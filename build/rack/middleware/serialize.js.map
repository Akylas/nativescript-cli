{"version":3,"sources":["rack/middleware/serialize.js"],"names":[],"mappings":";;;;;;;;;;;AAAA;;AACA;;;;;;;;;;;;;;;;IAKa;;;AACX,WADW,mBACX,GAAkD;QAAtC,6DAAO,6CAA+B;;0BADvC,qBACuC;;kEADvC,gCAEH,OAD0C;GAAlD;;eADW;;2BAKJ,SAAS;AACd,aAAO,2BANE,2DAMW,QAAb,CAAsB,IAAtB,CAA2B,YAAM;AACtC,YAAI,WAAW,QAAQ,IAAR,EAAc;AAC3B,cAAM,cAAc,QAAQ,OAAR,CAAgB,cAAhB,KAAmC,QAAQ,OAAR,CAAgB,cAAhB,CAAnC,CADO;;AAG3B,cAAI,YAAY,OAAZ,CAAoB,kBAApB,MAA4C,CAA5C,EAA+C;AACjD,oBAAQ,IAAR,GAAe,KAAK,SAAL,CAAe,QAAQ,IAAR,CAA9B,CADiD;WAAnD,MAEO,IAAI,YAAY,OAAZ,CAAoB,mCAApB,MAA6D,CAA7D,EAAgE;;AACzE,kBAAM,OAAO,QAAQ,IAAR;AACb,kBAAM,MAAM,EAAN;AACN,kBAAM,OAAO,OAAO,IAAP,CAAY,IAAZ,CAAP;;AAEN,qCAAQ,IAAR,EAAc,eAAO;AACnB,oBAAI,IAAJ,CAAY,OAAO,kBAAP,CAA0B,GAA1B,UAAkC,OAAO,kBAAP,CAA0B,KAAK,GAAL,CAA1B,CAA9C,EADmB;eAAP,CAAd;;AAIA,sBAAQ,IAAR,GAAe,IAAI,IAAJ,CAAS,GAAT,CAAf;iBATyE;WAApE;SALT;;AAkBA,eAAO,OAAP,CAnBsC;OAAN,CAAlC,CADc;;;;SALL","file":"rack/middleware/serialize.js","sourcesContent":["import { KinveyMiddleware } from '../middleware';\nimport forEach from 'lodash/forEach';\n\n/**\n * @private\n */\nexport class SerializeMiddleware extends KinveyMiddleware {\n  constructor(name = 'Kinvey Serialize Middleware') {\n    super(name);\n  }\n\n  handle(request) {\n    return super.handle(request).then(() => {\n      if (request && request.data) {\n        const contentType = request.headers['content-type'] || request.headers['Content-Type'];\n\n        if (contentType.indexOf('application/json') === 0) {\n          request.data = JSON.stringify(request.data);\n        } else if (contentType.indexOf('application/x-www-form-urlencoded') === 0) {\n          const data = request.data;\n          const str = [];\n          const keys = Object.keys(data);\n\n          forEach(keys, key => {\n            str.push(`${global.encodeURIComponent(key)}=${global.encodeURIComponent(data[key])}`);\n          });\n\n          request.data = str.join('&');\n        }\n      }\n\n      return request;\n    });\n  }\n}\n"],"sourceRoot":"/source/"}