{"version":3,"sources":["requests/response.js"],"names":[],"mappings":"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","file":"requests/response.js","sourcesContent":["import { StatusCode } from '../enums';\nimport { InsufficientCredentialsError, InvalidCredentialsError, KinveyError, NotFoundError } from '../errors';\nimport assign from 'lodash/assign';\nimport forEach from 'lodash/forEach';\nimport isString from 'lodash/isString';\nimport isPlainObject from 'lodash/isPlainObject';\n\n/**\n * @private\n */\nexport class Response {\n  constructor(options = {}) {\n    options = assign({\n      statusCode: StatusCode.Ok,\n      headers: {\n        'Content-Type': 'application/json; charset=utf-8'\n      },\n      data: null\n    }, options);\n\n    this.statusCode = options.statusCode;\n    this.addHeaders(options.headers);\n    this.data = options.data;\n  }\n\n  get error() {\n    if (this.isSuccess()) {\n      return null;\n    }\n\n    const data = this.data || {};\n    const name = data.name || data.error;\n    const message = data.message || data.description;\n    const debug = data.debug;\n\n    if (name === 'EntityNotFound'\n        || name === 'CollectionNotFound'\n        || name === 'AppNotFound'\n        || name === 'UserNotFound'\n        || name === 'BlobNotFound'\n        || name === 'DocumentNotFound') {\n      return new NotFoundError(message, debug);\n    } else if (name === 'InsufficientCredentials') {\n      return new InsufficientCredentialsError(message, debug);\n    } else if (name === 'InvalidCredentials') {\n      return new InvalidCredentialsError(message, debug);\n    }\n\n    return new KinveyError(message, debug);\n  }\n\n  getHeader(name) {\n    if (name) {\n      if (!isString(name)) {\n        name = String(name);\n      }\n\n      const headers = this.headers || {};\n      const keys = Object.keys(headers);\n\n      for (let i = 0, len = keys.length; i < len; i++) {\n        const key = keys[i];\n\n        if (key.toLowerCase() === name.toLowerCase()) {\n          return headers[key];\n        }\n      }\n    }\n\n    return undefined;\n  }\n\n  setHeader(name, value) {\n    if (!name || !value) {\n      throw new Error('A name and value must be provided to set a header.');\n    }\n\n    if (!isString(name)) {\n      name = String(name);\n    }\n\n    const headers = this.headers || {};\n\n    if (!isString(value)) {\n      headers[name] = JSON.stringify(value);\n    } else {\n      headers[name] = value;\n    }\n\n    this.headers = headers;\n  }\n\n  addHeader(header = {}) {\n    return this.setHeader(header.name, header.value);\n  }\n\n  addHeaders(headers) {\n    if (!isPlainObject(headers)) {\n      throw new Error('Headers argument must be an object.');\n    }\n\n    const names = Object.keys(headers);\n\n    forEach(names, name => {\n      const value = headers[name];\n      this.setHeader(name, value);\n    });\n  }\n\n  removeHeader(name) {\n    if (name) {\n      if (!isString(name)) {\n        name = String(name);\n      }\n\n      const headers = this.headers || {};\n      delete headers[name];\n      this.headers = headers;\n    }\n  }\n\n  clearHeaders() {\n    this.headers = {};\n  }\n\n  isSuccess() {\n    return (this.statusCode >= 200 && this.statusCode < 300) || this.statusCode === 302;\n  }\n\n  toJSON() {\n    const json = {\n      statusCode: this.statusCode,\n      headers: this.headers,\n      data: this.data\n    };\n    return json;\n  }\n}\n"],"sourceRoot":"/source/"}