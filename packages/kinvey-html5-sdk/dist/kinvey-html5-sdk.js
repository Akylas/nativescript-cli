
/**
 * kinvey-html5-sdk - Kinvey JavaScript SDK for HTML5 applications.
 * @version 3.14.0-next.0
 * @author undefined
 * @license Apache-2.0
 */

(function webpackUniversalModuleDefinition(root, factory) {
	if(typeof exports === 'object' && typeof module === 'object')
		module.exports = factory();
	else if(typeof define === 'function' && define.amd)
		define([], factory);
	else if(typeof exports === 'object')
		exports["Kinvey"] = factory();
	else
		root["Kinvey"] = factory();
})(window, function() {
return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./packages/kinvey-html5-sdk/src/index.js");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./node_modules/@babel/runtime/helpers/arrayWithHoles.js":
/*!***************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/arrayWithHoles.js ***!
  \***************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

function _arrayWithHoles(arr) {
  if (Array.isArray(arr)) return arr;
}

module.exports = _arrayWithHoles;

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js":
/*!**********************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/assertThisInitialized.js ***!
  \**********************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

function _assertThisInitialized(self) {
  if (self === void 0) {
    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
  }

  return self;
}

module.exports = _assertThisInitialized;

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/asyncToGenerator.js":
/*!*****************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/asyncToGenerator.js ***!
  \*****************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {
  try {
    var info = gen[key](arg);
    var value = info.value;
  } catch (error) {
    reject(error);
    return;
  }

  if (info.done) {
    resolve(value);
  } else {
    Promise.resolve(value).then(_next, _throw);
  }
}

function _asyncToGenerator(fn) {
  return function () {
    var self = this,
        args = arguments;
    return new Promise(function (resolve, reject) {
      var gen = fn.apply(self, args);

      function _next(value) {
        asyncGeneratorStep(gen, resolve, reject, _next, _throw, "next", value);
      }

      function _throw(err) {
        asyncGeneratorStep(gen, resolve, reject, _next, _throw, "throw", err);
      }

      _next(undefined);
    });
  };
}

module.exports = _asyncToGenerator;

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/classCallCheck.js":
/*!***************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/classCallCheck.js ***!
  \***************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

function _classCallCheck(instance, Constructor) {
  if (!(instance instanceof Constructor)) {
    throw new TypeError("Cannot call a class as a function");
  }
}

module.exports = _classCallCheck;

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/construct.js":
/*!**********************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/construct.js ***!
  \**********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var setPrototypeOf = __webpack_require__(/*! ./setPrototypeOf */ "./node_modules/@babel/runtime/helpers/setPrototypeOf.js");

function isNativeReflectConstruct() {
  if (typeof Reflect === "undefined" || !Reflect.construct) return false;
  if (Reflect.construct.sham) return false;
  if (typeof Proxy === "function") return true;

  try {
    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));
    return true;
  } catch (e) {
    return false;
  }
}

function _construct(Parent, args, Class) {
  if (isNativeReflectConstruct()) {
    module.exports = _construct = Reflect.construct;
  } else {
    module.exports = _construct = function _construct(Parent, args, Class) {
      var a = [null];
      a.push.apply(a, args);
      var Constructor = Function.bind.apply(Parent, a);
      var instance = new Constructor();
      if (Class) setPrototypeOf(instance, Class.prototype);
      return instance;
    };
  }

  return _construct.apply(null, arguments);
}

module.exports = _construct;

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/createClass.js":
/*!************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/createClass.js ***!
  \************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

function _defineProperties(target, props) {
  for (var i = 0; i < props.length; i++) {
    var descriptor = props[i];
    descriptor.enumerable = descriptor.enumerable || false;
    descriptor.configurable = true;
    if ("value" in descriptor) descriptor.writable = true;
    Object.defineProperty(target, descriptor.key, descriptor);
  }
}

function _createClass(Constructor, protoProps, staticProps) {
  if (protoProps) _defineProperties(Constructor.prototype, protoProps);
  if (staticProps) _defineProperties(Constructor, staticProps);
  return Constructor;
}

module.exports = _createClass;

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/defineProperty.js":
/*!***************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/defineProperty.js ***!
  \***************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

function _defineProperty(obj, key, value) {
  if (key in obj) {
    Object.defineProperty(obj, key, {
      value: value,
      enumerable: true,
      configurable: true,
      writable: true
    });
  } else {
    obj[key] = value;
  }

  return obj;
}

module.exports = _defineProperty;

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/get.js":
/*!****************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/get.js ***!
  \****************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var getPrototypeOf = __webpack_require__(/*! ./getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js");

var superPropBase = __webpack_require__(/*! ./superPropBase */ "./node_modules/@babel/runtime/helpers/superPropBase.js");

function _get(target, property, receiver) {
  if (typeof Reflect !== "undefined" && Reflect.get) {
    module.exports = _get = Reflect.get;
  } else {
    module.exports = _get = function _get(target, property, receiver) {
      var base = superPropBase(target, property);
      if (!base) return;
      var desc = Object.getOwnPropertyDescriptor(base, property);

      if (desc.get) {
        return desc.get.call(receiver);
      }

      return desc.value;
    };
  }

  return _get(target, property, receiver || target);
}

module.exports = _get;

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js":
/*!***************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/getPrototypeOf.js ***!
  \***************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

function _getPrototypeOf(o) {
  module.exports = _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {
    return o.__proto__ || Object.getPrototypeOf(o);
  };
  return _getPrototypeOf(o);
}

module.exports = _getPrototypeOf;

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/inherits.js":
/*!*********************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/inherits.js ***!
  \*********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var setPrototypeOf = __webpack_require__(/*! ./setPrototypeOf */ "./node_modules/@babel/runtime/helpers/setPrototypeOf.js");

function _inherits(subClass, superClass) {
  if (typeof superClass !== "function" && superClass !== null) {
    throw new TypeError("Super expression must either be null or a function");
  }

  subClass.prototype = Object.create(superClass && superClass.prototype, {
    constructor: {
      value: subClass,
      writable: true,
      configurable: true
    }
  });
  if (superClass) setPrototypeOf(subClass, superClass);
}

module.exports = _inherits;

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js":
/*!**********************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/interopRequireDefault.js ***!
  \**********************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    default: obj
  };
}

module.exports = _interopRequireDefault;

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/interopRequireWildcard.js":
/*!***********************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/interopRequireWildcard.js ***!
  \***********************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

function _interopRequireWildcard(obj) {
  if (obj && obj.__esModule) {
    return obj;
  } else {
    var newObj = {};

    if (obj != null) {
      for (var key in obj) {
        if (Object.prototype.hasOwnProperty.call(obj, key)) {
          var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {};

          if (desc.get || desc.set) {
            Object.defineProperty(newObj, key, desc);
          } else {
            newObj[key] = obj[key];
          }
        }
      }
    }

    newObj.default = obj;
    return newObj;
  }
}

module.exports = _interopRequireWildcard;

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/isNativeFunction.js":
/*!*****************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/isNativeFunction.js ***!
  \*****************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

function _isNativeFunction(fn) {
  return Function.toString.call(fn).indexOf("[native code]") !== -1;
}

module.exports = _isNativeFunction;

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/iterableToArrayLimit.js":
/*!*********************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/iterableToArrayLimit.js ***!
  \*********************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

function _iterableToArrayLimit(arr, i) {
  var _arr = [];
  var _n = true;
  var _d = false;
  var _e = undefined;

  try {
    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {
      _arr.push(_s.value);

      if (i && _arr.length === i) break;
    }
  } catch (err) {
    _d = true;
    _e = err;
  } finally {
    try {
      if (!_n && _i["return"] != null) _i["return"]();
    } finally {
      if (_d) throw _e;
    }
  }

  return _arr;
}

module.exports = _iterableToArrayLimit;

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/nonIterableRest.js":
/*!****************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/nonIterableRest.js ***!
  \****************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

function _nonIterableRest() {
  throw new TypeError("Invalid attempt to destructure non-iterable instance");
}

module.exports = _nonIterableRest;

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js":
/*!**************************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js ***!
  \**************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var _typeof = __webpack_require__(/*! ../helpers/typeof */ "./node_modules/@babel/runtime/helpers/typeof.js");

var assertThisInitialized = __webpack_require__(/*! ./assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js");

function _possibleConstructorReturn(self, call) {
  if (call && (_typeof(call) === "object" || typeof call === "function")) {
    return call;
  }

  return assertThisInitialized(self);
}

module.exports = _possibleConstructorReturn;

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/setPrototypeOf.js":
/*!***************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/setPrototypeOf.js ***!
  \***************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

function _setPrototypeOf(o, p) {
  module.exports = _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {
    o.__proto__ = p;
    return o;
  };

  return _setPrototypeOf(o, p);
}

module.exports = _setPrototypeOf;

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/slicedToArray.js":
/*!**************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/slicedToArray.js ***!
  \**************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var arrayWithHoles = __webpack_require__(/*! ./arrayWithHoles */ "./node_modules/@babel/runtime/helpers/arrayWithHoles.js");

var iterableToArrayLimit = __webpack_require__(/*! ./iterableToArrayLimit */ "./node_modules/@babel/runtime/helpers/iterableToArrayLimit.js");

var nonIterableRest = __webpack_require__(/*! ./nonIterableRest */ "./node_modules/@babel/runtime/helpers/nonIterableRest.js");

function _slicedToArray(arr, i) {
  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || nonIterableRest();
}

module.exports = _slicedToArray;

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/superPropBase.js":
/*!**************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/superPropBase.js ***!
  \**************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var getPrototypeOf = __webpack_require__(/*! ./getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js");

function _superPropBase(object, property) {
  while (!Object.prototype.hasOwnProperty.call(object, property)) {
    object = getPrototypeOf(object);
    if (object === null) break;
  }

  return object;
}

module.exports = _superPropBase;

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/typeof.js":
/*!*******************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/typeof.js ***!
  \*******************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

function _typeof2(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof2 = function _typeof2(obj) { return typeof obj; }; } else { _typeof2 = function _typeof2(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof2(obj); }

function _typeof(obj) {
  if (typeof Symbol === "function" && _typeof2(Symbol.iterator) === "symbol") {
    module.exports = _typeof = function _typeof(obj) {
      return _typeof2(obj);
    };
  } else {
    module.exports = _typeof = function _typeof(obj) {
      return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : _typeof2(obj);
    };
  }

  return _typeof(obj);
}

module.exports = _typeof;

/***/ }),

/***/ "./node_modules/@babel/runtime/helpers/wrapNativeSuper.js":
/*!****************************************************************!*\
  !*** ./node_modules/@babel/runtime/helpers/wrapNativeSuper.js ***!
  \****************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var getPrototypeOf = __webpack_require__(/*! ./getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js");

var setPrototypeOf = __webpack_require__(/*! ./setPrototypeOf */ "./node_modules/@babel/runtime/helpers/setPrototypeOf.js");

var isNativeFunction = __webpack_require__(/*! ./isNativeFunction */ "./node_modules/@babel/runtime/helpers/isNativeFunction.js");

var construct = __webpack_require__(/*! ./construct */ "./node_modules/@babel/runtime/helpers/construct.js");

function _wrapNativeSuper(Class) {
  var _cache = typeof Map === "function" ? new Map() : undefined;

  module.exports = _wrapNativeSuper = function _wrapNativeSuper(Class) {
    if (Class === null || !isNativeFunction(Class)) return Class;

    if (typeof Class !== "function") {
      throw new TypeError("Super expression must either be null or a function");
    }

    if (typeof _cache !== "undefined") {
      if (_cache.has(Class)) return _cache.get(Class);

      _cache.set(Class, Wrapper);
    }

    function Wrapper() {
      return construct(Class, arguments, getPrototypeOf(this).constructor);
    }

    Wrapper.prototype = Object.create(Class.prototype, {
      constructor: {
        value: Wrapper,
        enumerable: false,
        writable: true,
        configurable: true
      }
    });
    return setPrototypeOf(Wrapper, Class);
  };

  return _wrapNativeSuper(Class);
}

module.exports = _wrapNativeSuper;

/***/ }),

/***/ "./node_modules/@babel/runtime/regenerator/index.js":
/*!**********************************************************!*\
  !*** ./node_modules/@babel/runtime/regenerator/index.js ***!
  \**********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(/*! regenerator-runtime */ "./node_modules/regenerator-runtime/runtime-module.js");


/***/ }),

/***/ "./node_modules/axios/index.js":
/*!*************************************!*\
  !*** ./node_modules/axios/index.js ***!
  \*************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(/*! ./lib/axios */ "./node_modules/axios/lib/axios.js");

/***/ }),

/***/ "./node_modules/axios/lib/adapters/xhr.js":
/*!************************************************!*\
  !*** ./node_modules/axios/lib/adapters/xhr.js ***!
  \************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var utils = __webpack_require__(/*! ./../utils */ "./node_modules/axios/lib/utils.js");
var settle = __webpack_require__(/*! ./../core/settle */ "./node_modules/axios/lib/core/settle.js");
var buildURL = __webpack_require__(/*! ./../helpers/buildURL */ "./node_modules/axios/lib/helpers/buildURL.js");
var parseHeaders = __webpack_require__(/*! ./../helpers/parseHeaders */ "./node_modules/axios/lib/helpers/parseHeaders.js");
var isURLSameOrigin = __webpack_require__(/*! ./../helpers/isURLSameOrigin */ "./node_modules/axios/lib/helpers/isURLSameOrigin.js");
var createError = __webpack_require__(/*! ../core/createError */ "./node_modules/axios/lib/core/createError.js");
var btoa = (typeof window !== 'undefined' && window.btoa && window.btoa.bind(window)) || __webpack_require__(/*! ./../helpers/btoa */ "./node_modules/axios/lib/helpers/btoa.js");

module.exports = function xhrAdapter(config) {
  return new Promise(function dispatchXhrRequest(resolve, reject) {
    var requestData = config.data;
    var requestHeaders = config.headers;

    if (utils.isFormData(requestData)) {
      delete requestHeaders['Content-Type']; // Let the browser set it
    }

    var request = new XMLHttpRequest();
    var loadEvent = 'onreadystatechange';
    var xDomain = false;

    // For IE 8/9 CORS support
    // Only supports POST and GET calls and doesn't returns the response headers.
    // DON'T do this for testing b/c XMLHttpRequest is mocked, not XDomainRequest.
    if ( true &&
        typeof window !== 'undefined' &&
        window.XDomainRequest && !('withCredentials' in request) &&
        !isURLSameOrigin(config.url)) {
      request = new window.XDomainRequest();
      loadEvent = 'onload';
      xDomain = true;
      request.onprogress = function handleProgress() {};
      request.ontimeout = function handleTimeout() {};
    }

    // HTTP basic authentication
    if (config.auth) {
      var username = config.auth.username || '';
      var password = config.auth.password || '';
      requestHeaders.Authorization = 'Basic ' + btoa(username + ':' + password);
    }

    request.open(config.method.toUpperCase(), buildURL(config.url, config.params, config.paramsSerializer), true);

    // Set the request timeout in MS
    request.timeout = config.timeout;

    // Listen for ready state
    request[loadEvent] = function handleLoad() {
      if (!request || (request.readyState !== 4 && !xDomain)) {
        return;
      }

      // The request errored out and we didn't get a response, this will be
      // handled by onerror instead
      // With one exception: request that using file: protocol, most browsers
      // will return status as 0 even though it's a successful request
      if (request.status === 0 && !(request.responseURL && request.responseURL.indexOf('file:') === 0)) {
        return;
      }

      // Prepare the response
      var responseHeaders = 'getAllResponseHeaders' in request ? parseHeaders(request.getAllResponseHeaders()) : null;
      var responseData = !config.responseType || config.responseType === 'text' ? request.responseText : request.response;
      var response = {
        data: responseData,
        // IE sends 1223 instead of 204 (https://github.com/axios/axios/issues/201)
        status: request.status === 1223 ? 204 : request.status,
        statusText: request.status === 1223 ? 'No Content' : request.statusText,
        headers: responseHeaders,
        config: config,
        request: request
      };

      settle(resolve, reject, response);

      // Clean up request
      request = null;
    };

    // Handle low level network errors
    request.onerror = function handleError() {
      // Real errors are hidden from us by the browser
      // onerror should only fire if it's a network error
      reject(createError('Network Error', config, null, request));

      // Clean up request
      request = null;
    };

    // Handle timeout
    request.ontimeout = function handleTimeout() {
      reject(createError('timeout of ' + config.timeout + 'ms exceeded', config, 'ECONNABORTED',
        request));

      // Clean up request
      request = null;
    };

    // Add xsrf header
    // This is only done if running in a standard browser environment.
    // Specifically not if we're in a web worker, or react-native.
    if (utils.isStandardBrowserEnv()) {
      var cookies = __webpack_require__(/*! ./../helpers/cookies */ "./node_modules/axios/lib/helpers/cookies.js");

      // Add xsrf header
      var xsrfValue = (config.withCredentials || isURLSameOrigin(config.url)) && config.xsrfCookieName ?
          cookies.read(config.xsrfCookieName) :
          undefined;

      if (xsrfValue) {
        requestHeaders[config.xsrfHeaderName] = xsrfValue;
      }
    }

    // Add headers to the request
    if ('setRequestHeader' in request) {
      utils.forEach(requestHeaders, function setRequestHeader(val, key) {
        if (typeof requestData === 'undefined' && key.toLowerCase() === 'content-type') {
          // Remove Content-Type if data is undefined
          delete requestHeaders[key];
        } else {
          // Otherwise add header to the request
          request.setRequestHeader(key, val);
        }
      });
    }

    // Add withCredentials to request if needed
    if (config.withCredentials) {
      request.withCredentials = true;
    }

    // Add responseType to request if needed
    if (config.responseType) {
      try {
        request.responseType = config.responseType;
      } catch (e) {
        // Expected DOMException thrown by browsers not compatible XMLHttpRequest Level 2.
        // But, this can be suppressed for 'json' type as it can be parsed by default 'transformResponse' function.
        if (config.responseType !== 'json') {
          throw e;
        }
      }
    }

    // Handle progress if needed
    if (typeof config.onDownloadProgress === 'function') {
      request.addEventListener('progress', config.onDownloadProgress);
    }

    // Not all browsers support upload events
    if (typeof config.onUploadProgress === 'function' && request.upload) {
      request.upload.addEventListener('progress', config.onUploadProgress);
    }

    if (config.cancelToken) {
      // Handle cancellation
      config.cancelToken.promise.then(function onCanceled(cancel) {
        if (!request) {
          return;
        }

        request.abort();
        reject(cancel);
        // Clean up request
        request = null;
      });
    }

    if (requestData === undefined) {
      requestData = null;
    }

    // Send the request
    request.send(requestData);
  });
};


/***/ }),

/***/ "./node_modules/axios/lib/axios.js":
/*!*****************************************!*\
  !*** ./node_modules/axios/lib/axios.js ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var utils = __webpack_require__(/*! ./utils */ "./node_modules/axios/lib/utils.js");
var bind = __webpack_require__(/*! ./helpers/bind */ "./node_modules/axios/lib/helpers/bind.js");
var Axios = __webpack_require__(/*! ./core/Axios */ "./node_modules/axios/lib/core/Axios.js");
var defaults = __webpack_require__(/*! ./defaults */ "./node_modules/axios/lib/defaults.js");

/**
 * Create an instance of Axios
 *
 * @param {Object} defaultConfig The default config for the instance
 * @return {Axios} A new instance of Axios
 */
function createInstance(defaultConfig) {
  var context = new Axios(defaultConfig);
  var instance = bind(Axios.prototype.request, context);

  // Copy axios.prototype to instance
  utils.extend(instance, Axios.prototype, context);

  // Copy context to instance
  utils.extend(instance, context);

  return instance;
}

// Create the default instance to be exported
var axios = createInstance(defaults);

// Expose Axios class to allow class inheritance
axios.Axios = Axios;

// Factory for creating new instances
axios.create = function create(instanceConfig) {
  return createInstance(utils.merge(defaults, instanceConfig));
};

// Expose Cancel & CancelToken
axios.Cancel = __webpack_require__(/*! ./cancel/Cancel */ "./node_modules/axios/lib/cancel/Cancel.js");
axios.CancelToken = __webpack_require__(/*! ./cancel/CancelToken */ "./node_modules/axios/lib/cancel/CancelToken.js");
axios.isCancel = __webpack_require__(/*! ./cancel/isCancel */ "./node_modules/axios/lib/cancel/isCancel.js");

// Expose all/spread
axios.all = function all(promises) {
  return Promise.all(promises);
};
axios.spread = __webpack_require__(/*! ./helpers/spread */ "./node_modules/axios/lib/helpers/spread.js");

module.exports = axios;

// Allow use of default import syntax in TypeScript
module.exports.default = axios;


/***/ }),

/***/ "./node_modules/axios/lib/cancel/Cancel.js":
/*!*************************************************!*\
  !*** ./node_modules/axios/lib/cancel/Cancel.js ***!
  \*************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


/**
 * A `Cancel` is an object that is thrown when an operation is canceled.
 *
 * @class
 * @param {string=} message The message.
 */
function Cancel(message) {
  this.message = message;
}

Cancel.prototype.toString = function toString() {
  return 'Cancel' + (this.message ? ': ' + this.message : '');
};

Cancel.prototype.__CANCEL__ = true;

module.exports = Cancel;


/***/ }),

/***/ "./node_modules/axios/lib/cancel/CancelToken.js":
/*!******************************************************!*\
  !*** ./node_modules/axios/lib/cancel/CancelToken.js ***!
  \******************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var Cancel = __webpack_require__(/*! ./Cancel */ "./node_modules/axios/lib/cancel/Cancel.js");

/**
 * A `CancelToken` is an object that can be used to request cancellation of an operation.
 *
 * @class
 * @param {Function} executor The executor function.
 */
function CancelToken(executor) {
  if (typeof executor !== 'function') {
    throw new TypeError('executor must be a function.');
  }

  var resolvePromise;
  this.promise = new Promise(function promiseExecutor(resolve) {
    resolvePromise = resolve;
  });

  var token = this;
  executor(function cancel(message) {
    if (token.reason) {
      // Cancellation has already been requested
      return;
    }

    token.reason = new Cancel(message);
    resolvePromise(token.reason);
  });
}

/**
 * Throws a `Cancel` if cancellation has been requested.
 */
CancelToken.prototype.throwIfRequested = function throwIfRequested() {
  if (this.reason) {
    throw this.reason;
  }
};

/**
 * Returns an object that contains a new `CancelToken` and a function that, when called,
 * cancels the `CancelToken`.
 */
CancelToken.source = function source() {
  var cancel;
  var token = new CancelToken(function executor(c) {
    cancel = c;
  });
  return {
    token: token,
    cancel: cancel
  };
};

module.exports = CancelToken;


/***/ }),

/***/ "./node_modules/axios/lib/cancel/isCancel.js":
/*!***************************************************!*\
  !*** ./node_modules/axios/lib/cancel/isCancel.js ***!
  \***************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = function isCancel(value) {
  return !!(value && value.__CANCEL__);
};


/***/ }),

/***/ "./node_modules/axios/lib/core/Axios.js":
/*!**********************************************!*\
  !*** ./node_modules/axios/lib/core/Axios.js ***!
  \**********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var defaults = __webpack_require__(/*! ./../defaults */ "./node_modules/axios/lib/defaults.js");
var utils = __webpack_require__(/*! ./../utils */ "./node_modules/axios/lib/utils.js");
var InterceptorManager = __webpack_require__(/*! ./InterceptorManager */ "./node_modules/axios/lib/core/InterceptorManager.js");
var dispatchRequest = __webpack_require__(/*! ./dispatchRequest */ "./node_modules/axios/lib/core/dispatchRequest.js");

/**
 * Create a new instance of Axios
 *
 * @param {Object} instanceConfig The default config for the instance
 */
function Axios(instanceConfig) {
  this.defaults = instanceConfig;
  this.interceptors = {
    request: new InterceptorManager(),
    response: new InterceptorManager()
  };
}

/**
 * Dispatch a request
 *
 * @param {Object} config The config specific for this request (merged with this.defaults)
 */
Axios.prototype.request = function request(config) {
  /*eslint no-param-reassign:0*/
  // Allow for axios('example/url'[, config]) a la fetch API
  if (typeof config === 'string') {
    config = utils.merge({
      url: arguments[0]
    }, arguments[1]);
  }

  config = utils.merge(defaults, {method: 'get'}, this.defaults, config);
  config.method = config.method.toLowerCase();

  // Hook up interceptors middleware
  var chain = [dispatchRequest, undefined];
  var promise = Promise.resolve(config);

  this.interceptors.request.forEach(function unshiftRequestInterceptors(interceptor) {
    chain.unshift(interceptor.fulfilled, interceptor.rejected);
  });

  this.interceptors.response.forEach(function pushResponseInterceptors(interceptor) {
    chain.push(interceptor.fulfilled, interceptor.rejected);
  });

  while (chain.length) {
    promise = promise.then(chain.shift(), chain.shift());
  }

  return promise;
};

// Provide aliases for supported request methods
utils.forEach(['delete', 'get', 'head', 'options'], function forEachMethodNoData(method) {
  /*eslint func-names:0*/
  Axios.prototype[method] = function(url, config) {
    return this.request(utils.merge(config || {}, {
      method: method,
      url: url
    }));
  };
});

utils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {
  /*eslint func-names:0*/
  Axios.prototype[method] = function(url, data, config) {
    return this.request(utils.merge(config || {}, {
      method: method,
      url: url,
      data: data
    }));
  };
});

module.exports = Axios;


/***/ }),

/***/ "./node_modules/axios/lib/core/InterceptorManager.js":
/*!***********************************************************!*\
  !*** ./node_modules/axios/lib/core/InterceptorManager.js ***!
  \***********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var utils = __webpack_require__(/*! ./../utils */ "./node_modules/axios/lib/utils.js");

function InterceptorManager() {
  this.handlers = [];
}

/**
 * Add a new interceptor to the stack
 *
 * @param {Function} fulfilled The function to handle `then` for a `Promise`
 * @param {Function} rejected The function to handle `reject` for a `Promise`
 *
 * @return {Number} An ID used to remove interceptor later
 */
InterceptorManager.prototype.use = function use(fulfilled, rejected) {
  this.handlers.push({
    fulfilled: fulfilled,
    rejected: rejected
  });
  return this.handlers.length - 1;
};

/**
 * Remove an interceptor from the stack
 *
 * @param {Number} id The ID that was returned by `use`
 */
InterceptorManager.prototype.eject = function eject(id) {
  if (this.handlers[id]) {
    this.handlers[id] = null;
  }
};

/**
 * Iterate over all the registered interceptors
 *
 * This method is particularly useful for skipping over any
 * interceptors that may have become `null` calling `eject`.
 *
 * @param {Function} fn The function to call for each interceptor
 */
InterceptorManager.prototype.forEach = function forEach(fn) {
  utils.forEach(this.handlers, function forEachHandler(h) {
    if (h !== null) {
      fn(h);
    }
  });
};

module.exports = InterceptorManager;


/***/ }),

/***/ "./node_modules/axios/lib/core/createError.js":
/*!****************************************************!*\
  !*** ./node_modules/axios/lib/core/createError.js ***!
  \****************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var enhanceError = __webpack_require__(/*! ./enhanceError */ "./node_modules/axios/lib/core/enhanceError.js");

/**
 * Create an Error with the specified message, config, error code, request and response.
 *
 * @param {string} message The error message.
 * @param {Object} config The config.
 * @param {string} [code] The error code (for example, 'ECONNABORTED').
 * @param {Object} [request] The request.
 * @param {Object} [response] The response.
 * @returns {Error} The created error.
 */
module.exports = function createError(message, config, code, request, response) {
  var error = new Error(message);
  return enhanceError(error, config, code, request, response);
};


/***/ }),

/***/ "./node_modules/axios/lib/core/dispatchRequest.js":
/*!********************************************************!*\
  !*** ./node_modules/axios/lib/core/dispatchRequest.js ***!
  \********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var utils = __webpack_require__(/*! ./../utils */ "./node_modules/axios/lib/utils.js");
var transformData = __webpack_require__(/*! ./transformData */ "./node_modules/axios/lib/core/transformData.js");
var isCancel = __webpack_require__(/*! ../cancel/isCancel */ "./node_modules/axios/lib/cancel/isCancel.js");
var defaults = __webpack_require__(/*! ../defaults */ "./node_modules/axios/lib/defaults.js");
var isAbsoluteURL = __webpack_require__(/*! ./../helpers/isAbsoluteURL */ "./node_modules/axios/lib/helpers/isAbsoluteURL.js");
var combineURLs = __webpack_require__(/*! ./../helpers/combineURLs */ "./node_modules/axios/lib/helpers/combineURLs.js");

/**
 * Throws a `Cancel` if cancellation has been requested.
 */
function throwIfCancellationRequested(config) {
  if (config.cancelToken) {
    config.cancelToken.throwIfRequested();
  }
}

/**
 * Dispatch a request to the server using the configured adapter.
 *
 * @param {object} config The config that is to be used for the request
 * @returns {Promise} The Promise to be fulfilled
 */
module.exports = function dispatchRequest(config) {
  throwIfCancellationRequested(config);

  // Support baseURL config
  if (config.baseURL && !isAbsoluteURL(config.url)) {
    config.url = combineURLs(config.baseURL, config.url);
  }

  // Ensure headers exist
  config.headers = config.headers || {};

  // Transform request data
  config.data = transformData(
    config.data,
    config.headers,
    config.transformRequest
  );

  // Flatten headers
  config.headers = utils.merge(
    config.headers.common || {},
    config.headers[config.method] || {},
    config.headers || {}
  );

  utils.forEach(
    ['delete', 'get', 'head', 'post', 'put', 'patch', 'common'],
    function cleanHeaderConfig(method) {
      delete config.headers[method];
    }
  );

  var adapter = config.adapter || defaults.adapter;

  return adapter(config).then(function onAdapterResolution(response) {
    throwIfCancellationRequested(config);

    // Transform response data
    response.data = transformData(
      response.data,
      response.headers,
      config.transformResponse
    );

    return response;
  }, function onAdapterRejection(reason) {
    if (!isCancel(reason)) {
      throwIfCancellationRequested(config);

      // Transform response data
      if (reason && reason.response) {
        reason.response.data = transformData(
          reason.response.data,
          reason.response.headers,
          config.transformResponse
        );
      }
    }

    return Promise.reject(reason);
  });
};


/***/ }),

/***/ "./node_modules/axios/lib/core/enhanceError.js":
/*!*****************************************************!*\
  !*** ./node_modules/axios/lib/core/enhanceError.js ***!
  \*****************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


/**
 * Update an Error with the specified config, error code, and response.
 *
 * @param {Error} error The error to update.
 * @param {Object} config The config.
 * @param {string} [code] The error code (for example, 'ECONNABORTED').
 * @param {Object} [request] The request.
 * @param {Object} [response] The response.
 * @returns {Error} The error.
 */
module.exports = function enhanceError(error, config, code, request, response) {
  error.config = config;
  if (code) {
    error.code = code;
  }
  error.request = request;
  error.response = response;
  return error;
};


/***/ }),

/***/ "./node_modules/axios/lib/core/settle.js":
/*!***********************************************!*\
  !*** ./node_modules/axios/lib/core/settle.js ***!
  \***********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var createError = __webpack_require__(/*! ./createError */ "./node_modules/axios/lib/core/createError.js");

/**
 * Resolve or reject a Promise based on response status.
 *
 * @param {Function} resolve A function that resolves the promise.
 * @param {Function} reject A function that rejects the promise.
 * @param {object} response The response.
 */
module.exports = function settle(resolve, reject, response) {
  var validateStatus = response.config.validateStatus;
  // Note: status is not exposed by XDomainRequest
  if (!response.status || !validateStatus || validateStatus(response.status)) {
    resolve(response);
  } else {
    reject(createError(
      'Request failed with status code ' + response.status,
      response.config,
      null,
      response.request,
      response
    ));
  }
};


/***/ }),

/***/ "./node_modules/axios/lib/core/transformData.js":
/*!******************************************************!*\
  !*** ./node_modules/axios/lib/core/transformData.js ***!
  \******************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var utils = __webpack_require__(/*! ./../utils */ "./node_modules/axios/lib/utils.js");

/**
 * Transform the data for a request or a response
 *
 * @param {Object|String} data The data to be transformed
 * @param {Array} headers The headers for the request or response
 * @param {Array|Function} fns A single function or Array of functions
 * @returns {*} The resulting transformed data
 */
module.exports = function transformData(data, headers, fns) {
  /*eslint no-param-reassign:0*/
  utils.forEach(fns, function transform(fn) {
    data = fn(data, headers);
  });

  return data;
};


/***/ }),

/***/ "./node_modules/axios/lib/defaults.js":
/*!********************************************!*\
  !*** ./node_modules/axios/lib/defaults.js ***!
  \********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function(process) {

var utils = __webpack_require__(/*! ./utils */ "./node_modules/axios/lib/utils.js");
var normalizeHeaderName = __webpack_require__(/*! ./helpers/normalizeHeaderName */ "./node_modules/axios/lib/helpers/normalizeHeaderName.js");

var DEFAULT_CONTENT_TYPE = {
  'Content-Type': 'application/x-www-form-urlencoded'
};

function setContentTypeIfUnset(headers, value) {
  if (!utils.isUndefined(headers) && utils.isUndefined(headers['Content-Type'])) {
    headers['Content-Type'] = value;
  }
}

function getDefaultAdapter() {
  var adapter;
  if (typeof XMLHttpRequest !== 'undefined') {
    // For browsers use XHR adapter
    adapter = __webpack_require__(/*! ./adapters/xhr */ "./node_modules/axios/lib/adapters/xhr.js");
  } else if (typeof process !== 'undefined') {
    // For node use HTTP adapter
    adapter = __webpack_require__(/*! ./adapters/http */ "./node_modules/axios/lib/adapters/xhr.js");
  }
  return adapter;
}

var defaults = {
  adapter: getDefaultAdapter(),

  transformRequest: [function transformRequest(data, headers) {
    normalizeHeaderName(headers, 'Content-Type');
    if (utils.isFormData(data) ||
      utils.isArrayBuffer(data) ||
      utils.isBuffer(data) ||
      utils.isStream(data) ||
      utils.isFile(data) ||
      utils.isBlob(data)
    ) {
      return data;
    }
    if (utils.isArrayBufferView(data)) {
      return data.buffer;
    }
    if (utils.isURLSearchParams(data)) {
      setContentTypeIfUnset(headers, 'application/x-www-form-urlencoded;charset=utf-8');
      return data.toString();
    }
    if (utils.isObject(data)) {
      setContentTypeIfUnset(headers, 'application/json;charset=utf-8');
      return JSON.stringify(data);
    }
    return data;
  }],

  transformResponse: [function transformResponse(data) {
    /*eslint no-param-reassign:0*/
    if (typeof data === 'string') {
      try {
        data = JSON.parse(data);
      } catch (e) { /* Ignore */ }
    }
    return data;
  }],

  /**
   * A timeout in milliseconds to abort a request. If set to 0 (default) a
   * timeout is not created.
   */
  timeout: 0,

  xsrfCookieName: 'XSRF-TOKEN',
  xsrfHeaderName: 'X-XSRF-TOKEN',

  maxContentLength: -1,

  validateStatus: function validateStatus(status) {
    return status >= 200 && status < 300;
  }
};

defaults.headers = {
  common: {
    'Accept': 'application/json, text/plain, */*'
  }
};

utils.forEach(['delete', 'get', 'head'], function forEachMethodNoData(method) {
  defaults.headers[method] = {};
});

utils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {
  defaults.headers[method] = utils.merge(DEFAULT_CONTENT_TYPE);
});

module.exports = defaults;

/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../process/browser.js */ "./node_modules/process/browser.js")))

/***/ }),

/***/ "./node_modules/axios/lib/helpers/bind.js":
/*!************************************************!*\
  !*** ./node_modules/axios/lib/helpers/bind.js ***!
  \************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = function bind(fn, thisArg) {
  return function wrap() {
    var args = new Array(arguments.length);
    for (var i = 0; i < args.length; i++) {
      args[i] = arguments[i];
    }
    return fn.apply(thisArg, args);
  };
};


/***/ }),

/***/ "./node_modules/axios/lib/helpers/btoa.js":
/*!************************************************!*\
  !*** ./node_modules/axios/lib/helpers/btoa.js ***!
  \************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


// btoa polyfill for IE<10 courtesy https://github.com/davidchambers/Base64.js

var chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';

function E() {
  this.message = 'String contains an invalid character';
}
E.prototype = new Error;
E.prototype.code = 5;
E.prototype.name = 'InvalidCharacterError';

function btoa(input) {
  var str = String(input);
  var output = '';
  for (
    // initialize result and counter
    var block, charCode, idx = 0, map = chars;
    // if the next str index does not exist:
    //   change the mapping table to "="
    //   check if d has no fractional digits
    str.charAt(idx | 0) || (map = '=', idx % 1);
    // "8 - idx % 1 * 8" generates the sequence 2, 4, 6, 8
    output += map.charAt(63 & block >> 8 - idx % 1 * 8)
  ) {
    charCode = str.charCodeAt(idx += 3 / 4);
    if (charCode > 0xFF) {
      throw new E();
    }
    block = block << 8 | charCode;
  }
  return output;
}

module.exports = btoa;


/***/ }),

/***/ "./node_modules/axios/lib/helpers/buildURL.js":
/*!****************************************************!*\
  !*** ./node_modules/axios/lib/helpers/buildURL.js ***!
  \****************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var utils = __webpack_require__(/*! ./../utils */ "./node_modules/axios/lib/utils.js");

function encode(val) {
  return encodeURIComponent(val).
    replace(/%40/gi, '@').
    replace(/%3A/gi, ':').
    replace(/%24/g, '$').
    replace(/%2C/gi, ',').
    replace(/%20/g, '+').
    replace(/%5B/gi, '[').
    replace(/%5D/gi, ']');
}

/**
 * Build a URL by appending params to the end
 *
 * @param {string} url The base of the url (e.g., http://www.google.com)
 * @param {object} [params] The params to be appended
 * @returns {string} The formatted url
 */
module.exports = function buildURL(url, params, paramsSerializer) {
  /*eslint no-param-reassign:0*/
  if (!params) {
    return url;
  }

  var serializedParams;
  if (paramsSerializer) {
    serializedParams = paramsSerializer(params);
  } else if (utils.isURLSearchParams(params)) {
    serializedParams = params.toString();
  } else {
    var parts = [];

    utils.forEach(params, function serialize(val, key) {
      if (val === null || typeof val === 'undefined') {
        return;
      }

      if (utils.isArray(val)) {
        key = key + '[]';
      } else {
        val = [val];
      }

      utils.forEach(val, function parseValue(v) {
        if (utils.isDate(v)) {
          v = v.toISOString();
        } else if (utils.isObject(v)) {
          v = JSON.stringify(v);
        }
        parts.push(encode(key) + '=' + encode(v));
      });
    });

    serializedParams = parts.join('&');
  }

  if (serializedParams) {
    url += (url.indexOf('?') === -1 ? '?' : '&') + serializedParams;
  }

  return url;
};


/***/ }),

/***/ "./node_modules/axios/lib/helpers/combineURLs.js":
/*!*******************************************************!*\
  !*** ./node_modules/axios/lib/helpers/combineURLs.js ***!
  \*******************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


/**
 * Creates a new URL by combining the specified URLs
 *
 * @param {string} baseURL The base URL
 * @param {string} relativeURL The relative URL
 * @returns {string} The combined URL
 */
module.exports = function combineURLs(baseURL, relativeURL) {
  return relativeURL
    ? baseURL.replace(/\/+$/, '') + '/' + relativeURL.replace(/^\/+/, '')
    : baseURL;
};


/***/ }),

/***/ "./node_modules/axios/lib/helpers/cookies.js":
/*!***************************************************!*\
  !*** ./node_modules/axios/lib/helpers/cookies.js ***!
  \***************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var utils = __webpack_require__(/*! ./../utils */ "./node_modules/axios/lib/utils.js");

module.exports = (
  utils.isStandardBrowserEnv() ?

  // Standard browser envs support document.cookie
  (function standardBrowserEnv() {
    return {
      write: function write(name, value, expires, path, domain, secure) {
        var cookie = [];
        cookie.push(name + '=' + encodeURIComponent(value));

        if (utils.isNumber(expires)) {
          cookie.push('expires=' + new Date(expires).toGMTString());
        }

        if (utils.isString(path)) {
          cookie.push('path=' + path);
        }

        if (utils.isString(domain)) {
          cookie.push('domain=' + domain);
        }

        if (secure === true) {
          cookie.push('secure');
        }

        document.cookie = cookie.join('; ');
      },

      read: function read(name) {
        var match = document.cookie.match(new RegExp('(^|;\\s*)(' + name + ')=([^;]*)'));
        return (match ? decodeURIComponent(match[3]) : null);
      },

      remove: function remove(name) {
        this.write(name, '', Date.now() - 86400000);
      }
    };
  })() :

  // Non standard browser env (web workers, react-native) lack needed support.
  (function nonStandardBrowserEnv() {
    return {
      write: function write() {},
      read: function read() { return null; },
      remove: function remove() {}
    };
  })()
);


/***/ }),

/***/ "./node_modules/axios/lib/helpers/isAbsoluteURL.js":
/*!*********************************************************!*\
  !*** ./node_modules/axios/lib/helpers/isAbsoluteURL.js ***!
  \*********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


/**
 * Determines whether the specified URL is absolute
 *
 * @param {string} url The URL to test
 * @returns {boolean} True if the specified URL is absolute, otherwise false
 */
module.exports = function isAbsoluteURL(url) {
  // A URL is considered absolute if it begins with "<scheme>://" or "//" (protocol-relative URL).
  // RFC 3986 defines scheme name as a sequence of characters beginning with a letter and followed
  // by any combination of letters, digits, plus, period, or hyphen.
  return /^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(url);
};


/***/ }),

/***/ "./node_modules/axios/lib/helpers/isURLSameOrigin.js":
/*!***********************************************************!*\
  !*** ./node_modules/axios/lib/helpers/isURLSameOrigin.js ***!
  \***********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var utils = __webpack_require__(/*! ./../utils */ "./node_modules/axios/lib/utils.js");

module.exports = (
  utils.isStandardBrowserEnv() ?

  // Standard browser envs have full support of the APIs needed to test
  // whether the request URL is of the same origin as current location.
  (function standardBrowserEnv() {
    var msie = /(msie|trident)/i.test(navigator.userAgent);
    var urlParsingNode = document.createElement('a');
    var originURL;

    /**
    * Parse a URL to discover it's components
    *
    * @param {String} url The URL to be parsed
    * @returns {Object}
    */
    function resolveURL(url) {
      var href = url;

      if (msie) {
        // IE needs attribute set twice to normalize properties
        urlParsingNode.setAttribute('href', href);
        href = urlParsingNode.href;
      }

      urlParsingNode.setAttribute('href', href);

      // urlParsingNode provides the UrlUtils interface - http://url.spec.whatwg.org/#urlutils
      return {
        href: urlParsingNode.href,
        protocol: urlParsingNode.protocol ? urlParsingNode.protocol.replace(/:$/, '') : '',
        host: urlParsingNode.host,
        search: urlParsingNode.search ? urlParsingNode.search.replace(/^\?/, '') : '',
        hash: urlParsingNode.hash ? urlParsingNode.hash.replace(/^#/, '') : '',
        hostname: urlParsingNode.hostname,
        port: urlParsingNode.port,
        pathname: (urlParsingNode.pathname.charAt(0) === '/') ?
                  urlParsingNode.pathname :
                  '/' + urlParsingNode.pathname
      };
    }

    originURL = resolveURL(window.location.href);

    /**
    * Determine if a URL shares the same origin as the current location
    *
    * @param {String} requestURL The URL to test
    * @returns {boolean} True if URL shares the same origin, otherwise false
    */
    return function isURLSameOrigin(requestURL) {
      var parsed = (utils.isString(requestURL)) ? resolveURL(requestURL) : requestURL;
      return (parsed.protocol === originURL.protocol &&
            parsed.host === originURL.host);
    };
  })() :

  // Non standard browser envs (web workers, react-native) lack needed support.
  (function nonStandardBrowserEnv() {
    return function isURLSameOrigin() {
      return true;
    };
  })()
);


/***/ }),

/***/ "./node_modules/axios/lib/helpers/normalizeHeaderName.js":
/*!***************************************************************!*\
  !*** ./node_modules/axios/lib/helpers/normalizeHeaderName.js ***!
  \***************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var utils = __webpack_require__(/*! ../utils */ "./node_modules/axios/lib/utils.js");

module.exports = function normalizeHeaderName(headers, normalizedName) {
  utils.forEach(headers, function processHeader(value, name) {
    if (name !== normalizedName && name.toUpperCase() === normalizedName.toUpperCase()) {
      headers[normalizedName] = value;
      delete headers[name];
    }
  });
};


/***/ }),

/***/ "./node_modules/axios/lib/helpers/parseHeaders.js":
/*!********************************************************!*\
  !*** ./node_modules/axios/lib/helpers/parseHeaders.js ***!
  \********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var utils = __webpack_require__(/*! ./../utils */ "./node_modules/axios/lib/utils.js");

// Headers whose duplicates are ignored by node
// c.f. https://nodejs.org/api/http.html#http_message_headers
var ignoreDuplicateOf = [
  'age', 'authorization', 'content-length', 'content-type', 'etag',
  'expires', 'from', 'host', 'if-modified-since', 'if-unmodified-since',
  'last-modified', 'location', 'max-forwards', 'proxy-authorization',
  'referer', 'retry-after', 'user-agent'
];

/**
 * Parse headers into an object
 *
 * ```
 * Date: Wed, 27 Aug 2014 08:58:49 GMT
 * Content-Type: application/json
 * Connection: keep-alive
 * Transfer-Encoding: chunked
 * ```
 *
 * @param {String} headers Headers needing to be parsed
 * @returns {Object} Headers parsed into an object
 */
module.exports = function parseHeaders(headers) {
  var parsed = {};
  var key;
  var val;
  var i;

  if (!headers) { return parsed; }

  utils.forEach(headers.split('\n'), function parser(line) {
    i = line.indexOf(':');
    key = utils.trim(line.substr(0, i)).toLowerCase();
    val = utils.trim(line.substr(i + 1));

    if (key) {
      if (parsed[key] && ignoreDuplicateOf.indexOf(key) >= 0) {
        return;
      }
      if (key === 'set-cookie') {
        parsed[key] = (parsed[key] ? parsed[key] : []).concat([val]);
      } else {
        parsed[key] = parsed[key] ? parsed[key] + ', ' + val : val;
      }
    }
  });

  return parsed;
};


/***/ }),

/***/ "./node_modules/axios/lib/helpers/spread.js":
/*!**************************************************!*\
  !*** ./node_modules/axios/lib/helpers/spread.js ***!
  \**************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


/**
 * Syntactic sugar for invoking a function and expanding an array for arguments.
 *
 * Common use case would be to use `Function.prototype.apply`.
 *
 *  ```js
 *  function f(x, y, z) {}
 *  var args = [1, 2, 3];
 *  f.apply(null, args);
 *  ```
 *
 * With `spread` this example can be re-written.
 *
 *  ```js
 *  spread(function(x, y, z) {})([1, 2, 3]);
 *  ```
 *
 * @param {Function} callback
 * @returns {Function}
 */
module.exports = function spread(callback) {
  return function wrap(arr) {
    return callback.apply(null, arr);
  };
};


/***/ }),

/***/ "./node_modules/axios/lib/utils.js":
/*!*****************************************!*\
  !*** ./node_modules/axios/lib/utils.js ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var bind = __webpack_require__(/*! ./helpers/bind */ "./node_modules/axios/lib/helpers/bind.js");
var isBuffer = __webpack_require__(/*! is-buffer */ "./node_modules/is-buffer/index.js");

/*global toString:true*/

// utils is a library of generic helper functions non-specific to axios

var toString = Object.prototype.toString;

/**
 * Determine if a value is an Array
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is an Array, otherwise false
 */
function isArray(val) {
  return toString.call(val) === '[object Array]';
}

/**
 * Determine if a value is an ArrayBuffer
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is an ArrayBuffer, otherwise false
 */
function isArrayBuffer(val) {
  return toString.call(val) === '[object ArrayBuffer]';
}

/**
 * Determine if a value is a FormData
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is an FormData, otherwise false
 */
function isFormData(val) {
  return (typeof FormData !== 'undefined') && (val instanceof FormData);
}

/**
 * Determine if a value is a view on an ArrayBuffer
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a view on an ArrayBuffer, otherwise false
 */
function isArrayBufferView(val) {
  var result;
  if ((typeof ArrayBuffer !== 'undefined') && (ArrayBuffer.isView)) {
    result = ArrayBuffer.isView(val);
  } else {
    result = (val) && (val.buffer) && (val.buffer instanceof ArrayBuffer);
  }
  return result;
}

/**
 * Determine if a value is a String
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a String, otherwise false
 */
function isString(val) {
  return typeof val === 'string';
}

/**
 * Determine if a value is a Number
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a Number, otherwise false
 */
function isNumber(val) {
  return typeof val === 'number';
}

/**
 * Determine if a value is undefined
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if the value is undefined, otherwise false
 */
function isUndefined(val) {
  return typeof val === 'undefined';
}

/**
 * Determine if a value is an Object
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is an Object, otherwise false
 */
function isObject(val) {
  return val !== null && typeof val === 'object';
}

/**
 * Determine if a value is a Date
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a Date, otherwise false
 */
function isDate(val) {
  return toString.call(val) === '[object Date]';
}

/**
 * Determine if a value is a File
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a File, otherwise false
 */
function isFile(val) {
  return toString.call(val) === '[object File]';
}

/**
 * Determine if a value is a Blob
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a Blob, otherwise false
 */
function isBlob(val) {
  return toString.call(val) === '[object Blob]';
}

/**
 * Determine if a value is a Function
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a Function, otherwise false
 */
function isFunction(val) {
  return toString.call(val) === '[object Function]';
}

/**
 * Determine if a value is a Stream
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a Stream, otherwise false
 */
function isStream(val) {
  return isObject(val) && isFunction(val.pipe);
}

/**
 * Determine if a value is a URLSearchParams object
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a URLSearchParams object, otherwise false
 */
function isURLSearchParams(val) {
  return typeof URLSearchParams !== 'undefined' && val instanceof URLSearchParams;
}

/**
 * Trim excess whitespace off the beginning and end of a string
 *
 * @param {String} str The String to trim
 * @returns {String} The String freed of excess whitespace
 */
function trim(str) {
  return str.replace(/^\s*/, '').replace(/\s*$/, '');
}

/**
 * Determine if we're running in a standard browser environment
 *
 * This allows axios to run in a web worker, and react-native.
 * Both environments support XMLHttpRequest, but not fully standard globals.
 *
 * web workers:
 *  typeof window -> undefined
 *  typeof document -> undefined
 *
 * react-native:
 *  navigator.product -> 'ReactNative'
 */
function isStandardBrowserEnv() {
  if (typeof navigator !== 'undefined' && navigator.product === 'ReactNative') {
    return false;
  }
  return (
    typeof window !== 'undefined' &&
    typeof document !== 'undefined'
  );
}

/**
 * Iterate over an Array or an Object invoking a function for each item.
 *
 * If `obj` is an Array callback will be called passing
 * the value, index, and complete array for each item.
 *
 * If 'obj' is an Object callback will be called passing
 * the value, key, and complete object for each property.
 *
 * @param {Object|Array} obj The object to iterate
 * @param {Function} fn The callback to invoke for each item
 */
function forEach(obj, fn) {
  // Don't bother if no value provided
  if (obj === null || typeof obj === 'undefined') {
    return;
  }

  // Force an array if not already something iterable
  if (typeof obj !== 'object') {
    /*eslint no-param-reassign:0*/
    obj = [obj];
  }

  if (isArray(obj)) {
    // Iterate over array values
    for (var i = 0, l = obj.length; i < l; i++) {
      fn.call(null, obj[i], i, obj);
    }
  } else {
    // Iterate over object keys
    for (var key in obj) {
      if (Object.prototype.hasOwnProperty.call(obj, key)) {
        fn.call(null, obj[key], key, obj);
      }
    }
  }
}

/**
 * Accepts varargs expecting each argument to be an object, then
 * immutably merges the properties of each object and returns result.
 *
 * When multiple objects contain the same key the later object in
 * the arguments list will take precedence.
 *
 * Example:
 *
 * ```js
 * var result = merge({foo: 123}, {foo: 456});
 * console.log(result.foo); // outputs 456
 * ```
 *
 * @param {Object} obj1 Object to merge
 * @returns {Object} Result of all merge properties
 */
function merge(/* obj1, obj2, obj3, ... */) {
  var result = {};
  function assignValue(val, key) {
    if (typeof result[key] === 'object' && typeof val === 'object') {
      result[key] = merge(result[key], val);
    } else {
      result[key] = val;
    }
  }

  for (var i = 0, l = arguments.length; i < l; i++) {
    forEach(arguments[i], assignValue);
  }
  return result;
}

/**
 * Extends object a by mutably adding to it the properties of object b.
 *
 * @param {Object} a The object to be extended
 * @param {Object} b The object to copy properties from
 * @param {Object} thisArg The object to bind function to
 * @return {Object} The resulting value of object a
 */
function extend(a, b, thisArg) {
  forEach(b, function assignValue(val, key) {
    if (thisArg && typeof val === 'function') {
      a[key] = bind(val, thisArg);
    } else {
      a[key] = val;
    }
  });
  return a;
}

module.exports = {
  isArray: isArray,
  isArrayBuffer: isArrayBuffer,
  isBuffer: isBuffer,
  isFormData: isFormData,
  isArrayBufferView: isArrayBufferView,
  isString: isString,
  isNumber: isNumber,
  isObject: isObject,
  isUndefined: isUndefined,
  isDate: isDate,
  isFile: isFile,
  isBlob: isBlob,
  isFunction: isFunction,
  isStream: isStream,
  isURLSearchParams: isURLSearchParams,
  isStandardBrowserEnv: isStandardBrowserEnv,
  forEach: forEach,
  merge: merge,
  extend: extend,
  trim: trim
};


/***/ }),

/***/ "./node_modules/events/events.js":
/*!***************************************!*\
  !*** ./node_modules/events/events.js ***!
  \***************************************/
/*! no static exports found */
/***/ (function(module, exports) {

// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.

function EventEmitter() {
  this._events = this._events || {};
  this._maxListeners = this._maxListeners || undefined;
}
module.exports = EventEmitter;

// Backwards-compat with node 0.10.x
EventEmitter.EventEmitter = EventEmitter;

EventEmitter.prototype._events = undefined;
EventEmitter.prototype._maxListeners = undefined;

// By default EventEmitters will print a warning if more than 10 listeners are
// added to it. This is a useful default which helps finding memory leaks.
EventEmitter.defaultMaxListeners = 10;

// Obviously not all Emitters should be limited to 10. This function allows
// that to be increased. Set to zero for unlimited.
EventEmitter.prototype.setMaxListeners = function(n) {
  if (!isNumber(n) || n < 0 || isNaN(n))
    throw TypeError('n must be a positive number');
  this._maxListeners = n;
  return this;
};

EventEmitter.prototype.emit = function(type) {
  var er, handler, len, args, i, listeners;

  if (!this._events)
    this._events = {};

  // If there is no 'error' event listener then throw.
  if (type === 'error') {
    if (!this._events.error ||
        (isObject(this._events.error) && !this._events.error.length)) {
      er = arguments[1];
      if (er instanceof Error) {
        throw er; // Unhandled 'error' event
      } else {
        // At least give some kind of context to the user
        var err = new Error('Uncaught, unspecified "error" event. (' + er + ')');
        err.context = er;
        throw err;
      }
    }
  }

  handler = this._events[type];

  if (isUndefined(handler))
    return false;

  if (isFunction(handler)) {
    switch (arguments.length) {
      // fast cases
      case 1:
        handler.call(this);
        break;
      case 2:
        handler.call(this, arguments[1]);
        break;
      case 3:
        handler.call(this, arguments[1], arguments[2]);
        break;
      // slower
      default:
        args = Array.prototype.slice.call(arguments, 1);
        handler.apply(this, args);
    }
  } else if (isObject(handler)) {
    args = Array.prototype.slice.call(arguments, 1);
    listeners = handler.slice();
    len = listeners.length;
    for (i = 0; i < len; i++)
      listeners[i].apply(this, args);
  }

  return true;
};

EventEmitter.prototype.addListener = function(type, listener) {
  var m;

  if (!isFunction(listener))
    throw TypeError('listener must be a function');

  if (!this._events)
    this._events = {};

  // To avoid recursion in the case that type === "newListener"! Before
  // adding it to the listeners, first emit "newListener".
  if (this._events.newListener)
    this.emit('newListener', type,
              isFunction(listener.listener) ?
              listener.listener : listener);

  if (!this._events[type])
    // Optimize the case of one listener. Don't need the extra array object.
    this._events[type] = listener;
  else if (isObject(this._events[type]))
    // If we've already got an array, just append.
    this._events[type].push(listener);
  else
    // Adding the second element, need to change to array.
    this._events[type] = [this._events[type], listener];

  // Check for listener leak
  if (isObject(this._events[type]) && !this._events[type].warned) {
    if (!isUndefined(this._maxListeners)) {
      m = this._maxListeners;
    } else {
      m = EventEmitter.defaultMaxListeners;
    }

    if (m && m > 0 && this._events[type].length > m) {
      this._events[type].warned = true;
      console.error('(node) warning: possible EventEmitter memory ' +
                    'leak detected. %d listeners added. ' +
                    'Use emitter.setMaxListeners() to increase limit.',
                    this._events[type].length);
      if (typeof console.trace === 'function') {
        // not supported in IE 10
        console.trace();
      }
    }
  }

  return this;
};

EventEmitter.prototype.on = EventEmitter.prototype.addListener;

EventEmitter.prototype.once = function(type, listener) {
  if (!isFunction(listener))
    throw TypeError('listener must be a function');

  var fired = false;

  function g() {
    this.removeListener(type, g);

    if (!fired) {
      fired = true;
      listener.apply(this, arguments);
    }
  }

  g.listener = listener;
  this.on(type, g);

  return this;
};

// emits a 'removeListener' event iff the listener was removed
EventEmitter.prototype.removeListener = function(type, listener) {
  var list, position, length, i;

  if (!isFunction(listener))
    throw TypeError('listener must be a function');

  if (!this._events || !this._events[type])
    return this;

  list = this._events[type];
  length = list.length;
  position = -1;

  if (list === listener ||
      (isFunction(list.listener) && list.listener === listener)) {
    delete this._events[type];
    if (this._events.removeListener)
      this.emit('removeListener', type, listener);

  } else if (isObject(list)) {
    for (i = length; i-- > 0;) {
      if (list[i] === listener ||
          (list[i].listener && list[i].listener === listener)) {
        position = i;
        break;
      }
    }

    if (position < 0)
      return this;

    if (list.length === 1) {
      list.length = 0;
      delete this._events[type];
    } else {
      list.splice(position, 1);
    }

    if (this._events.removeListener)
      this.emit('removeListener', type, listener);
  }

  return this;
};

EventEmitter.prototype.removeAllListeners = function(type) {
  var key, listeners;

  if (!this._events)
    return this;

  // not listening for removeListener, no need to emit
  if (!this._events.removeListener) {
    if (arguments.length === 0)
      this._events = {};
    else if (this._events[type])
      delete this._events[type];
    return this;
  }

  // emit removeListener for all listeners on all events
  if (arguments.length === 0) {
    for (key in this._events) {
      if (key === 'removeListener') continue;
      this.removeAllListeners(key);
    }
    this.removeAllListeners('removeListener');
    this._events = {};
    return this;
  }

  listeners = this._events[type];

  if (isFunction(listeners)) {
    this.removeListener(type, listeners);
  } else if (listeners) {
    // LIFO order
    while (listeners.length)
      this.removeListener(type, listeners[listeners.length - 1]);
  }
  delete this._events[type];

  return this;
};

EventEmitter.prototype.listeners = function(type) {
  var ret;
  if (!this._events || !this._events[type])
    ret = [];
  else if (isFunction(this._events[type]))
    ret = [this._events[type]];
  else
    ret = this._events[type].slice();
  return ret;
};

EventEmitter.prototype.listenerCount = function(type) {
  if (this._events) {
    var evlistener = this._events[type];

    if (isFunction(evlistener))
      return 1;
    else if (evlistener)
      return evlistener.length;
  }
  return 0;
};

EventEmitter.listenerCount = function(emitter, type) {
  return emitter.listenerCount(type);
};

function isFunction(arg) {
  return typeof arg === 'function';
}

function isNumber(arg) {
  return typeof arg === 'number';
}

function isObject(arg) {
  return typeof arg === 'object' && arg !== null;
}

function isUndefined(arg) {
  return arg === void 0;
}


/***/ }),

/***/ "./node_modules/is-buffer/index.js":
/*!*****************************************!*\
  !*** ./node_modules/is-buffer/index.js ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports) {

/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */

// The _isBuffer check is for Safari 5-7 support, because it's missing
// Object.prototype.constructor. Remove this eventually
module.exports = function (obj) {
  return obj != null && (isBuffer(obj) || isSlowBuffer(obj) || !!obj._isBuffer)
}

function isBuffer (obj) {
  return !!obj.constructor && typeof obj.constructor.isBuffer === 'function' && obj.constructor.isBuffer(obj)
}

// For Node v0.10 support. Remove this eventually.
function isSlowBuffer (obj) {
  return typeof obj.readFloatLE === 'function' && typeof obj.slice === 'function' && isBuffer(obj.slice(0, 0))
}


/***/ }),

/***/ "./node_modules/js-base64/base64.js":
/*!******************************************!*\
  !*** ./node_modules/js-base64/base64.js ***!
  \******************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/*
 *  base64.js
 *
 *  Licensed under the BSD 3-Clause License.
 *    http://opensource.org/licenses/BSD-3-Clause
 *
 *  References:
 *    http://en.wikipedia.org/wiki/Base64
 */
;(function (global, factory) {
     true
        ? module.exports = factory(global)
        : undefined
}((
    typeof self !== 'undefined' ? self
        : typeof window !== 'undefined' ? window
        : typeof global !== 'undefined' ? global
: this
), function(global) {
    'use strict';
    // existing version for noConflict()
    var _Base64 = global.Base64;
    var version = "2.5.0";
    // if node.js and NOT React Native, we use Buffer
    var buffer;
    if ( true && module.exports) {
        try {
            buffer = eval("require('buffer').Buffer");
        } catch (err) {
            buffer = undefined;
        }
    }
    // constants
    var b64chars
        = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';
    var b64tab = function(bin) {
        var t = {};
        for (var i = 0, l = bin.length; i < l; i++) t[bin.charAt(i)] = i;
        return t;
    }(b64chars);
    var fromCharCode = String.fromCharCode;
    // encoder stuff
    var cb_utob = function(c) {
        if (c.length < 2) {
            var cc = c.charCodeAt(0);
            return cc < 0x80 ? c
                : cc < 0x800 ? (fromCharCode(0xc0 | (cc >>> 6))
                                + fromCharCode(0x80 | (cc & 0x3f)))
                : (fromCharCode(0xe0 | ((cc >>> 12) & 0x0f))
                   + fromCharCode(0x80 | ((cc >>>  6) & 0x3f))
                   + fromCharCode(0x80 | ( cc         & 0x3f)));
        } else {
            var cc = 0x10000
                + (c.charCodeAt(0) - 0xD800) * 0x400
                + (c.charCodeAt(1) - 0xDC00);
            return (fromCharCode(0xf0 | ((cc >>> 18) & 0x07))
                    + fromCharCode(0x80 | ((cc >>> 12) & 0x3f))
                    + fromCharCode(0x80 | ((cc >>>  6) & 0x3f))
                    + fromCharCode(0x80 | ( cc         & 0x3f)));
        }
    };
    var re_utob = /[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g;
    var utob = function(u) {
        return u.replace(re_utob, cb_utob);
    };
    var cb_encode = function(ccc) {
        var padlen = [0, 2, 1][ccc.length % 3],
        ord = ccc.charCodeAt(0) << 16
            | ((ccc.length > 1 ? ccc.charCodeAt(1) : 0) << 8)
            | ((ccc.length > 2 ? ccc.charCodeAt(2) : 0)),
        chars = [
            b64chars.charAt( ord >>> 18),
            b64chars.charAt((ord >>> 12) & 63),
            padlen >= 2 ? '=' : b64chars.charAt((ord >>> 6) & 63),
            padlen >= 1 ? '=' : b64chars.charAt(ord & 63)
        ];
        return chars.join('');
    };
    var btoa = global.btoa ? function(b) {
        return global.btoa(b);
    } : function(b) {
        return b.replace(/[\s\S]{1,3}/g, cb_encode);
    };
    var _encode = buffer ?
        buffer.from && Uint8Array && buffer.from !== Uint8Array.from
        ? function (u) {
            return (u.constructor === buffer.constructor ? u : buffer.from(u))
                .toString('base64')
        }
        :  function (u) {
            return (u.constructor === buffer.constructor ? u : new  buffer(u))
                .toString('base64')
        }
        : function (u) { return btoa(utob(u)) }
    ;
    var encode = function(u, urisafe) {
        return !urisafe
            ? _encode(String(u))
            : _encode(String(u)).replace(/[+\/]/g, function(m0) {
                return m0 == '+' ? '-' : '_';
            }).replace(/=/g, '');
    };
    var encodeURI = function(u) { return encode(u, true) };
    // decoder stuff
    var re_btou = new RegExp([
        '[\xC0-\xDF][\x80-\xBF]',
        '[\xE0-\xEF][\x80-\xBF]{2}',
        '[\xF0-\xF7][\x80-\xBF]{3}'
    ].join('|'), 'g');
    var cb_btou = function(cccc) {
        switch(cccc.length) {
        case 4:
            var cp = ((0x07 & cccc.charCodeAt(0)) << 18)
                |    ((0x3f & cccc.charCodeAt(1)) << 12)
                |    ((0x3f & cccc.charCodeAt(2)) <<  6)
                |     (0x3f & cccc.charCodeAt(3)),
            offset = cp - 0x10000;
            return (fromCharCode((offset  >>> 10) + 0xD800)
                    + fromCharCode((offset & 0x3FF) + 0xDC00));
        case 3:
            return fromCharCode(
                ((0x0f & cccc.charCodeAt(0)) << 12)
                    | ((0x3f & cccc.charCodeAt(1)) << 6)
                    |  (0x3f & cccc.charCodeAt(2))
            );
        default:
            return  fromCharCode(
                ((0x1f & cccc.charCodeAt(0)) << 6)
                    |  (0x3f & cccc.charCodeAt(1))
            );
        }
    };
    var btou = function(b) {
        return b.replace(re_btou, cb_btou);
    };
    var cb_decode = function(cccc) {
        var len = cccc.length,
        padlen = len % 4,
        n = (len > 0 ? b64tab[cccc.charAt(0)] << 18 : 0)
            | (len > 1 ? b64tab[cccc.charAt(1)] << 12 : 0)
            | (len > 2 ? b64tab[cccc.charAt(2)] <<  6 : 0)
            | (len > 3 ? b64tab[cccc.charAt(3)]       : 0),
        chars = [
            fromCharCode( n >>> 16),
            fromCharCode((n >>>  8) & 0xff),
            fromCharCode( n         & 0xff)
        ];
        chars.length -= [0, 0, 2, 1][padlen];
        return chars.join('');
    };
    var _atob = global.atob ? function(a) {
        return global.atob(a);
    } : function(a){
        return a.replace(/\S{1,4}/g, cb_decode);
    };
    var atob = function(a) {
        return _atob(String(a).replace(/[^A-Za-z0-9\+\/]/g, ''));
    };
    var _decode = buffer ?
        buffer.from && Uint8Array && buffer.from !== Uint8Array.from
        ? function(a) {
            return (a.constructor === buffer.constructor
                    ? a : buffer.from(a, 'base64')).toString();
        }
        : function(a) {
            return (a.constructor === buffer.constructor
                    ? a : new buffer(a, 'base64')).toString();
        }
        : function(a) { return btou(_atob(a)) };
    var decode = function(a){
        return _decode(
            String(a).replace(/[-_]/g, function(m0) { return m0 == '-' ? '+' : '/' })
                .replace(/[^A-Za-z0-9\+\/]/g, '')
        );
    };
    var noConflict = function() {
        var Base64 = global.Base64;
        global.Base64 = _Base64;
        return Base64;
    };
    // export Base64
    global.Base64 = {
        VERSION: version,
        atob: atob,
        btoa: btoa,
        fromBase64: decode,
        toBase64: encode,
        utob: utob,
        encode: encode,
        encodeURI: encodeURI,
        btou: btou,
        decode: decode,
        noConflict: noConflict,
        __buffer__: buffer
    };
    // if ES5 is available, make Base64.extendString() available
    if (typeof Object.defineProperty === 'function') {
        var noEnum = function(v){
            return {value:v,enumerable:false,writable:true,configurable:true};
        };
        global.Base64.extendString = function () {
            Object.defineProperty(
                String.prototype, 'fromBase64', noEnum(function () {
                    return decode(this)
                }));
            Object.defineProperty(
                String.prototype, 'toBase64', noEnum(function (urisafe) {
                    return encode(this, urisafe)
                }));
            Object.defineProperty(
                String.prototype, 'toBase64URI', noEnum(function () {
                    return encode(this, true)
                }));
        };
    }
    //
    // export Base64 to the namespace
    //
    if (global['Meteor']) { // Meteor.js
        Base64 = global.Base64;
    }
    // module.exports and AMD are mutually exclusive.
    // module.exports has precedence.
    if ( true && module.exports) {
        module.exports.Base64 = global.Base64;
    }
    else if (true) {
        // AMD. Register as an anonymous module.
        !(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_RESULT__ = (function(){ return global.Base64 }).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
    }
    // that's it!
    return {Base64: global.Base64}
}));

/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../webpack/buildin/global.js */ "./node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "./node_modules/lodash/_DataView.js":
/*!******************************************!*\
  !*** ./node_modules/lodash/_DataView.js ***!
  \******************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var getNative = __webpack_require__(/*! ./_getNative */ "./node_modules/lodash/_getNative.js"),
    root = __webpack_require__(/*! ./_root */ "./node_modules/lodash/_root.js");

/* Built-in method references that are verified to be native. */
var DataView = getNative(root, 'DataView');

module.exports = DataView;


/***/ }),

/***/ "./node_modules/lodash/_Map.js":
/*!*************************************!*\
  !*** ./node_modules/lodash/_Map.js ***!
  \*************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var getNative = __webpack_require__(/*! ./_getNative */ "./node_modules/lodash/_getNative.js"),
    root = __webpack_require__(/*! ./_root */ "./node_modules/lodash/_root.js");

/* Built-in method references that are verified to be native. */
var Map = getNative(root, 'Map');

module.exports = Map;


/***/ }),

/***/ "./node_modules/lodash/_Promise.js":
/*!*****************************************!*\
  !*** ./node_modules/lodash/_Promise.js ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var getNative = __webpack_require__(/*! ./_getNative */ "./node_modules/lodash/_getNative.js"),
    root = __webpack_require__(/*! ./_root */ "./node_modules/lodash/_root.js");

/* Built-in method references that are verified to be native. */
var Promise = getNative(root, 'Promise');

module.exports = Promise;


/***/ }),

/***/ "./node_modules/lodash/_Set.js":
/*!*************************************!*\
  !*** ./node_modules/lodash/_Set.js ***!
  \*************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var getNative = __webpack_require__(/*! ./_getNative */ "./node_modules/lodash/_getNative.js"),
    root = __webpack_require__(/*! ./_root */ "./node_modules/lodash/_root.js");

/* Built-in method references that are verified to be native. */
var Set = getNative(root, 'Set');

module.exports = Set;


/***/ }),

/***/ "./node_modules/lodash/_Symbol.js":
/*!****************************************!*\
  !*** ./node_modules/lodash/_Symbol.js ***!
  \****************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var root = __webpack_require__(/*! ./_root */ "./node_modules/lodash/_root.js");

/** Built-in value references. */
var Symbol = root.Symbol;

module.exports = Symbol;


/***/ }),

/***/ "./node_modules/lodash/_WeakMap.js":
/*!*****************************************!*\
  !*** ./node_modules/lodash/_WeakMap.js ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var getNative = __webpack_require__(/*! ./_getNative */ "./node_modules/lodash/_getNative.js"),
    root = __webpack_require__(/*! ./_root */ "./node_modules/lodash/_root.js");

/* Built-in method references that are verified to be native. */
var WeakMap = getNative(root, 'WeakMap');

module.exports = WeakMap;


/***/ }),

/***/ "./node_modules/lodash/_baseGetTag.js":
/*!********************************************!*\
  !*** ./node_modules/lodash/_baseGetTag.js ***!
  \********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var Symbol = __webpack_require__(/*! ./_Symbol */ "./node_modules/lodash/_Symbol.js"),
    getRawTag = __webpack_require__(/*! ./_getRawTag */ "./node_modules/lodash/_getRawTag.js"),
    objectToString = __webpack_require__(/*! ./_objectToString */ "./node_modules/lodash/_objectToString.js");

/** `Object#toString` result references. */
var nullTag = '[object Null]',
    undefinedTag = '[object Undefined]';

/** Built-in value references. */
var symToStringTag = Symbol ? Symbol.toStringTag : undefined;

/**
 * The base implementation of `getTag` without fallbacks for buggy environments.
 *
 * @private
 * @param {*} value The value to query.
 * @returns {string} Returns the `toStringTag`.
 */
function baseGetTag(value) {
  if (value == null) {
    return value === undefined ? undefinedTag : nullTag;
  }
  return (symToStringTag && symToStringTag in Object(value))
    ? getRawTag(value)
    : objectToString(value);
}

module.exports = baseGetTag;


/***/ }),

/***/ "./node_modules/lodash/_baseIsArguments.js":
/*!*************************************************!*\
  !*** ./node_modules/lodash/_baseIsArguments.js ***!
  \*************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var baseGetTag = __webpack_require__(/*! ./_baseGetTag */ "./node_modules/lodash/_baseGetTag.js"),
    isObjectLike = __webpack_require__(/*! ./isObjectLike */ "./node_modules/lodash/isObjectLike.js");

/** `Object#toString` result references. */
var argsTag = '[object Arguments]';

/**
 * The base implementation of `_.isArguments`.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an `arguments` object,
 */
function baseIsArguments(value) {
  return isObjectLike(value) && baseGetTag(value) == argsTag;
}

module.exports = baseIsArguments;


/***/ }),

/***/ "./node_modules/lodash/_baseIsNative.js":
/*!**********************************************!*\
  !*** ./node_modules/lodash/_baseIsNative.js ***!
  \**********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var isFunction = __webpack_require__(/*! ./isFunction */ "./node_modules/lodash/isFunction.js"),
    isMasked = __webpack_require__(/*! ./_isMasked */ "./node_modules/lodash/_isMasked.js"),
    isObject = __webpack_require__(/*! ./isObject */ "./node_modules/lodash/isObject.js"),
    toSource = __webpack_require__(/*! ./_toSource */ "./node_modules/lodash/_toSource.js");

/**
 * Used to match `RegExp`
 * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).
 */
var reRegExpChar = /[\\^$.*+?()[\]{}|]/g;

/** Used to detect host constructors (Safari). */
var reIsHostCtor = /^\[object .+?Constructor\]$/;

/** Used for built-in method references. */
var funcProto = Function.prototype,
    objectProto = Object.prototype;

/** Used to resolve the decompiled source of functions. */
var funcToString = funcProto.toString;

/** Used to check objects for own properties. */
var hasOwnProperty = objectProto.hasOwnProperty;

/** Used to detect if a method is native. */
var reIsNative = RegExp('^' +
  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\$&')
  .replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g, '$1.*?') + '$'
);

/**
 * The base implementation of `_.isNative` without bad shim checks.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a native function,
 *  else `false`.
 */
function baseIsNative(value) {
  if (!isObject(value) || isMasked(value)) {
    return false;
  }
  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;
  return pattern.test(toSource(value));
}

module.exports = baseIsNative;


/***/ }),

/***/ "./node_modules/lodash/_baseIsTypedArray.js":
/*!**************************************************!*\
  !*** ./node_modules/lodash/_baseIsTypedArray.js ***!
  \**************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var baseGetTag = __webpack_require__(/*! ./_baseGetTag */ "./node_modules/lodash/_baseGetTag.js"),
    isLength = __webpack_require__(/*! ./isLength */ "./node_modules/lodash/isLength.js"),
    isObjectLike = __webpack_require__(/*! ./isObjectLike */ "./node_modules/lodash/isObjectLike.js");

/** `Object#toString` result references. */
var argsTag = '[object Arguments]',
    arrayTag = '[object Array]',
    boolTag = '[object Boolean]',
    dateTag = '[object Date]',
    errorTag = '[object Error]',
    funcTag = '[object Function]',
    mapTag = '[object Map]',
    numberTag = '[object Number]',
    objectTag = '[object Object]',
    regexpTag = '[object RegExp]',
    setTag = '[object Set]',
    stringTag = '[object String]',
    weakMapTag = '[object WeakMap]';

var arrayBufferTag = '[object ArrayBuffer]',
    dataViewTag = '[object DataView]',
    float32Tag = '[object Float32Array]',
    float64Tag = '[object Float64Array]',
    int8Tag = '[object Int8Array]',
    int16Tag = '[object Int16Array]',
    int32Tag = '[object Int32Array]',
    uint8Tag = '[object Uint8Array]',
    uint8ClampedTag = '[object Uint8ClampedArray]',
    uint16Tag = '[object Uint16Array]',
    uint32Tag = '[object Uint32Array]';

/** Used to identify `toStringTag` values of typed arrays. */
var typedArrayTags = {};
typedArrayTags[float32Tag] = typedArrayTags[float64Tag] =
typedArrayTags[int8Tag] = typedArrayTags[int16Tag] =
typedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =
typedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =
typedArrayTags[uint32Tag] = true;
typedArrayTags[argsTag] = typedArrayTags[arrayTag] =
typedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =
typedArrayTags[dataViewTag] = typedArrayTags[dateTag] =
typedArrayTags[errorTag] = typedArrayTags[funcTag] =
typedArrayTags[mapTag] = typedArrayTags[numberTag] =
typedArrayTags[objectTag] = typedArrayTags[regexpTag] =
typedArrayTags[setTag] = typedArrayTags[stringTag] =
typedArrayTags[weakMapTag] = false;

/**
 * The base implementation of `_.isTypedArray` without Node.js optimizations.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.
 */
function baseIsTypedArray(value) {
  return isObjectLike(value) &&
    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];
}

module.exports = baseIsTypedArray;


/***/ }),

/***/ "./node_modules/lodash/_baseKeys.js":
/*!******************************************!*\
  !*** ./node_modules/lodash/_baseKeys.js ***!
  \******************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var isPrototype = __webpack_require__(/*! ./_isPrototype */ "./node_modules/lodash/_isPrototype.js"),
    nativeKeys = __webpack_require__(/*! ./_nativeKeys */ "./node_modules/lodash/_nativeKeys.js");

/** Used for built-in method references. */
var objectProto = Object.prototype;

/** Used to check objects for own properties. */
var hasOwnProperty = objectProto.hasOwnProperty;

/**
 * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.
 *
 * @private
 * @param {Object} object The object to query.
 * @returns {Array} Returns the array of property names.
 */
function baseKeys(object) {
  if (!isPrototype(object)) {
    return nativeKeys(object);
  }
  var result = [];
  for (var key in Object(object)) {
    if (hasOwnProperty.call(object, key) && key != 'constructor') {
      result.push(key);
    }
  }
  return result;
}

module.exports = baseKeys;


/***/ }),

/***/ "./node_modules/lodash/_baseTimes.js":
/*!*******************************************!*\
  !*** ./node_modules/lodash/_baseTimes.js ***!
  \*******************************************/
/*! no static exports found */
/***/ (function(module, exports) {

/**
 * The base implementation of `_.times` without support for iteratee shorthands
 * or max array length checks.
 *
 * @private
 * @param {number} n The number of times to invoke `iteratee`.
 * @param {Function} iteratee The function invoked per iteration.
 * @returns {Array} Returns the array of results.
 */
function baseTimes(n, iteratee) {
  var index = -1,
      result = Array(n);

  while (++index < n) {
    result[index] = iteratee(index);
  }
  return result;
}

module.exports = baseTimes;


/***/ }),

/***/ "./node_modules/lodash/_baseUnary.js":
/*!*******************************************!*\
  !*** ./node_modules/lodash/_baseUnary.js ***!
  \*******************************************/
/*! no static exports found */
/***/ (function(module, exports) {

/**
 * The base implementation of `_.unary` without support for storing metadata.
 *
 * @private
 * @param {Function} func The function to cap arguments for.
 * @returns {Function} Returns the new capped function.
 */
function baseUnary(func) {
  return function(value) {
    return func(value);
  };
}

module.exports = baseUnary;


/***/ }),

/***/ "./node_modules/lodash/_castFunction.js":
/*!**********************************************!*\
  !*** ./node_modules/lodash/_castFunction.js ***!
  \**********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var identity = __webpack_require__(/*! ./identity */ "./node_modules/lodash/identity.js");

/**
 * Casts `value` to `identity` if it's not a function.
 *
 * @private
 * @param {*} value The value to inspect.
 * @returns {Function} Returns cast function.
 */
function castFunction(value) {
  return typeof value == 'function' ? value : identity;
}

module.exports = castFunction;


/***/ }),

/***/ "./node_modules/lodash/_coreJsData.js":
/*!********************************************!*\
  !*** ./node_modules/lodash/_coreJsData.js ***!
  \********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var root = __webpack_require__(/*! ./_root */ "./node_modules/lodash/_root.js");

/** Used to detect overreaching core-js shims. */
var coreJsData = root['__core-js_shared__'];

module.exports = coreJsData;


/***/ }),

/***/ "./node_modules/lodash/_freeGlobal.js":
/*!********************************************!*\
  !*** ./node_modules/lodash/_freeGlobal.js ***!
  \********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {/** Detect free variable `global` from Node.js. */
var freeGlobal = typeof global == 'object' && global && global.Object === Object && global;

module.exports = freeGlobal;

/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../webpack/buildin/global.js */ "./node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "./node_modules/lodash/_getNative.js":
/*!*******************************************!*\
  !*** ./node_modules/lodash/_getNative.js ***!
  \*******************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var baseIsNative = __webpack_require__(/*! ./_baseIsNative */ "./node_modules/lodash/_baseIsNative.js"),
    getValue = __webpack_require__(/*! ./_getValue */ "./node_modules/lodash/_getValue.js");

/**
 * Gets the native function at `key` of `object`.
 *
 * @private
 * @param {Object} object The object to query.
 * @param {string} key The key of the method to get.
 * @returns {*} Returns the function if it's native, else `undefined`.
 */
function getNative(object, key) {
  var value = getValue(object, key);
  return baseIsNative(value) ? value : undefined;
}

module.exports = getNative;


/***/ }),

/***/ "./node_modules/lodash/_getPrototype.js":
/*!**********************************************!*\
  !*** ./node_modules/lodash/_getPrototype.js ***!
  \**********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var overArg = __webpack_require__(/*! ./_overArg */ "./node_modules/lodash/_overArg.js");

/** Built-in value references. */
var getPrototype = overArg(Object.getPrototypeOf, Object);

module.exports = getPrototype;


/***/ }),

/***/ "./node_modules/lodash/_getRawTag.js":
/*!*******************************************!*\
  !*** ./node_modules/lodash/_getRawTag.js ***!
  \*******************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var Symbol = __webpack_require__(/*! ./_Symbol */ "./node_modules/lodash/_Symbol.js");

/** Used for built-in method references. */
var objectProto = Object.prototype;

/** Used to check objects for own properties. */
var hasOwnProperty = objectProto.hasOwnProperty;

/**
 * Used to resolve the
 * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)
 * of values.
 */
var nativeObjectToString = objectProto.toString;

/** Built-in value references. */
var symToStringTag = Symbol ? Symbol.toStringTag : undefined;

/**
 * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.
 *
 * @private
 * @param {*} value The value to query.
 * @returns {string} Returns the raw `toStringTag`.
 */
function getRawTag(value) {
  var isOwn = hasOwnProperty.call(value, symToStringTag),
      tag = value[symToStringTag];

  try {
    value[symToStringTag] = undefined;
    var unmasked = true;
  } catch (e) {}

  var result = nativeObjectToString.call(value);
  if (unmasked) {
    if (isOwn) {
      value[symToStringTag] = tag;
    } else {
      delete value[symToStringTag];
    }
  }
  return result;
}

module.exports = getRawTag;


/***/ }),

/***/ "./node_modules/lodash/_getTag.js":
/*!****************************************!*\
  !*** ./node_modules/lodash/_getTag.js ***!
  \****************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var DataView = __webpack_require__(/*! ./_DataView */ "./node_modules/lodash/_DataView.js"),
    Map = __webpack_require__(/*! ./_Map */ "./node_modules/lodash/_Map.js"),
    Promise = __webpack_require__(/*! ./_Promise */ "./node_modules/lodash/_Promise.js"),
    Set = __webpack_require__(/*! ./_Set */ "./node_modules/lodash/_Set.js"),
    WeakMap = __webpack_require__(/*! ./_WeakMap */ "./node_modules/lodash/_WeakMap.js"),
    baseGetTag = __webpack_require__(/*! ./_baseGetTag */ "./node_modules/lodash/_baseGetTag.js"),
    toSource = __webpack_require__(/*! ./_toSource */ "./node_modules/lodash/_toSource.js");

/** `Object#toString` result references. */
var mapTag = '[object Map]',
    objectTag = '[object Object]',
    promiseTag = '[object Promise]',
    setTag = '[object Set]',
    weakMapTag = '[object WeakMap]';

var dataViewTag = '[object DataView]';

/** Used to detect maps, sets, and weakmaps. */
var dataViewCtorString = toSource(DataView),
    mapCtorString = toSource(Map),
    promiseCtorString = toSource(Promise),
    setCtorString = toSource(Set),
    weakMapCtorString = toSource(WeakMap);

/**
 * Gets the `toStringTag` of `value`.
 *
 * @private
 * @param {*} value The value to query.
 * @returns {string} Returns the `toStringTag`.
 */
var getTag = baseGetTag;

// Fallback for data views, maps, sets, and weak maps in IE 11 and promises in Node.js < 6.
if ((DataView && getTag(new DataView(new ArrayBuffer(1))) != dataViewTag) ||
    (Map && getTag(new Map) != mapTag) ||
    (Promise && getTag(Promise.resolve()) != promiseTag) ||
    (Set && getTag(new Set) != setTag) ||
    (WeakMap && getTag(new WeakMap) != weakMapTag)) {
  getTag = function(value) {
    var result = baseGetTag(value),
        Ctor = result == objectTag ? value.constructor : undefined,
        ctorString = Ctor ? toSource(Ctor) : '';

    if (ctorString) {
      switch (ctorString) {
        case dataViewCtorString: return dataViewTag;
        case mapCtorString: return mapTag;
        case promiseCtorString: return promiseTag;
        case setCtorString: return setTag;
        case weakMapCtorString: return weakMapTag;
      }
    }
    return result;
  };
}

module.exports = getTag;


/***/ }),

/***/ "./node_modules/lodash/_getValue.js":
/*!******************************************!*\
  !*** ./node_modules/lodash/_getValue.js ***!
  \******************************************/
/*! no static exports found */
/***/ (function(module, exports) {

/**
 * Gets the value at `key` of `object`.
 *
 * @private
 * @param {Object} [object] The object to query.
 * @param {string} key The key of the property to get.
 * @returns {*} Returns the property value.
 */
function getValue(object, key) {
  return object == null ? undefined : object[key];
}

module.exports = getValue;


/***/ }),

/***/ "./node_modules/lodash/_isMasked.js":
/*!******************************************!*\
  !*** ./node_modules/lodash/_isMasked.js ***!
  \******************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var coreJsData = __webpack_require__(/*! ./_coreJsData */ "./node_modules/lodash/_coreJsData.js");

/** Used to detect methods masquerading as native. */
var maskSrcKey = (function() {
  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');
  return uid ? ('Symbol(src)_1.' + uid) : '';
}());

/**
 * Checks if `func` has its source masked.
 *
 * @private
 * @param {Function} func The function to check.
 * @returns {boolean} Returns `true` if `func` is masked, else `false`.
 */
function isMasked(func) {
  return !!maskSrcKey && (maskSrcKey in func);
}

module.exports = isMasked;


/***/ }),

/***/ "./node_modules/lodash/_isPrototype.js":
/*!*********************************************!*\
  !*** ./node_modules/lodash/_isPrototype.js ***!
  \*********************************************/
/*! no static exports found */
/***/ (function(module, exports) {

/** Used for built-in method references. */
var objectProto = Object.prototype;

/**
 * Checks if `value` is likely a prototype object.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.
 */
function isPrototype(value) {
  var Ctor = value && value.constructor,
      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;

  return value === proto;
}

module.exports = isPrototype;


/***/ }),

/***/ "./node_modules/lodash/_nativeKeys.js":
/*!********************************************!*\
  !*** ./node_modules/lodash/_nativeKeys.js ***!
  \********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var overArg = __webpack_require__(/*! ./_overArg */ "./node_modules/lodash/_overArg.js");

/* Built-in method references for those with the same name as other `lodash` methods. */
var nativeKeys = overArg(Object.keys, Object);

module.exports = nativeKeys;


/***/ }),

/***/ "./node_modules/lodash/_nodeUtil.js":
/*!******************************************!*\
  !*** ./node_modules/lodash/_nodeUtil.js ***!
  \******************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(module) {var freeGlobal = __webpack_require__(/*! ./_freeGlobal */ "./node_modules/lodash/_freeGlobal.js");

/** Detect free variable `exports`. */
var freeExports =  true && exports && !exports.nodeType && exports;

/** Detect free variable `module`. */
var freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;

/** Detect the popular CommonJS extension `module.exports`. */
var moduleExports = freeModule && freeModule.exports === freeExports;

/** Detect free variable `process` from Node.js. */
var freeProcess = moduleExports && freeGlobal.process;

/** Used to access faster Node.js helpers. */
var nodeUtil = (function() {
  try {
    // Use `util.types` for Node.js 10+.
    var types = freeModule && freeModule.require && freeModule.require('util').types;

    if (types) {
      return types;
    }

    // Legacy `process.binding('util')` for Node.js < 10.
    return freeProcess && freeProcess.binding && freeProcess.binding('util');
  } catch (e) {}
}());

module.exports = nodeUtil;

/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../webpack/buildin/module.js */ "./node_modules/webpack/buildin/module.js")(module)))

/***/ }),

/***/ "./node_modules/lodash/_objectToString.js":
/*!************************************************!*\
  !*** ./node_modules/lodash/_objectToString.js ***!
  \************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

/** Used for built-in method references. */
var objectProto = Object.prototype;

/**
 * Used to resolve the
 * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)
 * of values.
 */
var nativeObjectToString = objectProto.toString;

/**
 * Converts `value` to a string using `Object.prototype.toString`.
 *
 * @private
 * @param {*} value The value to convert.
 * @returns {string} Returns the converted string.
 */
function objectToString(value) {
  return nativeObjectToString.call(value);
}

module.exports = objectToString;


/***/ }),

/***/ "./node_modules/lodash/_overArg.js":
/*!*****************************************!*\
  !*** ./node_modules/lodash/_overArg.js ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports) {

/**
 * Creates a unary function that invokes `func` with its argument transformed.
 *
 * @private
 * @param {Function} func The function to wrap.
 * @param {Function} transform The argument transform.
 * @returns {Function} Returns the new function.
 */
function overArg(func, transform) {
  return function(arg) {
    return func(transform(arg));
  };
}

module.exports = overArg;


/***/ }),

/***/ "./node_modules/lodash/_root.js":
/*!**************************************!*\
  !*** ./node_modules/lodash/_root.js ***!
  \**************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var freeGlobal = __webpack_require__(/*! ./_freeGlobal */ "./node_modules/lodash/_freeGlobal.js");

/** Detect free variable `self`. */
var freeSelf = typeof self == 'object' && self && self.Object === Object && self;

/** Used as a reference to the global object. */
var root = freeGlobal || freeSelf || Function('return this')();

module.exports = root;


/***/ }),

/***/ "./node_modules/lodash/_toSource.js":
/*!******************************************!*\
  !*** ./node_modules/lodash/_toSource.js ***!
  \******************************************/
/*! no static exports found */
/***/ (function(module, exports) {

/** Used for built-in method references. */
var funcProto = Function.prototype;

/** Used to resolve the decompiled source of functions. */
var funcToString = funcProto.toString;

/**
 * Converts `func` to its source code.
 *
 * @private
 * @param {Function} func The function to convert.
 * @returns {string} Returns the source code.
 */
function toSource(func) {
  if (func != null) {
    try {
      return funcToString.call(func);
    } catch (e) {}
    try {
      return (func + '');
    } catch (e) {}
  }
  return '';
}

module.exports = toSource;


/***/ }),

/***/ "./node_modules/lodash/identity.js":
/*!*****************************************!*\
  !*** ./node_modules/lodash/identity.js ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports) {

/**
 * This method returns the first argument it receives.
 *
 * @static
 * @since 0.1.0
 * @memberOf _
 * @category Util
 * @param {*} value Any value.
 * @returns {*} Returns `value`.
 * @example
 *
 * var object = { 'a': 1 };
 *
 * console.log(_.identity(object) === object);
 * // => true
 */
function identity(value) {
  return value;
}

module.exports = identity;


/***/ }),

/***/ "./node_modules/lodash/isArguments.js":
/*!********************************************!*\
  !*** ./node_modules/lodash/isArguments.js ***!
  \********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var baseIsArguments = __webpack_require__(/*! ./_baseIsArguments */ "./node_modules/lodash/_baseIsArguments.js"),
    isObjectLike = __webpack_require__(/*! ./isObjectLike */ "./node_modules/lodash/isObjectLike.js");

/** Used for built-in method references. */
var objectProto = Object.prototype;

/** Used to check objects for own properties. */
var hasOwnProperty = objectProto.hasOwnProperty;

/** Built-in value references. */
var propertyIsEnumerable = objectProto.propertyIsEnumerable;

/**
 * Checks if `value` is likely an `arguments` object.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an `arguments` object,
 *  else `false`.
 * @example
 *
 * _.isArguments(function() { return arguments; }());
 * // => true
 *
 * _.isArguments([1, 2, 3]);
 * // => false
 */
var isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {
  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&
    !propertyIsEnumerable.call(value, 'callee');
};

module.exports = isArguments;


/***/ }),

/***/ "./node_modules/lodash/isArray.js":
/*!****************************************!*\
  !*** ./node_modules/lodash/isArray.js ***!
  \****************************************/
/*! no static exports found */
/***/ (function(module, exports) {

/**
 * Checks if `value` is classified as an `Array` object.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an array, else `false`.
 * @example
 *
 * _.isArray([1, 2, 3]);
 * // => true
 *
 * _.isArray(document.body.children);
 * // => false
 *
 * _.isArray('abc');
 * // => false
 *
 * _.isArray(_.noop);
 * // => false
 */
var isArray = Array.isArray;

module.exports = isArray;


/***/ }),

/***/ "./node_modules/lodash/isArrayLike.js":
/*!********************************************!*\
  !*** ./node_modules/lodash/isArrayLike.js ***!
  \********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var isFunction = __webpack_require__(/*! ./isFunction */ "./node_modules/lodash/isFunction.js"),
    isLength = __webpack_require__(/*! ./isLength */ "./node_modules/lodash/isLength.js");

/**
 * Checks if `value` is array-like. A value is considered array-like if it's
 * not a function and has a `value.length` that's an integer greater than or
 * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is array-like, else `false`.
 * @example
 *
 * _.isArrayLike([1, 2, 3]);
 * // => true
 *
 * _.isArrayLike(document.body.children);
 * // => true
 *
 * _.isArrayLike('abc');
 * // => true
 *
 * _.isArrayLike(_.noop);
 * // => false
 */
function isArrayLike(value) {
  return value != null && isLength(value.length) && !isFunction(value);
}

module.exports = isArrayLike;


/***/ }),

/***/ "./node_modules/lodash/isBuffer.js":
/*!*****************************************!*\
  !*** ./node_modules/lodash/isBuffer.js ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(module) {var root = __webpack_require__(/*! ./_root */ "./node_modules/lodash/_root.js"),
    stubFalse = __webpack_require__(/*! ./stubFalse */ "./node_modules/lodash/stubFalse.js");

/** Detect free variable `exports`. */
var freeExports =  true && exports && !exports.nodeType && exports;

/** Detect free variable `module`. */
var freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;

/** Detect the popular CommonJS extension `module.exports`. */
var moduleExports = freeModule && freeModule.exports === freeExports;

/** Built-in value references. */
var Buffer = moduleExports ? root.Buffer : undefined;

/* Built-in method references for those with the same name as other `lodash` methods. */
var nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined;

/**
 * Checks if `value` is a buffer.
 *
 * @static
 * @memberOf _
 * @since 4.3.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.
 * @example
 *
 * _.isBuffer(new Buffer(2));
 * // => true
 *
 * _.isBuffer(new Uint8Array(2));
 * // => false
 */
var isBuffer = nativeIsBuffer || stubFalse;

module.exports = isBuffer;

/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../webpack/buildin/module.js */ "./node_modules/webpack/buildin/module.js")(module)))

/***/ }),

/***/ "./node_modules/lodash/isEmpty.js":
/*!****************************************!*\
  !*** ./node_modules/lodash/isEmpty.js ***!
  \****************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var baseKeys = __webpack_require__(/*! ./_baseKeys */ "./node_modules/lodash/_baseKeys.js"),
    getTag = __webpack_require__(/*! ./_getTag */ "./node_modules/lodash/_getTag.js"),
    isArguments = __webpack_require__(/*! ./isArguments */ "./node_modules/lodash/isArguments.js"),
    isArray = __webpack_require__(/*! ./isArray */ "./node_modules/lodash/isArray.js"),
    isArrayLike = __webpack_require__(/*! ./isArrayLike */ "./node_modules/lodash/isArrayLike.js"),
    isBuffer = __webpack_require__(/*! ./isBuffer */ "./node_modules/lodash/isBuffer.js"),
    isPrototype = __webpack_require__(/*! ./_isPrototype */ "./node_modules/lodash/_isPrototype.js"),
    isTypedArray = __webpack_require__(/*! ./isTypedArray */ "./node_modules/lodash/isTypedArray.js");

/** `Object#toString` result references. */
var mapTag = '[object Map]',
    setTag = '[object Set]';

/** Used for built-in method references. */
var objectProto = Object.prototype;

/** Used to check objects for own properties. */
var hasOwnProperty = objectProto.hasOwnProperty;

/**
 * Checks if `value` is an empty object, collection, map, or set.
 *
 * Objects are considered empty if they have no own enumerable string keyed
 * properties.
 *
 * Array-like values such as `arguments` objects, arrays, buffers, strings, or
 * jQuery-like collections are considered empty if they have a `length` of `0`.
 * Similarly, maps and sets are considered empty if they have a `size` of `0`.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is empty, else `false`.
 * @example
 *
 * _.isEmpty(null);
 * // => true
 *
 * _.isEmpty(true);
 * // => true
 *
 * _.isEmpty(1);
 * // => true
 *
 * _.isEmpty([1, 2, 3]);
 * // => false
 *
 * _.isEmpty({ 'a': 1 });
 * // => false
 */
function isEmpty(value) {
  if (value == null) {
    return true;
  }
  if (isArrayLike(value) &&
      (isArray(value) || typeof value == 'string' || typeof value.splice == 'function' ||
        isBuffer(value) || isTypedArray(value) || isArguments(value))) {
    return !value.length;
  }
  var tag = getTag(value);
  if (tag == mapTag || tag == setTag) {
    return !value.size;
  }
  if (isPrototype(value)) {
    return !baseKeys(value).length;
  }
  for (var key in value) {
    if (hasOwnProperty.call(value, key)) {
      return false;
    }
  }
  return true;
}

module.exports = isEmpty;


/***/ }),

/***/ "./node_modules/lodash/isFunction.js":
/*!*******************************************!*\
  !*** ./node_modules/lodash/isFunction.js ***!
  \*******************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var baseGetTag = __webpack_require__(/*! ./_baseGetTag */ "./node_modules/lodash/_baseGetTag.js"),
    isObject = __webpack_require__(/*! ./isObject */ "./node_modules/lodash/isObject.js");

/** `Object#toString` result references. */
var asyncTag = '[object AsyncFunction]',
    funcTag = '[object Function]',
    genTag = '[object GeneratorFunction]',
    proxyTag = '[object Proxy]';

/**
 * Checks if `value` is classified as a `Function` object.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a function, else `false`.
 * @example
 *
 * _.isFunction(_);
 * // => true
 *
 * _.isFunction(/abc/);
 * // => false
 */
function isFunction(value) {
  if (!isObject(value)) {
    return false;
  }
  // The use of `Object#toString` avoids issues with the `typeof` operator
  // in Safari 9 which returns 'object' for typed arrays and other constructors.
  var tag = baseGetTag(value);
  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;
}

module.exports = isFunction;


/***/ }),

/***/ "./node_modules/lodash/isLength.js":
/*!*****************************************!*\
  !*** ./node_modules/lodash/isLength.js ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports) {

/** Used as references for various `Number` constants. */
var MAX_SAFE_INTEGER = 9007199254740991;

/**
 * Checks if `value` is a valid array-like length.
 *
 * **Note:** This method is loosely based on
 * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.
 * @example
 *
 * _.isLength(3);
 * // => true
 *
 * _.isLength(Number.MIN_VALUE);
 * // => false
 *
 * _.isLength(Infinity);
 * // => false
 *
 * _.isLength('3');
 * // => false
 */
function isLength(value) {
  return typeof value == 'number' &&
    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;
}

module.exports = isLength;


/***/ }),

/***/ "./node_modules/lodash/isNumber.js":
/*!*****************************************!*\
  !*** ./node_modules/lodash/isNumber.js ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var baseGetTag = __webpack_require__(/*! ./_baseGetTag */ "./node_modules/lodash/_baseGetTag.js"),
    isObjectLike = __webpack_require__(/*! ./isObjectLike */ "./node_modules/lodash/isObjectLike.js");

/** `Object#toString` result references. */
var numberTag = '[object Number]';

/**
 * Checks if `value` is classified as a `Number` primitive or object.
 *
 * **Note:** To exclude `Infinity`, `-Infinity`, and `NaN`, which are
 * classified as numbers, use the `_.isFinite` method.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a number, else `false`.
 * @example
 *
 * _.isNumber(3);
 * // => true
 *
 * _.isNumber(Number.MIN_VALUE);
 * // => true
 *
 * _.isNumber(Infinity);
 * // => true
 *
 * _.isNumber('3');
 * // => false
 */
function isNumber(value) {
  return typeof value == 'number' ||
    (isObjectLike(value) && baseGetTag(value) == numberTag);
}

module.exports = isNumber;


/***/ }),

/***/ "./node_modules/lodash/isObject.js":
/*!*****************************************!*\
  !*** ./node_modules/lodash/isObject.js ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports) {

/**
 * Checks if `value` is the
 * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)
 * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an object, else `false`.
 * @example
 *
 * _.isObject({});
 * // => true
 *
 * _.isObject([1, 2, 3]);
 * // => true
 *
 * _.isObject(_.noop);
 * // => true
 *
 * _.isObject(null);
 * // => false
 */
function isObject(value) {
  var type = typeof value;
  return value != null && (type == 'object' || type == 'function');
}

module.exports = isObject;


/***/ }),

/***/ "./node_modules/lodash/isObjectLike.js":
/*!*********************************************!*\
  !*** ./node_modules/lodash/isObjectLike.js ***!
  \*********************************************/
/*! no static exports found */
/***/ (function(module, exports) {

/**
 * Checks if `value` is object-like. A value is object-like if it's not `null`
 * and has a `typeof` result of "object".
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is object-like, else `false`.
 * @example
 *
 * _.isObjectLike({});
 * // => true
 *
 * _.isObjectLike([1, 2, 3]);
 * // => true
 *
 * _.isObjectLike(_.noop);
 * // => false
 *
 * _.isObjectLike(null);
 * // => false
 */
function isObjectLike(value) {
  return value != null && typeof value == 'object';
}

module.exports = isObjectLike;


/***/ }),

/***/ "./node_modules/lodash/isPlainObject.js":
/*!**********************************************!*\
  !*** ./node_modules/lodash/isPlainObject.js ***!
  \**********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var baseGetTag = __webpack_require__(/*! ./_baseGetTag */ "./node_modules/lodash/_baseGetTag.js"),
    getPrototype = __webpack_require__(/*! ./_getPrototype */ "./node_modules/lodash/_getPrototype.js"),
    isObjectLike = __webpack_require__(/*! ./isObjectLike */ "./node_modules/lodash/isObjectLike.js");

/** `Object#toString` result references. */
var objectTag = '[object Object]';

/** Used for built-in method references. */
var funcProto = Function.prototype,
    objectProto = Object.prototype;

/** Used to resolve the decompiled source of functions. */
var funcToString = funcProto.toString;

/** Used to check objects for own properties. */
var hasOwnProperty = objectProto.hasOwnProperty;

/** Used to infer the `Object` constructor. */
var objectCtorString = funcToString.call(Object);

/**
 * Checks if `value` is a plain object, that is, an object created by the
 * `Object` constructor or one with a `[[Prototype]]` of `null`.
 *
 * @static
 * @memberOf _
 * @since 0.8.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.
 * @example
 *
 * function Foo() {
 *   this.a = 1;
 * }
 *
 * _.isPlainObject(new Foo);
 * // => false
 *
 * _.isPlainObject([1, 2, 3]);
 * // => false
 *
 * _.isPlainObject({ 'x': 0, 'y': 0 });
 * // => true
 *
 * _.isPlainObject(Object.create(null));
 * // => true
 */
function isPlainObject(value) {
  if (!isObjectLike(value) || baseGetTag(value) != objectTag) {
    return false;
  }
  var proto = getPrototype(value);
  if (proto === null) {
    return true;
  }
  var Ctor = hasOwnProperty.call(proto, 'constructor') && proto.constructor;
  return typeof Ctor == 'function' && Ctor instanceof Ctor &&
    funcToString.call(Ctor) == objectCtorString;
}

module.exports = isPlainObject;


/***/ }),

/***/ "./node_modules/lodash/isString.js":
/*!*****************************************!*\
  !*** ./node_modules/lodash/isString.js ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var baseGetTag = __webpack_require__(/*! ./_baseGetTag */ "./node_modules/lodash/_baseGetTag.js"),
    isArray = __webpack_require__(/*! ./isArray */ "./node_modules/lodash/isArray.js"),
    isObjectLike = __webpack_require__(/*! ./isObjectLike */ "./node_modules/lodash/isObjectLike.js");

/** `Object#toString` result references. */
var stringTag = '[object String]';

/**
 * Checks if `value` is classified as a `String` primitive or object.
 *
 * @static
 * @since 0.1.0
 * @memberOf _
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a string, else `false`.
 * @example
 *
 * _.isString('abc');
 * // => true
 *
 * _.isString(1);
 * // => false
 */
function isString(value) {
  return typeof value == 'string' ||
    (!isArray(value) && isObjectLike(value) && baseGetTag(value) == stringTag);
}

module.exports = isString;


/***/ }),

/***/ "./node_modules/lodash/isSymbol.js":
/*!*****************************************!*\
  !*** ./node_modules/lodash/isSymbol.js ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var baseGetTag = __webpack_require__(/*! ./_baseGetTag */ "./node_modules/lodash/_baseGetTag.js"),
    isObjectLike = __webpack_require__(/*! ./isObjectLike */ "./node_modules/lodash/isObjectLike.js");

/** `Object#toString` result references. */
var symbolTag = '[object Symbol]';

/**
 * Checks if `value` is classified as a `Symbol` primitive or object.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.
 * @example
 *
 * _.isSymbol(Symbol.iterator);
 * // => true
 *
 * _.isSymbol('abc');
 * // => false
 */
function isSymbol(value) {
  return typeof value == 'symbol' ||
    (isObjectLike(value) && baseGetTag(value) == symbolTag);
}

module.exports = isSymbol;


/***/ }),

/***/ "./node_modules/lodash/isTypedArray.js":
/*!*********************************************!*\
  !*** ./node_modules/lodash/isTypedArray.js ***!
  \*********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var baseIsTypedArray = __webpack_require__(/*! ./_baseIsTypedArray */ "./node_modules/lodash/_baseIsTypedArray.js"),
    baseUnary = __webpack_require__(/*! ./_baseUnary */ "./node_modules/lodash/_baseUnary.js"),
    nodeUtil = __webpack_require__(/*! ./_nodeUtil */ "./node_modules/lodash/_nodeUtil.js");

/* Node.js helper references. */
var nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;

/**
 * Checks if `value` is classified as a typed array.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.
 * @example
 *
 * _.isTypedArray(new Uint8Array);
 * // => true
 *
 * _.isTypedArray([]);
 * // => false
 */
var isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;

module.exports = isTypedArray;


/***/ }),

/***/ "./node_modules/lodash/stubFalse.js":
/*!******************************************!*\
  !*** ./node_modules/lodash/stubFalse.js ***!
  \******************************************/
/*! no static exports found */
/***/ (function(module, exports) {

/**
 * This method returns `false`.
 *
 * @static
 * @memberOf _
 * @since 4.13.0
 * @category Util
 * @returns {boolean} Returns `false`.
 * @example
 *
 * _.times(2, _.stubFalse);
 * // => [false, false]
 */
function stubFalse() {
  return false;
}

module.exports = stubFalse;


/***/ }),

/***/ "./node_modules/lodash/times.js":
/*!**************************************!*\
  !*** ./node_modules/lodash/times.js ***!
  \**************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var baseTimes = __webpack_require__(/*! ./_baseTimes */ "./node_modules/lodash/_baseTimes.js"),
    castFunction = __webpack_require__(/*! ./_castFunction */ "./node_modules/lodash/_castFunction.js"),
    toInteger = __webpack_require__(/*! ./toInteger */ "./node_modules/lodash/toInteger.js");

/** Used as references for various `Number` constants. */
var MAX_SAFE_INTEGER = 9007199254740991;

/** Used as references for the maximum length and index of an array. */
var MAX_ARRAY_LENGTH = 4294967295;

/* Built-in method references for those with the same name as other `lodash` methods. */
var nativeMin = Math.min;

/**
 * Invokes the iteratee `n` times, returning an array of the results of
 * each invocation. The iteratee is invoked with one argument; (index).
 *
 * @static
 * @since 0.1.0
 * @memberOf _
 * @category Util
 * @param {number} n The number of times to invoke `iteratee`.
 * @param {Function} [iteratee=_.identity] The function invoked per iteration.
 * @returns {Array} Returns the array of results.
 * @example
 *
 * _.times(3, String);
 * // => ['0', '1', '2']
 *
 *  _.times(4, _.constant(0));
 * // => [0, 0, 0, 0]
 */
function times(n, iteratee) {
  n = toInteger(n);
  if (n < 1 || n > MAX_SAFE_INTEGER) {
    return [];
  }
  var index = MAX_ARRAY_LENGTH,
      length = nativeMin(n, MAX_ARRAY_LENGTH);

  iteratee = castFunction(iteratee);
  n -= MAX_ARRAY_LENGTH;

  var result = baseTimes(length, iteratee);
  while (++index < n) {
    iteratee(index);
  }
  return result;
}

module.exports = times;


/***/ }),

/***/ "./node_modules/lodash/toFinite.js":
/*!*****************************************!*\
  !*** ./node_modules/lodash/toFinite.js ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var toNumber = __webpack_require__(/*! ./toNumber */ "./node_modules/lodash/toNumber.js");

/** Used as references for various `Number` constants. */
var INFINITY = 1 / 0,
    MAX_INTEGER = 1.7976931348623157e+308;

/**
 * Converts `value` to a finite number.
 *
 * @static
 * @memberOf _
 * @since 4.12.0
 * @category Lang
 * @param {*} value The value to convert.
 * @returns {number} Returns the converted number.
 * @example
 *
 * _.toFinite(3.2);
 * // => 3.2
 *
 * _.toFinite(Number.MIN_VALUE);
 * // => 5e-324
 *
 * _.toFinite(Infinity);
 * // => 1.7976931348623157e+308
 *
 * _.toFinite('3.2');
 * // => 3.2
 */
function toFinite(value) {
  if (!value) {
    return value === 0 ? value : 0;
  }
  value = toNumber(value);
  if (value === INFINITY || value === -INFINITY) {
    var sign = (value < 0 ? -1 : 1);
    return sign * MAX_INTEGER;
  }
  return value === value ? value : 0;
}

module.exports = toFinite;


/***/ }),

/***/ "./node_modules/lodash/toInteger.js":
/*!******************************************!*\
  !*** ./node_modules/lodash/toInteger.js ***!
  \******************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var toFinite = __webpack_require__(/*! ./toFinite */ "./node_modules/lodash/toFinite.js");

/**
 * Converts `value` to an integer.
 *
 * **Note:** This method is loosely based on
 * [`ToInteger`](http://www.ecma-international.org/ecma-262/7.0/#sec-tointeger).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to convert.
 * @returns {number} Returns the converted integer.
 * @example
 *
 * _.toInteger(3.2);
 * // => 3
 *
 * _.toInteger(Number.MIN_VALUE);
 * // => 0
 *
 * _.toInteger(Infinity);
 * // => 1.7976931348623157e+308
 *
 * _.toInteger('3.2');
 * // => 3
 */
function toInteger(value) {
  var result = toFinite(value),
      remainder = result % 1;

  return result === result ? (remainder ? result - remainder : result) : 0;
}

module.exports = toInteger;


/***/ }),

/***/ "./node_modules/lodash/toNumber.js":
/*!*****************************************!*\
  !*** ./node_modules/lodash/toNumber.js ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var isObject = __webpack_require__(/*! ./isObject */ "./node_modules/lodash/isObject.js"),
    isSymbol = __webpack_require__(/*! ./isSymbol */ "./node_modules/lodash/isSymbol.js");

/** Used as references for various `Number` constants. */
var NAN = 0 / 0;

/** Used to match leading and trailing whitespace. */
var reTrim = /^\s+|\s+$/g;

/** Used to detect bad signed hexadecimal string values. */
var reIsBadHex = /^[-+]0x[0-9a-f]+$/i;

/** Used to detect binary string values. */
var reIsBinary = /^0b[01]+$/i;

/** Used to detect octal string values. */
var reIsOctal = /^0o[0-7]+$/i;

/** Built-in method references without a dependency on `root`. */
var freeParseInt = parseInt;

/**
 * Converts `value` to a number.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to process.
 * @returns {number} Returns the number.
 * @example
 *
 * _.toNumber(3.2);
 * // => 3.2
 *
 * _.toNumber(Number.MIN_VALUE);
 * // => 5e-324
 *
 * _.toNumber(Infinity);
 * // => Infinity
 *
 * _.toNumber('3.2');
 * // => 3.2
 */
function toNumber(value) {
  if (typeof value == 'number') {
    return value;
  }
  if (isSymbol(value)) {
    return NAN;
  }
  if (isObject(value)) {
    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;
    value = isObject(other) ? (other + '') : other;
  }
  if (typeof value != 'string') {
    return value === 0 ? value : +value;
  }
  value = value.replace(reTrim, '');
  var isBinary = reIsBinary.test(value);
  return (isBinary || reIsOctal.test(value))
    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)
    : (reIsBadHex.test(value) ? NAN : +value);
}

module.exports = toNumber;


/***/ }),

/***/ "./node_modules/lokijs/src/loki-indexed-adapter.js":
/*!*********************************************************!*\
  !*** ./node_modules/lokijs/src/loki-indexed-adapter.js ***!
  \*********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/*
  Loki IndexedDb Adapter (need to include this script to use it)

  Console Usage can be used for management/diagnostic, here are a few examples :
  adapter.getDatabaseList(); // with no callback passed, this method will log results to console
  adapter.saveDatabase('UserDatabase', JSON.stringify(myDb));
  adapter.loadDatabase('UserDatabase'); // will log the serialized db to console
  adapter.deleteDatabase('UserDatabase');
*/

(function (root, factory) {
    if (true) {
        // AMD
        !(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),
				__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?
				(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
    } else {}
}(this, function () {
  return (function() {

    /**
     * Loki persistence adapter class for indexedDb.
     *     This class fulfills abstract adapter interface which can be applied to other storage methods. 
     *     Utilizes the included LokiCatalog app/key/value database for actual database persistence.
     *     Indexeddb is highly async, but this adapter has been made 'console-friendly' as well.
     *     Anywhere a callback is omitted, it should return results (if applicable) to console.
     *     IndexedDb storage is provided per-domain, so we implement app/key/value database to 
     *     allow separate contexts for separate apps within a domain.
     *
     * @example
     * var idbAdapter = new LokiIndexedAdapter('finance');
     *
     * @constructor LokiIndexedAdapter
     *
     * @param {string} appname - (Optional) Application name context can be used to distinguish subdomains, 'loki' by default
     * @param {object=} options Configuration options for the adapter
     * @param {boolean} options.closeAfterSave Whether the indexedDB database should be closed after saving.
     */
    function LokiIndexedAdapter(appname, options)
    {
      this.app = 'loki';
      this.options = options || {};

      if (typeof (appname) !== 'undefined')
      {
        this.app = appname;
      }

      // keep reference to catalog class for base AKV operations
      this.catalog = null;

      if (!this.checkAvailability()) {
        throw new Error('indexedDB does not seem to be supported for your environment');
      }
    }

    /**
     * Used for closing the indexeddb database.
     */
    LokiIndexedAdapter.prototype.closeDatabase = function ()
    {
      if (this.catalog && this.catalog.db) {
        this.catalog.db.close();
        this.catalog.db = null;
      }
    };

    /**
     * Used to check if adapter is available
     *
     * @returns {boolean} true if indexeddb is available, false if not.
     * @memberof LokiIndexedAdapter
     */
    LokiIndexedAdapter.prototype.checkAvailability = function()
    {
      if (typeof indexedDB !== 'undefined' && indexedDB) return true;

      return false;
    };

    /**
     * Retrieves a serialized db string from the catalog.
     *
     * @example
     * // LOAD
     * var idbAdapter = new LokiIndexedAdapter('finance');
     * var db = new loki('test', { adapter: idbAdapter });
     *   db.loadDatabase(function(result) {
     *   console.log('done');
     * });
     *
     * @param {string} dbname - the name of the database to retrieve.
     * @param {function} callback - callback should accept string param containing serialized db string.
     * @memberof LokiIndexedAdapter
     */
    LokiIndexedAdapter.prototype.loadDatabase = function(dbname, callback)
    {
      var appName = this.app;
      var adapter = this;

      // lazy open/create db reference so dont -need- callback in constructor
      if (this.catalog === null || this.catalog.db === null) {
        this.catalog = new LokiCatalog(function(cat) {
          adapter.catalog = cat;

          adapter.loadDatabase(dbname, callback);
        });

        return;
      }

      // lookup up db string in AKV db
      this.catalog.getAppKey(appName, dbname, function(result) {
        if (typeof (callback) === 'function') {
          if (result.id === 0) {
            callback(null);
            return;
          }
          callback(result.val);
        }
        else {
          // support console use of api
          console.log(result.val);
        }
      });
    };

    // alias
    LokiIndexedAdapter.prototype.loadKey = LokiIndexedAdapter.prototype.loadDatabase;

    /**
     * Saves a serialized db to the catalog.
     *
     * @example
     * // SAVE : will save App/Key/Val as 'finance'/'test'/{serializedDb}
     * var idbAdapter = new LokiIndexedAdapter('finance');
     * var db = new loki('test', { adapter: idbAdapter });
     * var coll = db.addCollection('testColl');
     * coll.insert({test: 'val'});
     * db.saveDatabase();  // could pass callback if needed for async complete
     *
     * @param {string} dbname - the name to give the serialized database within the catalog.
     * @param {string} dbstring - the serialized db string to save.
     * @param {function} callback - (Optional) callback passed obj.success with true or false
     * @memberof LokiIndexedAdapter
     */
    LokiIndexedAdapter.prototype.saveDatabase = function(dbname, dbstring, callback)
    {
      var appName = this.app;
      var adapter = this;

      function saveCallback(result) {
        if (result && result.success === true) {
          callback(null);
        }
        else {
          callback(new Error("Error saving database"));
        }

        if (adapter.options.closeAfterSave) {
          adapter.closeDatabase();
        }
      }

      // lazy open/create db reference so dont -need- callback in constructor
      if (this.catalog === null || this.catalog.db === null) {
        this.catalog = new LokiCatalog(function(cat) {
          adapter.saveDatabase(dbname, dbstring, saveCallback);
        });

        return;
      }

      // set (add/update) entry to AKV database
      this.catalog.setAppKey(appName, dbname, dbstring, saveCallback);
    };

    // alias
    LokiIndexedAdapter.prototype.saveKey = LokiIndexedAdapter.prototype.saveDatabase;

    /**
     * Deletes a serialized db from the catalog.
     *
     * @example
     * // DELETE DATABASE
     * // delete 'finance'/'test' value from catalog
     * idbAdapter.deleteDatabase('test', function {
     *   // database deleted
     * });
     *
     * @param {string} dbname - the name of the database to delete from the catalog.
     * @param {function=} callback - (Optional) executed on database delete
     * @memberof LokiIndexedAdapter
     */
    LokiIndexedAdapter.prototype.deleteDatabase = function(dbname, callback)
    {
      var appName = this.app;
      var adapter = this;

      // lazy open/create db reference and pass callback ahead
      if (this.catalog === null || this.catalog.db === null) {
        this.catalog = new LokiCatalog(function(cat) {
          adapter.catalog = cat;

          adapter.deleteDatabase(dbname, callback);
        });

        return;
      }

      // catalog was already initialized, so just lookup object and delete by id
      this.catalog.getAppKey(appName, dbname, function(result) {
        var id = result.id;

        if (id !== 0) {
          adapter.catalog.deleteAppKey(id, callback);
        } else if (typeof (callback) === 'function') {
          callback({ success: true });
        }
      });
    };

    // alias
    LokiIndexedAdapter.prototype.deleteKey = LokiIndexedAdapter.prototype.deleteDatabase;

    /**
     * Removes all database partitions and pages with the base filename passed in.
     * This utility method does not (yet) guarantee async deletions will be completed before returning
     *
     * @param {string} dbname - the base filename which container, partitions, or pages are derived
     * @memberof LokiIndexedAdapter
     */
    LokiIndexedAdapter.prototype.deleteDatabasePartitions = function(dbname) {
      var self=this;
      this.getDatabaseList(function(result) {
        result.forEach(function(str) {
          if (str.startsWith(dbname)) {
            self.deleteDatabase(str);
          }
        });
      });
    };

    /**
     * Retrieves object array of catalog entries for current app.
     *
     * @example
     * idbAdapter.getDatabaseList(function(result) {
     *   // result is array of string names for that appcontext ('finance')
     *   result.forEach(function(str) {
     *     console.log(str);
     *   });
     * });
     *
     * @param {function} callback - should accept array of database names in the catalog for current app.
     * @memberof LokiIndexedAdapter
     */
    LokiIndexedAdapter.prototype.getDatabaseList = function(callback)
    {
      var appName = this.app;
      var adapter = this;

      // lazy open/create db reference so dont -need- callback in constructor
      if (this.catalog === null || this.catalog.db === null) {
        this.catalog = new LokiCatalog(function(cat) {
          adapter.catalog = cat;

          adapter.getDatabaseList(callback);
        });

        return;
      }

      // catalog already initialized
      // get all keys for current appName, and transpose results so just string array
      this.catalog.getAppKeys(appName, function(results) {
        var names = [];

        for(var idx = 0; idx < results.length; idx++) {
          names.push(results[idx].key);
        }

        if (typeof (callback) === 'function') {
          callback(names);
        }
        else {
          names.forEach(function(obj) {
            console.log(obj);
          });
        }
      });
    };

    // alias
    LokiIndexedAdapter.prototype.getKeyList = LokiIndexedAdapter.prototype.getDatabaseList;

    /**
     * Allows retrieval of list of all keys in catalog along with size
     *
     * @param {function} callback - (Optional) callback to accept result array.
     * @memberof LokiIndexedAdapter
     */
    LokiIndexedAdapter.prototype.getCatalogSummary = function(callback)
    {
      var appName = this.app;
      var adapter = this;

      // lazy open/create db reference
      if (this.catalog === null || this.catalog.db === null) {
        this.catalog = new LokiCatalog(function(cat) {
          adapter.catalog = cat;

          adapter.getCatalogSummary(callback);
        });

        return;
      }

      // catalog already initialized
      // get all keys for current appName, and transpose results so just string array
      this.catalog.getAllKeys(function(results) {
        var entries = [];
        var obj,
          size,
          oapp,
          okey,
          oval;

        for(var idx = 0; idx < results.length; idx++) {
          obj = results[idx];
          oapp = obj.app || '';
          okey = obj.key || '';
          oval = obj.val || '';

          // app and key are composited into an appkey column so we will mult by 2
          size = oapp.length * 2 + okey.length * 2 + oval.length + 1;

          entries.push({ "app": obj.app, "key": obj.key, "size": size });
        }

        if (typeof (callback) === 'function') {
          callback(entries);
        }
        else {
          entries.forEach(function(obj) {
            console.log(obj);
          });
        }
      });
    };

    /**
     * LokiCatalog - underlying App/Key/Value catalog persistence
     *    This non-interface class implements the actual persistence.
     *    Used by the IndexedAdapter class.
     */
    function LokiCatalog(callback)
    {
      this.db = null;
      this.initializeLokiCatalog(callback);
    }

    LokiCatalog.prototype.initializeLokiCatalog = function(callback) {
      var openRequest = indexedDB.open('LokiCatalog', 1);
      var cat = this;

      // If database doesn't exist yet or its version is lower than our version specified above (2nd param in line above)
      openRequest.onupgradeneeded = function(e) {
        var thisDB = e.target.result;
        if (thisDB.objectStoreNames.contains('LokiAKV')) {
          thisDB.deleteObjectStore('LokiAKV');
        }

        if(!thisDB.objectStoreNames.contains('LokiAKV')) {
          var objectStore = thisDB.createObjectStore('LokiAKV', { keyPath: 'id', autoIncrement:true });
          objectStore.createIndex('app', 'app', {unique:false});
          objectStore.createIndex('key', 'key', {unique:false});
          // hack to simulate composite key since overhead is low (main size should be in val field)
          // user (me) required to duplicate the app and key into comma delimited appkey field off object
          // This will allow retrieving single record with that composite key as well as
          // still supporting opening cursors on app or key alone
          objectStore.createIndex('appkey', 'appkey', {unique:true});
        }
      };

      openRequest.onsuccess = function(e) {
        cat.db = e.target.result;

        if (typeof (callback) === 'function') callback(cat);
      };

      openRequest.onerror = function(e) {
        throw e;
      };
    };

    LokiCatalog.prototype.getAppKey = function(app, key, callback) {
      var transaction = this.db.transaction(['LokiAKV'], 'readonly');
      var store = transaction.objectStore('LokiAKV');
      var index = store.index('appkey');
      var appkey = app + "," + key;
      var request = index.get(appkey);

      request.onsuccess = (function(usercallback) {
        return function(e) {
          var lres = e.target.result;

          if (lres === null || typeof(lres) === 'undefined') {
            lres = {
              id: 0,
              success: false
            };
          }

          if (typeof(usercallback) === 'function') {
            usercallback(lres);
          }
          else {
            console.log(lres);
          }
        };
      })(callback);

      request.onerror = (function(usercallback) {
        return function(e) {
          if (typeof(usercallback) === 'function') {
            usercallback({ id: 0, success: false });
          }
          else {
            throw e;
          }
        };
      })(callback);
    };

    LokiCatalog.prototype.getAppKeyById = function (id, callback, data) {
      var transaction = this.db.transaction(['LokiAKV'], 'readonly');
      var store = transaction.objectStore('LokiAKV');
      var request = store.get(id);

      request.onsuccess = (function(data, usercallback){
        return function(e) {
          if (typeof(usercallback) === 'function') {
            usercallback(e.target.result, data);
          }
          else {
            console.log(e.target.result);
          }
        };
      })(data, callback);
    };

    LokiCatalog.prototype.setAppKey = function (app, key, val, callback) {
      var transaction = this.db.transaction(['LokiAKV'], 'readwrite');
      var store = transaction.objectStore('LokiAKV');
      var index = store.index('appkey');
      var appkey = app + "," + key;
      var request = index.get(appkey);

      // first try to retrieve an existing object by that key
      // need to do this because to update an object you need to have id in object, otherwise it will append id with new autocounter and clash the unique index appkey
      request.onsuccess = function(e) {
        var res = e.target.result;

        if (res === null || res === undefined) {
          res = {
            app:app,
            key:key,
            appkey: app + ',' + key,
            val:val
          };
        }
        else {
          res.val = val;
        }

        var requestPut = store.put(res);

        requestPut.onerror = (function(usercallback) {
          return function(e) {
            if (typeof(usercallback) === 'function') {
              usercallback({ success: false });
            }
            else {
              console.error('LokiCatalog.setAppKey (set) onerror');
              console.error(request.error);
            }
          };

        })(callback);

        requestPut.onsuccess = (function(usercallback) {
          return function(e) {
            if (typeof(usercallback) === 'function') {
              usercallback({ success: true });
            }
          };
        })(callback);
      };

      request.onerror = (function(usercallback) {
        return function(e) {
          if (typeof(usercallback) === 'function') {
            usercallback({ success: false });
          }
          else {
            console.error('LokiCatalog.setAppKey (get) onerror');
            console.error(request.error);
          }
        };
      })(callback);
    };

    LokiCatalog.prototype.deleteAppKey = function (id, callback) {
      var transaction = this.db.transaction(['LokiAKV'], 'readwrite');
      var store = transaction.objectStore('LokiAKV');
      var request = store.delete(id);

      request.onsuccess = (function(usercallback) {
        return function(evt) {
          if (typeof(usercallback) === 'function') usercallback({ success: true });
        };
      })(callback);

      request.onerror = (function(usercallback) {
        return function(evt) {
          if (typeof(usercallback) === 'function') {
            usercallback({ success: false });
          }
          else {
            console.error('LokiCatalog.deleteAppKey raised onerror');
            console.error(request.error);
          }
        };
      })(callback);
    };

    LokiCatalog.prototype.getAppKeys = function(app, callback) {
      var transaction = this.db.transaction(['LokiAKV'], 'readonly');
      var store = transaction.objectStore('LokiAKV');
      var index = store.index('app');

      // We want cursor to all values matching our (single) app param
      var singleKeyRange = IDBKeyRange.only(app);

      // To use one of the key ranges, pass it in as the first argument of openCursor()/openKeyCursor()
      var cursor = index.openCursor(singleKeyRange);

      // cursor internally, pushing results into this.data[] and return
      // this.data[] when done (similar to service)
      var localdata = [];

      cursor.onsuccess = (function(data, callback) {
        return function(e) {
          var cursor = e.target.result;
          if (cursor) {
            var currObject = cursor.value;

            data.push(currObject);

            cursor.continue();
          }
          else {
            if (typeof(callback) === 'function') {
              callback(data);
            }
            else {
              console.log(data);
            }
          }
        };
      })(localdata, callback);

      cursor.onerror = (function(usercallback) {
        return function(e) {
          if (typeof(usercallback) === 'function') {
            usercallback(null);
          }
          else {
            console.error('LokiCatalog.getAppKeys raised onerror');
            console.error(e);
          }
        };
      })(callback);

    };

    // Hide 'cursoring' and return array of { id: id, key: key }
    LokiCatalog.prototype.getAllKeys = function (callback) {
      var transaction = this.db.transaction(['LokiAKV'], 'readonly');
      var store = transaction.objectStore('LokiAKV');
      var cursor = store.openCursor();

      var localdata = [];

      cursor.onsuccess = (function(data, callback) {
        return function(e) {
          var cursor = e.target.result;
          if (cursor) {
            var currObject = cursor.value;

            data.push(currObject);

            cursor.continue();
          }
          else {
            if (typeof(callback) === 'function') {
              callback(data);
            }
            else {
              console.log(data);
            }
          }
        };
      })(localdata, callback);

      cursor.onerror = (function(usercallback) {
        return function(e) {
          if (typeof(usercallback) === 'function') usercallback(null);
        };
      })(callback);

    };

    return LokiIndexedAdapter;

  }());
}));


/***/ }),

/***/ "./node_modules/lokijs/src/lokijs.js":
/*!*******************************************!*\
  !*** ./node_modules/lokijs/src/lokijs.js ***!
  \*******************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global, process) {var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/**
 * LokiJS
 * @author Joe Minichino <joe.minichino@gmail.com>
 *
 * A lightweight document oriented javascript database
 */
(function (root, factory) {
  if (true) {
    // AMD
    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),
				__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?
				(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
  } else {}
}(this, function () {

  return (function () {
    'use strict';

    var hasOwnProperty = Object.prototype.hasOwnProperty;

    var Utils = {
      copyProperties: function (src, dest) {
        var prop;
        for (prop in src) {
          dest[prop] = src[prop];
        }
      },
      // used to recursively scan hierarchical transform step object for param substitution
      resolveTransformObject: function (subObj, params, depth) {
        var prop,
          pname;

        if (typeof depth !== 'number') {
          depth = 0;
        }

        if (++depth >= 10) return subObj;

        for (prop in subObj) {
          if (typeof subObj[prop] === 'string' && subObj[prop].indexOf("[%lktxp]") === 0) {
            pname = subObj[prop].substring(8);
            if (params.hasOwnProperty(pname)) {
              subObj[prop] = params[pname];
            }
          } else if (typeof subObj[prop] === "object") {
            subObj[prop] = Utils.resolveTransformObject(subObj[prop], params, depth);
          }
        }

        return subObj;
      },
      // top level utility to resolve an entire (single) transform (array of steps) for parameter substitution
      resolveTransformParams: function (transform, params) {
        var idx,
          clonedStep,
          resolvedTransform = [];

        if (typeof params === 'undefined') return transform;

        // iterate all steps in the transform array
        for (idx = 0; idx < transform.length; idx++) {
          // clone transform so our scan/replace can operate directly on cloned transform
          clonedStep = clone(transform[idx], "shallow-recurse-objects");
          resolvedTransform.push(Utils.resolveTransformObject(clonedStep, params));
        }

        return resolvedTransform;
      },

      // By default (if usingDotNotation is false), looks up path in
      // object via `object[path]`
      //
      // If `usingDotNotation` is true, then the path is assumed to
      // represent a nested path. It can be in the form of an array of
      // field names, or a period delimited string. The function will
      // look up the value of object[path[0]], and then call
      // result[path[1]] on the result, etc etc.
      //
      // If `usingDotNotation` is true, this function still supports
      // non nested fields.
      //
      // `usingDotNotation` is a performance optimization. The caller
      // may know that a path is *not* nested. In which case, this
      // function avoids a costly string.split('.')
      //
      // examples:
      // getIn({a: 1}, "a") => 1
      // getIn({a: 1}, "a", true) => 1
      // getIn({a: {b: 1}}, ["a", "b"], true) => 1
      // getIn({a: {b: 1}}, "a.b", true) => 1
      getIn: function (object, path, usingDotNotation) {
        if (object == null) {
          return undefined;
        }
        if (!usingDotNotation) {
          return object[path];
        }

        if (typeof(path) === "string") {
          path = path.split(".");
        }

        if (!Array.isArray(path)) {
          throw new Error("path must be a string or array. Found " + typeof(path));
        }

        var index = 0,
          length = path.length;

        while (object != null && index < length) {
          object = object[path[index++]];
        }
        return (index && index == length) ? object : undefined;
      }
    };

    // wrapping in object to expose to default export for potential user override.
    // warning: overriding these methods will override behavior for all loki db instances in memory.
    // warning: if you use binary indices these comparators should be the same for all inserts/updates/removes.
    var Comparators = {
      aeq: aeqHelper,
      lt: ltHelper,
      gt: gtHelper
    };

    /** Helper function for determining 'loki' abstract equality which is a little more abstract than ==
     *     aeqHelper(5, '5') === true
     *     aeqHelper(5.0, '5') === true
     *     aeqHelper(new Date("1/1/2011"), new Date("1/1/2011")) === true
     *     aeqHelper({a:1}, {z:4}) === true (all objects sorted equally)
     *     aeqHelper([1, 2, 3], [1, 3]) === false
     *     aeqHelper([1, 2, 3], [1, 2, 3]) === true
     *     aeqHelper(undefined, null) === true
     */
    function aeqHelper(prop1, prop2) {
      var cv1, cv2, t1, t2;

      if (prop1 === prop2) return true;

      // 'falsy' and Boolean handling
      if (!prop1 || !prop2 || prop1 === true || prop2 === true || prop1 !== prop1 || prop2 !== prop2) {
        // dates and NaN conditions (typed dates before serialization)
        switch (prop1) {
          case undefined: t1 = 1; break;
          case null: t1 = 1; break;
          case false: t1 = 3; break;
          case true: t1 = 4; break;
          case "": t1 = 5; break;
          default: t1 = (prop1 === prop1)?9:0; break;
        }

        switch (prop2) {
          case undefined: t2 = 1; break;
          case null: t2 = 1; break;
          case false: t2 = 3; break;
          case true: t2 = 4; break;
          case "": t2 = 5; break;
          default: t2 = (prop2 === prop2)?9:0; break;
        }

        // one or both is edge case
        if (t1 !== 9 || t2 !== 9) {
          return (t1===t2);
        }
      }

      // Handle 'Number-like' comparisons
      cv1 = Number(prop1);
      cv2 = Number(prop2);

      // if one or both are 'number-like'...
      if (cv1 === cv1 || cv2 === cv2) {
        return (cv1 === cv2);
      }

      // not strict equal nor less than nor gt so must be mixed types, convert to string and use that to compare
      cv1 = prop1.toString();
      cv2 = prop2.toString();

      return (cv1 == cv2);
    }

    /** Helper function for determining 'less-than' conditions for ops, sorting, and binary indices.
     *     In the future we might want $lt and $gt ops to use their own functionality/helper.
     *     Since binary indices on a property might need to index [12, NaN, new Date(), Infinity], we
     *     need this function (as well as gtHelper) to always ensure one value is LT, GT, or EQ to another.
     */
    function ltHelper(prop1, prop2, equal) {
      var cv1, cv2, t1, t2;

      // if one of the params is falsy or strictly true or not equal to itself
      // 0, 0.0, "", NaN, null, undefined, not defined, false, true
      if (!prop1 || !prop2 || prop1 === true || prop2 === true || prop1 !== prop1 || prop2 !== prop2) {
        switch (prop1) {
          case undefined: t1 = 1; break;
          case null: t1 = 1; break;
          case false: t1 = 3; break;
          case true: t1 = 4; break;
          case "": t1 = 5; break;
          // if strict equal probably 0 so sort higher, otherwise probably NaN so sort lower than even null
          default: t1 = (prop1 === prop1)?9:0; break;
        }

        switch (prop2) {
          case undefined: t2 = 1; break;
          case null: t2 = 1; break;
          case false: t2 = 3; break;
          case true: t2 = 4; break;
          case "": t2 = 5; break;
          default: t2 = (prop2 === prop2)?9:0; break;
        }

        // one or both is edge case
        if (t1 !== 9 || t2 !== 9) {
          return (t1===t2)?equal:(t1<t2);
        }
      }

      // if both are numbers (string encoded or not), compare as numbers
      cv1 = Number(prop1);
      cv2 = Number(prop2);

      if (cv1 === cv1 && cv2 === cv2) {
        if (cv1 < cv2) return true;
        if (cv1 > cv2) return false;
        return equal;
      }

      if (cv1 === cv1 && cv2 !== cv2) {
        return true;
      }

      if (cv2 === cv2 && cv1 !== cv1) {
        return false;
      }

      if (prop1 < prop2) return true;
      if (prop1 > prop2) return false;
      if (prop1 == prop2) return equal;

      // not strict equal nor less than nor gt so must be mixed types, convert to string and use that to compare
      cv1 = prop1.toString();
      cv2 = prop2.toString();

      if (cv1 < cv2) {
        return true;
      }

      if (cv1 == cv2) {
        return equal;
      }

      return false;
    }

    function gtHelper(prop1, prop2, equal) {
      var cv1, cv2, t1, t2;

      // 'falsy' and Boolean handling
      if (!prop1 || !prop2 || prop1 === true || prop2 === true || prop1 !== prop1 || prop2 !== prop2) {
        switch (prop1) {
          case undefined: t1 = 1; break;
          case null: t1 = 1; break;
          case false: t1 = 3; break;
          case true: t1 = 4; break;
          case "": t1 = 5; break;
          // NaN 0
          default: t1 = (prop1 === prop1)?9:0; break;
        }

        switch (prop2) {
          case undefined: t2 = 1; break;
          case null: t2 = 1; break;
          case false: t2 = 3; break;
          case true: t2 = 4; break;
          case "": t2 = 5; break;
          default: t2 = (prop2 === prop2)?9:0; break;
        }

        // one or both is edge case
        if (t1 !== 9 || t2 !== 9) {
          return (t1===t2)?equal:(t1>t2);
        }
      }

      // if both are numbers (string encoded or not), compare as numbers
      cv1 = Number(prop1);
      cv2 = Number(prop2);
      if (cv1 === cv1 && cv2 === cv2) {
        if (cv1 > cv2) return true;
        if (cv1 < cv2) return false;
        return equal;
      }

      if (cv1 === cv1 && cv2 !== cv2) {
        return false;
      }

      if (cv2 === cv2 && cv1 !== cv1) {
        return true;
      }

      if (prop1 > prop2) return true;
      if (prop1 < prop2) return false;
      if (prop1 == prop2) return equal;

      // not strict equal nor less than nor gt so must be dates or mixed types
      // convert to string and use that to compare
      cv1 = prop1.toString();
      cv2 = prop2.toString();

      if (cv1 > cv2) {
        return true;
      }

      if (cv1 == cv2) {
        return equal;
      }

      return false;
    }

    function sortHelper(prop1, prop2, desc) {
      if (Comparators.aeq(prop1, prop2)) return 0;

      if (Comparators.lt(prop1, prop2, false)) {
        return (desc) ? (1) : (-1);
      }

      if (Comparators.gt(prop1, prop2, false)) {
        return (desc) ? (-1) : (1);
      }

      // not lt, not gt so implied equality-- date compatible
      return 0;
    }

    /**
     * compoundeval() - helper function for compoundsort(), performing individual object comparisons
     *
     * @param {array} properties - array of property names, in order, by which to evaluate sort order
     * @param {object} obj1 - first object to compare
     * @param {object} obj2 - second object to compare
     * @returns {integer} 0, -1, or 1 to designate if identical (sortwise) or which should be first
     */
    function compoundeval(properties, obj1, obj2) {
      var res = 0;
      var prop, field, val1, val2, arr, path;
      for (var i = 0, len = properties.length; i < len; i++) {
        prop = properties[i];
        field = prop[0];
        if (~field.indexOf('.')) {
          arr = field.split('.');
          val1 = Utils.getIn(obj1, arr, true);
          val2 = Utils.getIn(obj2, arr, true);
        } else {
          val1 = obj1[field];
          val2 = obj2[field];
        }
        res = sortHelper(val1, val2, prop[1]);
        if (res !== 0) {
          return res;
        }
      }
      return 0;
    }

    /**
     * dotSubScan - helper function used for dot notation queries.
     *
     * @param {object} root - object to traverse
     * @param {array} paths - array of properties to drill into
     * @param {function} fun - evaluation function to test with
     * @param {any} value - comparative value to also pass to (compare) fun
     * @param {number} poffset - index of the item in 'paths' to start the sub-scan from
     */
    function dotSubScan(root, paths, fun, value, poffset) {
      var pathOffset = poffset || 0;
      var path = paths[pathOffset];

      var valueFound = false;
      var element;
      if (typeof root === 'object' && path in root) {
        element = root[path];
      }
      if (pathOffset + 1 >= paths.length) {
        // if we have already expanded out the dot notation,
        // then just evaluate the test function and value on the element
        valueFound = fun(element, value);
      } else if (Array.isArray(element)) {
        for (var index = 0, len = element.length; index < len; index += 1) {
          valueFound = dotSubScan(element[index], paths, fun, value, pathOffset + 1);
          if (valueFound === true) {
            break;
          }
        }
      } else {
        valueFound = dotSubScan(element, paths, fun, value, pathOffset + 1);
      }

      return valueFound;
    }

    function containsCheckFn(a) {
      if (typeof a === 'string' || Array.isArray(a)) {
        return function (b) {
          return a.indexOf(b) !== -1;
        };
      } else if (typeof a === 'object' && a !== null) {
        return function (b) {
          return hasOwnProperty.call(a, b);
        };
      }
      return null;
    }

    function doQueryOp(val, op) {
      for (var p in op) {
        if (hasOwnProperty.call(op, p)) {
          return LokiOps[p](val, op[p]);
        }
      }
      return false;
    }

    var LokiOps = {
      // comparison operators
      // a is the value in the collection
      // b is the query value
      $eq: function (a, b) {
        return a === b;
      },

      // abstract/loose equality
      $aeq: function (a, b) {
        return a == b;
      },

      $ne: function (a, b) {
        // ecma 5 safe test for NaN
        if (b !== b) {
          // ecma 5 test value is not NaN
          return (a === a);
        }

        return a !== b;
      },
      // date equality / loki abstract equality test
      $dteq: function (a, b) {
        return Comparators.aeq(a, b);
      },

      // loki comparisons: return identical unindexed results as indexed comparisons
      $gt: function (a, b) {
        return Comparators.gt(a, b, false);
      },

      $gte: function (a, b) {
        return Comparators.gt(a, b, true);
      },

      $lt: function (a, b) {
        return Comparators.lt(a, b, false);
      },

      $lte: function (a, b) {
        return Comparators.lt(a, b, true);
      },

      // lightweight javascript comparisons
      $jgt: function (a, b) {
        return a > b;
      },

      $jgte: function (a, b) {
        return a >= b;
      },

      $jlt: function (a, b) {
        return a < b;
      },

      $jlte: function (a, b) {
        return a <= b;
      },

      // ex : coll.find({'orderCount': {$between: [10, 50]}});
      $between: function (a, vals) {
        if (a === undefined || a === null) return false;
        return (Comparators.gt(a, vals[0], true) && Comparators.lt(a, vals[1], true));
      },

      $jbetween: function (a, vals) {
        if (a === undefined || a === null) return false;
        return (a >= vals[0] && a <= vals[1]);
      },

      $in: function (a, b) {
        return b.indexOf(a) !== -1;
      },

      $nin: function (a, b) {
        return b.indexOf(a) === -1;
      },

      $keyin: function (a, b) {
        return a in b;
      },

      $nkeyin: function (a, b) {
        return !(a in b);
      },

      $definedin: function (a, b) {
        return b[a] !== undefined;
      },

      $undefinedin: function (a, b) {
        return b[a] === undefined;
      },

      $regex: function (a, b) {
        return b.test(a);
      },

      $containsString: function (a, b) {
        return (typeof a === 'string') && (a.indexOf(b) !== -1);
      },

      $containsNone: function (a, b) {
        return !LokiOps.$containsAny(a, b);
      },

      $containsAny: function (a, b) {
        var checkFn = containsCheckFn(a);
        if (checkFn !== null) {
          return (Array.isArray(b)) ? (b.some(checkFn)) : (checkFn(b));
        }
        return false;
      },

      $contains: function (a, b) {
        var checkFn = containsCheckFn(a);
        if (checkFn !== null) {
          return (Array.isArray(b)) ? (b.every(checkFn)) : (checkFn(b));
        }
        return false;
      },

      $type: function (a, b) {
        var type = typeof a;
        if (type === 'object') {
          if (Array.isArray(a)) {
            type = 'array';
          } else if (a instanceof Date) {
            type = 'date';
          }
        }
        return (typeof b !== 'object') ? (type === b) : doQueryOp(type, b);
      },

      $finite: function(a, b) {
        return (b === isFinite(a));
      },

      $size: function (a, b) {
        if (Array.isArray(a)) {
          return (typeof b !== 'object') ? (a.length === b) : doQueryOp(a.length, b);
        }
        return false;
      },

      $len: function (a, b) {
        if (typeof a === 'string') {
          return (typeof b !== 'object') ? (a.length === b) : doQueryOp(a.length, b);
        }
        return false;
      },

      $where: function (a, b) {
        return b(a) === true;
      },

      // field-level logical operators
      // a is the value in the collection
      // b is the nested query operation (for '$not')
      //   or an array of nested query operations (for '$and' and '$or')
      $not: function (a, b) {
        return !doQueryOp(a, b);
      },

      $and: function (a, b) {
        for (var idx = 0, len = b.length; idx < len; idx += 1) {
          if (!doQueryOp(a, b[idx])) {
            return false;
          }
        }
        return true;
      },

      $or: function (a, b) {
        for (var idx = 0, len = b.length; idx < len; idx += 1) {
          if (doQueryOp(a, b[idx])) {
            return true;
          }
        }
        return false;
      },

      $exists: function (a, b) {
        if (b) {
          return a !== undefined;
        } else {
          return a === undefined;
        }
      }
    };

    // if an op is registered in this object, our 'calculateRange' can use it with our binary indices.
    // if the op is registered to a function, we will run that function/op as a 2nd pass filter on results.
    // those 2nd pass filter functions should be similar to LokiOps functions, accepting 2 vals to compare.
    var indexedOps = {
      $eq: LokiOps.$eq,
      $aeq: true,
      $dteq: true,
      $gt: true,
      $gte: true,
      $lt: true,
      $lte: true,
      $in: true,
      $between: true
    };

    function clone(data, method) {
      if (data === null || data === undefined) {
        return null;
      }

      var cloneMethod = method || 'parse-stringify',
        cloned;

      switch (cloneMethod) {
      case "parse-stringify":
        cloned = JSON.parse(JSON.stringify(data));
        break;
      case "jquery-extend-deep":
        cloned = jQuery.extend(true, {}, data);
        break;
      case "shallow":
        // more compatible method for older browsers
        cloned = Object.create(data.constructor.prototype);
        Object.keys(data).map(function (i) {
          cloned[i] = data[i];
        });
        break;
      case "shallow-assign":
        // should be supported by newer environments/browsers
        cloned = Object.create(data.constructor.prototype);
        Object.assign(cloned, data);
        break;
      case "shallow-recurse-objects":
        // shallow clone top level properties
        cloned = clone(data, "shallow");
        var keys = Object.keys(data);
        // for each of the top level properties which are object literals, recursively shallow copy
        keys.forEach(function(key) {
          if (typeof data[key] === "object" && data[key].constructor.name === "Object")  {
            cloned[key] = clone(data[key], "shallow-recurse-objects");
          }else if(Array.isArray(data[key])){
            cloned[key] = cloneObjectArray(data[key], "shallow-recurse-objects");
          }
        });
        break;
      default:
        break;
      }

      return cloned;
    }

    function cloneObjectArray(objarray, method) {
      if (method == "parse-stringify") {
        return clone(objarray, method);
      }
      var result = [];
      for (var i = 0, len = objarray.length; i < len; i++) {
        result[i] = clone(objarray[i], method);
      }
      return result;
    }

    function localStorageAvailable() {
      try {
        return (window && window.localStorage !== undefined && window.localStorage !== null);
      } catch (e) {
        return false;
      }
    }


    /**
     * LokiEventEmitter is a minimalist version of EventEmitter. It enables any
     * constructor that inherits EventEmitter to emit events and trigger
     * listeners that have been added to the event through the on(event, callback) method
     *
     * @constructor LokiEventEmitter
     */
    function LokiEventEmitter() {}

    /**
     * @prop {hashmap} events - a hashmap, with each property being an array of callbacks
     * @memberof LokiEventEmitter
     */
    LokiEventEmitter.prototype.events = {};

    /**
     * @prop {boolean} asyncListeners - boolean determines whether or not the callbacks associated with each event
     * should happen in an async fashion or not
     * Default is false, which means events are synchronous
     * @memberof LokiEventEmitter
     */
    LokiEventEmitter.prototype.asyncListeners = false;

    /**
     * on(eventName, listener) - adds a listener to the queue of callbacks associated to an event
     * @param {string|string[]} eventName - the name(s) of the event(s) to listen to
     * @param {function} listener - callback function of listener to attach
     * @returns {int} the index of the callback in the array of listeners for a particular event
     * @memberof LokiEventEmitter
     */
    LokiEventEmitter.prototype.on = function (eventName, listener) {
      var event;
      var self = this;

      if (Array.isArray(eventName)) {
        eventName.forEach(function(currentEventName) {
          self.on(currentEventName, listener);
        });
        return listener;
      }

      event = this.events[eventName];
      if (!event) {
        event = this.events[eventName] = [];
      }
      event.push(listener);
      return listener;
    };

    /**
     * emit(eventName, data) - emits a particular event
     * with the option of passing optional parameters which are going to be processed by the callback
     * provided signatures match (i.e. if passing emit(event, arg0, arg1) the listener should take two parameters)
     * @param {string} eventName - the name of the event
     * @param {object=} data - optional object passed with the event
     * @memberof LokiEventEmitter
     */
    LokiEventEmitter.prototype.emit = function (eventName) {
      var self = this;
      var selfArgs = Array.prototype.slice.call(arguments, 1);
      if (eventName && this.events[eventName]) {
        this.events[eventName].forEach(function (listener) {
          if (self.asyncListeners) {
            setTimeout(function () {
              listener.apply(self, selfArgs);
            }, 1);
          } else {
            listener.apply(self, selfArgs);
          }

        });
      } else {
        throw new Error('No event ' + eventName + ' defined');
      }
    };

    /**
     * Alias of LokiEventEmitter.prototype.on
     * addListener(eventName, listener) - adds a listener to the queue of callbacks associated to an event
     * @param {string|string[]} eventName - the name(s) of the event(s) to listen to
     * @param {function} listener - callback function of listener to attach
     * @returns {int} the index of the callback in the array of listeners for a particular event
     * @memberof LokiEventEmitter
     */
    LokiEventEmitter.prototype.addListener = LokiEventEmitter.prototype.on;

    /**
     * removeListener() - removes the listener at position 'index' from the event 'eventName'
     * @param {string|string[]} eventName - the name(s) of the event(s) which the listener is attached to
     * @param {function} listener - the listener callback function to remove from emitter
     * @memberof LokiEventEmitter
     */
    LokiEventEmitter.prototype.removeListener = function (eventName, listener) {
      var self = this;

      if (Array.isArray(eventName)) {
        eventName.forEach(function(currentEventName) {
          self.removeListener(currentEventName, listener);
        });

        return;
      }

      if (this.events[eventName]) {
        var listeners = this.events[eventName];
        listeners.splice(listeners.indexOf(listener), 1);
      }
    };

    /**
     * Loki: The main database class
     * @constructor Loki
     * @implements LokiEventEmitter
     * @param {string} filename - name of the file to be saved to
     * @param {object=} options - (Optional) config options object
     * @param {string} options.env - override environment detection as 'NODEJS', 'BROWSER', 'CORDOVA'
     * @param {boolean} [options.verbose=false] - enable console output
     * @param {boolean} [options.autosave=false] - enables autosave
     * @param {int} [options.autosaveInterval=5000] - time interval (in milliseconds) between saves (if dirty)
     * @param {boolean} [options.autoload=false] - enables autoload on loki instantiation
     * @param {function} options.autoloadCallback - user callback called after database load
     * @param {adapter} options.adapter - an instance of a loki persistence adapter
     * @param {string} [options.serializationMethod='normal'] - ['normal', 'pretty', 'destructured']
     * @param {string} options.destructureDelimiter - string delimiter used for destructured serialization
     * @param {boolean} [options.throttledSaves=true] - debounces multiple calls to to saveDatabase reducing number of disk I/O operations
                                                and guaranteeing proper serialization of the calls.
     */
    function Loki(filename, options) {
      this.filename = filename || 'loki.db';
      this.collections = [];

      // persist version of code which created the database to the database.
      // could use for upgrade scenarios
      this.databaseVersion = 1.5;
      this.engineVersion = 1.5;

      // autosave support (disabled by default)
      // pass autosave: true, autosaveInterval: 6000 in options to set 6 second autosave
      this.autosave = false;
      this.autosaveInterval = 5000;
      this.autosaveHandle = null;
      this.throttledSaves = true;

      this.options = {};

      // currently keeping persistenceMethod and persistenceAdapter as loki level properties that
      // will not or cannot be deserialized.  You are required to configure persistence every time
      // you instantiate a loki object (or use default environment detection) in order to load the database anyways.

      // persistenceMethod could be 'fs', 'localStorage', or 'adapter'
      // this is optional option param, otherwise environment detection will be used
      // if user passes their own adapter we will force this method to 'adapter' later, so no need to pass method option.
      this.persistenceMethod = null;

      // retain reference to optional (non-serializable) persistenceAdapter 'instance'
      this.persistenceAdapter = null;

      // flags used to throttle saves
      this.throttledSavePending = false;
      this.throttledCallbacks = [];

      // enable console output if verbose flag is set (disabled by default)
      this.verbose = options && options.hasOwnProperty('verbose') ? options.verbose : false;

      this.events = {
        'init': [],
        'loaded': [],
        'flushChanges': [],
        'close': [],
        'changes': [],
        'warning': []
      };

      var getENV = function () {
        if (typeof global !== 'undefined' && (global.android || global.NSObject)) {
           // If no adapter assume nativescript which needs adapter to be passed manually
           return 'NATIVESCRIPT'; //nativescript
        }

        if (typeof window === 'undefined') {
          return 'NODEJS';
        }

        if (typeof global !== 'undefined' && global.window && typeof process !== 'undefined') {
          return 'NODEJS'; //node-webkit
        }

        if (typeof document !== 'undefined') {
          if (document.URL.indexOf('http://') === -1 && document.URL.indexOf('https://') === -1) {
            return 'CORDOVA';
          }
          return 'BROWSER';
        }
        return 'CORDOVA';
      };

      // refactored environment detection due to invalid detection for browser environments.
      // if they do not specify an options.env we want to detect env rather than default to nodejs.
      // currently keeping two properties for similar thing (options.env and options.persistenceMethod)
      //   might want to review whether we can consolidate.
      if (options && options.hasOwnProperty('env')) {
        this.ENV = options.env;
      } else {
        this.ENV = getENV();
      }

      // not sure if this is necessary now that i have refactored the line above
      if (this.ENV === 'undefined') {
        this.ENV = 'NODEJS';
      }

      this.configureOptions(options, true);

      this.on('init', this.clearChanges);

    }

    // db class is an EventEmitter
    Loki.prototype = new LokiEventEmitter();
    Loki.prototype.constructor = Loki;

    // experimental support for browserify's abstract syntax scan to pick up dependency of indexed adapter.
    // Hopefully, once this hits npm a browserify require of lokijs should scan the main file and detect this indexed adapter reference.
    Loki.prototype.getIndexedAdapter = function () {
      var adapter;

      if (true) {
        adapter = __webpack_require__(/*! ./loki-indexed-adapter.js */ "./node_modules/lokijs/src/loki-indexed-adapter.js");
      }

      return adapter;
    };


    /**
     * Allows reconfiguring database options
     *
     * @param {object} options - configuration options to apply to loki db object
     * @param {string} options.env - override environment detection as 'NODEJS', 'BROWSER', 'CORDOVA'
     * @param {boolean} options.verbose - enable console output (default is 'false')
     * @param {boolean} options.autosave - enables autosave
     * @param {int} options.autosaveInterval - time interval (in milliseconds) between saves (if dirty)
     * @param {boolean} options.autoload - enables autoload on loki instantiation
     * @param {function} options.autoloadCallback - user callback called after database load
     * @param {adapter} options.adapter - an instance of a loki persistence adapter
     * @param {string} options.serializationMethod - ['normal', 'pretty', 'destructured']
     * @param {string} options.destructureDelimiter - string delimiter used for destructured serialization
     * @param {boolean} initialConfig - (internal) true is passed when loki ctor is invoking
     * @memberof Loki
     */
    Loki.prototype.configureOptions = function (options, initialConfig) {
      var defaultPersistence = {
          'NODEJS': 'fs',
          'BROWSER': 'localStorage',
          'CORDOVA': 'localStorage',
          'MEMORY': 'memory'
        },
        persistenceMethods = {
          'fs': LokiFsAdapter,
          'localStorage': LokiLocalStorageAdapter,
          'memory': LokiMemoryAdapter
        };

      this.options = {};

      this.persistenceMethod = null;
      // retain reference to optional persistence adapter 'instance'
      // currently keeping outside options because it can't be serialized
      this.persistenceAdapter = null;

      // process the options
      if (typeof (options) !== 'undefined') {
        this.options = options;

        if (this.options.hasOwnProperty('persistenceMethod')) {
          // check if the specified persistence method is known
          if (typeof (persistenceMethods[options.persistenceMethod]) == 'function') {
            this.persistenceMethod = options.persistenceMethod;
            this.persistenceAdapter = new persistenceMethods[options.persistenceMethod]();
          }
          // should be throw an error here, or just fall back to defaults ??
        }

        // if user passes adapter, set persistence mode to adapter and retain persistence adapter instance
        if (this.options.hasOwnProperty('adapter')) {
          this.persistenceMethod = 'adapter';
          this.persistenceAdapter = options.adapter;
          this.options.adapter = null;
        }


        // if they want to load database on loki instantiation, now is a good time to load... after adapter set and before possible autosave initiation
        if (options.autoload && initialConfig) {
          // for autoload, let the constructor complete before firing callback
          var self = this;
          setTimeout(function () {
            self.loadDatabase(options, options.autoloadCallback);
          }, 1);
        }

        if (this.options.hasOwnProperty('autosaveInterval')) {
          this.autosaveDisable();
          this.autosaveInterval = parseInt(this.options.autosaveInterval, 10);
        }

        if (this.options.hasOwnProperty('autosave') && this.options.autosave) {
          this.autosaveDisable();
          this.autosave = true;

          if (this.options.hasOwnProperty('autosaveCallback')) {
            this.autosaveEnable(options, options.autosaveCallback);
          } else {
            this.autosaveEnable();
          }
        }

        if (this.options.hasOwnProperty('throttledSaves')) {
          this.throttledSaves = this.options.throttledSaves;
        }
      } // end of options processing

      // ensure defaults exists for options which were not set
      if (!this.options.hasOwnProperty('serializationMethod')) {
        this.options.serializationMethod = 'normal';
      }

      // ensure passed or default option exists
      if (!this.options.hasOwnProperty('destructureDelimiter')) {
        this.options.destructureDelimiter = '$<\n';
      }

      // if by now there is no adapter specified by user nor derived from persistenceMethod: use sensible defaults
      if (this.persistenceAdapter === null) {
        this.persistenceMethod = defaultPersistence[this.ENV];
        if (this.persistenceMethod) {
          this.persistenceAdapter = new persistenceMethods[this.persistenceMethod]();
        }
      }

    };

    /**
     * Copies 'this' database into a new Loki instance. Object references are shared to make lightweight.
     *
     * @param {object} options - apply or override collection level settings
     * @param {bool} options.removeNonSerializable - nulls properties not safe for serialization.
     * @memberof Loki
     */
    Loki.prototype.copy = function(options) {
      // in case running in an environment without accurate environment detection, pass 'NA'
      var databaseCopy = new Loki(this.filename, { env: "NA" });
      var clen, idx;

      options = options || {};

      // currently inverting and letting loadJSONObject do most of the work
      databaseCopy.loadJSONObject(this, { retainDirtyFlags: true });

      // since our JSON serializeReplacer is not invoked for reference database adapters, this will let us mimic
      if(options.hasOwnProperty("removeNonSerializable") && options.removeNonSerializable === true) {
        databaseCopy.autosaveHandle = null;
        databaseCopy.persistenceAdapter = null;

        clen = databaseCopy.collections.length;
        for (idx=0; idx<clen; idx++) {
          databaseCopy.collections[idx].constraints = null;
          databaseCopy.collections[idx].ttl = null;
        }
      }

      return databaseCopy;
    };

    /**
     * Adds a collection to the database.
     * @param {string} name - name of collection to add
     * @param {object=} options - (optional) options to configure collection with.
     * @param {array=} [options.unique=[]] - array of property names to define unique constraints for
     * @param {array=} [options.exact=[]] - array of property names to define exact constraints for
     * @param {array=} [options.indices=[]] - array property names to define binary indexes for
     * @param {boolean} [options.asyncListeners=false] - whether listeners are called asynchronously
     * @param {boolean} [options.disableMeta=false] - set to true to disable meta property on documents
     * @param {boolean} [options.disableChangesApi=true] - set to false to enable Changes Api
     * @param {boolean} [options.disableDeltaChangesApi=true] - set to false to enable Delta Changes API (requires Changes API, forces cloning)
     * @param {boolean} [options.autoupdate=false] - use Object.observe to update objects automatically
     * @param {boolean} [options.clone=false] - specify whether inserts and queries clone to/from user
     * @param {string} [options.cloneMethod='parse-stringify'] - 'parse-stringify', 'jquery-extend-deep', 'shallow, 'shallow-assign'
     * @param {int=} options.ttl - age of document (in ms.) before document is considered aged/stale.
     * @param {int=} options.ttlInterval - time interval for clearing out 'aged' documents; not set by default.
     * @returns {Collection} a reference to the collection which was just added
     * @memberof Loki
     */
    Loki.prototype.addCollection = function (name, options) {
      var i,
        len = this.collections.length;

      if (options && options.disableMeta === true) {
        if (options.disableChangesApi === false) {
          throw new Error("disableMeta option cannot be passed as true when disableChangesApi is passed as false");
        }
        if (options.disableDeltaChangesApi === false) {
          throw new Error("disableMeta option cannot be passed as true when disableDeltaChangesApi is passed as false");
        }
        if (typeof options.ttl === "number" && options.ttl > 0) {
          throw new Error("disableMeta option cannot be passed as true when ttl is enabled");
        }
      }

      for (i = 0; i < len; i += 1) {
        if (this.collections[i].name === name) {
          return this.collections[i];
        }
      }

      var collection = new Collection(name, options);
      this.collections.push(collection);

      if (this.verbose)
        collection.console = console;

      return collection;
    };

    Loki.prototype.loadCollection = function (collection) {
      if (!collection.name) {
        throw new Error('Collection must have a name property to be loaded');
      }
      this.collections.push(collection);
    };

    /**
     * Retrieves reference to a collection by name.
     * @param {string} collectionName - name of collection to look up
     * @returns {Collection} Reference to collection in database by that name, or null if not found
     * @memberof Loki
     */
    Loki.prototype.getCollection = function (collectionName) {
      var i,
        len = this.collections.length;

      for (i = 0; i < len; i += 1) {
        if (this.collections[i].name === collectionName) {
          return this.collections[i];
        }
      }

      // no such collection
      this.emit('warning', 'collection ' + collectionName + ' not found');
      return null;
    };

    /**
     * Renames an existing loki collection
     * @param {string} oldName - name of collection to rename
     * @param {string} newName - new name of collection
     * @returns {Collection} reference to the newly renamed collection
     * @memberof Loki
     */
    Loki.prototype.renameCollection = function (oldName, newName) {
      var c = this.getCollection(oldName);

      if (c) {
        c.name = newName;
      }

      return c;
    };

    /**
     * Returns a list of collections in the database.
     * @returns {object[]} array of objects containing 'name', 'type', and 'count' properties.
     * @memberof Loki
     */
    Loki.prototype.listCollections = function () {

      var i = this.collections.length,
        colls = [];

      while (i--) {
        colls.push({
          name: this.collections[i].name,
          type: this.collections[i].objType,
          count: this.collections[i].data.length
        });
      }
      return colls;
    };

    /**
     * Removes a collection from the database.
     * @param {string} collectionName - name of collection to remove
     * @memberof Loki
     */
    Loki.prototype.removeCollection = function (collectionName) {
      var i,
        len = this.collections.length;

      for (i = 0; i < len; i += 1) {
        if (this.collections[i].name === collectionName) {
          var tmpcol = new Collection(collectionName, {});
          var curcol = this.collections[i];
          for (var prop in curcol) {
            if (curcol.hasOwnProperty(prop) && tmpcol.hasOwnProperty(prop)) {
              curcol[prop] = tmpcol[prop];
            }
          }
          this.collections.splice(i, 1);
          return;
        }
      }
    };

    Loki.prototype.getName = function () {
      return this.name;
    };

    /**
     * serializeReplacer - used to prevent certain properties from being serialized
     *
     */
    Loki.prototype.serializeReplacer = function (key, value) {
      switch (key) {
      case 'autosaveHandle':
      case 'persistenceAdapter':
      case 'constraints':
      case 'ttl':
        return null;
      case 'throttledSavePending':
      case 'throttledCallbacks':
        return undefined;
      default:
        return value;
      }
    };

    /**
     * Serialize database to a string which can be loaded via {@link Loki#loadJSON}
     *
     * @returns {string} Stringified representation of the loki database.
     * @memberof Loki
     */
    Loki.prototype.serialize = function (options) {
      options = options || {};

      if (!options.hasOwnProperty("serializationMethod")) {
        options.serializationMethod = this.options.serializationMethod;
      }

      switch(options.serializationMethod) {
        case "normal": return JSON.stringify(this, this.serializeReplacer);
        case "pretty": return JSON.stringify(this, this.serializeReplacer, 2);
        case "destructured": return this.serializeDestructured(); // use default options
        default: return JSON.stringify(this, this.serializeReplacer);
      }
    };

    // alias of serialize
    Loki.prototype.toJson = Loki.prototype.serialize;

    /**
     * Database level destructured JSON serialization routine to allow alternate serialization methods.
     * Internally, Loki supports destructuring via loki "serializationMethod' option and
     * the optional LokiPartitioningAdapter class. It is also available if you wish to do
     * your own structured persistence or data exchange.
     *
     * @param {object=} options - output format options for use externally to loki
     * @param {bool=} options.partitioned - (default: false) whether db and each collection are separate
     * @param {int=} options.partition - can be used to only output an individual collection or db (-1)
     * @param {bool=} options.delimited - (default: true) whether subitems are delimited or subarrays
     * @param {string=} options.delimiter - override default delimiter
     *
     * @returns {string|array} A custom, restructured aggregation of independent serializations.
     * @memberof Loki
     */
    Loki.prototype.serializeDestructured = function(options) {
      var idx, sidx, result, resultlen;
      var reconstruct = [];
      var dbcopy;

      options = options || {};

      if (!options.hasOwnProperty("partitioned")) {
        options.partitioned = false;
      }

      if (!options.hasOwnProperty("delimited")) {
        options.delimited = true;
      }

      if (!options.hasOwnProperty("delimiter")) {
        options.delimiter = this.options.destructureDelimiter;
      }

      // 'partitioned' along with 'partition' of 0 or greater is a request for single collection serialization
      if (options.partitioned === true && options.hasOwnProperty("partition") && options.partition >= 0) {
        return this.serializeCollection({
          delimited: options.delimited,
          delimiter: options.delimiter,
          collectionIndex: options.partition
        });
      }

      // not just an individual collection, so we will need to serialize db container via shallow copy
      dbcopy = new Loki(this.filename);
      dbcopy.loadJSONObject(this);

      for(idx=0; idx < dbcopy.collections.length; idx++) {
        dbcopy.collections[idx].data = [];
      }

      // if we -only- wanted the db container portion, return it now
      if (options.partitioned === true && options.partition === -1) {
        // since we are deconstructing, override serializationMethod to normal for here
        return dbcopy.serialize({
          serializationMethod: "normal"
        });
      }

      // at this point we must be deconstructing the entire database
      // start by pushing db serialization into first array element
      reconstruct.push(dbcopy.serialize({
          serializationMethod: "normal"
      }));

      dbcopy = null;

      // push collection data into subsequent elements
      for(idx=0; idx < this.collections.length; idx++) {
        result = this.serializeCollection({
          delimited: options.delimited,
          delimiter: options.delimiter,
          collectionIndex: idx
        });

        // NDA : Non-Delimited Array : one iterable concatenated array with empty string collection partitions
        if (options.partitioned === false && options.delimited === false) {
          if (!Array.isArray(result)) {
            throw new Error("a nondelimited, non partitioned collection serialization did not return an expected array");
          }

          // Array.concat would probably duplicate memory overhead for copying strings.
          // Instead copy each individually, and clear old value after each copy.
          // Hopefully this will allow g.c. to reduce memory pressure, if needed.
          resultlen = result.length;

          for (sidx=0; sidx < resultlen; sidx++) {
            reconstruct.push(result[sidx]);
            result[sidx] = null;
          }

          reconstruct.push("");
        }
        else {
          reconstruct.push(result);
        }
      }

      // Reconstruct / present results according to four combinations : D, DA, NDA, NDAA
      if (options.partitioned) {
        // DA : Delimited Array of strings [0] db [1] collection [n] collection { partitioned: true, delimited: true }
        // useful for simple future adaptations of existing persistence adapters to save collections separately
        if (options.delimited) {
          return reconstruct;
        }
        // NDAA : Non-Delimited Array with subArrays. db at [0] and collection subarrays at [n] { partitioned: true, delimited : false }
        // This format might be the most versatile for 'rolling your own' partitioned sync or save.
        // Memory overhead can be reduced by specifying a specific partition, but at this code path they did not, so its all.
        else {
          return reconstruct;
        }
      }
      else {
        // D : one big Delimited string { partitioned: false, delimited : true }
        // This is the method Loki will use internally if 'destructured'.
        // Little memory overhead improvements but does not require multiple asynchronous adapter call scheduling
        if (options.delimited) {
          // indicate no more collections
          reconstruct.push("");

          return reconstruct.join(options.delimiter);
        }
        // NDA : Non-Delimited Array : one iterable array with empty string collection partitions { partitioned: false, delimited: false }
        // This format might be best candidate for custom synchronous syncs or saves
        else {
          // indicate no more collections
          reconstruct.push("");

          return reconstruct;
        }
      }

      reconstruct.push("");

      return reconstruct.join(delim);
    };

    /**
     * Collection level utility method to serialize a collection in a 'destructured' format
     *
     * @param {object=} options - used to determine output of method
     * @param {int} options.delimited - whether to return single delimited string or an array
     * @param {string} options.delimiter - (optional) if delimited, this is delimiter to use
     * @param {int} options.collectionIndex -  specify which collection to serialize data for
     *
     * @returns {string|array} A custom, restructured aggregation of independent serializations for a single collection.
     * @memberof Loki
     */
    Loki.prototype.serializeCollection = function(options) {
      var doccount,
        docidx,
        resultlines = [];

      options = options || {};

      if (!options.hasOwnProperty("delimited")) {
        options.delimited = true;
      }

      if (!options.hasOwnProperty("collectionIndex")) {
        throw new Error("serializeCollection called without 'collectionIndex' option");
      }

      doccount = this.collections[options.collectionIndex].data.length;

      resultlines = [];

      for(docidx=0; docidx<doccount; docidx++) {
        resultlines.push(JSON.stringify(this.collections[options.collectionIndex].data[docidx]));
      }

      // D and DA
      if (options.delimited) {
         // indicate no more documents in collection (via empty delimited string)
        resultlines.push("");

        return resultlines.join(options.delimiter);
      }
      else {
        // NDAA and NDA
        return resultlines;
      }
    };

    /**
     * Database level destructured JSON deserialization routine to minimize memory overhead.
     * Internally, Loki supports destructuring via loki "serializationMethod' option and
     * the optional LokiPartitioningAdapter class. It is also available if you wish to do
     * your own structured persistence or data exchange.
     *
     * @param {string|array} destructuredSource - destructured json or array to deserialize from
     * @param {object=} options - source format options
     * @param {bool=} [options.partitioned=false] - whether db and each collection are separate
     * @param {int=} options.partition - can be used to deserialize only a single partition
     * @param {bool=} [options.delimited=true] - whether subitems are delimited or subarrays
     * @param {string=} options.delimiter - override default delimiter
     *
     * @returns {object|array} An object representation of the deserialized database, not yet applied to 'this' db or document array
     * @memberof Loki
     */
    Loki.prototype.deserializeDestructured = function(destructuredSource, options) {
      var workarray=[];
      var len, cdb;
      var idx, collIndex=0, collCount, lineIndex=1, done=false;
      var currLine, currObject;

      options = options || {};

      if (!options.hasOwnProperty("partitioned")) {
        options.partitioned = false;
      }

      if (!options.hasOwnProperty("delimited")) {
        options.delimited = true;
      }

      if (!options.hasOwnProperty("delimiter")) {
        options.delimiter = this.options.destructureDelimiter;
      }

      // Partitioned
      // DA : Delimited Array of strings [0] db [1] collection [n] collection { partitioned: true, delimited: true }
      // NDAA : Non-Delimited Array with subArrays. db at [0] and collection subarrays at [n] { partitioned: true, delimited : false }
      // -or- single partition
      if (options.partitioned) {
        // handle single partition
        if (options.hasOwnProperty('partition')) {
          // db only
          if (options.partition === -1) {
            cdb = JSON.parse(destructuredSource[0]);

            return cdb;
          }

          // single collection, return doc array
          return this.deserializeCollection(destructuredSource[options.partition+1], options);
        }

        // Otherwise we are restoring an entire partitioned db
        cdb = JSON.parse(destructuredSource[0]);
        collCount = cdb.collections.length;
        for(collIndex=0; collIndex<collCount; collIndex++) {
          // attach each collection docarray to container collection data, add 1 to collection array index since db is at 0
          cdb.collections[collIndex].data = this.deserializeCollection(destructuredSource[collIndex+1], options);
        }

        return cdb;
      }

      // Non-Partitioned
      // D : one big Delimited string { partitioned: false, delimited : true }
      // NDA : Non-Delimited Array : one iterable array with empty string collection partitions { partitioned: false, delimited: false }

      // D
      if (options.delimited) {
        workarray = destructuredSource.split(options.delimiter);
        destructuredSource = null; // lower memory pressure
        len = workarray.length;

        if (len === 0) {
          return null;
        }
      }
      // NDA
      else {
        workarray = destructuredSource;
      }

      // first line is database and collection shells
      cdb = JSON.parse(workarray[0]);
      collCount = cdb.collections.length;
      workarray[0] = null;

      while (!done) {
        currLine = workarray[lineIndex];

        // empty string indicates either end of collection or end of file
        if (workarray[lineIndex] === "") {
          // if no more collections to load into, we are done
          if (++collIndex > collCount) {
            done = true;
          }
        }
        else {
          currObject = JSON.parse(workarray[lineIndex]);
          cdb.collections[collIndex].data.push(currObject);
        }

        // lower memory pressure and advance iterator
        workarray[lineIndex++] = null;
      }

      return cdb;
    };

    /**
     * Collection level utility function to deserializes a destructured collection.
     *
     * @param {string|array} destructuredSource - destructured representation of collection to inflate
     * @param {object=} options - used to describe format of destructuredSource input
     * @param {int=} [options.delimited=false] - whether source is delimited string or an array
     * @param {string=} options.delimiter - if delimited, this is delimiter to use (if other than default)
     *
     * @returns {array} an array of documents to attach to collection.data.
     * @memberof Loki
     */
    Loki.prototype.deserializeCollection = function(destructuredSource, options) {
      var workarray=[];
      var idx, len;

      options = options || {};

      if (!options.hasOwnProperty("partitioned")) {
        options.partitioned = false;
      }

      if (!options.hasOwnProperty("delimited")) {
        options.delimited = true;
      }

      if (!options.hasOwnProperty("delimiter")) {
        options.delimiter = this.options.destructureDelimiter;
      }

      if (options.delimited) {
        workarray = destructuredSource.split(options.delimiter);
        workarray.pop();
      }
      else {
        workarray = destructuredSource;
      }

      len = workarray.length;
      for (idx=0; idx < len; idx++) {
        workarray[idx] = JSON.parse(workarray[idx]);
      }

      return workarray;
    };

    /**
     * Inflates a loki database from a serialized JSON string
     *
     * @param {string} serializedDb - a serialized loki database string
     * @param {object=} options - apply or override collection level settings
     * @param {bool} options.retainDirtyFlags - whether collection dirty flags will be preserved
     * @memberof Loki
     */
    Loki.prototype.loadJSON = function (serializedDb, options) {
      var dbObject;
      if (serializedDb.length === 0) {
        dbObject = {};
      } else {
        // using option defined in instantiated db not what was in serialized db
        switch (this.options.serializationMethod) {
          case "normal":
          case "pretty": dbObject = JSON.parse(serializedDb); break;
          case "destructured": dbObject = this.deserializeDestructured(serializedDb); break;
          default:  dbObject = JSON.parse(serializedDb); break;
        }
      }

      this.loadJSONObject(dbObject, options);
    };

    /**
     * Inflates a loki database from a JS object
     *
     * @param {object} dbObject - a serialized loki database string
     * @param {object=} options - apply or override collection level settings
     * @param {bool} options.retainDirtyFlags - whether collection dirty flags will be preserved
     * @memberof Loki
     */
    Loki.prototype.loadJSONObject = function (dbObject, options) {
      var i = 0,
        len = dbObject.collections ? dbObject.collections.length : 0,
        coll,
        copyColl,
        clen,
        j,
        loader,
        collObj;

      this.name = dbObject.name;

      // restore save throttled boolean only if not defined in options
      if (dbObject.hasOwnProperty('throttledSaves') && options && !options.hasOwnProperty('throttledSaves')) {
        this.throttledSaves = dbObject.throttledSaves;
      }

      this.collections = [];

      function makeLoader(coll) {
        var collOptions = options[coll.name];
        var inflater;

        if(collOptions.proto) {
          inflater = collOptions.inflate || Utils.copyProperties;

          return function(data) {
            var collObj = new(collOptions.proto)();
            inflater(data, collObj);
            return collObj;
          };
        }

        return collOptions.inflate;
      }

      for (i; i < len; i += 1) {
        coll = dbObject.collections[i];

        copyColl = this.addCollection(coll.name, { disableChangesApi: coll.disableChangesApi, disableDeltaChangesApi: coll.disableDeltaChangesApi, disableMeta: coll.disableMeta });

        copyColl.adaptiveBinaryIndices = coll.hasOwnProperty('adaptiveBinaryIndices')?(coll.adaptiveBinaryIndices === true): false;
        copyColl.transactional = coll.transactional;
        copyColl.asyncListeners = coll.asyncListeners;
        copyColl.cloneObjects = coll.cloneObjects;
        copyColl.cloneMethod = coll.cloneMethod || "parse-stringify";
        copyColl.autoupdate = coll.autoupdate;
        copyColl.changes = coll.changes;

        if (options && options.retainDirtyFlags === true) {
          copyColl.dirty = coll.dirty;
        }
        else {
          copyColl.dirty = false;
        }

        // load each element individually
        clen = coll.data.length;
        j = 0;
        if (options && options.hasOwnProperty(coll.name)) {
          loader = makeLoader(coll);

          for (j; j < clen; j++) {
            collObj = loader(coll.data[j]);
            copyColl.data[j] = collObj;
            copyColl.addAutoUpdateObserver(collObj);
          }
        } else {

          for (j; j < clen; j++) {
            copyColl.data[j] = coll.data[j];
            copyColl.addAutoUpdateObserver(copyColl.data[j]);
          }
        }

        copyColl.maxId = (typeof coll.maxId === 'undefined') ? 0 : coll.maxId;
        copyColl.idIndex = coll.idIndex;
        if (typeof (coll.binaryIndices) !== 'undefined') {
          copyColl.binaryIndices = coll.binaryIndices;
        }
        if (typeof coll.transforms !== 'undefined') {
          copyColl.transforms = coll.transforms;
        }

        copyColl.ensureId();

        // regenerate unique indexes
        copyColl.uniqueNames = [];
        if (coll.hasOwnProperty("uniqueNames")) {
          copyColl.uniqueNames = coll.uniqueNames;
          for (j = 0; j < copyColl.uniqueNames.length; j++) {
            copyColl.ensureUniqueIndex(copyColl.uniqueNames[j]);
          }
        }

        // in case they are loading a database created before we added dynamic views, handle undefined
        if (typeof (coll.DynamicViews) === 'undefined') continue;

        // reinflate DynamicViews and attached Resultsets
        for (var idx = 0; idx < coll.DynamicViews.length; idx++) {
          var colldv = coll.DynamicViews[idx];

          var dv = copyColl.addDynamicView(colldv.name, colldv.options);
          dv.resultdata = colldv.resultdata;
          dv.resultsdirty = colldv.resultsdirty;
          dv.filterPipeline = colldv.filterPipeline;

          dv.sortCriteria = colldv.sortCriteria;
          dv.sortFunction = null;

          dv.sortDirty = colldv.sortDirty;
          dv.resultset.filteredrows = colldv.resultset.filteredrows;
          dv.resultset.filterInitialized = colldv.resultset.filterInitialized;

          dv.rematerialize({
            removeWhereFilters: true
          });
        }

        // Upgrade Logic for binary index refactoring at version 1.5
        if (dbObject.databaseVersion < 1.5) {
            // rebuild all indices
            copyColl.ensureAllIndexes(true);
            copyColl.dirty = true;
        }
      }
    };

    /**
     * Emits the close event. In autosave scenarios, if the database is dirty, this will save and disable timer.
     * Does not actually destroy the db.
     *
     * @param {function=} callback - (Optional) if supplied will be registered with close event before emitting.
     * @memberof Loki
     */
    Loki.prototype.close = function (callback) {
      // for autosave scenarios, we will let close perform final save (if dirty)
      // For web use, you might call from window.onbeforeunload to shutdown database, saving pending changes
      if (this.autosave) {
        this.autosaveDisable();
        if (this.autosaveDirty()) {
          this.saveDatabase(callback);
          callback = undefined;
        }
      }

      if (callback) {
        this.on('close', callback);
      }
      this.emit('close');
    };

    /**-------------------------+
    | Changes API               |
    +--------------------------*/

    /**
     * The Changes API enables the tracking the changes occurred in the collections since the beginning of the session,
     * so it's possible to create a differential dataset for synchronization purposes (possibly to a remote db)
     */

    /**
     * (Changes API) : takes all the changes stored in each
     * collection and creates a single array for the entire database. If an array of names
     * of collections is passed then only the included collections will be tracked.
     *
     * @param {array=} optional array of collection names. No arg means all collections are processed.
     * @returns {array} array of changes
     * @see private method createChange() in Collection
     * @memberof Loki
     */
    Loki.prototype.generateChangesNotification = function (arrayOfCollectionNames) {
      function getCollName(coll) {
        return coll.name;
      }
      var changes = [],
        selectedCollections = arrayOfCollectionNames || this.collections.map(getCollName);

      this.collections.forEach(function (coll) {
        if (selectedCollections.indexOf(getCollName(coll)) !== -1) {
          changes = changes.concat(coll.getChanges());
        }
      });
      return changes;
    };

    /**
     * (Changes API) - stringify changes for network transmission
     * @returns {string} string representation of the changes
     * @memberof Loki
     */
    Loki.prototype.serializeChanges = function (collectionNamesArray) {
      return JSON.stringify(this.generateChangesNotification(collectionNamesArray));
    };

    /**
     * (Changes API) : clears all the changes in all collections.
     * @memberof Loki
     */
    Loki.prototype.clearChanges = function () {
      this.collections.forEach(function (coll) {
        if (coll.flushChanges) {
          coll.flushChanges();
        }
      });
    };

    /*------------------+
    | PERSISTENCE       |
    -------------------*/

    /** there are two build in persistence adapters for internal use
     * fs             for use in Nodejs type environments
     * localStorage   for use in browser environment
     * defined as helper classes here so its easy and clean to use
     */

    /**
     * In in-memory persistence adapter for an in-memory database.
     * This simple 'key/value' adapter is intended for unit testing and diagnostics.
     *
     * @param {object=} options - memory adapter options
     * @param {boolean} [options.asyncResponses=false] - whether callbacks are invoked asynchronously
     * @param {int} [options.asyncTimeout=50] - timeout in ms to queue callbacks
     * @constructor LokiMemoryAdapter
     */
    function LokiMemoryAdapter(options) {
      this.hashStore = {};
      this.options = options || {};

      if (!this.options.hasOwnProperty('asyncResponses')) {
        this.options.asyncResponses = false;
      }

      if (!this.options.hasOwnProperty('asyncTimeout')) {
        this.options.asyncTimeout = 50; // 50 ms default
      }
    }

    /**
     * Loads a serialized database from its in-memory store.
     * (Loki persistence adapter interface function)
     *
     * @param {string} dbname - name of the database (filename/keyname)
     * @param {function} callback - adapter callback to return load result to caller
     * @memberof LokiMemoryAdapter
     */
    LokiMemoryAdapter.prototype.loadDatabase = function (dbname, callback) {
      var self=this;

      if (this.options.asyncResponses) {
        setTimeout(function() {
          if (self.hashStore.hasOwnProperty(dbname)) {
            callback(self.hashStore[dbname].value);
          }
          else {
            // database doesn't exist, return falsy
            callback (null);
          }
        }, this.options.asyncTimeout);
      }
      else {
        if (this.hashStore.hasOwnProperty(dbname)) {
          // database doesn't exist, return falsy
          callback(this.hashStore[dbname].value);
        }
        else {
          callback (null);
        }
      }
    };

    /**
     * Saves a serialized database to its in-memory store.
     * (Loki persistence adapter interface function)
     *
     * @param {string} dbname - name of the database (filename/keyname)
     * @param {function} callback - adapter callback to return load result to caller
     * @memberof LokiMemoryAdapter
     */
    LokiMemoryAdapter.prototype.saveDatabase = function (dbname, dbstring, callback) {
      var self=this;
      var saveCount;

      if (this.options.asyncResponses) {
        setTimeout(function() {
          saveCount = (self.hashStore.hasOwnProperty(dbname)?self.hashStore[dbname].savecount:0);

          self.hashStore[dbname] = {
            savecount: saveCount+1,
            lastsave: new Date(),
            value: dbstring
          };

          callback();
        }, this.options.asyncTimeout);
      }
      else {
        saveCount = (this.hashStore.hasOwnProperty(dbname)?this.hashStore[dbname].savecount:0);

        this.hashStore[dbname] = {
          savecount: saveCount+1,
          lastsave: new Date(),
          value: dbstring
        };

        callback();
      }
    };

    /**
     * Deletes a database from its in-memory store.
     *
     * @param {string} dbname - name of the database (filename/keyname)
     * @param {function} callback - function to call when done
     * @memberof LokiMemoryAdapter
     */
    LokiMemoryAdapter.prototype.deleteDatabase = function(dbname, callback) {
      if (this.hashStore.hasOwnProperty(dbname)) {
        delete this.hashStore[dbname];
      }

      if (typeof callback === "function") {
        callback();
      }
    };

    /**
     * An adapter for adapters.  Converts a non reference mode adapter into a reference mode adapter
     * which can perform destructuring and partioning.  Each collection will be stored in its own key/save and
     * only dirty collections will be saved.  If you  turn on paging with default page size of 25megs and save
     * a 75 meg collection it should use up roughly 3 save slots (key/value pairs sent to inner adapter).
     * A dirty collection that spans three pages will save all three pages again
     * Paging mode was added mainly because Chrome has issues saving 'too large' of a string within a
     * single indexeddb row.  If a single document update causes the collection to be flagged as dirty, all
     * of that collection's pages will be written on next save.
     *
     * @param {object} adapter - reference to a 'non-reference' mode loki adapter instance.
     * @param {object=} options - configuration options for partitioning and paging
     * @param {bool} options.paging - (default: false) set to true to enable paging collection data.
     * @param {int} options.pageSize - (default : 25MB) you can use this to limit size of strings passed to inner adapter.
     * @param {string} options.delimiter - allows you to override the default delimeter
     * @constructor LokiPartitioningAdapter
     */
    function LokiPartitioningAdapter(adapter, options) {
      this.mode = "reference";
      this.adapter = null;
      this.options = options || {};
      this.dbref = null;
      this.dbname = "";
      this.pageIterator = {};

      // verify user passed an appropriate adapter
      if (adapter) {
        if (adapter.mode === "reference") {
          throw new Error("LokiPartitioningAdapter cannot be instantiated with a reference mode adapter");
        }
        else {
          this.adapter = adapter;
        }
      }
      else {
        throw new Error("LokiPartitioningAdapter requires a (non-reference mode) adapter on construction");
      }

      // set collection paging defaults
      if (!this.options.hasOwnProperty("paging")) {
        this.options.paging = false;
      }

      // default to page size of 25 megs (can be up to your largest serialized object size larger than this)
      if (!this.options.hasOwnProperty("pageSize")) {
        this.options.pageSize = 25*1024*1024;
      }

      if (!this.options.hasOwnProperty("delimiter")) {
        this.options.delimiter = '$<\n';
      }
    }

    /**
     * Loads a database which was partitioned into several key/value saves.
     * (Loki persistence adapter interface function)
     *
     * @param {string} dbname - name of the database (filename/keyname)
     * @param {function} callback - adapter callback to return load result to caller
     * @memberof LokiPartitioningAdapter
     */
    LokiPartitioningAdapter.prototype.loadDatabase = function (dbname, callback) {
      var self=this;
      this.dbname = dbname;
      this.dbref = new Loki(dbname);

      // load the db container (without data)
      this.adapter.loadDatabase(dbname, function(result) {
        // empty database condition is for inner adapter return null/undefined/falsy
        if (!result) {
          // partition 0 not found so new database, no need to try to load other partitions.
          // return same falsy result to loadDatabase to signify no database exists (yet)
          callback(result);
          return;
        }

        if (typeof result !== "string") {
          callback(new Error("LokiPartitioningAdapter received an unexpected response from inner adapter loadDatabase()"));
        }

        // I will want to use loki destructuring helper methods so i will inflate into typed instance
        var db = JSON.parse(result);
        self.dbref.loadJSONObject(db);
        db = null;

        var clen = self.dbref.collections.length;

        if (self.dbref.collections.length === 0) {
          callback(self.dbref);
          return;
        }

        self.pageIterator = {
          collection: 0,
          pageIndex: 0
        };

        self.loadNextPartition(0, function() {
          callback(self.dbref);
        });
      });
    };

    /**
     * Used to sequentially load each collection partition, one at a time.
     *
     * @param {int} partition - ordinal collection position to load next
     * @param {function} callback - adapter callback to return load result to caller
     */
    LokiPartitioningAdapter.prototype.loadNextPartition = function(partition, callback) {
      var keyname = this.dbname + "." + partition;
      var self=this;

      if (this.options.paging === true) {
        this.pageIterator.pageIndex = 0;
        this.loadNextPage(callback);
        return;
      }

      this.adapter.loadDatabase(keyname, function(result) {
        var data = self.dbref.deserializeCollection(result, { delimited: true, collectionIndex: partition });
        self.dbref.collections[partition].data = data;

        if (++partition < self.dbref.collections.length) {
          self.loadNextPartition(partition, callback);
        }
        else {
          callback();
        }
      });
    };

    /**
     * Used to sequentially load the next page of collection partition, one at a time.
     *
     * @param {function} callback - adapter callback to return load result to caller
     */
    LokiPartitioningAdapter.prototype.loadNextPage = function(callback) {
      // calculate name for next saved page in sequence
      var keyname = this.dbname + "." + this.pageIterator.collection + "." + this.pageIterator.pageIndex;
      var self=this;

      // load whatever page is next in sequence
      this.adapter.loadDatabase(keyname, function(result) {
        var data = result.split(self.options.delimiter);
        result = ""; // free up memory now that we have split it into array
        var dlen = data.length;
        var idx;

        // detect if last page by presence of final empty string element and remove it if so
        var isLastPage = (data[dlen-1] === "");
        if (isLastPage) {
          data.pop();
          dlen = data.length;
          // empty collections are just a delimiter meaning two blank items
          if (data[dlen-1] === "" && dlen === 1) {
            data.pop();
            dlen = data.length;
          }
        }

        // convert stringified array elements to object instances and push to collection data
        for(idx=0; idx < dlen; idx++) {
          self.dbref.collections[self.pageIterator.collection].data.push(JSON.parse(data[idx]));
          data[idx] = null;
        }
        data = [];

        // if last page, we are done with this partition
        if (isLastPage) {

          // if there are more partitions, kick off next partition load
          if (++self.pageIterator.collection < self.dbref.collections.length) {
            self.loadNextPartition(self.pageIterator.collection, callback);
          }
          else {
            callback();
          }
        }
        else {
          self.pageIterator.pageIndex++;
          self.loadNextPage(callback);
        }
      });
    };

    /**
     * Saves a database by partioning into separate key/value saves.
     * (Loki 'reference mode' persistence adapter interface function)
     *
     * @param {string} dbname - name of the database (filename/keyname)
     * @param {object} dbref - reference to database which we will partition and save.
     * @param {function} callback - adapter callback to return load result to caller
     *
     * @memberof LokiPartitioningAdapter
     */
    LokiPartitioningAdapter.prototype.exportDatabase = function(dbname, dbref, callback) {
      var self=this;
      var idx, clen = dbref.collections.length;

      this.dbref = dbref;
      this.dbname = dbname;

      // queue up dirty partitions to be saved
      this.dirtyPartitions = [-1];
      for(idx=0; idx<clen; idx++) {
        if (dbref.collections[idx].dirty) {
          this.dirtyPartitions.push(idx);
        }
      }

      this.saveNextPartition(function(err) {
        callback(err);
      });
    };

    /**
     * Helper method used internally to save each dirty collection, one at a time.
     *
     * @param {function} callback - adapter callback to return load result to caller
     */
    LokiPartitioningAdapter.prototype.saveNextPartition = function(callback) {
      var self=this;
      var partition = this.dirtyPartitions.shift();
      var keyname = this.dbname + ((partition===-1)?"":("." + partition));

      // if we are doing paging and this is collection partition
      if (this.options.paging && partition !== -1) {
        this.pageIterator = {
          collection: partition,
          docIndex: 0,
          pageIndex: 0
        };

        // since saveNextPage recursively calls itself until done, our callback means this whole paged partition is finished
        this.saveNextPage(function(err) {
          if (self.dirtyPartitions.length === 0) {
            callback(err);
          }
          else {
            self.saveNextPartition(callback);
          }
        });
        return;
      }

      // otherwise this is 'non-paged' partioning...
      var result = this.dbref.serializeDestructured({
        partitioned : true,
        delimited: true,
        partition: partition
      });

      this.adapter.saveDatabase(keyname, result, function(err) {
        if (err) {
          callback(err);
          return;
        }

        if (self.dirtyPartitions.length === 0) {
          callback(null);
        }
        else {
          self.saveNextPartition(callback);
        }
      });
    };

    /**
     * Helper method used internally to generate and save the next page of the current (dirty) partition.
     *
     * @param {function} callback - adapter callback to return load result to caller
     */
    LokiPartitioningAdapter.prototype.saveNextPage = function(callback) {
      var self=this;
      var coll = this.dbref.collections[this.pageIterator.collection];
      var keyname = this.dbname + "." + this.pageIterator.collection + "." + this.pageIterator.pageIndex;
      var pageLen=0,
        cdlen = coll.data.length,
        delimlen = this.options.delimiter.length;
      var serializedObject = "",
        pageBuilder = "";
      var doneWithPartition=false,
        doneWithPage=false;

      var pageSaveCallback = function(err) {
        pageBuilder = "";

        if (err) {
          callback(err);
        }

        // update meta properties then continue process by invoking callback
        if (doneWithPartition) {
          callback(null);
        }
        else {
          self.pageIterator.pageIndex++;
          self.saveNextPage(callback);
        }
      };

      if (coll.data.length === 0) {
        doneWithPartition = true;
      }

      while (true) {
        if (!doneWithPartition) {
          // serialize object
          serializedObject = JSON.stringify(coll.data[this.pageIterator.docIndex]);
          pageBuilder += serializedObject;
          pageLen += serializedObject.length;

          // if no more documents in collection to add, we are done with partition
          if (++this.pageIterator.docIndex >= cdlen) doneWithPartition = true;
        }
        // if our current page is bigger than defined pageSize, we are done with page
        if (pageLen >= this.options.pageSize) doneWithPage = true;

        // if not done with current page, need delimiter before next item
        // if done with partition we also want a delmiter to indicate 'end of pages' final empty row
        if (!doneWithPage || doneWithPartition) {
          pageBuilder += this.options.delimiter;
          pageLen += delimlen;
        }

        // if we are done with page save it and pass off to next recursive call or callback
        if (doneWithPartition || doneWithPage) {
          this.adapter.saveDatabase(keyname, pageBuilder, pageSaveCallback);
          return;
        }
      }
    };

    /**
     * A loki persistence adapter which persists using node fs module
     * @constructor LokiFsAdapter
     */
    function LokiFsAdapter() {
      try {
        this.fs = __webpack_require__(/*! fs */ "./node_modules/node-libs-browser/mock/empty.js");
      }catch(e) {
        this.fs = null;
      }
    }

    /**
     * loadDatabase() - Load data from file, will throw an error if the file does not exist
     * @param {string} dbname - the filename of the database to load
     * @param {function} callback - the callback to handle the result
     * @memberof LokiFsAdapter
     */
    LokiFsAdapter.prototype.loadDatabase = function loadDatabase(dbname, callback) {
      var self = this;

      this.fs.stat(dbname, function (err, stats) {
        if (!err && stats.isFile()) {
          self.fs.readFile(dbname, {
            encoding: 'utf8'
          }, function readFileCallback(err, data) {
            if (err) {
              callback(new Error(err));
            } else {
              callback(data);
            }
          });
        }
        else {
          callback(null);
        }
      });
    };

    /**
     * saveDatabase() - save data to file, will throw an error if the file can't be saved
     * might want to expand this to avoid dataloss on partial save
     * @param {string} dbname - the filename of the database to load
     * @param {function} callback - the callback to handle the result
     * @memberof LokiFsAdapter
     */
    LokiFsAdapter.prototype.saveDatabase = function saveDatabase(dbname, dbstring, callback) {
      var self = this;
      var tmpdbname = dbname + '~';
      this.fs.writeFile(tmpdbname, dbstring, function writeFileCallback(err) {
        if (err) {
          callback(new Error(err));
        } else {
          self.fs.rename(tmpdbname,dbname,callback);
        }
      });
    };

    /**
     * deleteDatabase() - delete the database file, will throw an error if the
     * file can't be deleted
     * @param {string} dbname - the filename of the database to delete
     * @param {function} callback - the callback to handle the result
     * @memberof LokiFsAdapter
     */
    LokiFsAdapter.prototype.deleteDatabase = function deleteDatabase(dbname, callback) {
      this.fs.unlink(dbname, function deleteDatabaseCallback(err) {
        if (err) {
          callback(new Error(err));
        } else {
          callback();
        }
      });
    };


    /**
     * A loki persistence adapter which persists to web browser's local storage object
     * @constructor LokiLocalStorageAdapter
     */
    function LokiLocalStorageAdapter() {}

    /**
     * loadDatabase() - Load data from localstorage
     * @param {string} dbname - the name of the database to load
     * @param {function} callback - the callback to handle the result
     * @memberof LokiLocalStorageAdapter
     */
    LokiLocalStorageAdapter.prototype.loadDatabase = function loadDatabase(dbname, callback) {
      if (localStorageAvailable()) {
        callback(localStorage.getItem(dbname));
      } else {
        callback(new Error('localStorage is not available'));
      }
    };

    /**
     * saveDatabase() - save data to localstorage, will throw an error if the file can't be saved
     * might want to expand this to avoid dataloss on partial save
     * @param {string} dbname - the filename of the database to load
     * @param {function} callback - the callback to handle the result
     * @memberof LokiLocalStorageAdapter
     */
    LokiLocalStorageAdapter.prototype.saveDatabase = function saveDatabase(dbname, dbstring, callback) {
      if (localStorageAvailable()) {
        localStorage.setItem(dbname, dbstring);
        callback(null);
      } else {
        callback(new Error('localStorage is not available'));
      }
    };

    /**
     * deleteDatabase() - delete the database from localstorage, will throw an error if it
     * can't be deleted
     * @param {string} dbname - the filename of the database to delete
     * @param {function} callback - the callback to handle the result
     * @memberof LokiLocalStorageAdapter
     */
    LokiLocalStorageAdapter.prototype.deleteDatabase = function deleteDatabase(dbname, callback) {
      if (localStorageAvailable()) {
        localStorage.removeItem(dbname);
        callback(null);
      } else {
        callback(new Error('localStorage is not available'));
      }
    };

    /**
     * Wait for throttledSaves to complete and invoke your callback when drained or duration is met.
     *
     * @param {function} callback - callback to fire when save queue is drained, it is passed a sucess parameter value
     * @param {object=} options - configuration options
     * @param {boolean} options.recursiveWait - (default: true) if after queue is drained, another save was kicked off, wait for it
     * @param {bool} options.recursiveWaitLimit - (default: false) limit our recursive waiting to a duration
     * @param {int} options.recursiveWaitLimitDelay - (default: 2000) cutoff in ms to stop recursively re-draining
     * @memberof Loki
     */
    Loki.prototype.throttledSaveDrain = function(callback, options) {
      var self = this;
      var now = (new Date()).getTime();

      if (!this.throttledSaves) {
        callback(true);
      }

      options = options || {};
      if (!options.hasOwnProperty('recursiveWait')) {
        options.recursiveWait = true;
      }
      if (!options.hasOwnProperty('recursiveWaitLimit')) {
        options.recursiveWaitLimit = false;
      }
      if (!options.hasOwnProperty('recursiveWaitLimitDuration')) {
        options.recursiveWaitLimitDuration = 2000;
      }
      if (!options.hasOwnProperty('started')) {
        options.started = (new Date()).getTime();
      }

      // if save is pending
      if (this.throttledSaves && this.throttledSavePending) {
        // if we want to wait until we are in a state where there are no pending saves at all
        if (options.recursiveWait) {
          // queue the following meta callback for when it completes
          this.throttledCallbacks.push(function() {
            // if there is now another save pending...
            if (self.throttledSavePending) {
              // if we wish to wait only so long and we have exceeded limit of our waiting, callback with false success value
              if (options.recursiveWaitLimit && (now - options.started > options.recursiveWaitLimitDuration)) {
                callback(false);
                return;
              }
              // it must be ok to wait on next queue drain
              self.throttledSaveDrain(callback, options);
              return;
            }
            // no pending saves so callback with true success
            else {
              callback(true);
              return;
            }
          });
        }
        // just notify when current queue is depleted
        else {
          this.throttledCallbacks.push(callback);
          return;
        }
      }
      // no save pending, just callback
      else {
        callback(true);
      }
    };

    /**
     * Internal load logic, decoupled from throttling/contention logic
     *
     * @param {object} options - not currently used (remove or allow overrides?)
     * @param {function=} callback - (Optional) user supplied async callback / error handler
     */
    Loki.prototype.loadDatabaseInternal = function (options, callback) {
      var cFun = callback || function (err, data) {
          if (err) {
            throw err;
          }
        },
        self = this;

      // the persistenceAdapter should be present if all is ok, but check to be sure.
      if (this.persistenceAdapter !== null) {

        this.persistenceAdapter.loadDatabase(this.filename, function loadDatabaseCallback(dbString) {
          if (typeof (dbString) === 'string') {
            var parseSuccess = false;
            try {
              self.loadJSON(dbString, options || {});
              parseSuccess = true;
            } catch (err) {
              cFun(err);
            }
            if (parseSuccess) {
              cFun(null);
              self.emit('loaded', 'database ' + self.filename + ' loaded');
            }
          } else {
            // falsy result means new database
            if (!dbString) {
              cFun(null);
              self.emit('loaded', 'empty database ' + self.filename + ' loaded');
              return;
            }

            // instanceof error means load faulted
            if (dbString instanceof Error) {
                cFun(dbString);
                return;
            }

            // if adapter has returned an js object (other than null or error) attempt to load from JSON object
            if (typeof (dbString) === "object") {
              self.loadJSONObject(dbString, options || {});
              cFun(null); // return null on success
              self.emit('loaded', 'database ' + self.filename + ' loaded');
              return;
            }

            cFun("unexpected adapter response : " + dbString);
          }
        });

      } else {
        cFun(new Error('persistenceAdapter not configured'));
      }
    };

    /**
     * Handles manually loading from file system, local storage, or adapter (such as indexeddb)
     *    This method utilizes loki configuration options (if provided) to determine which
     *    persistence method to use, or environment detection (if configuration was not provided).
     *    To avoid contention with any throttledSaves, we will drain the save queue first.
     *
     * If you are configured with autosave, you do not need to call this method yourself.
     *
     * @param {object} options - if throttling saves and loads, this controls how we drain save queue before loading
     * @param {boolean} options.recursiveWait - (default: true) wait recursively until no saves are queued
     * @param {bool} options.recursiveWaitLimit - (default: false) limit our recursive waiting to a duration
     * @param {int} options.recursiveWaitLimitDelay - (default: 2000) cutoff in ms to stop recursively re-draining
     * @param {function=} callback - (Optional) user supplied async callback / error handler
     * @memberof Loki
     * @example
     * db.loadDatabase({}, function(err) {
     *   if (err) {
     *     console.log("error : " + err);
     *   }
     *   else {
     *     console.log("database loaded.");
     *   }
     * });
     */
    Loki.prototype.loadDatabase = function (options, callback) {
      var self=this;

      // if throttling disabled, just call internal
      if (!this.throttledSaves) {
        this.loadDatabaseInternal(options, callback);
        return;
      }

      // try to drain any pending saves in the queue to lock it for loading
      this.throttledSaveDrain(function(success) {
        if (success) {
          // pause/throttle saving until loading is done
          self.throttledSavePending = true;

          self.loadDatabaseInternal(options, function(err) {
            // now that we are finished loading, if no saves were throttled, disable flag
            if (self.throttledCallbacks.length === 0) {
              self.throttledSavePending = false;
            }
            // if saves requests came in while loading, kick off new save to kick off resume saves
            else {
              self.saveDatabase();
            }

            if (typeof callback === 'function') {
              callback(err);
            }
          });
          return;
        }
        else {
          if (typeof callback === 'function') {
            callback(new Error("Unable to pause save throttling long enough to read database"));
          }
        }
      }, options);
    };

    /**
     * Internal save logic, decoupled from save throttling logic
     */
    Loki.prototype.saveDatabaseInternal = function (callback) {
      var cFun = callback || function (err) {
          if (err) {
            throw err;
          }
          return;
        },
        self = this;

      // the persistenceAdapter should be present if all is ok, but check to be sure.
      if (this.persistenceAdapter !== null) {
        // check if the adapter is requesting (and supports) a 'reference' mode export
        if (this.persistenceAdapter.mode === "reference" && typeof this.persistenceAdapter.exportDatabase === "function") {
          // filename may seem redundant but loadDatabase will need to expect this same filename
          this.persistenceAdapter.exportDatabase(this.filename, this.copy({removeNonSerializable:true}), function exportDatabaseCallback(err) {
            self.autosaveClearFlags();
            cFun(err);
          });
        }
        // otherwise just pass the serialized database to adapter
        else {
          // persistenceAdapter might be asynchronous, so we must clear `dirty` immediately
          // or autosave won't work if an update occurs between here and the callback
          self.autosaveClearFlags();
          this.persistenceAdapter.saveDatabase(this.filename, self.serialize(), function saveDatabasecallback(err) {
            cFun(err);
          });
        }
      } else {
        cFun(new Error('persistenceAdapter not configured'));
      }
    };

    /**
     * Handles manually saving to file system, local storage, or adapter (such as indexeddb)
     *    This method utilizes loki configuration options (if provided) to determine which
     *    persistence method to use, or environment detection (if configuration was not provided).
     *
     * If you are configured with autosave, you do not need to call this method yourself.
     *
     * @param {function=} callback - (Optional) user supplied async callback / error handler
     * @memberof Loki
     * @example
     * db.saveDatabase(function(err) {
     *   if (err) {
     *     console.log("error : " + err);
     *   }
     *   else {
     *     console.log("database saved.");
     *   }
     * });
     */
    Loki.prototype.saveDatabase = function (callback) {
      if (!this.throttledSaves) {
        this.saveDatabaseInternal(callback);
        return;
      }

      if (this.throttledSavePending) {
        this.throttledCallbacks.push(callback);
        return;
      }

      var localCallbacks = this.throttledCallbacks;
      this.throttledCallbacks = [];
      localCallbacks.unshift(callback);
      this.throttledSavePending = true;

      var self = this;
      this.saveDatabaseInternal(function(err) {
        self.throttledSavePending = false;
        localCallbacks.forEach(function(pcb) {
          if (typeof pcb === 'function') {
            // Queue the callbacks so we first finish this method execution
            setTimeout(function() {
              pcb(err);
            }, 1);
          }
        });

        // since this is called async, future requests may have come in, if so.. kick off next save
        if (self.throttledCallbacks.length > 0) {
          self.saveDatabase();
        }
      });
    };

    // alias
    Loki.prototype.save = Loki.prototype.saveDatabase;

    /**
     * Handles deleting a database from file system, local
     *    storage, or adapter (indexeddb)
     *    This method utilizes loki configuration options (if provided) to determine which
     *    persistence method to use, or environment detection (if configuration was not provided).
     *
     * @param {function=} callback - (Optional) user supplied async callback / error handler
     * @memberof Loki
     */
    Loki.prototype.deleteDatabase = function (options, callback) {
      var cFun = callback || function (err, data) {
        if (err) {
          throw err;
        }
      };

      // we aren't even using options, so we will support syntax where
      // callback is passed as first and only argument
      if (typeof options === 'function' && !callback) {
        cFun = options;
      }

      // the persistenceAdapter should be present if all is ok, but check to be sure.
      if (this.persistenceAdapter !== null) {
        this.persistenceAdapter.deleteDatabase(this.filename, function deleteDatabaseCallback(err) {
          cFun(err);
        });
      } else {
        cFun(new Error('persistenceAdapter not configured'));
      }
    };

    /**
     * autosaveDirty - check whether any collections are 'dirty' meaning we need to save (entire) database
     *
     * @returns {boolean} - true if database has changed since last autosave, false if not.
     */
    Loki.prototype.autosaveDirty = function () {
      for (var idx = 0; idx < this.collections.length; idx++) {
        if (this.collections[idx].dirty) {
          return true;
        }
      }

      return false;
    };

    /**
     * autosaveClearFlags - resets dirty flags on all collections.
     *    Called from saveDatabase() after db is saved.
     *
     */
    Loki.prototype.autosaveClearFlags = function () {
      for (var idx = 0; idx < this.collections.length; idx++) {
        this.collections[idx].dirty = false;
      }
    };

    /**
     * autosaveEnable - begin a javascript interval to periodically save the database.
     *
     * @param {object} options - not currently used (remove or allow overrides?)
     * @param {function=} callback - (Optional) user supplied async callback
     */
    Loki.prototype.autosaveEnable = function (options, callback) {
      this.autosave = true;

      var delay = 5000,
        self = this;

      if (typeof (this.autosaveInterval) !== 'undefined' && this.autosaveInterval !== null) {
        delay = this.autosaveInterval;
      }

      this.autosaveHandle = setInterval(function autosaveHandleInterval() {
        // use of dirty flag will need to be hierarchical since mods are done at collection level with no visibility of 'db'
        // so next step will be to implement collection level dirty flags set on insert/update/remove
        // along with loki level isdirty() function which iterates all collections to see if any are dirty

        if (self.autosaveDirty()) {
          self.saveDatabase(callback);
        }
      }, delay);
    };

    /**
     * autosaveDisable - stop the autosave interval timer.
     *
     */
    Loki.prototype.autosaveDisable = function () {
      if (typeof (this.autosaveHandle) !== 'undefined' && this.autosaveHandle !== null) {
        clearInterval(this.autosaveHandle);
        this.autosaveHandle = null;
      }
    };


    /**
     * Resultset class allowing chainable queries.  Intended to be instanced internally.
     *    Collection.find(), Collection.where(), and Collection.chain() instantiate this.
     *
     * @example
     *    mycollection.chain()
     *      .find({ 'doors' : 4 })
     *      .where(function(obj) { return obj.name === 'Toyota' })
     *      .data();
     *
     * @constructor Resultset
     * @param {Collection} collection - The collection which this Resultset will query against.
     */
    function Resultset(collection, options) {
      options = options || {};

      // retain reference to collection we are querying against
      this.collection = collection;
      this.filteredrows = [];
      this.filterInitialized = false;

      return this;
    }

    /**
     * reset() - Reset the resultset to its initial state.
     *
     * @returns {Resultset} Reference to this resultset, for future chain operations.
     */
    Resultset.prototype.reset = function () {
      if (this.filteredrows.length > 0) {
        this.filteredrows = [];
      }
      this.filterInitialized = false;
      return this;
    };

    /**
     * toJSON() - Override of toJSON to avoid circular references
     *
     */
    Resultset.prototype.toJSON = function () {
      var copy = this.copy();
      copy.collection = null;
      return copy;
    };

    /**
     * Allows you to limit the number of documents passed to next chain operation.
     *    A resultset copy() is made to avoid altering original resultset.
     *
     * @param {int} qty - The number of documents to return.
     * @returns {Resultset} Returns a copy of the resultset, limited by qty, for subsequent chain ops.
     * @memberof Resultset
     * // find the two oldest users
     * var result = users.chain().simplesort("age", true).limit(2).data();
     */
    Resultset.prototype.limit = function (qty) {
      // if this has no filters applied, we need to populate filteredrows first
      if (!this.filterInitialized && this.filteredrows.length === 0) {
        this.filteredrows = this.collection.prepareFullDocIndex();
      }

      var rscopy = new Resultset(this.collection);
      rscopy.filteredrows = this.filteredrows.slice(0, qty);
      rscopy.filterInitialized = true;
      return rscopy;
    };

    /**
     * Used for skipping 'pos' number of documents in the resultset.
     *
     * @param {int} pos - Number of documents to skip; all preceding documents are filtered out.
     * @returns {Resultset} Returns a copy of the resultset, containing docs starting at 'pos' for subsequent chain ops.
     * @memberof Resultset
     * // find everyone but the two oldest users
     * var result = users.chain().simplesort("age", true).offset(2).data();
     */
    Resultset.prototype.offset = function (pos) {
      // if this has no filters applied, we need to populate filteredrows first
      if (!this.filterInitialized && this.filteredrows.length === 0) {
        this.filteredrows = this.collection.prepareFullDocIndex();
      }

      var rscopy = new Resultset(this.collection);
      rscopy.filteredrows = this.filteredrows.slice(pos);
      rscopy.filterInitialized = true;
      return rscopy;
    };

    /**
     * copy() - To support reuse of resultset in branched query situations.
     *
     * @returns {Resultset} Returns a copy of the resultset (set) but the underlying document references will be the same.
     * @memberof Resultset
     */
    Resultset.prototype.copy = function () {
      var result = new Resultset(this.collection);

      if (this.filteredrows.length > 0) {
        result.filteredrows = this.filteredrows.slice();
      }
      result.filterInitialized = this.filterInitialized;

      return result;
    };

    /**
     * Alias of copy()
     * @memberof Resultset
     */
    Resultset.prototype.branch = Resultset.prototype.copy;

    /**
     * transform() - executes a named collection transform or raw array of transform steps against the resultset.
     *
     * @param transform {(string|array)} - name of collection transform or raw transform array
     * @param parameters {object=} - (Optional) object property hash of parameters, if the transform requires them.
     * @returns {Resultset} either (this) resultset or a clone of of this resultset (depending on steps)
     * @memberof Resultset
     * @example
     * users.addTransform('CountryFilter', [
     *   {
     *     type: 'find',
     *     value: {
     *       'country': { $eq: '[%lktxp]Country' }
     *     }
     *   },
     *   {
     *     type: 'simplesort',
     *     property: 'age',
     *     options: { desc: false}
     *   }
     * ]);
     * var results = users.chain().transform("CountryFilter", { Country: 'fr' }).data();
     */
    Resultset.prototype.transform = function (transform, parameters) {
      var idx,
        step,
        rs = this;

      // if transform is name, then do lookup first
      if (typeof transform === 'string') {
        if (this.collection.transforms.hasOwnProperty(transform)) {
          transform = this.collection.transforms[transform];
        }
      }

      // either they passed in raw transform array or we looked it up, so process
      if (typeof transform !== 'object' || !Array.isArray(transform)) {
        throw new Error("Invalid transform");
      }

      if (typeof parameters !== 'undefined') {
        transform = Utils.resolveTransformParams(transform, parameters);
      }

      for (idx = 0; idx < transform.length; idx++) {
        step = transform[idx];

        switch (step.type) {
        case "find":
          rs.find(step.value);
          break;
        case "where":
          rs.where(step.value);
          break;
        case "simplesort":
          rs.simplesort(step.property, step.desc || step.options);
          break;
        case "compoundsort":
          rs.compoundsort(step.value);
          break;
        case "sort":
          rs.sort(step.value);
          break;
        case "limit":
          rs = rs.limit(step.value);
          break; // limit makes copy so update reference
        case "offset":
          rs = rs.offset(step.value);
          break; // offset makes copy so update reference
        case "map":
          rs = rs.map(step.value, step.dataOptions);
          break;
        case "eqJoin":
          rs = rs.eqJoin(step.joinData, step.leftJoinKey, step.rightJoinKey, step.mapFun, step.dataOptions);
          break;
          // following cases break chain by returning array data so make any of these last in transform steps
        case "mapReduce":
          rs = rs.mapReduce(step.mapFunction, step.reduceFunction);
          break;
          // following cases update documents in current filtered resultset (use carefully)
        case "update":
          rs.update(step.value);
          break;
        case "remove":
          rs.remove();
          break;
        default:
          break;
        }
      }

      return rs;
    };

    /**
     * User supplied compare function is provided two documents to compare. (chainable)
     * @example
     *    rslt.sort(function(obj1, obj2) {
     *      if (obj1.name === obj2.name) return 0;
     *      if (obj1.name > obj2.name) return 1;
     *      if (obj1.name < obj2.name) return -1;
     *    });
     *
     * @param {function} comparefun - A javascript compare function used for sorting.
     * @returns {Resultset} Reference to this resultset, sorted, for future chain operations.
     * @memberof Resultset
     */
    Resultset.prototype.sort = function (comparefun) {
      // if this has no filters applied, just we need to populate filteredrows first
      if (!this.filterInitialized && this.filteredrows.length === 0) {
        this.filteredrows = this.collection.prepareFullDocIndex();
      }

      var wrappedComparer =
        (function (userComparer, data) {
          return function (a, b) {
            return userComparer(data[a], data[b]);
          };
        })(comparefun, this.collection.data);

      this.filteredrows.sort(wrappedComparer);

      return this;
    };

    /**
     * Simpler, loose evaluation for user to sort based on a property name. (chainable).
     *    Sorting based on the same lt/gt helper functions used for binary indices.
     *
     * @param {string} propname - name of property to sort by.
     * @param {object|bool=} options - boolean to specify if isdescending, or options object
     * @param {boolean} [options.desc=false] - whether to sort descending
     * @param {boolean} [options.disableIndexIntersect=false] - whether we should explicity not use array intersection.
     * @param {boolean} [options.forceIndexIntersect=false] - force array intersection (if binary index exists).
     * @param {boolean} [options.useJavascriptSorting=false] - whether results are sorted via basic javascript sort.
     * @returns {Resultset} Reference to this resultset, sorted, for future chain operations.
     * @memberof Resultset
     * @example
     * var results = users.chain().simplesort('age').data();
     */
    Resultset.prototype.simplesort = function (propname, options) {
      var eff, 
        targetEff = 10,
        dc = this.collection.data.length, 
        frl = this.filteredrows.length,
        hasBinaryIndex = this.collection.binaryIndices.hasOwnProperty(propname);

      if (typeof (options) === 'undefined' || options === false) {
        options = { desc: false };
      }
      if (options === true) {
        options = { desc: true };
      }

      // if nothing in filtered rows array...
      if (frl === 0) {
        // if the filter is initialized to be empty resultset, do nothing
        if (this.filterInitialized) {
          return this;
        }
        
        // otherwise no filters applied implies all documents, so we need to populate filteredrows first
        
        // if we have a binary index, we can just use that instead of sorting (again)
        if (this.collection.binaryIndices.hasOwnProperty(propname)) {
          // make sure index is up-to-date
          this.collection.ensureIndex(propname);
          // copy index values into filteredrows
          this.filteredrows = this.collection.binaryIndices[propname].values.slice(0);

          if (options.desc) {
            this.filteredrows.reverse();
          }

          // we are done, return this (resultset) for further chain ops
          return this;
        }
        // otherwise initialize array for sort below
        else {
          // build full document index (to be sorted subsequently)
          this.filteredrows = this.collection.prepareFullDocIndex();
        }
      }
      // otherwise we had results to begin with, see if we qualify for index intercept optimization
      else {

        // If already filtered, but we want to leverage binary index on sort.
        // This will use custom array intection algorithm.
        if (!options.disableIndexIntersect && hasBinaryIndex) {

          // calculate filter efficiency
          eff = dc/frl;

          // when javascript sort fallback is enabled, you generally need more than ~17% of total docs in resultset
          // before array intersect is determined to be the faster algorithm, otherwise leave at 10% for loki sort.
          if (options.useJavascriptSorting) {
            targetEff = 6;
          }

          // anything more than ratio of 10:1 (total documents/current results) should use old sort code path
          // So we will only use array intersection if you have more than 10% of total docs in your current resultset.
          if (eff <= targetEff || options.forceIndexIntersect) {
            var idx, fr=this.filteredrows;
            var io = {};
            // set up hashobject for simple 'inclusion test' with existing (filtered) results
            for(idx=0; idx<frl; idx++) {
              io[fr[idx]] = true;
            }
            // grab full sorted binary index array
            var pv = this.collection.binaryIndices[propname].values;

            // filter by existing results
            this.filteredrows = pv.filter(function(n) { return io[n]; });

            if (options.desc) {
              this.filteredrows.reverse();
            }

            return this;
          }
        }
      }

      // at this point, we will not be able to leverage binary index so we will have to do an array sort
      
      // if we have opted to use simplified javascript comparison function...
      if (options.useJavascriptSorting) {
        return this.sort(function(obj1, obj2) {
          if (obj1[propname] === obj2[propname]) return 0;
          if (obj1[propname] > obj2[propname]) return 1;
          if (obj1[propname] < obj2[propname]) return -1;
        });
      }

      // otherwise use loki sort which will return same results if column is indexed or not
      var wrappedComparer =
        (function (prop, desc, data) {
          var val1, val2, arr;
          return function (a, b) {
            if (~prop.indexOf('.')) {
              arr = prop.split('.');
              val1 = Utils.getIn(data[a], arr, true);
              val2 = Utils.getIn(data[b], arr, true);
            } else {
              val1 = data[a][prop];
              val2 = data[b][prop];
            }
            return sortHelper(val1, val2, desc);
          };
        })(propname, options.desc, this.collection.data);

      this.filteredrows.sort(wrappedComparer);

      return this;
    };

    /**
     * Allows sorting a resultset based on multiple columns.
     * @example
     * // to sort by age and then name (both ascending)
     * rs.compoundsort(['age', 'name']);
     * // to sort by age (ascending) and then by name (descending)
     * rs.compoundsort(['age', ['name', true]]);
     *
     * @param {array} properties - array of property names or subarray of [propertyname, isdesc] used evaluate sort order
     * @returns {Resultset} Reference to this resultset, sorted, for future chain operations.
     * @memberof Resultset
     */
    Resultset.prototype.compoundsort = function (properties) {
      if (properties.length === 0) {
        throw new Error("Invalid call to compoundsort, need at least one property");
      }

      var prop;
      if (properties.length === 1) {
        prop = properties[0];
        if (Array.isArray(prop)) {
          return this.simplesort(prop[0], prop[1]);
        }
        return this.simplesort(prop, false);
      }

      // unify the structure of 'properties' to avoid checking it repeatedly while sorting
      for (var i = 0, len = properties.length; i < len; i += 1) {
        prop = properties[i];
        if (!Array.isArray(prop)) {
          properties[i] = [prop, false];
        }
      }

      // if this has no filters applied, just we need to populate filteredrows first
      if (!this.filterInitialized && this.filteredrows.length === 0) {
        this.filteredrows = this.collection.prepareFullDocIndex();
      }

      var wrappedComparer =
        (function (props, data) {
          return function (a, b) {
            return compoundeval(props, data[a], data[b]);
          };
        })(properties, this.collection.data);

      this.filteredrows.sort(wrappedComparer);

      return this;
    };

    /**
     * findOr() - oversee the operation of OR'ed query expressions.
     *    OR'ed expression evaluation runs each expression individually against the full collection,
     *    and finally does a set OR on each expression's results.
     *    Each evaluation can utilize a binary index to prevent multiple linear array scans.
     *
     * @param {array} expressionArray - array of expressions
     * @returns {Resultset} this resultset for further chain ops.
     */
    Resultset.prototype.findOr = function (expressionArray) {
      var fr = null,
        fri = 0,
        frlen = 0,
        docset = [],
        idxset = [],
        idx = 0,
        origCount = this.count();

      // If filter is already initialized, then we query against only those items already in filter.
      // This means no index utilization for fields, so hopefully its filtered to a smallish filteredrows.
      for (var ei = 0, elen = expressionArray.length; ei < elen; ei++) {
        // we need to branch existing query to run each filter separately and combine results
        fr = this.branch().find(expressionArray[ei]).filteredrows;
        frlen = fr.length;
        // if the find operation did not reduce the initial set, then the initial set is the actual result
        if (frlen === origCount) {
          return this;
        }

        // add any document 'hits'
        for (fri = 0; fri < frlen; fri++) {
          idx = fr[fri];
          if (idxset[idx] === undefined) {
            idxset[idx] = true;
            docset.push(idx);
          }
        }
      }

      this.filteredrows = docset;
      this.filterInitialized = true;

      return this;
    };
    Resultset.prototype.$or = Resultset.prototype.findOr;

    // precompile recursively
    function precompileQuery (operator, value) {
      // for regex ops, precompile
      if (operator === '$regex') {
        if (Array.isArray(value)) {
          value = new RegExp(value[0], value[1]);
        } else if (!(value instanceof RegExp)) {
          value = new RegExp(value);
        }
      }
      else if (typeof value === 'object') {
        for (var key in value) {
          if (key === '$regex' || typeof value[key] === 'object') {
            value[key] = precompileQuery(key, value[key]);
          }
        }
      }

      return value;
    }

    /**
     * findAnd() - oversee the operation of AND'ed query expressions.
     *    AND'ed expression evaluation runs each expression progressively against the full collection,
     *    internally utilizing existing chained resultset functionality.
     *    Only the first filter can utilize a binary index.
     *
     * @param {array} expressionArray - array of expressions
     * @returns {Resultset} this resultset for further chain ops.
     */
    Resultset.prototype.findAnd = function (expressionArray) {
      // we have already implementing method chaining in this (our Resultset class)
      // so lets just progressively apply user supplied and filters
      for (var i = 0, len = expressionArray.length; i < len; i++) {
        if (this.count() === 0) {
          return this;
        }
        this.find(expressionArray[i]);
      }
      return this;
    };
    Resultset.prototype.$and = Resultset.prototype.findAnd;

    /**
     * Used for querying via a mongo-style query object.
     *
     * @param {object} query - A mongo-style query object used for filtering current results.
     * @param {boolean=} firstOnly - (Optional) Used by collection.findOne()
     * @returns {Resultset} this resultset for further chain ops.
     * @memberof Resultset
     * @example
     * var over30 = users.chain().find({ age: { $gte: 30 } }).data();
     */
    Resultset.prototype.find = function (query, firstOnly) {
      if (this.collection.data.length === 0) {
        this.filteredrows = [];
        this.filterInitialized = true;
        return this;
      }

      var queryObject = query || 'getAll',
        p,
        property,
        queryObjectOp,
        obj,
        operator,
        value,
        key,
        searchByIndex = false,
        result = [],
        filters = [],
        index = null;

      // flag if this was invoked via findOne()
      firstOnly = firstOnly || false;

      if (typeof queryObject === 'object') {
        for (p in queryObject) {
          obj = {};
          obj[p] = queryObject[p];
          filters.push(obj);

          if (hasOwnProperty.call(queryObject, p)) {
            property = p;
            queryObjectOp = queryObject[p];
          }
        }
        // if more than one expression in single query object,
        // convert implicit $and to explicit $and
        if (filters.length > 1) {
          return this.find({ '$and': filters }, firstOnly);
        }
      }

      // apply no filters if they want all
      if (!property || queryObject === 'getAll') {
        if (firstOnly) {
          this.filteredrows = (this.collection.data.length > 0)?[0]: [];
          this.filterInitialized = true;
        }

        return this;
      }

      // injecting $and and $or expression tree evaluation here.
      if (property === '$and' || property === '$or') {
        this[property](queryObjectOp);

        // for chained find with firstonly,
        if (firstOnly && this.filteredrows.length > 1) {
          this.filteredrows = this.filteredrows.slice(0, 1);
        }

        return this;
      }

      // see if query object is in shorthand mode (assuming eq operator)
      if (queryObjectOp === null || (typeof queryObjectOp !== 'object' || queryObjectOp instanceof Date)) {
        operator = '$eq';
        value = queryObjectOp;
      } else if (typeof queryObjectOp === 'object') {
        for (key in queryObjectOp) {
          if (hasOwnProperty.call(queryObjectOp, key)) {
            operator = key;
            value = queryObjectOp[key];
            break;
          }
        }
      } else {
        throw new Error('Do not know what you want to do.');
      }

      if (operator === '$regex' || typeof value === 'object') {
        value = precompileQuery(operator, value);
      }

      // if user is deep querying the object such as find('name.first': 'odin')
      var usingDotNotation = (property.indexOf('.') !== -1);

      // if an index exists for the property being queried against, use it
      // for now only enabling where it is the first filter applied and prop is indexed
      var doIndexCheck = !this.filterInitialized;

      if (doIndexCheck && this.collection.binaryIndices[property] && indexedOps[operator]) {
        // this is where our lazy index rebuilding will take place
        // basically we will leave all indexes dirty until we need them
        // so here we will rebuild only the index tied to this property
        // ensureIndex() will only rebuild if flagged as dirty since we are not passing force=true param
        if (this.collection.adaptiveBinaryIndices !== true) {
          this.collection.ensureIndex(property);
        }

        searchByIndex = true;
        index = this.collection.binaryIndices[property];
      }

      // the comparison function
      var fun = LokiOps[operator];

      // "shortcut" for collection data
      var t = this.collection.data;
      // filter data length
      var i = 0,
        len = 0;

      // Query executed differently depending on :
      //    - whether the property being queried has an index defined
      //    - if chained, we handle first pass differently for initial filteredrows[] population
      //
      // For performance reasons, each case has its own if block to minimize in-loop calculations

      var filter, rowIdx = 0;

      // If the filteredrows[] is already initialized, use it
      if (this.filterInitialized) {
        filter = this.filteredrows;
        len = filter.length;

        // currently supporting dot notation for non-indexed conditions only
        if (usingDotNotation) {
          property = property.split('.');
          for(i=0; i<len; i++) {
            rowIdx = filter[i];
            if (dotSubScan(t[rowIdx], property, fun, value)) {
              result.push(rowIdx);
            }
          }
        } else {
          for(i=0; i<len; i++) {
            rowIdx = filter[i];
            if (fun(t[rowIdx][property], value)) {
              result.push(rowIdx);
            }
          }
        }
      }
      // first chained query so work against data[] but put results in filteredrows
      else {
        // if not searching by index
        if (!searchByIndex) {
          len = t.length;

          if (usingDotNotation) {
            property = property.split('.');
            for(i=0; i<len; i++) {
              if (dotSubScan(t[i], property, fun, value)) {
                result.push(i);
                if (firstOnly) {
                  this.filteredrows = result;
                  this.filterInitialized = true;
                  return this;
                }
              }
            }
          } else {
            for(i=0; i<len; i++) {
              if (fun(t[i][property], value)) {
                result.push(i);
                if (firstOnly) {
                  this.filteredrows = result;
                  this.filterInitialized = true;
                  return this;
                }
              }
            }
          }
        } else {
          // search by index
          var segm = this.collection.calculateRange(operator, property, value);

          if (operator !== '$in') {
            for (i = segm[0]; i <= segm[1]; i++) {
              if (indexedOps[operator] !== true) {
                // must be a function, implying 2nd phase filtering of results from calculateRange
                if (indexedOps[operator](Utils.getIn(t[index.values[i]], property, usingDotNotation), value)) {
                  result.push(index.values[i]);
                  if (firstOnly) {
                    this.filteredrows = result;
                    this.filterInitialized = true;
                    return this;
                  }
                }
              }
              else {
                  result.push(index.values[i]);
                  if (firstOnly) {
                    this.filteredrows = result;
                    this.filterInitialized = true;
                    return this;
                  }
              }
            }
          } else {
            for (i = 0, len = segm.length; i < len; i++) {
              result.push(index.values[segm[i]]);
              if (firstOnly) {
                this.filteredrows = result;
                this.filterInitialized = true;
                return this;
              }
            }
          }
        }

      }

      this.filteredrows = result;
      this.filterInitialized = true; // next time work against filteredrows[]
      return this;
    };


    /**
     * where() - Used for filtering via a javascript filter function.
     *
     * @param {function} fun - A javascript function used for filtering current results by.
     * @returns {Resultset} this resultset for further chain ops.
     * @memberof Resultset
     * @example
     * var over30 = users.chain().where(function(obj) { return obj.age >= 30; }.data();
     */
    Resultset.prototype.where = function (fun) {
      var viewFunction,
        result = [];

      if ('function' === typeof fun) {
        viewFunction = fun;
      } else {
        throw new TypeError('Argument is not a stored view or a function');
      }
      try {
        // If the filteredrows[] is already initialized, use it
        if (this.filterInitialized) {
          var j = this.filteredrows.length;

          while (j--) {
            if (viewFunction(this.collection.data[this.filteredrows[j]]) === true) {
              result.push(this.filteredrows[j]);
            }
          }

          this.filteredrows = result;

          return this;
        }
        // otherwise this is initial chained op, work against data, push into filteredrows[]
        else {
          var k = this.collection.data.length;

          while (k--) {
            if (viewFunction(this.collection.data[k]) === true) {
              result.push(k);
            }
          }

          this.filteredrows = result;
          this.filterInitialized = true;

          return this;
        }
      } catch (err) {
        throw err;
      }
    };

    /**
     * count() - returns the number of documents in the resultset.
     *
     * @returns {number} The number of documents in the resultset.
     * @memberof Resultset
     * @example
     * var over30Count = users.chain().find({ age: { $gte: 30 } }).count();
     */
    Resultset.prototype.count = function () {
      if (this.filterInitialized) {
        return this.filteredrows.length;
      }
      return this.collection.count();
    };

    /**
     * Terminates the chain and returns array of filtered documents
     *
     * @param {object=} options - allows specifying 'forceClones' and 'forceCloneMethod' options.
     * @param {boolean} options.forceClones - Allows forcing the return of cloned objects even when
     *        the collection is not configured for clone object.
     * @param {string} options.forceCloneMethod - Allows overriding the default or collection specified cloning method.
     *        Possible values include 'parse-stringify', 'jquery-extend-deep', 'shallow', 'shallow-assign'
     * @param {bool} options.removeMeta - Will force clones and strip $loki and meta properties from documents
     *
     * @returns {array} Array of documents in the resultset
     * @memberof Resultset
     * @example
     * var resutls = users.chain().find({ age: 34 }).data();
     */
    Resultset.prototype.data = function (options) {
      var result = [],
        data = this.collection.data,
        obj,
        len,
        i,
        method;

      options = options || {};

      // if user opts to strip meta, then force clones and use 'shallow' if 'force' options are not present
      if (options.removeMeta && !options.forceClones) {
        options.forceClones = true;
        options.forceCloneMethod = options.forceCloneMethod || 'shallow';
      }

      // if collection has delta changes active, then force clones and use 'parse-stringify' for effective change tracking of nested objects
      if (!this.collection.disableDeltaChangesApi) {
        options.forceClones = true;
        options.forceCloneMethod = 'parse-stringify';
      }

      // if this has no filters applied, just return collection.data
      if (!this.filterInitialized) {
        if (this.filteredrows.length === 0) {
          // determine whether we need to clone objects or not
          if (this.collection.cloneObjects || options.forceClones) {
            len = data.length;
            method = options.forceCloneMethod || this.collection.cloneMethod;

            for (i = 0; i < len; i++) {
              obj = clone(data[i], method);
              if (options.removeMeta) {
                delete obj.$loki;
                delete obj.meta;
              }
              result.push(obj);
            }
            return result;
          }
          // otherwise we are not cloning so return sliced array with same object references
          else {
            return data.slice();
          }
        } else {
          // filteredrows must have been set manually, so use it
          this.filterInitialized = true;
        }
      }

      var fr = this.filteredrows;
      len = fr.length;

      if (this.collection.cloneObjects || options.forceClones) {
        method = options.forceCloneMethod || this.collection.cloneMethod;
        for (i = 0; i < len; i++) {
          obj = clone(data[fr[i]], method);
          if (options.removeMeta) {
            delete obj.$loki;
            delete obj.meta;
          }
          result.push(obj);
        }
      } else {
        for (i = 0; i < len; i++) {
          result.push(data[fr[i]]);
        }
      }
      return result;
    };

    /**
     * Used to run an update operation on all documents currently in the resultset.
     *
     * @param {function} updateFunction - User supplied updateFunction(obj) will be executed for each document object.
     * @returns {Resultset} this resultset for further chain ops.
     * @memberof Resultset
     * @example
     * users.chain().find({ country: 'de' }).update(function(user) {
     *   user.phoneFormat = "+49 AAAA BBBBBB";
     * });
     */
    Resultset.prototype.update = function (updateFunction) {

      if (typeof (updateFunction) !== "function") {
        throw new TypeError('Argument is not a function');
      }

      // if this has no filters applied, we need to populate filteredrows first
      if (!this.filterInitialized && this.filteredrows.length === 0) {
        this.filteredrows = this.collection.prepareFullDocIndex();
      }

      var obj, len = this.filteredrows.length,
        rcd = this.collection.data;

      // pass in each document object currently in resultset to user supplied updateFunction
      for (var idx = 0; idx < len; idx++) {
        // if we have cloning option specified or are doing differential delta changes, clone object first
        if (this.collection.cloneObjects || !this.collection.disableDeltaChangesApi) {
          obj = clone(rcd[this.filteredrows[idx]], this.collection.cloneMethod);
          updateFunction(obj);
          this.collection.update(obj);
        }
        else {
          // no need to clone, so just perform update on collection data object instance
          updateFunction(rcd[this.filteredrows[idx]]);
          this.collection.update(rcd[this.filteredrows[idx]]);
        }
      }

      return this;
    };

    /**
     * Removes all document objects which are currently in resultset from collection (as well as resultset)
     *
     * @returns {Resultset} this (empty) resultset for further chain ops.
     * @memberof Resultset
     * @example
     * // remove users inactive since 1/1/2001
     * users.chain().find({ lastActive: { $lte: new Date("1/1/2001").getTime() } }).remove();
     */
    Resultset.prototype.remove = function () {

      // if this has no filters applied, we need to populate filteredrows first
      if (!this.filterInitialized && this.filteredrows.length === 0) {
        this.filteredrows = this.collection.prepareFullDocIndex();
      }

      this.collection.removeBatchByPositions(this.filteredrows);

      this.filteredrows = [];

      return this;
    };

    /**
     * data transformation via user supplied functions
     *
     * @param {function} mapFunction - this function accepts a single document for you to transform and return
     * @param {function} reduceFunction - this function accepts many (array of map outputs) and returns single value
     * @returns {value} The output of your reduceFunction
     * @memberof Resultset
     * @example
     * var db = new loki("order.db");
     * var orders = db.addCollection("orders");
     * orders.insert([{ qty: 4, unitCost: 100.00 }, { qty: 10, unitCost: 999.99 }, { qty: 2, unitCost: 49.99 }]);
     *
     * function mapfun (obj) { return obj.qty*obj.unitCost };
     * function reducefun(array) {
     *   var grandTotal=0;
     *   array.forEach(function(orderTotal) { grandTotal += orderTotal; });
     *   return grandTotal;
     * }
     * var grandOrderTotal = orders.chain().mapReduce(mapfun, reducefun);
     * console.log(grandOrderTotal);
     */
    Resultset.prototype.mapReduce = function (mapFunction, reduceFunction) {
      try {
        return reduceFunction(this.data().map(mapFunction));
      } catch (err) {
        throw err;
      }
    };

    /**
     * eqJoin() - Left joining two sets of data. Join keys can be defined or calculated properties
     * eqJoin expects the right join key values to be unique.  Otherwise left data will be joined on the last joinData object with that key
     * @param {Array|Resultset|Collection} joinData - Data array to join to.
     * @param {(string|function)} leftJoinKey - Property name in this result set to join on or a function to produce a value to join on
     * @param {(string|function)} rightJoinKey - Property name in the joinData to join on or a function to produce a value to join on
     * @param {function=} mapFun - (Optional) A function that receives each matching pair and maps them into output objects - function(left,right){return joinedObject}
     * @param {object=} dataOptions - options to data() before input to your map function
     * @param {bool} dataOptions.removeMeta - allows removing meta before calling mapFun
     * @param {boolean} dataOptions.forceClones - forcing the return of cloned objects to your map object
     * @param {string} dataOptions.forceCloneMethod - Allows overriding the default or collection specified cloning method.
     * @returns {Resultset} A resultset with data in the format [{left: leftObj, right: rightObj}]
     * @memberof Resultset
     * @example
     * var db = new loki('sandbox.db');
     *
     * var products = db.addCollection('products');
     * var orders = db.addCollection('orders');
     *
     * products.insert({ productId: "100234", name: "flywheel energy storage", unitCost: 19999.99 });
     * products.insert({ productId: "140491", name: "300F super capacitor", unitCost: 129.99 });
     * products.insert({ productId: "271941", name: "fuel cell", unitCost: 3999.99 });
     * products.insert({ productId: "174592", name: "390V 3AH lithium bank", unitCost: 4999.99 });
     *
     * orders.insert({ orderDate : new Date("12/1/2017").getTime(), prodId: "174592", qty: 2, customerId: 2 });
     * orders.insert({ orderDate : new Date("4/15/2016").getTime(), prodId: "271941", qty: 1, customerId: 1 });
     * orders.insert({ orderDate : new Date("3/12/2017").getTime(), prodId: "140491", qty: 4, customerId: 4 });
     * orders.insert({ orderDate : new Date("7/31/2017").getTime(), prodId: "100234", qty: 7, customerId: 3 });
     * orders.insert({ orderDate : new Date("8/3/2016").getTime(), prodId: "174592", qty: 3, customerId: 5 });
     *
     * var mapfun = function(left, right) {
     *   return {
     *     orderId: left.$loki,
     *     orderDate: new Date(left.orderDate) + '',
     *     customerId: left.customerId,
     *     qty: left.qty,
     *     productId: left.prodId,
     *     prodName: right.name,
     *     prodCost: right.unitCost,
     *     orderTotal: +((right.unitCost * left.qty).toFixed(2))
     *   };
     * };
     *
     * // join orders with relevant product info via eqJoin
     * var orderSummary = orders.chain().eqJoin(products, "prodId", "productId", mapfun).data();
     * 
     * console.log(orderSummary);     
     */
    Resultset.prototype.eqJoin = function (joinData, leftJoinKey, rightJoinKey, mapFun, dataOptions) {

      var leftData = [],
        leftDataLength,
        rightData = [],
        rightDataLength,
        key,
        result = [],
        leftKeyisFunction = typeof leftJoinKey === 'function',
        rightKeyisFunction = typeof rightJoinKey === 'function',
        joinMap = {};

      //get the left data
      leftData = this.data(dataOptions);
      leftDataLength = leftData.length;

      //get the right data
      if (joinData instanceof Collection) {
        rightData = joinData.chain().data(dataOptions);
      } else if (joinData instanceof Resultset) {
        rightData = joinData.data(dataOptions);
      } else if (Array.isArray(joinData)) {
        rightData = joinData;
      } else {
        throw new TypeError('joinData needs to be an array or result set');
      }
      rightDataLength = rightData.length;

      //construct a lookup table

      for (var i = 0; i < rightDataLength; i++) {
        key = rightKeyisFunction ? rightJoinKey(rightData[i]) : rightData[i][rightJoinKey];
        joinMap[key] = rightData[i];
      }

      if (!mapFun) {
        mapFun = function (left, right) {
          return {
            left: left,
            right: right
          };
        };
      }

      //Run map function over each object in the resultset
      for (var j = 0; j < leftDataLength; j++) {
        key = leftKeyisFunction ? leftJoinKey(leftData[j]) : leftData[j][leftJoinKey];
        result.push(mapFun(leftData[j], joinMap[key] || {}));
      }

      //return return a new resultset with no filters
      this.collection = new Collection('joinData');
      this.collection.insert(result);
      this.filteredrows = [];
      this.filterInitialized = false;

      return this;
    };

    /**
     * Applies a map function into a new collection for further chaining.
     * @param {function} mapFun - javascript map function
     * @param {object=} dataOptions - options to data() before input to your map function
     * @param {bool} dataOptions.removeMeta - allows removing meta before calling mapFun
     * @param {boolean} dataOptions.forceClones - forcing the return of cloned objects to your map object
     * @param {string} dataOptions.forceCloneMethod - Allows overriding the default or collection specified cloning method.
     * @memberof Resultset
     * @example
     * var orders.chain().find({ productId: 32 }).map(function(obj) {
     *   return {
     *     orderId: $loki,
     *     productId: productId,
     *     quantity: qty
     *   };
     * });
     */
    Resultset.prototype.map = function (mapFun, dataOptions) {
      var data = this.data(dataOptions).map(mapFun);
      //return return a new resultset with no filters
      this.collection = new Collection('mappedData');
      this.collection.insert(data);
      this.filteredrows = [];
      this.filterInitialized = false;

      return this;
    };

    /**
     * DynamicView class is a versatile 'live' view class which can have filters and sorts applied.
     *    Collection.addDynamicView(name) instantiates this DynamicView object and notifies it
     *    whenever documents are add/updated/removed so it can remain up-to-date. (chainable)
     *
     * @example
     * var mydv = mycollection.addDynamicView('test');  // default is non-persistent
     * mydv.applyFind({ 'doors' : 4 });
     * mydv.applyWhere(function(obj) { return obj.name === 'Toyota'; });
     * var results = mydv.data();
     *
     * @constructor DynamicView
     * @implements LokiEventEmitter
     * @param {Collection} collection - A reference to the collection to work against
     * @param {string} name - The name of this dynamic view
     * @param {object=} options - (Optional) Pass in object with 'persistent' and/or 'sortPriority' options.
     * @param {boolean} [options.persistent=false] - indicates if view is to main internal results array in 'resultdata'
     * @param {string} [options.sortPriority='passive'] - 'passive' (sorts performed on call to data) or 'active' (after updates)
     * @param {number} options.minRebuildInterval - minimum rebuild interval (need clarification to docs here)
     * @see {@link Collection#addDynamicView} to construct instances of DynamicView
     */
    function DynamicView(collection, name, options) {
      this.collection = collection;
      this.name = name;
      this.rebuildPending = false;
      this.options = options || {};

      if (!this.options.hasOwnProperty('persistent')) {
        this.options.persistent = false;
      }

      // 'persistentSortPriority':
      // 'passive' will defer the sort phase until they call data(). (most efficient overall)
      // 'active' will sort async whenever next idle. (prioritizes read speeds)
      if (!this.options.hasOwnProperty('sortPriority')) {
        this.options.sortPriority = 'passive';
      }

      if (!this.options.hasOwnProperty('minRebuildInterval')) {
        this.options.minRebuildInterval = 1;
      }

      this.resultset = new Resultset(collection);
      this.resultdata = [];
      this.resultsdirty = false;

      this.cachedresultset = null;

      // keep ordered filter pipeline
      this.filterPipeline = [];

      // sorting member variables
      // we only support one active search, applied using applySort() or applySimpleSort()
      this.sortFunction = null;
      this.sortCriteria = null;
      this.sortCriteriaSimple = null;
      this.sortDirty = false;

      // for now just have 1 event for when we finally rebuilt lazy view
      // once we refactor transactions, i will tie in certain transactional events

      this.events = {
        'rebuild': []
      };
    }

    DynamicView.prototype = new LokiEventEmitter();


    /**
     * rematerialize() - internally used immediately after deserialization (loading)
     *    This will clear out and reapply filterPipeline ops, recreating the view.
     *    Since where filters do not persist correctly, this method allows
     *    restoring the view to state where user can re-apply those where filters.
     *
     * @param {Object=} options - (Optional) allows specification of 'removeWhereFilters' option
     * @returns {DynamicView} This dynamic view for further chained ops.
     * @memberof DynamicView
     * @fires DynamicView.rebuild
     */
    DynamicView.prototype.rematerialize = function (options) {
      var fpl,
        fpi,
        idx;

      options = options || {};

      this.resultdata = [];
      this.resultsdirty = true;
      this.resultset = new Resultset(this.collection);

      if (this.sortFunction || this.sortCriteria || this.sortCriteriaSimple) {
        this.sortDirty = true;
      }

      if (options.hasOwnProperty('removeWhereFilters')) {
        // for each view see if it had any where filters applied... since they don't
        // serialize those functions lets remove those invalid filters
        fpl = this.filterPipeline.length;
        fpi = fpl;
        while (fpi--) {
          if (this.filterPipeline[fpi].type === 'where') {
            if (fpi !== this.filterPipeline.length - 1) {
              this.filterPipeline[fpi] = this.filterPipeline[this.filterPipeline.length - 1];
            }

            this.filterPipeline.length--;
          }
        }
      }

      // back up old filter pipeline, clear filter pipeline, and reapply pipeline ops
      var ofp = this.filterPipeline;
      this.filterPipeline = [];

      // now re-apply 'find' filterPipeline ops
      fpl = ofp.length;
      for (idx = 0; idx < fpl; idx++) {
        this.applyFind(ofp[idx].val);
      }

      // during creation of unit tests, i will remove this forced refresh and leave lazy
      this.data();

      // emit rebuild event in case user wants to be notified
      this.emit('rebuild', this);

      return this;
    };

    /**
     * branchResultset() - Makes a copy of the internal resultset for branched queries.
     *    Unlike this dynamic view, the branched resultset will not be 'live' updated,
     *    so your branched query should be immediately resolved and not held for future evaluation.
     *
     * @param {(string|array=)} transform - Optional name of collection transform, or an array of transform steps
     * @param {object=} parameters - optional parameters (if optional transform requires them)
     * @returns {Resultset} A copy of the internal resultset for branched queries.
     * @memberof DynamicView
     * @example
     * var db = new loki('test');
     * var coll = db.addCollection('mydocs');
     * var dv = coll.addDynamicView('myview');
     * var tx = [
     *   {
     *     type: 'offset',
     *     value: '[%lktxp]pageStart'
     *   },
     *   {
     *     type: 'limit',
     *     value: '[%lktxp]pageSize'
     *   }
     * ];
     * coll.addTransform('viewPaging', tx);
     * 
     * // add some records
     * 
     * var results = dv.branchResultset('viewPaging', { pageStart: 10, pageSize: 10 }).data();     
     */
    DynamicView.prototype.branchResultset = function (transform, parameters) {
      var rs = this.resultset.branch();

      if (typeof transform === 'undefined') {
        return rs;
      }

      return rs.transform(transform, parameters);
    };

    /**
     * toJSON() - Override of toJSON to avoid circular references
     *
     */
    DynamicView.prototype.toJSON = function () {
      var copy = new DynamicView(this.collection, this.name, this.options);

      copy.resultset = this.resultset;
      copy.resultdata = []; // let's not save data (copy) to minimize size
      copy.resultsdirty = true;
      copy.filterPipeline = this.filterPipeline;
      copy.sortFunction = this.sortFunction;
      copy.sortCriteria = this.sortCriteria;
      copy.sortCriteriaSimple = this.sortCriteriaSimple || null;
      copy.sortDirty = this.sortDirty;

      // avoid circular reference, reapply in db.loadJSON()
      copy.collection = null;

      return copy;
    };

    /**
     * removeFilters() - Used to clear pipeline and reset dynamic view to initial state.
     *     Existing options should be retained.
     * @param {object=} options - configure removeFilter behavior
     * @param {boolean=} options.queueSortPhase - (default: false) if true we will async rebuild view (maybe set default to true in future?)
     * @memberof DynamicView
     */
    DynamicView.prototype.removeFilters = function (options) {
      options = options || {};

      this.rebuildPending = false;
      this.resultset.reset();
      this.resultdata = [];
      this.resultsdirty = true;

      this.cachedresultset = null;

      // keep ordered filter pipeline
      this.filterPipeline = [];

      // sorting member variables
      // we only support one active search, applied using applySort() or applySimpleSort()
      this.sortFunction = null;
      this.sortCriteria = null;
      this.sortCriteriaSimple = null;
      this.sortDirty = false;

      if (options.queueSortPhase === true) {
        this.queueSortPhase();
      }
    };

    /**
     * applySort() - Used to apply a sort to the dynamic view
     * @example
     * dv.applySort(function(obj1, obj2) {
     *   if (obj1.name === obj2.name) return 0;
     *   if (obj1.name > obj2.name) return 1;
     *   if (obj1.name < obj2.name) return -1;
     * });
     *
     * @param {function} comparefun - a javascript compare function used for sorting
     * @returns {DynamicView} this DynamicView object, for further chain ops.
     * @memberof DynamicView
     */
    DynamicView.prototype.applySort = function (comparefun) {
      this.sortFunction = comparefun;
      this.sortCriteria = null;
      this.sortCriteriaSimple = null;

      this.queueSortPhase();

      return this;
    };

    /**
     * applySimpleSort() - Used to specify a property used for view translation.
     * @example
     * dv.applySimpleSort("name");
     *
     * @param {string} propname - Name of property by which to sort.
     * @param {object|boolean=} options - boolean for sort descending or options object
     * @param {boolean} [options.desc=false] - whether we should sort descending.
     * @param {boolean} [options.disableIndexIntersect=false] - whether we should explicity not use array intersection.
     * @param {boolean} [options.forceIndexIntersect=false] - force array intersection (if binary index exists).
     * @param {boolean} [options.useJavascriptSorting=false] - whether results are sorted via basic javascript sort.
     * @returns {DynamicView} this DynamicView object, for further chain ops.
     * @memberof DynamicView
     */
    DynamicView.prototype.applySimpleSort = function (propname, options) {
      this.sortCriteriaSimple = { propname: propname, options: options || false };
      this.sortCriteria = null;
      this.sortFunction = null;

      this.queueSortPhase();

      return this;
    };

    /**
     * applySortCriteria() - Allows sorting a resultset based on multiple columns.
     * @example
     * // to sort by age and then name (both ascending)
     * dv.applySortCriteria(['age', 'name']);
     * // to sort by age (ascending) and then by name (descending)
     * dv.applySortCriteria(['age', ['name', true]);
     * // to sort by age (descending) and then by name (descending)
     * dv.applySortCriteria(['age', true], ['name', true]);
     *
     * @param {array} properties - array of property names or subarray of [propertyname, isdesc] used evaluate sort order
     * @returns {DynamicView} Reference to this DynamicView, sorted, for future chain operations.
     * @memberof DynamicView
     */
    DynamicView.prototype.applySortCriteria = function (criteria) {
      this.sortCriteria = criteria;
      this.sortCriteriaSimple = null;
      this.sortFunction = null;

      this.queueSortPhase();

      return this;
    };

    /**
     * startTransaction() - marks the beginning of a transaction.
     *
     * @returns {DynamicView} this DynamicView object, for further chain ops.
     */
    DynamicView.prototype.startTransaction = function () {
      this.cachedresultset = this.resultset.copy();

      return this;
    };

    /**
     * commit() - commits a transaction.
     *
     * @returns {DynamicView} this DynamicView object, for further chain ops.
     */
    DynamicView.prototype.commit = function () {
      this.cachedresultset = null;

      return this;
    };

    /**
     * rollback() - rolls back a transaction.
     *
     * @returns {DynamicView} this DynamicView object, for further chain ops.
     */
    DynamicView.prototype.rollback = function () {
      this.resultset = this.cachedresultset;

      if (this.options.persistent) {
        // for now just rebuild the persistent dynamic view data in this worst case scenario
        // (a persistent view utilizing transactions which get rolled back), we already know the filter so not too bad.
        this.resultdata = this.resultset.data();

        this.emit('rebuild', this);
      }

      return this;
    };


    /**
     * Implementation detail.
     * _indexOfFilterWithId() - Find the index of a filter in the pipeline, by that filter's ID.
     *
     * @param {(string|number)} uid - The unique ID of the filter.
     * @returns {number}: index of the referenced filter in the pipeline; -1 if not found.
     */
    DynamicView.prototype._indexOfFilterWithId = function (uid) {
      if (typeof uid === 'string' || typeof uid === 'number') {
        for (var idx = 0, len = this.filterPipeline.length; idx < len; idx += 1) {
          if (uid === this.filterPipeline[idx].uid) {
            return idx;
          }
        }
      }
      return -1;
    };

    /**
     * Implementation detail.
     * _addFilter() - Add the filter object to the end of view's filter pipeline and apply the filter to the resultset.
     *
     * @param {object} filter - The filter object. Refer to applyFilter() for extra details.
     */
    DynamicView.prototype._addFilter = function (filter) {
      this.filterPipeline.push(filter);
      this.resultset[filter.type](filter.val);
    };

    /**
     * reapplyFilters() - Reapply all the filters in the current pipeline.
     *
     * @returns {DynamicView} this DynamicView object, for further chain ops.
     */
    DynamicView.prototype.reapplyFilters = function () {
      this.resultset.reset();

      this.cachedresultset = null;
      if (this.options.persistent) {
        this.resultdata = [];
        this.resultsdirty = true;
      }

      var filters = this.filterPipeline;
      this.filterPipeline = [];

      for (var idx = 0, len = filters.length; idx < len; idx += 1) {
        this._addFilter(filters[idx]);
      }

      if (this.sortFunction || this.sortCriteria || this.sortCriteriaSimple) {
        this.queueSortPhase();
      } else {
        this.queueRebuildEvent();
      }

      return this;
    };

    /**
     * applyFilter() - Adds or updates a filter in the DynamicView filter pipeline
     *
     * @param {object} filter - A filter object to add to the pipeline.
     *    The object is in the format { 'type': filter_type, 'val', filter_param, 'uid', optional_filter_id }
     * @returns {DynamicView} this DynamicView object, for further chain ops.
     * @memberof DynamicView
     */
    DynamicView.prototype.applyFilter = function (filter) {
      var idx = this._indexOfFilterWithId(filter.uid);
      if (idx >= 0) {
        this.filterPipeline[idx] = filter;
        return this.reapplyFilters();
      }

      this.cachedresultset = null;
      if (this.options.persistent) {
        this.resultdata = [];
        this.resultsdirty = true;
      }

      this._addFilter(filter);

      if (this.sortFunction || this.sortCriteria || this.sortCriteriaSimple) {
        this.queueSortPhase();
      } else {
        this.queueRebuildEvent();
      }

      return this;
    };

    /**
     * applyFind() - Adds or updates a mongo-style query option in the DynamicView filter pipeline
     *
     * @param {object} query - A mongo-style query object to apply to pipeline
     * @param {(string|number)=} uid - Optional: The unique ID of this filter, to reference it in the future.
     * @returns {DynamicView} this DynamicView object, for further chain ops.
     * @memberof DynamicView
     */
    DynamicView.prototype.applyFind = function (query, uid) {
      this.applyFilter({
        type: 'find',
        val: query,
        uid: uid
      });
      return this;
    };

    /**
     * applyWhere() - Adds or updates a javascript filter function in the DynamicView filter pipeline
     *
     * @param {function} fun - A javascript filter function to apply to pipeline
     * @param {(string|number)=} uid - Optional: The unique ID of this filter, to reference it in the future.
     * @returns {DynamicView} this DynamicView object, for further chain ops.
     * @memberof DynamicView
     */
    DynamicView.prototype.applyWhere = function (fun, uid) {
      this.applyFilter({
        type: 'where',
        val: fun,
        uid: uid
      });
      return this;
    };

    /**
     * removeFilter() - Remove the specified filter from the DynamicView filter pipeline
     *
     * @param {(string|number)} uid - The unique ID of the filter to be removed.
     * @returns {DynamicView} this DynamicView object, for further chain ops.
     * @memberof DynamicView
     */
    DynamicView.prototype.removeFilter = function (uid) {
      var idx = this._indexOfFilterWithId(uid);
      if (idx < 0) {
        throw new Error("Dynamic view does not contain a filter with ID: " + uid);
      }

      this.filterPipeline.splice(idx, 1);
      this.reapplyFilters();
      return this;
    };

    /**
     * count() - returns the number of documents representing the current DynamicView contents.
     *
     * @returns {number} The number of documents representing the current DynamicView contents.
     * @memberof DynamicView
     */
    DynamicView.prototype.count = function () {
      // in order to be accurate we will pay the minimum cost (and not alter dv state management)
      // recurring resultset data resolutions should know internally its already up to date.
      // for persistent data this will not update resultdata nor fire rebuild event.
      if (this.resultsdirty) {
        this.resultdata = this.resultset.data();
      }

      return this.resultset.count();
    };

    /**
     * data() - resolves and pending filtering and sorting, then returns document array as result.
     *
     * @param {object=} options - optional parameters to pass to resultset.data() if non-persistent
     * @param {boolean} options.forceClones - Allows forcing the return of cloned objects even when
     *        the collection is not configured for clone object.
     * @param {string} options.forceCloneMethod - Allows overriding the default or collection specified cloning method.
     *        Possible values include 'parse-stringify', 'jquery-extend-deep', 'shallow', 'shallow-assign'
     * @param {bool} options.removeMeta - Will force clones and strip $loki and meta properties from documents
     * @returns {array} An array of documents representing the current DynamicView contents.
     * @memberof DynamicView
     */
    DynamicView.prototype.data = function (options) {
      // using final sort phase as 'catch all' for a few use cases which require full rebuild
      if (this.sortDirty || this.resultsdirty) {
        this.performSortPhase({
          suppressRebuildEvent: true
        });
      }
      return (this.options.persistent) ? (this.resultdata) : (this.resultset.data(options));
    };

    /**
     * queueRebuildEvent() - When the view is not sorted we may still wish to be notified of rebuild events.
     *     This event will throttle and queue a single rebuild event when batches of updates affect the view.
     */
    DynamicView.prototype.queueRebuildEvent = function () {
      if (this.rebuildPending) {
        return;
      }
      this.rebuildPending = true;

      var self = this;
      setTimeout(function () {
        if (self.rebuildPending) {
          self.rebuildPending = false;
          self.emit('rebuild', self);
        }
      }, this.options.minRebuildInterval);
    };

    /**
     * queueSortPhase : If the view is sorted we will throttle sorting to either :
     *    (1) passive - when the user calls data(), or
     *    (2) active - once they stop updating and yield js thread control
     */
    DynamicView.prototype.queueSortPhase = function () {
      // already queued? exit without queuing again
      if (this.sortDirty) {
        return;
      }
      this.sortDirty = true;

      var self = this;
      if (this.options.sortPriority === "active") {
        // active sorting... once they are done and yield js thread, run async performSortPhase()
        setTimeout(function () {
          self.performSortPhase();
        }, this.options.minRebuildInterval);
      } else {
        // must be passive sorting... since not calling performSortPhase (until data call), lets use queueRebuildEvent to
        // potentially notify user that data has changed.
        this.queueRebuildEvent();
      }
    };

    /**
     * performSortPhase() - invoked synchronously or asynchronously to perform final sort phase (if needed)
     *
     */
    DynamicView.prototype.performSortPhase = function (options) {
      // async call to this may have been pre-empted by synchronous call to data before async could fire
      if (!this.sortDirty && !this.resultsdirty) {
        return;
      }

      options = options || {};

      if (this.sortDirty) {
        if (this.sortFunction) {
          this.resultset.sort(this.sortFunction);
        } else if (this.sortCriteria) {
          this.resultset.compoundsort(this.sortCriteria);
        } else if (this.sortCriteriaSimple) {
          this.resultset.simplesort(this.sortCriteriaSimple.propname, this.sortCriteriaSimple.options);
        }

        this.sortDirty = false;
      }

      if (this.options.persistent) {
        // persistent view, rebuild local resultdata array
        this.resultdata = this.resultset.data();
        this.resultsdirty = false;
      }

      if (!options.suppressRebuildEvent) {
        this.emit('rebuild', this);
      }
    };

    /**
     * evaluateDocument() - internal method for (re)evaluating document inclusion.
     *    Called by : collection.insert() and collection.update().
     *
     * @param {int} objIndex - index of document to (re)run through filter pipeline.
     * @param {bool} isNew - true if the document was just added to the collection.
     */
    DynamicView.prototype.evaluateDocument = function (objIndex, isNew) {
      // if no filter applied yet, the result 'set' should remain 'everything'
      if (!this.resultset.filterInitialized) {
        if (this.options.persistent) {
          this.resultdata = this.resultset.data();
        }
        // need to re-sort to sort new document
        if (this.sortFunction || this.sortCriteria || this.sortCriteriaSimple) {
          this.queueSortPhase();
        } else {
          this.queueRebuildEvent();
        }
        return;
      }

      var ofr = this.resultset.filteredrows;
      var oldPos = (isNew) ? (-1) : (ofr.indexOf(+objIndex));
      var oldlen = ofr.length;

      // creating a 1-element resultset to run filter chain ops on to see if that doc passes filters;
      // mostly efficient algorithm, slight stack overhead price (this function is called on inserts and updates)
      var evalResultset = new Resultset(this.collection);
      evalResultset.filteredrows = [objIndex];
      evalResultset.filterInitialized = true;
      var filter;
      for (var idx = 0, len = this.filterPipeline.length; idx < len; idx++) {
        filter = this.filterPipeline[idx];
        evalResultset[filter.type](filter.val);
      }

      // not a true position, but -1 if not pass our filter(s), 0 if passed filter(s)
      var newPos = (evalResultset.filteredrows.length === 0) ? -1 : 0;

      // wasn't in old, shouldn't be now... do nothing
      if (oldPos === -1 && newPos === -1) return;

      // wasn't in resultset, should be now... add
      if (oldPos === -1 && newPos !== -1) {
        ofr.push(objIndex);

        if (this.options.persistent) {
          this.resultdata.push(this.collection.data[objIndex]);
        }

        // need to re-sort to sort new document
        if (this.sortFunction || this.sortCriteria || this.sortCriteriaSimple) {
          this.queueSortPhase();
        } else {
          this.queueRebuildEvent();
        }

        return;
      }

      // was in resultset, shouldn't be now... delete
      if (oldPos !== -1 && newPos === -1) {
        if (oldPos < oldlen - 1) {
          ofr.splice(oldPos, 1);

          if (this.options.persistent) {
            this.resultdata.splice(oldPos, 1);
          }
        } else {
          ofr.length = oldlen - 1;

          if (this.options.persistent) {
            this.resultdata.length = oldlen - 1;
          }
        }

        // in case changes to data altered a sort column
        if (this.sortFunction || this.sortCriteria || this.sortCriteriaSimple) {
          this.queueSortPhase();
        } else {
          this.queueRebuildEvent();
        }

        return;
      }

      // was in resultset, should still be now... (update persistent only?)
      if (oldPos !== -1 && newPos !== -1) {
        if (this.options.persistent) {
          // in case document changed, replace persistent view data with the latest collection.data document
          this.resultdata[oldPos] = this.collection.data[objIndex];
        }

        // in case changes to data altered a sort column
        if (this.sortFunction || this.sortCriteria || this.sortCriteriaSimple) {
          this.queueSortPhase();
        } else {
          this.queueRebuildEvent();
        }

        return;
      }
    };

    /**
     * removeDocument() - internal function called on collection.delete()
     * @param {number|number[]} objIndex - index of document to (re)run through filter pipeline.
     */
    DynamicView.prototype.removeDocument = function (objIndex) {
      var idx, rmidx, rmlen, rxo = {}, fxo = {};
      var adjels = [];
      var drs = this.resultset;
      var fr = this.resultset.filteredrows;
      var frlen = fr.length;

      // if no filter applied yet, the result 'set' should remain 'everything'
      if (!this.resultset.filterInitialized) {
        if (this.options.persistent) {
          this.resultdata = this.resultset.data();
        }
        // in case changes to data altered a sort column
        if (this.sortFunction || this.sortCriteria || this.sortCriteriaSimple) {
          this.queueSortPhase();
        } else {
          this.queueRebuildEvent();
        }
        return;
      }

      // if passed single index, wrap in array
      if (!Array.isArray(objIndex)) {
        objIndex = [objIndex];
      }

      rmlen = objIndex.length;
      // create intersection object of data indices to remove
      for(rmidx=0;rmidx<rmlen; rmidx++) {
        rxo[objIndex[rmidx]] = true;
      }

      // pivot remove data indices into remove filteredrows indices and dump in hashobject
      for (idx=0; idx<frlen; idx++) {
        if (rxo[fr[idx]]) fxo[idx] = true;
      }

      // if any of the removed items were in our filteredrows...
      if (Object.keys(fxo).length > 0) {
        // remove them from filtered rows
        this.resultset.filteredrows = this.resultset.filteredrows.filter(function(di, idx) { return !fxo[idx]; });
        // if persistent...
        if (this.options.persistent) {
          // remove from resultdata
          this.resultdata = this.resultdata.filter(function(obj, idx) { return !fxo[idx]; });
        }

        // and queue sorts 
        if (this.sortFunction || this.sortCriteria || this.sortCriteriaSimple) {
          this.queueSortPhase();
        } else {
          this.queueRebuildEvent();
        }
      }

      // to remove holes, we need to 'shift down' indices, this filter function finds number of positions to shift
      var filt = function(idx) { return function(di) { return di < drs.filteredrows[idx]; }; };

      frlen = drs.filteredrows.length;
      for (idx = 0; idx < frlen; idx++) {
        // grab subset of removed elements where data index is less than current filtered row data index;
        // use this to determine how many positions iterated remaining data index needs to be 'shifted down'
        adjels = objIndex.filter(filt(idx));
        drs.filteredrows[idx] -= adjels.length;
      }
    };

    /**
     * mapReduce() - data transformation via user supplied functions
     *
     * @param {function} mapFunction - this function accepts a single document for you to transform and return
     * @param {function} reduceFunction - this function accepts many (array of map outputs) and returns single value
     * @returns The output of your reduceFunction
     * @memberof DynamicView
     */
    DynamicView.prototype.mapReduce = function (mapFunction, reduceFunction) {
      try {
        return reduceFunction(this.data().map(mapFunction));
      } catch (err) {
        throw err;
      }
    };


    /**
     * Collection class that handles documents of same type
     * @constructor Collection
     * @implements LokiEventEmitter
     * @param {string} name - collection name
     * @param {(array|object)=} options - (optional) array of property names to be indicized OR a configuration object
     * @param {array=} [options.unique=[]] - array of property names to define unique constraints for
     * @param {array=} [options.exact=[]] - array of property names to define exact constraints for
     * @param {array=} [options.indices=[]] - array property names to define binary indexes for
     * @param {boolean} [options.adaptiveBinaryIndices=true] - collection indices will be actively rebuilt rather than lazily
     * @param {boolean} [options.asyncListeners=false] - whether listeners are invoked asynchronously
     * @param {boolean} [options.disableMeta=false] - set to true to disable meta property on documents
     * @param {boolean} [options.disableChangesApi=true] - set to false to enable Changes API
     * @param {boolean} [options.disableDeltaChangesApi=true] - set to false to enable Delta Changes API (requires Changes API, forces cloning)
     * @param {boolean} [options.autoupdate=false] - use Object.observe to update objects automatically
     * @param {boolean} [options.clone=false] - specify whether inserts and queries clone to/from user
     * @param {boolean} [options.serializableIndices=true[]] - converts date values on binary indexed properties to epoch time
     * @param {string} [options.cloneMethod='parse-stringify'] - 'parse-stringify', 'jquery-extend-deep', 'shallow', 'shallow-assign'
     * @param {int=} options.ttl - age of document (in ms.) before document is considered aged/stale.
     * @param {int=} options.ttlInterval - time interval for clearing out 'aged' documents; not set by default.
     * @see {@link Loki#addCollection} for normal creation of collections
     */
    function Collection(name, options) {
      // the name of the collection

      this.name = name;
      // the data held by the collection
      this.data = [];
      this.idIndex = []; // index of id
      this.binaryIndices = {}; // user defined indexes
      this.constraints = {
        unique: {},
        exact: {}
      };

      // unique contraints contain duplicate object references, so they are not persisted.
      // we will keep track of properties which have unique contraint applied here, and regenerate on load
      this.uniqueNames = [];

      // transforms will be used to store frequently used query chains as a series of steps
      // which itself can be stored along with the database.
      this.transforms = {};

      // the object type of the collection
      this.objType = name;

      // in autosave scenarios we will use collection level dirty flags to determine whether save is needed.
      // currently, if any collection is dirty we will autosave the whole database if autosave is configured.
      // defaulting to true since this is called from addCollection and adding a collection should trigger save
      this.dirty = true;

      // private holders for cached data
      this.cachedIndex = null;
      this.cachedBinaryIndex = null;
      this.cachedData = null;
      var self = this;

      /* OPTIONS */
      options = options || {};

      // exact match and unique constraints
      if (options.hasOwnProperty('unique')) {
        if (!Array.isArray(options.unique)) {
          options.unique = [options.unique];
        }
        options.unique.forEach(function (prop) {
          self.uniqueNames.push(prop); // used to regenerate on subsequent database loads
          self.constraints.unique[prop] = new UniqueIndex(prop);
        });
      }

      if (options.hasOwnProperty('exact')) {
        options.exact.forEach(function (prop) {
          self.constraints.exact[prop] = new ExactIndex(prop);
        });
      }

      // if set to true we will optimally keep indices 'fresh' during insert/update/remove ops (never dirty/never needs rebuild)
      // if you frequently intersperse insert/update/remove ops between find ops this will likely be significantly faster option.
      this.adaptiveBinaryIndices = options.hasOwnProperty('adaptiveBinaryIndices') ? options.adaptiveBinaryIndices : true;

      // is collection transactional
      this.transactional = options.hasOwnProperty('transactional') ? options.transactional : false;

      // options to clone objects when inserting them
      this.cloneObjects = options.hasOwnProperty('clone') ? options.clone : false;

      // default clone method (if enabled) is parse-stringify
      this.cloneMethod = options.hasOwnProperty('cloneMethod') ? options.cloneMethod : "parse-stringify";

      // option to make event listeners async, default is sync
      this.asyncListeners = options.hasOwnProperty('asyncListeners') ? options.asyncListeners : false;

      // if set to true we will not maintain a meta property for a document
      this.disableMeta = options.hasOwnProperty('disableMeta') ? options.disableMeta : false;

      // disable track changes
      this.disableChangesApi = options.hasOwnProperty('disableChangesApi') ? options.disableChangesApi : true;

      // disable delta update object style on changes
      this.disableDeltaChangesApi = options.hasOwnProperty('disableDeltaChangesApi') ? options.disableDeltaChangesApi : true;
      if (this.disableChangesApi) { this.disableDeltaChangesApi = true; }

      // option to observe objects and update them automatically, ignored if Object.observe is not supported
      this.autoupdate = options.hasOwnProperty('autoupdate') ? options.autoupdate : false;

      // by default, if you insert a document into a collection with binary indices, if those indexed properties contain
      // a DateTime we will convert to epoch time format so that (across serializations) its value position will be the
      // same 'after' serialization as it was 'before'.
      this.serializableIndices = options.hasOwnProperty('serializableIndices') ? options.serializableIndices : true;

      //option to activate a cleaner daemon - clears "aged" documents at set intervals.
      this.ttl = {
        age: null,
        ttlInterval: null,
        daemon: null
      };
      this.setTTL(options.ttl || -1, options.ttlInterval);

      // currentMaxId - change manually at your own peril!
      this.maxId = 0;

      this.DynamicViews = [];

      // events
      this.events = {
        'insert': [],
        'update': [],
        'pre-insert': [],
        'pre-update': [],
        'close': [],
        'flushbuffer': [],
        'error': [],
        'delete': [],
        'warning': []
      };

      // changes are tracked by collection and aggregated by the db
      this.changes = [];

      // initialize the id index
      this.ensureId();
      var indices = [];
      // initialize optional user-supplied indices array ['age', 'lname', 'zip']
      if (options && options.indices) {
        if (Object.prototype.toString.call(options.indices) === '[object Array]') {
          indices = options.indices;
        } else if (typeof options.indices === 'string') {
          indices = [options.indices];
        } else {
          throw new TypeError('Indices needs to be a string or an array of strings');
        }
      }

      for (var idx = 0; idx < indices.length; idx++) {
        this.ensureIndex(indices[idx]);
      }

      function observerCallback(changes) {

        var changedObjects = typeof Set === 'function' ? new Set() : [];

        if (!changedObjects.add)
          changedObjects.add = function (object) {
            if (this.indexOf(object) === -1)
              this.push(object);
            return this;
          };

        changes.forEach(function (change) {
          changedObjects.add(change.object);
        });

        changedObjects.forEach(function (object) {
          if (!hasOwnProperty.call(object, '$loki'))
            return self.removeAutoUpdateObserver(object);
          try {
            self.update(object);
          } catch (err) {}
        });
      }

      this.observerCallback = observerCallback;

      //Compare changed object (which is a forced clone) with existing object and return the delta
      function getChangeDelta(obj, old) {
        if (old) {
          return getObjectDelta(old, obj);
        }
        else {
          return JSON.parse(JSON.stringify(obj));
        }
      }

      this.getChangeDelta = getChangeDelta;

      function getObjectDelta(oldObject, newObject) {
        var propertyNames = newObject !== null && typeof newObject === 'object' ? Object.keys(newObject) : null;
        if (propertyNames && propertyNames.length && ['string', 'boolean', 'number'].indexOf(typeof(newObject)) < 0) {
          var delta = {};
          for (var i = 0; i < propertyNames.length; i++) {
            var propertyName = propertyNames[i];
            if (newObject.hasOwnProperty(propertyName)) {
              if (!oldObject.hasOwnProperty(propertyName) || self.uniqueNames.indexOf(propertyName) >= 0 || propertyName == '$loki' || propertyName == 'meta') {
                delta[propertyName] = newObject[propertyName];
              }
              else {
                var propertyDelta = getObjectDelta(oldObject[propertyName], newObject[propertyName]);
                if (typeof propertyDelta !== "undefined" && propertyDelta != {}) {
                  delta[propertyName] = propertyDelta;
                }
              }
            }
          }
          return Object.keys(delta).length === 0 ? undefined : delta;
        }
        else {
          return oldObject === newObject ? undefined : newObject;
        }
      }

      this.getObjectDelta = getObjectDelta;

      // clear all the changes
      function flushChanges() {
        self.changes = [];
      }

      this.getChanges = function () {
        return self.changes;
      };

      this.flushChanges = flushChanges;

      this.setChangesApi = function (enabled) {
        self.disableChangesApi = !enabled;
        if (!enabled) { self.disableDeltaChangesApi = false; }
      };

      this.on('delete', function deleteCallback(obj) {
        if (!self.disableChangesApi) {
          self.createChange(self.name, 'R', obj);
        }
      });

      this.on('warning', function (warning) {
        self.console.warn(warning);
      });
      // for de-serialization purposes
      flushChanges();
    }

    Collection.prototype = new LokiEventEmitter();

    /*
      * For ChangeAPI default to clone entire object, for delta changes create object with only differences (+ $loki and meta)
      */
    Collection.prototype.createChange = function(name, op, obj, old) {
      this.changes.push({
        name: name,
        operation: op,
        obj: op == 'U' && !this.disableDeltaChangesApi ? this.getChangeDelta(obj, old) : JSON.parse(JSON.stringify(obj))
      });
    };

    Collection.prototype.insertMeta = function(obj) {
      var len, idx;

      if (this.disableMeta || !obj) {
        return;
      }

      // if batch insert
      if (Array.isArray(obj)) {
        len = obj.length;

        for(idx=0; idx<len; idx++) {
          if (!obj[idx].hasOwnProperty('meta')) {
            obj[idx].meta = {};
          }

          obj[idx].meta.created = (new Date()).getTime();
          obj[idx].meta.revision = 0;
        }

        return;
      }

      // single object
      if (!obj.meta) {
        obj.meta = {};
      }

      obj.meta.created = (new Date()).getTime();
      obj.meta.revision = 0;
    };

    Collection.prototype.updateMeta = function(obj) {
      if (this.disableMeta || !obj) {
        return;
      }
      obj.meta.updated = (new Date()).getTime();
      obj.meta.revision += 1;
    };

    Collection.prototype.createInsertChange = function(obj) {
      this.createChange(this.name, 'I', obj);
    };

    Collection.prototype.createUpdateChange = function(obj, old) {
      this.createChange(this.name, 'U', obj, old);
    };

    Collection.prototype.insertMetaWithChange = function(obj) {
      this.insertMeta(obj);
      this.createInsertChange(obj);
    };

    Collection.prototype.updateMetaWithChange = function(obj, old) {
      this.updateMeta(obj);
      this.createUpdateChange(obj, old);
    };

    Collection.prototype.console = {
      log: function () {},
      warn: function () {},
      error: function () {},
    };

    Collection.prototype.addAutoUpdateObserver = function (object) {
      if (!this.autoupdate || typeof Object.observe !== 'function')
        return;

      Object.observe(object, this.observerCallback, ['add', 'update', 'delete', 'reconfigure', 'setPrototype']);
    };

    Collection.prototype.removeAutoUpdateObserver = function (object) {
      if (!this.autoupdate || typeof Object.observe !== 'function')
        return;

      Object.unobserve(object, this.observerCallback);
    };

    /**
     * Adds a named collection transform to the collection
     * @param {string} name - name to associate with transform
     * @param {array} transform - an array of transformation 'step' objects to save into the collection
     * @memberof Collection
     * @example
     * users.addTransform('progeny', [
     *   {
     *     type: 'find',
     *     value: {
     *       'age': {'$lte': 40}
     *     }
     *   }
     * ]);
     *
     * var results = users.chain('progeny').data();
     */
    Collection.prototype.addTransform = function (name, transform) {
      if (this.transforms.hasOwnProperty(name)) {
        throw new Error("a transform by that name already exists");
      }

      this.transforms[name] = transform;
    };

    /**
     * Retrieves a named transform from the collection.
     * @param {string} name - name of the transform to lookup.
     * @memberof Collection
     */
    Collection.prototype.getTransform = function (name) {
      return this.transforms[name];
    };

    /**
     * Updates a named collection transform to the collection
     * @param {string} name - name to associate with transform
     * @param {object} transform - a transformation object to save into collection
     * @memberof Collection
     */
    Collection.prototype.setTransform = function (name, transform) {
      this.transforms[name] = transform;
    };

    /**
     * Removes a named collection transform from the collection
     * @param {string} name - name of collection transform to remove
     * @memberof Collection
     */
    Collection.prototype.removeTransform = function (name) {
      delete this.transforms[name];
    };

    Collection.prototype.byExample = function (template) {
      var k, obj, query;
      query = [];
      for (k in template) {
        if (!template.hasOwnProperty(k)) continue;
        query.push((
          obj = {},
          obj[k] = template[k],
          obj
        ));
      }
      return {
        '$and': query
      };
    };

    Collection.prototype.findObject = function (template) {
      return this.findOne(this.byExample(template));
    };

    Collection.prototype.findObjects = function (template) {
      return this.find(this.byExample(template));
    };

    /*----------------------------+
    | TTL daemon                  |
    +----------------------------*/
    Collection.prototype.ttlDaemonFuncGen = function () {
      var collection = this;
      var age = this.ttl.age;
      return function ttlDaemon() {
        var now = Date.now();
        var toRemove = collection.chain().where(function daemonFilter(member) {
          var timestamp = member.meta.updated || member.meta.created;
          var diff = now - timestamp;
          return age < diff;
        });
        toRemove.remove();
      };
    };

    /**
     * Updates or applies collection TTL settings.
     * @param {int} age - age (in ms) to expire document from collection
     * @param {int} interval - time (in ms) to clear collection of aged documents.
     * @memberof Collection
     */
    Collection.prototype.setTTL = function (age, interval) {
      if (age < 0) {
        clearInterval(this.ttl.daemon);
      } else {
        this.ttl.age = age;
        this.ttl.ttlInterval = interval;
        this.ttl.daemon = setInterval(this.ttlDaemonFuncGen(), interval);
      }
    };

    /*----------------------------+
    | INDEXING                    |
    +----------------------------*/

    /**
     * create a row filter that covers all documents in the collection
     */
    Collection.prototype.prepareFullDocIndex = function () {
      var len = this.data.length;
      var indexes = new Array(len);
      for (var i = 0; i < len; i += 1) {
        indexes[i] = i;
      }
      return indexes;
    };

    /**
     * Will allow reconfiguring certain collection options.
     * @param {boolean} options.adaptiveBinaryIndices - collection indices will be actively rebuilt rather than lazily
     * @memberof Collection
     */
    Collection.prototype.configureOptions = function (options) {
      options = options || {};

      if (options.hasOwnProperty('adaptiveBinaryIndices')) {
        this.adaptiveBinaryIndices = options.adaptiveBinaryIndices;

        // if switching to adaptive binary indices, make sure none are 'dirty'
        if (this.adaptiveBinaryIndices) {
          this.ensureAllIndexes();
        }
      }
    };

    /**
     * Ensure binary index on a certain field
     * @param {string} property - name of property to create binary index on
     * @param {boolean=} force - (Optional) flag indicating whether to construct index immediately
     * @memberof Collection
     */
    Collection.prototype.ensureIndex = function (property, force) {
      // optional parameter to force rebuild whether flagged as dirty or not
      if (typeof (force) === 'undefined') {
        force = false;
      }

      if (property === null || property === undefined) {
        throw new Error('Attempting to set index without an associated property');
      }

      if (this.binaryIndices[property] && !force) {
        if (!this.binaryIndices[property].dirty) return;
      }

      // if the index is already defined and we are using adaptiveBinaryIndices and we are not forcing a rebuild, return.
      if (this.adaptiveBinaryIndices === true && this.binaryIndices.hasOwnProperty(property) && !force) {
        return;
      }

      var index = {
        'name': property,
        'dirty': true,
        'values': this.prepareFullDocIndex()
      };
      this.binaryIndices[property] = index;

      var wrappedComparer =
        (function (prop, data) {
          var val1, val2, arr;
          return function (a, b) {
            if (~prop.indexOf('.')) {
              arr = prop.split('.');
              val1 = Utils.getIn(data[a], arr, true);
              val2 = Utils.getIn(data[b], arr, true);
            } else {
              val1 = data[a][prop];
              val2 = data[b][prop];
            }

            if (val1 !== val2) {
              if (Comparators.lt(val1, val2, false)) return -1;
              if (Comparators.gt(val1, val2, false)) return 1;
            }
            return 0;
          };
        })(property, this.data);

      index.values.sort(wrappedComparer);
      index.dirty = false;

      this.dirty = true; // for autosave scenarios
    };

    /**
     * Perform checks to determine validity/consistency of all binary indices
     * @param {object=} options - optional configuration object
     * @param {boolean} [options.randomSampling=false] - whether (faster) random sampling should be used
     * @param {number} [options.randomSamplingFactor=0.10] - percentage of total rows to randomly sample
     * @param {boolean} [options.repair=false] - whether to fix problems if they are encountered
     * @returns {string[]} array of index names where problems were found.
     * @memberof Collection
     * @example
     * // check all indices on a collection, returns array of invalid index names
     * var result = coll.checkAllIndexes({ repair: true, randomSampling: true, randomSamplingFactor: 0.15 });
     * if (result.length > 0) {
     *   results.forEach(function(name) { 
     *     console.log('problem encountered with index : ' + name); 
     *   });
     * }     
     */
    Collection.prototype.checkAllIndexes = function (options) {
      var key, bIndices = this.binaryIndices;
      var results = [], result;

      for (key in bIndices) {
        if (hasOwnProperty.call(bIndices, key)) {
          result = this.checkIndex(key, options);
          if (!result) {
            results.push(key);
          }
        }
      }

      return results;
    };

    /**
     * Perform checks to determine validity/consistency of a binary index
     * @param {string} property - name of the binary-indexed property to check
     * @param {object=} options - optional configuration object
     * @param {boolean} [options.randomSampling=false] - whether (faster) random sampling should be used
     * @param {number} [options.randomSamplingFactor=0.10] - percentage of total rows to randomly sample
     * @param {boolean} [options.repair=false] - whether to fix problems if they are encountered
     * @returns {boolean} whether the index was found to be valid (before optional correcting).
     * @memberof Collection
     * @example
     * // full test
     * var valid = coll.checkIndex('name');
     * // full test with repair (if issues found)
     * valid = coll.checkIndex('name', { repair: true });
     * // random sampling (default is 10% of total document count)
     * valid = coll.checkIndex('name', { randomSampling: true });
     * // random sampling (sample 20% of total document count)
     * valid = coll.checkIndex('name', { randomSampling: true, randomSamplingFactor: 0.20 });
     * // random sampling (implied boolean)
     * valid = coll.checkIndex('name', { randomSamplingFactor: 0.20 });
     * // random sampling with repair (if issues found)
     * valid = coll.checkIndex('name', { repair: true, randomSampling: true });
     */
    Collection.prototype.checkIndex = function (property, options) {
      options = options || {};
      // if 'randomSamplingFactor' specified but not 'randomSampling', assume true
      if (options.randomSamplingFactor && options.randomSampling !== false) {
        options.randomSampling = true;
      }
      options.randomSamplingFactor = options.randomSamplingFactor || 0.1;
      if (options.randomSamplingFactor < 0 || options.randomSamplingFactor > 1) {
        options.randomSamplingFactor = 0.1;
      }

      var valid=true, idx, iter, pos, len, biv;

      // make sure we are passed a valid binary index name
      if (!this.binaryIndices.hasOwnProperty(property)) {
        throw new Error("called checkIndex on property without an index: " + property);
      }

      // if lazy indexing, rebuild only if flagged as dirty
      if (!this.adaptiveBinaryIndices) {
        this.ensureIndex(property);
      }

      biv = this.binaryIndices[property].values;
      len = biv.length;

      // if the index has an incorrect number of values
      if (len !== this.data.length) {
        if (options.repair) {
          this.ensureIndex(property, true);
        }
        return false;
      }

      if (len === 0) {
        return true;
      }

      var usingDotNotation = (property.indexOf('.') !== -1);

      if (len === 1) {
        valid = (biv[0] === 0);
      }
      else {
        if (options.randomSampling) {
          // validate first and last
          if (!LokiOps.$lte(Utils.getIn(this.data[biv[0]], property, usingDotNotation),
                            Utils.getIn(this.data[biv[1]], property, usingDotNotation))) {
            valid=false;
          }
          if (!LokiOps.$lte(Utils.getIn(this.data[biv[len-2]], property, usingDotNotation),
                            Utils.getIn(this.data[biv[len-1]], property, usingDotNotation))) {
            valid=false;
          }

          // if first and last positions are sorted correctly with their nearest neighbor,
          // continue onto random sampling phase...
          if (valid) {
            // # random samplings = total count * sampling factor
            iter = Math.floor((len-1) * options.randomSamplingFactor);

            // for each random sampling, validate that the binary index is sequenced properly
            // with next higher value.
            for(idx=0; idx<iter-1; idx++) {
              // calculate random position
              pos = Math.floor(Math.random() * (len-1));
              if (!LokiOps.$lte(Utils.getIn(this.data[biv[pos]], property, usingDotNotation),
                                Utils.getIn(this.data[biv[pos+1]], property, usingDotNotation))) {
                valid=false;
                break;
              }
            }
          }
        }
        else {
          // validate that the binary index is sequenced properly
          for(idx=0; idx<len-1; idx++) {
            if (!LokiOps.$lte(Utils.getIn(this.data[biv[idx]], property, usingDotNotation),
                              Utils.getIn(this.data[biv[idx+1]], property, usingDotNotation))) {
              valid=false;
              break;
            }
          }
        }
      }

      // if incorrectly sequenced and we are to fix problems, rebuild index
      if (!valid && options.repair) {
        this.ensureIndex(property, true);
      }

      return valid;
    };

    Collection.prototype.getBinaryIndexValues = function (property) {
      var idx, idxvals = this.binaryIndices[property].values;
      var result = [];

      for (idx = 0; idx < idxvals.length; idx++) {
        result.push(Utils.getIn(this.data[idxvals[idx]], property, true));
      }

      return result;
    };

    Collection.prototype.ensureUniqueIndex = function (field) {
      var index = this.constraints.unique[field];
      if (!index) {
        // keep track of new unique index for regenerate after database (re)load.
        if (this.uniqueNames.indexOf(field) == -1) {
          this.uniqueNames.push(field);
        }
      }

      // if index already existed, (re)loading it will likely cause collisions, rebuild always
      this.constraints.unique[field] = index = new UniqueIndex(field);
      this.data.forEach(function (obj) {
        index.set(obj);
      });
      return index;
    };

    /**
     * Ensure all binary indices
     * @param {boolean} force - whether to force rebuild of existing lazy binary indices
     * @memberof Collection
     */
    Collection.prototype.ensureAllIndexes = function (force) {
      var key, bIndices = this.binaryIndices;
      for (key in bIndices) {
        if (hasOwnProperty.call(bIndices, key)) {
          this.ensureIndex(key, force);
        }
      }
    };

    /**
     * Internal method used to flag all lazy index as dirty
     */
    Collection.prototype.flagBinaryIndexesDirty = function () {
      var key, bIndices = this.binaryIndices;
      for (key in bIndices) {
        if (hasOwnProperty.call(bIndices, key)) {
          bIndices[key].dirty = true;
        }
      }
    };

    /**
     * Internal method used to flag a lazy index as dirty
     */
    Collection.prototype.flagBinaryIndexDirty = function (index) {
      if (this.binaryIndices[index])
        this.binaryIndices[index].dirty = true;
    };

    /**
     * Quickly determine number of documents in collection (or query)
     * @param {object=} query - (optional) query object to count results of
     * @returns {number} number of documents in the collection
     * @memberof Collection
     */
    Collection.prototype.count = function (query) {
      if (!query) {
        return this.data.length;
      }

      return this.chain().find(query).filteredrows.length;
    };

    /**
     * Rebuild idIndex
     */
    Collection.prototype.ensureId = function () {
      var len = this.data.length,
        i = 0;

      this.idIndex = [];
      for (i; i < len; i += 1) {
        this.idIndex.push(this.data[i].$loki);
      }
    };

    /**
     * Rebuild idIndex async with callback - useful for background syncing with a remote server
     */
    Collection.prototype.ensureIdAsync = function (callback) {
      this.async(function () {
        this.ensureId();
      }, callback);
    };

    /**
     * Add a dynamic view to the collection
     * @param {string} name - name of dynamic view to add
     * @param {object=} options - options to configure dynamic view with
     * @param {boolean} [options.persistent=false] - indicates if view is to main internal results array in 'resultdata'
     * @param {string} [options.sortPriority='passive'] - 'passive' (sorts performed on call to data) or 'active' (after updates)
     * @param {number} options.minRebuildInterval - minimum rebuild interval (need clarification to docs here)
     * @returns {DynamicView} reference to the dynamic view added
     * @memberof Collection
     * @example
     * var pview = users.addDynamicView('progeny');
     * pview.applyFind({'age': {'$lte': 40}});
     * pview.applySimpleSort('name');
     *
     * var results = pview.data();
     **/

    Collection.prototype.addDynamicView = function (name, options) {
      var dv = new DynamicView(this, name, options);
      this.DynamicViews.push(dv);

      return dv;
    };

    /**
     * Remove a dynamic view from the collection
     * @param {string} name - name of dynamic view to remove
     * @memberof Collection
     **/
    Collection.prototype.removeDynamicView = function (name) {
      this.DynamicViews = 
        this.DynamicViews.filter(function(dv) { return dv.name !== name; });
    };

    /**
     * Look up dynamic view reference from within the collection
     * @param {string} name - name of dynamic view to retrieve reference of
     * @returns {DynamicView} A reference to the dynamic view with that name
     * @memberof Collection
     **/
    Collection.prototype.getDynamicView = function (name) {
      for (var idx = 0; idx < this.DynamicViews.length; idx++) {
        if (this.DynamicViews[idx].name === name) {
          return this.DynamicViews[idx];
        }
      }

      return null;
    };

    /**
     * Applies a 'mongo-like' find query object and passes all results to an update function.
     * For filter function querying you should migrate to [updateWhere()]{@link Collection#updateWhere}.
     *
     * @param {object|function} filterObject - 'mongo-like' query object (or deprecated filterFunction mode)
     * @param {function} updateFunction - update function to run against filtered documents
     * @memberof Collection
     */
    Collection.prototype.findAndUpdate = function (filterObject, updateFunction) {
      if (typeof (filterObject) === "function") {
        this.updateWhere(filterObject, updateFunction);
      }
      else {
        this.chain().find(filterObject).update(updateFunction);
      }
    };

    /**
     * Applies a 'mongo-like' find query object removes all documents which match that filter.
     *
     * @param {object} filterObject - 'mongo-like' query object
     * @memberof Collection
     */
    Collection.prototype.findAndRemove = function(filterObject) {
      this.chain().find(filterObject).remove();
    };

    /**
     * Adds object(s) to collection, ensure object(s) have meta properties, clone it if necessary, etc.
     * @param {(object|array)} doc - the document (or array of documents) to be inserted
     * @returns {(object|array)} document or documents inserted
     * @memberof Collection
     * @example
     * users.insert({
     *     name: 'Odin',
     *     age: 50,
     *     address: 'Asgard'
     * });
     *
     * // alternatively, insert array of documents
     * users.insert([{ name: 'Thor', age: 35}, { name: 'Loki', age: 30}]);
     */
    Collection.prototype.insert = function (doc) {
      if (!Array.isArray(doc)) {
        return this.insertOne(doc);
      }

      // holder to the clone of the object inserted if collections is set to clone objects
      var obj;
      var results = [];

      this.emit('pre-insert', doc);
      for (var i = 0, len = doc.length; i < len; i++) {
        obj = this.insertOne(doc[i], true);
        if (!obj) {
          return undefined;
        }
        results.push(obj);
      }

      // at the 'batch' level, if clone option is true then emitted docs are clones
      this.emit('insert', results);

      // if clone option is set, clone return values
      results = this.cloneObjects ? clone(results, this.cloneMethod) : results;

      return results.length === 1 ? results[0] : results;
    };

    /**
     * Adds a single object, ensures it has meta properties, clone it if necessary, etc.
     * @param {object} doc - the document to be inserted
     * @param {boolean} bulkInsert - quiet pre-insert and insert event emits
     * @returns {object} document or 'undefined' if there was a problem inserting it
     */
    Collection.prototype.insertOne = function (doc, bulkInsert) {
      var err = null;
      var returnObj;

      if (typeof doc !== 'object') {
        err = new TypeError('Document needs to be an object');
      } else if (doc === null) {
        err = new TypeError('Object cannot be null');
      }

      if (err !== null) {
        this.emit('error', err);
        throw err;
      }

      // if configured to clone, do so now... otherwise just use same obj reference
      var obj = this.cloneObjects ? clone(doc, this.cloneMethod) : doc;

      if (!this.disableMeta && typeof obj.meta === 'undefined') {
        obj.meta = {
          revision: 0,
          created: 0
        };
      }

      // both 'pre-insert' and 'insert' events are passed internal data reference even when cloning
      // insert needs internal reference because that is where loki itself listens to add meta
      if (!bulkInsert) {
        this.emit('pre-insert', obj);
      }
      if (!this.add(obj)) {
        return undefined;
      }

      // update meta and store changes if ChangesAPI is enabled
      // (moved from "insert" event listener to allow internal reference to be used)
      if (this.disableChangesApi) {
        this.insertMeta(obj);
      }
      else {
        this.insertMetaWithChange(obj);
      }

      // if cloning is enabled, emit insert event with clone of new object
      returnObj = this.cloneObjects ? clone(obj, this.cloneMethod) : obj;
      if (!bulkInsert) {
        this.emit('insert', returnObj);
      }

      this.addAutoUpdateObserver(returnObj);
      return returnObj;
    };

    /**
     * Empties the collection.
     * @param {object=} options - configure clear behavior
     * @param {bool=} [options.removeIndices=false] - whether to remove indices in addition to data
     * @memberof Collection
     */
    Collection.prototype.clear = function (options) {
      var self = this;

      options = options || {};

      this.data = [];
      this.idIndex = [];
      this.cachedIndex = null;
      this.cachedBinaryIndex = null;
      this.cachedData = null;
      this.maxId = 0;
      this.DynamicViews = [];
      this.dirty = true;

      // if removing indices entirely
      if (options.removeIndices === true) {
        this.binaryIndices = {};

        this.constraints = {
          unique: {},
          exact: {}
        };
        this.uniqueNames = [];
      }
      // clear indices but leave definitions in place
      else {
        // clear binary indices
        var keys = Object.keys(this.binaryIndices);
        keys.forEach(function(biname) {
          self.binaryIndices[biname].dirty = false;
          self.binaryIndices[biname].values = [];
        });

        // clear entire unique indices definition
        this.constraints = {
          unique: {},
          exact: {}
        };

        // add definitions back
        this.uniqueNames.forEach(function(uiname) {
          self.ensureUniqueIndex(uiname);
        });
      }
    };

    /**
     * Updates an object and notifies collection that the document has changed.
     * @param {object} doc - document to update within the collection
     * @memberof Collection
     */
    Collection.prototype.update = function (doc) {
      var adaptiveBatchOverride, k, len;

      if (Array.isArray(doc)) {
        len = doc.length;

        // if not cloning, disable adaptive binary indices for the duration of the batch update,
        // followed by lazy rebuild and re-enabling adaptive indices after batch update.
        adaptiveBatchOverride = !this.cloneObjects &&
          this.adaptiveBinaryIndices && Object.keys(this.binaryIndices).length > 0;

        if (adaptiveBatchOverride) {
          this.adaptiveBinaryIndices = false;
        }

        try {
          for (k=0; k < len; k += 1) {
            this.update(doc[k]);
          }
        }
        finally {
          if (adaptiveBatchOverride) {
            this.ensureAllIndexes();
            this.adaptiveBinaryIndices = true;
          }
        }

        return;
      }

      // verify object is a properly formed document
      if (!hasOwnProperty.call(doc, '$loki')) {
        throw new Error('Trying to update unsynced document. Please save the document first by using insert() or addMany()');
      }
      try {
        this.startTransaction();
        var arr = this.get(doc.$loki, true),
          oldInternal,   // ref to existing obj
          newInternal, // ref to new internal obj
          position,
          self = this;

        if (!arr) {
          throw new Error('Trying to update a document not in collection.');
        }

        oldInternal = arr[0]; // -internal- obj ref
        position = arr[1]; // position in data array

        // if configured to clone, do so now... otherwise just use same obj reference
        newInternal = this.cloneObjects || !this.disableDeltaChangesApi ? clone(doc, this.cloneMethod) : doc;

        this.emit('pre-update', doc);

        Object.keys(this.constraints.unique).forEach(function (key) {
          self.constraints.unique[key].update(oldInternal, newInternal);
        });

        // operate the update
        this.data[position] = newInternal;

        if (newInternal !== doc) {
          this.addAutoUpdateObserver(doc);
        }

        // now that we can efficiently determine the data[] position of newly added document,
        // submit it for all registered DynamicViews to evaluate for inclusion/exclusion
        for (var idx = 0; idx < this.DynamicViews.length; idx++) {
          this.DynamicViews[idx].evaluateDocument(position, false);
        }

        var key;
        if (this.adaptiveBinaryIndices) {
          // for each binary index defined in collection, immediately update rather than flag for lazy rebuild
          var bIndices = this.binaryIndices;
          for (key in bIndices) {
            this.adaptiveBinaryIndexUpdate(position, key);
          }
        }
        else {
          this.flagBinaryIndexesDirty();
        }

        this.idIndex[position] = newInternal.$loki;
        //this.flagBinaryIndexesDirty();

        this.commit();
        this.dirty = true; // for autosave scenarios

        // update meta and store changes if ChangesAPI is enabled
        if (this.disableChangesApi) {
          this.updateMeta(newInternal, null);
        }
        else {
          this.updateMetaWithChange(newInternal, oldInternal);
        }

        var returnObj;

        // if cloning is enabled, emit 'update' event and return with clone of new object
        if (this.cloneObjects) {
          returnObj = clone(newInternal, this.cloneMethod);
        }
        else {
          returnObj = newInternal;
        }

        this.emit('update', returnObj, oldInternal);
        return returnObj;
      } catch (err) {
        this.rollback();
        this.console.error(err.message);
        this.emit('error', err);
        throw (err); // re-throw error so user does not think it succeeded
      }
    };

    /**
     * Add object to collection
     */
    Collection.prototype.add = function (obj) {
      // if parameter isn't object exit with throw
      if ('object' !== typeof obj) {
        throw new TypeError('Object being added needs to be an object');
      }
      // if object you are adding already has id column it is either already in the collection
      // or the object is carrying its own 'id' property.  If it also has a meta property,
      // then this is already in collection so throw error, otherwise rename to originalId and continue adding.
      if (typeof (obj.$loki) !== 'undefined') {
        throw new Error('Document is already in collection, please use update()');
      }

      /*
       * try adding object to collection
       */
      try {
        this.startTransaction();
        this.maxId++;

        if (isNaN(this.maxId)) {
          this.maxId = (this.data[this.data.length - 1].$loki + 1);
        }

        obj.$loki = this.maxId;

        if (!this.disableMeta) {
          obj.meta.version = 0;
        }

        var key, constrUnique = this.constraints.unique;
        for (key in constrUnique) {
          if (hasOwnProperty.call(constrUnique, key)) {
            constrUnique[key].set(obj);
          }
        }

        // add new obj id to idIndex
        this.idIndex.push(obj.$loki);

        // add the object
        this.data.push(obj);

        var addedPos = this.data.length - 1;

        // now that we can efficiently determine the data[] position of newly added document,
        // submit it for all registered DynamicViews to evaluate for inclusion/exclusion
        var dvlen = this.DynamicViews.length;
        for (var i = 0; i < dvlen; i++) {
          this.DynamicViews[i].evaluateDocument(addedPos, true);
        }

        if (this.adaptiveBinaryIndices) {
          // for each binary index defined in collection, immediately update rather than flag for lazy rebuild
          var bIndices = this.binaryIndices;
          for (key in bIndices) {
            this.adaptiveBinaryIndexInsert(addedPos, key);
          }
        }
        else {
          this.flagBinaryIndexesDirty();
        }

        this.commit();
        this.dirty = true; // for autosave scenarios

        return (this.cloneObjects) ? (clone(obj, this.cloneMethod)) : (obj);
      } catch (err) {
        this.rollback();
        this.console.error(err.message);
        this.emit('error', err);
        throw (err); // re-throw error so user does not think it succeeded
      }
    };

    /**
     * Applies a filter function and passes all results to an update function.
     *
     * @param {function} filterFunction - filter function whose results will execute update
     * @param {function} updateFunction - update function to run against filtered documents
     * @memberof Collection
     */
    Collection.prototype.updateWhere = function(filterFunction, updateFunction) {
      var results = this.where(filterFunction),
        i = 0,
        obj;
      try {
        for (i; i < results.length; i++) {
          obj = updateFunction(results[i]);
          this.update(obj);
        }

      } catch (err) {
        this.rollback();
        this.console.error(err.message);
      }
    };

    /**
     * Remove all documents matching supplied filter function.
     * For 'mongo-like' querying you should migrate to [findAndRemove()]{@link Collection#findAndRemove}.
     * @param {function|object} query - query object to filter on
     * @memberof Collection
     */
    Collection.prototype.removeWhere = function (query) {
      var list;
      if (typeof query === 'function') {
        list = this.data.filter(query);
        this.remove(list);
      } else {
        this.chain().find(query).remove();
      }
    };

    Collection.prototype.removeDataOnly = function () {
      this.remove(this.data.slice());
    };

    /**
     * Internal method to remove a batch of documents from the collection.
     * @param {number[]} positions - data/idIndex positions to remove
     */
    Collection.prototype.removeBatchByPositions = function(positions) {
      var len = positions.length;
      var xo = {};
      var dlen, didx, idx;
      var bic=Object.keys(this.binaryIndices).length;
      var uic=Object.keys(this.constraints.unique).length;
      var adaptiveOverride = this.adaptiveBinaryIndices && Object.keys(this.binaryIndices).length > 0;
      var doc, self=this;

      try {
        this.startTransaction();

        // create hashobject for positional removal inclusion tests...
        // all keys defined in this hashobject represent $loki ids of the documents to remove.
        for(idx=0; idx < len; idx++) {
          xo[this.idIndex[positions[idx]]] = true;
        }

        // if we will need to notify dynamic views and/or binary indices to update themselves...
        dlen = this.DynamicViews.length;
        if ((dlen > 0) || (bic > 0) || (uic > 0)) {
          if (dlen > 0) {
            // notify dynamic views to remove relevant documents at data positions
            for (didx = 0; didx < dlen; didx++) {
              // notify dv of remove (passing batch/array of positions)
              this.DynamicViews[didx].removeDocument(positions);
            }
          }

          // notify binary indices to update
          if (this.adaptiveBinaryIndices && !adaptiveOverride) {
            // for each binary index defined in collection, immediately update rather than flag for lazy rebuild
            var key, bIndices = this.binaryIndices;

            for (key in bIndices) {
              this.adaptiveBinaryIndexRemove(positions, key);
            }
          }
          else {
            this.flagBinaryIndexesDirty();
          }

          if (uic) {
            Object.keys(this.constraints.unique).forEach(function (key) {
              for(idx=0; idx < len; idx++) {
                doc = self.data[positions[idx]];
                if (doc[key] !== null && doc[key] !== undefined) {
                  self.constraints.unique[key].remove(doc[key]);
                }
              }
            });
          }
        }

        // emit 'delete' events only of listeners are attached.
        // since data not removed yet, in future we can emit single delete event with array...
        // for now that might be breaking change to put in potential 1.6 or LokiDB (lokijs2) version
        if (!this.disableChangesApi || this.events.delete.length > 1) {
          for(idx=0; idx < len; idx++) {
            this.emit('delete', this.data[positions[idx]]);
          }
        }

        // remove from data[] :
        // filter collection data for items not in inclusion hashobject
        this.data = this.data.filter(function(obj) {
          return !xo[obj.$loki];
        });

        // remove from idIndex[] :
        // filter idIndex for items not in inclusion hashobject
        this.idIndex = this.idIndex.filter(function(id) {
            return !xo[id];
        });

        if (this.adaptiveBinaryIndices && adaptiveOverride) {
          this.adaptiveBinaryIndices = false;
          this.ensureAllIndexes(true);
          this.adaptiveBinaryIndices = true;
        }

        this.commit();

        // flag collection as dirty for autosave
        this.dirty = true;
      } 
      catch (err) {
        this.rollback();
        if (adaptiveOverride) {
          this.adaptiveBinaryIndices = true;
        }
        this.console.error(err.message);
        this.emit('error', err);
        return null;
      }      
    };

    /**
     *  Internal method called by remove()
     * @param {object[]|number[]} batch - array of documents or $loki ids to remove
     */
    Collection.prototype.removeBatch = function(batch) {
      var len = batch.length, 
        dlen=this.data.length, 
        idx;
      var xlt = {};
      var posx = [];
      
      // create lookup hashobject to translate $loki id to position
      for (idx=0; idx < dlen; idx++) {
        xlt[this.data[idx].$loki] = idx;
      }

      // iterate the batch
      for (idx=0; idx < len; idx++) {
        if (typeof(batch[idx]) === 'object') {
          posx.push(xlt[batch[idx].$loki]);
        }
        else {
          posx.push(xlt[batch[idx]]);
        }
      }

      this.removeBatchByPositions(posx);
    };

    /**
     * Remove a document from the collection
     * @param {object} doc - document to remove from collection
     * @memberof Collection
     */
    Collection.prototype.remove = function (doc) {
      if (typeof doc === 'number') {
        doc = this.get(doc);
      }

      if ('object' !== typeof doc) {
        throw new Error('Parameter is not an object');
      }
      if (Array.isArray(doc)) {
        this.removeBatch(doc);
        return;
      }

      if (!hasOwnProperty.call(doc, '$loki')) {
        throw new Error('Object is not a document stored in the collection');
      }

      try {
        this.startTransaction();
        var arr = this.get(doc.$loki, true),
          // obj = arr[0],
          position = arr[1];
        var self = this;
        Object.keys(this.constraints.unique).forEach(function (key) {
          if (doc[key] !== null && typeof doc[key] !== 'undefined') {
            self.constraints.unique[key].remove(doc[key]);
          }
        });
        // now that we can efficiently determine the data[] position of newly added document,
        // submit it for all registered DynamicViews to remove
        for (var idx = 0; idx < this.DynamicViews.length; idx++) {
          this.DynamicViews[idx].removeDocument(position);
        }

        if (this.adaptiveBinaryIndices) {
          // for each binary index defined in collection, immediately update rather than flag for lazy rebuild
          var key, bIndices = this.binaryIndices;
          for (key in bIndices) {
            this.adaptiveBinaryIndexRemove(position, key);
          }
        }
        else {
          this.flagBinaryIndexesDirty();
        }

        this.data.splice(position, 1);
        this.removeAutoUpdateObserver(doc);

        // remove id from idIndex
        this.idIndex.splice(position, 1);

        this.commit();
        this.dirty = true; // for autosave scenarios
        this.emit('delete', arr[0]);
        delete doc.$loki;
        delete doc.meta;
        return doc;

      } catch (err) {
        this.rollback();
        this.console.error(err.message);
        this.emit('error', err);
        return null;
      }
    };

    /*---------------------+
    | Finding methods     |
    +----------------------*/

    /**
     * Get by Id - faster than other methods because of the searching algorithm
     * @param {int} id - $loki id of document you want to retrieve
     * @param {boolean} returnPosition - if 'true' we will return [object, position]
     * @returns {(object|array|null)} Object reference if document was found, null if not,
     *     or an array if 'returnPosition' was passed.
     * @memberof Collection
     */
    Collection.prototype.get = function (id, returnPosition) {
      var retpos = returnPosition || false,
        data = this.idIndex,
        max = data.length - 1,
        min = 0,
        mid = (min + max) >> 1;

      id = typeof id === 'number' ? id : parseInt(id, 10);

      if (isNaN(id)) {
        throw new TypeError('Passed id is not an integer');
      }

      while (data[min] < data[max]) {
        mid = (min + max) >> 1;

        if (data[mid] < id) {
          min = mid + 1;
        } else {
          max = mid;
        }
      }

      if (max === min && data[min] === id) {
        if (retpos) {
          return [this.data[min], min];
        }
        return this.data[min];
      }
      return null;

    };

    /**
     * Perform binary range lookup for the data[dataPosition][binaryIndexName] property value
     *    Since multiple documents may contain the same value (which the index is sorted on),
     *    we hone in on range and then linear scan range to find exact index array position.
     * @param {int} dataPosition : coll.data array index/position
     * @param {string} binaryIndexName : index to search for dataPosition in
     */
    Collection.prototype.getBinaryIndexPosition = function(dataPosition, binaryIndexName) {
      var val = Utils.getIn(this.data[dataPosition], binaryIndexName, true);
      var index = this.binaryIndices[binaryIndexName].values;

      // i think calculateRange can probably be moved to collection
      // as it doesn't seem to need resultset.  need to verify
      var range = this.calculateRange("$eq", binaryIndexName, val);

      if (range[0] === 0 && range[1] === -1) {
        // uhoh didn't find range
        return null;
      }

      var min = range[0];
      var max = range[1];

      // narrow down the sub-segment of index values
      // where the indexed property value exactly matches our
      // value and then linear scan to find exact -index- position
      for(var idx = min; idx <= max; idx++) {
        if (index[idx] === dataPosition) return idx;
      }

      // uhoh
      return null;
    };

    /**
     * Adaptively insert a selected item to the index.
     * @param {int} dataPosition : coll.data array index/position
     * @param {string} binaryIndexName : index to search for dataPosition in
     */
    Collection.prototype.adaptiveBinaryIndexInsert = function(dataPosition, binaryIndexName) {
      var usingDotNotation = (binaryIndexName.indexOf('.') !== -1);
      var index = this.binaryIndices[binaryIndexName].values;
      var val = Utils.getIn(this.data[dataPosition], binaryIndexName, usingDotNotation);

      // If you are inserting a javascript Date value into a binary index, convert to epoch time
      if (this.serializableIndices === true && val instanceof Date) {
        this.data[dataPosition][binaryIndexName] = val.getTime();
        val = Utils.getIn(this.data[dataPosition], binaryIndexName);
      }

      var idxPos = (index.length === 0)?0:this.calculateRangeStart(binaryIndexName, val, true, usingDotNotation);

      // insert new data index into our binary index at the proper sorted location for relevant property calculated by idxPos.
      // doing this after adjusting dataPositions so no clash with previous item at that position.
      this.binaryIndices[binaryIndexName].values.splice(idxPos, 0, dataPosition);
    };

    /**
     * Adaptively update a selected item within an index.
     * @param {int} dataPosition : coll.data array index/position
     * @param {string} binaryIndexName : index to search for dataPosition in
     */
    Collection.prototype.adaptiveBinaryIndexUpdate = function(dataPosition, binaryIndexName) {
      // linear scan needed to find old position within index unless we optimize for clone scenarios later
      // within (my) node 5.6.0, the following for() loop with strict compare is -much- faster than indexOf()
      var idxPos,
        index = this.binaryIndices[binaryIndexName].values,
        len=index.length;

      for(idxPos=0; idxPos < len; idxPos++) {
        if (index[idxPos] === dataPosition) break;
      }

      //var idxPos = this.binaryIndices[binaryIndexName].values.indexOf(dataPosition);
      this.binaryIndices[binaryIndexName].values.splice(idxPos, 1);

      //this.adaptiveBinaryIndexRemove(dataPosition, binaryIndexName, true);
      this.adaptiveBinaryIndexInsert(dataPosition, binaryIndexName);
    };

    /**
     * Adaptively remove a selected item from the index.
     * @param {number|number[]} dataPosition : coll.data array index/position
     * @param {string} binaryIndexName : index to search for dataPosition in
     */
    Collection.prototype.adaptiveBinaryIndexRemove = function(dataPosition, binaryIndexName, removedFromIndexOnly) {
      var bi = this.binaryIndices[binaryIndexName];
      var len, idx, rmidx, rmlen, rxo = {};
      var curr, shift, idxPos;

      if (Array.isArray(dataPosition)) {
        // when called from chained remove, and only one document in array,
        // it will be faster to use old algorithm
        rmlen = dataPosition.length;
        if (rmlen === 1) {
          dataPosition = dataPosition[0];
        }
        // we were passed an array (batch) of documents so use this 'batch optimized' algorithm
        else {
          for(rmidx=0;rmidx<rmlen; rmidx++) {
            rxo[dataPosition[rmidx]] = true;
          }
    
          // remove document from index (with filter function)
          bi.values = bi.values.filter(function(di) { return !rxo[di]; });
    
          // if we passed this optional flag parameter, we are calling from adaptiveBinaryIndexUpdate,
          // in which case data positions stay the same.
          if (removedFromIndexOnly === true) {
            return;
          }
    
          var sortedPositions = dataPosition.slice();
          sortedPositions.sort(function (a, b) { return a-b; });
    
          // to remove holes, we need to 'shift down' the index's data array positions
          // we need to adjust array positions -1 for each index data positions greater than removed positions
          len = bi.values.length;
          for (idx=0; idx<len; idx++) {
            curr=bi.values[idx];
            shift=0;
            for(rmidx=0; rmidx<rmlen && curr > sortedPositions[rmidx]; rmidx++) {
                shift++;
            }
            bi.values[idx]-=shift;
          }

          // batch processed, bail out
          return;
        }

        // not a batch so continue...
      }

      idxPos = this.getBinaryIndexPosition(dataPosition, binaryIndexName);

      if (idxPos === null) {
        // throw new Error('unable to determine binary index position');
        return null;
      }

      // remove document from index (with splice)
      bi.values.splice(idxPos, 1);

      // if we passed this optional flag parameter, we are calling from adaptiveBinaryIndexUpdate,
      // in which case data positions stay the same.
      if (removedFromIndexOnly === true) {
        return;
      }

      // since index stores data array positions, if we remove a document
      // we need to adjust array positions -1 for all document positions greater than removed position
      len = bi.values.length;
      for (idx = 0; idx < len; idx++) {
        if (bi.values[idx] > dataPosition) {
          bi.values[idx]--;
        }
      }
    };

    /**
     * Internal method used for index maintenance and indexed searching.
     * Calculates the beginning of an index range for a given value.
     * For index maintainance (adaptive:true), we will return a valid index position to insert to.
     * For querying (adaptive:false/undefined), we will :
     *    return lower bound/index of range of that value (if found)
     *    return next lower index position if not found (hole)
     * If index is empty it is assumed to be handled at higher level, so
     * this method assumes there is at least 1 document in index.
     *
     * @param {string} prop - name of property which has binary index
     * @param {any} val - value to find within index
     * @param {bool?} adaptive - if true, we will return insert position
     */
    Collection.prototype.calculateRangeStart = function (prop, val, adaptive, usingDotNotation) {
      var rcd = this.data;
      var index = this.binaryIndices[prop].values;
      var min = 0;
      var max = index.length - 1;
      var mid = 0;

      if (index.length === 0) {
        return -1;
      }

      var minVal = Utils.getIn(rcd[index[min]], prop, usingDotNotation);
      var maxVal = Utils.getIn(rcd[index[max]], prop, usingDotNotation);

      // hone in on start position of value
      while (min < max) {
        mid = (min + max) >> 1;

        if (Comparators.lt(Utils.getIn(rcd[index[mid]], prop, usingDotNotation), val, false)) {
          min = mid + 1;
        } else {
          max = mid;
        }
      }

      var lbound = min;

      // found it... return it
      if (Comparators.aeq(val, Utils.getIn(rcd[index[lbound]], prop, usingDotNotation))) {
        return lbound;
      }

      // if not in index and our value is less than the found one
      if (Comparators.lt(val, Utils.getIn(rcd[index[lbound]], prop, usingDotNotation), false)) {
        return adaptive?lbound:lbound-1;
      }

      // not in index and our value is greater than the found one
      return adaptive?lbound+1:lbound;
    };

    /**
     * Internal method used for indexed $between.  Given a prop (index name), and a value
     * (which may or may not yet exist) this will find the final position of that upper range value.
     */
    Collection.prototype.calculateRangeEnd = function (prop, val, usingDotNotation) {
      var rcd = this.data;
      var index = this.binaryIndices[prop].values;
      var min = 0;
      var max = index.length - 1;
      var mid = 0;

      if (index.length === 0) {
        return -1;
      }

      var minVal = Utils.getIn(rcd[index[min]], prop, usingDotNotation);
      var maxVal = Utils.getIn(rcd[index[max]], prop, usingDotNotation);

      // hone in on start position of value
      while (min < max) {
        mid = (min + max) >> 1;

        if (Comparators.lt(val, Utils.getIn(rcd[index[mid]], prop, usingDotNotation), false)) {
          max = mid;
        } else {
          min = mid + 1;
        }
      }

      var ubound = max;

      // only eq if last element in array is our val
      if (Comparators.aeq(val, Utils.getIn(rcd[index[ubound]], prop, usingDotNotation))) {
        return ubound;
      }

       // if not in index and our value is less than the found one
      if (Comparators.gt(val, Utils.getIn(rcd[index[ubound]], prop, usingDotNotation), false)) {
        return ubound+1;
      }

      // either hole or first nonmatch
      if (Comparators.aeq(val, Utils.getIn(rcd[index[ubound-1]], prop, usingDotNotation))) {
        return ubound-1;
      }

      // hole, so ubound if nearest gt than the val we were looking for
      return ubound;
    };

    /**
     * calculateRange() - Binary Search utility method to find range/segment of values matching criteria.
     *    this is used for collection.find() and first find filter of resultset/dynview
     *    slightly different than get() binary search in that get() hones in on 1 value,
     *    but we have to hone in on many (range)
     * @param {string} op - operation, such as $eq
     * @param {string} prop - name of property to calculate range for
     * @param {object} val - value to use for range calculation.
     * @returns {array} [start, end] index array positions
     */
    Collection.prototype.calculateRange = function (op, prop, val) {
      var rcd = this.data;
      var index = this.binaryIndices[prop].values;
      var min = 0;
      var max = index.length - 1;
      var mid = 0;
      var lbound, lval;
      var ubound, uval;

      // when no documents are in collection, return empty range condition
      if (rcd.length === 0) {
        return [0, -1];
      }

      var usingDotNotation = (prop.indexOf('.') !== -1);

      var minVal = Utils.getIn(rcd[index[min]], prop, usingDotNotation);
      var maxVal = Utils.getIn(rcd[index[max]], prop, usingDotNotation);

      // if value falls outside of our range return [0, -1] to designate no results
      switch (op) {
      case '$eq':
      case '$aeq':
        if (Comparators.lt(val, minVal, false) || Comparators.gt(val, maxVal, false)) {
          return [0, -1];
        }
        break;
      case '$dteq':
        if (Comparators.lt(val, minVal, false) || Comparators.gt(val, maxVal, false)) {
          return [0, -1];
        }
        break;
      case '$gt':
        // none are within range
        if (Comparators.gt(val, maxVal, true)) {
          return [0, -1];
        }
        // all are within range
        if (Comparators.gt(minVal, val, false)) {
          return [min, max];
        }
        break;
      case '$gte':
        // none are within range
        if (Comparators.gt(val, maxVal, false)) {
          return [0, -1];
        }
        // all are within range
        if (Comparators.gt(minVal, val, true)) {
            return [min, max];
        }
        break;
      case '$lt':
        // none are within range
        if (Comparators.lt(val, minVal, true)) {
          return [0, -1];
        }
        // all are within range
        if (Comparators.lt(maxVal, val, false)) {
          return [min, max];
        }
        break;
      case '$lte':
        // none are within range
        if (Comparators.lt(val, minVal, false)) {
          return [0, -1];
        }
        // all are within range
        if (Comparators.lt(maxVal, val, true)) {
          return [min, max];
        }
        break;
      case '$between':
        // none are within range (low range is greater)
        if (Comparators.gt(val[0], maxVal, false)) {
          return [0, -1];
        }
        // none are within range (high range lower)
        if (Comparators.lt(val[1], minVal, false)) {
          return [0, -1];
        }

        lbound = this.calculateRangeStart(prop, val[0], false, usingDotNotation);
        ubound = this.calculateRangeEnd(prop, val[1], usingDotNotation);

        if (lbound < 0) lbound++;
        if (ubound > max) ubound--;

        if (!Comparators.gt(Utils.getIn(rcd[index[lbound]], prop, usingDotNotation), val[0], true)) lbound++;
        if (!Comparators.lt(Utils.getIn(rcd[index[ubound]], prop, usingDotNotation), val[1], true)) ubound--;

        if (ubound < lbound) return [0, -1];

        return ([lbound, ubound]);
      case '$in':
        var idxset = [],
          segResult = [];
        // query each value '$eq' operator and merge the seqment results.
        for (var j = 0, len = val.length; j < len; j++) {
            var seg = this.calculateRange('$eq', prop, val[j]);

            for (var i = seg[0]; i <= seg[1]; i++) {
                if (idxset[i] === undefined) {
                    idxset[i] = true;
                    segResult.push(i);
                }
            }
        }
        return segResult;
      }

      // determine lbound where needed
      switch (op) {
        case '$eq':
        case '$aeq':
        case '$dteq':
        case '$gte':
        case '$lt':
        lbound = this.calculateRangeStart(prop, val, false, usingDotNotation);
        lval = Utils.getIn(rcd[index[lbound]], prop, usingDotNotation);
          break;
        default: break;
      }

      // determine ubound where needed
      switch (op) {
        case '$eq':
        case '$aeq':
        case '$dteq':
        case '$lte':
        case '$gt':
          ubound = this.calculateRangeEnd(prop, val, usingDotNotation);
          uval = Utils.getIn(rcd[index[ubound]], prop, usingDotNotation);
          break;
        default: break;
      }


      switch (op) {
      case '$eq':
      case '$aeq':
      case '$dteq':
        // if hole (not found)
        if (!Comparators.aeq(lval, val)) {
          return [0, -1];
        }

        return [lbound, ubound];

      case '$gt':
        // if hole (not found) ub position is already greater
        if (!Comparators.aeq(Utils.getIn(rcd[index[ubound]], prop, usingDotNotation), val)) {
          return [ubound, max];
        }
        // otherwise (found) so ubound is still equal, get next
        return [ubound+1, max];

      case '$gte':
        // if hole (not found) lb position marks left outside of range
        if (!Comparators.aeq(Utils.getIn(rcd[index[lbound]], prop, usingDotNotation), val)) {
          return [lbound+1, max];
        }
        // otherwise (found) so lb is first position where its equal
        return [lbound, max];

      case '$lt':
        // if hole (not found) position already is less than
        if (!Comparators.aeq(Utils.getIn(rcd[index[lbound]], prop, usingDotNotation), val)) {
          return [min, lbound];
        }
        // otherwise (found) so lb marks left inside of eq range, get previous
        return [min, lbound-1];

      case '$lte':
        // if hole (not found) ub position marks right outside so get previous
        if (!Comparators.aeq(Utils.getIn(rcd[index[ubound]], prop, usingDotNotation), val)) {
          return [min, ubound-1];
        }
        // otherwise (found) so ub is last position where its still equal
        return [min, ubound];

      default:
        return [0, rcd.length - 1];
      }
    };

    /**
     * Retrieve doc by Unique index
     * @param {string} field - name of uniquely indexed property to use when doing lookup
     * @param {value} value - unique value to search for
     * @returns {object} document matching the value passed
     * @memberof Collection
     */
    Collection.prototype.by = function (field, value) {
      var self;
      if (value === undefined) {
        self = this;
        return function (value) {
          return self.by(field, value);
        };
      }

      var result = this.constraints.unique[field].get(value);
      if (!this.cloneObjects) {
        return result;
      } else {
        return clone(result, this.cloneMethod);
      }
    };

    /**
     * Find one object by index property, by property equal to value
     * @param {object} query - query object used to perform search with
     * @returns {(object|null)} First matching document, or null if none
     * @memberof Collection
     */
    Collection.prototype.findOne = function (query) {
      query = query || {};

      // Instantiate Resultset and exec find op passing firstOnly = true param
      var result = this.chain().find(query,true).data();

      if (Array.isArray(result) && result.length === 0) {
        return null;
      } else {
        if (!this.cloneObjects) {
          return result[0];
        } else {
          return clone(result[0], this.cloneMethod);
        }
      }
    };

    /**
     * Chain method, used for beginning a series of chained find() and/or view() operations
     * on a collection.
     *
     * @param {string|array=} transform - named transform or array of transform steps
     * @param {object=} parameters - Object containing properties representing parameters to substitute
     * @returns {Resultset} (this) resultset, or data array if any map or join functions where called
     * @memberof Collection
     */
    Collection.prototype.chain = function (transform, parameters) {
      var rs = new Resultset(this);

      if (typeof transform === 'undefined') {
        return rs;
      }

      return rs.transform(transform, parameters);
    };

    /**
     * Find method, api is similar to mongodb.
     * for more complex queries use [chain()]{@link Collection#chain} or [where()]{@link Collection#where}.
     * @example {@tutorial Query Examples}
     * @param {object} query - 'mongo-like' query object
     * @returns {array} Array of matching documents
     * @memberof Collection
     */
    Collection.prototype.find = function (query) {
      return this.chain().find(query).data();
    };

    /**
     * Find object by unindexed field by property equal to value,
     * simply iterates and returns the first element matching the query
     */
    Collection.prototype.findOneUnindexed = function (prop, value) {
      var i = this.data.length,
        doc;
      while (i--) {
        if (Utils.getIn(this.data[i], prop, true) === value) {
          doc = this.data[i];
          return doc;
        }
      }
      return null;
    };

    /**
     * Transaction methods
     */

    /** start the transation */
    Collection.prototype.startTransaction = function () {
      if (this.transactional) {
        this.cachedData = clone(this.data, this.cloneMethod);
        this.cachedIndex = this.idIndex;
        this.cachedBinaryIndex = this.binaryIndices;

        // propagate startTransaction to dynamic views
        for (var idx = 0; idx < this.DynamicViews.length; idx++) {
          this.DynamicViews[idx].startTransaction();
        }
      }
    };

    /** commit the transation */
    Collection.prototype.commit = function () {
      if (this.transactional) {
        this.cachedData = null;
        this.cachedIndex = null;
        this.cachedBinaryIndex = null;

        // propagate commit to dynamic views
        for (var idx = 0; idx < this.DynamicViews.length; idx++) {
          this.DynamicViews[idx].commit();
        }
      }
    };

    /** roll back the transation */
    Collection.prototype.rollback = function () {
      if (this.transactional) {
        if (this.cachedData !== null && this.cachedIndex !== null) {
          this.data = this.cachedData;
          this.idIndex = this.cachedIndex;
          this.binaryIndices = this.cachedBinaryIndex;
        }

        // propagate rollback to dynamic views
        for (var idx = 0; idx < this.DynamicViews.length; idx++) {
          this.DynamicViews[idx].rollback();
        }
      }
    };

    // async executor. This is only to enable callbacks at the end of the execution.
    Collection.prototype.async = function (fun, callback) {
      setTimeout(function () {
        if (typeof fun === 'function') {
          fun();
          callback();
        } else {
          throw new TypeError('Argument passed for async execution is not a function');
        }
      }, 0);
    };

    /**
     * Query the collection by supplying a javascript filter function.
     * @example
     * var results = coll.where(function(obj) {
     *   return obj.legs === 8;
     * });
     *
     * @param {function} fun - filter function to run against all collection docs
     * @returns {array} all documents which pass your filter function
     * @memberof Collection
     */
    Collection.prototype.where = function (fun) {
      return this.chain().where(fun).data();
    };

    /**
     * Map Reduce operation
     *
     * @param {function} mapFunction - function to use as map function
     * @param {function} reduceFunction - function to use as reduce function
     * @returns {data} The result of your mapReduce operation
     * @memberof Collection
     */
    Collection.prototype.mapReduce = function (mapFunction, reduceFunction) {
      try {
        return reduceFunction(this.data.map(mapFunction));
      } catch (err) {
        throw err;
      }
    };

    /**
     * Join two collections on specified properties
     *
     * @param {array|Resultset|Collection} joinData - array of documents to 'join' to this collection
     * @param {string} leftJoinProp - property name in collection
     * @param {string} rightJoinProp - property name in joinData
     * @param {function=} mapFun - (Optional) map function to use
     * @param {object=} dataOptions - options to data() before input to your map function
     * @param {bool} dataOptions.removeMeta - allows removing meta before calling mapFun
     * @param {boolean} dataOptions.forceClones - forcing the return of cloned objects to your map object
     * @param {string} dataOptions.forceCloneMethod - Allows overriding the default or collection specified cloning method.
     * @returns {Resultset} Result of the mapping operation
     * @memberof Collection
     */
    Collection.prototype.eqJoin = function (joinData, leftJoinProp, rightJoinProp, mapFun, dataOptions) {
      // logic in Resultset class
      return new Resultset(this).eqJoin(joinData, leftJoinProp, rightJoinProp, mapFun, dataOptions);
    };

    /* ------ STAGING API -------- */
    /**
     * stages: a map of uniquely identified 'stages', which hold copies of objects to be
     * manipulated without affecting the data in the original collection
     */
    Collection.prototype.stages = {};

    /**
     * (Staging API) create a stage and/or retrieve it
     * @memberof Collection
     */
    Collection.prototype.getStage = function (name) {
      if (!this.stages[name]) {
        this.stages[name] = {};
      }
      return this.stages[name];
    };
    /**
     * a collection of objects recording the changes applied through a commmitStage
     */
    Collection.prototype.commitLog = [];

    /**
     * (Staging API) create a copy of an object and insert it into a stage
     * @memberof Collection
     */
    Collection.prototype.stage = function (stageName, obj) {
      var copy = JSON.parse(JSON.stringify(obj));
      this.getStage(stageName)[obj.$loki] = copy;
      return copy;
    };

    /**
     * (Staging API) re-attach all objects to the original collection, so indexes and views can be rebuilt
     * then create a message to be inserted in the commitlog
     * @param {string} stageName - name of stage
     * @param {string} message
     * @memberof Collection
     */
    Collection.prototype.commitStage = function (stageName, message) {
      var stage = this.getStage(stageName),
        prop,
        timestamp = new Date().getTime();

      for (prop in stage) {

        this.update(stage[prop]);
        this.commitLog.push({
          timestamp: timestamp,
          message: message,
          data: JSON.parse(JSON.stringify(stage[prop]))
        });
      }
      this.stages[stageName] = {};
    };

    Collection.prototype.no_op = function () {
      return;
    };

    /**
     * @memberof Collection
     */
    Collection.prototype.extract = function (field) {
      var i = 0,
        len = this.data.length,
        isDotNotation = isDeepProperty(field),
        result = [];
      for (i; i < len; i += 1) {
        result.push(deepProperty(this.data[i], field, isDotNotation));
      }
      return result;
    };

    /**
     * @memberof Collection
     */
    Collection.prototype.max = function (field) {
      return Math.max.apply(null, this.extract(field));
    };

    /**
     * @memberof Collection
     */
    Collection.prototype.min = function (field) {
      return Math.min.apply(null, this.extract(field));
    };

    /**
     * @memberof Collection
     */
    Collection.prototype.maxRecord = function (field) {
      var i = 0,
        len = this.data.length,
        deep = isDeepProperty(field),
        result = {
          index: 0,
          value: undefined
        },
        max;

      for (i; i < len; i += 1) {
        if (max !== undefined) {
          if (max < deepProperty(this.data[i], field, deep)) {
            max = deepProperty(this.data[i], field, deep);
            result.index = this.data[i].$loki;
          }
        } else {
          max = deepProperty(this.data[i], field, deep);
          result.index = this.data[i].$loki;
        }
      }
      result.value = max;
      return result;
    };

    /**
     * @memberof Collection
     */
    Collection.prototype.minRecord = function (field) {
      var i = 0,
        len = this.data.length,
        deep = isDeepProperty(field),
        result = {
          index: 0,
          value: undefined
        },
        min;

      for (i; i < len; i += 1) {
        if (min !== undefined) {
          if (min > deepProperty(this.data[i], field, deep)) {
            min = deepProperty(this.data[i], field, deep);
            result.index = this.data[i].$loki;
          }
        } else {
          min = deepProperty(this.data[i], field, deep);
          result.index = this.data[i].$loki;
        }
      }
      result.value = min;
      return result;
    };

    /**
     * @memberof Collection
     */
    Collection.prototype.extractNumerical = function (field) {
      return this.extract(field).map(parseBase10).filter(Number).filter(function (n) {
        return !(isNaN(n));
      });
    };

    /**
     * Calculates the average numerical value of a property
     *
     * @param {string} field - name of property in docs to average
     * @returns {number} average of property in all docs in the collection
     * @memberof Collection
     */
    Collection.prototype.avg = function (field) {
      return average(this.extractNumerical(field));
    };

    /**
     * Calculate standard deviation of a field
     * @memberof Collection
     * @param {string} field
     */
    Collection.prototype.stdDev = function (field) {
      return standardDeviation(this.extractNumerical(field));
    };

    /**
     * @memberof Collection
     * @param {string} field
     */
    Collection.prototype.mode = function (field) {
      var dict = {},
        data = this.extract(field);
      data.forEach(function (obj) {
        if (dict[obj]) {
          dict[obj] += 1;
        } else {
          dict[obj] = 1;
        }
      });
      var max,
        prop, mode;
      for (prop in dict) {
        if (max) {
          if (max < dict[prop]) {
            mode = prop;
          }
        } else {
          mode = prop;
          max = dict[prop];
        }
      }
      return mode;
    };

    /**
     * @memberof Collection
     * @param {string} field - property name
     */
    Collection.prototype.median = function (field) {
      var values = this.extractNumerical(field);
      values.sort(sub);

      var half = Math.floor(values.length / 2);

      if (values.length % 2) {
        return values[half];
      } else {
        return (values[half - 1] + values[half]) / 2.0;
      }
    };

    /**
     * General utils, including statistical functions
     */
    function isDeepProperty(field) {
      return field.indexOf('.') !== -1;
    }

    function parseBase10(num) {
      return parseFloat(num, 10);
    }

    function isNotUndefined(obj) {
      return obj !== undefined;
    }

    function add(a, b) {
      return a + b;
    }

    function sub(a, b) {
      return a - b;
    }

    function median(values) {
      values.sort(sub);
      var half = Math.floor(values.length / 2);
      return (values.length % 2) ? values[half] : ((values[half - 1] + values[half]) / 2.0);
    }

    function average(array) {
      return (array.reduce(add, 0)) / array.length;
    }

    function standardDeviation(values) {
      var avg = average(values);
      var squareDiffs = values.map(function (value) {
        var diff = value - avg;
        var sqrDiff = diff * diff;
        return sqrDiff;
      });

      var avgSquareDiff = average(squareDiffs);

      var stdDev = Math.sqrt(avgSquareDiff);
      return stdDev;
    }

    function deepProperty(obj, property, isDeep) {
      if (isDeep === false) {
        // pass without processing
        return obj[property];
      }
      var pieces = property.split('.'),
        root = obj;
      while (pieces.length > 0) {
        root = root[pieces.shift()];
      }
      return root;
    }

    function binarySearch(array, item, fun) {
      var lo = 0,
        hi = array.length,
        compared,
        mid;
      while (lo < hi) {
        mid = (lo + hi) >> 1;
        compared = fun.apply(null, [item, array[mid]]);
        if (compared === 0) {
          return {
            found: true,
            index: mid
          };
        } else if (compared < 0) {
          hi = mid;
        } else {
          lo = mid + 1;
        }
      }
      return {
        found: false,
        index: hi
      };
    }

    function BSonSort(fun) {
      return function (array, item) {
        return binarySearch(array, item, fun);
      };
    }

    function KeyValueStore() {}

    KeyValueStore.prototype = {
      keys: [],
      values: [],
      sort: function (a, b) {
        return (a < b) ? -1 : ((a > b) ? 1 : 0);
      },
      setSort: function (fun) {
        this.bs = new BSonSort(fun);
      },
      bs: function () {
        return new BSonSort(this.sort);
      },
      set: function (key, value) {
        var pos = this.bs(this.keys, key);
        if (pos.found) {
          this.values[pos.index] = value;
        } else {
          this.keys.splice(pos.index, 0, key);
          this.values.splice(pos.index, 0, value);
        }
      },
      get: function (key) {
        return this.values[binarySearch(this.keys, key, this.sort).index];
      }
    };

    function UniqueIndex(uniqueField) {
      this.field = uniqueField;
      this.keyMap = {};
      this.lokiMap = {};
    }
    UniqueIndex.prototype.keyMap = {};
    UniqueIndex.prototype.lokiMap = {};
    UniqueIndex.prototype.set = function (obj) {
      var fieldValue = obj[this.field];
      if (fieldValue !== null && typeof (fieldValue) !== 'undefined') {
        if (this.keyMap[fieldValue]) {
          throw new Error('Duplicate key for property ' + this.field + ': ' + fieldValue);
        } else {
          this.keyMap[fieldValue] = obj;
          this.lokiMap[obj.$loki] = fieldValue;
        }
      }
    };
    UniqueIndex.prototype.get = function (key) {
      return this.keyMap[key];
    };

    UniqueIndex.prototype.byId = function (id) {
      return this.keyMap[this.lokiMap[id]];
    };
    /**
     * Updates a document's unique index given an updated object.
     * @param  {Object} obj Original document object
     * @param  {Object} doc New document object (likely the same as obj)
     */
    UniqueIndex.prototype.update = function (obj, doc) {
      if (this.lokiMap[obj.$loki] !== doc[this.field]) {
        var old = this.lokiMap[obj.$loki];
        this.set(doc);
        // make the old key fail bool test, while avoiding the use of delete (mem-leak prone)
        this.keyMap[old] = undefined;
      } else {
        this.keyMap[obj[this.field]] = doc;
      }
    };
    UniqueIndex.prototype.remove = function (key) {
      var obj = this.keyMap[key];
      if (obj !== null && typeof obj !== 'undefined') {
        this.keyMap[key] = undefined;
        this.lokiMap[obj.$loki] = undefined;
      } else {
        throw new Error('Key is not in unique index: ' + this.field);
      }
    };
    UniqueIndex.prototype.clear = function () {
      this.keyMap = {};
      this.lokiMap = {};
    };

    function ExactIndex(exactField) {
      this.index = {};
      this.field = exactField;
    }

    // add the value you want returned to the key in the index
    ExactIndex.prototype = {
      set: function add(key, val) {
        if (this.index[key]) {
          this.index[key].push(val);
        } else {
          this.index[key] = [val];
        }
      },

      // remove the value from the index, if the value was the last one, remove the key
      remove: function remove(key, val) {
        var idxSet = this.index[key];
        for (var i in idxSet) {
          if (idxSet[i] == val) {
            idxSet.splice(i, 1);
          }
        }
        if (idxSet.length < 1) {
          this.index[key] = undefined;
        }
      },

      // get the values related to the key, could be more than one
      get: function get(key) {
        return this.index[key];
      },

      // clear will zap the index
      clear: function clear(key) {
        this.index = {};
      }
    };

    function SortedIndex(sortedField) {
      this.field = sortedField;
    }

    SortedIndex.prototype = {
      keys: [],
      values: [],
      // set the default sort
      sort: function (a, b) {
        return (a < b) ? -1 : ((a > b) ? 1 : 0);
      },
      bs: function () {
        return new BSonSort(this.sort);
      },
      // and allow override of the default sort
      setSort: function (fun) {
        this.bs = new BSonSort(fun);
      },
      // add the value you want returned  to the key in the index
      set: function (key, value) {
        var pos = binarySearch(this.keys, key, this.sort);
        if (pos.found) {
          this.values[pos.index].push(value);
        } else {
          this.keys.splice(pos.index, 0, key);
          this.values.splice(pos.index, 0, [value]);
        }
      },
      // get all values which have a key == the given key
      get: function (key) {
        var bsr = binarySearch(this.keys, key, this.sort);
        if (bsr.found) {
          return this.values[bsr.index];
        } else {
          return [];
        }
      },
      // get all values which have a key < the given key
      getLt: function (key) {
        var bsr = binarySearch(this.keys, key, this.sort);
        var pos = bsr.index;
        if (bsr.found) pos--;
        return this.getAll(key, 0, pos);
      },
      // get all values which have a key > the given key
      getGt: function (key) {
        var bsr = binarySearch(this.keys, key, this.sort);
        var pos = bsr.index;
        if (bsr.found) pos++;
        return this.getAll(key, pos, this.keys.length);
      },

      // get all vals from start to end
      getAll: function (key, start, end) {
        var results = [];
        for (var i = start; i < end; i++) {
          results = results.concat(this.values[i]);
        }
        return results;
      },
      // just in case someone wants to do something smart with ranges
      getPos: function (key) {
        return binarySearch(this.keys, key, this.sort);
      },
      // remove the value from the index, if the value was the last one, remove the key
      remove: function (key, value) {
        var pos = binarySearch(this.keys, key, this.sort).index;
        var idxSet = this.values[pos];
        for (var i in idxSet) {
          if (idxSet[i] == value) idxSet.splice(i, 1);
        }
        if (idxSet.length < 1) {
          this.keys.splice(pos, 1);
          this.values.splice(pos, 1);
        }
      },
      // clear will zap the index
      clear: function () {
        this.keys = [];
        this.values = [];
      }
    };


    Loki.LokiOps = LokiOps;
    Loki.Collection = Collection;
    Loki.KeyValueStore = KeyValueStore;
    Loki.LokiMemoryAdapter = LokiMemoryAdapter;
    Loki.LokiPartitioningAdapter = LokiPartitioningAdapter;
    Loki.LokiLocalStorageAdapter = LokiLocalStorageAdapter;
    Loki.LokiFsAdapter = LokiFsAdapter;
    Loki.persistenceAdapters = {
      fs: LokiFsAdapter,
      localStorage: LokiLocalStorageAdapter
    };
    Loki.aeq = aeqHelper;
    Loki.lt = ltHelper;
    Loki.gt = gtHelper;
    Loki.Comparators = Comparators;
    return Loki;
  }());

}));

/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../webpack/buildin/global.js */ "./node_modules/webpack/buildin/global.js"), __webpack_require__(/*! ./../../process/browser.js */ "./node_modules/process/browser.js")))

/***/ }),

/***/ "./node_modules/node-libs-browser/mock/empty.js":
/*!******************************************************!*\
  !*** ./node_modules/node-libs-browser/mock/empty.js ***!
  \******************************************************/
/*! no static exports found */
/***/ (function(module, exports) {



/***/ }),

/***/ "./node_modules/node-libs-browser/node_modules/punycode/punycode.js":
/*!**************************************************************************!*\
  !*** ./node_modules/node-libs-browser/node_modules/punycode/punycode.js ***!
  \**************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(module, global) {var __WEBPACK_AMD_DEFINE_RESULT__;/*! https://mths.be/punycode v1.4.1 by @mathias */
;(function(root) {

	/** Detect free variables */
	var freeExports =  true && exports &&
		!exports.nodeType && exports;
	var freeModule =  true && module &&
		!module.nodeType && module;
	var freeGlobal = typeof global == 'object' && global;
	if (
		freeGlobal.global === freeGlobal ||
		freeGlobal.window === freeGlobal ||
		freeGlobal.self === freeGlobal
	) {
		root = freeGlobal;
	}

	/**
	 * The `punycode` object.
	 * @name punycode
	 * @type Object
	 */
	var punycode,

	/** Highest positive signed 32-bit float value */
	maxInt = 2147483647, // aka. 0x7FFFFFFF or 2^31-1

	/** Bootstring parameters */
	base = 36,
	tMin = 1,
	tMax = 26,
	skew = 38,
	damp = 700,
	initialBias = 72,
	initialN = 128, // 0x80
	delimiter = '-', // '\x2D'

	/** Regular expressions */
	regexPunycode = /^xn--/,
	regexNonASCII = /[^\x20-\x7E]/, // unprintable ASCII chars + non-ASCII chars
	regexSeparators = /[\x2E\u3002\uFF0E\uFF61]/g, // RFC 3490 separators

	/** Error messages */
	errors = {
		'overflow': 'Overflow: input needs wider integers to process',
		'not-basic': 'Illegal input >= 0x80 (not a basic code point)',
		'invalid-input': 'Invalid input'
	},

	/** Convenience shortcuts */
	baseMinusTMin = base - tMin,
	floor = Math.floor,
	stringFromCharCode = String.fromCharCode,

	/** Temporary variable */
	key;

	/*--------------------------------------------------------------------------*/

	/**
	 * A generic error utility function.
	 * @private
	 * @param {String} type The error type.
	 * @returns {Error} Throws a `RangeError` with the applicable error message.
	 */
	function error(type) {
		throw new RangeError(errors[type]);
	}

	/**
	 * A generic `Array#map` utility function.
	 * @private
	 * @param {Array} array The array to iterate over.
	 * @param {Function} callback The function that gets called for every array
	 * item.
	 * @returns {Array} A new array of values returned by the callback function.
	 */
	function map(array, fn) {
		var length = array.length;
		var result = [];
		while (length--) {
			result[length] = fn(array[length]);
		}
		return result;
	}

	/**
	 * A simple `Array#map`-like wrapper to work with domain name strings or email
	 * addresses.
	 * @private
	 * @param {String} domain The domain name or email address.
	 * @param {Function} callback The function that gets called for every
	 * character.
	 * @returns {Array} A new string of characters returned by the callback
	 * function.
	 */
	function mapDomain(string, fn) {
		var parts = string.split('@');
		var result = '';
		if (parts.length > 1) {
			// In email addresses, only the domain name should be punycoded. Leave
			// the local part (i.e. everything up to `@`) intact.
			result = parts[0] + '@';
			string = parts[1];
		}
		// Avoid `split(regex)` for IE8 compatibility. See #17.
		string = string.replace(regexSeparators, '\x2E');
		var labels = string.split('.');
		var encoded = map(labels, fn).join('.');
		return result + encoded;
	}

	/**
	 * Creates an array containing the numeric code points of each Unicode
	 * character in the string. While JavaScript uses UCS-2 internally,
	 * this function will convert a pair of surrogate halves (each of which
	 * UCS-2 exposes as separate characters) into a single code point,
	 * matching UTF-16.
	 * @see `punycode.ucs2.encode`
	 * @see <https://mathiasbynens.be/notes/javascript-encoding>
	 * @memberOf punycode.ucs2
	 * @name decode
	 * @param {String} string The Unicode input string (UCS-2).
	 * @returns {Array} The new array of code points.
	 */
	function ucs2decode(string) {
		var output = [],
		    counter = 0,
		    length = string.length,
		    value,
		    extra;
		while (counter < length) {
			value = string.charCodeAt(counter++);
			if (value >= 0xD800 && value <= 0xDBFF && counter < length) {
				// high surrogate, and there is a next character
				extra = string.charCodeAt(counter++);
				if ((extra & 0xFC00) == 0xDC00) { // low surrogate
					output.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);
				} else {
					// unmatched surrogate; only append this code unit, in case the next
					// code unit is the high surrogate of a surrogate pair
					output.push(value);
					counter--;
				}
			} else {
				output.push(value);
			}
		}
		return output;
	}

	/**
	 * Creates a string based on an array of numeric code points.
	 * @see `punycode.ucs2.decode`
	 * @memberOf punycode.ucs2
	 * @name encode
	 * @param {Array} codePoints The array of numeric code points.
	 * @returns {String} The new Unicode string (UCS-2).
	 */
	function ucs2encode(array) {
		return map(array, function(value) {
			var output = '';
			if (value > 0xFFFF) {
				value -= 0x10000;
				output += stringFromCharCode(value >>> 10 & 0x3FF | 0xD800);
				value = 0xDC00 | value & 0x3FF;
			}
			output += stringFromCharCode(value);
			return output;
		}).join('');
	}

	/**
	 * Converts a basic code point into a digit/integer.
	 * @see `digitToBasic()`
	 * @private
	 * @param {Number} codePoint The basic numeric code point value.
	 * @returns {Number} The numeric value of a basic code point (for use in
	 * representing integers) in the range `0` to `base - 1`, or `base` if
	 * the code point does not represent a value.
	 */
	function basicToDigit(codePoint) {
		if (codePoint - 48 < 10) {
			return codePoint - 22;
		}
		if (codePoint - 65 < 26) {
			return codePoint - 65;
		}
		if (codePoint - 97 < 26) {
			return codePoint - 97;
		}
		return base;
	}

	/**
	 * Converts a digit/integer into a basic code point.
	 * @see `basicToDigit()`
	 * @private
	 * @param {Number} digit The numeric value of a basic code point.
	 * @returns {Number} The basic code point whose value (when used for
	 * representing integers) is `digit`, which needs to be in the range
	 * `0` to `base - 1`. If `flag` is non-zero, the uppercase form is
	 * used; else, the lowercase form is used. The behavior is undefined
	 * if `flag` is non-zero and `digit` has no uppercase form.
	 */
	function digitToBasic(digit, flag) {
		//  0..25 map to ASCII a..z or A..Z
		// 26..35 map to ASCII 0..9
		return digit + 22 + 75 * (digit < 26) - ((flag != 0) << 5);
	}

	/**
	 * Bias adaptation function as per section 3.4 of RFC 3492.
	 * https://tools.ietf.org/html/rfc3492#section-3.4
	 * @private
	 */
	function adapt(delta, numPoints, firstTime) {
		var k = 0;
		delta = firstTime ? floor(delta / damp) : delta >> 1;
		delta += floor(delta / numPoints);
		for (/* no initialization */; delta > baseMinusTMin * tMax >> 1; k += base) {
			delta = floor(delta / baseMinusTMin);
		}
		return floor(k + (baseMinusTMin + 1) * delta / (delta + skew));
	}

	/**
	 * Converts a Punycode string of ASCII-only symbols to a string of Unicode
	 * symbols.
	 * @memberOf punycode
	 * @param {String} input The Punycode string of ASCII-only symbols.
	 * @returns {String} The resulting string of Unicode symbols.
	 */
	function decode(input) {
		// Don't use UCS-2
		var output = [],
		    inputLength = input.length,
		    out,
		    i = 0,
		    n = initialN,
		    bias = initialBias,
		    basic,
		    j,
		    index,
		    oldi,
		    w,
		    k,
		    digit,
		    t,
		    /** Cached calculation results */
		    baseMinusT;

		// Handle the basic code points: let `basic` be the number of input code
		// points before the last delimiter, or `0` if there is none, then copy
		// the first basic code points to the output.

		basic = input.lastIndexOf(delimiter);
		if (basic < 0) {
			basic = 0;
		}

		for (j = 0; j < basic; ++j) {
			// if it's not a basic code point
			if (input.charCodeAt(j) >= 0x80) {
				error('not-basic');
			}
			output.push(input.charCodeAt(j));
		}

		// Main decoding loop: start just after the last delimiter if any basic code
		// points were copied; start at the beginning otherwise.

		for (index = basic > 0 ? basic + 1 : 0; index < inputLength; /* no final expression */) {

			// `index` is the index of the next character to be consumed.
			// Decode a generalized variable-length integer into `delta`,
			// which gets added to `i`. The overflow checking is easier
			// if we increase `i` as we go, then subtract off its starting
			// value at the end to obtain `delta`.
			for (oldi = i, w = 1, k = base; /* no condition */; k += base) {

				if (index >= inputLength) {
					error('invalid-input');
				}

				digit = basicToDigit(input.charCodeAt(index++));

				if (digit >= base || digit > floor((maxInt - i) / w)) {
					error('overflow');
				}

				i += digit * w;
				t = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);

				if (digit < t) {
					break;
				}

				baseMinusT = base - t;
				if (w > floor(maxInt / baseMinusT)) {
					error('overflow');
				}

				w *= baseMinusT;

			}

			out = output.length + 1;
			bias = adapt(i - oldi, out, oldi == 0);

			// `i` was supposed to wrap around from `out` to `0`,
			// incrementing `n` each time, so we'll fix that now:
			if (floor(i / out) > maxInt - n) {
				error('overflow');
			}

			n += floor(i / out);
			i %= out;

			// Insert `n` at position `i` of the output
			output.splice(i++, 0, n);

		}

		return ucs2encode(output);
	}

	/**
	 * Converts a string of Unicode symbols (e.g. a domain name label) to a
	 * Punycode string of ASCII-only symbols.
	 * @memberOf punycode
	 * @param {String} input The string of Unicode symbols.
	 * @returns {String} The resulting Punycode string of ASCII-only symbols.
	 */
	function encode(input) {
		var n,
		    delta,
		    handledCPCount,
		    basicLength,
		    bias,
		    j,
		    m,
		    q,
		    k,
		    t,
		    currentValue,
		    output = [],
		    /** `inputLength` will hold the number of code points in `input`. */
		    inputLength,
		    /** Cached calculation results */
		    handledCPCountPlusOne,
		    baseMinusT,
		    qMinusT;

		// Convert the input in UCS-2 to Unicode
		input = ucs2decode(input);

		// Cache the length
		inputLength = input.length;

		// Initialize the state
		n = initialN;
		delta = 0;
		bias = initialBias;

		// Handle the basic code points
		for (j = 0; j < inputLength; ++j) {
			currentValue = input[j];
			if (currentValue < 0x80) {
				output.push(stringFromCharCode(currentValue));
			}
		}

		handledCPCount = basicLength = output.length;

		// `handledCPCount` is the number of code points that have been handled;
		// `basicLength` is the number of basic code points.

		// Finish the basic string - if it is not empty - with a delimiter
		if (basicLength) {
			output.push(delimiter);
		}

		// Main encoding loop:
		while (handledCPCount < inputLength) {

			// All non-basic code points < n have been handled already. Find the next
			// larger one:
			for (m = maxInt, j = 0; j < inputLength; ++j) {
				currentValue = input[j];
				if (currentValue >= n && currentValue < m) {
					m = currentValue;
				}
			}

			// Increase `delta` enough to advance the decoder's <n,i> state to <m,0>,
			// but guard against overflow
			handledCPCountPlusOne = handledCPCount + 1;
			if (m - n > floor((maxInt - delta) / handledCPCountPlusOne)) {
				error('overflow');
			}

			delta += (m - n) * handledCPCountPlusOne;
			n = m;

			for (j = 0; j < inputLength; ++j) {
				currentValue = input[j];

				if (currentValue < n && ++delta > maxInt) {
					error('overflow');
				}

				if (currentValue == n) {
					// Represent delta as a generalized variable-length integer
					for (q = delta, k = base; /* no condition */; k += base) {
						t = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);
						if (q < t) {
							break;
						}
						qMinusT = q - t;
						baseMinusT = base - t;
						output.push(
							stringFromCharCode(digitToBasic(t + qMinusT % baseMinusT, 0))
						);
						q = floor(qMinusT / baseMinusT);
					}

					output.push(stringFromCharCode(digitToBasic(q, 0)));
					bias = adapt(delta, handledCPCountPlusOne, handledCPCount == basicLength);
					delta = 0;
					++handledCPCount;
				}
			}

			++delta;
			++n;

		}
		return output.join('');
	}

	/**
	 * Converts a Punycode string representing a domain name or an email address
	 * to Unicode. Only the Punycoded parts of the input will be converted, i.e.
	 * it doesn't matter if you call it on a string that has already been
	 * converted to Unicode.
	 * @memberOf punycode
	 * @param {String} input The Punycoded domain name or email address to
	 * convert to Unicode.
	 * @returns {String} The Unicode representation of the given Punycode
	 * string.
	 */
	function toUnicode(input) {
		return mapDomain(input, function(string) {
			return regexPunycode.test(string)
				? decode(string.slice(4).toLowerCase())
				: string;
		});
	}

	/**
	 * Converts a Unicode string representing a domain name or an email address to
	 * Punycode. Only the non-ASCII parts of the domain name will be converted,
	 * i.e. it doesn't matter if you call it with a domain that's already in
	 * ASCII.
	 * @memberOf punycode
	 * @param {String} input The domain name or email address to convert, as a
	 * Unicode string.
	 * @returns {String} The Punycode representation of the given domain name or
	 * email address.
	 */
	function toASCII(input) {
		return mapDomain(input, function(string) {
			return regexNonASCII.test(string)
				? 'xn--' + encode(string)
				: string;
		});
	}

	/*--------------------------------------------------------------------------*/

	/** Define the public API */
	punycode = {
		/**
		 * A string representing the current Punycode.js version number.
		 * @memberOf punycode
		 * @type String
		 */
		'version': '1.4.1',
		/**
		 * An object of methods to convert from JavaScript's internal character
		 * representation (UCS-2) to Unicode code points, and back.
		 * @see <https://mathiasbynens.be/notes/javascript-encoding>
		 * @memberOf punycode
		 * @type Object
		 */
		'ucs2': {
			'decode': ucs2decode,
			'encode': ucs2encode
		},
		'decode': decode,
		'encode': encode,
		'toASCII': toASCII,
		'toUnicode': toUnicode
	};

	/** Expose `punycode` */
	// Some AMD build optimizers, like r.js, check for specific condition patterns
	// like the following:
	if (
		true
	) {
		!(__WEBPACK_AMD_DEFINE_RESULT__ = (function() {
			return punycode;
		}).call(exports, __webpack_require__, exports, module),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
	} else {}

}(this));

/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../../webpack/buildin/module.js */ "./node_modules/webpack/buildin/module.js")(module), __webpack_require__(/*! ./../../../webpack/buildin/global.js */ "./node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "./node_modules/p-queue/index.js":
/*!***************************************!*\
  !*** ./node_modules/p-queue/index.js ***!
  \***************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


// Port of lower_bound from http://en.cppreference.com/w/cpp/algorithm/lower_bound
// Used to compute insertion index to keep queue sorted after insertion
function lowerBound(array, value, comp) {
	let first = 0;
	let count = array.length;

	while (count > 0) {
		const step = (count / 2) | 0;
		let it = first + step;

		if (comp(array[it], value) <= 0) {
			first = ++it;
			count -= step + 1;
		} else {
			count = step;
		}
	}

	return first;
}

class PriorityQueue {
	constructor() {
		this._queue = [];
	}

	enqueue(run, options) {
		options = Object.assign({
			priority: 0
		}, options);

		const element = {priority: options.priority, run};

		if (this.size && this._queue[this.size - 1].priority >= options.priority) {
			this._queue.push(element);
			return;
		}

		const index = lowerBound(this._queue, element, (a, b) => b.priority - a.priority);
		this._queue.splice(index, 0, element);
	}

	dequeue() {
		return this._queue.shift().run;
	}

	get size() {
		return this._queue.length;
	}
}

class PQueue {
	constructor(options) {
		options = Object.assign({
			carryoverConcurrencyCount: false,
			intervalCap: Infinity,
			interval: 0,
			concurrency: Infinity,
			autoStart: true,
			queueClass: PriorityQueue
		}, options);

		if (!(typeof options.concurrency === 'number' && options.concurrency >= 1)) {
			throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${options.concurrency}\` (${typeof options.concurrency})`);
		}

		if (!(typeof options.intervalCap === 'number' && options.intervalCap >= 1)) {
			throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${options.intervalCap}\` (${typeof options.intervalCap})`);
		}

		if (!(typeof options.interval === 'number' && Number.isFinite(options.interval) && options.interval >= 0)) {
			throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${options.interval}\` (${typeof options.interval})`);
		}

		this._carryoverConcurrencyCount = options.carryoverConcurrencyCount;
		this._isIntervalIgnored = options.intervalCap === Infinity || options.interval === 0;
		this._intervalCount = 0;
		this._intervalCap = options.intervalCap;
		this._interval = options.interval;
		this._intervalId = null;
		this._intervalEnd = 0;
		this._timeoutId = null;

		this.queue = new options.queueClass(); // eslint-disable-line new-cap
		this._queueClass = options.queueClass;
		this._pendingCount = 0;
		this._concurrency = options.concurrency;
		this._isPaused = options.autoStart === false;
		this._resolveEmpty = () => {};
		this._resolveIdle = () => {};
	}

	get _doesIntervalAllowAnother() {
		return this._isIntervalIgnored || this._intervalCount < this._intervalCap;
	}

	get _doesConcurrentAllowAnother() {
		return this._pendingCount < this._concurrency;
	}

	_next() {
		this._pendingCount--;
		this._tryToStartAnother();
	}

	_resolvePromises() {
		this._resolveEmpty();
		this._resolveEmpty = () => {};

		if (this._pendingCount === 0) {
			this._resolveIdle();
			this._resolveIdle = () => {};
		}
	}

	_onResumeInterval() {
		this._onInterval();
		this._initializeIntervalIfNeeded();
		this._timeoutId = null;
	}

	_intervalPaused() {
		const now = Date.now();

		if (this._intervalId === null) {
			const delay = this._intervalEnd - now;
			if (delay < 0) {
				// Act as the interval was done
				// We don't need to resume it here,
				// because it'll be resumed on line 160
				this._intervalCount = (this._carryoverConcurrencyCount) ? this._pendingCount : 0;
			} else {
				// Act as the interval is pending
				if (this._timeoutId === null) {
					this._timeoutId = setTimeout(() => this._onResumeInterval(), delay);
				}

				return true;
			}
		}

		return false;
	}

	_tryToStartAnother() {
		if (this.queue.size === 0) {
			// We can clear the interval ("pause")
			// because we can redo it later ("resume")
			clearInterval(this._intervalId);
			this._intervalId = null;

			this._resolvePromises();

			return false;
		}

		if (!this._isPaused) {
			const canInitializeInterval = !this._intervalPaused();
			if (this._doesIntervalAllowAnother && this._doesConcurrentAllowAnother) {
				this.queue.dequeue()();
				if (canInitializeInterval) {
					this._initializeIntervalIfNeeded();
				}

				return true;
			}
		}

		return false;
	}

	_initializeIntervalIfNeeded() {
		if (this._isIntervalIgnored || this._intervalId !== null) {
			return;
		}

		this._intervalId = setInterval(() => this._onInterval(), this._interval);
		this._intervalEnd = Date.now() + this._interval;
	}

	_onInterval() {
		if (this._intervalCount === 0 && this._pendingCount === 0) {
			clearInterval(this._intervalId);
			this._intervalId = null;
		}

		this._intervalCount = (this._carryoverConcurrencyCount) ? this._pendingCount : 0;
		while (this._tryToStartAnother()) {} // eslint-disable-line no-empty
	}

	add(fn, options) {
		return new Promise((resolve, reject) => {
			const run = () => {
				this._pendingCount++;
				this._intervalCount++;

				try {
					Promise.resolve(fn()).then(
						val => {
							resolve(val);
							this._next();
						},
						err => {
							reject(err);
							this._next();
						}
					);
				} catch (err) {
					reject(err);
					this._next();
				}
			};

			this.queue.enqueue(run, options);
			this._tryToStartAnother();
		});
	}

	addAll(fns, options) {
		return Promise.all(fns.map(fn => this.add(fn, options)));
	}

	start() {
		if (!this._isPaused) {
			return;
		}

		this._isPaused = false;
		while (this._tryToStartAnother()) {} // eslint-disable-line no-empty
	}

	pause() {
		this._isPaused = true;
	}

	clear() {
		this.queue = new this._queueClass(); // eslint-disable-line new-cap
	}

	onEmpty() {
		// Instantly resolve if the queue is empty
		if (this.queue.size === 0) {
			return Promise.resolve();
		}

		return new Promise(resolve => {
			const existingResolve = this._resolveEmpty;
			this._resolveEmpty = () => {
				existingResolve();
				resolve();
			};
		});
	}

	onIdle() {
		// Instantly resolve if none pending and if nothing else is queued
		if (this._pendingCount === 0 && this.queue.size === 0) {
			return Promise.resolve();
		}

		return new Promise(resolve => {
			const existingResolve = this._resolveIdle;
			this._resolveIdle = () => {
				existingResolve();
				resolve();
			};
		});
	}

	get size() {
		return this.queue.size;
	}

	get pending() {
		return this._pendingCount;
	}

	get isPaused() {
		return this._isPaused;
	}
}

module.exports = PQueue;


/***/ }),

/***/ "./node_modules/process/browser.js":
/*!*****************************************!*\
  !*** ./node_modules/process/browser.js ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports) {

// shim for using process in browser
var process = module.exports = {};

// cached from whatever global is present so that test runners that stub it
// don't break things.  But we need to wrap it in a try catch in case it is
// wrapped in strict mode code which doesn't define any globals.  It's inside a
// function because try/catches deoptimize in certain engines.

var cachedSetTimeout;
var cachedClearTimeout;

function defaultSetTimout() {
    throw new Error('setTimeout has not been defined');
}
function defaultClearTimeout () {
    throw new Error('clearTimeout has not been defined');
}
(function () {
    try {
        if (typeof setTimeout === 'function') {
            cachedSetTimeout = setTimeout;
        } else {
            cachedSetTimeout = defaultSetTimout;
        }
    } catch (e) {
        cachedSetTimeout = defaultSetTimout;
    }
    try {
        if (typeof clearTimeout === 'function') {
            cachedClearTimeout = clearTimeout;
        } else {
            cachedClearTimeout = defaultClearTimeout;
        }
    } catch (e) {
        cachedClearTimeout = defaultClearTimeout;
    }
} ())
function runTimeout(fun) {
    if (cachedSetTimeout === setTimeout) {
        //normal enviroments in sane situations
        return setTimeout(fun, 0);
    }
    // if setTimeout wasn't available but was latter defined
    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {
        cachedSetTimeout = setTimeout;
        return setTimeout(fun, 0);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedSetTimeout(fun, 0);
    } catch(e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally
            return cachedSetTimeout.call(null, fun, 0);
        } catch(e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error
            return cachedSetTimeout.call(this, fun, 0);
        }
    }


}
function runClearTimeout(marker) {
    if (cachedClearTimeout === clearTimeout) {
        //normal enviroments in sane situations
        return clearTimeout(marker);
    }
    // if clearTimeout wasn't available but was latter defined
    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {
        cachedClearTimeout = clearTimeout;
        return clearTimeout(marker);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedClearTimeout(marker);
    } catch (e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally
            return cachedClearTimeout.call(null, marker);
        } catch (e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.
            // Some versions of I.E. have different rules for clearTimeout vs setTimeout
            return cachedClearTimeout.call(this, marker);
        }
    }



}
var queue = [];
var draining = false;
var currentQueue;
var queueIndex = -1;

function cleanUpNextTick() {
    if (!draining || !currentQueue) {
        return;
    }
    draining = false;
    if (currentQueue.length) {
        queue = currentQueue.concat(queue);
    } else {
        queueIndex = -1;
    }
    if (queue.length) {
        drainQueue();
    }
}

function drainQueue() {
    if (draining) {
        return;
    }
    var timeout = runTimeout(cleanUpNextTick);
    draining = true;

    var len = queue.length;
    while(len) {
        currentQueue = queue;
        queue = [];
        while (++queueIndex < len) {
            if (currentQueue) {
                currentQueue[queueIndex].run();
            }
        }
        queueIndex = -1;
        len = queue.length;
    }
    currentQueue = null;
    draining = false;
    runClearTimeout(timeout);
}

process.nextTick = function (fun) {
    var args = new Array(arguments.length - 1);
    if (arguments.length > 1) {
        for (var i = 1; i < arguments.length; i++) {
            args[i - 1] = arguments[i];
        }
    }
    queue.push(new Item(fun, args));
    if (queue.length === 1 && !draining) {
        runTimeout(drainQueue);
    }
};

// v8 likes predictible objects
function Item(fun, array) {
    this.fun = fun;
    this.array = array;
}
Item.prototype.run = function () {
    this.fun.apply(null, this.array);
};
process.title = 'browser';
process.browser = true;
process.env = {};
process.argv = [];
process.version = ''; // empty string to avoid regexp issues
process.versions = {};

function noop() {}

process.on = noop;
process.addListener = noop;
process.once = noop;
process.off = noop;
process.removeListener = noop;
process.removeAllListeners = noop;
process.emit = noop;
process.prependListener = noop;
process.prependOnceListener = noop;

process.listeners = function (name) { return [] }

process.binding = function (name) {
    throw new Error('process.binding is not supported');
};

process.cwd = function () { return '/' };
process.chdir = function (dir) {
    throw new Error('process.chdir is not supported');
};
process.umask = function() { return 0; };


/***/ }),

/***/ "./node_modules/pubnub/dist/web/pubnub.min.js":
/*!****************************************************!*\
  !*** ./node_modules/pubnub/dist/web/pubnub.min.js ***!
  \****************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

!function(e,t){ true?module.exports=t():undefined}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){if(!navigator||!navigator.sendBeacon)return!1;navigator.sendBeacon(e)}Object.defineProperty(t,"__esModule",{value:!0});var u=n(1),c=r(u),l=n(39),h=r(l),f=n(40),p=r(f),d=n(41),y=(n(5),function(e){function t(e){i(this,t);var n=e.listenToBrowserNetworkEvents,r=void 0===n||n;e.db=p.default,e.sdkFamily="Web",e.networking=new h.default({del:d.del,get:d.get,post:d.post,sendBeacon:a});var o=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r&&(window.addEventListener("offline",function(){o.networkDownDetected()}),window.addEventListener("online",function(){o.networkUpDetected()})),o}return o(t,e),t}(c.default));t.default=y,e.exports=t.default},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(2),u=i(a),c=n(6),l=i(c),h=n(8),f=i(h),p=n(9),d=i(p),y=n(16),g=i(y),b=n(17),_=r(b),v=n(18),m=r(v),k=n(19),P=r(k),O=n(20),w=r(O),T=n(21),S=r(T),C=n(22),M=r(C),E=n(23),x=r(E),N=n(24),R=r(N),A=n(25),D=r(A),K=n(26),j=r(K),G=n(27),U=r(G),I=n(28),H=r(I),B=n(29),L=r(B),q=n(30),F=r(q),z=n(31),X=r(z),W=n(32),J=r(W),V=n(33),$=r(V),Q=n(34),Y=r(Q),Z=n(35),ee=r(Z),te=n(36),ne=r(te),re=n(37),ie=r(re),se=n(12),oe=r(se),ae=n(38),ue=r(ae),ce=n(13),le=i(ce),he=n(10),fe=i(he),pe=(n(5),n(3)),de=i(pe),ye=function(){function e(t){var n=this;s(this,e);var r=t.db,i=t.networking,o=this._config=new u.default({setup:t,db:r}),a=new l.default({config:o});i.init(o);var c={config:o,networking:i,crypto:a},h=g.default.bind(this,c,oe),p=g.default.bind(this,c,j),y=g.default.bind(this,c,H),b=g.default.bind(this,c,F),v=g.default.bind(this,c,ue),k=this._listenerManager=new d.default,O=new f.default({timeEndpoint:h,leaveEndpoint:p,heartbeatEndpoint:y,setStateEndpoint:b,subscribeEndpoint:v,crypto:c.crypto,config:c.config,listenerManager:k});this.addListener=k.addListener.bind(k),this.removeListener=k.removeListener.bind(k),this.removeAllListeners=k.removeAllListeners.bind(k),this.channelGroups={listGroups:g.default.bind(this,c,w),listChannels:g.default.bind(this,c,S),addChannels:g.default.bind(this,c,_),removeChannels:g.default.bind(this,c,m),deleteGroup:g.default.bind(this,c,P)},this.push={addChannels:g.default.bind(this,c,M),removeChannels:g.default.bind(this,c,x),deleteDevice:g.default.bind(this,c,D),listChannels:g.default.bind(this,c,R)},this.hereNow=g.default.bind(this,c,X),this.whereNow=g.default.bind(this,c,U),this.getState=g.default.bind(this,c,L),this.setState=O.adaptStateChange.bind(O),this.grant=g.default.bind(this,c,$),this.audit=g.default.bind(this,c,J),this.publish=g.default.bind(this,c,Y),this.fire=function(e,t){return e.replicate=!1,e.storeInHistory=!1,n.publish(e,t)},this.history=g.default.bind(this,c,ee),this.deleteMessages=g.default.bind(this,c,ne),this.fetchMessages=g.default.bind(this,c,ie),this.time=h,this.subscribe=O.adaptSubscribeChange.bind(O),this.presence=O.adaptPresenceChange.bind(O),this.unsubscribe=O.adaptUnsubscribeChange.bind(O),this.disconnect=O.disconnect.bind(O),this.reconnect=O.reconnect.bind(O),this.destroy=function(e){O.unsubscribeAll(e),O.disconnect()},this.stop=this.destroy,this.unsubscribeAll=O.unsubscribeAll.bind(O),this.getSubscribedChannels=O.getSubscribedChannels.bind(O),this.getSubscribedChannelGroups=O.getSubscribedChannelGroups.bind(O),this.encrypt=a.encrypt.bind(a),this.decrypt=a.decrypt.bind(a),this.getAuthKey=c.config.getAuthKey.bind(c.config),this.setAuthKey=c.config.setAuthKey.bind(c.config),this.setCipherKey=c.config.setCipherKey.bind(c.config),this.getUUID=c.config.getUUID.bind(c.config),this.setUUID=c.config.setUUID.bind(c.config),this.getFilterExpression=c.config.getFilterExpression.bind(c.config),this.setFilterExpression=c.config.setFilterExpression.bind(c.config),this.setHeartbeatInterval=c.config.setHeartbeatInterval.bind(c.config),i.hasModule("proxy")&&(this.setProxy=function(e){c.config.setProxy(e),n.reconnect()})}return o(e,[{key:"getVersion",value:function(){return this._config.getVersion()}},{key:"networkDownDetected",value:function(){this._listenerManager.announceNetworkDown(),this._config.restore?this.disconnect():this.destroy(!0)}},{key:"networkUpDetected",value:function(){this._listenerManager.announceNetworkUp(),this.reconnect()}}],[{key:"generateUUID",value:function(){return de.default.createUUID()}}]),e}();ye.OPERATIONS=le.default,ye.CATEGORIES=fe.default,t.default=ye,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(3),o=function(e){return e&&e.__esModule?e:{default:e}}(s),a=(n(5),function(){function e(t){var n=t.setup,i=t.db;r(this,e),this._db=i,this.instanceId="pn-"+o.default.createUUID(),this.secretKey=n.secretKey||n.secret_key,this.subscribeKey=n.subscribeKey||n.subscribe_key,this.publishKey=n.publishKey||n.publish_key,this.sdkName=n.sdkName,this.sdkFamily=n.sdkFamily,this.partnerId=n.partnerId,this.setAuthKey(n.authKey),this.setCipherKey(n.cipherKey),this.setFilterExpression(n.filterExpression),this.origin=n.origin||"pubsub.pndsn.com",this.secure=n.ssl||!1,this.restore=n.restore||!1,this.proxy=n.proxy,this.keepAlive=n.keepAlive,this.keepAliveSettings=n.keepAliveSettings,this.autoNetworkDetection=n.autoNetworkDetection||!1,this.dedupeOnSubscribe=n.dedupeOnSubscribe||!1,this.maximumCacheSize=n.maximumCacheSize||100,this.customEncrypt=n.customEncrypt,this.customDecrypt=n.customDecrypt,"undefined"!=typeof location&&"https:"===location.protocol&&(this.secure=!0),this.logVerbosity=n.logVerbosity||!1,this.suppressLeaveEvents=n.suppressLeaveEvents||!1,this.announceFailedHeartbeats=n.announceFailedHeartbeats||!0,this.announceSuccessfulHeartbeats=n.announceSuccessfulHeartbeats||!1,this.useInstanceId=n.useInstanceId||!1,this.useRequestId=n.useRequestId||!1,this.requestMessageCountThreshold=n.requestMessageCountThreshold,this.setTransactionTimeout(n.transactionalRequestTimeout||15e3),this.setSubscribeTimeout(n.subscribeRequestTimeout||31e4),this.setSendBeaconConfig(n.useSendBeacon||!0),this.setPresenceTimeout(n.presenceTimeout||300),null!=n.heartbeatInterval&&this.setHeartbeatInterval(n.heartbeatInterval),this.setUUID(this._decideUUID(n.uuid))}return i(e,[{key:"getAuthKey",value:function(){return this.authKey}},{key:"setAuthKey",value:function(e){return this.authKey=e,this}},{key:"setCipherKey",value:function(e){return this.cipherKey=e,this}},{key:"getUUID",value:function(){return this.UUID}},{key:"setUUID",value:function(e){return this._db&&this._db.set&&this._db.set(this.subscribeKey+"uuid",e),this.UUID=e,this}},{key:"getFilterExpression",value:function(){return this.filterExpression}},{key:"setFilterExpression",value:function(e){return this.filterExpression=e,this}},{key:"getPresenceTimeout",value:function(){return this._presenceTimeout}},{key:"setPresenceTimeout",value:function(e){return this._presenceTimeout=e,this.setHeartbeatInterval(this._presenceTimeout/2-1),this}},{key:"setProxy",value:function(e){this.proxy=e}},{key:"getHeartbeatInterval",value:function(){return this._heartbeatInterval}},{key:"setHeartbeatInterval",value:function(e){return this._heartbeatInterval=e,this}},{key:"getSubscribeTimeout",value:function(){return this._subscribeRequestTimeout}},{key:"setSubscribeTimeout",value:function(e){return this._subscribeRequestTimeout=e,this}},{key:"getTransactionTimeout",value:function(){return this._transactionalRequestTimeout}},{key:"setTransactionTimeout",value:function(e){return this._transactionalRequestTimeout=e,this}},{key:"isSendBeaconEnabled",value:function(){return this._useSendBeacon}},{key:"setSendBeaconConfig",value:function(e){return this._useSendBeacon=e,this}},{key:"getVersion",value:function(){return"4.21.6"}},{key:"_decideUUID",value:function(e){return e||(this._db&&this._db.get&&this._db.get(this.subscribeKey+"uuid")?this._db.get(this.subscribeKey+"uuid"):"pn-"+o.default.createUUID())}}]),e}());t.default=a,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default={createUUID:function(){return i.default.uuid?i.default.uuid():(0,i.default)()}},e.exports=t.default},function(e,t,n){var r,i,s;!function(n,o){i=[t],r=o,void 0!==(s="function"==typeof r?r.apply(t,i):r)&&(e.exports=s)}(0,function(e){function t(){var e,t,n="";for(e=0;e<32;e++)t=16*Math.random()|0,8!==e&&12!==e&&16!==e&&20!==e||(n+="-"),n+=(12===e?4:16===e?3&t|8:t).toString(16);return n}function n(e,t){var n=r[t||"all"];return n&&n.test(e)||!1}var r={3:/^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,4:/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,5:/^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,all:/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i};t.isUUID=n,t.VERSION="0.1.0",e.uuid=t,e.isUUID=n})},function(e,t){"use strict";e.exports={}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(2),a=(r(o),n(7)),u=r(a),c=function(){function e(t){var n=t.config;i(this,e),this._config=n,this._iv="0123456789012345",this._allowedKeyEncodings=["hex","utf8","base64","binary"],this._allowedKeyLengths=[128,256],this._allowedModes=["ecb","cbc"],this._defaultOptions={encryptKey:!0,keyEncoding:"utf8",keyLength:256,mode:"cbc"}}return s(e,[{key:"HMACSHA256",value:function(e){return u.default.HmacSHA256(e,this._config.secretKey).toString(u.default.enc.Base64)}},{key:"SHA256",value:function(e){return u.default.SHA256(e).toString(u.default.enc.Hex)}},{key:"_parseOptions",value:function(e){var t=e||{};return t.hasOwnProperty("encryptKey")||(t.encryptKey=this._defaultOptions.encryptKey),t.hasOwnProperty("keyEncoding")||(t.keyEncoding=this._defaultOptions.keyEncoding),t.hasOwnProperty("keyLength")||(t.keyLength=this._defaultOptions.keyLength),t.hasOwnProperty("mode")||(t.mode=this._defaultOptions.mode),-1===this._allowedKeyEncodings.indexOf(t.keyEncoding.toLowerCase())&&(t.keyEncoding=this._defaultOptions.keyEncoding),-1===this._allowedKeyLengths.indexOf(parseInt(t.keyLength,10))&&(t.keyLength=this._defaultOptions.keyLength),-1===this._allowedModes.indexOf(t.mode.toLowerCase())&&(t.mode=this._defaultOptions.mode),t}},{key:"_decodeKey",value:function(e,t){return"base64"===t.keyEncoding?u.default.enc.Base64.parse(e):"hex"===t.keyEncoding?u.default.enc.Hex.parse(e):e}},{key:"_getPaddedKey",value:function(e,t){return e=this._decodeKey(e,t),t.encryptKey?u.default.enc.Utf8.parse(this.SHA256(e).slice(0,32)):e}},{key:"_getMode",value:function(e){return"ecb"===e.mode?u.default.mode.ECB:u.default.mode.CBC}},{key:"_getIV",value:function(e){return"cbc"===e.mode?u.default.enc.Utf8.parse(this._iv):null}},{key:"encrypt",value:function(e,t,n){return this._config.customEncrypt?this._config.customEncrypt(e):this.pnEncrypt(e,t,n)}},{key:"decrypt",value:function(e,t,n){return this._config.customDecrypt?this._config.customDecrypt(e):this.pnDecrypt(e,t,n)}},{key:"pnEncrypt",value:function(e,t,n){if(!t&&!this._config.cipherKey)return e;n=this._parseOptions(n);var r=this._getIV(n),i=this._getMode(n),s=this._getPaddedKey(t||this._config.cipherKey,n);return u.default.AES.encrypt(e,s,{iv:r,mode:i}).ciphertext.toString(u.default.enc.Base64)||e}},{key:"pnDecrypt",value:function(e,t,n){if(!t&&!this._config.cipherKey)return e;n=this._parseOptions(n);var r=this._getIV(n),i=this._getMode(n),s=this._getPaddedKey(t||this._config.cipherKey,n);try{var o=u.default.enc.Base64.parse(e),a=u.default.AES.decrypt({ciphertext:o},s,{iv:r,mode:i}).toString(u.default.enc.Utf8);return JSON.parse(a)}catch(e){return null}}}]),e}();t.default=c,e.exports=t.default},function(e,t){"use strict";var n=n||function(e,t){var n={},r=n.lib={},i=function(){},s=r.Base={extend:function(e){i.prototype=this;var t=new i;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},o=r.WordArray=s.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=void 0!=t?t:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes;if(e=e.sigBytes,this.clamp(),r%4)for(var i=0;i<e;i++)t[r+i>>>2]|=(n[i>>>2]>>>24-i%4*8&255)<<24-(r+i)%4*8;else if(65535<n.length)for(i=0;i<e;i+=4)t[r+i>>>2]=n[i>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=s.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],r=0;r<t;r+=4)n.push(4294967296*e.random()|0);return new o.init(n,t)}}),a=n.enc={},u=a.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++){var i=t[r>>>2]>>>24-r%4*8&255;n.push((i>>>4).toString(16)),n.push((15&i).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new o.init(n,t/2)}},c=a.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++)n.push(String.fromCharCode(t[r>>>2]>>>24-r%4*8&255));return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new o.init(n,t)}},l=a.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},h=r.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,i=n.sigBytes,s=this.blockSize,a=i/(4*s),a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0);if(t=a*s,i=e.min(4*t,i),t){for(var u=0;u<t;u+=s)this._doProcessBlock(r,u);u=r.splice(0,t),n.sigBytes-=i}return new o.init(u,i)},clone:function(){var e=s.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=h.extend({cfg:s.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new f.HMAC.init(e,n).finalize(t)}}});var f=n.algo={};return n}(Math);!function(e){for(var t=n,r=t.lib,i=r.WordArray,s=r.Hasher,r=t.algo,o=[],a=[],u=function(e){return 4294967296*(e-(0|e))|0},c=2,l=0;64>l;){var h;e:{h=c;for(var f=e.sqrt(h),p=2;p<=f;p++)if(!(h%p)){h=!1;break e}h=!0}h&&(8>l&&(o[l]=u(e.pow(c,.5))),a[l]=u(e.pow(c,1/3)),l++),c++}var d=[],r=r.SHA256=s.extend({_doReset:function(){this._hash=new i.init(o.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],s=n[2],o=n[3],u=n[4],c=n[5],l=n[6],h=n[7],f=0;64>f;f++){if(16>f)d[f]=0|e[t+f];else{var p=d[f-15],y=d[f-2];d[f]=((p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3)+d[f-7]+((y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10)+d[f-16]}p=h+((u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25))+(u&c^~u&l)+a[f]+d[f],y=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&i^r&s^i&s),h=l,l=c,c=u,u=o+p|0,o=s,s=i,i=r,r=p+y|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+s|0,n[3]=n[3]+o|0,n[4]=n[4]+u|0,n[5]=n[5]+c|0,n[6]=n[6]+l|0,n[7]=n[7]+h|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;return n[i>>>5]|=128<<24-i%32,n[14+(i+64>>>9<<4)]=e.floor(r/4294967296),n[15+(i+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=s._createHelper(r),t.HmacSHA256=s._createHmacHelper(r)}(Math),function(){var e=n,t=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init:function(e,n){e=this._hasher=new e.init,"string"==typeof n&&(n=t.parse(n));var r=e.blockSize,i=4*r;n.sigBytes>i&&(n=e.finalize(n)),n.clamp();for(var s=this._oKey=n.clone(),o=this._iKey=n.clone(),a=s.words,u=o.words,c=0;c<r;c++)a[c]^=1549556828,u[c]^=909522486;s.sigBytes=o.sigBytes=i,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}})}(),function(){var e=n,t=e.lib.WordArray;e.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp(),e=[];for(var i=0;i<n;i+=3)for(var s=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,o=0;4>o&&i+.75*o<n;o++)e.push(r.charAt(s>>>6*(3-o)&63));if(t=r.charAt(64))for(;e.length%4;)e.push(t);return e.join("")},parse:function(e){var n=e.length,r=this._map,i=r.charAt(64);i&&-1!=(i=e.indexOf(i))&&(n=i);for(var i=[],s=0,o=0;o<n;o++)if(o%4){var a=r.indexOf(e.charAt(o-1))<<o%4*2,u=r.indexOf(e.charAt(o))>>>6-o%4*2;i[s>>>2]|=(a|u)<<24-s%4*8,s++}return t.create(i,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(e){function t(e,t,n,r,i,s,o){return((e=e+(t&n|~t&r)+i+o)<<s|e>>>32-s)+t}function r(e,t,n,r,i,s,o){return((e=e+(t&r|n&~r)+i+o)<<s|e>>>32-s)+t}function i(e,t,n,r,i,s,o){return((e=e+(t^n^r)+i+o)<<s|e>>>32-s)+t}function s(e,t,n,r,i,s,o){return((e=e+(n^(t|~r))+i+o)<<s|e>>>32-s)+t}for(var o=n,a=o.lib,u=a.WordArray,c=a.Hasher,a=o.algo,l=[],h=0;64>h;h++)l[h]=4294967296*e.abs(e.sin(h+1))|0;a=a.MD5=c.extend({_doReset:function(){this._hash=new u.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,n){for(var o=0;16>o;o++){var a=n+o,u=e[a];e[a]=16711935&(u<<8|u>>>24)|4278255360&(u<<24|u>>>8)}var o=this._hash.words,a=e[n+0],u=e[n+1],c=e[n+2],h=e[n+3],f=e[n+4],p=e[n+5],d=e[n+6],y=e[n+7],g=e[n+8],b=e[n+9],_=e[n+10],v=e[n+11],m=e[n+12],k=e[n+13],P=e[n+14],O=e[n+15],w=o[0],T=o[1],S=o[2],C=o[3],w=t(w,T,S,C,a,7,l[0]),C=t(C,w,T,S,u,12,l[1]),S=t(S,C,w,T,c,17,l[2]),T=t(T,S,C,w,h,22,l[3]),w=t(w,T,S,C,f,7,l[4]),C=t(C,w,T,S,p,12,l[5]),S=t(S,C,w,T,d,17,l[6]),T=t(T,S,C,w,y,22,l[7]),w=t(w,T,S,C,g,7,l[8]),C=t(C,w,T,S,b,12,l[9]),S=t(S,C,w,T,_,17,l[10]),T=t(T,S,C,w,v,22,l[11]),w=t(w,T,S,C,m,7,l[12]),C=t(C,w,T,S,k,12,l[13]),S=t(S,C,w,T,P,17,l[14]),T=t(T,S,C,w,O,22,l[15]),w=r(w,T,S,C,u,5,l[16]),C=r(C,w,T,S,d,9,l[17]),S=r(S,C,w,T,v,14,l[18]),T=r(T,S,C,w,a,20,l[19]),w=r(w,T,S,C,p,5,l[20]),C=r(C,w,T,S,_,9,l[21]),S=r(S,C,w,T,O,14,l[22]),T=r(T,S,C,w,f,20,l[23]),w=r(w,T,S,C,b,5,l[24]),C=r(C,w,T,S,P,9,l[25]),S=r(S,C,w,T,h,14,l[26]),T=r(T,S,C,w,g,20,l[27]),w=r(w,T,S,C,k,5,l[28]),C=r(C,w,T,S,c,9,l[29]),S=r(S,C,w,T,y,14,l[30]),T=r(T,S,C,w,m,20,l[31]),w=i(w,T,S,C,p,4,l[32]),C=i(C,w,T,S,g,11,l[33]),S=i(S,C,w,T,v,16,l[34]),T=i(T,S,C,w,P,23,l[35]),w=i(w,T,S,C,u,4,l[36]),C=i(C,w,T,S,f,11,l[37]),S=i(S,C,w,T,y,16,l[38]),T=i(T,S,C,w,_,23,l[39]),w=i(w,T,S,C,k,4,l[40]),C=i(C,w,T,S,a,11,l[41]),S=i(S,C,w,T,h,16,l[42]),T=i(T,S,C,w,d,23,l[43]),w=i(w,T,S,C,b,4,l[44]),C=i(C,w,T,S,m,11,l[45]),S=i(S,C,w,T,O,16,l[46]),T=i(T,S,C,w,c,23,l[47]),w=s(w,T,S,C,a,6,l[48]),C=s(C,w,T,S,y,10,l[49]),S=s(S,C,w,T,P,15,l[50]),T=s(T,S,C,w,p,21,l[51]),w=s(w,T,S,C,m,6,l[52]),C=s(C,w,T,S,h,10,l[53]),S=s(S,C,w,T,_,15,l[54]),T=s(T,S,C,w,u,21,l[55]),w=s(w,T,S,C,g,6,l[56]),C=s(C,w,T,S,O,10,l[57]),S=s(S,C,w,T,d,15,l[58]),T=s(T,S,C,w,k,21,l[59]),w=s(w,T,S,C,f,6,l[60]),C=s(C,w,T,S,v,10,l[61]),S=s(S,C,w,T,c,15,l[62]),T=s(T,S,C,w,b,21,l[63]);o[0]=o[0]+w|0,o[1]=o[1]+T|0,o[2]=o[2]+S|0,o[3]=o[3]+C|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;n[i>>>5]|=128<<24-i%32;var s=e.floor(r/4294967296);for(n[15+(i+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),n[14+(i+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),t.sigBytes=4*(n.length+1),this._process(),t=this._hash,n=t.words,r=0;4>r;r++)i=n[r],n[r]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8);return t},clone:function(){var e=c.clone.call(this);return e._hash=this._hash.clone(),e}}),o.MD5=c._createHelper(a),o.HmacMD5=c._createHmacHelper(a)}(Math),function(){var e=n,t=e.lib,r=t.Base,i=t.WordArray,t=e.algo,s=t.EvpKDF=r.extend({cfg:r.extend({keySize:4,hasher:t.MD5,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,r=n.hasher.create(),s=i.create(),o=s.words,a=n.keySize,n=n.iterations;o.length<a;){u&&r.update(u);var u=r.update(e).finalize(t);r.reset();for(var c=1;c<n;c++)u=r.finalize(u),r.reset();s.concat(u)}return s.sigBytes=4*a,s}});e.EvpKDF=function(e,t,n){return s.create(n).compute(e,t)}}(),n.lib.Cipher||function(e){var t=n,r=t.lib,i=r.Base,s=r.WordArray,o=r.BufferedBlockAlgorithm,a=t.enc.Base64,u=t.algo.EvpKDF,c=r.Cipher=o.extend({cfg:i.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){o.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(e){return{encrypt:function(t,n,r){return("string"==typeof n?y:d).encrypt(e,t,n,r)},decrypt:function(t,n,r){return("string"==typeof n?y:d).decrypt(e,t,n,r)}}}});r.StreamCipher=c.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var l=t.mode={},h=function(e,t,n){var r=this._iv;r?this._iv=void 0:r=this._prevBlock;for(var i=0;i<n;i++)e[t+i]^=r[i]},f=(r.BlockCipherMode=i.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}})).extend();f.Encryptor=f.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize;h.call(this,e,t,r),n.encryptBlock(e,t),this._prevBlock=e.slice(t,t+r)}}),f.Decryptor=f.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,i=e.slice(t,t+r);n.decryptBlock(e,t),h.call(this,e,t,r),this._prevBlock=i}}),l=l.CBC=f,f=(t.pad={}).Pkcs7={pad:function(e,t){for(var n=4*t,n=n-e.sigBytes%n,r=n<<24|n<<16|n<<8|n,i=[],o=0;o<n;o+=4)i.push(r);n=s.create(i,n),e.concat(n)},unpad:function(e){e.sigBytes-=255&e.words[e.sigBytes-1>>>2]}},r.BlockCipher=c.extend({cfg:c.cfg.extend({mode:l,padding:f}),reset:function(){c.reset.call(this);var e=this.cfg,t=e.iv,e=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=e.createEncryptor;else n=e.createDecryptor,this._minBufferSize=1;this._mode=n.call(e,this,t&&t.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4});var p=r.CipherParams=i.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),l=(t.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext;return e=e.salt,(e?s.create([1398893684,1701076831]).concat(e).concat(t):t).toString(a)},parse:function(e){e=a.parse(e);var t=e.words;if(1398893684==t[0]&&1701076831==t[1]){var n=s.create(t.slice(2,4));t.splice(0,4),e.sigBytes-=16}return p.create({ciphertext:e,salt:n})}},d=r.SerializableCipher=i.extend({cfg:i.extend({format:l}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var i=e.createEncryptor(n,r);return t=i.finalize(t),i=i.cfg,p.create({ciphertext:t,key:n,iv:i.iv,algorithm:e,mode:i.mode,padding:i.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),e.createDecryptor(n,r).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),t=(t.kdf={}).OpenSSL={execute:function(e,t,n,r){return r||(r=s.random(8)),e=u.create({keySize:t+n}).compute(e,r),n=s.create(e.words.slice(t),4*n),e.sigBytes=4*t,p.create({key:e,iv:n,salt:r})}},y=r.PasswordBasedCipher=d.extend({cfg:d.cfg.extend({kdf:t}),encrypt:function(e,t,n,r){return r=this.cfg.extend(r),n=r.kdf.execute(n,e.keySize,e.ivSize),r.iv=n.iv,e=d.encrypt.call(this,e,t,n.key,r),e.mixIn(n),e},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),n=r.kdf.execute(n,e.keySize,e.ivSize,t.salt),r.iv=n.iv,d.decrypt.call(this,e,t,n.key,r)}})}(),function(){for(var e=n,t=e.lib.BlockCipher,r=e.algo,i=[],s=[],o=[],a=[],u=[],c=[],l=[],h=[],f=[],p=[],d=[],y=0;256>y;y++)d[y]=128>y?y<<1:y<<1^283;for(var g=0,b=0,y=0;256>y;y++){var _=b^b<<1^b<<2^b<<3^b<<4,_=_>>>8^255&_^99;i[g]=_,s[_]=g;var v=d[g],m=d[v],k=d[m],P=257*d[_]^16843008*_;o[g]=P<<24|P>>>8,a[g]=P<<16|P>>>16,u[g]=P<<8|P>>>24,c[g]=P,P=16843009*k^65537*m^257*v^16843008*g,l[_]=P<<24|P>>>8,h[_]=P<<16|P>>>16,f[_]=P<<8|P>>>24,p[_]=P,g?(g=v^d[d[d[k^v]]],b^=d[d[b]]):g=b=1}var O=[0,1,2,4,8,16,32,64,128,27,54],r=r.AES=t.extend({_doReset:function(){for(var e=this._key,t=e.words,n=e.sigBytes/4,e=4*((this._nRounds=n+6)+1),r=this._keySchedule=[],s=0;s<e;s++)if(s<n)r[s]=t[s];else{var o=r[s-1];s%n?6<n&&4==s%n&&(o=i[o>>>24]<<24|i[o>>>16&255]<<16|i[o>>>8&255]<<8|i[255&o]):(o=o<<8|o>>>24,o=i[o>>>24]<<24|i[o>>>16&255]<<16|i[o>>>8&255]<<8|i[255&o],o^=O[s/n|0]<<24),r[s]=r[s-n]^o}for(t=this._invKeySchedule=[],n=0;n<e;n++)s=e-n,o=n%4?r[s]:r[s-4],t[n]=4>n||4>=s?o:l[i[o>>>24]]^h[i[o>>>16&255]]^f[i[o>>>8&255]]^p[i[255&o]]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,o,a,u,c,i)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,l,h,f,p,s),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,i,s,o,a){for(var u=this._nRounds,c=e[t]^n[0],l=e[t+1]^n[1],h=e[t+2]^n[2],f=e[t+3]^n[3],p=4,d=1;d<u;d++)var y=r[c>>>24]^i[l>>>16&255]^s[h>>>8&255]^o[255&f]^n[p++],g=r[l>>>24]^i[h>>>16&255]^s[f>>>8&255]^o[255&c]^n[p++],b=r[h>>>24]^i[f>>>16&255]^s[c>>>8&255]^o[255&l]^n[p++],f=r[f>>>24]^i[c>>>16&255]^s[l>>>8&255]^o[255&h]^n[p++],c=y,l=g,h=b;y=(a[c>>>24]<<24|a[l>>>16&255]<<16|a[h>>>8&255]<<8|a[255&f])^n[p++],g=(a[l>>>24]<<24|a[h>>>16&255]<<16|a[f>>>8&255]<<8|a[255&c])^n[p++],b=(a[h>>>24]<<24|a[f>>>16&255]<<16|a[c>>>8&255]<<8|a[255&l])^n[p++],f=(a[f>>>24]<<24|a[c>>>16&255]<<16|a[l>>>8&255]<<8|a[255&h])^n[p++],e[t]=y,e[t+1]=g,e[t+2]=b,e[t+3]=f},keySize:8});e.AES=t._createHelper(r)}(),n.mode.ECB=function(){var e=n.lib.BlockCipherMode.extend();return e.Encryptor=e.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),e.Decryptor=e.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),e}(),e.exports=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(6),a=(r(o),n(2)),u=(r(a),n(9)),c=(r(u),n(11)),l=r(c),h=n(14),f=r(h),p=n(15),d=r(p),y=(n(5),n(10)),g=r(y),b=function(){function e(t){var n=t.subscribeEndpoint,r=t.leaveEndpoint,s=t.heartbeatEndpoint,o=t.setStateEndpoint,a=t.timeEndpoint,u=t.config,c=t.crypto,h=t.listenerManager;i(this,e),this._listenerManager=h,this._config=u,this._leaveEndpoint=r,this._heartbeatEndpoint=s,this._setStateEndpoint=o,this._subscribeEndpoint=n,this._crypto=c,this._channels={},this._presenceChannels={},this._heartbeatChannels={},this._heartbeatChannelGroups={},this._channelGroups={},this._presenceChannelGroups={},this._pendingChannelSubscriptions=[],this._pendingChannelGroupSubscriptions=[],this._currentTimetoken=0,this._lastTimetoken=0,this._storedTimetoken=null,this._subscriptionStatusAnnounced=!1,this._isOnline=!0,this._reconnectionManager=new l.default({timeEndpoint:a}),this._dedupingManager=new f.default({config:u})}return s(e,[{key:"adaptStateChange",value:function(e,t){var n=this,r=e.state,i=e.channels,s=void 0===i?[]:i,o=e.channelGroups,a=void 0===o?[]:o;return s.forEach(function(e){e in n._channels&&(n._channels[e].state=r)}),a.forEach(function(e){e in n._channelGroups&&(n._channelGroups[e].state=r)}),this._setStateEndpoint({state:r,channels:s,channelGroups:a},t)}},{key:"adaptPresenceChange",value:function(e){var t=this,n=e.connected,r=e.channels,i=void 0===r?[]:r,s=e.channelGroups,o=void 0===s?[]:s;n?(i.forEach(function(e){t._heartbeatChannels[e]={state:{}}}),o.forEach(function(e){t._heartbeatChannelGroups[e]={state:{}}})):(i.forEach(function(e){e in t._heartbeatChannels&&delete t._heartbeatChannels[e]}),o.forEach(function(e){e in t._heartbeatChannelGroups&&delete t._heartbeatChannelGroups[e]}),!1===this._config.suppressLeaveEvents&&this._leaveEndpoint({channels:i,channelGroups:o},function(e){t._listenerManager.announceStatus(e)})),this.reconnect()}},{key:"adaptSubscribeChange",value:function(e){var t=this,n=e.timetoken,r=e.channels,i=void 0===r?[]:r,s=e.channelGroups,o=void 0===s?[]:s,a=e.withPresence,u=void 0!==a&&a,c=e.withHeartbeats,l=void 0===c||c;if(!this._config.subscribeKey||""===this._config.subscribeKey)return void(console&&console.log&&console.log("subscribe key missing; aborting subscribe"));n&&(this._lastTimetoken=this._currentTimetoken,this._currentTimetoken=n),
"0"!==this._currentTimetoken&&0!==this._currentTimetoken&&(this._storedTimetoken=this._currentTimetoken,this._currentTimetoken=0),i.forEach(function(e){t._channels[e]={state:{}},u&&(t._presenceChannels[e]={}),l&&(t._heartbeatChannels[e]={}),t._pendingChannelSubscriptions.push(e)}),o.forEach(function(e){t._channelGroups[e]={state:{}},u&&(t._presenceChannelGroups[e]={}),l&&(t._heartbeatChannelGroups[e]={}),t._pendingChannelGroupSubscriptions.push(e)}),this._subscriptionStatusAnnounced=!1,this.reconnect()}},{key:"adaptUnsubscribeChange",value:function(e,t){var n=this,r=e.channels,i=void 0===r?[]:r,s=e.channelGroups,o=void 0===s?[]:s,a=[],u=[];i.forEach(function(e){e in n._channels&&(delete n._channels[e],a.push(e),e in n._heartbeatChannels&&delete n._heartbeatChannels[e]),e in n._presenceChannels&&(delete n._presenceChannels[e],a.push(e))}),o.forEach(function(e){e in n._channelGroups&&(delete n._channelGroups[e],u.push(e),e in n._heartbeatChannelGroups&&delete n._heartbeatChannelGroups[e]),e in n._presenceChannelGroups&&(delete n._channelGroups[e],u.push(e))}),0===a.length&&0===u.length||(!1!==this._config.suppressLeaveEvents||t||this._leaveEndpoint({channels:a,channelGroups:u},function(e){e.affectedChannels=a,e.affectedChannelGroups=u,e.currentTimetoken=n._currentTimetoken,e.lastTimetoken=n._lastTimetoken,n._listenerManager.announceStatus(e)}),0===Object.keys(this._channels).length&&0===Object.keys(this._presenceChannels).length&&0===Object.keys(this._channelGroups).length&&0===Object.keys(this._presenceChannelGroups).length&&(this._lastTimetoken=0,this._currentTimetoken=0,this._storedTimetoken=null,this._region=null,this._reconnectionManager.stopPolling()),this.reconnect())}},{key:"unsubscribeAll",value:function(e){this.adaptUnsubscribeChange({channels:this.getSubscribedChannels(),channelGroups:this.getSubscribedChannelGroups()},e)}},{key:"getHeartbeatChannels",value:function(){return Object.keys(this._heartbeatChannels)}},{key:"getHeartbeatChannelGroups",value:function(){return Object.keys(this._heartbeatChannelGroups)}},{key:"getSubscribedChannels",value:function(){return Object.keys(this._channels)}},{key:"getSubscribedChannelGroups",value:function(){return Object.keys(this._channelGroups)}},{key:"reconnect",value:function(){this._startSubscribeLoop(),this._registerHeartbeatTimer()}},{key:"disconnect",value:function(){this._stopSubscribeLoop(),this._stopHeartbeatTimer(),this._reconnectionManager.stopPolling()}},{key:"_registerHeartbeatTimer",value:function(){this._stopHeartbeatTimer(),0!==this._config.getHeartbeatInterval()&&(this._performHeartbeatLoop(),this._heartbeatTimer=setInterval(this._performHeartbeatLoop.bind(this),1e3*this._config.getHeartbeatInterval()))}},{key:"_stopHeartbeatTimer",value:function(){this._heartbeatTimer&&(clearInterval(this._heartbeatTimer),this._heartbeatTimer=null)}},{key:"_performHeartbeatLoop",value:function(){var e=this,t=this.getHeartbeatChannels(),n=this.getHeartbeatChannelGroups(),r={};if(0!==t.length||0!==n.length){this.getSubscribedChannels().forEach(function(t){var n=e._channels[t].state;Object.keys(n).length&&(r[t]=n)}),this.getSubscribedChannelGroups().forEach(function(t){var n=e._channelGroups[t].state;Object.keys(n).length&&(r[t]=n)});var i=function(t){t.error&&e._config.announceFailedHeartbeats&&e._listenerManager.announceStatus(t),t.error&&e._config.autoNetworkDetection&&e._isOnline&&(e._isOnline=!1,e.disconnect(),e._listenerManager.announceNetworkDown(),e.reconnect()),!t.error&&e._config.announceSuccessfulHeartbeats&&e._listenerManager.announceStatus(t)};this._heartbeatEndpoint({channels:t,channelGroups:n,state:r},i.bind(this))}}},{key:"_startSubscribeLoop",value:function(){this._stopSubscribeLoop();var e=[],t=[];if(Object.keys(this._channels).forEach(function(t){return e.push(t)}),Object.keys(this._presenceChannels).forEach(function(t){return e.push(t+"-pnpres")}),Object.keys(this._channelGroups).forEach(function(e){return t.push(e)}),Object.keys(this._presenceChannelGroups).forEach(function(e){return t.push(e+"-pnpres")}),0!==e.length||0!==t.length){var n={channels:e,channelGroups:t,timetoken:this._currentTimetoken,filterExpression:this._config.filterExpression,region:this._region};this._subscribeCall=this._subscribeEndpoint(n,this._processSubscribeResponse.bind(this))}}},{key:"_processSubscribeResponse",value:function(e,t){var n=this;if(e.error)return void(e.category===g.default.PNTimeoutCategory?this._startSubscribeLoop():e.category===g.default.PNNetworkIssuesCategory?(this.disconnect(),e.error&&this._config.autoNetworkDetection&&this._isOnline&&(this._isOnline=!1,this._listenerManager.announceNetworkDown()),this._reconnectionManager.onReconnection(function(){n._config.autoNetworkDetection&&!n._isOnline&&(n._isOnline=!0,n._listenerManager.announceNetworkUp()),n.reconnect(),n._subscriptionStatusAnnounced=!0;var t={category:g.default.PNReconnectedCategory,operation:e.operation,lastTimetoken:n._lastTimetoken,currentTimetoken:n._currentTimetoken};n._listenerManager.announceStatus(t)}),this._reconnectionManager.startPolling(),this._listenerManager.announceStatus(e)):e.category===g.default.PNBadRequestCategory?(this._stopHeartbeatTimer(),this._listenerManager.announceStatus(e)):this._listenerManager.announceStatus(e));if(this._storedTimetoken?(this._currentTimetoken=this._storedTimetoken,this._storedTimetoken=null):(this._lastTimetoken=this._currentTimetoken,this._currentTimetoken=t.metadata.timetoken),!this._subscriptionStatusAnnounced){var r={};r.category=g.default.PNConnectedCategory,r.operation=e.operation,r.affectedChannels=this._pendingChannelSubscriptions,r.subscribedChannels=this.getSubscribedChannels(),r.affectedChannelGroups=this._pendingChannelGroupSubscriptions,r.lastTimetoken=this._lastTimetoken,r.currentTimetoken=this._currentTimetoken,this._subscriptionStatusAnnounced=!0,this._listenerManager.announceStatus(r),this._pendingChannelSubscriptions=[],this._pendingChannelGroupSubscriptions=[]}var i=t.messages||[],s=this._config,o=s.requestMessageCountThreshold,a=s.dedupeOnSubscribe;if(o&&i.length>=o){var u={};u.category=g.default.PNRequestMessageCountExceededCategory,u.operation=e.operation,this._listenerManager.announceStatus(u)}i.forEach(function(e){var t=e.channel,r=e.subscriptionMatch,i=e.publishMetaData;if(t===r&&(r=null),a){if(n._dedupingManager.isDuplicate(e))return;n._dedupingManager.addEntry(e)}if(d.default.endsWith(e.channel,"-pnpres")){var s={};s.channel=null,s.subscription=null,s.actualChannel=null!=r?t:null,s.subscribedChannel=null!=r?r:t,t&&(s.channel=t.substring(0,t.lastIndexOf("-pnpres"))),r&&(s.subscription=r.substring(0,r.lastIndexOf("-pnpres"))),s.action=e.payload.action,s.state=e.payload.data,s.timetoken=i.publishTimetoken,s.occupancy=e.payload.occupancy,s.uuid=e.payload.uuid,s.timestamp=e.payload.timestamp,e.payload.join&&(s.join=e.payload.join),e.payload.leave&&(s.leave=e.payload.leave),e.payload.timeout&&(s.timeout=e.payload.timeout),n._listenerManager.announcePresence(s)}else{var o={};o.channel=null,o.subscription=null,o.actualChannel=null!=r?t:null,o.subscribedChannel=null!=r?r:t,o.channel=t,o.subscription=r,o.timetoken=i.publishTimetoken,o.publisher=e.issuingClientId,e.userMetadata&&(o.userMetadata=e.userMetadata),n._config.cipherKey?o.message=n._crypto.decrypt(e.payload):o.message=e.payload,n._listenerManager.announceMessage(o)}}),this._region=t.metadata.region,this._startSubscribeLoop()}},{key:"_stopSubscribeLoop",value:function(){this._subscribeCall&&("function"==typeof this._subscribeCall.abort&&this._subscribeCall.abort(),this._subscribeCall=null)}}]),e}();t.default=b,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=(n(5),n(10)),o=function(e){return e&&e.__esModule?e:{default:e}}(s),a=function(){function e(){r(this,e),this._listeners=[]}return i(e,[{key:"addListener",value:function(e){this._listeners.push(e)}},{key:"removeListener",value:function(e){var t=[];this._listeners.forEach(function(n){n!==e&&t.push(n)}),this._listeners=t}},{key:"removeAllListeners",value:function(){this._listeners=[]}},{key:"announcePresence",value:function(e){this._listeners.forEach(function(t){t.presence&&t.presence(e)})}},{key:"announceStatus",value:function(e){this._listeners.forEach(function(t){t.status&&t.status(e)})}},{key:"announceMessage",value:function(e){this._listeners.forEach(function(t){t.message&&t.message(e)})}},{key:"announceNetworkUp",value:function(){var e={};e.category=o.default.PNNetworkUpCategory,this.announceStatus(e)}},{key:"announceNetworkDown",value:function(){var e={};e.category=o.default.PNNetworkDownCategory,this.announceStatus(e)}}]),e}();t.default=a,e.exports=t.default},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={PNNetworkUpCategory:"PNNetworkUpCategory",PNNetworkDownCategory:"PNNetworkDownCategory",PNNetworkIssuesCategory:"PNNetworkIssuesCategory",PNTimeoutCategory:"PNTimeoutCategory",PNBadRequestCategory:"PNBadRequestCategory",PNAccessDeniedCategory:"PNAccessDeniedCategory",PNUnknownCategory:"PNUnknownCategory",PNReconnectedCategory:"PNReconnectedCategory",PNConnectedCategory:"PNConnectedCategory",PNRequestMessageCountExceededCategory:"PNRequestMessageCountExceededCategory"},e.exports=t.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(12),o=(function(e){e&&e.__esModule}(s),n(5),function(){function e(t){var n=t.timeEndpoint;r(this,e),this._timeEndpoint=n}return i(e,[{key:"onReconnection",value:function(e){this._reconnectionCallback=e}},{key:"startPolling",value:function(){this._timeTimer=setInterval(this._performTimeLoop.bind(this),3e3)}},{key:"stopPolling",value:function(){clearInterval(this._timeTimer)}},{key:"_performTimeLoop",value:function(){var e=this;this._timeEndpoint(function(t){t.error||(clearInterval(e._timeTimer),e._reconnectionCallback())})}}]),e}());t.default=o,e.exports=t.default},function(e,t,n){"use strict";function r(){return h.default.PNTimeOperation}function i(){return"/time/0"}function s(e){return e.config.getTransactionTimeout()}function o(){return{}}function a(){return!1}function u(e,t){return{timetoken:t[0]}}function c(){}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=r,t.getURL=i,t.getRequestTimeout=s,t.prepareParams=o,t.isAuthSupported=a,t.handleResponse=u,t.validateParams=c;var l=(n(5),n(13)),h=function(e){return e&&e.__esModule?e:{default:e}}(l)},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={PNTimeOperation:"PNTimeOperation",PNHistoryOperation:"PNHistoryOperation",PNDeleteMessagesOperation:"PNDeleteMessagesOperation",PNFetchMessagesOperation:"PNFetchMessagesOperation",PNSubscribeOperation:"PNSubscribeOperation",PNUnsubscribeOperation:"PNUnsubscribeOperation",PNPublishOperation:"PNPublishOperation",PNPushNotificationEnabledChannelsOperation:"PNPushNotificationEnabledChannelsOperation",PNRemoveAllPushNotificationsOperation:"PNRemoveAllPushNotificationsOperation",PNWhereNowOperation:"PNWhereNowOperation",PNSetStateOperation:"PNSetStateOperation",PNHereNowOperation:"PNHereNowOperation",PNGetStateOperation:"PNGetStateOperation",PNHeartbeatOperation:"PNHeartbeatOperation",PNChannelGroupsOperation:"PNChannelGroupsOperation",PNRemoveGroupOperation:"PNRemoveGroupOperation",PNChannelsForGroupOperation:"PNChannelsForGroupOperation",PNAddChannelsToGroupOperation:"PNAddChannelsToGroupOperation",PNRemoveChannelsFromGroupOperation:"PNRemoveChannelsFromGroupOperation",PNAccessManagerGrant:"PNAccessManagerGrant",PNAccessManagerAudit:"PNAccessManagerAudit"},e.exports=t.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(2),o=(function(e){e&&e.__esModule}(s),n(5),function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n+=1){t=(t<<5)-t+e.charCodeAt(n),t&=t}return t}),a=function(){function e(t){var n=t.config;r(this,e),this.hashHistory=[],this._config=n}return i(e,[{key:"getKey",value:function(e){var t=o(JSON.stringify(e.payload)).toString();return e.publishMetaData.publishTimetoken+"-"+t}},{key:"isDuplicate",value:function(e){return this.hashHistory.includes(this.getKey(e))}},{key:"addEntry",value:function(e){this.hashHistory.length>=this._config.maximumCacheSize&&this.hashHistory.shift(),this.hashHistory.push(this.getKey(e))}},{key:"clearHistory",value:function(){this.hashHistory=[]}}]),e}();t.default=a,e.exports=t.default},function(e,t){"use strict";function n(e){var t=[];return Object.keys(e).forEach(function(e){return t.push(e)}),t}function r(e){return encodeURIComponent(e).replace(/[!~*'()]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function i(e){return n(e).sort()}function s(e){return i(e).map(function(t){return t+"="+r(e[t])}).join("&")}function o(e,t){return-1!==e.indexOf(t,this.length-t.length)}function a(){var e=void 0,t=void 0;return{promise:new Promise(function(n,r){e=n,t=r}),reject:t,fulfill:e}}e.exports={signPamFromParams:s,endsWith:o,createPromise:a,encodeString:r}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){return e.type=t,e.error=!0,e}function u(e){return a({message:e},"validationError")}function c(e,t,n){return e.usePost&&e.usePost(t,n)?e.postURL(t,n):e.getURL(t,n)}function l(e){if(e.sdkName)return e.sdkName;var t="PubNub-JS-"+e.sdkFamily;return e.partnerId&&(t+="-"+e.partnerId),t+="/"+e.getVersion()}function h(e,t,n){var r=e.config,i=e.crypto;n.timestamp=Math.floor((new Date).getTime()/1e3);var s=r.subscribeKey+"\n"+r.publishKey+"\n"+t+"\n";s+=y.default.signPamFromParams(n);var o=i.HMACSHA256(s);o=o.replace(/\+/g,"-"),o=o.replace(/\//g,"_"),n.signature=o}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=e.networking,r=e.config,i=null,s=null,o={};t.getOperation()===_.default.PNTimeOperation||t.getOperation()===_.default.PNChannelGroupsOperation?i=arguments.length<=2?void 0:arguments[2]:(o=arguments.length<=2?void 0:arguments[2],i=arguments.length<=3?void 0:arguments[3]),"undefined"==typeof Promise||i||(s=y.default.createPromise());var a=t.validateParams(e,o);if(!a){var f=t.prepareParams(e,o),d=c(t,e,o),g=void 0,b={url:d,operation:t.getOperation(),timeout:t.getRequestTimeout(e)};f.uuid=r.UUID,f.pnsdk=l(r),r.useInstanceId&&(f.instanceid=r.instanceId),r.useRequestId&&(f.requestid=p.default.createUUID()),t.isAuthSupported()&&r.getAuthKey()&&(f.auth=r.getAuthKey()),r.secretKey&&h(e,d,f);var m=function(n,r){if(n.error)return void(i?i(n):s&&s.reject(new v("PubNub call failed, check status for details",n)));var a=t.handleResponse(e,r,o);i?i(n,a):s&&s.fulfill(a)};if(t.usePost&&t.usePost(e,o)){var k=t.postPayload(e,o);g=n.POST(f,k,b,m)}else g=t.useDelete&&t.useDelete()?n.DELETE(f,b,m):n.GET(f,b,m);return t.getOperation()===_.default.PNSubscribeOperation?g:s?s.promise:void 0}return i?i(u(a)):s?(s.reject(new v("Validation failed, check status for details",u(a))),s.promise):void 0};var f=n(3),p=r(f),d=(n(5),n(15)),y=r(d),g=n(2),b=(r(g),n(13)),_=r(b),v=function(e){function t(e,n){i(this,t);var r=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.name=r.constructor.name,r.status=n,r.message=e,r}return o(t,e),t}(Error);e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){return f.default.PNAddChannelsToGroupOperation}function s(e,t){var n=t.channels,r=t.channelGroup,i=e.config;return r?n&&0!==n.length?i.subscribeKey?void 0:"Missing Subscribe Key":"Missing Channels":"Missing Channel Group"}function o(e,t){var n=t.channelGroup;return"/v1/channel-registration/sub-key/"+e.config.subscribeKey+"/channel-group/"+d.default.encodeString(n)}function a(e){return e.config.getTransactionTimeout()}function u(){return!0}function c(e,t){var n=t.channels;return{add:(void 0===n?[]:n).join(",")}}function l(){return{}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=i,t.validateParams=s,t.getURL=o,t.getRequestTimeout=a,t.isAuthSupported=u,t.prepareParams=c,t.handleResponse=l;var h=(n(5),n(13)),f=r(h),p=n(15),d=r(p)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){return f.default.PNRemoveChannelsFromGroupOperation}function s(e,t){var n=t.channels,r=t.channelGroup,i=e.config;return r?n&&0!==n.length?i.subscribeKey?void 0:"Missing Subscribe Key":"Missing Channels":"Missing Channel Group"}function o(e,t){var n=t.channelGroup;return"/v1/channel-registration/sub-key/"+e.config.subscribeKey+"/channel-group/"+d.default.encodeString(n)}function a(e){return e.config.getTransactionTimeout()}function u(){return!0}function c(e,t){var n=t.channels;return{remove:(void 0===n?[]:n).join(",")}}function l(){return{}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=i,t.validateParams=s,t.getURL=o,t.getRequestTimeout=a,t.isAuthSupported=u,t.prepareParams=c,t.handleResponse=l;var h=(n(5),n(13)),f=r(h),p=n(15),d=r(p)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){return f.default.PNRemoveGroupOperation}function s(e,t){var n=t.channelGroup,r=e.config;return n?r.subscribeKey?void 0:"Missing Subscribe Key":"Missing Channel Group"}function o(e,t){var n=t.channelGroup;return"/v1/channel-registration/sub-key/"+e.config.subscribeKey+"/channel-group/"+d.default.encodeString(n)+"/remove"}function a(){return!0}function u(e){return e.config.getTransactionTimeout()}function c(){return{}}function l(){return{}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=i,t.validateParams=s,t.getURL=o,t.isAuthSupported=a,t.getRequestTimeout=u,t.prepareParams=c,t.handleResponse=l;var h=(n(5),n(13)),f=r(h),p=n(15),d=r(p)},function(e,t,n){"use strict";function r(){return h.default.PNChannelGroupsOperation}function i(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"}function s(e){return"/v1/channel-registration/sub-key/"+e.config.subscribeKey+"/channel-group"}function o(e){return e.config.getTransactionTimeout()}function a(){return!0}function u(){return{}}function c(e,t){return{groups:t.payload.groups}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=r,t.validateParams=i,t.getURL=s,t.getRequestTimeout=o,t.isAuthSupported=a,t.prepareParams=u,t.handleResponse=c;var l=(n(5),n(13)),h=function(e){return e&&e.__esModule?e:{default:e}}(l)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){return f.default.PNChannelsForGroupOperation}function s(e,t){var n=t.channelGroup,r=e.config;return n?r.subscribeKey?void 0:"Missing Subscribe Key":"Missing Channel Group"}function o(e,t){var n=t.channelGroup;return"/v1/channel-registration/sub-key/"+e.config.subscribeKey+"/channel-group/"+d.default.encodeString(n)}function a(e){return e.config.getTransactionTimeout()}function u(){return!0}function c(){return{}}function l(e,t){return{channels:t.payload.channels}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=i,t.validateParams=s,t.getURL=o,t.getRequestTimeout=a,t.isAuthSupported=u,t.prepareParams=c,t.handleResponse=l;var h=(n(5),n(13)),f=r(h),p=n(15),d=r(p)},function(e,t,n){"use strict";function r(){return h.default.PNPushNotificationEnabledChannelsOperation}function i(e,t){var n=t.device,r=t.pushGateway,i=t.channels,s=e.config;return n?r?i&&0!==i.length?s.subscribeKey?void 0:"Missing Subscribe Key":"Missing Channels":"Missing GW Type (pushGateway: gcm or apns)":"Missing Device ID (device)"}function s(e,t){var n=t.device;return"/v1/push/sub-key/"+e.config.subscribeKey+"/devices/"+n}function o(e){return e.config.getTransactionTimeout()}function a(){return!0}function u(e,t){var n=t.pushGateway,r=t.channels;return{type:n,add:(void 0===r?[]:r).join(",")}}function c(){return{}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=r,t.validateParams=i,t.getURL=s,t.getRequestTimeout=o,t.isAuthSupported=a,t.prepareParams=u,t.handleResponse=c;var l=(n(5),n(13)),h=function(e){return e&&e.__esModule?e:{default:e}}(l)},function(e,t,n){"use strict";function r(){return h.default.PNPushNotificationEnabledChannelsOperation}function i(e,t){var n=t.device,r=t.pushGateway,i=t.channels,s=e.config;return n?r?i&&0!==i.length?s.subscribeKey?void 0:"Missing Subscribe Key":"Missing Channels":"Missing GW Type (pushGateway: gcm or apns)":"Missing Device ID (device)"}function s(e,t){var n=t.device;return"/v1/push/sub-key/"+e.config.subscribeKey+"/devices/"+n}function o(e){return e.config.getTransactionTimeout()}function a(){return!0}function u(e,t){var n=t.pushGateway,r=t.channels;return{type:n,remove:(void 0===r?[]:r).join(",")}}function c(){return{}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=r,t.validateParams=i,t.getURL=s,t.getRequestTimeout=o,t.isAuthSupported=a,t.prepareParams=u,t.handleResponse=c;var l=(n(5),n(13)),h=function(e){return e&&e.__esModule?e:{default:e}}(l)},function(e,t,n){"use strict";function r(){return h.default.PNPushNotificationEnabledChannelsOperation}function i(e,t){var n=t.device,r=t.pushGateway,i=e.config;return n?r?i.subscribeKey?void 0:"Missing Subscribe Key":"Missing GW Type (pushGateway: gcm or apns)":"Missing Device ID (device)"}function s(e,t){var n=t.device;return"/v1/push/sub-key/"+e.config.subscribeKey+"/devices/"+n}function o(e){return e.config.getTransactionTimeout()}function a(){return!0}function u(e,t){return{type:t.pushGateway}}function c(e,t){return{channels:t}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=r,t.validateParams=i,t.getURL=s,t.getRequestTimeout=o,t.isAuthSupported=a,t.prepareParams=u,t.handleResponse=c;var l=(n(5),n(13)),h=function(e){return e&&e.__esModule?e:{default:e}}(l)},function(e,t,n){"use strict";function r(){return h.default.PNRemoveAllPushNotificationsOperation}function i(e,t){var n=t.device,r=t.pushGateway,i=e.config;return n?r?i.subscribeKey?void 0:"Missing Subscribe Key":"Missing GW Type (pushGateway: gcm or apns)":"Missing Device ID (device)"}function s(e,t){var n=t.device;return"/v1/push/sub-key/"+e.config.subscribeKey+"/devices/"+n+"/remove"}function o(e){return e.config.getTransactionTimeout()}function a(){return!0}function u(e,t){return{type:t.pushGateway}}function c(){return{}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=r,t.validateParams=i,t.getURL=s,t.getRequestTimeout=o,t.isAuthSupported=a,t.prepareParams=u,t.handleResponse=c;var l=(n(5),n(13)),h=function(e){return e&&e.__esModule?e:{default:e}}(l)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){return f.default.PNUnsubscribeOperation}function s(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"}function o(e,t){var n=e.config,r=t.channels,i=void 0===r?[]:r,s=i.length>0?i.join(","):",";return"/v2/presence/sub-key/"+n.subscribeKey+"/channel/"+d.default.encodeString(s)+"/leave"}function a(e){return e.config.getTransactionTimeout()}function u(){return!0}function c(e,t){var n=t.channelGroups,r=void 0===n?[]:n,i={};return r.length>0&&(i["channel-group"]=r.join(",")),i}function l(){return{}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=i,t.validateParams=s,t.getURL=o,t.getRequestTimeout=a,t.isAuthSupported=u,t.prepareParams=c,t.handleResponse=l;var h=(n(5),n(13)),f=r(h),p=n(15),d=r(p)},function(e,t,n){"use strict";function r(){return h.default.PNWhereNowOperation}function i(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"}function s(e,t){var n=e.config,r=t.uuid,i=void 0===r?n.UUID:r;return"/v2/presence/sub-key/"+n.subscribeKey+"/uuid/"+i}function o(e){return e.config.getTransactionTimeout()}function a(){return!0}function u(){return{}}function c(e,t){return t.payload?{channels:t.payload.channels}:{channels:[]}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=r,t.validateParams=i,t.getURL=s,t.getRequestTimeout=o,t.isAuthSupported=a,t.prepareParams=u,t.handleResponse=c;var l=(n(5),n(13)),h=function(e){return e&&e.__esModule?e:{default:e}}(l)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){return f.default.PNHeartbeatOperation}function s(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"}function o(e,t){var n=e.config,r=t.channels,i=void 0===r?[]:r,s=i.length>0?i.join(","):",";return"/v2/presence/sub-key/"+n.subscribeKey+"/channel/"+d.default.encodeString(s)+"/heartbeat"}function a(){return!0}function u(e){return e.config.getTransactionTimeout()}function c(e,t){var n=t.channelGroups,r=void 0===n?[]:n,i=t.state,s=void 0===i?{}:i,o=e.config,a={};return r.length>0&&(a["channel-group"]=r.join(",")),a.state=JSON.stringify(s),a.heartbeat=o.getPresenceTimeout(),a}function l(){return{}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=i,t.validateParams=s,t.getURL=o,t.isAuthSupported=a,t.getRequestTimeout=u,t.prepareParams=c,t.handleResponse=l;var h=(n(5),n(13)),f=r(h),p=n(15),d=r(p)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){return f.default.PNGetStateOperation}function s(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"}function o(e,t){var n=e.config,r=t.uuid,i=void 0===r?n.UUID:r,s=t.channels,o=void 0===s?[]:s,a=o.length>0?o.join(","):",";return"/v2/presence/sub-key/"+n.subscribeKey+"/channel/"+d.default.encodeString(a)+"/uuid/"+i}function a(e){return e.config.getTransactionTimeout()}function u(){return!0}function c(e,t){var n=t.channelGroups,r=void 0===n?[]:n,i={};return r.length>0&&(i["channel-group"]=r.join(",")),i}function l(e,t,n){var r=n.channels,i=void 0===r?[]:r,s=n.channelGroups,o=void 0===s?[]:s,a={};return 1===i.length&&0===o.length?a[i[0]]=t.payload:a=t.payload,{channels:a}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=i,t.validateParams=s,t.getURL=o,t.getRequestTimeout=a,t.isAuthSupported=u,t.prepareParams=c,t.handleResponse=l;var h=(n(5),n(13)),f=r(h),p=n(15),d=r(p)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){return f.default.PNSetStateOperation}function s(e,t){var n=e.config,r=t.state,i=t.channels,s=void 0===i?[]:i,o=t.channelGroups,a=void 0===o?[]:o;return r?n.subscribeKey?0===s.length&&0===a.length?"Please provide a list of channels and/or channel-groups":void 0:"Missing Subscribe Key":"Missing State"}function o(e,t){var n=e.config,r=t.channels,i=void 0===r?[]:r,s=i.length>0?i.join(","):",";return"/v2/presence/sub-key/"+n.subscribeKey+"/channel/"+d.default.encodeString(s)+"/uuid/"+n.UUID+"/data"}function a(e){return e.config.getTransactionTimeout()}function u(){return!0}function c(e,t){var n=t.state,r=t.channelGroups,i=void 0===r?[]:r,s={};return s.state=JSON.stringify(n),i.length>0&&(s["channel-group"]=i.join(",")),s}function l(e,t){return{state:t.payload}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=i,t.validateParams=s,t.getURL=o,t.getRequestTimeout=a,t.isAuthSupported=u,t.prepareParams=c,t.handleResponse=l;var h=(n(5),n(13)),f=r(h),p=n(15),d=r(p)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){return f.default.PNHereNowOperation}function s(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"}function o(e,t){var n=e.config,r=t.channels,i=void 0===r?[]:r,s=t.channelGroups,o=void 0===s?[]:s,a="/v2/presence/sub-key/"+n.subscribeKey;if(i.length>0||o.length>0){var u=i.length>0?i.join(","):",";a+="/channel/"+d.default.encodeString(u)}return a}function a(e){return e.config.getTransactionTimeout()}function u(){return!0}function c(e,t){var n=t.channelGroups,r=void 0===n?[]:n,i=t.includeUUIDs,s=void 0===i||i,o=t.includeState,a=void 0!==o&&o,u={};return s||(u.disable_uuids=1),a&&(u.state=1),r.length>0&&(u["channel-group"]=r.join(",")),u}function l(e,t,n){var r=n.channels,i=void 0===r?[]:r,s=n.channelGroups,o=void 0===s?[]:s,a=n.includeUUIDs,u=void 0===a||a,c=n.includeState,l=void 0!==c&&c;return i.length>1||o.length>0||0===o.length&&0===i.length?function(){var e={};return e.totalChannels=t.payload.total_channels,e.totalOccupancy=t.payload.total_occupancy,e.channels={},Object.keys(t.payload.channels).forEach(function(n){var r=t.payload.channels[n],i=[];return e.channels[n]={occupants:i,name:n,occupancy:r.occupancy},u&&r.uuids.forEach(function(e){l?i.push({state:e.state,uuid:e.uuid}):i.push({state:null,uuid:e})}),e}),e}():function(){var e={},n=[];return e.totalChannels=1,e.totalOccupancy=t.occupancy,e.channels={},e.channels[i[0]]={occupants:n,name:i[0],occupancy:t.occupancy},u&&t.uuids&&t.uuids.forEach(function(e){l?n.push({state:e.state,uuid:e.uuid}):n.push({state:null,uuid:e})}),e}()}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=i,t.validateParams=s,t.getURL=o,t.getRequestTimeout=a,t.isAuthSupported=u,t.prepareParams=c,t.handleResponse=l;var h=(n(5),n(13)),f=r(h),p=n(15),d=r(p)},function(e,t,n){"use strict";function r(){return h.default.PNAccessManagerAudit}function i(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"}function s(e){return"/v2/auth/audit/sub-key/"+e.config.subscribeKey}function o(e){return e.config.getTransactionTimeout()}function a(){return!1}function u(e,t){var n=t.channel,r=t.channelGroup,i=t.authKeys,s=void 0===i?[]:i,o={};return n&&(o.channel=n),r&&(o["channel-group"]=r),s.length>0&&(o.auth=s.join(",")),o}function c(e,t){return t.payload}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=r,t.validateParams=i,t.getURL=s,t.getRequestTimeout=o,t.isAuthSupported=a,t.prepareParams=u,t.handleResponse=c;var l=(n(5),n(13)),h=function(e){return e&&e.__esModule?e:{default:e}}(l)},function(e,t,n){"use strict";function r(){return h.default.PNAccessManagerGrant}function i(e){var t=e.config;return t.subscribeKey?t.publishKey?t.secretKey?void 0:"Missing Secret Key":"Missing Publish Key":"Missing Subscribe Key"}function s(e){return"/v2/auth/grant/sub-key/"+e.config.subscribeKey}function o(e){return e.config.getTransactionTimeout()}function a(){return!1}function u(e,t){var n=t.channels,r=void 0===n?[]:n,i=t.channelGroups,s=void 0===i?[]:i,o=t.ttl,a=t.read,u=void 0!==a&&a,c=t.write,l=void 0!==c&&c,h=t.manage,f=void 0!==h&&h,p=t.authKeys,d=void 0===p?[]:p,y={};return y.r=u?"1":"0",y.w=l?"1":"0",y.m=f?"1":"0",r.length>0&&(y.channel=r.join(",")),s.length>0&&(y["channel-group"]=s.join(",")),d.length>0&&(y.auth=d.join(",")),(o||0===o)&&(y.ttl=o),y}function c(){return{}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=r,t.validateParams=i,t.getURL=s,t.getRequestTimeout=o,
t.isAuthSupported=a,t.prepareParams=u,t.handleResponse=c;var l=(n(5),n(13)),h=function(e){return e&&e.__esModule?e:{default:e}}(l)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n=e.crypto,r=e.config,i=JSON.stringify(t);return r.cipherKey&&(i=n.encrypt(i),i=JSON.stringify(i)),i}function s(){return b.default.PNPublishOperation}function o(e,t){var n=e.config,r=t.message;return t.channel?r?n.subscribeKey?void 0:"Missing Subscribe Key":"Missing Message":"Missing Channel"}function a(e,t){var n=t.sendByPost;return void 0!==n&&n}function u(e,t){var n=e.config,r=t.channel,s=t.message,o=i(e,s);return"/publish/"+n.publishKey+"/"+n.subscribeKey+"/0/"+v.default.encodeString(r)+"/0/"+v.default.encodeString(o)}function c(e,t){var n=e.config,r=t.channel;return"/publish/"+n.publishKey+"/"+n.subscribeKey+"/0/"+v.default.encodeString(r)+"/0"}function l(e){return e.config.getTransactionTimeout()}function h(){return!0}function f(e,t){return i(e,t.message)}function p(e,t){var n=t.meta,r=t.replicate,i=void 0===r||r,s=t.storeInHistory,o=t.ttl,a={};return null!=s&&(a.store=s?"1":"0"),o&&(a.ttl=o),!1===i&&(a.norep="true"),n&&"object"===(void 0===n?"undefined":y(n))&&(a.meta=JSON.stringify(n)),a}function d(e,t){return{timetoken:t[2]}}Object.defineProperty(t,"__esModule",{value:!0});var y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.getOperation=s,t.validateParams=o,t.usePost=a,t.getURL=u,t.postURL=c,t.getRequestTimeout=l,t.isAuthSupported=h,t.postPayload=f,t.prepareParams=p,t.handleResponse=d;var g=(n(5),n(13)),b=r(g),_=n(15),v=r(_)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n=e.config,r=e.crypto;if(!n.cipherKey)return t;try{return r.decrypt(t)}catch(e){return t}}function s(){return p.default.PNHistoryOperation}function o(e,t){var n=t.channel,r=e.config;return n?r.subscribeKey?void 0:"Missing Subscribe Key":"Missing channel"}function a(e,t){var n=t.channel;return"/v2/history/sub-key/"+e.config.subscribeKey+"/channel/"+y.default.encodeString(n)}function u(e){return e.config.getTransactionTimeout()}function c(){return!0}function l(e,t){var n=t.start,r=t.end,i=t.reverse,s=t.count,o=void 0===s?100:s,a=t.stringifiedTimeToken,u=void 0!==a&&a,c={include_token:"true"};return c.count=o,n&&(c.start=n),r&&(c.end=r),u&&(c.string_message_token="true"),null!=i&&(c.reverse=i.toString()),c}function h(e,t){var n={messages:[],startTimeToken:t[1],endTimeToken:t[2]};return t[0].forEach(function(t){var r={timetoken:t.timetoken,entry:i(e,t.message)};n.messages.push(r)}),n}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=s,t.validateParams=o,t.getURL=a,t.getRequestTimeout=u,t.isAuthSupported=c,t.prepareParams=l,t.handleResponse=h;var f=(n(5),n(13)),p=r(f),d=n(15),y=r(d)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){return p.default.PNDeleteMessagesOperation}function s(e,t){var n=t.channel,r=e.config;return n?r.subscribeKey?void 0:"Missing Subscribe Key":"Missing channel"}function o(){return!0}function a(e,t){var n=t.channel;return"/v3/history/sub-key/"+e.config.subscribeKey+"/channel/"+y.default.encodeString(n)}function u(e){return e.config.getTransactionTimeout()}function c(){return!0}function l(e,t){var n=t.start,r=t.end,i={};return n&&(i.start=n),r&&(i.end=r),i}function h(e,t){return t.payload}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=i,t.validateParams=s,t.useDelete=o,t.getURL=a,t.getRequestTimeout=u,t.isAuthSupported=c,t.prepareParams=l,t.handleResponse=h;var f=(n(5),n(13)),p=r(f),d=n(15),y=r(d)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n=e.config,r=e.crypto;if(!n.cipherKey)return t;try{return r.decrypt(t)}catch(e){return t}}function s(){return p.default.PNFetchMessagesOperation}function o(e,t){var n=t.channels,r=e.config;return n&&0!==n.length?r.subscribeKey?void 0:"Missing Subscribe Key":"Missing channels"}function a(e,t){var n=t.channels,r=void 0===n?[]:n,i=e.config,s=r.length>0?r.join(","):",";return"/v3/history/sub-key/"+i.subscribeKey+"/channel/"+y.default.encodeString(s)}function u(e){return e.config.getTransactionTimeout()}function c(){return!0}function l(e,t){var n=t.start,r=t.end,i=t.count,s=t.stringifiedTimeToken,o=void 0!==s&&s,a={};return i&&(a.max=i),n&&(a.start=n),r&&(a.end=r),o&&(a.string_message_token="true"),a}function h(e,t){var n={channels:{}};return Object.keys(t.channels||{}).forEach(function(r){n.channels[r]=[],(t.channels[r]||[]).forEach(function(t){var s={};s.channel=r,s.subscription=null,s.timetoken=t.timetoken,s.message=i(e,t.message),n.channels[r].push(s)})}),n}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=s,t.validateParams=o,t.getURL=a,t.getRequestTimeout=u,t.isAuthSupported=c,t.prepareParams=l,t.handleResponse=h;var f=(n(5),n(13)),p=r(f),d=n(15),y=r(d)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){return f.default.PNSubscribeOperation}function s(e){if(!e.config.subscribeKey)return"Missing Subscribe Key"}function o(e,t){var n=e.config,r=t.channels,i=void 0===r?[]:r,s=i.length>0?i.join(","):",";return"/v2/subscribe/"+n.subscribeKey+"/"+d.default.encodeString(s)+"/0"}function a(e){return e.config.getSubscribeTimeout()}function u(){return!0}function c(e,t){var n=e.config,r=t.channelGroups,i=void 0===r?[]:r,s=t.timetoken,o=t.filterExpression,a=t.region,u={heartbeat:n.getPresenceTimeout()};return i.length>0&&(u["channel-group"]=i.join(",")),o&&o.length>0&&(u["filter-expr"]=o),s&&(u.tt=s),a&&(u.tr=a),u}function l(e,t){var n=[];t.m.forEach(function(e){var t={publishTimetoken:e.p.t,region:e.p.r},r={shard:parseInt(e.a,10),subscriptionMatch:e.b,channel:e.c,payload:e.d,flags:e.f,issuingClientId:e.i,subscribeKey:e.k,originationTimetoken:e.o,userMetadata:e.u,publishMetaData:t};n.push(r)});var r={timetoken:t.t.t,region:t.t.r};return{messages:n,metadata:r}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=i,t.validateParams=s,t.getURL=o,t.getRequestTimeout=a,t.isAuthSupported=u,t.prepareParams=c,t.handleResponse=l;var h=(n(5),n(13)),f=r(h),p=n(15),d=r(p)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(2),a=(r(o),n(10)),u=r(a),c=(n(5),function(){function e(t){var n=this;i(this,e),this._modules={},Object.keys(t).forEach(function(e){n._modules[e]=t[e].bind(n)})}return s(e,[{key:"init",value:function(e){this._config=e,this._maxSubDomain=20,this._currentSubDomain=Math.floor(Math.random()*this._maxSubDomain),this._providedFQDN=(this._config.secure?"https://":"http://")+this._config.origin,this._coreParams={},this.shiftStandardOrigin()}},{key:"nextOrigin",value:function(){if(-1===this._providedFQDN.indexOf("pubsub."))return this._providedFQDN;var e=void 0;return this._currentSubDomain=this._currentSubDomain+1,this._currentSubDomain>=this._maxSubDomain&&(this._currentSubDomain=1),e=this._currentSubDomain.toString(),this._providedFQDN.replace("pubsub","ps"+e)}},{key:"hasModule",value:function(e){return e in this._modules}},{key:"shiftStandardOrigin",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._standardOrigin=this.nextOrigin(e),this._standardOrigin}},{key:"getStandardOrigin",value:function(){return this._standardOrigin}},{key:"POST",value:function(e,t,n,r){return this._modules.post(e,t,n,r)}},{key:"GET",value:function(e,t,n){return this._modules.get(e,t,n)}},{key:"DELETE",value:function(e,t,n){return this._modules.del(e,t,n)}},{key:"_detectErrorCategory",value:function(e){if("ENOTFOUND"===e.code)return u.default.PNNetworkIssuesCategory;if("ECONNREFUSED"===e.code)return u.default.PNNetworkIssuesCategory;if("ECONNRESET"===e.code)return u.default.PNNetworkIssuesCategory;if("EAI_AGAIN"===e.code)return u.default.PNNetworkIssuesCategory;if(0===e.status||e.hasOwnProperty("status")&&void 0===e.status)return u.default.PNNetworkIssuesCategory;if(e.timeout)return u.default.PNTimeoutCategory;if("ETIMEDOUT"===e.code)return u.default.PNNetworkIssuesCategory;if(e.response){if(e.response.badRequest)return u.default.PNBadRequestCategory;if(e.response.forbidden)return u.default.PNAccessDeniedCategory}return u.default.PNUnknownCategory}}]),e}());t.default=c,e.exports=t.default},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={get:function(e){try{return localStorage.getItem(e)}catch(e){return null}},set:function(e,t){try{return localStorage.setItem(e,t)}catch(e){return null}}},e.exports=t.default},function(e,t,n){"use strict";function r(e){var t=(new Date).getTime(),n=(new Date).toISOString(),r=function(){return console&&console.log?console:window&&window.console&&window.console.log?window.console:console}();r.log("<<<<<"),r.log("["+n+"]","\n",e.url,"\n",e.qs),r.log("-----"),e.on("response",function(n){var i=(new Date).getTime(),s=i-t,o=(new Date).toISOString();r.log(">>>>>>"),r.log("["+o+" / "+s+"]","\n",e.url,"\n",e.qs,"\n",n.text),r.log("-----")})}function i(e,t,n){var i=this;return this._config.logVerbosity&&(e=e.use(r)),this._config.proxy&&this._modules.proxy&&(e=this._modules.proxy.call(this,e)),this._config.keepAlive&&this._modules.keepAlive&&(e=this._modules.keepAlive(e)),e.timeout(t.timeout).end(function(e,r){var s={};if(s.error=null!==e,s.operation=t.operation,r&&r.status&&(s.statusCode=r.status),e){if(e.response&&e.response.text&&!i._config.logVerbosity)try{s.errorData=JSON.parse(e.response.text)}catch(t){s.errorData=e}else s.errorData=e;return s.category=i._detectErrorCategory(e),n(s,null)}var o=JSON.parse(r.text);return o.error&&1===o.error&&o.status&&o.message&&o.service?(s.errorData=o,s.statusCode=o.status,s.error=!0,s.category=i._detectErrorCategory(s),n(s,null)):n(s,o)})}function s(e,t,n){var r=c.default.get(this.getStandardOrigin()+t.url).query(e);return i.call(this,r,t,n)}function o(e,t,n,r){var s=c.default.post(this.getStandardOrigin()+n.url).query(e).send(t);return i.call(this,s,n,r)}function a(e,t,n){var r=c.default.delete(this.getStandardOrigin()+t.url).query(e);return i.call(this,r,t,n)}Object.defineProperty(t,"__esModule",{value:!0}),t.get=s,t.post=o,t.del=a;var u=n(42),c=function(e){return e&&e.__esModule?e:{default:e}}(u);n(5)},function(e,t,n){function r(){}function i(e){if(!y(e))return e;var t=[];for(var n in e)s(t,n,e[n]);return t.join("&")}function s(e,t,n){if(null!=n)if(Array.isArray(n))n.forEach(function(n){s(e,t,n)});else if(y(n))for(var r in n)s(e,t+"["+r+"]",n[r]);else e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));else null===n&&e.push(encodeURIComponent(t))}function o(e){for(var t,n,r={},i=e.split("&"),s=0,o=i.length;s<o;++s)t=i[s],n=t.indexOf("="),-1==n?r[decodeURIComponent(t)]="":r[decodeURIComponent(t.slice(0,n))]=decodeURIComponent(t.slice(n+1));return r}function a(e){for(var t,n,r,i,s=e.split(/\r?\n/),o={},a=0,u=s.length;a<u;++a)n=s[a],-1!==(t=n.indexOf(":"))&&(r=n.slice(0,t).toLowerCase(),i=v(n.slice(t+1)),o[r]=i);return o}function u(e){return/[\/+]json($|[^-\w])/.test(e)}function c(e){this.req=e,this.xhr=this.req.xhr,this.text="HEAD"!=this.req.method&&(""===this.xhr.responseType||"text"===this.xhr.responseType)||void 0===this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;var t=this.xhr.status;1223===t&&(t=204),this._setStatusProperties(t),this.header=this.headers=a(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this._setHeaderProperties(this.header),null===this.text&&e._responseType?this.body=this.xhr.response:this.body="HEAD"!=this.req.method?this._parseBody(this.text?this.text:this.xhr.response):null}function l(e,t){var n=this;this._query=this._query||[],this.method=e,this.url=t,this.header={},this._header={},this.on("end",function(){var e=null,t=null;try{t=new c(n)}catch(t){return e=new Error("Parser is unable to parse the response"),e.parse=!0,e.original=t,n.xhr?(e.rawResponse=void 0===n.xhr.responseType?n.xhr.responseText:n.xhr.response,e.status=n.xhr.status?n.xhr.status:null,e.statusCode=e.status):(e.rawResponse=null,e.status=null),n.callback(e)}n.emit("response",t);var r;try{n._isResponseOK(t)||(r=new Error(t.statusText||"Unsuccessful HTTP response"))}catch(e){r=e}r?(r.original=e,r.response=t,r.status=t.status,n.callback(r,t)):n.callback(null,t)})}function h(e,t,n){var r=_("DELETE",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}var f;"undefined"!=typeof window?f=window:"undefined"!=typeof self?f=self:(console.warn("Using browser-only version of superagent in non-browser environment"),f=this);var p=n(43),d=n(44),y=n(45),g=n(46),b=n(48),_=t=e.exports=function(e,n){return"function"==typeof n?new t.Request("GET",e).end(n):1==arguments.length?new t.Request("GET",e):new t.Request(e,n)};t.Request=l,_.getXHR=function(){if(!(!f.XMLHttpRequest||f.location&&"file:"==f.location.protocol&&f.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}throw Error("Browser-only version of superagent could not find XHR")};var v="".trim?function(e){return e.trim()}:function(e){return e.replace(/(^\s*|\s*$)/g,"")};_.serializeObject=i,_.parseString=o,_.types={html:"text/html",json:"application/json",xml:"text/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},_.serialize={"application/x-www-form-urlencoded":i,"application/json":JSON.stringify},_.parse={"application/x-www-form-urlencoded":o,"application/json":JSON.parse},g(c.prototype),c.prototype._parseBody=function(e){var t=_.parse[this.type];return this.req._parser?this.req._parser(this,e):(!t&&u(this.type)&&(t=_.parse["application/json"]),t&&e&&(e.length||e instanceof Object)?t(e):null)},c.prototype.toError=function(){var e=this.req,t=e.method,n=e.url,r="cannot "+t+" "+n+" ("+this.status+")",i=new Error(r);return i.status=this.status,i.method=t,i.url=n,i},_.Response=c,p(l.prototype),d(l.prototype),l.prototype.type=function(e){return this.set("Content-Type",_.types[e]||e),this},l.prototype.accept=function(e){return this.set("Accept",_.types[e]||e),this},l.prototype.auth=function(e,t,n){1===arguments.length&&(t=""),"object"==typeof t&&null!==t&&(n=t,t=""),n||(n={type:"function"==typeof btoa?"basic":"auto"});var r=function(e){if("function"==typeof btoa)return btoa(e);throw new Error("Cannot use basic auth, btoa is not a function")};return this._auth(e,t,n,r)},l.prototype.query=function(e){return"string"!=typeof e&&(e=i(e)),e&&this._query.push(e),this},l.prototype.attach=function(e,t,n){if(t){if(this._data)throw Error("superagent can't mix .send() and .attach()");this._getFormData().append(e,t,n||t.name)}return this},l.prototype._getFormData=function(){return this._formData||(this._formData=new f.FormData),this._formData},l.prototype.callback=function(e,t){if(this._shouldRetry(e,t))return this._retry();var n=this._callback;this.clearTimeout(),e&&(this._maxRetries&&(e.retries=this._retries-1),this.emit("error",e)),n(e,t)},l.prototype.crossDomainError=function(){var e=new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");e.crossDomain=!0,e.status=this.status,e.method=this.method,e.url=this.url,this.callback(e)},l.prototype.buffer=l.prototype.ca=l.prototype.agent=function(){return console.warn("This is not supported in browser version of superagent"),this},l.prototype.pipe=l.prototype.write=function(){throw Error("Streaming is not supported in browser version of superagent")},l.prototype._isHost=function(e){return e&&"object"==typeof e&&!Array.isArray(e)&&"[object Object]"!==Object.prototype.toString.call(e)},l.prototype.end=function(e){return this._endCalled&&console.warn("Warning: .end() was called twice. This is not supported in superagent"),this._endCalled=!0,this._callback=e||r,this._finalizeQueryString(),this._end()},l.prototype._end=function(){var e=this,t=this.xhr=_.getXHR(),n=this._formData||this._data;this._setTimeouts(),t.onreadystatechange=function(){var n=t.readyState;if(n>=2&&e._responseTimeoutTimer&&clearTimeout(e._responseTimeoutTimer),4==n){var r;try{r=t.status}catch(e){r=0}if(!r){if(e.timedout||e._aborted)return;return e.crossDomainError()}e.emit("end")}};var r=function(t,n){n.total>0&&(n.percent=n.loaded/n.total*100),n.direction=t,e.emit("progress",n)};if(this.hasListeners("progress"))try{t.onprogress=r.bind(null,"download"),t.upload&&(t.upload.onprogress=r.bind(null,"upload"))}catch(e){}try{this.username&&this.password?t.open(this.method,this.url,!0,this.username,this.password):t.open(this.method,this.url,!0)}catch(e){return this.callback(e)}if(this._withCredentials&&(t.withCredentials=!0),!this._formData&&"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof n&&!this._isHost(n)){var i=this._header["content-type"],s=this._serializer||_.serialize[i?i.split(";")[0]:""];!s&&u(i)&&(s=_.serialize["application/json"]),s&&(n=s(n))}for(var o in this.header)null!=this.header[o]&&this.header.hasOwnProperty(o)&&t.setRequestHeader(o,this.header[o]);return this._responseType&&(t.responseType=this._responseType),this.emit("request",this),t.send(void 0!==n?n:null),this},_.agent=function(){return new b},["GET","POST","OPTIONS","PATCH","PUT","DELETE"].forEach(function(e){b.prototype[e.toLowerCase()]=function(t,n){var r=new _.Request(e,t);return this._setDefaults(r),n&&r.end(n),r}}),b.prototype.del=b.prototype.delete,_.get=function(e,t,n){var r=_("GET",e);return"function"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},_.head=function(e,t,n){var r=_("HEAD",e);return"function"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},_.options=function(e,t,n){var r=_("OPTIONS",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},_.del=h,_.delete=h,_.patch=function(e,t,n){var r=_("PATCH",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},_.post=function(e,t,n){var r=_("POST",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},_.put=function(e,t,n){var r=_("PUT",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}},function(e,t,n){function r(e){if(e)return i(e)}function i(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}e.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var r,i=0;i<n.length;i++)if((r=n[i])===t||r.fn===t){n.splice(i,1);break}return this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n){n=n.slice(0);for(var r=0,i=n.length;r<i;++r)n[r].apply(this,t)}return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){"use strict";function r(e){if(e)return i(e)}function i(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}var s=n(45);e.exports=r,r.prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,this},r.prototype.parse=function(e){return this._parser=e,this},r.prototype.responseType=function(e){return this._responseType=e,this},r.prototype.serialize=function(e){return this._serializer=e,this},r.prototype.timeout=function(e){if(!e||"object"!=typeof e)return this._timeout=e,this._responseTimeout=0,this;for(var t in e)switch(t){case"deadline":this._timeout=e.deadline;break;case"response":this._responseTimeout=e.response;break;default:console.warn("Unknown timeout option",t)}return this},r.prototype.retry=function(e,t){return 0!==arguments.length&&!0!==e||(e=1),e<=0&&(e=0),this._maxRetries=e,this._retries=0,this._retryCallback=t,this};var o=["ECONNRESET","ETIMEDOUT","EADDRINFO","ESOCKETTIMEDOUT"];r.prototype._shouldRetry=function(e,t){if(!this._maxRetries||this._retries++>=this._maxRetries)return!1;if(this._retryCallback)try{var n=this._retryCallback(e,t);if(!0===n)return!0;if(!1===n)return!1}catch(e){console.error(e)}if(t&&t.status&&t.status>=500&&501!=t.status)return!0;if(e){if(e.code&&~o.indexOf(e.code))return!0;if(e.timeout&&"ECONNABORTED"==e.code)return!0;if(e.crossDomain)return!0}return!1},r.prototype._retry=function(){return this.clearTimeout(),this.req&&(this.req=null,this.req=this.request()),this._aborted=!1,this.timedout=!1,this._end()},r.prototype.then=function(e,t){if(!this._fullfilledPromise){var n=this;this._endCalled&&console.warn("Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises"),this._fullfilledPromise=new Promise(function(e,t){n.end(function(n,r){n?t(n):e(r)})})}return this._fullfilledPromise.then(e,t)},r.prototype.catch=function(e){return this.then(void 0,e)},r.prototype.use=function(e){return e(this),this},r.prototype.ok=function(e){if("function"!=typeof e)throw Error("Callback required");return this._okCallback=e,this},r.prototype._isResponseOK=function(e){return!!e&&(this._okCallback?this._okCallback(e):e.status>=200&&e.status<300)},r.prototype.get=function(e){return this._header[e.toLowerCase()]},r.prototype.getHeader=r.prototype.get,r.prototype.set=function(e,t){if(s(e)){for(var n in e)this.set(n,e[n]);return this}return this._header[e.toLowerCase()]=t,this.header[e]=t,this},r.prototype.unset=function(e){return delete this._header[e.toLowerCase()],delete this.header[e],this},r.prototype.field=function(e,t){if(null===e||void 0===e)throw new Error(".field(name, val) name can not be empty");if(this._data&&console.error(".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()"),s(e)){for(var n in e)this.field(n,e[n]);return this}if(Array.isArray(t)){for(var r in t)this.field(e,t[r]);return this}if(null===t||void 0===t)throw new Error(".field(name, val) val can not be empty");return"boolean"==typeof t&&(t=""+t),this._getFormData().append(e,t),this},r.prototype.abort=function(){return this._aborted?this:(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req&&this.req.abort(),this.clearTimeout(),this.emit("abort"),this)},r.prototype._auth=function(e,t,n,r){switch(n.type){case"basic":this.set("Authorization","Basic "+r(e+":"+t));break;case"auto":this.username=e,this.password=t;break;case"bearer":this.set("Authorization","Bearer "+e)}return this},r.prototype.withCredentials=function(e){return void 0==e&&(e=!0),this._withCredentials=e,this},r.prototype.redirects=function(e){return this._maxRedirects=e,this},r.prototype.maxResponseSize=function(e){if("number"!=typeof e)throw TypeError("Invalid argument");return this._maxResponseSize=e,this},r.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},r.prototype.send=function(e){var t=s(e),n=this._header["content-type"];if(this._formData&&console.error(".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()"),t&&!this._data)Array.isArray(e)?this._data=[]:this._isHost(e)||(this._data={});else if(e&&this._data&&this._isHost(this._data))throw Error("Can't merge these send calls");if(t&&s(this._data))for(var r in e)this._data[r]=e[r];else"string"==typeof e?(n||this.type("form"),n=this._header["content-type"],this._data="application/x-www-form-urlencoded"==n?this._data?this._data+"&"+e:e:(this._data||"")+e):this._data=e;return!t||this._isHost(e)?this:(n||this.type("json"),this)},r.prototype.sortQuery=function(e){return this._sort=void 0===e||e,this},r.prototype._finalizeQueryString=function(){var e=this._query.join("&");if(e&&(this.url+=(this.url.indexOf("?")>=0?"&":"?")+e),this._query.length=0,this._sort){var t=this.url.indexOf("?");if(t>=0){var n=this.url.substring(t+1).split("&");"function"==typeof this._sort?n.sort(this._sort):n.sort(),this.url=this.url.substring(0,t)+"?"+n.join("&")}}},r.prototype._appendQueryString=function(){console.trace("Unsupported")},r.prototype._timeoutError=function(e,t,n){if(!this._aborted){var r=new Error(e+t+"ms exceeded");r.timeout=t,r.code="ECONNABORTED",r.errno=n,this.timedout=!0,this.abort(),this.callback(r)}},r.prototype._setTimeouts=function(){var e=this;this._timeout&&!this._timer&&(this._timer=setTimeout(function(){e._timeoutError("Timeout of ",e._timeout,"ETIME")},this._timeout)),this._responseTimeout&&!this._responseTimeoutTimer&&(this._responseTimeoutTimer=setTimeout(function(){e._timeoutError("Response timeout of ",e._responseTimeout,"ETIMEDOUT")},this._responseTimeout))}},function(e,t){"use strict";function n(e){return null!==e&&"object"==typeof e}e.exports=n},function(e,t,n){"use strict";function r(e){if(e)return i(e)}function i(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}var s=n(47);e.exports=r,r.prototype.get=function(e){return this.header[e.toLowerCase()]},r.prototype._setHeaderProperties=function(e){var t=e["content-type"]||"";this.type=s.type(t);var n=s.params(t);for(var r in n)this[r]=n[r];this.links={};try{e.link&&(this.links=s.parseLinks(e.link))}catch(e){}},r.prototype._setStatusProperties=function(e){var t=e/100|0;this.status=this.statusCode=e,this.statusType=t,this.info=1==t,this.ok=2==t,this.redirect=3==t,this.clientError=4==t,this.serverError=5==t,this.error=(4==t||5==t)&&this.toError(),this.accepted=202==e,this.noContent=204==e,this.badRequest=400==e,this.unauthorized=401==e,this.notAcceptable=406==e,this.forbidden=403==e,this.notFound=404==e}},function(e,t){"use strict";t.type=function(e){return e.split(/ *; */).shift()},t.params=function(e){return e.split(/ *; */).reduce(function(e,t){var n=t.split(/ *= */),r=n.shift(),i=n.shift();return r&&i&&(e[r]=i),e},{})},t.parseLinks=function(e){return e.split(/ *, */).reduce(function(e,t){var n=t.split(/ *; */),r=n[0].slice(1,-1);return e[n[1].split(/ *= */)[1].slice(1,-1)]=r,e},{})},t.cleanHeader=function(e,t){return delete e["content-type"],delete e["content-length"],delete e["transfer-encoding"],delete e.host,t&&(delete e.authorization,delete e.cookie),e}},function(e,t){function n(){this._defaults=[]}["use","on","once","set","query","type","accept","auth","withCredentials","sortQuery","retry","ok","redirects","timeout","buffer","serialize","parse","ca","key","pfx","cert"].forEach(function(e){n.prototype[e]=function(){return this._defaults.push({fn:e,arguments:arguments}),this}}),n.prototype._setDefaults=function(e){this._defaults.forEach(function(t){e[t.fn].apply(e,t.arguments)})},e.exports=n}])});

/***/ }),

/***/ "./node_modules/querystring-es3/decode.js":
/*!************************************************!*\
  !*** ./node_modules/querystring-es3/decode.js ***!
  \************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.



// If obj.hasOwnProperty has been overridden, then calling
// obj.hasOwnProperty(prop) will break.
// See: https://github.com/joyent/node/issues/1707
function hasOwnProperty(obj, prop) {
  return Object.prototype.hasOwnProperty.call(obj, prop);
}

module.exports = function(qs, sep, eq, options) {
  sep = sep || '&';
  eq = eq || '=';
  var obj = {};

  if (typeof qs !== 'string' || qs.length === 0) {
    return obj;
  }

  var regexp = /\+/g;
  qs = qs.split(sep);

  var maxKeys = 1000;
  if (options && typeof options.maxKeys === 'number') {
    maxKeys = options.maxKeys;
  }

  var len = qs.length;
  // maxKeys <= 0 means that we should not limit keys count
  if (maxKeys > 0 && len > maxKeys) {
    len = maxKeys;
  }

  for (var i = 0; i < len; ++i) {
    var x = qs[i].replace(regexp, '%20'),
        idx = x.indexOf(eq),
        kstr, vstr, k, v;

    if (idx >= 0) {
      kstr = x.substr(0, idx);
      vstr = x.substr(idx + 1);
    } else {
      kstr = x;
      vstr = '';
    }

    k = decodeURIComponent(kstr);
    v = decodeURIComponent(vstr);

    if (!hasOwnProperty(obj, k)) {
      obj[k] = v;
    } else if (isArray(obj[k])) {
      obj[k].push(v);
    } else {
      obj[k] = [obj[k], v];
    }
  }

  return obj;
};

var isArray = Array.isArray || function (xs) {
  return Object.prototype.toString.call(xs) === '[object Array]';
};


/***/ }),

/***/ "./node_modules/querystring-es3/encode.js":
/*!************************************************!*\
  !*** ./node_modules/querystring-es3/encode.js ***!
  \************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.



var stringifyPrimitive = function(v) {
  switch (typeof v) {
    case 'string':
      return v;

    case 'boolean':
      return v ? 'true' : 'false';

    case 'number':
      return isFinite(v) ? v : '';

    default:
      return '';
  }
};

module.exports = function(obj, sep, eq, name) {
  sep = sep || '&';
  eq = eq || '=';
  if (obj === null) {
    obj = undefined;
  }

  if (typeof obj === 'object') {
    return map(objectKeys(obj), function(k) {
      var ks = encodeURIComponent(stringifyPrimitive(k)) + eq;
      if (isArray(obj[k])) {
        return map(obj[k], function(v) {
          return ks + encodeURIComponent(stringifyPrimitive(v));
        }).join(sep);
      } else {
        return ks + encodeURIComponent(stringifyPrimitive(obj[k]));
      }
    }).join(sep);

  }

  if (!name) return '';
  return encodeURIComponent(stringifyPrimitive(name)) + eq +
         encodeURIComponent(stringifyPrimitive(obj));
};

var isArray = Array.isArray || function (xs) {
  return Object.prototype.toString.call(xs) === '[object Array]';
};

function map (xs, f) {
  if (xs.map) return xs.map(f);
  var res = [];
  for (var i = 0; i < xs.length; i++) {
    res.push(f(xs[i], i));
  }
  return res;
}

var objectKeys = Object.keys || function (obj) {
  var res = [];
  for (var key in obj) {
    if (Object.prototype.hasOwnProperty.call(obj, key)) res.push(key);
  }
  return res;
};


/***/ }),

/***/ "./node_modules/querystring-es3/index.js":
/*!***********************************************!*\
  !*** ./node_modules/querystring-es3/index.js ***!
  \***********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


exports.decode = exports.parse = __webpack_require__(/*! ./decode */ "./node_modules/querystring-es3/decode.js");
exports.encode = exports.stringify = __webpack_require__(/*! ./encode */ "./node_modules/querystring-es3/encode.js");


/***/ }),

/***/ "./node_modules/regenerator-runtime/runtime-module.js":
/*!************************************************************!*\
  !*** ./node_modules/regenerator-runtime/runtime-module.js ***!
  \************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

/**
 * Copyright (c) 2014-present, Facebook, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */

// This method of obtaining a reference to the global object needs to be
// kept identical to the way it is obtained in runtime.js
var g = (function() {
  return this || (typeof self === "object" && self);
})() || Function("return this")();

// Use `getOwnPropertyNames` because not all browsers support calling
// `hasOwnProperty` on the global `self` object in a worker. See #183.
var hadRuntime = g.regeneratorRuntime &&
  Object.getOwnPropertyNames(g).indexOf("regeneratorRuntime") >= 0;

// Save the old regeneratorRuntime in case it needs to be restored later.
var oldRuntime = hadRuntime && g.regeneratorRuntime;

// Force reevalutation of runtime.js.
g.regeneratorRuntime = undefined;

module.exports = __webpack_require__(/*! ./runtime */ "./node_modules/regenerator-runtime/runtime.js");

if (hadRuntime) {
  // Restore the original runtime.
  g.regeneratorRuntime = oldRuntime;
} else {
  // Remove the global property added by runtime.js.
  try {
    delete g.regeneratorRuntime;
  } catch(e) {
    g.regeneratorRuntime = undefined;
  }
}


/***/ }),

/***/ "./node_modules/regenerator-runtime/runtime.js":
/*!*****************************************************!*\
  !*** ./node_modules/regenerator-runtime/runtime.js ***!
  \*****************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

/**
 * Copyright (c) 2014-present, Facebook, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */

!(function(global) {
  "use strict";

  var Op = Object.prototype;
  var hasOwn = Op.hasOwnProperty;
  var undefined; // More compressible than void 0.
  var $Symbol = typeof Symbol === "function" ? Symbol : {};
  var iteratorSymbol = $Symbol.iterator || "@@iterator";
  var asyncIteratorSymbol = $Symbol.asyncIterator || "@@asyncIterator";
  var toStringTagSymbol = $Symbol.toStringTag || "@@toStringTag";

  var inModule = typeof module === "object";
  var runtime = global.regeneratorRuntime;
  if (runtime) {
    if (inModule) {
      // If regeneratorRuntime is defined globally and we're in a module,
      // make the exports object identical to regeneratorRuntime.
      module.exports = runtime;
    }
    // Don't bother evaluating the rest of this file if the runtime was
    // already defined globally.
    return;
  }

  // Define the runtime globally (as expected by generated code) as either
  // module.exports (if we're in a module) or a new, empty object.
  runtime = global.regeneratorRuntime = inModule ? module.exports : {};

  function wrap(innerFn, outerFn, self, tryLocsList) {
    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.
    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;
    var generator = Object.create(protoGenerator.prototype);
    var context = new Context(tryLocsList || []);

    // The ._invoke method unifies the implementations of the .next,
    // .throw, and .return methods.
    generator._invoke = makeInvokeMethod(innerFn, self, context);

    return generator;
  }
  runtime.wrap = wrap;

  // Try/catch helper to minimize deoptimizations. Returns a completion
  // record like context.tryEntries[i].completion. This interface could
  // have been (and was previously) designed to take a closure to be
  // invoked without arguments, but in all the cases we care about we
  // already have an existing method we want to call, so there's no need
  // to create a new function object. We can even get away with assuming
  // the method takes exactly one argument, since that happens to be true
  // in every case, so we don't have to touch the arguments object. The
  // only additional allocation required is the completion record, which
  // has a stable shape and so hopefully should be cheap to allocate.
  function tryCatch(fn, obj, arg) {
    try {
      return { type: "normal", arg: fn.call(obj, arg) };
    } catch (err) {
      return { type: "throw", arg: err };
    }
  }

  var GenStateSuspendedStart = "suspendedStart";
  var GenStateSuspendedYield = "suspendedYield";
  var GenStateExecuting = "executing";
  var GenStateCompleted = "completed";

  // Returning this object from the innerFn has the same effect as
  // breaking out of the dispatch switch statement.
  var ContinueSentinel = {};

  // Dummy constructor functions that we use as the .constructor and
  // .constructor.prototype properties for functions that return Generator
  // objects. For full spec compliance, you may wish to configure your
  // minifier not to mangle the names of these two functions.
  function Generator() {}
  function GeneratorFunction() {}
  function GeneratorFunctionPrototype() {}

  // This is a polyfill for %IteratorPrototype% for environments that
  // don't natively support it.
  var IteratorPrototype = {};
  IteratorPrototype[iteratorSymbol] = function () {
    return this;
  };

  var getProto = Object.getPrototypeOf;
  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));
  if (NativeIteratorPrototype &&
      NativeIteratorPrototype !== Op &&
      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {
    // This environment has a native %IteratorPrototype%; use it instead
    // of the polyfill.
    IteratorPrototype = NativeIteratorPrototype;
  }

  var Gp = GeneratorFunctionPrototype.prototype =
    Generator.prototype = Object.create(IteratorPrototype);
  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;
  GeneratorFunctionPrototype.constructor = GeneratorFunction;
  GeneratorFunctionPrototype[toStringTagSymbol] =
    GeneratorFunction.displayName = "GeneratorFunction";

  // Helper for defining the .next, .throw, and .return methods of the
  // Iterator interface in terms of a single ._invoke method.
  function defineIteratorMethods(prototype) {
    ["next", "throw", "return"].forEach(function(method) {
      prototype[method] = function(arg) {
        return this._invoke(method, arg);
      };
    });
  }

  runtime.isGeneratorFunction = function(genFun) {
    var ctor = typeof genFun === "function" && genFun.constructor;
    return ctor
      ? ctor === GeneratorFunction ||
        // For the native GeneratorFunction constructor, the best we can
        // do is to check its .name property.
        (ctor.displayName || ctor.name) === "GeneratorFunction"
      : false;
  };

  runtime.mark = function(genFun) {
    if (Object.setPrototypeOf) {
      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);
    } else {
      genFun.__proto__ = GeneratorFunctionPrototype;
      if (!(toStringTagSymbol in genFun)) {
        genFun[toStringTagSymbol] = "GeneratorFunction";
      }
    }
    genFun.prototype = Object.create(Gp);
    return genFun;
  };

  // Within the body of any async function, `await x` is transformed to
  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test
  // `hasOwn.call(value, "__await")` to determine if the yielded value is
  // meant to be awaited.
  runtime.awrap = function(arg) {
    return { __await: arg };
  };

  function AsyncIterator(generator) {
    function invoke(method, arg, resolve, reject) {
      var record = tryCatch(generator[method], generator, arg);
      if (record.type === "throw") {
        reject(record.arg);
      } else {
        var result = record.arg;
        var value = result.value;
        if (value &&
            typeof value === "object" &&
            hasOwn.call(value, "__await")) {
          return Promise.resolve(value.__await).then(function(value) {
            invoke("next", value, resolve, reject);
          }, function(err) {
            invoke("throw", err, resolve, reject);
          });
        }

        return Promise.resolve(value).then(function(unwrapped) {
          // When a yielded Promise is resolved, its final value becomes
          // the .value of the Promise<{value,done}> result for the
          // current iteration.
          result.value = unwrapped;
          resolve(result);
        }, function(error) {
          // If a rejected Promise was yielded, throw the rejection back
          // into the async generator function so it can be handled there.
          return invoke("throw", error, resolve, reject);
        });
      }
    }

    var previousPromise;

    function enqueue(method, arg) {
      function callInvokeWithMethodAndArg() {
        return new Promise(function(resolve, reject) {
          invoke(method, arg, resolve, reject);
        });
      }

      return previousPromise =
        // If enqueue has been called before, then we want to wait until
        // all previous Promises have been resolved before calling invoke,
        // so that results are always delivered in the correct order. If
        // enqueue has not been called before, then it is important to
        // call invoke immediately, without waiting on a callback to fire,
        // so that the async generator function has the opportunity to do
        // any necessary setup in a predictable way. This predictability
        // is why the Promise constructor synchronously invokes its
        // executor callback, and why async functions synchronously
        // execute code before the first await. Since we implement simple
        // async functions in terms of async generators, it is especially
        // important to get this right, even though it requires care.
        previousPromise ? previousPromise.then(
          callInvokeWithMethodAndArg,
          // Avoid propagating failures to Promises returned by later
          // invocations of the iterator.
          callInvokeWithMethodAndArg
        ) : callInvokeWithMethodAndArg();
    }

    // Define the unified helper method that is used to implement .next,
    // .throw, and .return (see defineIteratorMethods).
    this._invoke = enqueue;
  }

  defineIteratorMethods(AsyncIterator.prototype);
  AsyncIterator.prototype[asyncIteratorSymbol] = function () {
    return this;
  };
  runtime.AsyncIterator = AsyncIterator;

  // Note that simple async functions are implemented on top of
  // AsyncIterator objects; they just return a Promise for the value of
  // the final result produced by the iterator.
  runtime.async = function(innerFn, outerFn, self, tryLocsList) {
    var iter = new AsyncIterator(
      wrap(innerFn, outerFn, self, tryLocsList)
    );

    return runtime.isGeneratorFunction(outerFn)
      ? iter // If outerFn is a generator, return the full iterator.
      : iter.next().then(function(result) {
          return result.done ? result.value : iter.next();
        });
  };

  function makeInvokeMethod(innerFn, self, context) {
    var state = GenStateSuspendedStart;

    return function invoke(method, arg) {
      if (state === GenStateExecuting) {
        throw new Error("Generator is already running");
      }

      if (state === GenStateCompleted) {
        if (method === "throw") {
          throw arg;
        }

        // Be forgiving, per 25.3.3.3.3 of the spec:
        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume
        return doneResult();
      }

      context.method = method;
      context.arg = arg;

      while (true) {
        var delegate = context.delegate;
        if (delegate) {
          var delegateResult = maybeInvokeDelegate(delegate, context);
          if (delegateResult) {
            if (delegateResult === ContinueSentinel) continue;
            return delegateResult;
          }
        }

        if (context.method === "next") {
          // Setting context._sent for legacy support of Babel's
          // function.sent implementation.
          context.sent = context._sent = context.arg;

        } else if (context.method === "throw") {
          if (state === GenStateSuspendedStart) {
            state = GenStateCompleted;
            throw context.arg;
          }

          context.dispatchException(context.arg);

        } else if (context.method === "return") {
          context.abrupt("return", context.arg);
        }

        state = GenStateExecuting;

        var record = tryCatch(innerFn, self, context);
        if (record.type === "normal") {
          // If an exception is thrown from innerFn, we leave state ===
          // GenStateExecuting and loop back for another invocation.
          state = context.done
            ? GenStateCompleted
            : GenStateSuspendedYield;

          if (record.arg === ContinueSentinel) {
            continue;
          }

          return {
            value: record.arg,
            done: context.done
          };

        } else if (record.type === "throw") {
          state = GenStateCompleted;
          // Dispatch the exception by looping back around to the
          // context.dispatchException(context.arg) call above.
          context.method = "throw";
          context.arg = record.arg;
        }
      }
    };
  }

  // Call delegate.iterator[context.method](context.arg) and handle the
  // result, either by returning a { value, done } result from the
  // delegate iterator, or by modifying context.method and context.arg,
  // setting context.delegate to null, and returning the ContinueSentinel.
  function maybeInvokeDelegate(delegate, context) {
    var method = delegate.iterator[context.method];
    if (method === undefined) {
      // A .throw or .return when the delegate iterator has no .throw
      // method always terminates the yield* loop.
      context.delegate = null;

      if (context.method === "throw") {
        if (delegate.iterator.return) {
          // If the delegate iterator has a return method, give it a
          // chance to clean up.
          context.method = "return";
          context.arg = undefined;
          maybeInvokeDelegate(delegate, context);

          if (context.method === "throw") {
            // If maybeInvokeDelegate(context) changed context.method from
            // "return" to "throw", let that override the TypeError below.
            return ContinueSentinel;
          }
        }

        context.method = "throw";
        context.arg = new TypeError(
          "The iterator does not provide a 'throw' method");
      }

      return ContinueSentinel;
    }

    var record = tryCatch(method, delegate.iterator, context.arg);

    if (record.type === "throw") {
      context.method = "throw";
      context.arg = record.arg;
      context.delegate = null;
      return ContinueSentinel;
    }

    var info = record.arg;

    if (! info) {
      context.method = "throw";
      context.arg = new TypeError("iterator result is not an object");
      context.delegate = null;
      return ContinueSentinel;
    }

    if (info.done) {
      // Assign the result of the finished delegate to the temporary
      // variable specified by delegate.resultName (see delegateYield).
      context[delegate.resultName] = info.value;

      // Resume execution at the desired location (see delegateYield).
      context.next = delegate.nextLoc;

      // If context.method was "throw" but the delegate handled the
      // exception, let the outer generator proceed normally. If
      // context.method was "next", forget context.arg since it has been
      // "consumed" by the delegate iterator. If context.method was
      // "return", allow the original .return call to continue in the
      // outer generator.
      if (context.method !== "return") {
        context.method = "next";
        context.arg = undefined;
      }

    } else {
      // Re-yield the result returned by the delegate method.
      return info;
    }

    // The delegate iterator is finished, so forget it and continue with
    // the outer generator.
    context.delegate = null;
    return ContinueSentinel;
  }

  // Define Generator.prototype.{next,throw,return} in terms of the
  // unified ._invoke helper method.
  defineIteratorMethods(Gp);

  Gp[toStringTagSymbol] = "Generator";

  // A Generator should always return itself as the iterator object when the
  // @@iterator function is called on it. Some browsers' implementations of the
  // iterator prototype chain incorrectly implement this, causing the Generator
  // object to not be returned from this call. This ensures that doesn't happen.
  // See https://github.com/facebook/regenerator/issues/274 for more details.
  Gp[iteratorSymbol] = function() {
    return this;
  };

  Gp.toString = function() {
    return "[object Generator]";
  };

  function pushTryEntry(locs) {
    var entry = { tryLoc: locs[0] };

    if (1 in locs) {
      entry.catchLoc = locs[1];
    }

    if (2 in locs) {
      entry.finallyLoc = locs[2];
      entry.afterLoc = locs[3];
    }

    this.tryEntries.push(entry);
  }

  function resetTryEntry(entry) {
    var record = entry.completion || {};
    record.type = "normal";
    delete record.arg;
    entry.completion = record;
  }

  function Context(tryLocsList) {
    // The root entry object (effectively a try statement without a catch
    // or a finally block) gives us a place to store values thrown from
    // locations where there is no enclosing try statement.
    this.tryEntries = [{ tryLoc: "root" }];
    tryLocsList.forEach(pushTryEntry, this);
    this.reset(true);
  }

  runtime.keys = function(object) {
    var keys = [];
    for (var key in object) {
      keys.push(key);
    }
    keys.reverse();

    // Rather than returning an object with a next method, we keep
    // things simple and return the next function itself.
    return function next() {
      while (keys.length) {
        var key = keys.pop();
        if (key in object) {
          next.value = key;
          next.done = false;
          return next;
        }
      }

      // To avoid creating an additional object, we just hang the .value
      // and .done properties off the next function object itself. This
      // also ensures that the minifier will not anonymize the function.
      next.done = true;
      return next;
    };
  };

  function values(iterable) {
    if (iterable) {
      var iteratorMethod = iterable[iteratorSymbol];
      if (iteratorMethod) {
        return iteratorMethod.call(iterable);
      }

      if (typeof iterable.next === "function") {
        return iterable;
      }

      if (!isNaN(iterable.length)) {
        var i = -1, next = function next() {
          while (++i < iterable.length) {
            if (hasOwn.call(iterable, i)) {
              next.value = iterable[i];
              next.done = false;
              return next;
            }
          }

          next.value = undefined;
          next.done = true;

          return next;
        };

        return next.next = next;
      }
    }

    // Return an iterator with no values.
    return { next: doneResult };
  }
  runtime.values = values;

  function doneResult() {
    return { value: undefined, done: true };
  }

  Context.prototype = {
    constructor: Context,

    reset: function(skipTempReset) {
      this.prev = 0;
      this.next = 0;
      // Resetting context._sent for legacy support of Babel's
      // function.sent implementation.
      this.sent = this._sent = undefined;
      this.done = false;
      this.delegate = null;

      this.method = "next";
      this.arg = undefined;

      this.tryEntries.forEach(resetTryEntry);

      if (!skipTempReset) {
        for (var name in this) {
          // Not sure about the optimal order of these conditions:
          if (name.charAt(0) === "t" &&
              hasOwn.call(this, name) &&
              !isNaN(+name.slice(1))) {
            this[name] = undefined;
          }
        }
      }
    },

    stop: function() {
      this.done = true;

      var rootEntry = this.tryEntries[0];
      var rootRecord = rootEntry.completion;
      if (rootRecord.type === "throw") {
        throw rootRecord.arg;
      }

      return this.rval;
    },

    dispatchException: function(exception) {
      if (this.done) {
        throw exception;
      }

      var context = this;
      function handle(loc, caught) {
        record.type = "throw";
        record.arg = exception;
        context.next = loc;

        if (caught) {
          // If the dispatched exception was caught by a catch block,
          // then let that catch block handle the exception normally.
          context.method = "next";
          context.arg = undefined;
        }

        return !! caught;
      }

      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];
        var record = entry.completion;

        if (entry.tryLoc === "root") {
          // Exception thrown outside of any try block that could handle
          // it, so set the completion value of the entire function to
          // throw the exception.
          return handle("end");
        }

        if (entry.tryLoc <= this.prev) {
          var hasCatch = hasOwn.call(entry, "catchLoc");
          var hasFinally = hasOwn.call(entry, "finallyLoc");

          if (hasCatch && hasFinally) {
            if (this.prev < entry.catchLoc) {
              return handle(entry.catchLoc, true);
            } else if (this.prev < entry.finallyLoc) {
              return handle(entry.finallyLoc);
            }

          } else if (hasCatch) {
            if (this.prev < entry.catchLoc) {
              return handle(entry.catchLoc, true);
            }

          } else if (hasFinally) {
            if (this.prev < entry.finallyLoc) {
              return handle(entry.finallyLoc);
            }

          } else {
            throw new Error("try statement without catch or finally");
          }
        }
      }
    },

    abrupt: function(type, arg) {
      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];
        if (entry.tryLoc <= this.prev &&
            hasOwn.call(entry, "finallyLoc") &&
            this.prev < entry.finallyLoc) {
          var finallyEntry = entry;
          break;
        }
      }

      if (finallyEntry &&
          (type === "break" ||
           type === "continue") &&
          finallyEntry.tryLoc <= arg &&
          arg <= finallyEntry.finallyLoc) {
        // Ignore the finally entry if control is not jumping to a
        // location outside the try/catch block.
        finallyEntry = null;
      }

      var record = finallyEntry ? finallyEntry.completion : {};
      record.type = type;
      record.arg = arg;

      if (finallyEntry) {
        this.method = "next";
        this.next = finallyEntry.finallyLoc;
        return ContinueSentinel;
      }

      return this.complete(record);
    },

    complete: function(record, afterLoc) {
      if (record.type === "throw") {
        throw record.arg;
      }

      if (record.type === "break" ||
          record.type === "continue") {
        this.next = record.arg;
      } else if (record.type === "return") {
        this.rval = this.arg = record.arg;
        this.method = "return";
        this.next = "end";
      } else if (record.type === "normal" && afterLoc) {
        this.next = afterLoc;
      }

      return ContinueSentinel;
    },

    finish: function(finallyLoc) {
      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];
        if (entry.finallyLoc === finallyLoc) {
          this.complete(entry.completion, entry.afterLoc);
          resetTryEntry(entry);
          return ContinueSentinel;
        }
      }
    },

    "catch": function(tryLoc) {
      for (var i = this.tryEntries.length - 1; i >= 0; --i) {
        var entry = this.tryEntries[i];
        if (entry.tryLoc === tryLoc) {
          var record = entry.completion;
          if (record.type === "throw") {
            var thrown = record.arg;
            resetTryEntry(entry);
          }
          return thrown;
        }
      }

      // The context.catch method must only be called with a location
      // argument that corresponds to a known catch block.
      throw new Error("illegal catch attempt");
    },

    delegateYield: function(iterable, resultName, nextLoc) {
      this.delegate = {
        iterator: values(iterable),
        resultName: resultName,
        nextLoc: nextLoc
      };

      if (this.method === "next") {
        // Deliberately forget the last sent value so that we don't
        // accidentally pass it on to the delegate.
        this.arg = undefined;
      }

      return ContinueSentinel;
    }
  };
})(
  // In sloppy mode, unbound `this` refers to the global object, fallback to
  // Function constructor if we're in global strict mode. That is sadly a form
  // of indirect eval which violates Content Security Policy.
  (function() {
    return this || (typeof self === "object" && self);
  })() || Function("return this")()
);


/***/ }),

/***/ "./node_modules/rxjs/_esm5/index.js":
/*!******************************************!*\
  !*** ./node_modules/rxjs/_esm5/index.js ***!
  \******************************************/
/*! exports provided: Observable, ConnectableObservable, GroupedObservable, observable, Subject, BehaviorSubject, ReplaySubject, AsyncSubject, asapScheduler, asyncScheduler, queueScheduler, animationFrameScheduler, VirtualTimeScheduler, VirtualAction, Scheduler, Subscription, Subscriber, Notification, pipe, noop, identity, isObservable, ArgumentOutOfRangeError, EmptyError, ObjectUnsubscribedError, UnsubscriptionError, TimeoutError, bindCallback, bindNodeCallback, combineLatest, concat, defer, empty, forkJoin, from, fromEvent, fromEventPattern, generate, iif, interval, merge, never, of, onErrorResumeNext, pairs, race, range, throwError, timer, using, zip, EMPTY, NEVER, config */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _internal_Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./internal/Observable */ "./node_modules/rxjs/_esm5/internal/Observable.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Observable", function() { return _internal_Observable__WEBPACK_IMPORTED_MODULE_0__["Observable"]; });

/* harmony import */ var _internal_observable_ConnectableObservable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./internal/observable/ConnectableObservable */ "./node_modules/rxjs/_esm5/internal/observable/ConnectableObservable.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ConnectableObservable", function() { return _internal_observable_ConnectableObservable__WEBPACK_IMPORTED_MODULE_1__["ConnectableObservable"]; });

/* harmony import */ var _internal_operators_groupBy__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./internal/operators/groupBy */ "./node_modules/rxjs/_esm5/internal/operators/groupBy.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "GroupedObservable", function() { return _internal_operators_groupBy__WEBPACK_IMPORTED_MODULE_2__["GroupedObservable"]; });

/* harmony import */ var _internal_symbol_observable__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./internal/symbol/observable */ "./node_modules/rxjs/_esm5/internal/symbol/observable.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "observable", function() { return _internal_symbol_observable__WEBPACK_IMPORTED_MODULE_3__["observable"]; });

/* harmony import */ var _internal_Subject__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./internal/Subject */ "./node_modules/rxjs/_esm5/internal/Subject.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Subject", function() { return _internal_Subject__WEBPACK_IMPORTED_MODULE_4__["Subject"]; });

/* harmony import */ var _internal_BehaviorSubject__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./internal/BehaviorSubject */ "./node_modules/rxjs/_esm5/internal/BehaviorSubject.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BehaviorSubject", function() { return _internal_BehaviorSubject__WEBPACK_IMPORTED_MODULE_5__["BehaviorSubject"]; });

/* harmony import */ var _internal_ReplaySubject__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./internal/ReplaySubject */ "./node_modules/rxjs/_esm5/internal/ReplaySubject.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ReplaySubject", function() { return _internal_ReplaySubject__WEBPACK_IMPORTED_MODULE_6__["ReplaySubject"]; });

/* harmony import */ var _internal_AsyncSubject__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./internal/AsyncSubject */ "./node_modules/rxjs/_esm5/internal/AsyncSubject.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "AsyncSubject", function() { return _internal_AsyncSubject__WEBPACK_IMPORTED_MODULE_7__["AsyncSubject"]; });

/* harmony import */ var _internal_scheduler_asap__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./internal/scheduler/asap */ "./node_modules/rxjs/_esm5/internal/scheduler/asap.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "asapScheduler", function() { return _internal_scheduler_asap__WEBPACK_IMPORTED_MODULE_8__["asap"]; });

/* harmony import */ var _internal_scheduler_async__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./internal/scheduler/async */ "./node_modules/rxjs/_esm5/internal/scheduler/async.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "asyncScheduler", function() { return _internal_scheduler_async__WEBPACK_IMPORTED_MODULE_9__["async"]; });

/* harmony import */ var _internal_scheduler_queue__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./internal/scheduler/queue */ "./node_modules/rxjs/_esm5/internal/scheduler/queue.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "queueScheduler", function() { return _internal_scheduler_queue__WEBPACK_IMPORTED_MODULE_10__["queue"]; });

/* harmony import */ var _internal_scheduler_animationFrame__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./internal/scheduler/animationFrame */ "./node_modules/rxjs/_esm5/internal/scheduler/animationFrame.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "animationFrameScheduler", function() { return _internal_scheduler_animationFrame__WEBPACK_IMPORTED_MODULE_11__["animationFrame"]; });

/* harmony import */ var _internal_scheduler_VirtualTimeScheduler__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./internal/scheduler/VirtualTimeScheduler */ "./node_modules/rxjs/_esm5/internal/scheduler/VirtualTimeScheduler.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "VirtualTimeScheduler", function() { return _internal_scheduler_VirtualTimeScheduler__WEBPACK_IMPORTED_MODULE_12__["VirtualTimeScheduler"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "VirtualAction", function() { return _internal_scheduler_VirtualTimeScheduler__WEBPACK_IMPORTED_MODULE_12__["VirtualAction"]; });

/* harmony import */ var _internal_Scheduler__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./internal/Scheduler */ "./node_modules/rxjs/_esm5/internal/Scheduler.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Scheduler", function() { return _internal_Scheduler__WEBPACK_IMPORTED_MODULE_13__["Scheduler"]; });

/* harmony import */ var _internal_Subscription__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./internal/Subscription */ "./node_modules/rxjs/_esm5/internal/Subscription.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Subscription", function() { return _internal_Subscription__WEBPACK_IMPORTED_MODULE_14__["Subscription"]; });

/* harmony import */ var _internal_Subscriber__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./internal/Subscriber */ "./node_modules/rxjs/_esm5/internal/Subscriber.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Subscriber", function() { return _internal_Subscriber__WEBPACK_IMPORTED_MODULE_15__["Subscriber"]; });

/* harmony import */ var _internal_Notification__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./internal/Notification */ "./node_modules/rxjs/_esm5/internal/Notification.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Notification", function() { return _internal_Notification__WEBPACK_IMPORTED_MODULE_16__["Notification"]; });

/* harmony import */ var _internal_util_pipe__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./internal/util/pipe */ "./node_modules/rxjs/_esm5/internal/util/pipe.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "pipe", function() { return _internal_util_pipe__WEBPACK_IMPORTED_MODULE_17__["pipe"]; });

/* harmony import */ var _internal_util_noop__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./internal/util/noop */ "./node_modules/rxjs/_esm5/internal/util/noop.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "noop", function() { return _internal_util_noop__WEBPACK_IMPORTED_MODULE_18__["noop"]; });

/* harmony import */ var _internal_util_identity__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./internal/util/identity */ "./node_modules/rxjs/_esm5/internal/util/identity.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "identity", function() { return _internal_util_identity__WEBPACK_IMPORTED_MODULE_19__["identity"]; });

/* harmony import */ var _internal_util_isObservable__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./internal/util/isObservable */ "./node_modules/rxjs/_esm5/internal/util/isObservable.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "isObservable", function() { return _internal_util_isObservable__WEBPACK_IMPORTED_MODULE_20__["isObservable"]; });

/* harmony import */ var _internal_util_ArgumentOutOfRangeError__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./internal/util/ArgumentOutOfRangeError */ "./node_modules/rxjs/_esm5/internal/util/ArgumentOutOfRangeError.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ArgumentOutOfRangeError", function() { return _internal_util_ArgumentOutOfRangeError__WEBPACK_IMPORTED_MODULE_21__["ArgumentOutOfRangeError"]; });

/* harmony import */ var _internal_util_EmptyError__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./internal/util/EmptyError */ "./node_modules/rxjs/_esm5/internal/util/EmptyError.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EmptyError", function() { return _internal_util_EmptyError__WEBPACK_IMPORTED_MODULE_22__["EmptyError"]; });

/* harmony import */ var _internal_util_ObjectUnsubscribedError__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./internal/util/ObjectUnsubscribedError */ "./node_modules/rxjs/_esm5/internal/util/ObjectUnsubscribedError.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ObjectUnsubscribedError", function() { return _internal_util_ObjectUnsubscribedError__WEBPACK_IMPORTED_MODULE_23__["ObjectUnsubscribedError"]; });

/* harmony import */ var _internal_util_UnsubscriptionError__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./internal/util/UnsubscriptionError */ "./node_modules/rxjs/_esm5/internal/util/UnsubscriptionError.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "UnsubscriptionError", function() { return _internal_util_UnsubscriptionError__WEBPACK_IMPORTED_MODULE_24__["UnsubscriptionError"]; });

/* harmony import */ var _internal_util_TimeoutError__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./internal/util/TimeoutError */ "./node_modules/rxjs/_esm5/internal/util/TimeoutError.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TimeoutError", function() { return _internal_util_TimeoutError__WEBPACK_IMPORTED_MODULE_25__["TimeoutError"]; });

/* harmony import */ var _internal_observable_bindCallback__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./internal/observable/bindCallback */ "./node_modules/rxjs/_esm5/internal/observable/bindCallback.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "bindCallback", function() { return _internal_observable_bindCallback__WEBPACK_IMPORTED_MODULE_26__["bindCallback"]; });

/* harmony import */ var _internal_observable_bindNodeCallback__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ./internal/observable/bindNodeCallback */ "./node_modules/rxjs/_esm5/internal/observable/bindNodeCallback.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "bindNodeCallback", function() { return _internal_observable_bindNodeCallback__WEBPACK_IMPORTED_MODULE_27__["bindNodeCallback"]; });

/* harmony import */ var _internal_observable_combineLatest__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ./internal/observable/combineLatest */ "./node_modules/rxjs/_esm5/internal/observable/combineLatest.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "combineLatest", function() { return _internal_observable_combineLatest__WEBPACK_IMPORTED_MODULE_28__["combineLatest"]; });

/* harmony import */ var _internal_observable_concat__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./internal/observable/concat */ "./node_modules/rxjs/_esm5/internal/observable/concat.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "concat", function() { return _internal_observable_concat__WEBPACK_IMPORTED_MODULE_29__["concat"]; });

/* harmony import */ var _internal_observable_defer__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ./internal/observable/defer */ "./node_modules/rxjs/_esm5/internal/observable/defer.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "defer", function() { return _internal_observable_defer__WEBPACK_IMPORTED_MODULE_30__["defer"]; });

/* harmony import */ var _internal_observable_empty__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ./internal/observable/empty */ "./node_modules/rxjs/_esm5/internal/observable/empty.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "empty", function() { return _internal_observable_empty__WEBPACK_IMPORTED_MODULE_31__["empty"]; });

/* harmony import */ var _internal_observable_forkJoin__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ./internal/observable/forkJoin */ "./node_modules/rxjs/_esm5/internal/observable/forkJoin.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "forkJoin", function() { return _internal_observable_forkJoin__WEBPACK_IMPORTED_MODULE_32__["forkJoin"]; });

/* harmony import */ var _internal_observable_from__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! ./internal/observable/from */ "./node_modules/rxjs/_esm5/internal/observable/from.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "from", function() { return _internal_observable_from__WEBPACK_IMPORTED_MODULE_33__["from"]; });

/* harmony import */ var _internal_observable_fromEvent__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! ./internal/observable/fromEvent */ "./node_modules/rxjs/_esm5/internal/observable/fromEvent.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "fromEvent", function() { return _internal_observable_fromEvent__WEBPACK_IMPORTED_MODULE_34__["fromEvent"]; });

/* harmony import */ var _internal_observable_fromEventPattern__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! ./internal/observable/fromEventPattern */ "./node_modules/rxjs/_esm5/internal/observable/fromEventPattern.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "fromEventPattern", function() { return _internal_observable_fromEventPattern__WEBPACK_IMPORTED_MODULE_35__["fromEventPattern"]; });

/* harmony import */ var _internal_observable_generate__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(/*! ./internal/observable/generate */ "./node_modules/rxjs/_esm5/internal/observable/generate.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "generate", function() { return _internal_observable_generate__WEBPACK_IMPORTED_MODULE_36__["generate"]; });

/* harmony import */ var _internal_observable_iif__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(/*! ./internal/observable/iif */ "./node_modules/rxjs/_esm5/internal/observable/iif.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "iif", function() { return _internal_observable_iif__WEBPACK_IMPORTED_MODULE_37__["iif"]; });

/* harmony import */ var _internal_observable_interval__WEBPACK_IMPORTED_MODULE_38__ = __webpack_require__(/*! ./internal/observable/interval */ "./node_modules/rxjs/_esm5/internal/observable/interval.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "interval", function() { return _internal_observable_interval__WEBPACK_IMPORTED_MODULE_38__["interval"]; });

/* harmony import */ var _internal_observable_merge__WEBPACK_IMPORTED_MODULE_39__ = __webpack_require__(/*! ./internal/observable/merge */ "./node_modules/rxjs/_esm5/internal/observable/merge.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "merge", function() { return _internal_observable_merge__WEBPACK_IMPORTED_MODULE_39__["merge"]; });

/* harmony import */ var _internal_observable_never__WEBPACK_IMPORTED_MODULE_40__ = __webpack_require__(/*! ./internal/observable/never */ "./node_modules/rxjs/_esm5/internal/observable/never.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "never", function() { return _internal_observable_never__WEBPACK_IMPORTED_MODULE_40__["never"]; });

/* harmony import */ var _internal_observable_of__WEBPACK_IMPORTED_MODULE_41__ = __webpack_require__(/*! ./internal/observable/of */ "./node_modules/rxjs/_esm5/internal/observable/of.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "of", function() { return _internal_observable_of__WEBPACK_IMPORTED_MODULE_41__["of"]; });

/* harmony import */ var _internal_observable_onErrorResumeNext__WEBPACK_IMPORTED_MODULE_42__ = __webpack_require__(/*! ./internal/observable/onErrorResumeNext */ "./node_modules/rxjs/_esm5/internal/observable/onErrorResumeNext.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "onErrorResumeNext", function() { return _internal_observable_onErrorResumeNext__WEBPACK_IMPORTED_MODULE_42__["onErrorResumeNext"]; });

/* harmony import */ var _internal_observable_pairs__WEBPACK_IMPORTED_MODULE_43__ = __webpack_require__(/*! ./internal/observable/pairs */ "./node_modules/rxjs/_esm5/internal/observable/pairs.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "pairs", function() { return _internal_observable_pairs__WEBPACK_IMPORTED_MODULE_43__["pairs"]; });

/* harmony import */ var _internal_observable_race__WEBPACK_IMPORTED_MODULE_44__ = __webpack_require__(/*! ./internal/observable/race */ "./node_modules/rxjs/_esm5/internal/observable/race.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "race", function() { return _internal_observable_race__WEBPACK_IMPORTED_MODULE_44__["race"]; });

/* harmony import */ var _internal_observable_range__WEBPACK_IMPORTED_MODULE_45__ = __webpack_require__(/*! ./internal/observable/range */ "./node_modules/rxjs/_esm5/internal/observable/range.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "range", function() { return _internal_observable_range__WEBPACK_IMPORTED_MODULE_45__["range"]; });

/* harmony import */ var _internal_observable_throwError__WEBPACK_IMPORTED_MODULE_46__ = __webpack_require__(/*! ./internal/observable/throwError */ "./node_modules/rxjs/_esm5/internal/observable/throwError.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "throwError", function() { return _internal_observable_throwError__WEBPACK_IMPORTED_MODULE_46__["throwError"]; });

/* harmony import */ var _internal_observable_timer__WEBPACK_IMPORTED_MODULE_47__ = __webpack_require__(/*! ./internal/observable/timer */ "./node_modules/rxjs/_esm5/internal/observable/timer.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "timer", function() { return _internal_observable_timer__WEBPACK_IMPORTED_MODULE_47__["timer"]; });

/* harmony import */ var _internal_observable_using__WEBPACK_IMPORTED_MODULE_48__ = __webpack_require__(/*! ./internal/observable/using */ "./node_modules/rxjs/_esm5/internal/observable/using.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "using", function() { return _internal_observable_using__WEBPACK_IMPORTED_MODULE_48__["using"]; });

/* harmony import */ var _internal_observable_zip__WEBPACK_IMPORTED_MODULE_49__ = __webpack_require__(/*! ./internal/observable/zip */ "./node_modules/rxjs/_esm5/internal/observable/zip.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "zip", function() { return _internal_observable_zip__WEBPACK_IMPORTED_MODULE_49__["zip"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EMPTY", function() { return _internal_observable_empty__WEBPACK_IMPORTED_MODULE_31__["EMPTY"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "NEVER", function() { return _internal_observable_never__WEBPACK_IMPORTED_MODULE_40__["NEVER"]; });

/* harmony import */ var _internal_config__WEBPACK_IMPORTED_MODULE_50__ = __webpack_require__(/*! ./internal/config */ "./node_modules/rxjs/_esm5/internal/config.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "config", function() { return _internal_config__WEBPACK_IMPORTED_MODULE_50__["config"]; });

/** PURE_IMPORTS_START  PURE_IMPORTS_END */





















































//# sourceMappingURL=index.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/AsyncSubject.js":
/*!**********************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/AsyncSubject.js ***!
  \**********************************************************/
/*! exports provided: AsyncSubject */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AsyncSubject", function() { return AsyncSubject; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _Subject__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Subject */ "./node_modules/rxjs/_esm5/internal/Subject.js");
/* harmony import */ var _Subscription__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Subscription */ "./node_modules/rxjs/_esm5/internal/Subscription.js");
/** PURE_IMPORTS_START tslib,_Subject,_Subscription PURE_IMPORTS_END */



var AsyncSubject = /*@__PURE__*/ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](AsyncSubject, _super);
    function AsyncSubject() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.value = null;
        _this.hasNext = false;
        _this.hasCompleted = false;
        return _this;
    }
    AsyncSubject.prototype._subscribe = function (subscriber) {
        if (this.hasError) {
            subscriber.error(this.thrownError);
            return _Subscription__WEBPACK_IMPORTED_MODULE_2__["Subscription"].EMPTY;
        }
        else if (this.hasCompleted && this.hasNext) {
            subscriber.next(this.value);
            subscriber.complete();
            return _Subscription__WEBPACK_IMPORTED_MODULE_2__["Subscription"].EMPTY;
        }
        return _super.prototype._subscribe.call(this, subscriber);
    };
    AsyncSubject.prototype.next = function (value) {
        if (!this.hasCompleted) {
            this.value = value;
            this.hasNext = true;
        }
    };
    AsyncSubject.prototype.error = function (error) {
        if (!this.hasCompleted) {
            _super.prototype.error.call(this, error);
        }
    };
    AsyncSubject.prototype.complete = function () {
        this.hasCompleted = true;
        if (this.hasNext) {
            _super.prototype.next.call(this, this.value);
        }
        _super.prototype.complete.call(this);
    };
    return AsyncSubject;
}(_Subject__WEBPACK_IMPORTED_MODULE_1__["Subject"]));

//# sourceMappingURL=AsyncSubject.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/BehaviorSubject.js":
/*!*************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/BehaviorSubject.js ***!
  \*************************************************************/
/*! exports provided: BehaviorSubject */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BehaviorSubject", function() { return BehaviorSubject; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _Subject__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Subject */ "./node_modules/rxjs/_esm5/internal/Subject.js");
/* harmony import */ var _util_ObjectUnsubscribedError__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./util/ObjectUnsubscribedError */ "./node_modules/rxjs/_esm5/internal/util/ObjectUnsubscribedError.js");
/** PURE_IMPORTS_START tslib,_Subject,_util_ObjectUnsubscribedError PURE_IMPORTS_END */



var BehaviorSubject = /*@__PURE__*/ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](BehaviorSubject, _super);
    function BehaviorSubject(_value) {
        var _this = _super.call(this) || this;
        _this._value = _value;
        return _this;
    }
    Object.defineProperty(BehaviorSubject.prototype, "value", {
        get: function () {
            return this.getValue();
        },
        enumerable: true,
        configurable: true
    });
    BehaviorSubject.prototype._subscribe = function (subscriber) {
        var subscription = _super.prototype._subscribe.call(this, subscriber);
        if (subscription && !subscription.closed) {
            subscriber.next(this._value);
        }
        return subscription;
    };
    BehaviorSubject.prototype.getValue = function () {
        if (this.hasError) {
            throw this.thrownError;
        }
        else if (this.closed) {
            throw new _util_ObjectUnsubscribedError__WEBPACK_IMPORTED_MODULE_2__["ObjectUnsubscribedError"]();
        }
        else {
            return this._value;
        }
    };
    BehaviorSubject.prototype.next = function (value) {
        _super.prototype.next.call(this, this._value = value);
    };
    return BehaviorSubject;
}(_Subject__WEBPACK_IMPORTED_MODULE_1__["Subject"]));

//# sourceMappingURL=BehaviorSubject.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/InnerSubscriber.js":
/*!*************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/InnerSubscriber.js ***!
  \*************************************************************/
/*! exports provided: InnerSubscriber */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InnerSubscriber", function() { return InnerSubscriber; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _Subscriber__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Subscriber */ "./node_modules/rxjs/_esm5/internal/Subscriber.js");
/** PURE_IMPORTS_START tslib,_Subscriber PURE_IMPORTS_END */


var InnerSubscriber = /*@__PURE__*/ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](InnerSubscriber, _super);
    function InnerSubscriber(parent, outerValue, outerIndex) {
        var _this = _super.call(this) || this;
        _this.parent = parent;
        _this.outerValue = outerValue;
        _this.outerIndex = outerIndex;
        _this.index = 0;
        return _this;
    }
    InnerSubscriber.prototype._next = function (value) {
        this.parent.notifyNext(this.outerValue, value, this.outerIndex, this.index++, this);
    };
    InnerSubscriber.prototype._error = function (error) {
        this.parent.notifyError(error, this);
        this.unsubscribe();
    };
    InnerSubscriber.prototype._complete = function () {
        this.parent.notifyComplete(this);
        this.unsubscribe();
    };
    return InnerSubscriber;
}(_Subscriber__WEBPACK_IMPORTED_MODULE_1__["Subscriber"]));

//# sourceMappingURL=InnerSubscriber.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/Notification.js":
/*!**********************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/Notification.js ***!
  \**********************************************************/
/*! exports provided: Notification */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Notification", function() { return Notification; });
/* harmony import */ var _observable_empty__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./observable/empty */ "./node_modules/rxjs/_esm5/internal/observable/empty.js");
/* harmony import */ var _observable_of__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./observable/of */ "./node_modules/rxjs/_esm5/internal/observable/of.js");
/* harmony import */ var _observable_throwError__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./observable/throwError */ "./node_modules/rxjs/_esm5/internal/observable/throwError.js");
/** PURE_IMPORTS_START _observable_empty,_observable_of,_observable_throwError PURE_IMPORTS_END */



var Notification = /*@__PURE__*/ (function () {
    function Notification(kind, value, error) {
        this.kind = kind;
        this.value = value;
        this.error = error;
        this.hasValue = kind === 'N';
    }
    Notification.prototype.observe = function (observer) {
        switch (this.kind) {
            case 'N':
                return observer.next && observer.next(this.value);
            case 'E':
                return observer.error && observer.error(this.error);
            case 'C':
                return observer.complete && observer.complete();
        }
    };
    Notification.prototype.do = function (next, error, complete) {
        var kind = this.kind;
        switch (kind) {
            case 'N':
                return next && next(this.value);
            case 'E':
                return error && error(this.error);
            case 'C':
                return complete && complete();
        }
    };
    Notification.prototype.accept = function (nextOrObserver, error, complete) {
        if (nextOrObserver && typeof nextOrObserver.next === 'function') {
            return this.observe(nextOrObserver);
        }
        else {
            return this.do(nextOrObserver, error, complete);
        }
    };
    Notification.prototype.toObservable = function () {
        var kind = this.kind;
        switch (kind) {
            case 'N':
                return Object(_observable_of__WEBPACK_IMPORTED_MODULE_1__["of"])(this.value);
            case 'E':
                return Object(_observable_throwError__WEBPACK_IMPORTED_MODULE_2__["throwError"])(this.error);
            case 'C':
                return Object(_observable_empty__WEBPACK_IMPORTED_MODULE_0__["empty"])();
        }
        throw new Error('unexpected notification kind value');
    };
    Notification.createNext = function (value) {
        if (typeof value !== 'undefined') {
            return new Notification('N', value);
        }
        return Notification.undefinedValueNotification;
    };
    Notification.createError = function (err) {
        return new Notification('E', undefined, err);
    };
    Notification.createComplete = function () {
        return Notification.completeNotification;
    };
    Notification.completeNotification = new Notification('C');
    Notification.undefinedValueNotification = new Notification('N', undefined);
    return Notification;
}());

//# sourceMappingURL=Notification.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/Observable.js":
/*!********************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/Observable.js ***!
  \********************************************************/
/*! exports provided: Observable */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Observable", function() { return Observable; });
/* harmony import */ var _util_canReportError__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./util/canReportError */ "./node_modules/rxjs/_esm5/internal/util/canReportError.js");
/* harmony import */ var _util_toSubscriber__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./util/toSubscriber */ "./node_modules/rxjs/_esm5/internal/util/toSubscriber.js");
/* harmony import */ var _internal_symbol_observable__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../internal/symbol/observable */ "./node_modules/rxjs/_esm5/internal/symbol/observable.js");
/* harmony import */ var _util_pipe__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./util/pipe */ "./node_modules/rxjs/_esm5/internal/util/pipe.js");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./config */ "./node_modules/rxjs/_esm5/internal/config.js");
/** PURE_IMPORTS_START _util_canReportError,_util_toSubscriber,_internal_symbol_observable,_util_pipe,_config PURE_IMPORTS_END */





var Observable = /*@__PURE__*/ (function () {
    function Observable(subscribe) {
        this._isScalar = false;
        if (subscribe) {
            this._subscribe = subscribe;
        }
    }
    Observable.prototype.lift = function (operator) {
        var observable = new Observable();
        observable.source = this;
        observable.operator = operator;
        return observable;
    };
    Observable.prototype.subscribe = function (observerOrNext, error, complete) {
        var operator = this.operator;
        var sink = Object(_util_toSubscriber__WEBPACK_IMPORTED_MODULE_1__["toSubscriber"])(observerOrNext, error, complete);
        if (operator) {
            operator.call(sink, this.source);
        }
        else {
            sink.add(this.source || (_config__WEBPACK_IMPORTED_MODULE_4__["config"].useDeprecatedSynchronousErrorHandling && !sink.syncErrorThrowable) ?
                this._subscribe(sink) :
                this._trySubscribe(sink));
        }
        if (_config__WEBPACK_IMPORTED_MODULE_4__["config"].useDeprecatedSynchronousErrorHandling) {
            if (sink.syncErrorThrowable) {
                sink.syncErrorThrowable = false;
                if (sink.syncErrorThrown) {
                    throw sink.syncErrorValue;
                }
            }
        }
        return sink;
    };
    Observable.prototype._trySubscribe = function (sink) {
        try {
            return this._subscribe(sink);
        }
        catch (err) {
            if (_config__WEBPACK_IMPORTED_MODULE_4__["config"].useDeprecatedSynchronousErrorHandling) {
                sink.syncErrorThrown = true;
                sink.syncErrorValue = err;
            }
            if (Object(_util_canReportError__WEBPACK_IMPORTED_MODULE_0__["canReportError"])(sink)) {
                sink.error(err);
            }
            else {
                console.warn(err);
            }
        }
    };
    Observable.prototype.forEach = function (next, promiseCtor) {
        var _this = this;
        promiseCtor = getPromiseCtor(promiseCtor);
        return new promiseCtor(function (resolve, reject) {
            var subscription;
            subscription = _this.subscribe(function (value) {
                try {
                    next(value);
                }
                catch (err) {
                    reject(err);
                    if (subscription) {
                        subscription.unsubscribe();
                    }
                }
            }, reject, resolve);
        });
    };
    Observable.prototype._subscribe = function (subscriber) {
        var source = this.source;
        return source && source.subscribe(subscriber);
    };
    Observable.prototype[_internal_symbol_observable__WEBPACK_IMPORTED_MODULE_2__["observable"]] = function () {
        return this;
    };
    Observable.prototype.pipe = function () {
        var operations = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            operations[_i] = arguments[_i];
        }
        if (operations.length === 0) {
            return this;
        }
        return Object(_util_pipe__WEBPACK_IMPORTED_MODULE_3__["pipeFromArray"])(operations)(this);
    };
    Observable.prototype.toPromise = function (promiseCtor) {
        var _this = this;
        promiseCtor = getPromiseCtor(promiseCtor);
        return new promiseCtor(function (resolve, reject) {
            var value;
            _this.subscribe(function (x) { return value = x; }, function (err) { return reject(err); }, function () { return resolve(value); });
        });
    };
    Observable.create = function (subscribe) {
        return new Observable(subscribe);
    };
    return Observable;
}());

function getPromiseCtor(promiseCtor) {
    if (!promiseCtor) {
        promiseCtor = _config__WEBPACK_IMPORTED_MODULE_4__["config"].Promise || Promise;
    }
    if (!promiseCtor) {
        throw new Error('no Promise impl found');
    }
    return promiseCtor;
}
//# sourceMappingURL=Observable.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/Observer.js":
/*!******************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/Observer.js ***!
  \******************************************************/
/*! exports provided: empty */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "empty", function() { return empty; });
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./config */ "./node_modules/rxjs/_esm5/internal/config.js");
/* harmony import */ var _util_hostReportError__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./util/hostReportError */ "./node_modules/rxjs/_esm5/internal/util/hostReportError.js");
/** PURE_IMPORTS_START _config,_util_hostReportError PURE_IMPORTS_END */


var empty = {
    closed: true,
    next: function (value) { },
    error: function (err) {
        if (_config__WEBPACK_IMPORTED_MODULE_0__["config"].useDeprecatedSynchronousErrorHandling) {
            throw err;
        }
        else {
            Object(_util_hostReportError__WEBPACK_IMPORTED_MODULE_1__["hostReportError"])(err);
        }
    },
    complete: function () { }
};
//# sourceMappingURL=Observer.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/OuterSubscriber.js":
/*!*************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/OuterSubscriber.js ***!
  \*************************************************************/
/*! exports provided: OuterSubscriber */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OuterSubscriber", function() { return OuterSubscriber; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _Subscriber__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Subscriber */ "./node_modules/rxjs/_esm5/internal/Subscriber.js");
/** PURE_IMPORTS_START tslib,_Subscriber PURE_IMPORTS_END */


var OuterSubscriber = /*@__PURE__*/ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](OuterSubscriber, _super);
    function OuterSubscriber() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    OuterSubscriber.prototype.notifyNext = function (outerValue, innerValue, outerIndex, innerIndex, innerSub) {
        this.destination.next(innerValue);
    };
    OuterSubscriber.prototype.notifyError = function (error, innerSub) {
        this.destination.error(error);
    };
    OuterSubscriber.prototype.notifyComplete = function (innerSub) {
        this.destination.complete();
    };
    return OuterSubscriber;
}(_Subscriber__WEBPACK_IMPORTED_MODULE_1__["Subscriber"]));

//# sourceMappingURL=OuterSubscriber.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/ReplaySubject.js":
/*!***********************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/ReplaySubject.js ***!
  \***********************************************************/
/*! exports provided: ReplaySubject */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ReplaySubject", function() { return ReplaySubject; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _Subject__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Subject */ "./node_modules/rxjs/_esm5/internal/Subject.js");
/* harmony import */ var _scheduler_queue__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./scheduler/queue */ "./node_modules/rxjs/_esm5/internal/scheduler/queue.js");
/* harmony import */ var _Subscription__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Subscription */ "./node_modules/rxjs/_esm5/internal/Subscription.js");
/* harmony import */ var _operators_observeOn__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./operators/observeOn */ "./node_modules/rxjs/_esm5/internal/operators/observeOn.js");
/* harmony import */ var _util_ObjectUnsubscribedError__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./util/ObjectUnsubscribedError */ "./node_modules/rxjs/_esm5/internal/util/ObjectUnsubscribedError.js");
/* harmony import */ var _SubjectSubscription__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./SubjectSubscription */ "./node_modules/rxjs/_esm5/internal/SubjectSubscription.js");
/** PURE_IMPORTS_START tslib,_Subject,_scheduler_queue,_Subscription,_operators_observeOn,_util_ObjectUnsubscribedError,_SubjectSubscription PURE_IMPORTS_END */







var ReplaySubject = /*@__PURE__*/ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ReplaySubject, _super);
    function ReplaySubject(bufferSize, windowTime, scheduler) {
        if (bufferSize === void 0) {
            bufferSize = Number.POSITIVE_INFINITY;
        }
        if (windowTime === void 0) {
            windowTime = Number.POSITIVE_INFINITY;
        }
        var _this = _super.call(this) || this;
        _this.scheduler = scheduler;
        _this._events = [];
        _this._infiniteTimeWindow = false;
        _this._bufferSize = bufferSize < 1 ? 1 : bufferSize;
        _this._windowTime = windowTime < 1 ? 1 : windowTime;
        if (windowTime === Number.POSITIVE_INFINITY) {
            _this._infiniteTimeWindow = true;
            _this.next = _this.nextInfiniteTimeWindow;
        }
        else {
            _this.next = _this.nextTimeWindow;
        }
        return _this;
    }
    ReplaySubject.prototype.nextInfiniteTimeWindow = function (value) {
        var _events = this._events;
        _events.push(value);
        if (_events.length > this._bufferSize) {
            _events.shift();
        }
        _super.prototype.next.call(this, value);
    };
    ReplaySubject.prototype.nextTimeWindow = function (value) {
        this._events.push(new ReplayEvent(this._getNow(), value));
        this._trimBufferThenGetEvents();
        _super.prototype.next.call(this, value);
    };
    ReplaySubject.prototype._subscribe = function (subscriber) {
        var _infiniteTimeWindow = this._infiniteTimeWindow;
        var _events = _infiniteTimeWindow ? this._events : this._trimBufferThenGetEvents();
        var scheduler = this.scheduler;
        var len = _events.length;
        var subscription;
        if (this.closed) {
            throw new _util_ObjectUnsubscribedError__WEBPACK_IMPORTED_MODULE_5__["ObjectUnsubscribedError"]();
        }
        else if (this.isStopped || this.hasError) {
            subscription = _Subscription__WEBPACK_IMPORTED_MODULE_3__["Subscription"].EMPTY;
        }
        else {
            this.observers.push(subscriber);
            subscription = new _SubjectSubscription__WEBPACK_IMPORTED_MODULE_6__["SubjectSubscription"](this, subscriber);
        }
        if (scheduler) {
            subscriber.add(subscriber = new _operators_observeOn__WEBPACK_IMPORTED_MODULE_4__["ObserveOnSubscriber"](subscriber, scheduler));
        }
        if (_infiniteTimeWindow) {
            for (var i = 0; i < len && !subscriber.closed; i++) {
                subscriber.next(_events[i]);
            }
        }
        else {
            for (var i = 0; i < len && !subscriber.closed; i++) {
                subscriber.next(_events[i].value);
            }
        }
        if (this.hasError) {
            subscriber.error(this.thrownError);
        }
        else if (this.isStopped) {
            subscriber.complete();
        }
        return subscription;
    };
    ReplaySubject.prototype._getNow = function () {
        return (this.scheduler || _scheduler_queue__WEBPACK_IMPORTED_MODULE_2__["queue"]).now();
    };
    ReplaySubject.prototype._trimBufferThenGetEvents = function () {
        var now = this._getNow();
        var _bufferSize = this._bufferSize;
        var _windowTime = this._windowTime;
        var _events = this._events;
        var eventsCount = _events.length;
        var spliceCount = 0;
        while (spliceCount < eventsCount) {
            if ((now - _events[spliceCount].time) < _windowTime) {
                break;
            }
            spliceCount++;
        }
        if (eventsCount > _bufferSize) {
            spliceCount = Math.max(spliceCount, eventsCount - _bufferSize);
        }
        if (spliceCount > 0) {
            _events.splice(0, spliceCount);
        }
        return _events;
    };
    return ReplaySubject;
}(_Subject__WEBPACK_IMPORTED_MODULE_1__["Subject"]));

var ReplayEvent = /*@__PURE__*/ (function () {
    function ReplayEvent(time, value) {
        this.time = time;
        this.value = value;
    }
    return ReplayEvent;
}());
//# sourceMappingURL=ReplaySubject.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/Scheduler.js":
/*!*******************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/Scheduler.js ***!
  \*******************************************************/
/*! exports provided: Scheduler */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Scheduler", function() { return Scheduler; });
var Scheduler = /*@__PURE__*/ (function () {
    function Scheduler(SchedulerAction, now) {
        if (now === void 0) {
            now = Scheduler.now;
        }
        this.SchedulerAction = SchedulerAction;
        this.now = now;
    }
    Scheduler.prototype.schedule = function (work, delay, state) {
        if (delay === void 0) {
            delay = 0;
        }
        return new this.SchedulerAction(this, work).schedule(state, delay);
    };
    Scheduler.now = function () { return Date.now(); };
    return Scheduler;
}());

//# sourceMappingURL=Scheduler.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/Subject.js":
/*!*****************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/Subject.js ***!
  \*****************************************************/
/*! exports provided: SubjectSubscriber, Subject, AnonymousSubject */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SubjectSubscriber", function() { return SubjectSubscriber; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Subject", function() { return Subject; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AnonymousSubject", function() { return AnonymousSubject; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Observable */ "./node_modules/rxjs/_esm5/internal/Observable.js");
/* harmony import */ var _Subscriber__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Subscriber */ "./node_modules/rxjs/_esm5/internal/Subscriber.js");
/* harmony import */ var _Subscription__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Subscription */ "./node_modules/rxjs/_esm5/internal/Subscription.js");
/* harmony import */ var _util_ObjectUnsubscribedError__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./util/ObjectUnsubscribedError */ "./node_modules/rxjs/_esm5/internal/util/ObjectUnsubscribedError.js");
/* harmony import */ var _SubjectSubscription__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./SubjectSubscription */ "./node_modules/rxjs/_esm5/internal/SubjectSubscription.js");
/* harmony import */ var _internal_symbol_rxSubscriber__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../internal/symbol/rxSubscriber */ "./node_modules/rxjs/_esm5/internal/symbol/rxSubscriber.js");
/** PURE_IMPORTS_START tslib,_Observable,_Subscriber,_Subscription,_util_ObjectUnsubscribedError,_SubjectSubscription,_internal_symbol_rxSubscriber PURE_IMPORTS_END */







var SubjectSubscriber = /*@__PURE__*/ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](SubjectSubscriber, _super);
    function SubjectSubscriber(destination) {
        var _this = _super.call(this, destination) || this;
        _this.destination = destination;
        return _this;
    }
    return SubjectSubscriber;
}(_Subscriber__WEBPACK_IMPORTED_MODULE_2__["Subscriber"]));

var Subject = /*@__PURE__*/ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Subject, _super);
    function Subject() {
        var _this = _super.call(this) || this;
        _this.observers = [];
        _this.closed = false;
        _this.isStopped = false;
        _this.hasError = false;
        _this.thrownError = null;
        return _this;
    }
    Subject.prototype[_internal_symbol_rxSubscriber__WEBPACK_IMPORTED_MODULE_6__["rxSubscriber"]] = function () {
        return new SubjectSubscriber(this);
    };
    Subject.prototype.lift = function (operator) {
        var subject = new AnonymousSubject(this, this);
        subject.operator = operator;
        return subject;
    };
    Subject.prototype.next = function (value) {
        if (this.closed) {
            throw new _util_ObjectUnsubscribedError__WEBPACK_IMPORTED_MODULE_4__["ObjectUnsubscribedError"]();
        }
        if (!this.isStopped) {
            var observers = this.observers;
            var len = observers.length;
            var copy = observers.slice();
            for (var i = 0; i < len; i++) {
                copy[i].next(value);
            }
        }
    };
    Subject.prototype.error = function (err) {
        if (this.closed) {
            throw new _util_ObjectUnsubscribedError__WEBPACK_IMPORTED_MODULE_4__["ObjectUnsubscribedError"]();
        }
        this.hasError = true;
        this.thrownError = err;
        this.isStopped = true;
        var observers = this.observers;
        var len = observers.length;
        var copy = observers.slice();
        for (var i = 0; i < len; i++) {
            copy[i].error(err);
        }
        this.observers.length = 0;
    };
    Subject.prototype.complete = function () {
        if (this.closed) {
            throw new _util_ObjectUnsubscribedError__WEBPACK_IMPORTED_MODULE_4__["ObjectUnsubscribedError"]();
        }
        this.isStopped = true;
        var observers = this.observers;
        var len = observers.length;
        var copy = observers.slice();
        for (var i = 0; i < len; i++) {
            copy[i].complete();
        }
        this.observers.length = 0;
    };
    Subject.prototype.unsubscribe = function () {
        this.isStopped = true;
        this.closed = true;
        this.observers = null;
    };
    Subject.prototype._trySubscribe = function (subscriber) {
        if (this.closed) {
            throw new _util_ObjectUnsubscribedError__WEBPACK_IMPORTED_MODULE_4__["ObjectUnsubscribedError"]();
        }
        else {
            return _super.prototype._trySubscribe.call(this, subscriber);
        }
    };
    Subject.prototype._subscribe = function (subscriber) {
        if (this.closed) {
            throw new _util_ObjectUnsubscribedError__WEBPACK_IMPORTED_MODULE_4__["ObjectUnsubscribedError"]();
        }
        else if (this.hasError) {
            subscriber.error(this.thrownError);
            return _Subscription__WEBPACK_IMPORTED_MODULE_3__["Subscription"].EMPTY;
        }
        else if (this.isStopped) {
            subscriber.complete();
            return _Subscription__WEBPACK_IMPORTED_MODULE_3__["Subscription"].EMPTY;
        }
        else {
            this.observers.push(subscriber);
            return new _SubjectSubscription__WEBPACK_IMPORTED_MODULE_5__["SubjectSubscription"](this, subscriber);
        }
    };
    Subject.prototype.asObservable = function () {
        var observable = new _Observable__WEBPACK_IMPORTED_MODULE_1__["Observable"]();
        observable.source = this;
        return observable;
    };
    Subject.create = function (destination, source) {
        return new AnonymousSubject(destination, source);
    };
    return Subject;
}(_Observable__WEBPACK_IMPORTED_MODULE_1__["Observable"]));

var AnonymousSubject = /*@__PURE__*/ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](AnonymousSubject, _super);
    function AnonymousSubject(destination, source) {
        var _this = _super.call(this) || this;
        _this.destination = destination;
        _this.source = source;
        return _this;
    }
    AnonymousSubject.prototype.next = function (value) {
        var destination = this.destination;
        if (destination && destination.next) {
            destination.next(value);
        }
    };
    AnonymousSubject.prototype.error = function (err) {
        var destination = this.destination;
        if (destination && destination.error) {
            this.destination.error(err);
        }
    };
    AnonymousSubject.prototype.complete = function () {
        var destination = this.destination;
        if (destination && destination.complete) {
            this.destination.complete();
        }
    };
    AnonymousSubject.prototype._subscribe = function (subscriber) {
        var source = this.source;
        if (source) {
            return this.source.subscribe(subscriber);
        }
        else {
            return _Subscription__WEBPACK_IMPORTED_MODULE_3__["Subscription"].EMPTY;
        }
    };
    return AnonymousSubject;
}(Subject));

//# sourceMappingURL=Subject.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/SubjectSubscription.js":
/*!*****************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/SubjectSubscription.js ***!
  \*****************************************************************/
/*! exports provided: SubjectSubscription */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SubjectSubscription", function() { return SubjectSubscription; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _Subscription__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Subscription */ "./node_modules/rxjs/_esm5/internal/Subscription.js");
/** PURE_IMPORTS_START tslib,_Subscription PURE_IMPORTS_END */


var SubjectSubscription = /*@__PURE__*/ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](SubjectSubscription, _super);
    function SubjectSubscription(subject, subscriber) {
        var _this = _super.call(this) || this;
        _this.subject = subject;
        _this.subscriber = subscriber;
        _this.closed = false;
        return _this;
    }
    SubjectSubscription.prototype.unsubscribe = function () {
        if (this.closed) {
            return;
        }
        this.closed = true;
        var subject = this.subject;
        var observers = subject.observers;
        this.subject = null;
        if (!observers || observers.length === 0 || subject.isStopped || subject.closed) {
            return;
        }
        var subscriberIndex = observers.indexOf(this.subscriber);
        if (subscriberIndex !== -1) {
            observers.splice(subscriberIndex, 1);
        }
    };
    return SubjectSubscription;
}(_Subscription__WEBPACK_IMPORTED_MODULE_1__["Subscription"]));

//# sourceMappingURL=SubjectSubscription.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/Subscriber.js":
/*!********************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/Subscriber.js ***!
  \********************************************************/
/*! exports provided: Subscriber, SafeSubscriber */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Subscriber", function() { return Subscriber; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SafeSubscriber", function() { return SafeSubscriber; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _util_isFunction__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./util/isFunction */ "./node_modules/rxjs/_esm5/internal/util/isFunction.js");
/* harmony import */ var _Observer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Observer */ "./node_modules/rxjs/_esm5/internal/Observer.js");
/* harmony import */ var _Subscription__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Subscription */ "./node_modules/rxjs/_esm5/internal/Subscription.js");
/* harmony import */ var _internal_symbol_rxSubscriber__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../internal/symbol/rxSubscriber */ "./node_modules/rxjs/_esm5/internal/symbol/rxSubscriber.js");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./config */ "./node_modules/rxjs/_esm5/internal/config.js");
/* harmony import */ var _util_hostReportError__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./util/hostReportError */ "./node_modules/rxjs/_esm5/internal/util/hostReportError.js");
/** PURE_IMPORTS_START tslib,_util_isFunction,_Observer,_Subscription,_internal_symbol_rxSubscriber,_config,_util_hostReportError PURE_IMPORTS_END */







var Subscriber = /*@__PURE__*/ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Subscriber, _super);
    function Subscriber(destinationOrNext, error, complete) {
        var _this = _super.call(this) || this;
        _this.syncErrorValue = null;
        _this.syncErrorThrown = false;
        _this.syncErrorThrowable = false;
        _this.isStopped = false;
        _this._parentSubscription = null;
        switch (arguments.length) {
            case 0:
                _this.destination = _Observer__WEBPACK_IMPORTED_MODULE_2__["empty"];
                break;
            case 1:
                if (!destinationOrNext) {
                    _this.destination = _Observer__WEBPACK_IMPORTED_MODULE_2__["empty"];
                    break;
                }
                if (typeof destinationOrNext === 'object') {
                    if (destinationOrNext instanceof Subscriber) {
                        _this.syncErrorThrowable = destinationOrNext.syncErrorThrowable;
                        _this.destination = destinationOrNext;
                        destinationOrNext.add(_this);
                    }
                    else {
                        _this.syncErrorThrowable = true;
                        _this.destination = new SafeSubscriber(_this, destinationOrNext);
                    }
                    break;
                }
            default:
                _this.syncErrorThrowable = true;
                _this.destination = new SafeSubscriber(_this, destinationOrNext, error, complete);
                break;
        }
        return _this;
    }
    Subscriber.prototype[_internal_symbol_rxSubscriber__WEBPACK_IMPORTED_MODULE_4__["rxSubscriber"]] = function () { return this; };
    Subscriber.create = function (next, error, complete) {
        var subscriber = new Subscriber(next, error, complete);
        subscriber.syncErrorThrowable = false;
        return subscriber;
    };
    Subscriber.prototype.next = function (value) {
        if (!this.isStopped) {
            this._next(value);
        }
    };
    Subscriber.prototype.error = function (err) {
        if (!this.isStopped) {
            this.isStopped = true;
            this._error(err);
        }
    };
    Subscriber.prototype.complete = function () {
        if (!this.isStopped) {
            this.isStopped = true;
            this._complete();
        }
    };
    Subscriber.prototype.unsubscribe = function () {
        if (this.closed) {
            return;
        }
        this.isStopped = true;
        _super.prototype.unsubscribe.call(this);
    };
    Subscriber.prototype._next = function (value) {
        this.destination.next(value);
    };
    Subscriber.prototype._error = function (err) {
        this.destination.error(err);
        this.unsubscribe();
    };
    Subscriber.prototype._complete = function () {
        this.destination.complete();
        this.unsubscribe();
    };
    Subscriber.prototype._unsubscribeAndRecycle = function () {
        var _a = this, _parent = _a._parent, _parents = _a._parents;
        this._parent = null;
        this._parents = null;
        this.unsubscribe();
        this.closed = false;
        this.isStopped = false;
        this._parent = _parent;
        this._parents = _parents;
        this._parentSubscription = null;
        return this;
    };
    return Subscriber;
}(_Subscription__WEBPACK_IMPORTED_MODULE_3__["Subscription"]));

var SafeSubscriber = /*@__PURE__*/ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](SafeSubscriber, _super);
    function SafeSubscriber(_parentSubscriber, observerOrNext, error, complete) {
        var _this = _super.call(this) || this;
        _this._parentSubscriber = _parentSubscriber;
        var next;
        var context = _this;
        if (Object(_util_isFunction__WEBPACK_IMPORTED_MODULE_1__["isFunction"])(observerOrNext)) {
            next = observerOrNext;
        }
        else if (observerOrNext) {
            next = observerOrNext.next;
            error = observerOrNext.error;
            complete = observerOrNext.complete;
            if (observerOrNext !== _Observer__WEBPACK_IMPORTED_MODULE_2__["empty"]) {
                context = Object.create(observerOrNext);
                if (Object(_util_isFunction__WEBPACK_IMPORTED_MODULE_1__["isFunction"])(context.unsubscribe)) {
                    _this.add(context.unsubscribe.bind(context));
                }
                context.unsubscribe = _this.unsubscribe.bind(_this);
            }
        }
        _this._context = context;
        _this._next = next;
        _this._error = error;
        _this._complete = complete;
        return _this;
    }
    SafeSubscriber.prototype.next = function (value) {
        if (!this.isStopped && this._next) {
            var _parentSubscriber = this._parentSubscriber;
            if (!_config__WEBPACK_IMPORTED_MODULE_5__["config"].useDeprecatedSynchronousErrorHandling || !_parentSubscriber.syncErrorThrowable) {
                this.__tryOrUnsub(this._next, value);
            }
            else if (this.__tryOrSetError(_parentSubscriber, this._next, value)) {
                this.unsubscribe();
            }
        }
    };
    SafeSubscriber.prototype.error = function (err) {
        if (!this.isStopped) {
            var _parentSubscriber = this._parentSubscriber;
            var useDeprecatedSynchronousErrorHandling = _config__WEBPACK_IMPORTED_MODULE_5__["config"].useDeprecatedSynchronousErrorHandling;
            if (this._error) {
                if (!useDeprecatedSynchronousErrorHandling || !_parentSubscriber.syncErrorThrowable) {
                    this.__tryOrUnsub(this._error, err);
                    this.unsubscribe();
                }
                else {
                    this.__tryOrSetError(_parentSubscriber, this._error, err);
                    this.unsubscribe();
                }
            }
            else if (!_parentSubscriber.syncErrorThrowable) {
                this.unsubscribe();
                if (useDeprecatedSynchronousErrorHandling) {
                    throw err;
                }
                Object(_util_hostReportError__WEBPACK_IMPORTED_MODULE_6__["hostReportError"])(err);
            }
            else {
                if (useDeprecatedSynchronousErrorHandling) {
                    _parentSubscriber.syncErrorValue = err;
                    _parentSubscriber.syncErrorThrown = true;
                }
                else {
                    Object(_util_hostReportError__WEBPACK_IMPORTED_MODULE_6__["hostReportError"])(err);
                }
                this.unsubscribe();
            }
        }
    };
    SafeSubscriber.prototype.complete = function () {
        var _this = this;
        if (!this.isStopped) {
            var _parentSubscriber = this._parentSubscriber;
            if (this._complete) {
                var wrappedComplete = function () { return _this._complete.call(_this._context); };
                if (!_config__WEBPACK_IMPORTED_MODULE_5__["config"].useDeprecatedSynchronousErrorHandling || !_parentSubscriber.syncErrorThrowable) {
                    this.__tryOrUnsub(wrappedComplete);
                    this.unsubscribe();
                }
                else {
                    this.__tryOrSetError(_parentSubscriber, wrappedComplete);
                    this.unsubscribe();
                }
            }
            else {
                this.unsubscribe();
            }
        }
    };
    SafeSubscriber.prototype.__tryOrUnsub = function (fn, value) {
        try {
            fn.call(this._context, value);
        }
        catch (err) {
            this.unsubscribe();
            if (_config__WEBPACK_IMPORTED_MODULE_5__["config"].useDeprecatedSynchronousErrorHandling) {
                throw err;
            }
            else {
                Object(_util_hostReportError__WEBPACK_IMPORTED_MODULE_6__["hostReportError"])(err);
            }
        }
    };
    SafeSubscriber.prototype.__tryOrSetError = function (parent, fn, value) {
        if (!_config__WEBPACK_IMPORTED_MODULE_5__["config"].useDeprecatedSynchronousErrorHandling) {
            throw new Error('bad call');
        }
        try {
            fn.call(this._context, value);
        }
        catch (err) {
            if (_config__WEBPACK_IMPORTED_MODULE_5__["config"].useDeprecatedSynchronousErrorHandling) {
                parent.syncErrorValue = err;
                parent.syncErrorThrown = true;
                return true;
            }
            else {
                Object(_util_hostReportError__WEBPACK_IMPORTED_MODULE_6__["hostReportError"])(err);
                return true;
            }
        }
        return false;
    };
    SafeSubscriber.prototype._unsubscribe = function () {
        var _parentSubscriber = this._parentSubscriber;
        this._context = null;
        this._parentSubscriber = null;
        _parentSubscriber.unsubscribe();
    };
    return SafeSubscriber;
}(Subscriber));

//# sourceMappingURL=Subscriber.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/Subscription.js":
/*!**********************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/Subscription.js ***!
  \**********************************************************/
/*! exports provided: Subscription */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Subscription", function() { return Subscription; });
/* harmony import */ var _util_isArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./util/isArray */ "./node_modules/rxjs/_esm5/internal/util/isArray.js");
/* harmony import */ var _util_isObject__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./util/isObject */ "./node_modules/rxjs/_esm5/internal/util/isObject.js");
/* harmony import */ var _util_isFunction__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./util/isFunction */ "./node_modules/rxjs/_esm5/internal/util/isFunction.js");
/* harmony import */ var _util_tryCatch__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./util/tryCatch */ "./node_modules/rxjs/_esm5/internal/util/tryCatch.js");
/* harmony import */ var _util_errorObject__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./util/errorObject */ "./node_modules/rxjs/_esm5/internal/util/errorObject.js");
/* harmony import */ var _util_UnsubscriptionError__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./util/UnsubscriptionError */ "./node_modules/rxjs/_esm5/internal/util/UnsubscriptionError.js");
/** PURE_IMPORTS_START _util_isArray,_util_isObject,_util_isFunction,_util_tryCatch,_util_errorObject,_util_UnsubscriptionError PURE_IMPORTS_END */






var Subscription = /*@__PURE__*/ (function () {
    function Subscription(unsubscribe) {
        this.closed = false;
        this._parent = null;
        this._parents = null;
        this._subscriptions = null;
        if (unsubscribe) {
            this._unsubscribe = unsubscribe;
        }
    }
    Subscription.prototype.unsubscribe = function () {
        var hasErrors = false;
        var errors;
        if (this.closed) {
            return;
        }
        var _a = this, _parent = _a._parent, _parents = _a._parents, _unsubscribe = _a._unsubscribe, _subscriptions = _a._subscriptions;
        this.closed = true;
        this._parent = null;
        this._parents = null;
        this._subscriptions = null;
        var index = -1;
        var len = _parents ? _parents.length : 0;
        while (_parent) {
            _parent.remove(this);
            _parent = ++index < len && _parents[index] || null;
        }
        if (Object(_util_isFunction__WEBPACK_IMPORTED_MODULE_2__["isFunction"])(_unsubscribe)) {
            var trial = Object(_util_tryCatch__WEBPACK_IMPORTED_MODULE_3__["tryCatch"])(_unsubscribe).call(this);
            if (trial === _util_errorObject__WEBPACK_IMPORTED_MODULE_4__["errorObject"]) {
                hasErrors = true;
                errors = errors || (_util_errorObject__WEBPACK_IMPORTED_MODULE_4__["errorObject"].e instanceof _util_UnsubscriptionError__WEBPACK_IMPORTED_MODULE_5__["UnsubscriptionError"] ?
                    flattenUnsubscriptionErrors(_util_errorObject__WEBPACK_IMPORTED_MODULE_4__["errorObject"].e.errors) : [_util_errorObject__WEBPACK_IMPORTED_MODULE_4__["errorObject"].e]);
            }
        }
        if (Object(_util_isArray__WEBPACK_IMPORTED_MODULE_0__["isArray"])(_subscriptions)) {
            index = -1;
            len = _subscriptions.length;
            while (++index < len) {
                var sub = _subscriptions[index];
                if (Object(_util_isObject__WEBPACK_IMPORTED_MODULE_1__["isObject"])(sub)) {
                    var trial = Object(_util_tryCatch__WEBPACK_IMPORTED_MODULE_3__["tryCatch"])(sub.unsubscribe).call(sub);
                    if (trial === _util_errorObject__WEBPACK_IMPORTED_MODULE_4__["errorObject"]) {
                        hasErrors = true;
                        errors = errors || [];
                        var err = _util_errorObject__WEBPACK_IMPORTED_MODULE_4__["errorObject"].e;
                        if (err instanceof _util_UnsubscriptionError__WEBPACK_IMPORTED_MODULE_5__["UnsubscriptionError"]) {
                            errors = errors.concat(flattenUnsubscriptionErrors(err.errors));
                        }
                        else {
                            errors.push(err);
                        }
                    }
                }
            }
        }
        if (hasErrors) {
            throw new _util_UnsubscriptionError__WEBPACK_IMPORTED_MODULE_5__["UnsubscriptionError"](errors);
        }
    };
    Subscription.prototype.add = function (teardown) {
        if (!teardown || (teardown === Subscription.EMPTY)) {
            return Subscription.EMPTY;
        }
        if (teardown === this) {
            return this;
        }
        var subscription = teardown;
        switch (typeof teardown) {
            case 'function':
                subscription = new Subscription(teardown);
            case 'object':
                if (subscription.closed || typeof subscription.unsubscribe !== 'function') {
                    return subscription;
                }
                else if (this.closed) {
                    subscription.unsubscribe();
                    return subscription;
                }
                else if (typeof subscription._addParent !== 'function') {
                    var tmp = subscription;
                    subscription = new Subscription();
                    subscription._subscriptions = [tmp];
                }
                break;
            default:
                throw new Error('unrecognized teardown ' + teardown + ' added to Subscription.');
        }
        var subscriptions = this._subscriptions || (this._subscriptions = []);
        subscriptions.push(subscription);
        subscription._addParent(this);
        return subscription;
    };
    Subscription.prototype.remove = function (subscription) {
        var subscriptions = this._subscriptions;
        if (subscriptions) {
            var subscriptionIndex = subscriptions.indexOf(subscription);
            if (subscriptionIndex !== -1) {
                subscriptions.splice(subscriptionIndex, 1);
            }
        }
    };
    Subscription.prototype._addParent = function (parent) {
        var _a = this, _parent = _a._parent, _parents = _a._parents;
        if (!_parent || _parent === parent) {
            this._parent = parent;
        }
        else if (!_parents) {
            this._parents = [parent];
        }
        else if (_parents.indexOf(parent) === -1) {
            _parents.push(parent);
        }
    };
    Subscription.EMPTY = (function (empty) {
        empty.closed = true;
        return empty;
    }(new Subscription()));
    return Subscription;
}());

function flattenUnsubscriptionErrors(errors) {
    return errors.reduce(function (errs, err) { return errs.concat((err instanceof _util_UnsubscriptionError__WEBPACK_IMPORTED_MODULE_5__["UnsubscriptionError"]) ? err.errors : err); }, []);
}
//# sourceMappingURL=Subscription.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/config.js":
/*!****************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/config.js ***!
  \****************************************************/
/*! exports provided: config */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "config", function() { return config; });
/** PURE_IMPORTS_START  PURE_IMPORTS_END */
var _enable_super_gross_mode_that_will_cause_bad_things = false;
var config = {
    Promise: undefined,
    set useDeprecatedSynchronousErrorHandling(value) {
        if (value) {
            var error = /*@__PURE__*/ new Error();
            /*@__PURE__*/ console.warn('DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n' + error.stack);
        }
        else if (_enable_super_gross_mode_that_will_cause_bad_things) {
            /*@__PURE__*/ console.log('RxJS: Back to a better error behavior. Thank you. <3');
        }
        _enable_super_gross_mode_that_will_cause_bad_things = value;
    },
    get useDeprecatedSynchronousErrorHandling() {
        return _enable_super_gross_mode_that_will_cause_bad_things;
    },
};
//# sourceMappingURL=config.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/observable/ConnectableObservable.js":
/*!******************************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/observable/ConnectableObservable.js ***!
  \******************************************************************************/
/*! exports provided: ConnectableObservable, connectableObservableDescriptor */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ConnectableObservable", function() { return ConnectableObservable; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "connectableObservableDescriptor", function() { return connectableObservableDescriptor; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _Subject__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Subject */ "./node_modules/rxjs/_esm5/internal/Subject.js");
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Observable */ "./node_modules/rxjs/_esm5/internal/Observable.js");
/* harmony import */ var _Subscriber__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Subscriber */ "./node_modules/rxjs/_esm5/internal/Subscriber.js");
/* harmony import */ var _Subscription__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../Subscription */ "./node_modules/rxjs/_esm5/internal/Subscription.js");
/* harmony import */ var _operators_refCount__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../operators/refCount */ "./node_modules/rxjs/_esm5/internal/operators/refCount.js");
/** PURE_IMPORTS_START tslib,_Subject,_Observable,_Subscriber,_Subscription,_operators_refCount PURE_IMPORTS_END */






var ConnectableObservable = /*@__PURE__*/ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ConnectableObservable, _super);
    function ConnectableObservable(source, subjectFactory) {
        var _this = _super.call(this) || this;
        _this.source = source;
        _this.subjectFactory = subjectFactory;
        _this._refCount = 0;
        _this._isComplete = false;
        return _this;
    }
    ConnectableObservable.prototype._subscribe = function (subscriber) {
        return this.getSubject().subscribe(subscriber);
    };
    ConnectableObservable.prototype.getSubject = function () {
        var subject = this._subject;
        if (!subject || subject.isStopped) {
            this._subject = this.subjectFactory();
        }
        return this._subject;
    };
    ConnectableObservable.prototype.connect = function () {
        var connection = this._connection;
        if (!connection) {
            this._isComplete = false;
            connection = this._connection = new _Subscription__WEBPACK_IMPORTED_MODULE_4__["Subscription"]();
            connection.add(this.source
                .subscribe(new ConnectableSubscriber(this.getSubject(), this)));
            if (connection.closed) {
                this._connection = null;
                connection = _Subscription__WEBPACK_IMPORTED_MODULE_4__["Subscription"].EMPTY;
            }
            else {
                this._connection = connection;
            }
        }
        return connection;
    };
    ConnectableObservable.prototype.refCount = function () {
        return Object(_operators_refCount__WEBPACK_IMPORTED_MODULE_5__["refCount"])()(this);
    };
    return ConnectableObservable;
}(_Observable__WEBPACK_IMPORTED_MODULE_2__["Observable"]));

var connectableProto = ConnectableObservable.prototype;
var connectableObservableDescriptor = {
    operator: { value: null },
    _refCount: { value: 0, writable: true },
    _subject: { value: null, writable: true },
    _connection: { value: null, writable: true },
    _subscribe: { value: connectableProto._subscribe },
    _isComplete: { value: connectableProto._isComplete, writable: true },
    getSubject: { value: connectableProto.getSubject },
    connect: { value: connectableProto.connect },
    refCount: { value: connectableProto.refCount }
};
var ConnectableSubscriber = /*@__PURE__*/ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ConnectableSubscriber, _super);
    function ConnectableSubscriber(destination, connectable) {
        var _this = _super.call(this, destination) || this;
        _this.connectable = connectable;
        return _this;
    }
    ConnectableSubscriber.prototype._error = function (err) {
        this._unsubscribe();
        _super.prototype._error.call(this, err);
    };
    ConnectableSubscriber.prototype._complete = function () {
        this.connectable._isComplete = true;
        this._unsubscribe();
        _super.prototype._complete.call(this);
    };
    ConnectableSubscriber.prototype._unsubscribe = function () {
        var connectable = this.connectable;
        if (connectable) {
            this.connectable = null;
            var connection = connectable._connection;
            connectable._refCount = 0;
            connectable._subject = null;
            connectable._connection = null;
            if (connection) {
                connection.unsubscribe();
            }
        }
    };
    return ConnectableSubscriber;
}(_Subject__WEBPACK_IMPORTED_MODULE_1__["SubjectSubscriber"]));
var RefCountOperator = /*@__PURE__*/ (function () {
    function RefCountOperator(connectable) {
        this.connectable = connectable;
    }
    RefCountOperator.prototype.call = function (subscriber, source) {
        var connectable = this.connectable;
        connectable._refCount++;
        var refCounter = new RefCountSubscriber(subscriber, connectable);
        var subscription = source.subscribe(refCounter);
        if (!refCounter.closed) {
            refCounter.connection = connectable.connect();
        }
        return subscription;
    };
    return RefCountOperator;
}());
var RefCountSubscriber = /*@__PURE__*/ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](RefCountSubscriber, _super);
    function RefCountSubscriber(destination, connectable) {
        var _this = _super.call(this, destination) || this;
        _this.connectable = connectable;
        return _this;
    }
    RefCountSubscriber.prototype._unsubscribe = function () {
        var connectable = this.connectable;
        if (!connectable) {
            this.connection = null;
            return;
        }
        this.connectable = null;
        var refCount = connectable._refCount;
        if (refCount <= 0) {
            this.connection = null;
            return;
        }
        connectable._refCount = refCount - 1;
        if (refCount > 1) {
            this.connection = null;
            return;
        }
        var connection = this.connection;
        var sharedConnection = connectable._connection;
        this.connection = null;
        if (sharedConnection && (!connection || sharedConnection === connection)) {
            sharedConnection.unsubscribe();
        }
    };
    return RefCountSubscriber;
}(_Subscriber__WEBPACK_IMPORTED_MODULE_3__["Subscriber"]));
//# sourceMappingURL=ConnectableObservable.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/observable/bindCallback.js":
/*!*********************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/observable/bindCallback.js ***!
  \*********************************************************************/
/*! exports provided: bindCallback */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "bindCallback", function() { return bindCallback; });
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Observable */ "./node_modules/rxjs/_esm5/internal/Observable.js");
/* harmony import */ var _AsyncSubject__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../AsyncSubject */ "./node_modules/rxjs/_esm5/internal/AsyncSubject.js");
/* harmony import */ var _operators_map__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../operators/map */ "./node_modules/rxjs/_esm5/internal/operators/map.js");
/* harmony import */ var _util_canReportError__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../util/canReportError */ "./node_modules/rxjs/_esm5/internal/util/canReportError.js");
/* harmony import */ var _util_isArray__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../util/isArray */ "./node_modules/rxjs/_esm5/internal/util/isArray.js");
/* harmony import */ var _util_isScheduler__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../util/isScheduler */ "./node_modules/rxjs/_esm5/internal/util/isScheduler.js");
/** PURE_IMPORTS_START _Observable,_AsyncSubject,_operators_map,_util_canReportError,_util_isArray,_util_isScheduler PURE_IMPORTS_END */






function bindCallback(callbackFunc, resultSelector, scheduler) {
    if (resultSelector) {
        if (Object(_util_isScheduler__WEBPACK_IMPORTED_MODULE_5__["isScheduler"])(resultSelector)) {
            scheduler = resultSelector;
        }
        else {
            return function () {
                var args = [];
                for (var _i = 0; _i < arguments.length; _i++) {
                    args[_i] = arguments[_i];
                }
                return bindCallback(callbackFunc, scheduler).apply(void 0, args).pipe(Object(_operators_map__WEBPACK_IMPORTED_MODULE_2__["map"])(function (args) { return Object(_util_isArray__WEBPACK_IMPORTED_MODULE_4__["isArray"])(args) ? resultSelector.apply(void 0, args) : resultSelector(args); }));
            };
        }
    }
    return function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        var context = this;
        var subject;
        var params = {
            context: context,
            subject: subject,
            callbackFunc: callbackFunc,
            scheduler: scheduler,
        };
        return new _Observable__WEBPACK_IMPORTED_MODULE_0__["Observable"](function (subscriber) {
            if (!scheduler) {
                if (!subject) {
                    subject = new _AsyncSubject__WEBPACK_IMPORTED_MODULE_1__["AsyncSubject"]();
                    var handler = function () {
                        var innerArgs = [];
                        for (var _i = 0; _i < arguments.length; _i++) {
                            innerArgs[_i] = arguments[_i];
                        }
                        subject.next(innerArgs.length <= 1 ? innerArgs[0] : innerArgs);
                        subject.complete();
                    };
                    try {
                        callbackFunc.apply(context, args.concat([handler]));
                    }
                    catch (err) {
                        if (Object(_util_canReportError__WEBPACK_IMPORTED_MODULE_3__["canReportError"])(subject)) {
                            subject.error(err);
                        }
                        else {
                            console.warn(err);
                        }
                    }
                }
                return subject.subscribe(subscriber);
            }
            else {
                var state = {
                    args: args, subscriber: subscriber, params: params,
                };
                return scheduler.schedule(dispatch, 0, state);
            }
        });
    };
}
function dispatch(state) {
    var _this = this;
    var self = this;
    var args = state.args, subscriber = state.subscriber, params = state.params;
    var callbackFunc = params.callbackFunc, context = params.context, scheduler = params.scheduler;
    var subject = params.subject;
    if (!subject) {
        subject = params.subject = new _AsyncSubject__WEBPACK_IMPORTED_MODULE_1__["AsyncSubject"]();
        var handler = function () {
            var innerArgs = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                innerArgs[_i] = arguments[_i];
            }
            var value = innerArgs.length <= 1 ? innerArgs[0] : innerArgs;
            _this.add(scheduler.schedule(dispatchNext, 0, { value: value, subject: subject }));
        };
        try {
            callbackFunc.apply(context, args.concat([handler]));
        }
        catch (err) {
            subject.error(err);
        }
    }
    this.add(subject.subscribe(subscriber));
}
function dispatchNext(state) {
    var value = state.value, subject = state.subject;
    subject.next(value);
    subject.complete();
}
function dispatchError(state) {
    var err = state.err, subject = state.subject;
    subject.error(err);
}
//# sourceMappingURL=bindCallback.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/observable/bindNodeCallback.js":
/*!*************************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/observable/bindNodeCallback.js ***!
  \*************************************************************************/
/*! exports provided: bindNodeCallback */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "bindNodeCallback", function() { return bindNodeCallback; });
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Observable */ "./node_modules/rxjs/_esm5/internal/Observable.js");
/* harmony import */ var _AsyncSubject__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../AsyncSubject */ "./node_modules/rxjs/_esm5/internal/AsyncSubject.js");
/* harmony import */ var _operators_map__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../operators/map */ "./node_modules/rxjs/_esm5/internal/operators/map.js");
/* harmony import */ var _util_canReportError__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../util/canReportError */ "./node_modules/rxjs/_esm5/internal/util/canReportError.js");
/* harmony import */ var _util_isScheduler__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../util/isScheduler */ "./node_modules/rxjs/_esm5/internal/util/isScheduler.js");
/* harmony import */ var _util_isArray__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../util/isArray */ "./node_modules/rxjs/_esm5/internal/util/isArray.js");
/** PURE_IMPORTS_START _Observable,_AsyncSubject,_operators_map,_util_canReportError,_util_isScheduler,_util_isArray PURE_IMPORTS_END */






function bindNodeCallback(callbackFunc, resultSelector, scheduler) {
    if (resultSelector) {
        if (Object(_util_isScheduler__WEBPACK_IMPORTED_MODULE_4__["isScheduler"])(resultSelector)) {
            scheduler = resultSelector;
        }
        else {
            return function () {
                var args = [];
                for (var _i = 0; _i < arguments.length; _i++) {
                    args[_i] = arguments[_i];
                }
                return bindNodeCallback(callbackFunc, scheduler).apply(void 0, args).pipe(Object(_operators_map__WEBPACK_IMPORTED_MODULE_2__["map"])(function (args) { return Object(_util_isArray__WEBPACK_IMPORTED_MODULE_5__["isArray"])(args) ? resultSelector.apply(void 0, args) : resultSelector(args); }));
            };
        }
    }
    return function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        var params = {
            subject: undefined,
            args: args,
            callbackFunc: callbackFunc,
            scheduler: scheduler,
            context: this,
        };
        return new _Observable__WEBPACK_IMPORTED_MODULE_0__["Observable"](function (subscriber) {
            var context = params.context;
            var subject = params.subject;
            if (!scheduler) {
                if (!subject) {
                    subject = params.subject = new _AsyncSubject__WEBPACK_IMPORTED_MODULE_1__["AsyncSubject"]();
                    var handler = function () {
                        var innerArgs = [];
                        for (var _i = 0; _i < arguments.length; _i++) {
                            innerArgs[_i] = arguments[_i];
                        }
                        var err = innerArgs.shift();
                        if (err) {
                            subject.error(err);
                            return;
                        }
                        subject.next(innerArgs.length <= 1 ? innerArgs[0] : innerArgs);
                        subject.complete();
                    };
                    try {
                        callbackFunc.apply(context, args.concat([handler]));
                    }
                    catch (err) {
                        if (Object(_util_canReportError__WEBPACK_IMPORTED_MODULE_3__["canReportError"])(subject)) {
                            subject.error(err);
                        }
                        else {
                            console.warn(err);
                        }
                    }
                }
                return subject.subscribe(subscriber);
            }
            else {
                return scheduler.schedule(dispatch, 0, { params: params, subscriber: subscriber, context: context });
            }
        });
    };
}
function dispatch(state) {
    var _this = this;
    var params = state.params, subscriber = state.subscriber, context = state.context;
    var callbackFunc = params.callbackFunc, args = params.args, scheduler = params.scheduler;
    var subject = params.subject;
    if (!subject) {
        subject = params.subject = new _AsyncSubject__WEBPACK_IMPORTED_MODULE_1__["AsyncSubject"]();
        var handler = function () {
            var innerArgs = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                innerArgs[_i] = arguments[_i];
            }
            var err = innerArgs.shift();
            if (err) {
                _this.add(scheduler.schedule(dispatchError, 0, { err: err, subject: subject }));
            }
            else {
                var value = innerArgs.length <= 1 ? innerArgs[0] : innerArgs;
                _this.add(scheduler.schedule(dispatchNext, 0, { value: value, subject: subject }));
            }
        };
        try {
            callbackFunc.apply(context, args.concat([handler]));
        }
        catch (err) {
            this.add(scheduler.schedule(dispatchError, 0, { err: err, subject: subject }));
        }
    }
    this.add(subject.subscribe(subscriber));
}
function dispatchNext(arg) {
    var value = arg.value, subject = arg.subject;
    subject.next(value);
    subject.complete();
}
function dispatchError(arg) {
    var err = arg.err, subject = arg.subject;
    subject.error(err);
}
//# sourceMappingURL=bindNodeCallback.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/observable/combineLatest.js":
/*!**********************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/observable/combineLatest.js ***!
  \**********************************************************************/
/*! exports provided: combineLatest, CombineLatestOperator, CombineLatestSubscriber */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "combineLatest", function() { return combineLatest; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CombineLatestOperator", function() { return CombineLatestOperator; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CombineLatestSubscriber", function() { return CombineLatestSubscriber; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _util_isScheduler__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../util/isScheduler */ "./node_modules/rxjs/_esm5/internal/util/isScheduler.js");
/* harmony import */ var _util_isArray__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../util/isArray */ "./node_modules/rxjs/_esm5/internal/util/isArray.js");
/* harmony import */ var _OuterSubscriber__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../OuterSubscriber */ "./node_modules/rxjs/_esm5/internal/OuterSubscriber.js");
/* harmony import */ var _util_subscribeToResult__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../util/subscribeToResult */ "./node_modules/rxjs/_esm5/internal/util/subscribeToResult.js");
/* harmony import */ var _fromArray__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./fromArray */ "./node_modules/rxjs/_esm5/internal/observable/fromArray.js");
/** PURE_IMPORTS_START tslib,_util_isScheduler,_util_isArray,_OuterSubscriber,_util_subscribeToResult,_fromArray PURE_IMPORTS_END */






var NONE = {};
function combineLatest() {
    var observables = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        observables[_i] = arguments[_i];
    }
    var resultSelector = null;
    var scheduler = null;
    if (Object(_util_isScheduler__WEBPACK_IMPORTED_MODULE_1__["isScheduler"])(observables[observables.length - 1])) {
        scheduler = observables.pop();
    }
    if (typeof observables[observables.length - 1] === 'function') {
        resultSelector = observables.pop();
    }
    if (observables.length === 1 && Object(_util_isArray__WEBPACK_IMPORTED_MODULE_2__["isArray"])(observables[0])) {
        observables = observables[0];
    }
    return Object(_fromArray__WEBPACK_IMPORTED_MODULE_5__["fromArray"])(observables, scheduler).lift(new CombineLatestOperator(resultSelector));
}
var CombineLatestOperator = /*@__PURE__*/ (function () {
    function CombineLatestOperator(resultSelector) {
        this.resultSelector = resultSelector;
    }
    CombineLatestOperator.prototype.call = function (subscriber, source) {
        return source.subscribe(new CombineLatestSubscriber(subscriber, this.resultSelector));
    };
    return CombineLatestOperator;
}());

var CombineLatestSubscriber = /*@__PURE__*/ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](CombineLatestSubscriber, _super);
    function CombineLatestSubscriber(destination, resultSelector) {
        var _this = _super.call(this, destination) || this;
        _this.resultSelector = resultSelector;
        _this.active = 0;
        _this.values = [];
        _this.observables = [];
        return _this;
    }
    CombineLatestSubscriber.prototype._next = function (observable) {
        this.values.push(NONE);
        this.observables.push(observable);
    };
    CombineLatestSubscriber.prototype._complete = function () {
        var observables = this.observables;
        var len = observables.length;
        if (len === 0) {
            this.destination.complete();
        }
        else {
            this.active = len;
            this.toRespond = len;
            for (var i = 0; i < len; i++) {
                var observable = observables[i];
                this.add(Object(_util_subscribeToResult__WEBPACK_IMPORTED_MODULE_4__["subscribeToResult"])(this, observable, observable, i));
            }
        }
    };
    CombineLatestSubscriber.prototype.notifyComplete = function (unused) {
        if ((this.active -= 1) === 0) {
            this.destination.complete();
        }
    };
    CombineLatestSubscriber.prototype.notifyNext = function (outerValue, innerValue, outerIndex, innerIndex, innerSub) {
        var values = this.values;
        var oldVal = values[outerIndex];
        var toRespond = !this.toRespond
            ? 0
            : oldVal === NONE ? --this.toRespond : this.toRespond;
        values[outerIndex] = innerValue;
        if (toRespond === 0) {
            if (this.resultSelector) {
                this._tryResultSelector(values);
            }
            else {
                this.destination.next(values.slice());
            }
        }
    };
    CombineLatestSubscriber.prototype._tryResultSelector = function (values) {
        var result;
        try {
            result = this.resultSelector.apply(this, values);
        }
        catch (err) {
            this.destination.error(err);
            return;
        }
        this.destination.next(result);
    };
    return CombineLatestSubscriber;
}(_OuterSubscriber__WEBPACK_IMPORTED_MODULE_3__["OuterSubscriber"]));

//# sourceMappingURL=combineLatest.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/observable/concat.js":
/*!***************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/observable/concat.js ***!
  \***************************************************************/
/*! exports provided: concat */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "concat", function() { return concat; });
/* harmony import */ var _util_isScheduler__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../util/isScheduler */ "./node_modules/rxjs/_esm5/internal/util/isScheduler.js");
/* harmony import */ var _of__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./of */ "./node_modules/rxjs/_esm5/internal/observable/of.js");
/* harmony import */ var _from__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./from */ "./node_modules/rxjs/_esm5/internal/observable/from.js");
/* harmony import */ var _operators_concatAll__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../operators/concatAll */ "./node_modules/rxjs/_esm5/internal/operators/concatAll.js");
/** PURE_IMPORTS_START _util_isScheduler,_of,_from,_operators_concatAll PURE_IMPORTS_END */




function concat() {
    var observables = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        observables[_i] = arguments[_i];
    }
    if (observables.length === 1 || (observables.length === 2 && Object(_util_isScheduler__WEBPACK_IMPORTED_MODULE_0__["isScheduler"])(observables[1]))) {
        return Object(_from__WEBPACK_IMPORTED_MODULE_2__["from"])(observables[0]);
    }
    return Object(_operators_concatAll__WEBPACK_IMPORTED_MODULE_3__["concatAll"])()(_of__WEBPACK_IMPORTED_MODULE_1__["of"].apply(void 0, observables));
}
//# sourceMappingURL=concat.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/observable/defer.js":
/*!**************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/observable/defer.js ***!
  \**************************************************************/
/*! exports provided: defer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "defer", function() { return defer; });
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Observable */ "./node_modules/rxjs/_esm5/internal/Observable.js");
/* harmony import */ var _from__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./from */ "./node_modules/rxjs/_esm5/internal/observable/from.js");
/* harmony import */ var _empty__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./empty */ "./node_modules/rxjs/_esm5/internal/observable/empty.js");
/** PURE_IMPORTS_START _Observable,_from,_empty PURE_IMPORTS_END */



function defer(observableFactory) {
    return new _Observable__WEBPACK_IMPORTED_MODULE_0__["Observable"](function (subscriber) {
        var input;
        try {
            input = observableFactory();
        }
        catch (err) {
            subscriber.error(err);
            return undefined;
        }
        var source = input ? Object(_from__WEBPACK_IMPORTED_MODULE_1__["from"])(input) : Object(_empty__WEBPACK_IMPORTED_MODULE_2__["empty"])();
        return source.subscribe(subscriber);
    });
}
//# sourceMappingURL=defer.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/observable/empty.js":
/*!**************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/observable/empty.js ***!
  \**************************************************************/
/*! exports provided: EMPTY, empty, emptyScheduled */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EMPTY", function() { return EMPTY; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "empty", function() { return empty; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "emptyScheduled", function() { return emptyScheduled; });
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Observable */ "./node_modules/rxjs/_esm5/internal/Observable.js");
/** PURE_IMPORTS_START _Observable PURE_IMPORTS_END */

var EMPTY = /*@__PURE__*/ new _Observable__WEBPACK_IMPORTED_MODULE_0__["Observable"](function (subscriber) { return subscriber.complete(); });
function empty(scheduler) {
    return scheduler ? emptyScheduled(scheduler) : EMPTY;
}
function emptyScheduled(scheduler) {
    return new _Observable__WEBPACK_IMPORTED_MODULE_0__["Observable"](function (subscriber) { return scheduler.schedule(function () { return subscriber.complete(); }); });
}
//# sourceMappingURL=empty.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/observable/forkJoin.js":
/*!*****************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/observable/forkJoin.js ***!
  \*****************************************************************/
/*! exports provided: forkJoin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "forkJoin", function() { return forkJoin; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Observable */ "./node_modules/rxjs/_esm5/internal/Observable.js");
/* harmony import */ var _util_isArray__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../util/isArray */ "./node_modules/rxjs/_esm5/internal/util/isArray.js");
/* harmony import */ var _empty__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./empty */ "./node_modules/rxjs/_esm5/internal/observable/empty.js");
/* harmony import */ var _util_subscribeToResult__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../util/subscribeToResult */ "./node_modules/rxjs/_esm5/internal/util/subscribeToResult.js");
/* harmony import */ var _OuterSubscriber__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../OuterSubscriber */ "./node_modules/rxjs/_esm5/internal/OuterSubscriber.js");
/* harmony import */ var _operators_map__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../operators/map */ "./node_modules/rxjs/_esm5/internal/operators/map.js");
/** PURE_IMPORTS_START tslib,_Observable,_util_isArray,_empty,_util_subscribeToResult,_OuterSubscriber,_operators_map PURE_IMPORTS_END */







function forkJoin() {
    var sources = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        sources[_i] = arguments[_i];
    }
    var resultSelector;
    if (typeof sources[sources.length - 1] === 'function') {
        resultSelector = sources.pop();
    }
    if (sources.length === 1 && Object(_util_isArray__WEBPACK_IMPORTED_MODULE_2__["isArray"])(sources[0])) {
        sources = sources[0];
    }
    if (sources.length === 0) {
        return _empty__WEBPACK_IMPORTED_MODULE_3__["EMPTY"];
    }
    if (resultSelector) {
        return forkJoin(sources).pipe(Object(_operators_map__WEBPACK_IMPORTED_MODULE_6__["map"])(function (args) { return resultSelector.apply(void 0, args); }));
    }
    return new _Observable__WEBPACK_IMPORTED_MODULE_1__["Observable"](function (subscriber) {
        return new ForkJoinSubscriber(subscriber, sources);
    });
}
var ForkJoinSubscriber = /*@__PURE__*/ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ForkJoinSubscriber, _super);
    function ForkJoinSubscriber(destination, sources) {
        var _this = _super.call(this, destination) || this;
        _this.sources = sources;
        _this.completed = 0;
        _this.haveValues = 0;
        var len = sources.length;
        _this.values = new Array(len);
        for (var i = 0; i < len; i++) {
            var source = sources[i];
            var innerSubscription = Object(_util_subscribeToResult__WEBPACK_IMPORTED_MODULE_4__["subscribeToResult"])(_this, source, null, i);
            if (innerSubscription) {
                _this.add(innerSubscription);
            }
        }
        return _this;
    }
    ForkJoinSubscriber.prototype.notifyNext = function (outerValue, innerValue, outerIndex, innerIndex, innerSub) {
        this.values[outerIndex] = innerValue;
        if (!innerSub._hasValue) {
            innerSub._hasValue = true;
            this.haveValues++;
        }
    };
    ForkJoinSubscriber.prototype.notifyComplete = function (innerSub) {
        var _a = this, destination = _a.destination, haveValues = _a.haveValues, values = _a.values;
        var len = values.length;
        if (!innerSub._hasValue) {
            destination.complete();
            return;
        }
        this.completed++;
        if (this.completed !== len) {
            return;
        }
        if (haveValues === len) {
            destination.next(values);
        }
        destination.complete();
    };
    return ForkJoinSubscriber;
}(_OuterSubscriber__WEBPACK_IMPORTED_MODULE_5__["OuterSubscriber"]));
//# sourceMappingURL=forkJoin.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/observable/from.js":
/*!*************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/observable/from.js ***!
  \*************************************************************/
/*! exports provided: from */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "from", function() { return from; });
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Observable */ "./node_modules/rxjs/_esm5/internal/Observable.js");
/* harmony import */ var _util_isPromise__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../util/isPromise */ "./node_modules/rxjs/_esm5/internal/util/isPromise.js");
/* harmony import */ var _util_isArrayLike__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../util/isArrayLike */ "./node_modules/rxjs/_esm5/internal/util/isArrayLike.js");
/* harmony import */ var _util_isInteropObservable__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../util/isInteropObservable */ "./node_modules/rxjs/_esm5/internal/util/isInteropObservable.js");
/* harmony import */ var _util_isIterable__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../util/isIterable */ "./node_modules/rxjs/_esm5/internal/util/isIterable.js");
/* harmony import */ var _fromArray__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./fromArray */ "./node_modules/rxjs/_esm5/internal/observable/fromArray.js");
/* harmony import */ var _fromPromise__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./fromPromise */ "./node_modules/rxjs/_esm5/internal/observable/fromPromise.js");
/* harmony import */ var _fromIterable__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./fromIterable */ "./node_modules/rxjs/_esm5/internal/observable/fromIterable.js");
/* harmony import */ var _fromObservable__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./fromObservable */ "./node_modules/rxjs/_esm5/internal/observable/fromObservable.js");
/* harmony import */ var _util_subscribeTo__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../util/subscribeTo */ "./node_modules/rxjs/_esm5/internal/util/subscribeTo.js");
/** PURE_IMPORTS_START _Observable,_util_isPromise,_util_isArrayLike,_util_isInteropObservable,_util_isIterable,_fromArray,_fromPromise,_fromIterable,_fromObservable,_util_subscribeTo PURE_IMPORTS_END */










function from(input, scheduler) {
    if (!scheduler) {
        if (input instanceof _Observable__WEBPACK_IMPORTED_MODULE_0__["Observable"]) {
            return input;
        }
        return new _Observable__WEBPACK_IMPORTED_MODULE_0__["Observable"](Object(_util_subscribeTo__WEBPACK_IMPORTED_MODULE_9__["subscribeTo"])(input));
    }
    if (input != null) {
        if (Object(_util_isInteropObservable__WEBPACK_IMPORTED_MODULE_3__["isInteropObservable"])(input)) {
            return Object(_fromObservable__WEBPACK_IMPORTED_MODULE_8__["fromObservable"])(input, scheduler);
        }
        else if (Object(_util_isPromise__WEBPACK_IMPORTED_MODULE_1__["isPromise"])(input)) {
            return Object(_fromPromise__WEBPACK_IMPORTED_MODULE_6__["fromPromise"])(input, scheduler);
        }
        else if (Object(_util_isArrayLike__WEBPACK_IMPORTED_MODULE_2__["isArrayLike"])(input)) {
            return Object(_fromArray__WEBPACK_IMPORTED_MODULE_5__["fromArray"])(input, scheduler);
        }
        else if (Object(_util_isIterable__WEBPACK_IMPORTED_MODULE_4__["isIterable"])(input) || typeof input === 'string') {
            return Object(_fromIterable__WEBPACK_IMPORTED_MODULE_7__["fromIterable"])(input, scheduler);
        }
    }
    throw new TypeError((input !== null && typeof input || input) + ' is not observable');
}
//# sourceMappingURL=from.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/observable/fromArray.js":
/*!******************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/observable/fromArray.js ***!
  \******************************************************************/
/*! exports provided: fromArray */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "fromArray", function() { return fromArray; });
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Observable */ "./node_modules/rxjs/_esm5/internal/Observable.js");
/* harmony import */ var _Subscription__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Subscription */ "./node_modules/rxjs/_esm5/internal/Subscription.js");
/* harmony import */ var _util_subscribeToArray__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../util/subscribeToArray */ "./node_modules/rxjs/_esm5/internal/util/subscribeToArray.js");
/** PURE_IMPORTS_START _Observable,_Subscription,_util_subscribeToArray PURE_IMPORTS_END */



function fromArray(input, scheduler) {
    if (!scheduler) {
        return new _Observable__WEBPACK_IMPORTED_MODULE_0__["Observable"](Object(_util_subscribeToArray__WEBPACK_IMPORTED_MODULE_2__["subscribeToArray"])(input));
    }
    else {
        return new _Observable__WEBPACK_IMPORTED_MODULE_0__["Observable"](function (subscriber) {
            var sub = new _Subscription__WEBPACK_IMPORTED_MODULE_1__["Subscription"]();
            var i = 0;
            sub.add(scheduler.schedule(function () {
                if (i === input.length) {
                    subscriber.complete();
                    return;
                }
                subscriber.next(input[i++]);
                if (!subscriber.closed) {
                    sub.add(this.schedule());
                }
            }));
            return sub;
        });
    }
}
//# sourceMappingURL=fromArray.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/observable/fromEvent.js":
/*!******************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/observable/fromEvent.js ***!
  \******************************************************************/
/*! exports provided: fromEvent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "fromEvent", function() { return fromEvent; });
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Observable */ "./node_modules/rxjs/_esm5/internal/Observable.js");
/* harmony import */ var _util_isArray__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../util/isArray */ "./node_modules/rxjs/_esm5/internal/util/isArray.js");
/* harmony import */ var _util_isFunction__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../util/isFunction */ "./node_modules/rxjs/_esm5/internal/util/isFunction.js");
/* harmony import */ var _operators_map__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../operators/map */ "./node_modules/rxjs/_esm5/internal/operators/map.js");
/** PURE_IMPORTS_START _Observable,_util_isArray,_util_isFunction,_operators_map PURE_IMPORTS_END */




var toString = Object.prototype.toString;
function fromEvent(target, eventName, options, resultSelector) {
    if (Object(_util_isFunction__WEBPACK_IMPORTED_MODULE_2__["isFunction"])(options)) {
        resultSelector = options;
        options = undefined;
    }
    if (resultSelector) {
        return fromEvent(target, eventName, options).pipe(Object(_operators_map__WEBPACK_IMPORTED_MODULE_3__["map"])(function (args) { return Object(_util_isArray__WEBPACK_IMPORTED_MODULE_1__["isArray"])(args) ? resultSelector.apply(void 0, args) : resultSelector(args); }));
    }
    return new _Observable__WEBPACK_IMPORTED_MODULE_0__["Observable"](function (subscriber) {
        function handler(e) {
            if (arguments.length > 1) {
                subscriber.next(Array.prototype.slice.call(arguments));
            }
            else {
                subscriber.next(e);
            }
        }
        setupSubscription(target, eventName, handler, subscriber, options);
    });
}
function setupSubscription(sourceObj, eventName, handler, subscriber, options) {
    var unsubscribe;
    if (isEventTarget(sourceObj)) {
        var source_1 = sourceObj;
        sourceObj.addEventListener(eventName, handler, options);
        unsubscribe = function () { return source_1.removeEventListener(eventName, handler, options); };
    }
    else if (isJQueryStyleEventEmitter(sourceObj)) {
        var source_2 = sourceObj;
        sourceObj.on(eventName, handler);
        unsubscribe = function () { return source_2.off(eventName, handler); };
    }
    else if (isNodeStyleEventEmitter(sourceObj)) {
        var source_3 = sourceObj;
        sourceObj.addListener(eventName, handler);
        unsubscribe = function () { return source_3.removeListener(eventName, handler); };
    }
    else if (sourceObj && sourceObj.length) {
        for (var i = 0, len = sourceObj.length; i < len; i++) {
            setupSubscription(sourceObj[i], eventName, handler, subscriber, options);
        }
    }
    else {
        throw new TypeError('Invalid event target');
    }
    subscriber.add(unsubscribe);
}
function isNodeStyleEventEmitter(sourceObj) {
    return sourceObj && typeof sourceObj.addListener === 'function' && typeof sourceObj.removeListener === 'function';
}
function isJQueryStyleEventEmitter(sourceObj) {
    return sourceObj && typeof sourceObj.on === 'function' && typeof sourceObj.off === 'function';
}
function isEventTarget(sourceObj) {
    return sourceObj && typeof sourceObj.addEventListener === 'function' && typeof sourceObj.removeEventListener === 'function';
}
//# sourceMappingURL=fromEvent.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/observable/fromEventPattern.js":
/*!*************************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/observable/fromEventPattern.js ***!
  \*************************************************************************/
/*! exports provided: fromEventPattern */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "fromEventPattern", function() { return fromEventPattern; });
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Observable */ "./node_modules/rxjs/_esm5/internal/Observable.js");
/* harmony import */ var _util_isArray__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../util/isArray */ "./node_modules/rxjs/_esm5/internal/util/isArray.js");
/* harmony import */ var _util_isFunction__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../util/isFunction */ "./node_modules/rxjs/_esm5/internal/util/isFunction.js");
/* harmony import */ var _operators_map__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../operators/map */ "./node_modules/rxjs/_esm5/internal/operators/map.js");
/** PURE_IMPORTS_START _Observable,_util_isArray,_util_isFunction,_operators_map PURE_IMPORTS_END */




function fromEventPattern(addHandler, removeHandler, resultSelector) {
    if (resultSelector) {
        return fromEventPattern(addHandler, removeHandler).pipe(Object(_operators_map__WEBPACK_IMPORTED_MODULE_3__["map"])(function (args) { return Object(_util_isArray__WEBPACK_IMPORTED_MODULE_1__["isArray"])(args) ? resultSelector.apply(void 0, args) : resultSelector(args); }));
    }
    return new _Observable__WEBPACK_IMPORTED_MODULE_0__["Observable"](function (subscriber) {
        var handler = function () {
            var e = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                e[_i] = arguments[_i];
            }
            return subscriber.next(e.length === 1 ? e[0] : e);
        };
        var retValue;
        try {
            retValue = addHandler(handler);
        }
        catch (err) {
            subscriber.error(err);
            return undefined;
        }
        if (!Object(_util_isFunction__WEBPACK_IMPORTED_MODULE_2__["isFunction"])(removeHandler)) {
            return undefined;
        }
        return function () { return removeHandler(handler, retValue); };
    });
}
//# sourceMappingURL=fromEventPattern.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/observable/fromIterable.js":
/*!*********************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/observable/fromIterable.js ***!
  \*********************************************************************/
/*! exports provided: fromIterable */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "fromIterable", function() { return fromIterable; });
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Observable */ "./node_modules/rxjs/_esm5/internal/Observable.js");
/* harmony import */ var _Subscription__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Subscription */ "./node_modules/rxjs/_esm5/internal/Subscription.js");
/* harmony import */ var _symbol_iterator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../symbol/iterator */ "./node_modules/rxjs/_esm5/internal/symbol/iterator.js");
/* harmony import */ var _util_subscribeToIterable__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../util/subscribeToIterable */ "./node_modules/rxjs/_esm5/internal/util/subscribeToIterable.js");
/** PURE_IMPORTS_START _Observable,_Subscription,_symbol_iterator,_util_subscribeToIterable PURE_IMPORTS_END */




function fromIterable(input, scheduler) {
    if (!input) {
        throw new Error('Iterable cannot be null');
    }
    if (!scheduler) {
        return new _Observable__WEBPACK_IMPORTED_MODULE_0__["Observable"](Object(_util_subscribeToIterable__WEBPACK_IMPORTED_MODULE_3__["subscribeToIterable"])(input));
    }
    else {
        return new _Observable__WEBPACK_IMPORTED_MODULE_0__["Observable"](function (subscriber) {
            var sub = new _Subscription__WEBPACK_IMPORTED_MODULE_1__["Subscription"]();
            var iterator;
            sub.add(function () {
                if (iterator && typeof iterator.return === 'function') {
                    iterator.return();
                }
            });
            sub.add(scheduler.schedule(function () {
                iterator = input[_symbol_iterator__WEBPACK_IMPORTED_MODULE_2__["iterator"]]();
                sub.add(scheduler.schedule(function () {
                    if (subscriber.closed) {
                        return;
                    }
                    var value;
                    var done;
                    try {
                        var result = iterator.next();
                        value = result.value;
                        done = result.done;
                    }
                    catch (err) {
                        subscriber.error(err);
                        return;
                    }
                    if (done) {
                        subscriber.complete();
                    }
                    else {
                        subscriber.next(value);
                        this.schedule();
                    }
                }));
            }));
            return sub;
        });
    }
}
//# sourceMappingURL=fromIterable.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/observable/fromObservable.js":
/*!***********************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/observable/fromObservable.js ***!
  \***********************************************************************/
/*! exports provided: fromObservable */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "fromObservable", function() { return fromObservable; });
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Observable */ "./node_modules/rxjs/_esm5/internal/Observable.js");
/* harmony import */ var _Subscription__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Subscription */ "./node_modules/rxjs/_esm5/internal/Subscription.js");
/* harmony import */ var _symbol_observable__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../symbol/observable */ "./node_modules/rxjs/_esm5/internal/symbol/observable.js");
/* harmony import */ var _util_subscribeToObservable__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../util/subscribeToObservable */ "./node_modules/rxjs/_esm5/internal/util/subscribeToObservable.js");
/** PURE_IMPORTS_START _Observable,_Subscription,_symbol_observable,_util_subscribeToObservable PURE_IMPORTS_END */




function fromObservable(input, scheduler) {
    if (!scheduler) {
        return new _Observable__WEBPACK_IMPORTED_MODULE_0__["Observable"](Object(_util_subscribeToObservable__WEBPACK_IMPORTED_MODULE_3__["subscribeToObservable"])(input));
    }
    else {
        return new _Observable__WEBPACK_IMPORTED_MODULE_0__["Observable"](function (subscriber) {
            var sub = new _Subscription__WEBPACK_IMPORTED_MODULE_1__["Subscription"]();
            sub.add(scheduler.schedule(function () {
                var observable = input[_symbol_observable__WEBPACK_IMPORTED_MODULE_2__["observable"]]();
                sub.add(observable.subscribe({
                    next: function (value) { sub.add(scheduler.schedule(function () { return subscriber.next(value); })); },
                    error: function (err) { sub.add(scheduler.schedule(function () { return subscriber.error(err); })); },
                    complete: function () { sub.add(scheduler.schedule(function () { return subscriber.complete(); })); },
                }));
            }));
            return sub;
        });
    }
}
//# sourceMappingURL=fromObservable.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/observable/fromPromise.js":
/*!********************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/observable/fromPromise.js ***!
  \********************************************************************/
/*! exports provided: fromPromise */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "fromPromise", function() { return fromPromise; });
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Observable */ "./node_modules/rxjs/_esm5/internal/Observable.js");
/* harmony import */ var _Subscription__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Subscription */ "./node_modules/rxjs/_esm5/internal/Subscription.js");
/* harmony import */ var _util_subscribeToPromise__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../util/subscribeToPromise */ "./node_modules/rxjs/_esm5/internal/util/subscribeToPromise.js");
/** PURE_IMPORTS_START _Observable,_Subscription,_util_subscribeToPromise PURE_IMPORTS_END */



function fromPromise(input, scheduler) {
    if (!scheduler) {
        return new _Observable__WEBPACK_IMPORTED_MODULE_0__["Observable"](Object(_util_subscribeToPromise__WEBPACK_IMPORTED_MODULE_2__["subscribeToPromise"])(input));
    }
    else {
        return new _Observable__WEBPACK_IMPORTED_MODULE_0__["Observable"](function (subscriber) {
            var sub = new _Subscription__WEBPACK_IMPORTED_MODULE_1__["Subscription"]();
            sub.add(scheduler.schedule(function () {
                return input.then(function (value) {
                    sub.add(scheduler.schedule(function () {
                        subscriber.next(value);
                        sub.add(scheduler.schedule(function () { return subscriber.complete(); }));
                    }));
                }, function (err) {
                    sub.add(scheduler.schedule(function () { return subscriber.error(err); }));
                });
            }));
            return sub;
        });
    }
}
//# sourceMappingURL=fromPromise.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/observable/generate.js":
/*!*****************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/observable/generate.js ***!
  \*****************************************************************/
/*! exports provided: generate */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "generate", function() { return generate; });
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Observable */ "./node_modules/rxjs/_esm5/internal/Observable.js");
/* harmony import */ var _util_identity__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../util/identity */ "./node_modules/rxjs/_esm5/internal/util/identity.js");
/* harmony import */ var _util_isScheduler__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../util/isScheduler */ "./node_modules/rxjs/_esm5/internal/util/isScheduler.js");
/** PURE_IMPORTS_START _Observable,_util_identity,_util_isScheduler PURE_IMPORTS_END */



function generate(initialStateOrOptions, condition, iterate, resultSelectorOrObservable, scheduler) {
    var resultSelector;
    var initialState;
    if (arguments.length == 1) {
        var options = initialStateOrOptions;
        initialState = options.initialState;
        condition = options.condition;
        iterate = options.iterate;
        resultSelector = options.resultSelector || _util_identity__WEBPACK_IMPORTED_MODULE_1__["identity"];
        scheduler = options.scheduler;
    }
    else if (resultSelectorOrObservable === undefined || Object(_util_isScheduler__WEBPACK_IMPORTED_MODULE_2__["isScheduler"])(resultSelectorOrObservable)) {
        initialState = initialStateOrOptions;
        resultSelector = _util_identity__WEBPACK_IMPORTED_MODULE_1__["identity"];
        scheduler = resultSelectorOrObservable;
    }
    else {
        initialState = initialStateOrOptions;
        resultSelector = resultSelectorOrObservable;
    }
    return new _Observable__WEBPACK_IMPORTED_MODULE_0__["Observable"](function (subscriber) {
        var state = initialState;
        if (scheduler) {
            return scheduler.schedule(dispatch, 0, {
                subscriber: subscriber,
                iterate: iterate,
                condition: condition,
                resultSelector: resultSelector,
                state: state
            });
        }
        do {
            if (condition) {
                var conditionResult = void 0;
                try {
                    conditionResult = condition(state);
                }
                catch (err) {
                    subscriber.error(err);
                    return undefined;
                }
                if (!conditionResult) {
                    subscriber.complete();
                    break;
                }
            }
            var value = void 0;
            try {
                value = resultSelector(state);
            }
            catch (err) {
                subscriber.error(err);
                return undefined;
            }
            subscriber.next(value);
            if (subscriber.closed) {
                break;
            }
            try {
                state = iterate(state);
            }
            catch (err) {
                subscriber.error(err);
                return undefined;
            }
        } while (true);
        return undefined;
    });
}
function dispatch(state) {
    var subscriber = state.subscriber, condition = state.condition;
    if (subscriber.closed) {
        return undefined;
    }
    if (state.needIterate) {
        try {
            state.state = state.iterate(state.state);
        }
        catch (err) {
            subscriber.error(err);
            return undefined;
        }
    }
    else {
        state.needIterate = true;
    }
    if (condition) {
        var conditionResult = void 0;
        try {
            conditionResult = condition(state.state);
        }
        catch (err) {
            subscriber.error(err);
            return undefined;
        }
        if (!conditionResult) {
            subscriber.complete();
            return undefined;
        }
        if (subscriber.closed) {
            return undefined;
        }
    }
    var value;
    try {
        value = state.resultSelector(state.state);
    }
    catch (err) {
        subscriber.error(err);
        return undefined;
    }
    if (subscriber.closed) {
        return undefined;
    }
    subscriber.next(value);
    if (subscriber.closed) {
        return undefined;
    }
    return this.schedule(state);
}
//# sourceMappingURL=generate.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/observable/iif.js":
/*!************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/observable/iif.js ***!
  \************************************************************/
/*! exports provided: iif */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "iif", function() { return iif; });
/* harmony import */ var _defer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./defer */ "./node_modules/rxjs/_esm5/internal/observable/defer.js");
/* harmony import */ var _empty__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./empty */ "./node_modules/rxjs/_esm5/internal/observable/empty.js");
/** PURE_IMPORTS_START _defer,_empty PURE_IMPORTS_END */


function iif(condition, trueResult, falseResult) {
    if (trueResult === void 0) {
        trueResult = _empty__WEBPACK_IMPORTED_MODULE_1__["EMPTY"];
    }
    if (falseResult === void 0) {
        falseResult = _empty__WEBPACK_IMPORTED_MODULE_1__["EMPTY"];
    }
    return Object(_defer__WEBPACK_IMPORTED_MODULE_0__["defer"])(function () { return condition() ? trueResult : falseResult; });
}
//# sourceMappingURL=iif.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/observable/interval.js":
/*!*****************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/observable/interval.js ***!
  \*****************************************************************/
/*! exports provided: interval */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "interval", function() { return interval; });
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Observable */ "./node_modules/rxjs/_esm5/internal/Observable.js");
/* harmony import */ var _scheduler_async__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../scheduler/async */ "./node_modules/rxjs/_esm5/internal/scheduler/async.js");
/* harmony import */ var _util_isNumeric__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../util/isNumeric */ "./node_modules/rxjs/_esm5/internal/util/isNumeric.js");
/** PURE_IMPORTS_START _Observable,_scheduler_async,_util_isNumeric PURE_IMPORTS_END */



function interval(period, scheduler) {
    if (period === void 0) {
        period = 0;
    }
    if (scheduler === void 0) {
        scheduler = _scheduler_async__WEBPACK_IMPORTED_MODULE_1__["async"];
    }
    if (!Object(_util_isNumeric__WEBPACK_IMPORTED_MODULE_2__["isNumeric"])(period) || period < 0) {
        period = 0;
    }
    if (!scheduler || typeof scheduler.schedule !== 'function') {
        scheduler = _scheduler_async__WEBPACK_IMPORTED_MODULE_1__["async"];
    }
    return new _Observable__WEBPACK_IMPORTED_MODULE_0__["Observable"](function (subscriber) {
        subscriber.add(scheduler.schedule(dispatch, period, { subscriber: subscriber, counter: 0, period: period }));
        return subscriber;
    });
}
function dispatch(state) {
    var subscriber = state.subscriber, counter = state.counter, period = state.period;
    subscriber.next(counter);
    this.schedule({ subscriber: subscriber, counter: counter + 1, period: period }, period);
}
//# sourceMappingURL=interval.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/observable/merge.js":
/*!**************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/observable/merge.js ***!
  \**************************************************************/
/*! exports provided: merge */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "merge", function() { return merge; });
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Observable */ "./node_modules/rxjs/_esm5/internal/Observable.js");
/* harmony import */ var _util_isScheduler__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../util/isScheduler */ "./node_modules/rxjs/_esm5/internal/util/isScheduler.js");
/* harmony import */ var _operators_mergeAll__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../operators/mergeAll */ "./node_modules/rxjs/_esm5/internal/operators/mergeAll.js");
/* harmony import */ var _fromArray__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./fromArray */ "./node_modules/rxjs/_esm5/internal/observable/fromArray.js");
/** PURE_IMPORTS_START _Observable,_util_isScheduler,_operators_mergeAll,_fromArray PURE_IMPORTS_END */




function merge() {
    var observables = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        observables[_i] = arguments[_i];
    }
    var concurrent = Number.POSITIVE_INFINITY;
    var scheduler = null;
    var last = observables[observables.length - 1];
    if (Object(_util_isScheduler__WEBPACK_IMPORTED_MODULE_1__["isScheduler"])(last)) {
        scheduler = observables.pop();
        if (observables.length > 1 && typeof observables[observables.length - 1] === 'number') {
            concurrent = observables.pop();
        }
    }
    else if (typeof last === 'number') {
        concurrent = observables.pop();
    }
    if (scheduler === null && observables.length === 1 && observables[0] instanceof _Observable__WEBPACK_IMPORTED_MODULE_0__["Observable"]) {
        return observables[0];
    }
    return Object(_operators_mergeAll__WEBPACK_IMPORTED_MODULE_2__["mergeAll"])(concurrent)(Object(_fromArray__WEBPACK_IMPORTED_MODULE_3__["fromArray"])(observables, scheduler));
}
//# sourceMappingURL=merge.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/observable/never.js":
/*!**************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/observable/never.js ***!
  \**************************************************************/
/*! exports provided: NEVER, never */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NEVER", function() { return NEVER; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "never", function() { return never; });
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Observable */ "./node_modules/rxjs/_esm5/internal/Observable.js");
/* harmony import */ var _util_noop__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../util/noop */ "./node_modules/rxjs/_esm5/internal/util/noop.js");
/** PURE_IMPORTS_START _Observable,_util_noop PURE_IMPORTS_END */


var NEVER = /*@__PURE__*/ new _Observable__WEBPACK_IMPORTED_MODULE_0__["Observable"](_util_noop__WEBPACK_IMPORTED_MODULE_1__["noop"]);
function never() {
    return NEVER;
}
//# sourceMappingURL=never.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/observable/of.js":
/*!***********************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/observable/of.js ***!
  \***********************************************************/
/*! exports provided: of */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "of", function() { return of; });
/* harmony import */ var _util_isScheduler__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../util/isScheduler */ "./node_modules/rxjs/_esm5/internal/util/isScheduler.js");
/* harmony import */ var _fromArray__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./fromArray */ "./node_modules/rxjs/_esm5/internal/observable/fromArray.js");
/* harmony import */ var _empty__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./empty */ "./node_modules/rxjs/_esm5/internal/observable/empty.js");
/* harmony import */ var _scalar__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./scalar */ "./node_modules/rxjs/_esm5/internal/observable/scalar.js");
/** PURE_IMPORTS_START _util_isScheduler,_fromArray,_empty,_scalar PURE_IMPORTS_END */




function of() {
    var args = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        args[_i] = arguments[_i];
    }
    var scheduler = args[args.length - 1];
    if (Object(_util_isScheduler__WEBPACK_IMPORTED_MODULE_0__["isScheduler"])(scheduler)) {
        args.pop();
    }
    else {
        scheduler = undefined;
    }
    switch (args.length) {
        case 0:
            return Object(_empty__WEBPACK_IMPORTED_MODULE_2__["empty"])(scheduler);
        case 1:
            return scheduler ? Object(_fromArray__WEBPACK_IMPORTED_MODULE_1__["fromArray"])(args, scheduler) : Object(_scalar__WEBPACK_IMPORTED_MODULE_3__["scalar"])(args[0]);
        default:
            return Object(_fromArray__WEBPACK_IMPORTED_MODULE_1__["fromArray"])(args, scheduler);
    }
}
//# sourceMappingURL=of.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/observable/onErrorResumeNext.js":
/*!**************************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/observable/onErrorResumeNext.js ***!
  \**************************************************************************/
/*! exports provided: onErrorResumeNext */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "onErrorResumeNext", function() { return onErrorResumeNext; });
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Observable */ "./node_modules/rxjs/_esm5/internal/Observable.js");
/* harmony import */ var _from__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./from */ "./node_modules/rxjs/_esm5/internal/observable/from.js");
/* harmony import */ var _util_isArray__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../util/isArray */ "./node_modules/rxjs/_esm5/internal/util/isArray.js");
/* harmony import */ var _empty__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./empty */ "./node_modules/rxjs/_esm5/internal/observable/empty.js");
/** PURE_IMPORTS_START _Observable,_from,_util_isArray,_empty PURE_IMPORTS_END */




function onErrorResumeNext() {
    var sources = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        sources[_i] = arguments[_i];
    }
    if (sources.length === 0) {
        return _empty__WEBPACK_IMPORTED_MODULE_3__["EMPTY"];
    }
    var first = sources[0], remainder = sources.slice(1);
    if (sources.length === 1 && Object(_util_isArray__WEBPACK_IMPORTED_MODULE_2__["isArray"])(first)) {
        return onErrorResumeNext.apply(void 0, first);
    }
    return new _Observable__WEBPACK_IMPORTED_MODULE_0__["Observable"](function (subscriber) {
        var subNext = function () { return subscriber.add(onErrorResumeNext.apply(void 0, remainder).subscribe(subscriber)); };
        return Object(_from__WEBPACK_IMPORTED_MODULE_1__["from"])(first).subscribe({
            next: function (value) { subscriber.next(value); },
            error: subNext,
            complete: subNext,
        });
    });
}
//# sourceMappingURL=onErrorResumeNext.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/observable/pairs.js":
/*!**************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/observable/pairs.js ***!
  \**************************************************************/
/*! exports provided: pairs, dispatch */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "pairs", function() { return pairs; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "dispatch", function() { return dispatch; });
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Observable */ "./node_modules/rxjs/_esm5/internal/Observable.js");
/* harmony import */ var _Subscription__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Subscription */ "./node_modules/rxjs/_esm5/internal/Subscription.js");
/** PURE_IMPORTS_START _Observable,_Subscription PURE_IMPORTS_END */


function pairs(obj, scheduler) {
    if (!scheduler) {
        return new _Observable__WEBPACK_IMPORTED_MODULE_0__["Observable"](function (subscriber) {
            var keys = Object.keys(obj);
            for (var i = 0; i < keys.length && !subscriber.closed; i++) {
                var key = keys[i];
                if (obj.hasOwnProperty(key)) {
                    subscriber.next([key, obj[key]]);
                }
            }
            subscriber.complete();
        });
    }
    else {
        return new _Observable__WEBPACK_IMPORTED_MODULE_0__["Observable"](function (subscriber) {
            var keys = Object.keys(obj);
            var subscription = new _Subscription__WEBPACK_IMPORTED_MODULE_1__["Subscription"]();
            subscription.add(scheduler.schedule(dispatch, 0, { keys: keys, index: 0, subscriber: subscriber, subscription: subscription, obj: obj }));
            return subscription;
        });
    }
}
function dispatch(state) {
    var keys = state.keys, index = state.index, subscriber = state.subscriber, subscription = state.subscription, obj = state.obj;
    if (!subscriber.closed) {
        if (index < keys.length) {
            var key = keys[index];
            subscriber.next([key, obj[key]]);
            subscription.add(this.schedule({ keys: keys, index: index + 1, subscriber: subscriber, subscription: subscription, obj: obj }));
        }
        else {
            subscriber.complete();
        }
    }
}
//# sourceMappingURL=pairs.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/observable/race.js":
/*!*************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/observable/race.js ***!
  \*************************************************************/
/*! exports provided: race, RaceOperator, RaceSubscriber */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "race", function() { return race; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RaceOperator", function() { return RaceOperator; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RaceSubscriber", function() { return RaceSubscriber; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _util_isArray__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../util/isArray */ "./node_modules/rxjs/_esm5/internal/util/isArray.js");
/* harmony import */ var _fromArray__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./fromArray */ "./node_modules/rxjs/_esm5/internal/observable/fromArray.js");
/* harmony import */ var _OuterSubscriber__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../OuterSubscriber */ "./node_modules/rxjs/_esm5/internal/OuterSubscriber.js");
/* harmony import */ var _util_subscribeToResult__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../util/subscribeToResult */ "./node_modules/rxjs/_esm5/internal/util/subscribeToResult.js");
/** PURE_IMPORTS_START tslib,_util_isArray,_fromArray,_OuterSubscriber,_util_subscribeToResult PURE_IMPORTS_END */





function race() {
    var observables = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        observables[_i] = arguments[_i];
    }
    if (observables.length === 1) {
        if (Object(_util_isArray__WEBPACK_IMPORTED_MODULE_1__["isArray"])(observables[0])) {
            observables = observables[0];
        }
        else {
            return observables[0];
        }
    }
    return Object(_fromArray__WEBPACK_IMPORTED_MODULE_2__["fromArray"])(observables, undefined).lift(new RaceOperator());
}
var RaceOperator = /*@__PURE__*/ (function () {
    function RaceOperator() {
    }
    RaceOperator.prototype.call = function (subscriber, source) {
        return source.subscribe(new RaceSubscriber(subscriber));
    };
    return RaceOperator;
}());

var RaceSubscriber = /*@__PURE__*/ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](RaceSubscriber, _super);
    function RaceSubscriber(destination) {
        var _this = _super.call(this, destination) || this;
        _this.hasFirst = false;
        _this.observables = [];
        _this.subscriptions = [];
        return _this;
    }
    RaceSubscriber.prototype._next = function (observable) {
        this.observables.push(observable);
    };
    RaceSubscriber.prototype._complete = function () {
        var observables = this.observables;
        var len = observables.length;
        if (len === 0) {
            this.destination.complete();
        }
        else {
            for (var i = 0; i < len && !this.hasFirst; i++) {
                var observable = observables[i];
                var subscription = Object(_util_subscribeToResult__WEBPACK_IMPORTED_MODULE_4__["subscribeToResult"])(this, observable, observable, i);
                if (this.subscriptions) {
                    this.subscriptions.push(subscription);
                }
                this.add(subscription);
            }
            this.observables = null;
        }
    };
    RaceSubscriber.prototype.notifyNext = function (outerValue, innerValue, outerIndex, innerIndex, innerSub) {
        if (!this.hasFirst) {
            this.hasFirst = true;
            for (var i = 0; i < this.subscriptions.length; i++) {
                if (i !== outerIndex) {
                    var subscription = this.subscriptions[i];
                    subscription.unsubscribe();
                    this.remove(subscription);
                }
            }
            this.subscriptions = null;
        }
        this.destination.next(innerValue);
    };
    return RaceSubscriber;
}(_OuterSubscriber__WEBPACK_IMPORTED_MODULE_3__["OuterSubscriber"]));

//# sourceMappingURL=race.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/observable/range.js":
/*!**************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/observable/range.js ***!
  \**************************************************************/
/*! exports provided: range, dispatch */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "range", function() { return range; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "dispatch", function() { return dispatch; });
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Observable */ "./node_modules/rxjs/_esm5/internal/Observable.js");
/** PURE_IMPORTS_START _Observable PURE_IMPORTS_END */

function range(start, count, scheduler) {
    if (start === void 0) {
        start = 0;
    }
    if (count === void 0) {
        count = 0;
    }
    return new _Observable__WEBPACK_IMPORTED_MODULE_0__["Observable"](function (subscriber) {
        var index = 0;
        var current = start;
        if (scheduler) {
            return scheduler.schedule(dispatch, 0, {
                index: index, count: count, start: start, subscriber: subscriber
            });
        }
        else {
            do {
                if (index++ >= count) {
                    subscriber.complete();
                    break;
                }
                subscriber.next(current++);
                if (subscriber.closed) {
                    break;
                }
            } while (true);
        }
        return undefined;
    });
}
function dispatch(state) {
    var start = state.start, index = state.index, count = state.count, subscriber = state.subscriber;
    if (index >= count) {
        subscriber.complete();
        return;
    }
    subscriber.next(start);
    if (subscriber.closed) {
        return;
    }
    state.index = index + 1;
    state.start = start + 1;
    this.schedule(state);
}
//# sourceMappingURL=range.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/observable/scalar.js":
/*!***************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/observable/scalar.js ***!
  \***************************************************************/
/*! exports provided: scalar */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "scalar", function() { return scalar; });
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Observable */ "./node_modules/rxjs/_esm5/internal/Observable.js");
/** PURE_IMPORTS_START _Observable PURE_IMPORTS_END */

function scalar(value) {
    var result = new _Observable__WEBPACK_IMPORTED_MODULE_0__["Observable"](function (subscriber) {
        subscriber.next(value);
        subscriber.complete();
    });
    result._isScalar = true;
    result.value = value;
    return result;
}
//# sourceMappingURL=scalar.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/observable/throwError.js":
/*!*******************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/observable/throwError.js ***!
  \*******************************************************************/
/*! exports provided: throwError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "throwError", function() { return throwError; });
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Observable */ "./node_modules/rxjs/_esm5/internal/Observable.js");
/** PURE_IMPORTS_START _Observable PURE_IMPORTS_END */

function throwError(error, scheduler) {
    if (!scheduler) {
        return new _Observable__WEBPACK_IMPORTED_MODULE_0__["Observable"](function (subscriber) { return subscriber.error(error); });
    }
    else {
        return new _Observable__WEBPACK_IMPORTED_MODULE_0__["Observable"](function (subscriber) { return scheduler.schedule(dispatch, 0, { error: error, subscriber: subscriber }); });
    }
}
function dispatch(_a) {
    var error = _a.error, subscriber = _a.subscriber;
    subscriber.error(error);
}
//# sourceMappingURL=throwError.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/observable/timer.js":
/*!**************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/observable/timer.js ***!
  \**************************************************************/
/*! exports provided: timer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "timer", function() { return timer; });
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Observable */ "./node_modules/rxjs/_esm5/internal/Observable.js");
/* harmony import */ var _scheduler_async__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../scheduler/async */ "./node_modules/rxjs/_esm5/internal/scheduler/async.js");
/* harmony import */ var _util_isNumeric__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../util/isNumeric */ "./node_modules/rxjs/_esm5/internal/util/isNumeric.js");
/* harmony import */ var _util_isScheduler__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../util/isScheduler */ "./node_modules/rxjs/_esm5/internal/util/isScheduler.js");
/** PURE_IMPORTS_START _Observable,_scheduler_async,_util_isNumeric,_util_isScheduler PURE_IMPORTS_END */




function timer(dueTime, periodOrScheduler, scheduler) {
    if (dueTime === void 0) {
        dueTime = 0;
    }
    var period = -1;
    if (Object(_util_isNumeric__WEBPACK_IMPORTED_MODULE_2__["isNumeric"])(periodOrScheduler)) {
        period = Number(periodOrScheduler) < 1 && 1 || Number(periodOrScheduler);
    }
    else if (Object(_util_isScheduler__WEBPACK_IMPORTED_MODULE_3__["isScheduler"])(periodOrScheduler)) {
        scheduler = periodOrScheduler;
    }
    if (!Object(_util_isScheduler__WEBPACK_IMPORTED_MODULE_3__["isScheduler"])(scheduler)) {
        scheduler = _scheduler_async__WEBPACK_IMPORTED_MODULE_1__["async"];
    }
    return new _Observable__WEBPACK_IMPORTED_MODULE_0__["Observable"](function (subscriber) {
        var due = Object(_util_isNumeric__WEBPACK_IMPORTED_MODULE_2__["isNumeric"])(dueTime)
            ? dueTime
            : (+dueTime - scheduler.now());
        return scheduler.schedule(dispatch, due, {
            index: 0, period: period, subscriber: subscriber
        });
    });
}
function dispatch(state) {
    var index = state.index, period = state.period, subscriber = state.subscriber;
    subscriber.next(index);
    if (subscriber.closed) {
        return;
    }
    else if (period === -1) {
        return subscriber.complete();
    }
    state.index = index + 1;
    this.schedule(state, period);
}
//# sourceMappingURL=timer.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/observable/using.js":
/*!**************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/observable/using.js ***!
  \**************************************************************/
/*! exports provided: using */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "using", function() { return using; });
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Observable */ "./node_modules/rxjs/_esm5/internal/Observable.js");
/* harmony import */ var _from__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./from */ "./node_modules/rxjs/_esm5/internal/observable/from.js");
/* harmony import */ var _empty__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./empty */ "./node_modules/rxjs/_esm5/internal/observable/empty.js");
/** PURE_IMPORTS_START _Observable,_from,_empty PURE_IMPORTS_END */



function using(resourceFactory, observableFactory) {
    return new _Observable__WEBPACK_IMPORTED_MODULE_0__["Observable"](function (subscriber) {
        var resource;
        try {
            resource = resourceFactory();
        }
        catch (err) {
            subscriber.error(err);
            return undefined;
        }
        var result;
        try {
            result = observableFactory(resource);
        }
        catch (err) {
            subscriber.error(err);
            return undefined;
        }
        var source = result ? Object(_from__WEBPACK_IMPORTED_MODULE_1__["from"])(result) : _empty__WEBPACK_IMPORTED_MODULE_2__["EMPTY"];
        var subscription = source.subscribe(subscriber);
        return function () {
            subscription.unsubscribe();
            if (resource) {
                resource.unsubscribe();
            }
        };
    });
}
//# sourceMappingURL=using.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/observable/zip.js":
/*!************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/observable/zip.js ***!
  \************************************************************/
/*! exports provided: zip, ZipOperator, ZipSubscriber */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "zip", function() { return zip; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ZipOperator", function() { return ZipOperator; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ZipSubscriber", function() { return ZipSubscriber; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _fromArray__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./fromArray */ "./node_modules/rxjs/_esm5/internal/observable/fromArray.js");
/* harmony import */ var _util_isArray__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../util/isArray */ "./node_modules/rxjs/_esm5/internal/util/isArray.js");
/* harmony import */ var _Subscriber__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Subscriber */ "./node_modules/rxjs/_esm5/internal/Subscriber.js");
/* harmony import */ var _OuterSubscriber__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../OuterSubscriber */ "./node_modules/rxjs/_esm5/internal/OuterSubscriber.js");
/* harmony import */ var _util_subscribeToResult__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../util/subscribeToResult */ "./node_modules/rxjs/_esm5/internal/util/subscribeToResult.js");
/* harmony import */ var _internal_symbol_iterator__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../internal/symbol/iterator */ "./node_modules/rxjs/_esm5/internal/symbol/iterator.js");
/** PURE_IMPORTS_START tslib,_fromArray,_util_isArray,_Subscriber,_OuterSubscriber,_util_subscribeToResult,_.._internal_symbol_iterator PURE_IMPORTS_END */







function zip() {
    var observables = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        observables[_i] = arguments[_i];
    }
    var resultSelector = observables[observables.length - 1];
    if (typeof resultSelector === 'function') {
        observables.pop();
    }
    return Object(_fromArray__WEBPACK_IMPORTED_MODULE_1__["fromArray"])(observables, undefined).lift(new ZipOperator(resultSelector));
}
var ZipOperator = /*@__PURE__*/ (function () {
    function ZipOperator(resultSelector) {
        this.resultSelector = resultSelector;
    }
    ZipOperator.prototype.call = function (subscriber, source) {
        return source.subscribe(new ZipSubscriber(subscriber, this.resultSelector));
    };
    return ZipOperator;
}());

var ZipSubscriber = /*@__PURE__*/ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ZipSubscriber, _super);
    function ZipSubscriber(destination, resultSelector, values) {
        if (values === void 0) {
            values = Object.create(null);
        }
        var _this = _super.call(this, destination) || this;
        _this.iterators = [];
        _this.active = 0;
        _this.resultSelector = (typeof resultSelector === 'function') ? resultSelector : null;
        _this.values = values;
        return _this;
    }
    ZipSubscriber.prototype._next = function (value) {
        var iterators = this.iterators;
        if (Object(_util_isArray__WEBPACK_IMPORTED_MODULE_2__["isArray"])(value)) {
            iterators.push(new StaticArrayIterator(value));
        }
        else if (typeof value[_internal_symbol_iterator__WEBPACK_IMPORTED_MODULE_6__["iterator"]] === 'function') {
            iterators.push(new StaticIterator(value[_internal_symbol_iterator__WEBPACK_IMPORTED_MODULE_6__["iterator"]]()));
        }
        else {
            iterators.push(new ZipBufferIterator(this.destination, this, value));
        }
    };
    ZipSubscriber.prototype._complete = function () {
        var iterators = this.iterators;
        var len = iterators.length;
        this.unsubscribe();
        if (len === 0) {
            this.destination.complete();
            return;
        }
        this.active = len;
        for (var i = 0; i < len; i++) {
            var iterator = iterators[i];
            if (iterator.stillUnsubscribed) {
                var destination = this.destination;
                destination.add(iterator.subscribe(iterator, i));
            }
            else {
                this.active--;
            }
        }
    };
    ZipSubscriber.prototype.notifyInactive = function () {
        this.active--;
        if (this.active === 0) {
            this.destination.complete();
        }
    };
    ZipSubscriber.prototype.checkIterators = function () {
        var iterators = this.iterators;
        var len = iterators.length;
        var destination = this.destination;
        for (var i = 0; i < len; i++) {
            var iterator = iterators[i];
            if (typeof iterator.hasValue === 'function' && !iterator.hasValue()) {
                return;
            }
        }
        var shouldComplete = false;
        var args = [];
        for (var i = 0; i < len; i++) {
            var iterator = iterators[i];
            var result = iterator.next();
            if (iterator.hasCompleted()) {
                shouldComplete = true;
            }
            if (result.done) {
                destination.complete();
                return;
            }
            args.push(result.value);
        }
        if (this.resultSelector) {
            this._tryresultSelector(args);
        }
        else {
            destination.next(args);
        }
        if (shouldComplete) {
            destination.complete();
        }
    };
    ZipSubscriber.prototype._tryresultSelector = function (args) {
        var result;
        try {
            result = this.resultSelector.apply(this, args);
        }
        catch (err) {
            this.destination.error(err);
            return;
        }
        this.destination.next(result);
    };
    return ZipSubscriber;
}(_Subscriber__WEBPACK_IMPORTED_MODULE_3__["Subscriber"]));

var StaticIterator = /*@__PURE__*/ (function () {
    function StaticIterator(iterator) {
        this.iterator = iterator;
        this.nextResult = iterator.next();
    }
    StaticIterator.prototype.hasValue = function () {
        return true;
    };
    StaticIterator.prototype.next = function () {
        var result = this.nextResult;
        this.nextResult = this.iterator.next();
        return result;
    };
    StaticIterator.prototype.hasCompleted = function () {
        var nextResult = this.nextResult;
        return nextResult && nextResult.done;
    };
    return StaticIterator;
}());
var StaticArrayIterator = /*@__PURE__*/ (function () {
    function StaticArrayIterator(array) {
        this.array = array;
        this.index = 0;
        this.length = 0;
        this.length = array.length;
    }
    StaticArrayIterator.prototype[_internal_symbol_iterator__WEBPACK_IMPORTED_MODULE_6__["iterator"]] = function () {
        return this;
    };
    StaticArrayIterator.prototype.next = function (value) {
        var i = this.index++;
        var array = this.array;
        return i < this.length ? { value: array[i], done: false } : { value: null, done: true };
    };
    StaticArrayIterator.prototype.hasValue = function () {
        return this.array.length > this.index;
    };
    StaticArrayIterator.prototype.hasCompleted = function () {
        return this.array.length === this.index;
    };
    return StaticArrayIterator;
}());
var ZipBufferIterator = /*@__PURE__*/ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ZipBufferIterator, _super);
    function ZipBufferIterator(destination, parent, observable) {
        var _this = _super.call(this, destination) || this;
        _this.parent = parent;
        _this.observable = observable;
        _this.stillUnsubscribed = true;
        _this.buffer = [];
        _this.isComplete = false;
        return _this;
    }
    ZipBufferIterator.prototype[_internal_symbol_iterator__WEBPACK_IMPORTED_MODULE_6__["iterator"]] = function () {
        return this;
    };
    ZipBufferIterator.prototype.next = function () {
        var buffer = this.buffer;
        if (buffer.length === 0 && this.isComplete) {
            return { value: null, done: true };
        }
        else {
            return { value: buffer.shift(), done: false };
        }
    };
    ZipBufferIterator.prototype.hasValue = function () {
        return this.buffer.length > 0;
    };
    ZipBufferIterator.prototype.hasCompleted = function () {
        return this.buffer.length === 0 && this.isComplete;
    };
    ZipBufferIterator.prototype.notifyComplete = function () {
        if (this.buffer.length > 0) {
            this.isComplete = true;
            this.parent.notifyInactive();
        }
        else {
            this.destination.complete();
        }
    };
    ZipBufferIterator.prototype.notifyNext = function (outerValue, innerValue, outerIndex, innerIndex, innerSub) {
        this.buffer.push(innerValue);
        this.parent.checkIterators();
    };
    ZipBufferIterator.prototype.subscribe = function (value, index) {
        return Object(_util_subscribeToResult__WEBPACK_IMPORTED_MODULE_5__["subscribeToResult"])(this, this.observable, this, index);
    };
    return ZipBufferIterator;
}(_OuterSubscriber__WEBPACK_IMPORTED_MODULE_4__["OuterSubscriber"]));
//# sourceMappingURL=zip.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/operators/concatAll.js":
/*!*****************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/operators/concatAll.js ***!
  \*****************************************************************/
/*! exports provided: concatAll */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "concatAll", function() { return concatAll; });
/* harmony import */ var _mergeAll__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./mergeAll */ "./node_modules/rxjs/_esm5/internal/operators/mergeAll.js");
/** PURE_IMPORTS_START _mergeAll PURE_IMPORTS_END */

function concatAll() {
    return Object(_mergeAll__WEBPACK_IMPORTED_MODULE_0__["mergeAll"])(1);
}
//# sourceMappingURL=concatAll.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/operators/groupBy.js":
/*!***************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/operators/groupBy.js ***!
  \***************************************************************/
/*! exports provided: groupBy, GroupedObservable */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "groupBy", function() { return groupBy; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GroupedObservable", function() { return GroupedObservable; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _Subscriber__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Subscriber */ "./node_modules/rxjs/_esm5/internal/Subscriber.js");
/* harmony import */ var _Subscription__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Subscription */ "./node_modules/rxjs/_esm5/internal/Subscription.js");
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Observable */ "./node_modules/rxjs/_esm5/internal/Observable.js");
/* harmony import */ var _Subject__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../Subject */ "./node_modules/rxjs/_esm5/internal/Subject.js");
/** PURE_IMPORTS_START tslib,_Subscriber,_Subscription,_Observable,_Subject PURE_IMPORTS_END */





function groupBy(keySelector, elementSelector, durationSelector, subjectSelector) {
    return function (source) {
        return source.lift(new GroupByOperator(keySelector, elementSelector, durationSelector, subjectSelector));
    };
}
var GroupByOperator = /*@__PURE__*/ (function () {
    function GroupByOperator(keySelector, elementSelector, durationSelector, subjectSelector) {
        this.keySelector = keySelector;
        this.elementSelector = elementSelector;
        this.durationSelector = durationSelector;
        this.subjectSelector = subjectSelector;
    }
    GroupByOperator.prototype.call = function (subscriber, source) {
        return source.subscribe(new GroupBySubscriber(subscriber, this.keySelector, this.elementSelector, this.durationSelector, this.subjectSelector));
    };
    return GroupByOperator;
}());
var GroupBySubscriber = /*@__PURE__*/ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](GroupBySubscriber, _super);
    function GroupBySubscriber(destination, keySelector, elementSelector, durationSelector, subjectSelector) {
        var _this = _super.call(this, destination) || this;
        _this.keySelector = keySelector;
        _this.elementSelector = elementSelector;
        _this.durationSelector = durationSelector;
        _this.subjectSelector = subjectSelector;
        _this.groups = null;
        _this.attemptedToUnsubscribe = false;
        _this.count = 0;
        return _this;
    }
    GroupBySubscriber.prototype._next = function (value) {
        var key;
        try {
            key = this.keySelector(value);
        }
        catch (err) {
            this.error(err);
            return;
        }
        this._group(value, key);
    };
    GroupBySubscriber.prototype._group = function (value, key) {
        var groups = this.groups;
        if (!groups) {
            groups = this.groups = new Map();
        }
        var group = groups.get(key);
        var element;
        if (this.elementSelector) {
            try {
                element = this.elementSelector(value);
            }
            catch (err) {
                this.error(err);
            }
        }
        else {
            element = value;
        }
        if (!group) {
            group = (this.subjectSelector ? this.subjectSelector() : new _Subject__WEBPACK_IMPORTED_MODULE_4__["Subject"]());
            groups.set(key, group);
            var groupedObservable = new GroupedObservable(key, group, this);
            this.destination.next(groupedObservable);
            if (this.durationSelector) {
                var duration = void 0;
                try {
                    duration = this.durationSelector(new GroupedObservable(key, group));
                }
                catch (err) {
                    this.error(err);
                    return;
                }
                this.add(duration.subscribe(new GroupDurationSubscriber(key, group, this)));
            }
        }
        if (!group.closed) {
            group.next(element);
        }
    };
    GroupBySubscriber.prototype._error = function (err) {
        var groups = this.groups;
        if (groups) {
            groups.forEach(function (group, key) {
                group.error(err);
            });
            groups.clear();
        }
        this.destination.error(err);
    };
    GroupBySubscriber.prototype._complete = function () {
        var groups = this.groups;
        if (groups) {
            groups.forEach(function (group, key) {
                group.complete();
            });
            groups.clear();
        }
        this.destination.complete();
    };
    GroupBySubscriber.prototype.removeGroup = function (key) {
        this.groups.delete(key);
    };
    GroupBySubscriber.prototype.unsubscribe = function () {
        if (!this.closed) {
            this.attemptedToUnsubscribe = true;
            if (this.count === 0) {
                _super.prototype.unsubscribe.call(this);
            }
        }
    };
    return GroupBySubscriber;
}(_Subscriber__WEBPACK_IMPORTED_MODULE_1__["Subscriber"]));
var GroupDurationSubscriber = /*@__PURE__*/ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](GroupDurationSubscriber, _super);
    function GroupDurationSubscriber(key, group, parent) {
        var _this = _super.call(this, group) || this;
        _this.key = key;
        _this.group = group;
        _this.parent = parent;
        return _this;
    }
    GroupDurationSubscriber.prototype._next = function (value) {
        this.complete();
    };
    GroupDurationSubscriber.prototype._unsubscribe = function () {
        var _a = this, parent = _a.parent, key = _a.key;
        this.key = this.parent = null;
        if (parent) {
            parent.removeGroup(key);
        }
    };
    return GroupDurationSubscriber;
}(_Subscriber__WEBPACK_IMPORTED_MODULE_1__["Subscriber"]));
var GroupedObservable = /*@__PURE__*/ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](GroupedObservable, _super);
    function GroupedObservable(key, groupSubject, refCountSubscription) {
        var _this = _super.call(this) || this;
        _this.key = key;
        _this.groupSubject = groupSubject;
        _this.refCountSubscription = refCountSubscription;
        return _this;
    }
    GroupedObservable.prototype._subscribe = function (subscriber) {
        var subscription = new _Subscription__WEBPACK_IMPORTED_MODULE_2__["Subscription"]();
        var _a = this, refCountSubscription = _a.refCountSubscription, groupSubject = _a.groupSubject;
        if (refCountSubscription && !refCountSubscription.closed) {
            subscription.add(new InnerRefCountSubscription(refCountSubscription));
        }
        subscription.add(groupSubject.subscribe(subscriber));
        return subscription;
    };
    return GroupedObservable;
}(_Observable__WEBPACK_IMPORTED_MODULE_3__["Observable"]));

var InnerRefCountSubscription = /*@__PURE__*/ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](InnerRefCountSubscription, _super);
    function InnerRefCountSubscription(parent) {
        var _this = _super.call(this) || this;
        _this.parent = parent;
        parent.count++;
        return _this;
    }
    InnerRefCountSubscription.prototype.unsubscribe = function () {
        var parent = this.parent;
        if (!parent.closed && !this.closed) {
            _super.prototype.unsubscribe.call(this);
            parent.count -= 1;
            if (parent.count === 0 && parent.attemptedToUnsubscribe) {
                parent.unsubscribe();
            }
        }
    };
    return InnerRefCountSubscription;
}(_Subscription__WEBPACK_IMPORTED_MODULE_2__["Subscription"]));
//# sourceMappingURL=groupBy.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/operators/map.js":
/*!***********************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/operators/map.js ***!
  \***********************************************************/
/*! exports provided: map, MapOperator */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "map", function() { return map; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MapOperator", function() { return MapOperator; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _Subscriber__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Subscriber */ "./node_modules/rxjs/_esm5/internal/Subscriber.js");
/** PURE_IMPORTS_START tslib,_Subscriber PURE_IMPORTS_END */


function map(project, thisArg) {
    return function mapOperation(source) {
        if (typeof project !== 'function') {
            throw new TypeError('argument is not a function. Are you looking for `mapTo()`?');
        }
        return source.lift(new MapOperator(project, thisArg));
    };
}
var MapOperator = /*@__PURE__*/ (function () {
    function MapOperator(project, thisArg) {
        this.project = project;
        this.thisArg = thisArg;
    }
    MapOperator.prototype.call = function (subscriber, source) {
        return source.subscribe(new MapSubscriber(subscriber, this.project, this.thisArg));
    };
    return MapOperator;
}());

var MapSubscriber = /*@__PURE__*/ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](MapSubscriber, _super);
    function MapSubscriber(destination, project, thisArg) {
        var _this = _super.call(this, destination) || this;
        _this.project = project;
        _this.count = 0;
        _this.thisArg = thisArg || _this;
        return _this;
    }
    MapSubscriber.prototype._next = function (value) {
        var result;
        try {
            result = this.project.call(this.thisArg, value, this.count++);
        }
        catch (err) {
            this.destination.error(err);
            return;
        }
        this.destination.next(result);
    };
    return MapSubscriber;
}(_Subscriber__WEBPACK_IMPORTED_MODULE_1__["Subscriber"]));
//# sourceMappingURL=map.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/operators/mergeAll.js":
/*!****************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/operators/mergeAll.js ***!
  \****************************************************************/
/*! exports provided: mergeAll */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "mergeAll", function() { return mergeAll; });
/* harmony import */ var _mergeMap__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./mergeMap */ "./node_modules/rxjs/_esm5/internal/operators/mergeMap.js");
/* harmony import */ var _util_identity__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../util/identity */ "./node_modules/rxjs/_esm5/internal/util/identity.js");
/** PURE_IMPORTS_START _mergeMap,_util_identity PURE_IMPORTS_END */


function mergeAll(concurrent) {
    if (concurrent === void 0) {
        concurrent = Number.POSITIVE_INFINITY;
    }
    return Object(_mergeMap__WEBPACK_IMPORTED_MODULE_0__["mergeMap"])(_util_identity__WEBPACK_IMPORTED_MODULE_1__["identity"], concurrent);
}
//# sourceMappingURL=mergeAll.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/operators/mergeMap.js":
/*!****************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/operators/mergeMap.js ***!
  \****************************************************************/
/*! exports provided: mergeMap, MergeMapOperator, MergeMapSubscriber */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "mergeMap", function() { return mergeMap; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MergeMapOperator", function() { return MergeMapOperator; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MergeMapSubscriber", function() { return MergeMapSubscriber; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _util_subscribeToResult__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../util/subscribeToResult */ "./node_modules/rxjs/_esm5/internal/util/subscribeToResult.js");
/* harmony import */ var _OuterSubscriber__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../OuterSubscriber */ "./node_modules/rxjs/_esm5/internal/OuterSubscriber.js");
/* harmony import */ var _InnerSubscriber__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../InnerSubscriber */ "./node_modules/rxjs/_esm5/internal/InnerSubscriber.js");
/* harmony import */ var _map__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./map */ "./node_modules/rxjs/_esm5/internal/operators/map.js");
/* harmony import */ var _observable_from__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../observable/from */ "./node_modules/rxjs/_esm5/internal/observable/from.js");
/** PURE_IMPORTS_START tslib,_util_subscribeToResult,_OuterSubscriber,_InnerSubscriber,_map,_observable_from PURE_IMPORTS_END */






function mergeMap(project, resultSelector, concurrent) {
    if (concurrent === void 0) {
        concurrent = Number.POSITIVE_INFINITY;
    }
    if (typeof resultSelector === 'function') {
        return function (source) { return source.pipe(mergeMap(function (a, i) { return Object(_observable_from__WEBPACK_IMPORTED_MODULE_5__["from"])(project(a, i)).pipe(Object(_map__WEBPACK_IMPORTED_MODULE_4__["map"])(function (b, ii) { return resultSelector(a, b, i, ii); })); }, concurrent)); };
    }
    else if (typeof resultSelector === 'number') {
        concurrent = resultSelector;
    }
    return function (source) { return source.lift(new MergeMapOperator(project, concurrent)); };
}
var MergeMapOperator = /*@__PURE__*/ (function () {
    function MergeMapOperator(project, concurrent) {
        if (concurrent === void 0) {
            concurrent = Number.POSITIVE_INFINITY;
        }
        this.project = project;
        this.concurrent = concurrent;
    }
    MergeMapOperator.prototype.call = function (observer, source) {
        return source.subscribe(new MergeMapSubscriber(observer, this.project, this.concurrent));
    };
    return MergeMapOperator;
}());

var MergeMapSubscriber = /*@__PURE__*/ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](MergeMapSubscriber, _super);
    function MergeMapSubscriber(destination, project, concurrent) {
        if (concurrent === void 0) {
            concurrent = Number.POSITIVE_INFINITY;
        }
        var _this = _super.call(this, destination) || this;
        _this.project = project;
        _this.concurrent = concurrent;
        _this.hasCompleted = false;
        _this.buffer = [];
        _this.active = 0;
        _this.index = 0;
        return _this;
    }
    MergeMapSubscriber.prototype._next = function (value) {
        if (this.active < this.concurrent) {
            this._tryNext(value);
        }
        else {
            this.buffer.push(value);
        }
    };
    MergeMapSubscriber.prototype._tryNext = function (value) {
        var result;
        var index = this.index++;
        try {
            result = this.project(value, index);
        }
        catch (err) {
            this.destination.error(err);
            return;
        }
        this.active++;
        this._innerSub(result, value, index);
    };
    MergeMapSubscriber.prototype._innerSub = function (ish, value, index) {
        var innerSubscriber = new _InnerSubscriber__WEBPACK_IMPORTED_MODULE_3__["InnerSubscriber"](this, undefined, undefined);
        var destination = this.destination;
        destination.add(innerSubscriber);
        Object(_util_subscribeToResult__WEBPACK_IMPORTED_MODULE_1__["subscribeToResult"])(this, ish, value, index, innerSubscriber);
    };
    MergeMapSubscriber.prototype._complete = function () {
        this.hasCompleted = true;
        if (this.active === 0 && this.buffer.length === 0) {
            this.destination.complete();
        }
        this.unsubscribe();
    };
    MergeMapSubscriber.prototype.notifyNext = function (outerValue, innerValue, outerIndex, innerIndex, innerSub) {
        this.destination.next(innerValue);
    };
    MergeMapSubscriber.prototype.notifyComplete = function (innerSub) {
        var buffer = this.buffer;
        this.remove(innerSub);
        this.active--;
        if (buffer.length > 0) {
            this._next(buffer.shift());
        }
        else if (this.active === 0 && this.hasCompleted) {
            this.destination.complete();
        }
    };
    return MergeMapSubscriber;
}(_OuterSubscriber__WEBPACK_IMPORTED_MODULE_2__["OuterSubscriber"]));

//# sourceMappingURL=mergeMap.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/operators/observeOn.js":
/*!*****************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/operators/observeOn.js ***!
  \*****************************************************************/
/*! exports provided: observeOn, ObserveOnOperator, ObserveOnSubscriber, ObserveOnMessage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "observeOn", function() { return observeOn; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ObserveOnOperator", function() { return ObserveOnOperator; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ObserveOnSubscriber", function() { return ObserveOnSubscriber; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ObserveOnMessage", function() { return ObserveOnMessage; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _Subscriber__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Subscriber */ "./node_modules/rxjs/_esm5/internal/Subscriber.js");
/* harmony import */ var _Notification__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Notification */ "./node_modules/rxjs/_esm5/internal/Notification.js");
/** PURE_IMPORTS_START tslib,_Subscriber,_Notification PURE_IMPORTS_END */



function observeOn(scheduler, delay) {
    if (delay === void 0) {
        delay = 0;
    }
    return function observeOnOperatorFunction(source) {
        return source.lift(new ObserveOnOperator(scheduler, delay));
    };
}
var ObserveOnOperator = /*@__PURE__*/ (function () {
    function ObserveOnOperator(scheduler, delay) {
        if (delay === void 0) {
            delay = 0;
        }
        this.scheduler = scheduler;
        this.delay = delay;
    }
    ObserveOnOperator.prototype.call = function (subscriber, source) {
        return source.subscribe(new ObserveOnSubscriber(subscriber, this.scheduler, this.delay));
    };
    return ObserveOnOperator;
}());

var ObserveOnSubscriber = /*@__PURE__*/ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ObserveOnSubscriber, _super);
    function ObserveOnSubscriber(destination, scheduler, delay) {
        if (delay === void 0) {
            delay = 0;
        }
        var _this = _super.call(this, destination) || this;
        _this.scheduler = scheduler;
        _this.delay = delay;
        return _this;
    }
    ObserveOnSubscriber.dispatch = function (arg) {
        var notification = arg.notification, destination = arg.destination;
        notification.observe(destination);
        this.unsubscribe();
    };
    ObserveOnSubscriber.prototype.scheduleMessage = function (notification) {
        var destination = this.destination;
        destination.add(this.scheduler.schedule(ObserveOnSubscriber.dispatch, this.delay, new ObserveOnMessage(notification, this.destination)));
    };
    ObserveOnSubscriber.prototype._next = function (value) {
        this.scheduleMessage(_Notification__WEBPACK_IMPORTED_MODULE_2__["Notification"].createNext(value));
    };
    ObserveOnSubscriber.prototype._error = function (err) {
        this.scheduleMessage(_Notification__WEBPACK_IMPORTED_MODULE_2__["Notification"].createError(err));
        this.unsubscribe();
    };
    ObserveOnSubscriber.prototype._complete = function () {
        this.scheduleMessage(_Notification__WEBPACK_IMPORTED_MODULE_2__["Notification"].createComplete());
        this.unsubscribe();
    };
    return ObserveOnSubscriber;
}(_Subscriber__WEBPACK_IMPORTED_MODULE_1__["Subscriber"]));

var ObserveOnMessage = /*@__PURE__*/ (function () {
    function ObserveOnMessage(notification, destination) {
        this.notification = notification;
        this.destination = destination;
    }
    return ObserveOnMessage;
}());

//# sourceMappingURL=observeOn.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/operators/refCount.js":
/*!****************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/operators/refCount.js ***!
  \****************************************************************/
/*! exports provided: refCount */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "refCount", function() { return refCount; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _Subscriber__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Subscriber */ "./node_modules/rxjs/_esm5/internal/Subscriber.js");
/** PURE_IMPORTS_START tslib,_Subscriber PURE_IMPORTS_END */


function refCount() {
    return function refCountOperatorFunction(source) {
        return source.lift(new RefCountOperator(source));
    };
}
var RefCountOperator = /*@__PURE__*/ (function () {
    function RefCountOperator(connectable) {
        this.connectable = connectable;
    }
    RefCountOperator.prototype.call = function (subscriber, source) {
        var connectable = this.connectable;
        connectable._refCount++;
        var refCounter = new RefCountSubscriber(subscriber, connectable);
        var subscription = source.subscribe(refCounter);
        if (!refCounter.closed) {
            refCounter.connection = connectable.connect();
        }
        return subscription;
    };
    return RefCountOperator;
}());
var RefCountSubscriber = /*@__PURE__*/ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](RefCountSubscriber, _super);
    function RefCountSubscriber(destination, connectable) {
        var _this = _super.call(this, destination) || this;
        _this.connectable = connectable;
        return _this;
    }
    RefCountSubscriber.prototype._unsubscribe = function () {
        var connectable = this.connectable;
        if (!connectable) {
            this.connection = null;
            return;
        }
        this.connectable = null;
        var refCount = connectable._refCount;
        if (refCount <= 0) {
            this.connection = null;
            return;
        }
        connectable._refCount = refCount - 1;
        if (refCount > 1) {
            this.connection = null;
            return;
        }
        var connection = this.connection;
        var sharedConnection = connectable._connection;
        this.connection = null;
        if (sharedConnection && (!connection || sharedConnection === connection)) {
            sharedConnection.unsubscribe();
        }
    };
    return RefCountSubscriber;
}(_Subscriber__WEBPACK_IMPORTED_MODULE_1__["Subscriber"]));
//# sourceMappingURL=refCount.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/scheduler/Action.js":
/*!**************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/scheduler/Action.js ***!
  \**************************************************************/
/*! exports provided: Action */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Action", function() { return Action; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _Subscription__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Subscription */ "./node_modules/rxjs/_esm5/internal/Subscription.js");
/** PURE_IMPORTS_START tslib,_Subscription PURE_IMPORTS_END */


var Action = /*@__PURE__*/ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Action, _super);
    function Action(scheduler, work) {
        return _super.call(this) || this;
    }
    Action.prototype.schedule = function (state, delay) {
        if (delay === void 0) {
            delay = 0;
        }
        return this;
    };
    return Action;
}(_Subscription__WEBPACK_IMPORTED_MODULE_1__["Subscription"]));

//# sourceMappingURL=Action.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/scheduler/AnimationFrameAction.js":
/*!****************************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/scheduler/AnimationFrameAction.js ***!
  \****************************************************************************/
/*! exports provided: AnimationFrameAction */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AnimationFrameAction", function() { return AnimationFrameAction; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _AsyncAction__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./AsyncAction */ "./node_modules/rxjs/_esm5/internal/scheduler/AsyncAction.js");
/** PURE_IMPORTS_START tslib,_AsyncAction PURE_IMPORTS_END */


var AnimationFrameAction = /*@__PURE__*/ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](AnimationFrameAction, _super);
    function AnimationFrameAction(scheduler, work) {
        var _this = _super.call(this, scheduler, work) || this;
        _this.scheduler = scheduler;
        _this.work = work;
        return _this;
    }
    AnimationFrameAction.prototype.requestAsyncId = function (scheduler, id, delay) {
        if (delay === void 0) {
            delay = 0;
        }
        if (delay !== null && delay > 0) {
            return _super.prototype.requestAsyncId.call(this, scheduler, id, delay);
        }
        scheduler.actions.push(this);
        return scheduler.scheduled || (scheduler.scheduled = requestAnimationFrame(function () { return scheduler.flush(null); }));
    };
    AnimationFrameAction.prototype.recycleAsyncId = function (scheduler, id, delay) {
        if (delay === void 0) {
            delay = 0;
        }
        if ((delay !== null && delay > 0) || (delay === null && this.delay > 0)) {
            return _super.prototype.recycleAsyncId.call(this, scheduler, id, delay);
        }
        if (scheduler.actions.length === 0) {
            cancelAnimationFrame(id);
            scheduler.scheduled = undefined;
        }
        return undefined;
    };
    return AnimationFrameAction;
}(_AsyncAction__WEBPACK_IMPORTED_MODULE_1__["AsyncAction"]));

//# sourceMappingURL=AnimationFrameAction.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/scheduler/AnimationFrameScheduler.js":
/*!*******************************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/scheduler/AnimationFrameScheduler.js ***!
  \*******************************************************************************/
/*! exports provided: AnimationFrameScheduler */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AnimationFrameScheduler", function() { return AnimationFrameScheduler; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _AsyncScheduler__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./AsyncScheduler */ "./node_modules/rxjs/_esm5/internal/scheduler/AsyncScheduler.js");
/** PURE_IMPORTS_START tslib,_AsyncScheduler PURE_IMPORTS_END */


var AnimationFrameScheduler = /*@__PURE__*/ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](AnimationFrameScheduler, _super);
    function AnimationFrameScheduler() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    AnimationFrameScheduler.prototype.flush = function (action) {
        this.active = true;
        this.scheduled = undefined;
        var actions = this.actions;
        var error;
        var index = -1;
        var count = actions.length;
        action = action || actions.shift();
        do {
            if (error = action.execute(action.state, action.delay)) {
                break;
            }
        } while (++index < count && (action = actions.shift()));
        this.active = false;
        if (error) {
            while (++index < count && (action = actions.shift())) {
                action.unsubscribe();
            }
            throw error;
        }
    };
    return AnimationFrameScheduler;
}(_AsyncScheduler__WEBPACK_IMPORTED_MODULE_1__["AsyncScheduler"]));

//# sourceMappingURL=AnimationFrameScheduler.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/scheduler/AsapAction.js":
/*!******************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/scheduler/AsapAction.js ***!
  \******************************************************************/
/*! exports provided: AsapAction */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AsapAction", function() { return AsapAction; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _util_Immediate__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../util/Immediate */ "./node_modules/rxjs/_esm5/internal/util/Immediate.js");
/* harmony import */ var _AsyncAction__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./AsyncAction */ "./node_modules/rxjs/_esm5/internal/scheduler/AsyncAction.js");
/** PURE_IMPORTS_START tslib,_util_Immediate,_AsyncAction PURE_IMPORTS_END */



var AsapAction = /*@__PURE__*/ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](AsapAction, _super);
    function AsapAction(scheduler, work) {
        var _this = _super.call(this, scheduler, work) || this;
        _this.scheduler = scheduler;
        _this.work = work;
        return _this;
    }
    AsapAction.prototype.requestAsyncId = function (scheduler, id, delay) {
        if (delay === void 0) {
            delay = 0;
        }
        if (delay !== null && delay > 0) {
            return _super.prototype.requestAsyncId.call(this, scheduler, id, delay);
        }
        scheduler.actions.push(this);
        return scheduler.scheduled || (scheduler.scheduled = _util_Immediate__WEBPACK_IMPORTED_MODULE_1__["Immediate"].setImmediate(scheduler.flush.bind(scheduler, null)));
    };
    AsapAction.prototype.recycleAsyncId = function (scheduler, id, delay) {
        if (delay === void 0) {
            delay = 0;
        }
        if ((delay !== null && delay > 0) || (delay === null && this.delay > 0)) {
            return _super.prototype.recycleAsyncId.call(this, scheduler, id, delay);
        }
        if (scheduler.actions.length === 0) {
            _util_Immediate__WEBPACK_IMPORTED_MODULE_1__["Immediate"].clearImmediate(id);
            scheduler.scheduled = undefined;
        }
        return undefined;
    };
    return AsapAction;
}(_AsyncAction__WEBPACK_IMPORTED_MODULE_2__["AsyncAction"]));

//# sourceMappingURL=AsapAction.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/scheduler/AsapScheduler.js":
/*!*********************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/scheduler/AsapScheduler.js ***!
  \*********************************************************************/
/*! exports provided: AsapScheduler */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AsapScheduler", function() { return AsapScheduler; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _AsyncScheduler__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./AsyncScheduler */ "./node_modules/rxjs/_esm5/internal/scheduler/AsyncScheduler.js");
/** PURE_IMPORTS_START tslib,_AsyncScheduler PURE_IMPORTS_END */


var AsapScheduler = /*@__PURE__*/ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](AsapScheduler, _super);
    function AsapScheduler() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    AsapScheduler.prototype.flush = function (action) {
        this.active = true;
        this.scheduled = undefined;
        var actions = this.actions;
        var error;
        var index = -1;
        var count = actions.length;
        action = action || actions.shift();
        do {
            if (error = action.execute(action.state, action.delay)) {
                break;
            }
        } while (++index < count && (action = actions.shift()));
        this.active = false;
        if (error) {
            while (++index < count && (action = actions.shift())) {
                action.unsubscribe();
            }
            throw error;
        }
    };
    return AsapScheduler;
}(_AsyncScheduler__WEBPACK_IMPORTED_MODULE_1__["AsyncScheduler"]));

//# sourceMappingURL=AsapScheduler.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/scheduler/AsyncAction.js":
/*!*******************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/scheduler/AsyncAction.js ***!
  \*******************************************************************/
/*! exports provided: AsyncAction */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AsyncAction", function() { return AsyncAction; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _Action__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Action */ "./node_modules/rxjs/_esm5/internal/scheduler/Action.js");
/** PURE_IMPORTS_START tslib,_Action PURE_IMPORTS_END */


var AsyncAction = /*@__PURE__*/ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](AsyncAction, _super);
    function AsyncAction(scheduler, work) {
        var _this = _super.call(this, scheduler, work) || this;
        _this.scheduler = scheduler;
        _this.work = work;
        _this.pending = false;
        return _this;
    }
    AsyncAction.prototype.schedule = function (state, delay) {
        if (delay === void 0) {
            delay = 0;
        }
        if (this.closed) {
            return this;
        }
        this.state = state;
        var id = this.id;
        var scheduler = this.scheduler;
        if (id != null) {
            this.id = this.recycleAsyncId(scheduler, id, delay);
        }
        this.pending = true;
        this.delay = delay;
        this.id = this.id || this.requestAsyncId(scheduler, this.id, delay);
        return this;
    };
    AsyncAction.prototype.requestAsyncId = function (scheduler, id, delay) {
        if (delay === void 0) {
            delay = 0;
        }
        return setInterval(scheduler.flush.bind(scheduler, this), delay);
    };
    AsyncAction.prototype.recycleAsyncId = function (scheduler, id, delay) {
        if (delay === void 0) {
            delay = 0;
        }
        if (delay !== null && this.delay === delay && this.pending === false) {
            return id;
        }
        clearInterval(id);
    };
    AsyncAction.prototype.execute = function (state, delay) {
        if (this.closed) {
            return new Error('executing a cancelled action');
        }
        this.pending = false;
        var error = this._execute(state, delay);
        if (error) {
            return error;
        }
        else if (this.pending === false && this.id != null) {
            this.id = this.recycleAsyncId(this.scheduler, this.id, null);
        }
    };
    AsyncAction.prototype._execute = function (state, delay) {
        var errored = false;
        var errorValue = undefined;
        try {
            this.work(state);
        }
        catch (e) {
            errored = true;
            errorValue = !!e && e || new Error(e);
        }
        if (errored) {
            this.unsubscribe();
            return errorValue;
        }
    };
    AsyncAction.prototype._unsubscribe = function () {
        var id = this.id;
        var scheduler = this.scheduler;
        var actions = scheduler.actions;
        var index = actions.indexOf(this);
        this.work = null;
        this.state = null;
        this.pending = false;
        this.scheduler = null;
        if (index !== -1) {
            actions.splice(index, 1);
        }
        if (id != null) {
            this.id = this.recycleAsyncId(scheduler, id, null);
        }
        this.delay = null;
    };
    return AsyncAction;
}(_Action__WEBPACK_IMPORTED_MODULE_1__["Action"]));

//# sourceMappingURL=AsyncAction.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/scheduler/AsyncScheduler.js":
/*!**********************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/scheduler/AsyncScheduler.js ***!
  \**********************************************************************/
/*! exports provided: AsyncScheduler */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AsyncScheduler", function() { return AsyncScheduler; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _Scheduler__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../Scheduler */ "./node_modules/rxjs/_esm5/internal/Scheduler.js");
/** PURE_IMPORTS_START tslib,_Scheduler PURE_IMPORTS_END */


var AsyncScheduler = /*@__PURE__*/ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](AsyncScheduler, _super);
    function AsyncScheduler(SchedulerAction, now) {
        if (now === void 0) {
            now = _Scheduler__WEBPACK_IMPORTED_MODULE_1__["Scheduler"].now;
        }
        var _this = _super.call(this, SchedulerAction, function () {
            if (AsyncScheduler.delegate && AsyncScheduler.delegate !== _this) {
                return AsyncScheduler.delegate.now();
            }
            else {
                return now();
            }
        }) || this;
        _this.actions = [];
        _this.active = false;
        _this.scheduled = undefined;
        return _this;
    }
    AsyncScheduler.prototype.schedule = function (work, delay, state) {
        if (delay === void 0) {
            delay = 0;
        }
        if (AsyncScheduler.delegate && AsyncScheduler.delegate !== this) {
            return AsyncScheduler.delegate.schedule(work, delay, state);
        }
        else {
            return _super.prototype.schedule.call(this, work, delay, state);
        }
    };
    AsyncScheduler.prototype.flush = function (action) {
        var actions = this.actions;
        if (this.active) {
            actions.push(action);
            return;
        }
        var error;
        this.active = true;
        do {
            if (error = action.execute(action.state, action.delay)) {
                break;
            }
        } while (action = actions.shift());
        this.active = false;
        if (error) {
            while (action = actions.shift()) {
                action.unsubscribe();
            }
            throw error;
        }
    };
    return AsyncScheduler;
}(_Scheduler__WEBPACK_IMPORTED_MODULE_1__["Scheduler"]));

//# sourceMappingURL=AsyncScheduler.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/scheduler/QueueAction.js":
/*!*******************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/scheduler/QueueAction.js ***!
  \*******************************************************************/
/*! exports provided: QueueAction */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "QueueAction", function() { return QueueAction; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _AsyncAction__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./AsyncAction */ "./node_modules/rxjs/_esm5/internal/scheduler/AsyncAction.js");
/** PURE_IMPORTS_START tslib,_AsyncAction PURE_IMPORTS_END */


var QueueAction = /*@__PURE__*/ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](QueueAction, _super);
    function QueueAction(scheduler, work) {
        var _this = _super.call(this, scheduler, work) || this;
        _this.scheduler = scheduler;
        _this.work = work;
        return _this;
    }
    QueueAction.prototype.schedule = function (state, delay) {
        if (delay === void 0) {
            delay = 0;
        }
        if (delay > 0) {
            return _super.prototype.schedule.call(this, state, delay);
        }
        this.delay = delay;
        this.state = state;
        this.scheduler.flush(this);
        return this;
    };
    QueueAction.prototype.execute = function (state, delay) {
        return (delay > 0 || this.closed) ?
            _super.prototype.execute.call(this, state, delay) :
            this._execute(state, delay);
    };
    QueueAction.prototype.requestAsyncId = function (scheduler, id, delay) {
        if (delay === void 0) {
            delay = 0;
        }
        if ((delay !== null && delay > 0) || (delay === null && this.delay > 0)) {
            return _super.prototype.requestAsyncId.call(this, scheduler, id, delay);
        }
        return scheduler.flush(this);
    };
    return QueueAction;
}(_AsyncAction__WEBPACK_IMPORTED_MODULE_1__["AsyncAction"]));

//# sourceMappingURL=QueueAction.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/scheduler/QueueScheduler.js":
/*!**********************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/scheduler/QueueScheduler.js ***!
  \**********************************************************************/
/*! exports provided: QueueScheduler */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "QueueScheduler", function() { return QueueScheduler; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _AsyncScheduler__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./AsyncScheduler */ "./node_modules/rxjs/_esm5/internal/scheduler/AsyncScheduler.js");
/** PURE_IMPORTS_START tslib,_AsyncScheduler PURE_IMPORTS_END */


var QueueScheduler = /*@__PURE__*/ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](QueueScheduler, _super);
    function QueueScheduler() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return QueueScheduler;
}(_AsyncScheduler__WEBPACK_IMPORTED_MODULE_1__["AsyncScheduler"]));

//# sourceMappingURL=QueueScheduler.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/scheduler/VirtualTimeScheduler.js":
/*!****************************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/scheduler/VirtualTimeScheduler.js ***!
  \****************************************************************************/
/*! exports provided: VirtualTimeScheduler, VirtualAction */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "VirtualTimeScheduler", function() { return VirtualTimeScheduler; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "VirtualAction", function() { return VirtualAction; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _AsyncAction__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./AsyncAction */ "./node_modules/rxjs/_esm5/internal/scheduler/AsyncAction.js");
/* harmony import */ var _AsyncScheduler__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./AsyncScheduler */ "./node_modules/rxjs/_esm5/internal/scheduler/AsyncScheduler.js");
/** PURE_IMPORTS_START tslib,_AsyncAction,_AsyncScheduler PURE_IMPORTS_END */



var VirtualTimeScheduler = /*@__PURE__*/ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](VirtualTimeScheduler, _super);
    function VirtualTimeScheduler(SchedulerAction, maxFrames) {
        if (SchedulerAction === void 0) {
            SchedulerAction = VirtualAction;
        }
        if (maxFrames === void 0) {
            maxFrames = Number.POSITIVE_INFINITY;
        }
        var _this = _super.call(this, SchedulerAction, function () { return _this.frame; }) || this;
        _this.maxFrames = maxFrames;
        _this.frame = 0;
        _this.index = -1;
        return _this;
    }
    VirtualTimeScheduler.prototype.flush = function () {
        var _a = this, actions = _a.actions, maxFrames = _a.maxFrames;
        var error, action;
        while ((action = actions.shift()) && (this.frame = action.delay) <= maxFrames) {
            if (error = action.execute(action.state, action.delay)) {
                break;
            }
        }
        if (error) {
            while (action = actions.shift()) {
                action.unsubscribe();
            }
            throw error;
        }
    };
    VirtualTimeScheduler.frameTimeFactor = 10;
    return VirtualTimeScheduler;
}(_AsyncScheduler__WEBPACK_IMPORTED_MODULE_2__["AsyncScheduler"]));

var VirtualAction = /*@__PURE__*/ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](VirtualAction, _super);
    function VirtualAction(scheduler, work, index) {
        if (index === void 0) {
            index = scheduler.index += 1;
        }
        var _this = _super.call(this, scheduler, work) || this;
        _this.scheduler = scheduler;
        _this.work = work;
        _this.index = index;
        _this.active = true;
        _this.index = scheduler.index = index;
        return _this;
    }
    VirtualAction.prototype.schedule = function (state, delay) {
        if (delay === void 0) {
            delay = 0;
        }
        if (!this.id) {
            return _super.prototype.schedule.call(this, state, delay);
        }
        this.active = false;
        var action = new VirtualAction(this.scheduler, this.work);
        this.add(action);
        return action.schedule(state, delay);
    };
    VirtualAction.prototype.requestAsyncId = function (scheduler, id, delay) {
        if (delay === void 0) {
            delay = 0;
        }
        this.delay = scheduler.frame + delay;
        var actions = scheduler.actions;
        actions.push(this);
        actions.sort(VirtualAction.sortActions);
        return true;
    };
    VirtualAction.prototype.recycleAsyncId = function (scheduler, id, delay) {
        if (delay === void 0) {
            delay = 0;
        }
        return undefined;
    };
    VirtualAction.prototype._execute = function (state, delay) {
        if (this.active === true) {
            return _super.prototype._execute.call(this, state, delay);
        }
    };
    VirtualAction.sortActions = function (a, b) {
        if (a.delay === b.delay) {
            if (a.index === b.index) {
                return 0;
            }
            else if (a.index > b.index) {
                return 1;
            }
            else {
                return -1;
            }
        }
        else if (a.delay > b.delay) {
            return 1;
        }
        else {
            return -1;
        }
    };
    return VirtualAction;
}(_AsyncAction__WEBPACK_IMPORTED_MODULE_1__["AsyncAction"]));

//# sourceMappingURL=VirtualTimeScheduler.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/scheduler/animationFrame.js":
/*!**********************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/scheduler/animationFrame.js ***!
  \**********************************************************************/
/*! exports provided: animationFrame */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "animationFrame", function() { return animationFrame; });
/* harmony import */ var _AnimationFrameAction__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AnimationFrameAction */ "./node_modules/rxjs/_esm5/internal/scheduler/AnimationFrameAction.js");
/* harmony import */ var _AnimationFrameScheduler__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./AnimationFrameScheduler */ "./node_modules/rxjs/_esm5/internal/scheduler/AnimationFrameScheduler.js");
/** PURE_IMPORTS_START _AnimationFrameAction,_AnimationFrameScheduler PURE_IMPORTS_END */


var animationFrame = /*@__PURE__*/ new _AnimationFrameScheduler__WEBPACK_IMPORTED_MODULE_1__["AnimationFrameScheduler"](_AnimationFrameAction__WEBPACK_IMPORTED_MODULE_0__["AnimationFrameAction"]);
//# sourceMappingURL=animationFrame.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/scheduler/asap.js":
/*!************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/scheduler/asap.js ***!
  \************************************************************/
/*! exports provided: asap */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "asap", function() { return asap; });
/* harmony import */ var _AsapAction__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AsapAction */ "./node_modules/rxjs/_esm5/internal/scheduler/AsapAction.js");
/* harmony import */ var _AsapScheduler__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./AsapScheduler */ "./node_modules/rxjs/_esm5/internal/scheduler/AsapScheduler.js");
/** PURE_IMPORTS_START _AsapAction,_AsapScheduler PURE_IMPORTS_END */


var asap = /*@__PURE__*/ new _AsapScheduler__WEBPACK_IMPORTED_MODULE_1__["AsapScheduler"](_AsapAction__WEBPACK_IMPORTED_MODULE_0__["AsapAction"]);
//# sourceMappingURL=asap.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/scheduler/async.js":
/*!*************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/scheduler/async.js ***!
  \*************************************************************/
/*! exports provided: async */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "async", function() { return async; });
/* harmony import */ var _AsyncAction__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AsyncAction */ "./node_modules/rxjs/_esm5/internal/scheduler/AsyncAction.js");
/* harmony import */ var _AsyncScheduler__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./AsyncScheduler */ "./node_modules/rxjs/_esm5/internal/scheduler/AsyncScheduler.js");
/** PURE_IMPORTS_START _AsyncAction,_AsyncScheduler PURE_IMPORTS_END */


var async = /*@__PURE__*/ new _AsyncScheduler__WEBPACK_IMPORTED_MODULE_1__["AsyncScheduler"](_AsyncAction__WEBPACK_IMPORTED_MODULE_0__["AsyncAction"]);
//# sourceMappingURL=async.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/scheduler/queue.js":
/*!*************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/scheduler/queue.js ***!
  \*************************************************************/
/*! exports provided: queue */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "queue", function() { return queue; });
/* harmony import */ var _QueueAction__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./QueueAction */ "./node_modules/rxjs/_esm5/internal/scheduler/QueueAction.js");
/* harmony import */ var _QueueScheduler__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./QueueScheduler */ "./node_modules/rxjs/_esm5/internal/scheduler/QueueScheduler.js");
/** PURE_IMPORTS_START _QueueAction,_QueueScheduler PURE_IMPORTS_END */


var queue = /*@__PURE__*/ new _QueueScheduler__WEBPACK_IMPORTED_MODULE_1__["QueueScheduler"](_QueueAction__WEBPACK_IMPORTED_MODULE_0__["QueueAction"]);
//# sourceMappingURL=queue.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/symbol/iterator.js":
/*!*************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/symbol/iterator.js ***!
  \*************************************************************/
/*! exports provided: getSymbolIterator, iterator, $$iterator */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSymbolIterator", function() { return getSymbolIterator; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "iterator", function() { return iterator; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "$$iterator", function() { return $$iterator; });
/** PURE_IMPORTS_START  PURE_IMPORTS_END */
function getSymbolIterator() {
    if (typeof Symbol !== 'function' || !Symbol.iterator) {
        return '@@iterator';
    }
    return Symbol.iterator;
}
var iterator = /*@__PURE__*/ getSymbolIterator();
var $$iterator = iterator;
//# sourceMappingURL=iterator.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/symbol/observable.js":
/*!***************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/symbol/observable.js ***!
  \***************************************************************/
/*! exports provided: observable */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "observable", function() { return observable; });
/** PURE_IMPORTS_START  PURE_IMPORTS_END */
var observable = typeof Symbol === 'function' && Symbol.observable || '@@observable';
//# sourceMappingURL=observable.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/symbol/rxSubscriber.js":
/*!*****************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/symbol/rxSubscriber.js ***!
  \*****************************************************************/
/*! exports provided: rxSubscriber, $$rxSubscriber */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "rxSubscriber", function() { return rxSubscriber; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "$$rxSubscriber", function() { return $$rxSubscriber; });
/** PURE_IMPORTS_START  PURE_IMPORTS_END */
var rxSubscriber = typeof Symbol === 'function'
    ? /*@__PURE__*/ Symbol('rxSubscriber')
    : '@@rxSubscriber_' + /*@__PURE__*/ Math.random();
var $$rxSubscriber = rxSubscriber;
//# sourceMappingURL=rxSubscriber.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/util/ArgumentOutOfRangeError.js":
/*!**************************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/util/ArgumentOutOfRangeError.js ***!
  \**************************************************************************/
/*! exports provided: ArgumentOutOfRangeError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ArgumentOutOfRangeError", function() { return ArgumentOutOfRangeError; });
/** PURE_IMPORTS_START  PURE_IMPORTS_END */
function ArgumentOutOfRangeErrorImpl() {
    Error.call(this);
    this.message = 'argument out of range';
    this.name = 'ArgumentOutOfRangeError';
    return this;
}
ArgumentOutOfRangeErrorImpl.prototype = /*@__PURE__*/ Object.create(Error.prototype);
var ArgumentOutOfRangeError = ArgumentOutOfRangeErrorImpl;
//# sourceMappingURL=ArgumentOutOfRangeError.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/util/EmptyError.js":
/*!*************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/util/EmptyError.js ***!
  \*************************************************************/
/*! exports provided: EmptyError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EmptyError", function() { return EmptyError; });
/** PURE_IMPORTS_START  PURE_IMPORTS_END */
function EmptyErrorImpl() {
    Error.call(this);
    this.message = 'no elements in sequence';
    this.name = 'EmptyError';
    return this;
}
EmptyErrorImpl.prototype = /*@__PURE__*/ Object.create(Error.prototype);
var EmptyError = EmptyErrorImpl;
//# sourceMappingURL=EmptyError.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/util/Immediate.js":
/*!************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/util/Immediate.js ***!
  \************************************************************/
/*! exports provided: Immediate */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Immediate", function() { return Immediate; });
/** PURE_IMPORTS_START  PURE_IMPORTS_END */
var nextHandle = 1;
var tasksByHandle = {};
function runIfPresent(handle) {
    var cb = tasksByHandle[handle];
    if (cb) {
        cb();
    }
}
var Immediate = {
    setImmediate: function (cb) {
        var handle = nextHandle++;
        tasksByHandle[handle] = cb;
        Promise.resolve().then(function () { return runIfPresent(handle); });
        return handle;
    },
    clearImmediate: function (handle) {
        delete tasksByHandle[handle];
    },
};
//# sourceMappingURL=Immediate.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/util/ObjectUnsubscribedError.js":
/*!**************************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/util/ObjectUnsubscribedError.js ***!
  \**************************************************************************/
/*! exports provided: ObjectUnsubscribedError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ObjectUnsubscribedError", function() { return ObjectUnsubscribedError; });
/** PURE_IMPORTS_START  PURE_IMPORTS_END */
function ObjectUnsubscribedErrorImpl() {
    Error.call(this);
    this.message = 'object unsubscribed';
    this.name = 'ObjectUnsubscribedError';
    return this;
}
ObjectUnsubscribedErrorImpl.prototype = /*@__PURE__*/ Object.create(Error.prototype);
var ObjectUnsubscribedError = ObjectUnsubscribedErrorImpl;
//# sourceMappingURL=ObjectUnsubscribedError.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/util/TimeoutError.js":
/*!***************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/util/TimeoutError.js ***!
  \***************************************************************/
/*! exports provided: TimeoutError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TimeoutError", function() { return TimeoutError; });
/** PURE_IMPORTS_START  PURE_IMPORTS_END */
function TimeoutErrorImpl() {
    Error.call(this);
    this.message = 'Timeout has occurred';
    this.name = 'TimeoutError';
    return this;
}
TimeoutErrorImpl.prototype = /*@__PURE__*/ Object.create(Error.prototype);
var TimeoutError = TimeoutErrorImpl;
//# sourceMappingURL=TimeoutError.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/util/UnsubscriptionError.js":
/*!**********************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/util/UnsubscriptionError.js ***!
  \**********************************************************************/
/*! exports provided: UnsubscriptionError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UnsubscriptionError", function() { return UnsubscriptionError; });
/** PURE_IMPORTS_START  PURE_IMPORTS_END */
function UnsubscriptionErrorImpl(errors) {
    Error.call(this);
    this.message = errors ?
        errors.length + " errors occurred during unsubscription:\n" + errors.map(function (err, i) { return i + 1 + ") " + err.toString(); }).join('\n  ') : '';
    this.name = 'UnsubscriptionError';
    this.errors = errors;
    return this;
}
UnsubscriptionErrorImpl.prototype = /*@__PURE__*/ Object.create(Error.prototype);
var UnsubscriptionError = UnsubscriptionErrorImpl;
//# sourceMappingURL=UnsubscriptionError.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/util/canReportError.js":
/*!*****************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/util/canReportError.js ***!
  \*****************************************************************/
/*! exports provided: canReportError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "canReportError", function() { return canReportError; });
/* harmony import */ var _Subscriber__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Subscriber */ "./node_modules/rxjs/_esm5/internal/Subscriber.js");
/** PURE_IMPORTS_START _Subscriber PURE_IMPORTS_END */

function canReportError(observer) {
    while (observer) {
        var _a = observer, closed_1 = _a.closed, destination = _a.destination, isStopped = _a.isStopped;
        if (closed_1 || isStopped) {
            return false;
        }
        else if (destination && destination instanceof _Subscriber__WEBPACK_IMPORTED_MODULE_0__["Subscriber"]) {
            observer = destination;
        }
        else {
            observer = null;
        }
    }
    return true;
}
//# sourceMappingURL=canReportError.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/util/errorObject.js":
/*!**************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/util/errorObject.js ***!
  \**************************************************************/
/*! exports provided: errorObject */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "errorObject", function() { return errorObject; });
/** PURE_IMPORTS_START  PURE_IMPORTS_END */
var errorObject = { e: {} };
//# sourceMappingURL=errorObject.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/util/hostReportError.js":
/*!******************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/util/hostReportError.js ***!
  \******************************************************************/
/*! exports provided: hostReportError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hostReportError", function() { return hostReportError; });
/** PURE_IMPORTS_START  PURE_IMPORTS_END */
function hostReportError(err) {
    setTimeout(function () { throw err; });
}
//# sourceMappingURL=hostReportError.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/util/identity.js":
/*!***********************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/util/identity.js ***!
  \***********************************************************/
/*! exports provided: identity */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "identity", function() { return identity; });
/** PURE_IMPORTS_START  PURE_IMPORTS_END */
function identity(x) {
    return x;
}
//# sourceMappingURL=identity.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/util/isArray.js":
/*!**********************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/util/isArray.js ***!
  \**********************************************************/
/*! exports provided: isArray */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isArray", function() { return isArray; });
/** PURE_IMPORTS_START  PURE_IMPORTS_END */
var isArray = Array.isArray || (function (x) { return x && typeof x.length === 'number'; });
//# sourceMappingURL=isArray.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/util/isArrayLike.js":
/*!**************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/util/isArrayLike.js ***!
  \**************************************************************/
/*! exports provided: isArrayLike */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isArrayLike", function() { return isArrayLike; });
/** PURE_IMPORTS_START  PURE_IMPORTS_END */
var isArrayLike = (function (x) { return x && typeof x.length === 'number' && typeof x !== 'function'; });
//# sourceMappingURL=isArrayLike.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/util/isFunction.js":
/*!*************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/util/isFunction.js ***!
  \*************************************************************/
/*! exports provided: isFunction */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isFunction", function() { return isFunction; });
/** PURE_IMPORTS_START  PURE_IMPORTS_END */
function isFunction(x) {
    return typeof x === 'function';
}
//# sourceMappingURL=isFunction.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/util/isInteropObservable.js":
/*!**********************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/util/isInteropObservable.js ***!
  \**********************************************************************/
/*! exports provided: isInteropObservable */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isInteropObservable", function() { return isInteropObservable; });
/* harmony import */ var _symbol_observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../symbol/observable */ "./node_modules/rxjs/_esm5/internal/symbol/observable.js");
/** PURE_IMPORTS_START _symbol_observable PURE_IMPORTS_END */

function isInteropObservable(input) {
    return input && typeof input[_symbol_observable__WEBPACK_IMPORTED_MODULE_0__["observable"]] === 'function';
}
//# sourceMappingURL=isInteropObservable.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/util/isIterable.js":
/*!*************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/util/isIterable.js ***!
  \*************************************************************/
/*! exports provided: isIterable */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isIterable", function() { return isIterable; });
/* harmony import */ var _symbol_iterator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../symbol/iterator */ "./node_modules/rxjs/_esm5/internal/symbol/iterator.js");
/** PURE_IMPORTS_START _symbol_iterator PURE_IMPORTS_END */

function isIterable(input) {
    return input && typeof input[_symbol_iterator__WEBPACK_IMPORTED_MODULE_0__["iterator"]] === 'function';
}
//# sourceMappingURL=isIterable.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/util/isNumeric.js":
/*!************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/util/isNumeric.js ***!
  \************************************************************/
/*! exports provided: isNumeric */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isNumeric", function() { return isNumeric; });
/* harmony import */ var _isArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./isArray */ "./node_modules/rxjs/_esm5/internal/util/isArray.js");
/** PURE_IMPORTS_START _isArray PURE_IMPORTS_END */

function isNumeric(val) {
    return !Object(_isArray__WEBPACK_IMPORTED_MODULE_0__["isArray"])(val) && (val - parseFloat(val) + 1) >= 0;
}
//# sourceMappingURL=isNumeric.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/util/isObject.js":
/*!***********************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/util/isObject.js ***!
  \***********************************************************/
/*! exports provided: isObject */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isObject", function() { return isObject; });
/** PURE_IMPORTS_START  PURE_IMPORTS_END */
function isObject(x) {
    return x != null && typeof x === 'object';
}
//# sourceMappingURL=isObject.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/util/isObservable.js":
/*!***************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/util/isObservable.js ***!
  \***************************************************************/
/*! exports provided: isObservable */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isObservable", function() { return isObservable; });
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Observable */ "./node_modules/rxjs/_esm5/internal/Observable.js");
/** PURE_IMPORTS_START _Observable PURE_IMPORTS_END */

function isObservable(obj) {
    return !!obj && (obj instanceof _Observable__WEBPACK_IMPORTED_MODULE_0__["Observable"] || (typeof obj.lift === 'function' && typeof obj.subscribe === 'function'));
}
//# sourceMappingURL=isObservable.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/util/isPromise.js":
/*!************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/util/isPromise.js ***!
  \************************************************************/
/*! exports provided: isPromise */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isPromise", function() { return isPromise; });
/** PURE_IMPORTS_START  PURE_IMPORTS_END */
function isPromise(value) {
    return value && typeof value.subscribe !== 'function' && typeof value.then === 'function';
}
//# sourceMappingURL=isPromise.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/util/isScheduler.js":
/*!**************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/util/isScheduler.js ***!
  \**************************************************************/
/*! exports provided: isScheduler */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isScheduler", function() { return isScheduler; });
/** PURE_IMPORTS_START  PURE_IMPORTS_END */
function isScheduler(value) {
    return value && typeof value.schedule === 'function';
}
//# sourceMappingURL=isScheduler.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/util/noop.js":
/*!*******************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/util/noop.js ***!
  \*******************************************************/
/*! exports provided: noop */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "noop", function() { return noop; });
/** PURE_IMPORTS_START  PURE_IMPORTS_END */
function noop() { }
//# sourceMappingURL=noop.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/util/pipe.js":
/*!*******************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/util/pipe.js ***!
  \*******************************************************/
/*! exports provided: pipe, pipeFromArray */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "pipe", function() { return pipe; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "pipeFromArray", function() { return pipeFromArray; });
/* harmony import */ var _noop__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./noop */ "./node_modules/rxjs/_esm5/internal/util/noop.js");
/** PURE_IMPORTS_START _noop PURE_IMPORTS_END */

function pipe() {
    var fns = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        fns[_i] = arguments[_i];
    }
    return pipeFromArray(fns);
}
function pipeFromArray(fns) {
    if (!fns) {
        return _noop__WEBPACK_IMPORTED_MODULE_0__["noop"];
    }
    if (fns.length === 1) {
        return fns[0];
    }
    return function piped(input) {
        return fns.reduce(function (prev, fn) { return fn(prev); }, input);
    };
}
//# sourceMappingURL=pipe.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/util/subscribeTo.js":
/*!**************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/util/subscribeTo.js ***!
  \**************************************************************/
/*! exports provided: subscribeTo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "subscribeTo", function() { return subscribeTo; });
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Observable */ "./node_modules/rxjs/_esm5/internal/Observable.js");
/* harmony import */ var _subscribeToArray__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./subscribeToArray */ "./node_modules/rxjs/_esm5/internal/util/subscribeToArray.js");
/* harmony import */ var _subscribeToPromise__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./subscribeToPromise */ "./node_modules/rxjs/_esm5/internal/util/subscribeToPromise.js");
/* harmony import */ var _subscribeToIterable__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./subscribeToIterable */ "./node_modules/rxjs/_esm5/internal/util/subscribeToIterable.js");
/* harmony import */ var _subscribeToObservable__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./subscribeToObservable */ "./node_modules/rxjs/_esm5/internal/util/subscribeToObservable.js");
/* harmony import */ var _isArrayLike__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./isArrayLike */ "./node_modules/rxjs/_esm5/internal/util/isArrayLike.js");
/* harmony import */ var _isPromise__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./isPromise */ "./node_modules/rxjs/_esm5/internal/util/isPromise.js");
/* harmony import */ var _isObject__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./isObject */ "./node_modules/rxjs/_esm5/internal/util/isObject.js");
/* harmony import */ var _symbol_iterator__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../symbol/iterator */ "./node_modules/rxjs/_esm5/internal/symbol/iterator.js");
/* harmony import */ var _symbol_observable__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../symbol/observable */ "./node_modules/rxjs/_esm5/internal/symbol/observable.js");
/** PURE_IMPORTS_START _Observable,_subscribeToArray,_subscribeToPromise,_subscribeToIterable,_subscribeToObservable,_isArrayLike,_isPromise,_isObject,_symbol_iterator,_symbol_observable PURE_IMPORTS_END */










var subscribeTo = function (result) {
    if (result instanceof _Observable__WEBPACK_IMPORTED_MODULE_0__["Observable"]) {
        return function (subscriber) {
            if (result._isScalar) {
                subscriber.next(result.value);
                subscriber.complete();
                return undefined;
            }
            else {
                return result.subscribe(subscriber);
            }
        };
    }
    else if (result && typeof result[_symbol_observable__WEBPACK_IMPORTED_MODULE_9__["observable"]] === 'function') {
        return Object(_subscribeToObservable__WEBPACK_IMPORTED_MODULE_4__["subscribeToObservable"])(result);
    }
    else if (Object(_isArrayLike__WEBPACK_IMPORTED_MODULE_5__["isArrayLike"])(result)) {
        return Object(_subscribeToArray__WEBPACK_IMPORTED_MODULE_1__["subscribeToArray"])(result);
    }
    else if (Object(_isPromise__WEBPACK_IMPORTED_MODULE_6__["isPromise"])(result)) {
        return Object(_subscribeToPromise__WEBPACK_IMPORTED_MODULE_2__["subscribeToPromise"])(result);
    }
    else if (result && typeof result[_symbol_iterator__WEBPACK_IMPORTED_MODULE_8__["iterator"]] === 'function') {
        return Object(_subscribeToIterable__WEBPACK_IMPORTED_MODULE_3__["subscribeToIterable"])(result);
    }
    else {
        var value = Object(_isObject__WEBPACK_IMPORTED_MODULE_7__["isObject"])(result) ? 'an invalid object' : "'" + result + "'";
        var msg = "You provided " + value + " where a stream was expected."
            + ' You can provide an Observable, Promise, Array, or Iterable.';
        throw new TypeError(msg);
    }
};
//# sourceMappingURL=subscribeTo.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/util/subscribeToArray.js":
/*!*******************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/util/subscribeToArray.js ***!
  \*******************************************************************/
/*! exports provided: subscribeToArray */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "subscribeToArray", function() { return subscribeToArray; });
/** PURE_IMPORTS_START  PURE_IMPORTS_END */
var subscribeToArray = function (array) {
    return function (subscriber) {
        for (var i = 0, len = array.length; i < len && !subscriber.closed; i++) {
            subscriber.next(array[i]);
        }
        if (!subscriber.closed) {
            subscriber.complete();
        }
    };
};
//# sourceMappingURL=subscribeToArray.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/util/subscribeToIterable.js":
/*!**********************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/util/subscribeToIterable.js ***!
  \**********************************************************************/
/*! exports provided: subscribeToIterable */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "subscribeToIterable", function() { return subscribeToIterable; });
/* harmony import */ var _symbol_iterator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../symbol/iterator */ "./node_modules/rxjs/_esm5/internal/symbol/iterator.js");
/** PURE_IMPORTS_START _symbol_iterator PURE_IMPORTS_END */

var subscribeToIterable = function (iterable) {
    return function (subscriber) {
        var iterator = iterable[_symbol_iterator__WEBPACK_IMPORTED_MODULE_0__["iterator"]]();
        do {
            var item = iterator.next();
            if (item.done) {
                subscriber.complete();
                break;
            }
            subscriber.next(item.value);
            if (subscriber.closed) {
                break;
            }
        } while (true);
        if (typeof iterator.return === 'function') {
            subscriber.add(function () {
                if (iterator.return) {
                    iterator.return();
                }
            });
        }
        return subscriber;
    };
};
//# sourceMappingURL=subscribeToIterable.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/util/subscribeToObservable.js":
/*!************************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/util/subscribeToObservable.js ***!
  \************************************************************************/
/*! exports provided: subscribeToObservable */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "subscribeToObservable", function() { return subscribeToObservable; });
/* harmony import */ var _symbol_observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../symbol/observable */ "./node_modules/rxjs/_esm5/internal/symbol/observable.js");
/** PURE_IMPORTS_START _symbol_observable PURE_IMPORTS_END */

var subscribeToObservable = function (obj) {
    return function (subscriber) {
        var obs = obj[_symbol_observable__WEBPACK_IMPORTED_MODULE_0__["observable"]]();
        if (typeof obs.subscribe !== 'function') {
            throw new TypeError('Provided object does not correctly implement Symbol.observable');
        }
        else {
            return obs.subscribe(subscriber);
        }
    };
};
//# sourceMappingURL=subscribeToObservable.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/util/subscribeToPromise.js":
/*!*********************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/util/subscribeToPromise.js ***!
  \*********************************************************************/
/*! exports provided: subscribeToPromise */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "subscribeToPromise", function() { return subscribeToPromise; });
/* harmony import */ var _hostReportError__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./hostReportError */ "./node_modules/rxjs/_esm5/internal/util/hostReportError.js");
/** PURE_IMPORTS_START _hostReportError PURE_IMPORTS_END */

var subscribeToPromise = function (promise) {
    return function (subscriber) {
        promise.then(function (value) {
            if (!subscriber.closed) {
                subscriber.next(value);
                subscriber.complete();
            }
        }, function (err) { return subscriber.error(err); })
            .then(null, _hostReportError__WEBPACK_IMPORTED_MODULE_0__["hostReportError"]);
        return subscriber;
    };
};
//# sourceMappingURL=subscribeToPromise.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/util/subscribeToResult.js":
/*!********************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/util/subscribeToResult.js ***!
  \********************************************************************/
/*! exports provided: subscribeToResult */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "subscribeToResult", function() { return subscribeToResult; });
/* harmony import */ var _InnerSubscriber__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../InnerSubscriber */ "./node_modules/rxjs/_esm5/internal/InnerSubscriber.js");
/* harmony import */ var _subscribeTo__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./subscribeTo */ "./node_modules/rxjs/_esm5/internal/util/subscribeTo.js");
/** PURE_IMPORTS_START _InnerSubscriber,_subscribeTo PURE_IMPORTS_END */


function subscribeToResult(outerSubscriber, result, outerValue, outerIndex, destination) {
    if (destination === void 0) {
        destination = new _InnerSubscriber__WEBPACK_IMPORTED_MODULE_0__["InnerSubscriber"](outerSubscriber, outerValue, outerIndex);
    }
    if (destination.closed) {
        return;
    }
    return Object(_subscribeTo__WEBPACK_IMPORTED_MODULE_1__["subscribeTo"])(result)(destination);
}
//# sourceMappingURL=subscribeToResult.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/util/toSubscriber.js":
/*!***************************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/util/toSubscriber.js ***!
  \***************************************************************/
/*! exports provided: toSubscriber */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "toSubscriber", function() { return toSubscriber; });
/* harmony import */ var _Subscriber__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Subscriber */ "./node_modules/rxjs/_esm5/internal/Subscriber.js");
/* harmony import */ var _symbol_rxSubscriber__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../symbol/rxSubscriber */ "./node_modules/rxjs/_esm5/internal/symbol/rxSubscriber.js");
/* harmony import */ var _Observer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Observer */ "./node_modules/rxjs/_esm5/internal/Observer.js");
/** PURE_IMPORTS_START _Subscriber,_symbol_rxSubscriber,_Observer PURE_IMPORTS_END */



function toSubscriber(nextOrObserver, error, complete) {
    if (nextOrObserver) {
        if (nextOrObserver instanceof _Subscriber__WEBPACK_IMPORTED_MODULE_0__["Subscriber"]) {
            return nextOrObserver;
        }
        if (nextOrObserver[_symbol_rxSubscriber__WEBPACK_IMPORTED_MODULE_1__["rxSubscriber"]]) {
            return nextOrObserver[_symbol_rxSubscriber__WEBPACK_IMPORTED_MODULE_1__["rxSubscriber"]]();
        }
    }
    if (!nextOrObserver && !error && !complete) {
        return new _Subscriber__WEBPACK_IMPORTED_MODULE_0__["Subscriber"](_Observer__WEBPACK_IMPORTED_MODULE_2__["empty"]);
    }
    return new _Subscriber__WEBPACK_IMPORTED_MODULE_0__["Subscriber"](nextOrObserver, error, complete);
}
//# sourceMappingURL=toSubscriber.js.map


/***/ }),

/***/ "./node_modules/rxjs/_esm5/internal/util/tryCatch.js":
/*!***********************************************************!*\
  !*** ./node_modules/rxjs/_esm5/internal/util/tryCatch.js ***!
  \***********************************************************/
/*! exports provided: tryCatch */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "tryCatch", function() { return tryCatch; });
/* harmony import */ var _errorObject__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./errorObject */ "./node_modules/rxjs/_esm5/internal/util/errorObject.js");
/** PURE_IMPORTS_START _errorObject PURE_IMPORTS_END */

var tryCatchTarget;
function tryCatcher() {
    try {
        return tryCatchTarget.apply(this, arguments);
    }
    catch (e) {
        _errorObject__WEBPACK_IMPORTED_MODULE_0__["errorObject"].e = e;
        return _errorObject__WEBPACK_IMPORTED_MODULE_0__["errorObject"];
    }
}
function tryCatch(fn) {
    tryCatchTarget = fn;
    return tryCatcher;
}
//# sourceMappingURL=tryCatch.js.map


/***/ }),

/***/ "./node_modules/sift/src/index.js":
/*!****************************************!*\
  !*** ./node_modules/sift/src/index.js ***!
  \****************************************/
/*! exports provided: default, indexOf, compare */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return sift; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "indexOf", function() { return indexOf; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "compare", function() { return compare; });
/*
 *
 * Copryright 2018, Craig Condon
 * Licensed under MIT
 *
 * Filter JavaScript objects with mongodb queries
 */

/**
 */

function isFunction(value) {
  return typeof value === 'function';
}

/**
 */

function isArray(value) {
  return Object.prototype.toString.call(value) === '[object Array]';
}

/**
 */

function comparable(value) {
  if (value instanceof Date) {
    return value.getTime();
  } else if (isArray(value)) {
    return value.map(comparable);
  } else if (value && typeof value.toJSON === 'function') {
    return value.toJSON();
  } else {
    return value;
  }
}

function get(obj, key) {
  return isFunction(obj.get) ? obj.get(key) : obj[key];
}

/**
 */

function or(validator) {
  return function(a, b) {
    if (!isArray(b) || !b.length) {
      return validator(a, b);
    }
    for (var i = 0, n = b.length; i < n; i++) {
      if (validator(a, get(b,i))) return true;
    }
    return false;
  }
}

/**
 */

function and(validator) {
  return function(a, b) {
    if (!isArray(b) || !b.length) {
      return validator(a, b);
    }
    for (var i = 0, n = b.length; i < n; i++) {
      if (!validator(a, get(b, i))) return false;
    }
    return true;
  };
}

function validate(validator, b, k, o) {
  return validator.v(validator.a, b, k, o);
}

var OPERATORS = {

  /**
   */

  $eq: or(function(a, b) {
    return a(b);
  }),

  /**
   */

  $ne: and(function(a, b) {
    return !a(b);
  }),

  /**
   */

  $gt: or(function(a, b) {
    return compare(comparable(b), a) > 0;
  }),

  /**
   */

  $gte: or(function(a, b) {
    return compare(comparable(b), a) >= 0;
  }),

  /**
   */

  $lt: or(function(a, b) {
    return compare(comparable(b), a) < 0;
  }),

  /**
   */

  $lte: or(function(a, b) {
    return compare(comparable(b), a) <= 0;
  }),

  /**
   */

  $mod: or(function(a, b) {
    return b % a[0] == a[1];
  }),

  /**
   */

  $in: function(a, b) {

    if (b instanceof Array) {
      for (var i = b.length; i--;) {
        if (~a.indexOf(comparable(get(b, i)))) {
          return true;
        }
      }
    } else {
      var comparableB = comparable(b);
      if (comparableB === b && typeof b === 'object') {
        for (var i = a.length; i--;) {
          if (String(a[i]) === String(b) && String(b) !== '[object Object]') {
            return true;
          }
        }
      }

      /*
        Handles documents that are undefined, whilst also
        having a 'null' element in the parameters to $in.
      */
      if (typeof comparableB == 'undefined') {
        for (var i = a.length; i--;) {
          if (a[i] == null) {
            return true;
          }
        }
      }

      /*
        Handles the case of {'field': {$in: [/regexp1/, /regexp2/, ...]}}
      */
      for (var i = a.length; i--;) {
        var validator = createRootValidator(get(a, i), undefined);
        var result = validate(validator, b, i, a);
        if ((result) && (String(result) !== '[object Object]') && (String(b) !== '[object Object]')) {
          return true;
        }
      }

      return !!~a.indexOf(comparableB);
    }

    return false;
  },

  /**
   */

  $nin: function(a, b, k, o) {
    return !OPERATORS.$in(a, b, k, o);
  },

  /**
   */

  $not: function(a, b, k, o) {
    return !validate(a, b, k, o);
  },

  /**
   */

  $type: function(a, b) {
    return b != void 0 ? b instanceof a || b.constructor == a : false;
    },

  /**
   */

  $all: function(a, b, k, o) {
    return OPERATORS.$and(a, b, k, o);
  },

  /**
   */

  $size: function(a, b) {
    return b ? a === b.length : false;
  },

  /**
   */

  $or: function(a, b, k, o) {
    for (var i = 0, n = a.length; i < n; i++) if (validate(get(a, i), b, k, o)) return true;
    return false;
  },

  /**
   */

  $nor: function(a, b, k, o) {
    return !OPERATORS.$or(a, b, k, o);
  },

  /**
   */

  $and: function(a, b, k, o) {
    for (var i = 0, n = a.length; i < n; i++) {
      if (!validate(get(a, i), b, k, o)) {
        return false;
      }
    }
    return true;
  },

  /**
   */

  $regex: or(function(a, b) {
    return typeof b === 'string' && a.test(b);
  }),

  /**
   */

  $where: function(a, b, k, o) {
    return a.call(b, b, k, o);
  },

  /**
   */

  $elemMatch: function(a, b, k, o) {
    if (isArray(b)) {
      return !!~search(b, a);
    }
    return validate(a, b, k, o);
  },

  /**
   */

  $exists: function(a, b, k, o) {
    return o.hasOwnProperty(k) === a;
  }
};

/**
 */

var prepare = {

  /**
   */

  $eq: function(a) {

    if (a instanceof RegExp) {
      return function(b) {
        return typeof b === 'string' && a.test(b);
      };
    } else if (a instanceof Function) {
      return a;
    } else if (isArray(a) && !a.length) {
      // Special case of a == []
      return function(b) {
        return (isArray(b) && !b.length);
      };
    } else if (a === null){
      return function(b){
        //will match both null and undefined
        return b == null;
      }
    }

    return function(b) {
      return compare(comparable(b), comparable(a)) === 0;
    };
  },

  /**
   */

  $ne: function(a) {
    return prepare.$eq(a);
  },

  /**
   */

  $and: function(a) {
    return a.map(parse);
  },

  /**
   */

  $all: function(a) {
    return prepare.$and(a);
  },

  /**
   */

  $or: function(a) {
    return a.map(parse);
  },

  /**
   */

  $nor: function(a) {
    return a.map(parse);
  },

  /**
   */

  $not: function(a) {
    return parse(a);
  },

  /**
   */

  $regex: function(a, query) {
    return new RegExp(a, query.$options);
  },

  /**
   */

  $where: function(a) {
    return typeof a === 'string' ? new Function('obj', 'return ' + a) : a;
  },

  /**
   */

  $elemMatch: function(a) {
    return parse(a);
  },

  /**
   */

  $exists: function(a) {
    return !!a;
  }
};

/**
 */

function search(array, validator) {

  for (var i = 0; i < array.length; i++) {
    var result = get(array, i);
    if (validate(validator, get(array, i))) {
      return i;
    }
  }

  return -1;
}

/**
 */

function createValidator(a, validate) {
  return { a: a, v: validate };
}

/**
 */

function nestedValidator(a, b) {
  var values  = [];
  findValues(b, a.k, 0, b, values);

  if (values.length === 1) {
    var first = values[0];
    return validate(a.nv, first[0], first[1], first[2]);
  }

  // If the query contains $ne, need to test all elements ANDed together
  var inclusive = a && a.q && typeof a.q.$ne !== 'undefined';
  var allValid = inclusive;
  for (var i = 0; i < values.length; i++) {
    var result = values[i];
    var isValid = validate(a.nv, result[0], result[1], result[2]);
    if (inclusive) {
      allValid &= isValid;
    } else {
      allValid |= isValid;
    }
  }
  return allValid;
}

/**
 */

function findValues(current, keypath, index, object, values) {

  if (index === keypath.length || current == void 0) {

    values.push([current, keypath[index - 1], object]);
    return;
  }

  var k = get(keypath, index);

  // ensure that if current is an array, that the current key
  // is NOT an array index. This sort of thing needs to work:
  // sift({'foo.0':42}, [{foo: [42]}]);
  if (isArray(current) && isNaN(Number(k))) {
    for (var i = 0, n = current.length; i < n; i++) {
      findValues(get(current, i), keypath, index, current, values);
    }
  } else {
    findValues(get(current, k), keypath, index + 1, current, values);
  }
}

/**
 */

function createNestedValidator(keypath, a, q) {
  return { a: { k: keypath, nv: a, q: q }, v: nestedValidator };
}

/**
 * flatten the query
 */

function isVanillaObject(value) {
  return value && value.constructor === Object;
}

function parse(query) {
  query = comparable(query);

  if (!query || !isVanillaObject(query)) { // cross browser support
    query = { $eq: query };
  }

  var validators = [];

  for (var key in query) {
    var a = query[key];

    if (key === '$options') {
      continue;
    }

    if (OPERATORS[key]) {
      if (prepare[key]) a = prepare[key](a, query);
      validators.push(createValidator(comparable(a), OPERATORS[key]));
    } else {

      if (key.charCodeAt(0) === 36) {
        throw new Error('Unknown operation ' + key);
      }
      validators.push(createNestedValidator(key.split('.'), parse(a), a));
    }
  }

  return validators.length === 1 ? validators[0] : createValidator(validators, OPERATORS.$and);
}

/**
 */

function createRootValidator(query, getter) {
  var validator = parse(query);
  if (getter) {
    validator = {
      a: validator,
      v: function(a, b, k, o) {
        return validate(a, getter(b), k, o);
      }
    };
  }
  return validator;
}

/**
 */

function sift(query, array, getter) {

  if (isFunction(array)) {
    getter = array;
    array  = void 0;
  }

  var validator = createRootValidator(query, getter);

  function filter(b, k, o) {
    return validate(validator, b, k, o);
  }

  if (array) {
    return array.filter(filter);
  }

  return filter;
}

/**
 */

function indexOf(query, array, getter) {
  return search(array, createRootValidator(query, getter));
};

/**
 */

function compare(a, b) {
  if(a===b) return 0;
  if(typeof a === typeof b) {
    if (a > b) {
      return 1;
    }
    if (a < b) {
      return -1;
    }
  }
};

/***/ }),

/***/ "./node_modules/tslib/tslib.es6.js":
/*!*****************************************!*\
  !*** ./node_modules/tslib/tslib.es6.js ***!
  \*****************************************/
/*! exports provided: __extends, __assign, __rest, __decorate, __param, __metadata, __awaiter, __generator, __exportStar, __values, __read, __spread, __await, __asyncGenerator, __asyncDelegator, __asyncValues, __makeTemplateObject, __importStar, __importDefault */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__extends", function() { return __extends; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__assign", function() { return __assign; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__rest", function() { return __rest; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__decorate", function() { return __decorate; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__param", function() { return __param; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__metadata", function() { return __metadata; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__awaiter", function() { return __awaiter; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__generator", function() { return __generator; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__exportStar", function() { return __exportStar; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__values", function() { return __values; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__read", function() { return __read; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__spread", function() { return __spread; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__await", function() { return __await; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__asyncGenerator", function() { return __asyncGenerator; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__asyncDelegator", function() { return __asyncDelegator; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__asyncValues", function() { return __asyncValues; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__makeTemplateObject", function() { return __makeTemplateObject; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__importStar", function() { return __importStar; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__importDefault", function() { return __importDefault; });
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
/* global Reflect, Promise */

var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return extendStatics(d, b);
};

function __extends(d, b) {
    extendStatics(d, b);
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
}

var __assign = function() {
    __assign = Object.assign || function __assign(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
        }
        return t;
    }
    return __assign.apply(this, arguments);
}

function __rest(s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)
            t[p[i]] = s[p[i]];
    return t;
}

function __decorate(decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
}

function __param(paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
}

function __metadata(metadataKey, metadataValue) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(metadataKey, metadataValue);
}

function __awaiter(thisArg, _arguments, P, generator) {
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
}

function __generator(thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (_) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
}

function __exportStar(m, exports) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}

function __values(o) {
    var m = typeof Symbol === "function" && o[Symbol.iterator], i = 0;
    if (m) return m.call(o);
    return {
        next: function () {
            if (o && i >= o.length) o = void 0;
            return { value: o && o[i++], done: !o };
        }
    };
}

function __read(o, n) {
    var m = typeof Symbol === "function" && o[Symbol.iterator];
    if (!m) return o;
    var i = m.call(o), r, ar = [], e;
    try {
        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
    }
    catch (error) { e = { error: error }; }
    finally {
        try {
            if (r && !r.done && (m = i["return"])) m.call(i);
        }
        finally { if (e) throw e.error; }
    }
    return ar;
}

function __spread() {
    for (var ar = [], i = 0; i < arguments.length; i++)
        ar = ar.concat(__read(arguments[i]));
    return ar;
}

function __await(v) {
    return this instanceof __await ? (this.v = v, this) : new __await(v);
}

function __asyncGenerator(thisArg, _arguments, generator) {
    if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
    var g = generator.apply(thisArg, _arguments || []), i, q = [];
    return i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i;
    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }
    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }
    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }
    function fulfill(value) { resume("next", value); }
    function reject(value) { resume("throw", value); }
    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }
}

function __asyncDelegator(o) {
    var i, p;
    return i = {}, verb("next"), verb("throw", function (e) { throw e; }), verb("return"), i[Symbol.iterator] = function () { return this; }, i;
    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === "return" } : f ? f(v) : v; } : f; }
}

function __asyncValues(o) {
    if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
    var m = o[Symbol.asyncIterator], i;
    return m ? m.call(o) : (o = typeof __values === "function" ? __values(o) : o[Symbol.iterator](), i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i);
    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }
    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }
}

function __makeTemplateObject(cooked, raw) {
    if (Object.defineProperty) { Object.defineProperty(cooked, "raw", { value: raw }); } else { cooked.raw = raw; }
    return cooked;
};

function __importStar(mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];
    result.default = mod;
    return result;
}

function __importDefault(mod) {
    return (mod && mod.__esModule) ? mod : { default: mod };
}


/***/ }),

/***/ "./node_modules/url-join/lib/url-join.js":
/*!***********************************************!*\
  !*** ./node_modules/url-join/lib/url-join.js ***!
  \***********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_RESULT__;(function (name, context, definition) {
  if ( true && module.exports) module.exports = definition();
  else if (true) !(__WEBPACK_AMD_DEFINE_FACTORY__ = (definition),
				__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?
				(__WEBPACK_AMD_DEFINE_FACTORY__.call(exports, __webpack_require__, exports, module)) :
				__WEBPACK_AMD_DEFINE_FACTORY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
  else {}
})('urljoin', this, function () {

  function normalize (strArray) {
    var resultArray = [];

    // If the first part is a plain protocol, we combine it with the next part.
    if (strArray[0].match(/^[^/:]+:\/*$/) && strArray.length > 1) {
      var first = strArray.shift();
      strArray[0] = first + strArray[0];
    }

    // There must be two or three slashes in the file protocol, two slashes in anything else.
    if (strArray[0].match(/^file:\/\/\//)) {
      strArray[0] = strArray[0].replace(/^([^/:]+):\/*/, '$1:///');
    } else {
      strArray[0] = strArray[0].replace(/^([^/:]+):\/*/, '$1://');
    }

    for (var i = 0; i < strArray.length; i++) {
      var component = strArray[i];

      if (typeof component !== 'string') {
        throw new TypeError('Url must be a string. Received ' + component);
      }

      if (component === '') { continue; }

      if (i > 0) {
        // Removing the starting slashes for each component but the first.
        component = component.replace(/^[\/]+/, '');
      }
      if (i < strArray.length - 1) {
        // Removing the ending slashes for each component but the last.
        component = component.replace(/[\/]+$/, '');
      } else {
        // For the last component we will combine multiple slashes to a single one.
        component = component.replace(/[\/]+$/, '/');
      }

      resultArray.push(component);

    }

    var str = resultArray.join('/');
    // Each input component is now separated by a single slash except the possible first plain protocol part.

    // remove trailing slash before parameters or hash
    str = str.replace(/\/(\?|&|#[^!])/g, '$1');

    // replace ? in parameters with &
    var parts = str.split('?');
    str = parts.shift() + (parts.length > 0 ? '?': '') + parts.join('&');

    return str;
  }

  return function () {
    var input;

    if (typeof arguments[0] === 'object') {
      input = arguments[0];
    } else {
      input = [].slice.call(arguments);
    }

    return normalize(input);
  };

});


/***/ }),

/***/ "./node_modules/url/url.js":
/*!*********************************!*\
  !*** ./node_modules/url/url.js ***!
  \*********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.



var punycode = __webpack_require__(/*! punycode */ "./node_modules/node-libs-browser/node_modules/punycode/punycode.js");
var util = __webpack_require__(/*! ./util */ "./node_modules/url/util.js");

exports.parse = urlParse;
exports.resolve = urlResolve;
exports.resolveObject = urlResolveObject;
exports.format = urlFormat;

exports.Url = Url;

function Url() {
  this.protocol = null;
  this.slashes = null;
  this.auth = null;
  this.host = null;
  this.port = null;
  this.hostname = null;
  this.hash = null;
  this.search = null;
  this.query = null;
  this.pathname = null;
  this.path = null;
  this.href = null;
}

// Reference: RFC 3986, RFC 1808, RFC 2396

// define these here so at least they only have to be
// compiled once on the first module load.
var protocolPattern = /^([a-z0-9.+-]+:)/i,
    portPattern = /:[0-9]*$/,

    // Special case for a simple path URL
    simplePathPattern = /^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,

    // RFC 2396: characters reserved for delimiting URLs.
    // We actually just auto-escape these.
    delims = ['<', '>', '"', '`', ' ', '\r', '\n', '\t'],

    // RFC 2396: characters not allowed for various reasons.
    unwise = ['{', '}', '|', '\\', '^', '`'].concat(delims),

    // Allowed by RFCs, but cause of XSS attacks.  Always escape these.
    autoEscape = ['\''].concat(unwise),
    // Characters that are never ever allowed in a hostname.
    // Note that any invalid chars are also handled, but these
    // are the ones that are *expected* to be seen, so we fast-path
    // them.
    nonHostChars = ['%', '/', '?', ';', '#'].concat(autoEscape),
    hostEndingChars = ['/', '?', '#'],
    hostnameMaxLen = 255,
    hostnamePartPattern = /^[+a-z0-9A-Z_-]{0,63}$/,
    hostnamePartStart = /^([+a-z0-9A-Z_-]{0,63})(.*)$/,
    // protocols that can allow "unsafe" and "unwise" chars.
    unsafeProtocol = {
      'javascript': true,
      'javascript:': true
    },
    // protocols that never have a hostname.
    hostlessProtocol = {
      'javascript': true,
      'javascript:': true
    },
    // protocols that always contain a // bit.
    slashedProtocol = {
      'http': true,
      'https': true,
      'ftp': true,
      'gopher': true,
      'file': true,
      'http:': true,
      'https:': true,
      'ftp:': true,
      'gopher:': true,
      'file:': true
    },
    querystring = __webpack_require__(/*! querystring */ "./node_modules/querystring-es3/index.js");

function urlParse(url, parseQueryString, slashesDenoteHost) {
  if (url && util.isObject(url) && url instanceof Url) return url;

  var u = new Url;
  u.parse(url, parseQueryString, slashesDenoteHost);
  return u;
}

Url.prototype.parse = function(url, parseQueryString, slashesDenoteHost) {
  if (!util.isString(url)) {
    throw new TypeError("Parameter 'url' must be a string, not " + typeof url);
  }

  // Copy chrome, IE, opera backslash-handling behavior.
  // Back slashes before the query string get converted to forward slashes
  // See: https://code.google.com/p/chromium/issues/detail?id=25916
  var queryIndex = url.indexOf('?'),
      splitter =
          (queryIndex !== -1 && queryIndex < url.indexOf('#')) ? '?' : '#',
      uSplit = url.split(splitter),
      slashRegex = /\\/g;
  uSplit[0] = uSplit[0].replace(slashRegex, '/');
  url = uSplit.join(splitter);

  var rest = url;

  // trim before proceeding.
  // This is to support parse stuff like "  http://foo.com  \n"
  rest = rest.trim();

  if (!slashesDenoteHost && url.split('#').length === 1) {
    // Try fast path regexp
    var simplePath = simplePathPattern.exec(rest);
    if (simplePath) {
      this.path = rest;
      this.href = rest;
      this.pathname = simplePath[1];
      if (simplePath[2]) {
        this.search = simplePath[2];
        if (parseQueryString) {
          this.query = querystring.parse(this.search.substr(1));
        } else {
          this.query = this.search.substr(1);
        }
      } else if (parseQueryString) {
        this.search = '';
        this.query = {};
      }
      return this;
    }
  }

  var proto = protocolPattern.exec(rest);
  if (proto) {
    proto = proto[0];
    var lowerProto = proto.toLowerCase();
    this.protocol = lowerProto;
    rest = rest.substr(proto.length);
  }

  // figure out if it's got a host
  // user@server is *always* interpreted as a hostname, and url
  // resolution will treat //foo/bar as host=foo,path=bar because that's
  // how the browser resolves relative URLs.
  if (slashesDenoteHost || proto || rest.match(/^\/\/[^@\/]+@[^@\/]+/)) {
    var slashes = rest.substr(0, 2) === '//';
    if (slashes && !(proto && hostlessProtocol[proto])) {
      rest = rest.substr(2);
      this.slashes = true;
    }
  }

  if (!hostlessProtocol[proto] &&
      (slashes || (proto && !slashedProtocol[proto]))) {

    // there's a hostname.
    // the first instance of /, ?, ;, or # ends the host.
    //
    // If there is an @ in the hostname, then non-host chars *are* allowed
    // to the left of the last @ sign, unless some host-ending character
    // comes *before* the @-sign.
    // URLs are obnoxious.
    //
    // ex:
    // http://a@b@c/ => user:a@b host:c
    // http://a@b?@c => user:a host:c path:/?@c

    // v0.12 TODO(isaacs): This is not quite how Chrome does things.
    // Review our test case against browsers more comprehensively.

    // find the first instance of any hostEndingChars
    var hostEnd = -1;
    for (var i = 0; i < hostEndingChars.length; i++) {
      var hec = rest.indexOf(hostEndingChars[i]);
      if (hec !== -1 && (hostEnd === -1 || hec < hostEnd))
        hostEnd = hec;
    }

    // at this point, either we have an explicit point where the
    // auth portion cannot go past, or the last @ char is the decider.
    var auth, atSign;
    if (hostEnd === -1) {
      // atSign can be anywhere.
      atSign = rest.lastIndexOf('@');
    } else {
      // atSign must be in auth portion.
      // http://a@b/c@d => host:b auth:a path:/c@d
      atSign = rest.lastIndexOf('@', hostEnd);
    }

    // Now we have a portion which is definitely the auth.
    // Pull that off.
    if (atSign !== -1) {
      auth = rest.slice(0, atSign);
      rest = rest.slice(atSign + 1);
      this.auth = decodeURIComponent(auth);
    }

    // the host is the remaining to the left of the first non-host char
    hostEnd = -1;
    for (var i = 0; i < nonHostChars.length; i++) {
      var hec = rest.indexOf(nonHostChars[i]);
      if (hec !== -1 && (hostEnd === -1 || hec < hostEnd))
        hostEnd = hec;
    }
    // if we still have not hit it, then the entire thing is a host.
    if (hostEnd === -1)
      hostEnd = rest.length;

    this.host = rest.slice(0, hostEnd);
    rest = rest.slice(hostEnd);

    // pull out port.
    this.parseHost();

    // we've indicated that there is a hostname,
    // so even if it's empty, it has to be present.
    this.hostname = this.hostname || '';

    // if hostname begins with [ and ends with ]
    // assume that it's an IPv6 address.
    var ipv6Hostname = this.hostname[0] === '[' &&
        this.hostname[this.hostname.length - 1] === ']';

    // validate a little.
    if (!ipv6Hostname) {
      var hostparts = this.hostname.split(/\./);
      for (var i = 0, l = hostparts.length; i < l; i++) {
        var part = hostparts[i];
        if (!part) continue;
        if (!part.match(hostnamePartPattern)) {
          var newpart = '';
          for (var j = 0, k = part.length; j < k; j++) {
            if (part.charCodeAt(j) > 127) {
              // we replace non-ASCII char with a temporary placeholder
              // we need this to make sure size of hostname is not
              // broken by replacing non-ASCII by nothing
              newpart += 'x';
            } else {
              newpart += part[j];
            }
          }
          // we test again with ASCII char only
          if (!newpart.match(hostnamePartPattern)) {
            var validParts = hostparts.slice(0, i);
            var notHost = hostparts.slice(i + 1);
            var bit = part.match(hostnamePartStart);
            if (bit) {
              validParts.push(bit[1]);
              notHost.unshift(bit[2]);
            }
            if (notHost.length) {
              rest = '/' + notHost.join('.') + rest;
            }
            this.hostname = validParts.join('.');
            break;
          }
        }
      }
    }

    if (this.hostname.length > hostnameMaxLen) {
      this.hostname = '';
    } else {
      // hostnames are always lower case.
      this.hostname = this.hostname.toLowerCase();
    }

    if (!ipv6Hostname) {
      // IDNA Support: Returns a punycoded representation of "domain".
      // It only converts parts of the domain name that
      // have non-ASCII characters, i.e. it doesn't matter if
      // you call it with a domain that already is ASCII-only.
      this.hostname = punycode.toASCII(this.hostname);
    }

    var p = this.port ? ':' + this.port : '';
    var h = this.hostname || '';
    this.host = h + p;
    this.href += this.host;

    // strip [ and ] from the hostname
    // the host field still retains them, though
    if (ipv6Hostname) {
      this.hostname = this.hostname.substr(1, this.hostname.length - 2);
      if (rest[0] !== '/') {
        rest = '/' + rest;
      }
    }
  }

  // now rest is set to the post-host stuff.
  // chop off any delim chars.
  if (!unsafeProtocol[lowerProto]) {

    // First, make 100% sure that any "autoEscape" chars get
    // escaped, even if encodeURIComponent doesn't think they
    // need to be.
    for (var i = 0, l = autoEscape.length; i < l; i++) {
      var ae = autoEscape[i];
      if (rest.indexOf(ae) === -1)
        continue;
      var esc = encodeURIComponent(ae);
      if (esc === ae) {
        esc = escape(ae);
      }
      rest = rest.split(ae).join(esc);
    }
  }


  // chop off from the tail first.
  var hash = rest.indexOf('#');
  if (hash !== -1) {
    // got a fragment string.
    this.hash = rest.substr(hash);
    rest = rest.slice(0, hash);
  }
  var qm = rest.indexOf('?');
  if (qm !== -1) {
    this.search = rest.substr(qm);
    this.query = rest.substr(qm + 1);
    if (parseQueryString) {
      this.query = querystring.parse(this.query);
    }
    rest = rest.slice(0, qm);
  } else if (parseQueryString) {
    // no query string, but parseQueryString still requested
    this.search = '';
    this.query = {};
  }
  if (rest) this.pathname = rest;
  if (slashedProtocol[lowerProto] &&
      this.hostname && !this.pathname) {
    this.pathname = '/';
  }

  //to support http.request
  if (this.pathname || this.search) {
    var p = this.pathname || '';
    var s = this.search || '';
    this.path = p + s;
  }

  // finally, reconstruct the href based on what has been validated.
  this.href = this.format();
  return this;
};

// format a parsed object into a url string
function urlFormat(obj) {
  // ensure it's an object, and not a string url.
  // If it's an obj, this is a no-op.
  // this way, you can call url_format() on strings
  // to clean up potentially wonky urls.
  if (util.isString(obj)) obj = urlParse(obj);
  if (!(obj instanceof Url)) return Url.prototype.format.call(obj);
  return obj.format();
}

Url.prototype.format = function() {
  var auth = this.auth || '';
  if (auth) {
    auth = encodeURIComponent(auth);
    auth = auth.replace(/%3A/i, ':');
    auth += '@';
  }

  var protocol = this.protocol || '',
      pathname = this.pathname || '',
      hash = this.hash || '',
      host = false,
      query = '';

  if (this.host) {
    host = auth + this.host;
  } else if (this.hostname) {
    host = auth + (this.hostname.indexOf(':') === -1 ?
        this.hostname :
        '[' + this.hostname + ']');
    if (this.port) {
      host += ':' + this.port;
    }
  }

  if (this.query &&
      util.isObject(this.query) &&
      Object.keys(this.query).length) {
    query = querystring.stringify(this.query);
  }

  var search = this.search || (query && ('?' + query)) || '';

  if (protocol && protocol.substr(-1) !== ':') protocol += ':';

  // only the slashedProtocols get the //.  Not mailto:, xmpp:, etc.
  // unless they had them to begin with.
  if (this.slashes ||
      (!protocol || slashedProtocol[protocol]) && host !== false) {
    host = '//' + (host || '');
    if (pathname && pathname.charAt(0) !== '/') pathname = '/' + pathname;
  } else if (!host) {
    host = '';
  }

  if (hash && hash.charAt(0) !== '#') hash = '#' + hash;
  if (search && search.charAt(0) !== '?') search = '?' + search;

  pathname = pathname.replace(/[?#]/g, function(match) {
    return encodeURIComponent(match);
  });
  search = search.replace('#', '%23');

  return protocol + host + pathname + search + hash;
};

function urlResolve(source, relative) {
  return urlParse(source, false, true).resolve(relative);
}

Url.prototype.resolve = function(relative) {
  return this.resolveObject(urlParse(relative, false, true)).format();
};

function urlResolveObject(source, relative) {
  if (!source) return relative;
  return urlParse(source, false, true).resolveObject(relative);
}

Url.prototype.resolveObject = function(relative) {
  if (util.isString(relative)) {
    var rel = new Url();
    rel.parse(relative, false, true);
    relative = rel;
  }

  var result = new Url();
  var tkeys = Object.keys(this);
  for (var tk = 0; tk < tkeys.length; tk++) {
    var tkey = tkeys[tk];
    result[tkey] = this[tkey];
  }

  // hash is always overridden, no matter what.
  // even href="" will remove it.
  result.hash = relative.hash;

  // if the relative url is empty, then there's nothing left to do here.
  if (relative.href === '') {
    result.href = result.format();
    return result;
  }

  // hrefs like //foo/bar always cut to the protocol.
  if (relative.slashes && !relative.protocol) {
    // take everything except the protocol from relative
    var rkeys = Object.keys(relative);
    for (var rk = 0; rk < rkeys.length; rk++) {
      var rkey = rkeys[rk];
      if (rkey !== 'protocol')
        result[rkey] = relative[rkey];
    }

    //urlParse appends trailing / to urls like http://www.example.com
    if (slashedProtocol[result.protocol] &&
        result.hostname && !result.pathname) {
      result.path = result.pathname = '/';
    }

    result.href = result.format();
    return result;
  }

  if (relative.protocol && relative.protocol !== result.protocol) {
    // if it's a known url protocol, then changing
    // the protocol does weird things
    // first, if it's not file:, then we MUST have a host,
    // and if there was a path
    // to begin with, then we MUST have a path.
    // if it is file:, then the host is dropped,
    // because that's known to be hostless.
    // anything else is assumed to be absolute.
    if (!slashedProtocol[relative.protocol]) {
      var keys = Object.keys(relative);
      for (var v = 0; v < keys.length; v++) {
        var k = keys[v];
        result[k] = relative[k];
      }
      result.href = result.format();
      return result;
    }

    result.protocol = relative.protocol;
    if (!relative.host && !hostlessProtocol[relative.protocol]) {
      var relPath = (relative.pathname || '').split('/');
      while (relPath.length && !(relative.host = relPath.shift()));
      if (!relative.host) relative.host = '';
      if (!relative.hostname) relative.hostname = '';
      if (relPath[0] !== '') relPath.unshift('');
      if (relPath.length < 2) relPath.unshift('');
      result.pathname = relPath.join('/');
    } else {
      result.pathname = relative.pathname;
    }
    result.search = relative.search;
    result.query = relative.query;
    result.host = relative.host || '';
    result.auth = relative.auth;
    result.hostname = relative.hostname || relative.host;
    result.port = relative.port;
    // to support http.request
    if (result.pathname || result.search) {
      var p = result.pathname || '';
      var s = result.search || '';
      result.path = p + s;
    }
    result.slashes = result.slashes || relative.slashes;
    result.href = result.format();
    return result;
  }

  var isSourceAbs = (result.pathname && result.pathname.charAt(0) === '/'),
      isRelAbs = (
          relative.host ||
          relative.pathname && relative.pathname.charAt(0) === '/'
      ),
      mustEndAbs = (isRelAbs || isSourceAbs ||
                    (result.host && relative.pathname)),
      removeAllDots = mustEndAbs,
      srcPath = result.pathname && result.pathname.split('/') || [],
      relPath = relative.pathname && relative.pathname.split('/') || [],
      psychotic = result.protocol && !slashedProtocol[result.protocol];

  // if the url is a non-slashed url, then relative
  // links like ../.. should be able
  // to crawl up to the hostname, as well.  This is strange.
  // result.protocol has already been set by now.
  // Later on, put the first path part into the host field.
  if (psychotic) {
    result.hostname = '';
    result.port = null;
    if (result.host) {
      if (srcPath[0] === '') srcPath[0] = result.host;
      else srcPath.unshift(result.host);
    }
    result.host = '';
    if (relative.protocol) {
      relative.hostname = null;
      relative.port = null;
      if (relative.host) {
        if (relPath[0] === '') relPath[0] = relative.host;
        else relPath.unshift(relative.host);
      }
      relative.host = null;
    }
    mustEndAbs = mustEndAbs && (relPath[0] === '' || srcPath[0] === '');
  }

  if (isRelAbs) {
    // it's absolute.
    result.host = (relative.host || relative.host === '') ?
                  relative.host : result.host;
    result.hostname = (relative.hostname || relative.hostname === '') ?
                      relative.hostname : result.hostname;
    result.search = relative.search;
    result.query = relative.query;
    srcPath = relPath;
    // fall through to the dot-handling below.
  } else if (relPath.length) {
    // it's relative
    // throw away the existing file, and take the new path instead.
    if (!srcPath) srcPath = [];
    srcPath.pop();
    srcPath = srcPath.concat(relPath);
    result.search = relative.search;
    result.query = relative.query;
  } else if (!util.isNullOrUndefined(relative.search)) {
    // just pull out the search.
    // like href='?foo'.
    // Put this after the other two cases because it simplifies the booleans
    if (psychotic) {
      result.hostname = result.host = srcPath.shift();
      //occationaly the auth can get stuck only in host
      //this especially happens in cases like
      //url.resolveObject('mailto:local1@domain1', 'local2@domain2')
      var authInHost = result.host && result.host.indexOf('@') > 0 ?
                       result.host.split('@') : false;
      if (authInHost) {
        result.auth = authInHost.shift();
        result.host = result.hostname = authInHost.shift();
      }
    }
    result.search = relative.search;
    result.query = relative.query;
    //to support http.request
    if (!util.isNull(result.pathname) || !util.isNull(result.search)) {
      result.path = (result.pathname ? result.pathname : '') +
                    (result.search ? result.search : '');
    }
    result.href = result.format();
    return result;
  }

  if (!srcPath.length) {
    // no path at all.  easy.
    // we've already handled the other stuff above.
    result.pathname = null;
    //to support http.request
    if (result.search) {
      result.path = '/' + result.search;
    } else {
      result.path = null;
    }
    result.href = result.format();
    return result;
  }

  // if a url ENDs in . or .., then it must get a trailing slash.
  // however, if it ends in anything else non-slashy,
  // then it must NOT get a trailing slash.
  var last = srcPath.slice(-1)[0];
  var hasTrailingSlash = (
      (result.host || relative.host || srcPath.length > 1) &&
      (last === '.' || last === '..') || last === '');

  // strip single dots, resolve double dots to parent dir
  // if the path tries to go above the root, `up` ends up > 0
  var up = 0;
  for (var i = srcPath.length; i >= 0; i--) {
    last = srcPath[i];
    if (last === '.') {
      srcPath.splice(i, 1);
    } else if (last === '..') {
      srcPath.splice(i, 1);
      up++;
    } else if (up) {
      srcPath.splice(i, 1);
      up--;
    }
  }

  // if the path is allowed to go above the root, restore leading ..s
  if (!mustEndAbs && !removeAllDots) {
    for (; up--; up) {
      srcPath.unshift('..');
    }
  }

  if (mustEndAbs && srcPath[0] !== '' &&
      (!srcPath[0] || srcPath[0].charAt(0) !== '/')) {
    srcPath.unshift('');
  }

  if (hasTrailingSlash && (srcPath.join('/').substr(-1) !== '/')) {
    srcPath.push('');
  }

  var isAbsolute = srcPath[0] === '' ||
      (srcPath[0] && srcPath[0].charAt(0) === '/');

  // put the host back
  if (psychotic) {
    result.hostname = result.host = isAbsolute ? '' :
                                    srcPath.length ? srcPath.shift() : '';
    //occationaly the auth can get stuck only in host
    //this especially happens in cases like
    //url.resolveObject('mailto:local1@domain1', 'local2@domain2')
    var authInHost = result.host && result.host.indexOf('@') > 0 ?
                     result.host.split('@') : false;
    if (authInHost) {
      result.auth = authInHost.shift();
      result.host = result.hostname = authInHost.shift();
    }
  }

  mustEndAbs = mustEndAbs || (result.host && srcPath.length);

  if (mustEndAbs && !isAbsolute) {
    srcPath.unshift('');
  }

  if (!srcPath.length) {
    result.pathname = null;
    result.path = null;
  } else {
    result.pathname = srcPath.join('/');
  }

  //to support request.http
  if (!util.isNull(result.pathname) || !util.isNull(result.search)) {
    result.path = (result.pathname ? result.pathname : '') +
                  (result.search ? result.search : '');
  }
  result.auth = relative.auth || result.auth;
  result.slashes = result.slashes || relative.slashes;
  result.href = result.format();
  return result;
};

Url.prototype.parseHost = function() {
  var host = this.host;
  var port = portPattern.exec(host);
  if (port) {
    port = port[0];
    if (port !== ':') {
      this.port = port.substr(1);
    }
    host = host.substr(0, host.length - port.length);
  }
  if (host) this.hostname = host;
};


/***/ }),

/***/ "./node_modules/url/util.js":
/*!**********************************!*\
  !*** ./node_modules/url/util.js ***!
  \**********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = {
  isString: function(arg) {
    return typeof(arg) === 'string';
  },
  isObject: function(arg) {
    return typeof(arg) === 'object' && arg !== null;
  },
  isNull: function(arg) {
    return arg === null;
  },
  isNullOrUndefined: function(arg) {
    return arg == null;
  }
};


/***/ }),

/***/ "./node_modules/webpack/buildin/global.js":
/*!***********************************!*\
  !*** (webpack)/buildin/global.js ***!
  \***********************************/
/*! no static exports found */
/***/ (function(module, exports) {

var g;

// This works in non-strict mode
g = (function() {
	return this;
})();

try {
	// This works if eval is allowed (see CSP)
	g = g || new Function("return this")();
} catch (e) {
	// This works if the window reference is available
	if (typeof window === "object") g = window;
}

// g can still be undefined, but nothing to do about it...
// We return undefined, instead of nothing here, so it's
// easier to handle this case. if(!global) { ...}

module.exports = g;


/***/ }),

/***/ "./node_modules/webpack/buildin/module.js":
/*!***********************************!*\
  !*** (webpack)/buildin/module.js ***!
  \***********************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = function(module) {
	if (!module.webpackPolyfill) {
		module.deprecate = function() {};
		module.paths = [];
		// module.parent = undefined by default
		if (!module.children) module.children = [];
		Object.defineProperty(module, "loaded", {
			enumerable: true,
			get: function() {
				return module.l;
			}
		});
		Object.defineProperty(module, "id", {
			enumerable: true,
			get: function() {
				return module.i;
			}
		});
		module.webpackPolyfill = 1;
	}
	return module;
};


/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/acl.js":
/*!**********************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/acl.js ***!
  \**********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _createClass2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/createClass */ "./node_modules/@babel/runtime/helpers/createClass.js"));

var _isPlainObject = _interopRequireDefault(__webpack_require__(/*! lodash/isPlainObject */ "./node_modules/lodash/isPlainObject.js"));

var _kinvey = _interopRequireDefault(__webpack_require__(/*! ./errors/kinvey */ "./packages/kinvey-html5-sdk/src/errors/kinvey.js"));

/**
 * This class provides a way to access the ACL (Access Control List)
 * information for an entity and to modify the access control permissions.
 */
var Acl =
/*#__PURE__*/
function () {
  function Acl(entity) {
    (0, _classCallCheck2.default)(this, Acl);

    if (!(0, _isPlainObject.default)(entity)) {
      throw new _kinvey.default('entity must be an object.');
    }

    entity._acl = entity._acl || {}; // eslint-disable-line no-param-reassign

    this.entity = entity;
  }
  /**
   * Get the creator.
   *
   * @returns {string} Creator
   */


  (0, _createClass2.default)(Acl, [{
    key: "addReader",

    /**
     * Add a reader.
     *
     * @param {string} reader Reader
     * @returns {Acl} Acl
     */
    value: function addReader(reader) {
      var r = this.readers;

      if (r.indexOf(reader) === -1) {
        r.push(reader);
      }

      this.entity._acl.r = r;
      return this;
    }
    /**
     * Add a reader group.
     *
     * @param {string} group Reader group
     * @returns {Acl} Acl
     */

  }, {
    key: "addReaderGroup",
    value: function addReaderGroup(group) {
      var groups = this.readerGroups;

      if (groups.indexOf(group) === -1) {
        groups.push(group);
      }

      this.entity._acl.groups = Object.assign({}, this.entity._acl.groups, {
        r: groups
      });
      return this;
    }
    /**
     * Add a writer.
     *
     * @param {string} writer Writer
     * @returns {Acl} Acl
     */

  }, {
    key: "addWriter",
    value: function addWriter(writer) {
      var w = this.writers;

      if (w.indexOf(writer) === -1) {
        w.push(writer);
      }

      this.entity._acl.w = w;
      return this;
    }
    /**
     * Add a writer group.
     *
     * @param {string} group Writer group
     * @returns {Acl} Acl
     */

  }, {
    key: "addWriterGroup",
    value: function addWriterGroup(group) {
      var groups = this.writerGroups;

      if (groups.indexOf(group) === -1) {
        groups.push(group);
      }

      this.entity._acl.groups = Object.assign({}, this.entity._acl.groups, {
        w: groups
      });
      return this;
    }
    /**
     * Check if globally readable is allowed.
     *
     * @returns {boolean} True if globally readable is allowed otherwise false
     */

  }, {
    key: "isGloballyReadable",
    value: function isGloballyReadable() {
      return this.entity._acl.gr === true;
    }
    /**
     * Check if globally writable is allowed.
     *
     * @returns {boolean} True if globally writable is allowed otherwise false
     */

  }, {
    key: "isGloballyWritable",
    value: function isGloballyWritable() {
      return this.entity._acl.gw === true;
    }
    /**
     * Remove a reader.
     *
     * @param {string} reader Reader
     * @returns {Acl} Acl
     */

  }, {
    key: "removeReader",
    value: function removeReader(reader) {
      var r = this.readers;
      var index = r.indexOf(reader);

      if (index !== -1) {
        r.splice(index, 1);
      }

      this.entity._acl.r = r;
      return this;
    }
    /**
     * Remove a reader group.
     *
     * @param {string} group Reader group
     * @returns {Acl} Acl
     */

  }, {
    key: "removeReaderGroup",
    value: function removeReaderGroup(group) {
      var groups = this.readerGroups;
      var index = groups.indexOf(group);

      if (index !== -1) {
        groups.splice(index, 1);
      }

      this.entity._acl.groups = Object.assign({}, this.entity._acl.groups, {
        r: groups
      });
      return this;
    }
    /**
     * Remove a writer.
     *
     * @param {string} writer Writer
     * @returns {Acl} Acl
     */

  }, {
    key: "removeWriter",
    value: function removeWriter(writer) {
      var w = this.writers;
      var index = w.indexOf(writer);

      if (index !== -1) {
        w.splice(index, 1);
      }

      this.entity._acl.w = w;
      return this;
    }
    /**
     * Remove a writer group.
     *
     * @param {string} group Writer group
     * @returns {Acl} Acl
     */

  }, {
    key: "removeWriterGroup",
    value: function removeWriterGroup(group) {
      var groups = this.writerGroups;
      var index = groups.indexOf(group);

      if (index !== -1) {
        groups.splice(index, 1);
      }

      this.entity._acl.groups = Object.assign({}, this.entity._acl.groups, {
        w: groups
      });
      return this;
    }
    /**
     * The acl as a plain object.
     *
     * @returns {Object} Acl as a plain object.
     */

  }, {
    key: "toPlainObject",
    value: function toPlainObject() {
      return this.entity._acl;
    }
  }, {
    key: "creator",
    get: function get() {
      return this.entity._acl.creator;
    }
    /**
     * Get the readers.
     *
     * @returns {string[]} Readers
     */

  }, {
    key: "readers",
    get: function get() {
      return Array.isArray(this.entity._acl.r) ? this.entity._acl.r : [];
    }
    /**
     * Get the writers.
     *
     * @returns {string[]} Writers
     */

  }, {
    key: "writers",
    get: function get() {
      return Array.isArray(this.entity._acl.w) ? this.entity._acl.w : [];
    }
    /**
     * Get the reader groups.
     *
     * @returns {string[]} Reader groups
     */

  }, {
    key: "readerGroups",
    get: function get() {
      return this.entity._acl.groups && Array.isArray(this.entity._acl.groups.r) ? this.entity._acl.groups.r : [];
    }
    /**
     * Get the writer groups.
     *
     * @returns {string[]} Writer groups
     */

  }, {
    key: "writerGroups",
    get: function get() {
      return this.entity._acl.groups && Array.isArray(this.entity._acl.groups.w) ? this.entity._acl.groups.w : [];
    }
    /**
     * Set the globally readable permission.
     *
     * @param {boolean} gr Globally readable
     */

  }, {
    key: "globallyReadable",
    set: function set(gr) {
      this.entity._acl.gr = gr === true;
    }
    /**
     * Set the globally writable permission.
     *
     * @param {boolean} gw Globally writable
     */

  }, {
    key: "globallyWritable",
    set: function set(gw) {
      this.entity._acl.gw = gw === true;
    }
  }]);
  return Acl;
}();

exports.default = Acl;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/aggregation/aggregation.js":
/*!******************************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/aggregation/aggregation.js ***!
  \******************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _createClass2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/createClass */ "./node_modules/@babel/runtime/helpers/createClass.js"));

var _query = _interopRequireDefault(__webpack_require__(/*! ../query */ "./packages/kinvey-html5-sdk/src/query.js"));

var Aggregation =
/*#__PURE__*/
function () {
  function Aggregation(aggregation) {
    (0, _classCallCheck2.default)(this, Aggregation);
    var config = Object.assign({}, {
      query: null,
      initial: {},
      key: {},
      reduceFn: function reduceFn() {
        return null;
      }
    }, aggregation);
    this.query = config.query;
    this.initial = config.initial;
    this.key = config.key;
    this.reduceFn = config.reduceFn;
  }

  (0, _createClass2.default)(Aggregation, [{
    key: "by",

    /**
     * Adds the filed to the array of fields.
     *
     * @param {string} field
     * @returns {Aggregation} Aggregation
     */
    value: function by(field) {
      this.key[field] = true;
      return this;
    }
  }, {
    key: "process",
    value: function process() {
      var _this = this;

      var docs = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];

      if (docs.length > 0) {
        var fields = Object.keys(this.key);
        var filteredDocs = docs;

        if (this.query) {
          filteredDocs = this.query.process(docs);
        }

        if (fields.length > 0) {
          return fields.reduce(function (results, field) {
            results[field] = filteredDocs.reduce(function (result, doc) {
              return _this.reduceFn(result, doc, field) || result;
            }, Object.assign({}, _this.initial));
            return results;
          }, {});
        }

        return filteredDocs.reduce(function (result, doc) {
          return _this.reduceFn(doc, result) || result;
        }, Object.assign({}, this.initial));
      }

      return Object.assign({}, this.initial);
    }
  }, {
    key: "toPlainObject",
    value: function toPlainObject() {
      return {
        key: this.key,
        initial: this.initial,
        reduce: this.reduceFn,
        reduceFn: this.reduceFn,
        condition: this.query ? this.query.toPlainObject().filter : {},
        query: this.query ? this.query.toPlainObject() : null
      };
    }
  }, {
    key: "query",
    get: function get() {
      return this._query;
    },
    set: function set(query) {
      if (query && !(query instanceof _query.default)) {
        throw new Error('Query must be an instance of Query class.');
      }

      this._query = query;
    }
  }]);
  return Aggregation;
}();

exports.default = Aggregation;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/aggregation/average.js":
/*!**************************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/aggregation/average.js ***!
  \**************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = average;

var _aggregation = _interopRequireDefault(__webpack_require__(/*! ./aggregation */ "./packages/kinvey-html5-sdk/src/aggregation/aggregation.js"));

/**
 * Creates an aggregation that will return the average value for a field on an array of data.
 *
 * @param {string} field Field
 * @returns {Aggregation} Aggregation
 */
function average() {
  var field = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';
  var aggregation = new _aggregation.default({
    initial: {
      count: 0,
      average: 0
    },
    reduceFn: function reduceFn(result, doc, key) {
      // eslint-disable-next-line no-param-reassign
      result.average = (result.average * result.count + doc[key]) / (result.count + 1); // eslint-disable-next-line no-param-reassign

      result.count += 1;
      return result;
    }
  });
  aggregation.by(field);
  return aggregation;
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/aggregation/count.js":
/*!************************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/aggregation/count.js ***!
  \************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = count;

var _aggregation = _interopRequireDefault(__webpack_require__(/*! ./aggregation */ "./packages/kinvey-html5-sdk/src/aggregation/aggregation.js"));

/**
 * Creates an aggregation that will return the count for a field on an array of data.
 *
 * @param {string} field Field
 * @returns {Aggregation} Aggregation
 */
function count() {
  var field = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';
  var aggregation = new _aggregation.default({
    reduceFn: function reduceFn(result, doc, key) {
      var val = doc[key];

      if (val) {
        // eslint-disable-next-line no-param-reassign
        result[val] = typeof result[val] === 'undefined' ? 1 : result[val] + 1;
      }

      return result;
    }
  });
  aggregation.by(field);
  return aggregation;
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/aggregation/index.js":
/*!************************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/aggregation/index.js ***!
  \************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _aggregation = _interopRequireDefault(__webpack_require__(/*! ./aggregation */ "./packages/kinvey-html5-sdk/src/aggregation/aggregation.js"));

var _average = _interopRequireDefault(__webpack_require__(/*! ./average */ "./packages/kinvey-html5-sdk/src/aggregation/average.js"));

var _count = _interopRequireDefault(__webpack_require__(/*! ./count */ "./packages/kinvey-html5-sdk/src/aggregation/count.js"));

var _max = _interopRequireDefault(__webpack_require__(/*! ./max */ "./packages/kinvey-html5-sdk/src/aggregation/max.js"));

var _min = _interopRequireDefault(__webpack_require__(/*! ./min */ "./packages/kinvey-html5-sdk/src/aggregation/min.js"));

var _sum = _interopRequireDefault(__webpack_require__(/*! ./sum */ "./packages/kinvey-html5-sdk/src/aggregation/sum.js"));

_aggregation.default.average = _average.default;
_aggregation.default.count = _count.default;
_aggregation.default.max = _max.default;
_aggregation.default.min = _min.default;
_aggregation.default.sum = _sum.default;
var _default = _aggregation.default;
exports.default = _default;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/aggregation/max.js":
/*!**********************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/aggregation/max.js ***!
  \**********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = max;

var _aggregation = _interopRequireDefault(__webpack_require__(/*! ./aggregation */ "./packages/kinvey-html5-sdk/src/aggregation/aggregation.js"));

/**
 * Creates an aggregation that will return the max value for a field on an array of data.
 *
 * @param {string} field Field
 * @returns {Aggregation} Aggregation
 */
function max() {
  var field = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';
  var aggregation = new _aggregation.default({
    initial: {
      max: -Infinity
    },
    reduceFn: function reduceFn(result, doc, key) {
      // eslint-disable-next-line no-param-reassign
      result.max = Math.max(result.max, doc[key]);
      return result;
    }
  });
  aggregation.by(field);
  return aggregation;
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/aggregation/min.js":
/*!**********************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/aggregation/min.js ***!
  \**********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = min;

var _aggregation = _interopRequireDefault(__webpack_require__(/*! ./aggregation */ "./packages/kinvey-html5-sdk/src/aggregation/aggregation.js"));

/**
 * Creates an aggregation that will return the min value for a field on an array of data.
 *
 * @param {string} field Field
 * @returns {Aggregation} Aggregation
 */
function min() {
  var field = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';
  var aggregation = new _aggregation.default({
    initial: {
      min: Infinity
    },
    reduceFn: function reduceFn(result, doc, key) {
      // eslint-disable-next-line no-param-reassign
      result.min = Math.min(result.min, doc[key]);
      return result;
    }
  });
  aggregation.by(field);
  return aggregation;
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/aggregation/sum.js":
/*!**********************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/aggregation/sum.js ***!
  \**********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = sum;

var _aggregation = _interopRequireDefault(__webpack_require__(/*! ./aggregation */ "./packages/kinvey-html5-sdk/src/aggregation/aggregation.js"));

/**
 * Creates an aggregation that will return the sum for a field on an array of data.
 *
 * @param {string} field Field
 * @returns {Aggregation} Aggregation
 */
function sum() {
  var field = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';
  var aggregation = new _aggregation.default({
    initial: {
      sum: 0
    },
    reduceFn: function reduceFn(result, doc, key) {
      // eslint-disable-next-line no-param-reassign
      result.sum += doc[key];
      return result;
    }
  });
  aggregation.by(field);
  return aggregation;
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/cache/index.js":
/*!******************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/cache/index.js ***!
  \******************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.clear = clear;
exports.Cache = void 0;

var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js"));

var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _createClass2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/createClass */ "./node_modules/@babel/runtime/helpers/createClass.js"));

var _pQueue = _interopRequireDefault(__webpack_require__(/*! p-queue */ "./node_modules/p-queue/index.js"));

var _query = _interopRequireDefault(__webpack_require__(/*! ../query */ "./packages/kinvey-html5-sdk/src/query.js"));

var _aggregation = _interopRequireDefault(__webpack_require__(/*! ../aggregation */ "./packages/kinvey-html5-sdk/src/aggregation/index.js"));

var _kinvey = _interopRequireDefault(__webpack_require__(/*! ../errors/kinvey */ "./packages/kinvey-html5-sdk/src/errors/kinvey.js"));

var _utils = __webpack_require__(/*! ./utils */ "./packages/kinvey-html5-sdk/src/cache/utils.js");

var _store = __webpack_require__(/*! ./store */ "./packages/kinvey-html5-sdk/src/cache/store.js");

var queue = new _pQueue.default({
  concurrency: 1
});

var Cache =
/*#__PURE__*/
function () {
  function Cache(storeName, collectionName) {
    (0, _classCallCheck2.default)(this, Cache);
    this.storeName = storeName;
    this.collectionName = collectionName;
    this.store = (0, _store.get)();
  }

  (0, _createClass2.default)(Cache, [{
    key: "find",
    value: function find(query) {
      var _this = this;

      return queue.add(
      /*#__PURE__*/
      (0, _asyncToGenerator2.default)(
      /*#__PURE__*/
      _regenerator.default.mark(function _callee() {
        var docs;
        return _regenerator.default.wrap(function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                _context.next = 2;
                return _this.store.find(_this.storeName, _this.collectionName);

              case 2:
                docs = _context.sent;

                if (!(query && !(query instanceof _query.default))) {
                  _context.next = 5;
                  break;
                }

                throw new _kinvey.default('Invalid query. It must be an instance of the Query class.');

              case 5:
                if (!(docs.length > 0 && query)) {
                  _context.next = 7;
                  break;
                }

                return _context.abrupt("return", query.process(docs));

              case 7:
                return _context.abrupt("return", docs);

              case 8:
              case "end":
                return _context.stop();
            }
          }
        }, _callee, this);
      })));
    }
  }, {
    key: "group",
    value: function () {
      var _group = (0, _asyncToGenerator2.default)(
      /*#__PURE__*/
      _regenerator.default.mark(function _callee2(aggregation) {
        var docs;
        return _regenerator.default.wrap(function _callee2$(_context2) {
          while (1) {
            switch (_context2.prev = _context2.next) {
              case 0:
                if (aggregation instanceof _aggregation.default) {
                  _context2.next = 2;
                  break;
                }

                throw new _kinvey.default('Invalid aggregation. It must be an instance of the Aggregation class.');

              case 2:
                _context2.next = 4;
                return this.find();

              case 4:
                docs = _context2.sent;
                return _context2.abrupt("return", aggregation.process(docs));

              case 6:
              case "end":
                return _context2.stop();
            }
          }
        }, _callee2, this);
      }));

      function group(_x) {
        return _group.apply(this, arguments);
      }

      return group;
    }()
  }, {
    key: "reduce",
    value: function reduce(aggregation) {
      return this.group(aggregation);
    }
  }, {
    key: "count",
    value: function () {
      var _count = (0, _asyncToGenerator2.default)(
      /*#__PURE__*/
      _regenerator.default.mark(function _callee3(query) {
        var _this2 = this;

        var docs;
        return _regenerator.default.wrap(function _callee3$(_context3) {
          while (1) {
            switch (_context3.prev = _context3.next) {
              case 0:
                if (!query) {
                  _context3.next = 5;
                  break;
                }

                _context3.next = 3;
                return this.find(query);

              case 3:
                docs = _context3.sent;
                return _context3.abrupt("return", docs.length);

              case 5:
                return _context3.abrupt("return", queue.add(function () {
                  return _this2.store.count(_this2.storeName, _this2.collectionName);
                }));

              case 6:
              case "end":
                return _context3.stop();
            }
          }
        }, _callee3, this);
      }));

      function count(_x2) {
        return _count.apply(this, arguments);
      }

      return count;
    }()
  }, {
    key: "findById",
    value: function findById(id) {
      var _this3 = this;

      return queue.add(function () {
        return _this3.store.findById(_this3.storeName, _this3.collectionName, id);
      });
    }
  }, {
    key: "save",
    value: function save(docs) {
      var _this4 = this;

      return queue.add(
      /*#__PURE__*/
      (0, _asyncToGenerator2.default)(
      /*#__PURE__*/
      _regenerator.default.mark(function _callee4() {
        var docsToSave, singular;
        return _regenerator.default.wrap(function _callee4$(_context4) {
          while (1) {
            switch (_context4.prev = _context4.next) {
              case 0:
                docsToSave = docs;
                singular = false;

                if (docs) {
                  _context4.next = 4;
                  break;
                }

                return _context4.abrupt("return", null);

              case 4:
                if (!Array.isArray(docs)) {
                  singular = true;
                  docsToSave = [docs];
                } // Clone the docs


                docsToSave = docsToSave.slice(0, docsToSave.length); // Save the docs

                if (!(docsToSave.length > 0)) {
                  _context4.next = 11;
                  break;
                }

                docsToSave = docsToSave.map(function (doc) {
                  if (!doc._id) {
                    return Object.assign({}, {
                      _id: (0, _utils.generateId)(),
                      _kmd: Object.assign({}, doc._kmd, {
                        local: true
                      })
                    }, doc);
                  }

                  return doc;
                });
                _context4.next = 10;
                return _this4.store.save(_this4.storeName, _this4.collectionName, docsToSave);

              case 10:
                return _context4.abrupt("return", singular ? docsToSave.shift() : docsToSave);

              case 11:
                return _context4.abrupt("return", docs);

              case 12:
              case "end":
                return _context4.stop();
            }
          }
        }, _callee4, this);
      })));
    }
  }, {
    key: "remove",
    value: function () {
      var _remove = (0, _asyncToGenerator2.default)(
      /*#__PURE__*/
      _regenerator.default.mark(function _callee5(query) {
        var _this5 = this;

        var docs, results;
        return _regenerator.default.wrap(function _callee5$(_context5) {
          while (1) {
            switch (_context5.prev = _context5.next) {
              case 0:
                _context5.next = 2;
                return this.find(query);

              case 2:
                docs = _context5.sent;

                if (!query) {
                  _context5.next = 8;
                  break;
                }

                _context5.next = 6;
                return Promise.all(docs.map(function (doc) {
                  return _this5.removeById(doc._id);
                }));

              case 6:
                results = _context5.sent;
                return _context5.abrupt("return", results.reduce(function (totalCount, count) {
                  return totalCount + count;
                }, 0));

              case 8:
                _context5.next = 10;
                return this.clear();

              case 10:
                return _context5.abrupt("return", docs.length);

              case 11:
              case "end":
                return _context5.stop();
            }
          }
        }, _callee5, this);
      }));

      function remove(_x3) {
        return _remove.apply(this, arguments);
      }

      return remove;
    }()
  }, {
    key: "removeById",
    value: function removeById(id) {
      var _this6 = this;

      return queue.add(function () {
        return _this6.store.removeById(_this6.storeName, _this6.collectionName, id);
      });
    }
  }, {
    key: "clear",
    value: function clear() {
      var _this7 = this;

      return queue.add(function () {
        return _this7.store.clear(_this7.storeName, _this7.collectionName);
      });
    }
  }]);
  return Cache;
}();

exports.Cache = Cache;

function clear(storeName) {
  var store = (0, _store.get)();
  return queue.add(function () {
    return store.clearAll(storeName);
  });
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/cache/indexeddb.js":
/*!**********************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/cache/indexeddb.js ***!
  \**********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.find = find;
exports.count = count;
exports.findById = findById;
exports.save = save;
exports.removeById = removeById;
exports.clear = clear;
exports.clearAll = clearAll;

var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js"));

var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _createClass2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/createClass */ "./node_modules/@babel/runtime/helpers/createClass.js"));

var DB_CACHE = {};
var IndexedDBTransactionMode = {
  readWrite: 'readwrite',
  readOnly: 'readonly'
};

var IndexedDB =
/*#__PURE__*/
function () {
  function IndexedDB(dbName) {
    (0, _classCallCheck2.default)(this, IndexedDB);
    this.dbName = dbName;
    this.db = DB_CACHE[this.dbName];
    this.inTransaction = false;
    this.queue = [];
  }

  (0, _createClass2.default)(IndexedDB, [{
    key: "hasObjectStore",
    value: function hasObjectStore(objectStoreName) {
      if (this.db && this.db.objectStoreName) {
        return typeof this.db.objectStoreNames.contains === 'function' ? this.db.objectStoreNames.contains(objectStoreName) : this.db.objectStoreNames.indexOf(objectStoreName) !== -1;
      }

      return false;
    }
  }, {
    key: "openTransaction",
    value: function openTransaction(objectStoreName) {
      var mode = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : IndexedDBTransactionMode.readOnly;
      var txn = this.db.transaction(objectStoreName, mode);

      if (!txn) {
        throw new Error("Unable to open a transaction for ".concat(objectStoreName, " collection on the ").concat(this.dbName, " IndexedDB database."));
      }

      return txn;
    }
  }, {
    key: "openDB",
    value: function openDB() {
      var indexedDB = window.indexedDB || window.webkitIndexedDB || window.mozIndexedDB || window.msIndexedDB;

      if (this.db) {
        var version = this.db.version + 1;
        this.close();
        return indexedDB.open(this.dbName, version);
      }

      return indexedDB.open(this.dbName);
    }
  }, {
    key: "open",
    value: function open(objectStoreName) {
      var _this = this;

      var write = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
      var success = arguments.length > 2 ? arguments[2] : undefined;
      var error = arguments.length > 3 ? arguments[3] : undefined;
      var force = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;

      try {
        if (this.db) {
          if (this.db.objectStoreNames.contains(objectStoreName)) {
            var mode = write ? IndexedDBTransactionMode.readWrite : IndexedDBTransactionMode.readOnly;
            return success(this.openTransaction(objectStoreName, mode));
          } else if (!write) {
            throw new Error("The ".concat(objectStoreName, " collection was not found on the ").concat(this.dbName, " IndexedDB database."));
          }
        }

        if (!force && this.inTransaction) {
          return this.queue.push(function () {
            return _this.open(objectStoreName, write, success, error);
          });
        }

        this.inTransaction = true;
        var request = this.openDB(objectStoreName); // If the database is opened with an higher version than its current, the
        // `upgradeneeded` event is fired. Save the handle to the database, and
        // create the collection.

        request.onupgradeneeded = function (e) {
          _this.db = e.target.result;

          if (write && !_this.db.objectStoreNames.contains(objectStoreName)) {
            _this.db.createObjectStore(objectStoreName, {
              keyPath: '_id'
            });
          }
        }; // The `success` event is fired after `upgradeneeded` terminates.
        // Save the handle to the database.


        request.onsuccess = function (e) {
          _this.db = e.target.result; // If a second instance of the same IndexedDB database performs an
          // upgrade operation, the `versionchange` event is fired. Then, close the
          // database to allow the external upgrade to proceed.

          _this.db.onversionchange = function () {
            return _this.close();
          }; // Try to obtain the collection handle by recursing. Append the handlers
          // to empty the queue upon success and failure. Set the `force` flag so
          // all but the current transaction remain queued.


          var wrap = function wrap(done) {
            var callbackFn = function callbackFn(arg) {
              done(arg); // Switch flag

              _this.inTransaction = false; // The database handle has been established, we can now safely empty
              // the queue. The queue must be emptied before invoking the concurrent
              // operations to avoid infinite recursion.

              if (_this.queue.length > 0) {
                var pending = _this.queue;
                _this.queue = [];
                pending.forEach(function (fn) {
                  fn.call(_this);
                });
              }
            };

            return callbackFn;
          };

          return _this.open(objectStoreName, write, wrap(success), wrap(error), true);
        }; // The `blocked` event is not handled. In case such an event occurs, it
        // will resolve itself since the `versionchange` event handler will close
        // the conflicting database and enable the `blocked` event to continue.


        request.onblocked = function () {}; // Handle errors


        request.onerror = function (e) {
          error(new Error("Unable to open the ".concat(_this.dbName, " IndexedDB database. ").concat(e.target.error.message, ".")));
        };
      } catch (e) {
        error(e);
      }

      return null;
    }
  }, {
    key: "close",
    value: function close() {
      if (this.db) {
        this.db.close();
        this.db = null;
      }
    }
  }, {
    key: "db",
    get: function get() {
      return this._db;
    },
    set: function set(db) {
      if (db) {
        this._db = db;
        DB_CACHE[this.dbName] = db;
      } else {
        this._db = null;
        delete DB_CACHE[this.dbName];
      }
    }
  }]);
  return IndexedDB;
}();

function find(dbName, objectStoreName) {
  var db = new IndexedDB(dbName);
  return new Promise(function (resolve, reject) {
    db.open(objectStoreName, false, function (txn) {
      var store = txn.objectStore(objectStoreName);
      var request = store.openCursor();
      var docs = [];

      request.onsuccess = function (e) {
        var cursor = e.target.result;

        if (cursor) {
          docs.push(cursor.value);
          return cursor.continue();
        }

        return resolve(docs);
      };

      request.onerror = function (e) {
        reject(e.target.error);
      };
    }, function (error) {
      if (error.message.indexOf('not found') !== -1) {
        resolve([]);
      } else {
        reject(error);
      }
    });
  });
}

function count(_x, _x2) {
  return _count.apply(this, arguments);
}

function _count() {
  _count = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee(dbName, objectStoreName) {
    var db;
    return _regenerator.default.wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            db = new IndexedDB(dbName);
            return _context.abrupt("return", new Promise(function (resolve, reject) {
              db.open(objectStoreName, false, function (txn) {
                var store = txn.objectStore(objectStoreName);
                var request = store.count();

                request.onsuccess = function () {
                  return resolve(request.result);
                };

                request.onerror = function (e) {
                  return reject(e.target.error);
                };
              }, function (error) {
                if (error.message.indexOf('not found') !== -1) {
                  resolve(0);
                } else {
                  reject(error);
                }
              });
            }));

          case 2:
          case "end":
            return _context.stop();
        }
      }
    }, _callee, this);
  }));
  return _count.apply(this, arguments);
}

function findById(dbName, objectStoreName, id) {
  var db = new IndexedDB(dbName);
  return new Promise(function (resolve, reject) {
    db.open(objectStoreName, false, function (txn) {
      var store = txn.objectStore(objectStoreName);
      var request = store.get(id);

      request.onsuccess = function (e) {
        resolve(e.target.result);
      };

      request.onerror = function (e) {
        reject(e.target.error);
      };
    }, reject);
  });
}

function save(_x3, _x4) {
  return _save.apply(this, arguments);
}

function _save() {
  _save = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee2(dbName, objectStoreName) {
    var _this2 = this;

    var docs,
        db,
        _args2 = arguments;
    return _regenerator.default.wrap(function _callee2$(_context2) {
      while (1) {
        switch (_context2.prev = _context2.next) {
          case 0:
            docs = _args2.length > 2 && _args2[2] !== undefined ? _args2[2] : [];
            db = new IndexedDB(dbName);
            return _context2.abrupt("return", new Promise(function (resolve, reject) {
              db.open(objectStoreName, true, function (txn) {
                var store = txn.objectStore(objectStoreName);
                var docsToSave = docs;

                if (!Array.isArray(docs)) {
                  docsToSave = [docs];
                }

                docsToSave.forEach(function (doc) {
                  store.put(doc);
                });

                txn.oncomplete = function () {
                  resolve(docs);
                };

                txn.onerror = function (e) {
                  reject(new Error("An error occurred while saving the entities to the ".concat(objectStoreName, " collection on the ").concat(_this2.dbName, " IndexedDB database. ").concat(e.target.error.message, ".")));
                };
              }, reject);
            }));

          case 3:
          case "end":
            return _context2.stop();
        }
      }
    }, _callee2, this);
  }));
  return _save.apply(this, arguments);
}

function removeById(_x5, _x6, _x7) {
  return _removeById.apply(this, arguments);
}

function _removeById() {
  _removeById = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee3(dbName, objectStoreName, id) {
    var _this3 = this;

    var db;
    return _regenerator.default.wrap(function _callee3$(_context3) {
      while (1) {
        switch (_context3.prev = _context3.next) {
          case 0:
            db = new IndexedDB(dbName);
            return _context3.abrupt("return", new Promise(function (resolve, reject) {
              db.open(objectStoreName, true, function (txn) {
                var store = txn.objectStore(objectStoreName);
                var request = store.get(id);
                store.delete(id);

                txn.oncomplete = function () {
                  var doc = request.result;

                  if (doc) {
                    resolve(1);
                  } else {
                    reject(new Error("An entity with _id = ".concat(id, " was not found in the ").concat(objectStoreName, " collection on the ").concat(_this3.dbName, " database.")));
                  }
                };

                txn.onerror = function () {
                  reject(new Error("An entity with _id = ".concat(id, " was not found in the ").concat(objectStoreName, " collection on the ").concat(_this3.dbName, " database.")));
                };
              }, reject);
            }));

          case 2:
          case "end":
            return _context3.stop();
        }
      }
    }, _callee3, this);
  }));
  return _removeById.apply(this, arguments);
}

function clear(_x8, _x9) {
  return _clear.apply(this, arguments);
}

function _clear() {
  _clear = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee4(dbName, objectStoreName) {
    var db;
    return _regenerator.default.wrap(function _callee4$(_context4) {
      while (1) {
        switch (_context4.prev = _context4.next) {
          case 0:
            db = new IndexedDB(dbName);
            return _context4.abrupt("return", new Promise(function (resolve, reject) {
              db.open(objectStoreName, true, function (txn) {
                var objectStore = txn.objectStore(objectStoreName);
                objectStore.clear();

                txn.oncomplete = function () {
                  return resolve(true);
                };

                txn.onerror = function (err) {
                  return reject(err);
                };
              }, reject);
            }));

          case 2:
          case "end":
            return _context4.stop();
        }
      }
    }, _callee4, this);
  }));
  return _clear.apply(this, arguments);
}

function clearAll(dbName) {
  return new Promise(function (resolve, reject) {
    var indexedDB = window.indexedDB || window.webkitIndexedDB || window.mozIndexedDB || window.msIndexedDB;
    var request = indexedDB.deleteDatabase(dbName);

    request.onsuccess = function () {
      delete DB_CACHE[dbName];
      resolve(true);
    };

    request.onerror = function (e) {
      reject(new Error("An error occurred while clearing the ".concat(dbName, " IndexedDB database. ").concat(e.target.error.message, ".")));
    };

    request.onblocked = function () {
      reject(new Error("The ".concat(dbName, " IndexedDB database could not be cleared due to the operation being blocked.")));
    };
  });
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/cache/memory.js":
/*!*******************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/cache/memory.js ***!
  \*******************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.find = find;
exports.count = count;
exports.findById = findById;
exports.save = save;
exports.removeById = removeById;
exports.clear = clear;
exports.clearAll = clearAll;

var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js"));

var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));

var _lokijs = _interopRequireDefault(__webpack_require__(/*! lokijs */ "./node_modules/lokijs/src/lokijs.js"));

var memAdapter = new _lokijs.default.LokiMemoryAdapter();

function open(dbName, collectionName) {
  return new Promise(function (resolve, reject) {
    var db = new _lokijs.default(dbName, {
      adapter: memAdapter,
      autosave: false,
      autoload: true,
      autoloadCallback: function autoloadCallback(error) {
        if (error) {
          reject(error);
        } else {
          if (collectionName) {
            var collection = db.getCollection(collectionName);

            if (!collection) {
              collection = db.addCollection(collectionName, {
                clone: true,
                unique: ['_id'],
                disableMeta: true
              });
            }
          }

          resolve(db);
        }
      }
    });
  });
}

function find(_x, _x2) {
  return _find.apply(this, arguments);
}

function _find() {
  _find = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee(dbName, collectionName) {
    var db, collection;
    return _regenerator.default.wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            _context.next = 2;
            return open(dbName, collectionName);

          case 2:
            db = _context.sent;
            collection = db.getCollection(collectionName);
            return _context.abrupt("return", collection.chain().data({
              removeMeta: true
            }));

          case 5:
          case "end":
            return _context.stop();
        }
      }
    }, _callee, this);
  }));
  return _find.apply(this, arguments);
}

function count(_x3, _x4) {
  return _count.apply(this, arguments);
}

function _count() {
  _count = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee2(dbName, collectionName) {
    var docs;
    return _regenerator.default.wrap(function _callee2$(_context2) {
      while (1) {
        switch (_context2.prev = _context2.next) {
          case 0:
            _context2.next = 2;
            return find(dbName, collectionName);

          case 2:
            docs = _context2.sent;
            return _context2.abrupt("return", docs.length);

          case 4:
          case "end":
            return _context2.stop();
        }
      }
    }, _callee2, this);
  }));
  return _count.apply(this, arguments);
}

function findById(_x5, _x6, _x7) {
  return _findById.apply(this, arguments);
}

function _findById() {
  _findById = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee3(dbName, collectionName, id) {
    var db, collection, doc;
    return _regenerator.default.wrap(function _callee3$(_context3) {
      while (1) {
        switch (_context3.prev = _context3.next) {
          case 0:
            _context3.next = 2;
            return open(dbName, collectionName);

          case 2:
            db = _context3.sent;
            collection = db.getCollection(collectionName);
            doc = collection.by('_id', id);

            if (doc) {
              delete doc.$loki;
            }

            return _context3.abrupt("return", doc);

          case 7:
          case "end":
            return _context3.stop();
        }
      }
    }, _callee3, this);
  }));
  return _findById.apply(this, arguments);
}

function save(_x8, _x9, _x10) {
  return _save.apply(this, arguments);
}

function _save() {
  _save = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee4(dbName, collectionName, docsToSaveOrUpdate) {
    var db, collection, docs;
    return _regenerator.default.wrap(function _callee4$(_context4) {
      while (1) {
        switch (_context4.prev = _context4.next) {
          case 0:
            _context4.next = 2;
            return open(dbName, collectionName);

          case 2:
            db = _context4.sent;
            collection = db.getCollection(collectionName);
            docs = docsToSaveOrUpdate;

            if (docs) {
              _context4.next = 7;
              break;
            }

            return _context4.abrupt("return", null);

          case 7:
            docs = docs.map(function (doc) {
              var savedDoc = collection.by('_id', doc._id);

              if (savedDoc) {
                savedDoc = Object.assign({
                  $loki: savedDoc.$loki
                }, doc);
                collection.update(savedDoc);
                return savedDoc;
              }

              collection.insert(doc);
              return doc;
            });
            return _context4.abrupt("return", new Promise(function (resolve, reject) {
              db.save(function (error) {
                if (error) {
                  return reject(error);
                }

                return resolve(docs);
              });
            }));

          case 9:
          case "end":
            return _context4.stop();
        }
      }
    }, _callee4, this);
  }));
  return _save.apply(this, arguments);
}

function removeById(_x11, _x12, _x13) {
  return _removeById.apply(this, arguments);
}

function _removeById() {
  _removeById = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee5(dbName, collectionName, id) {
    var db, collection, doc, removedDoc;
    return _regenerator.default.wrap(function _callee5$(_context5) {
      while (1) {
        switch (_context5.prev = _context5.next) {
          case 0:
            _context5.next = 2;
            return open(dbName, collectionName);

          case 2:
            db = _context5.sent;
            collection = db.getCollection(collectionName);
            doc = collection.by('_id', id);

            if (!doc) {
              _context5.next = 9;
              break;
            }

            removedDoc = collection.remove(doc);

            if (!removedDoc) {
              _context5.next = 9;
              break;
            }

            return _context5.abrupt("return", new Promise(function (resolve, reject) {
              db.save(function (error) {
                if (error) {
                  return reject(error);
                }

                return resolve(1);
              });
            }));

          case 9:
            return _context5.abrupt("return", 0);

          case 10:
          case "end":
            return _context5.stop();
        }
      }
    }, _callee5, this);
  }));
  return _removeById.apply(this, arguments);
}

function clear(_x14, _x15) {
  return _clear.apply(this, arguments);
}

function _clear() {
  _clear = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee6(dbName, collectionName) {
    var db, collection;
    return _regenerator.default.wrap(function _callee6$(_context6) {
      while (1) {
        switch (_context6.prev = _context6.next) {
          case 0:
            _context6.next = 2;
            return open(dbName, collectionName);

          case 2:
            db = _context6.sent;
            collection = db.getCollection(collectionName);
            collection.clear();
            return _context6.abrupt("return", new Promise(function (resolve, reject) {
              db.save(function (error) {
                if (error) {
                  return reject(error);
                }

                return resolve(true);
              });
            }));

          case 6:
          case "end":
            return _context6.stop();
        }
      }
    }, _callee6, this);
  }));
  return _clear.apply(this, arguments);
}

function clearAll(_x16) {
  return _clearAll.apply(this, arguments);
}

function _clearAll() {
  _clearAll = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee7(dbName) {
    var db;
    return _regenerator.default.wrap(function _callee7$(_context7) {
      while (1) {
        switch (_context7.prev = _context7.next) {
          case 0:
            _context7.next = 2;
            return open(dbName);

          case 2:
            db = _context7.sent;
            return _context7.abrupt("return", new Promise(function (resolve, reject) {
              db.deleteDatabase(function (error) {
                if (error) {
                  return reject(error);
                }

                return resolve(true);
              });
            }));

          case 4:
          case "end":
            return _context7.stop();
        }
      }
    }, _callee7, this);
  }));
  return _clearAll.apply(this, arguments);
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/cache/store.js":
/*!******************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/cache/store.js ***!
  \******************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireWildcard = __webpack_require__(/*! @babel/runtime/helpers/interopRequireWildcard */ "./node_modules/@babel/runtime/helpers/interopRequireWildcard.js");

var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.get = get;
exports.StorageProvider = void 0;

var _config = __webpack_require__(/*! ../kinvey/config */ "./packages/kinvey-html5-sdk/src/kinvey/config.js");

var _kinvey = _interopRequireDefault(__webpack_require__(/*! ../errors/kinvey */ "./packages/kinvey-html5-sdk/src/errors/kinvey.js"));

var indexedDB = _interopRequireWildcard(__webpack_require__(/*! ./indexeddb */ "./packages/kinvey-html5-sdk/src/cache/indexeddb.js"));

var memory = _interopRequireWildcard(__webpack_require__(/*! ./memory */ "./packages/kinvey-html5-sdk/src/cache/memory.js"));

var webSQL = _interopRequireWildcard(__webpack_require__(/*! ./websql */ "./packages/kinvey-html5-sdk/src/cache/websql.js"));

var StorageProvider = {
  IndexedDB: 'IndexedDB',
  Memory: 'Memory',
  WebSQL: 'WebSQL'
}; // eslint-disable-next-line import/prefer-default-export

exports.StorageProvider = StorageProvider;

function get() {
  var _getConfig = (0, _config.get)(),
      _getConfig$storage = _getConfig.storage,
      storage = _getConfig$storage === void 0 ? StorageProvider.WebSQL : _getConfig$storage;

  if (storage === StorageProvider.IndexedDB) {
    return indexedDB;
  } else if (storage === StorageProvider.Memory) {
    return memory;
  } else if (storage === StorageProvider.WebSQL) {
    return webSQL;
  }

  throw new _kinvey.default('You must override the default cache store.');
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/cache/utils.js":
/*!******************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/cache/utils.js ***!
  \******************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.generateId = generateId;

// eslint-disable-next-line import/prefer-default-export
function generateId() {
  var length = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 24;
  var chars = 'abcdef0123456789';
  var id = '';

  for (var i = 0, j = chars.length; i < length; i += 1) {
    var pos = Math.floor(Math.random() * j);
    id += chars.substring(pos, pos + 1);
  }

  return id;
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/cache/websql.js":
/*!*******************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/cache/websql.js ***!
  \*******************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.find = find;
exports.count = count;
exports.findById = findById;
exports.save = save;
exports.removeById = removeById;
exports.clear = clear;
exports.clearAll = clearAll;

var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js"));

var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));

var _slicedToArray2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ "./node_modules/@babel/runtime/helpers/slicedToArray.js"));

var _isString = _interopRequireDefault(__webpack_require__(/*! lodash/isString */ "./node_modules/lodash/isString.js"));

var _kinvey = _interopRequireDefault(__webpack_require__(/*! ../errors/kinvey */ "./packages/kinvey-html5-sdk/src/errors/kinvey.js"));

var MASTER_TABLE_NAME = 'sqlite_master';
var SIZE = 2 * 1024 * 1024; // Database size in bytes

function execute(dbName, tableName, sqlQueries) {
  var write = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;
  var escapedTableName = "\"".concat(tableName, "\"");
  var isMaster = tableName === MASTER_TABLE_NAME;
  return new Promise(function (resolve, reject) {
    try {
      var db = window.openDatabase(dbName, 1, 'Kinvey WebSQL', SIZE);
      var writeTxn = write || typeof db.readTransaction !== 'function';
      db[writeTxn ? 'transaction' : 'readTransaction'](function (tx) {
        new Promise(function (resolve) {
          if (write && !isMaster) {
            tx.executeSql("CREATE TABLE IF NOT EXISTS ".concat(escapedTableName, " (key BLOB PRIMARY KEY NOT NULL, value BLOB NOT NULL)"), [], function () {
              resolve();
            });
          } else {
            resolve();
          }
        }).then(function () {
          return Promise.all(sqlQueries.map(function (_ref) {
            var _ref2 = (0, _slicedToArray2.default)(_ref, 2),
                sqlQuery = _ref2[0],
                _ref2$ = _ref2[1],
                parameters = _ref2$ === void 0 ? [] : _ref2$;

            return new Promise(function (resolve) {
              tx.executeSql(sqlQuery.replace('#{table}', escapedTableName), parameters, function (_, resultSet) {
                var response = {
                  rowCount: resultSet.rows.length || resultSet.rowsAffected,
                  result: []
                };

                if (resultSet.rows.length > 0) {
                  for (var i = 0, len = resultSet.rows.length; i < len; i += 1) {
                    var _resultSet$rows$item = resultSet.rows.item(i),
                        value = _resultSet$rows$item.value;

                    try {
                      var doc = isMaster ? value : JSON.parse(value);
                      response.result.push(doc);
                    } catch (error) {
                      response.result.push(value);
                    }
                  }
                }

                resolve(response);
              });
            });
          }));
        }).then(function () {
          var responses = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
          return responses.reduce(function (_ref3, response) {
            var _ref3$rowCount = _ref3.rowCount,
                rowCount = _ref3$rowCount === void 0 ? 0 : _ref3$rowCount,
                _ref3$result = _ref3.result,
                result = _ref3$result === void 0 ? [] : _ref3$result;
            return {
              rowCount: rowCount + response.rowCount,
              result: result.concat(response.result)
            };
          }, {
            rowCount: 0,
            result: []
          });
        }).then(resolve).catch(reject);
      }, function (error) {
        var errorMessage = (0, _isString.default)(error) ? error : error.message;

        if (errorMessage && errorMessage.indexOf('no such table') === -1) {
          resolve({
            rowCount: 0,
            result: []
          });
        } else {
          var sql = 'SELECT name AS value from #{table} WHERE type = ? AND name = ?';
          var parameters = ['table', tableName];
          execute(dbName, MASTER_TABLE_NAME, [[sql, parameters]]).then(function (response) {
            if (response.result.length === 0) {
              return resolve({
                rowCount: 0,
                result: []
              });
            }

            return reject(new _kinvey.default("Unable to open a transaction for the ".concat(tableName, " collection on the ").concat(dbName, " WebSQL database.")));
          }).catch(reject);
        }
      });
    } catch (error) {
      reject(error);
    }
  });
}

function find(_x, _x2) {
  return _find.apply(this, arguments);
}

function _find() {
  _find = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee(dbName, tableName) {
    var response;
    return _regenerator.default.wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            _context.next = 2;
            return execute(dbName, tableName, [['SELECT value FROM #{table}']]);

          case 2:
            response = _context.sent;
            return _context.abrupt("return", response.result);

          case 4:
          case "end":
            return _context.stop();
        }
      }
    }, _callee, this);
  }));
  return _find.apply(this, arguments);
}

function count(_x3, _x4) {
  return _count.apply(this, arguments);
}

function _count() {
  _count = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee2(dbName, tableName) {
    var response;
    return _regenerator.default.wrap(function _callee2$(_context2) {
      while (1) {
        switch (_context2.prev = _context2.next) {
          case 0:
            _context2.next = 2;
            return execute(dbName, tableName, [['SELECT COUNT(*) AS value FROM #{table}']]);

          case 2:
            response = _context2.sent;
            return _context2.abrupt("return", response.result.shift() || 0);

          case 4:
          case "end":
            return _context2.stop();
        }
      }
    }, _callee2, this);
  }));
  return _count.apply(this, arguments);
}

function findById(_x5, _x6, _x7) {
  return _findById.apply(this, arguments);
}

function _findById() {
  _findById = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee3(dbName, tableName, id) {
    var response;
    return _regenerator.default.wrap(function _callee3$(_context3) {
      while (1) {
        switch (_context3.prev = _context3.next) {
          case 0:
            _context3.next = 2;
            return execute(dbName, tableName, [['SELECT value FROM #{table} WHERE key = ?', [id]]]);

          case 2:
            response = _context3.sent;
            return _context3.abrupt("return", response.result.shift());

          case 4:
          case "end":
            return _context3.stop();
        }
      }
    }, _callee3, this);
  }));
  return _findById.apply(this, arguments);
}

function save(_x8, _x9) {
  return _save.apply(this, arguments);
}

function _save() {
  _save = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee4(dbName, tableName) {
    var docs,
        sqlQueries,
        _args4 = arguments;
    return _regenerator.default.wrap(function _callee4$(_context4) {
      while (1) {
        switch (_context4.prev = _context4.next) {
          case 0:
            docs = _args4.length > 2 && _args4[2] !== undefined ? _args4[2] : [];
            sqlQueries = docs.map(function (doc) {
              return ['REPLACE INTO #{table} (key, value) VALUES (?, ?)', [doc._id, JSON.stringify(doc)]];
            });
            _context4.next = 4;
            return execute(dbName, tableName, sqlQueries, true);

          case 4:
            return _context4.abrupt("return", docs);

          case 5:
          case "end":
            return _context4.stop();
        }
      }
    }, _callee4, this);
  }));
  return _save.apply(this, arguments);
}

function removeById(_x10, _x11, _x12) {
  return _removeById.apply(this, arguments);
}

function _removeById() {
  _removeById = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee5(dbName, tableName, id) {
    var response;
    return _regenerator.default.wrap(function _callee5$(_context5) {
      while (1) {
        switch (_context5.prev = _context5.next) {
          case 0:
            _context5.next = 2;
            return execute(dbName, tableName, [['DELETE FROM #{table} WHERE key = ?', [id]]], true);

          case 2:
            response = _context5.sent;
            return _context5.abrupt("return", response.rowCount);

          case 4:
          case "end":
            return _context5.stop();
        }
      }
    }, _callee5, this);
  }));
  return _removeById.apply(this, arguments);
}

function clear(_x13, _x14) {
  return _clear.apply(this, arguments);
}

function _clear() {
  _clear = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee6(dbName, tableName) {
    return _regenerator.default.wrap(function _callee6$(_context6) {
      while (1) {
        switch (_context6.prev = _context6.next) {
          case 0:
            _context6.next = 2;
            return execute(dbName, tableName, [['DROP TABLE IF EXISTS #{table}']], true);

          case 2:
            return _context6.abrupt("return", true);

          case 3:
          case "end":
            return _context6.stop();
        }
      }
    }, _callee6, this);
  }));
  return _clear.apply(this, arguments);
}

function clearAll(_x15) {
  return _clearAll.apply(this, arguments);
}

function _clearAll() {
  _clearAll = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee7(dbName) {
    var response, tables;
    return _regenerator.default.wrap(function _callee7$(_context7) {
      while (1) {
        switch (_context7.prev = _context7.next) {
          case 0:
            _context7.next = 2;
            return execute(dbName, MASTER_TABLE_NAME, [['SELECT name AS value FROM #{table} WHERE type = ? AND value NOT LIKE ?', ['table', '__Webkit%']]]);

          case 2:
            response = _context7.sent;
            tables = response.result;

            if (!(tables.length > 0)) {
              _context7.next = 7;
              break;
            }

            _context7.next = 7;
            return Promise.all(tables.map(function (tableName) {
              return execute(dbName, tableName, [['DROP TABLE IF EXISTS #{table}']], true);
            }));

          case 7:
            return _context7.abrupt("return", true);

          case 8:
          case "end":
            return _context7.stop();
        }
      }
    }, _callee7, this);
  }));
  return _clearAll.apply(this, arguments);
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/datastore/cache.js":
/*!**********************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/datastore/cache.js ***!
  \**********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.isValidTag = isValidTag;
exports.clear = clear;
exports.QueryCache = exports.DataStoreCache = void 0;

var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js"));

var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));

var _createClass2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/createClass */ "./node_modules/@babel/runtime/helpers/createClass.js"));

var _get2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/get */ "./node_modules/@babel/runtime/helpers/get.js"));

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _isString = _interopRequireDefault(__webpack_require__(/*! lodash/isString */ "./node_modules/lodash/isString.js"));

var _isEmpty = _interopRequireDefault(__webpack_require__(/*! lodash/isEmpty */ "./node_modules/lodash/isEmpty.js"));

var _cache = __webpack_require__(/*! ../cache */ "./packages/kinvey-html5-sdk/src/cache/index.js");

var _config = __webpack_require__(/*! ../kinvey/config */ "./packages/kinvey-html5-sdk/src/kinvey/config.js");

var _headers = __webpack_require__(/*! ../http/headers */ "./packages/kinvey-html5-sdk/src/http/headers.js");

var _query = _interopRequireDefault(__webpack_require__(/*! ../query */ "./packages/kinvey-html5-sdk/src/query.js"));

var QUERY_CACHE_TAG = '_QueryCache';

function isValidTag(tag) {
  var regexp = /^[a-z0-9-]+$/i;
  return (0, _isString.default)(tag) && regexp.test(tag);
}

var DataStoreCache =
/*#__PURE__*/
function (_Cache) {
  (0, _inherits2.default)(DataStoreCache, _Cache);

  function DataStoreCache(collectionName, tag) {
    var _this;

    (0, _classCallCheck2.default)(this, DataStoreCache);

    var _getConfig = (0, _config.get)(),
        appKey = _getConfig.appKey;

    if (tag && !isValidTag(tag)) {
      throw new Error('A tag can only contain letters, numbers, and "-".');
    }

    if (tag) {
      _this = (0, _possibleConstructorReturn2.default)(this, (0, _getPrototypeOf2.default)(DataStoreCache).call(this, appKey, "".concat(collectionName, ".").concat(tag)));
    } else {
      _this = (0, _possibleConstructorReturn2.default)(this, (0, _getPrototypeOf2.default)(DataStoreCache).call(this, appKey, collectionName));
    }

    return (0, _possibleConstructorReturn2.default)(_this);
  }

  return DataStoreCache;
}(_cache.Cache);

exports.DataStoreCache = DataStoreCache;

var QueryCache =
/*#__PURE__*/
function (_DataStoreCache) {
  (0, _inherits2.default)(QueryCache, _DataStoreCache);

  function QueryCache(tag) {
    (0, _classCallCheck2.default)(this, QueryCache);
    return (0, _possibleConstructorReturn2.default)(this, (0, _getPrototypeOf2.default)(QueryCache).call(this, QUERY_CACHE_TAG, tag));
  } // eslint-disable-next-line class-methods-use-this


  (0, _createClass2.default)(QueryCache, [{
    key: "serializeQuery",
    value: function serializeQuery(query) {
      if (!query) {
        return '';
      }

      if (query.skip > 0 || query.limit < Infinity) {
        return null;
      }

      var queryObject = query.toQueryObject();
      return queryObject && !(0, _isEmpty.default)(queryObject) ? JSON.stringify(queryObject) : '';
    }
  }, {
    key: "findByKey",
    value: function () {
      var _findByKey = (0, _asyncToGenerator2.default)(
      /*#__PURE__*/
      _regenerator.default.mark(function _callee(key) {
        var query, docs;
        return _regenerator.default.wrap(function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                query = new _query.default().equalTo('query', key);
                _context.next = 3;
                return this.find(query);

              case 3:
                docs = _context.sent;
                return _context.abrupt("return", docs.shift());

              case 5:
              case "end":
                return _context.stop();
            }
          }
        }, _callee, this);
      }));

      function findByKey(_x) {
        return _findByKey.apply(this, arguments);
      }

      return findByKey;
    }()
  }, {
    key: "save",
    value: function () {
      var _save = (0, _asyncToGenerator2.default)(
      /*#__PURE__*/
      _regenerator.default.mark(function _callee2(query, response) {
        var key, headers, doc;
        return _regenerator.default.wrap(function _callee2$(_context2) {
          while (1) {
            switch (_context2.prev = _context2.next) {
              case 0:
                key = this.serializeQuery(query);

                if (!(key !== null)) {
                  _context2.next = 9;
                  break;
                }

                headers = new _headers.KinveyHeaders(response.headers);
                _context2.next = 5;
                return this.findByKey(key);

              case 5:
                doc = _context2.sent;

                if (!doc) {
                  doc = {
                    collectionName: this.collectionName,
                    query: key
                  };
                }

                doc.lastRequest = headers.requestStart;
                return _context2.abrupt("return", (0, _get2.default)((0, _getPrototypeOf2.default)(QueryCache.prototype), "save", this).call(this, doc));

              case 9:
                return _context2.abrupt("return", null);

              case 10:
              case "end":
                return _context2.stop();
            }
          }
        }, _callee2, this);
      }));

      function save(_x2, _x3) {
        return _save.apply(this, arguments);
      }

      return save;
    }()
  }]);
  return QueryCache;
}(DataStoreCache);

exports.QueryCache = QueryCache;

function clear() {
  return _clear2.apply(this, arguments);
}

function _clear2() {
  _clear2 = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee3() {
    var _getConfig2, appKey;

    return _regenerator.default.wrap(function _callee3$(_context3) {
      while (1) {
        switch (_context3.prev = _context3.next) {
          case 0:
            _getConfig2 = (0, _config.get)(), appKey = _getConfig2.appKey;
            _context3.next = 3;
            return (0, _cache.clear)(appKey);

          case 3:
            return _context3.abrupt("return", null);

          case 4:
          case "end":
            return _context3.stop();
        }
      }
    }, _callee3, this);
  }));
  return _clear2.apply(this, arguments);
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/datastore/cachestore.js":
/*!***************************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/datastore/cachestore.js ***!
  \***************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.CacheStore = exports.default = void 0;

var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js"));

var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));

var _createClass2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/createClass */ "./node_modules/@babel/runtime/helpers/createClass.js"));

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf3 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _assertThisInitialized2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js"));

var _isArray = _interopRequireDefault(__webpack_require__(/*! lodash/isArray */ "./node_modules/lodash/isArray.js"));

var _times = _interopRequireDefault(__webpack_require__(/*! lodash/times */ "./node_modules/lodash/times.js"));

var _observable = _interopRequireDefault(__webpack_require__(/*! ../observable */ "./packages/kinvey-html5-sdk/src/observable.js"));

var _query = _interopRequireDefault(__webpack_require__(/*! ../query */ "./packages/kinvey-html5-sdk/src/query.js"));

var _config = __webpack_require__(/*! ../kinvey/config */ "./packages/kinvey-html5-sdk/src/kinvey/config.js");

var _utils = __webpack_require__(/*! ../http/utils */ "./packages/kinvey-html5-sdk/src/http/utils.js");

var _request = __webpack_require__(/*! ../http/request */ "./packages/kinvey-html5-sdk/src/http/request.js");

var _auth = __webpack_require__(/*! ../http/auth */ "./packages/kinvey-html5-sdk/src/http/auth.js");

var _kinvey = _interopRequireDefault(__webpack_require__(/*! ../errors/kinvey */ "./packages/kinvey-html5-sdk/src/errors/kinvey.js"));

var _missingConfiguration = _interopRequireDefault(__webpack_require__(/*! ../errors/missingConfiguration */ "./packages/kinvey-html5-sdk/src/errors/missingConfiguration.js"));

var _parameterValueOutOfRange = _interopRequireDefault(__webpack_require__(/*! ../errors/parameterValueOutOfRange */ "./packages/kinvey-html5-sdk/src/errors/parameterValueOutOfRange.js"));

var _notFound = _interopRequireDefault(__webpack_require__(/*! ../errors/notFound */ "./packages/kinvey-html5-sdk/src/errors/notFound.js"));

var _base = _interopRequireDefault(__webpack_require__(/*! ../errors/base */ "./packages/kinvey-html5-sdk/src/errors/base.js"));

var _cache = __webpack_require__(/*! ./cache */ "./packages/kinvey-html5-sdk/src/datastore/cache.js");

var _sync2 = __webpack_require__(/*! ./sync */ "./packages/kinvey-html5-sdk/src/datastore/sync.js");

var _networkstore = __webpack_require__(/*! ./networkstore */ "./packages/kinvey-html5-sdk/src/datastore/networkstore.js");

var NAMESPACE = 'appdata';
var PAGE_LIMIT = 10000;

var InvalidDeltaSetQueryError =
/*#__PURE__*/
function (_BaseError) {
  (0, _inherits2.default)(InvalidDeltaSetQueryError, _BaseError);

  function InvalidDeltaSetQueryError() {
    var _getPrototypeOf2;

    var _this;

    var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'Invalid delta set query.';
    (0, _classCallCheck2.default)(this, InvalidDeltaSetQueryError);

    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    // Pass remaining arguments (including vendor specific ones) to parent constructor
    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(InvalidDeltaSetQueryError)).call.apply(_getPrototypeOf2, [this, message].concat(args))); // Maintains proper stack trace for where our error was thrown (only available on V8)

    if (Error.captureStackTrace) {
      Error.captureStackTrace((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), InvalidDeltaSetQueryError);
    } // Custom debugging information


    _this.name = 'InvalidDeltaSetQueryError';
    return _this;
  }

  return InvalidDeltaSetQueryError;
}(_base.default);

exports.default = InvalidDeltaSetQueryError;

var CacheStore =
/*#__PURE__*/
function () {
  function CacheStore(collectionName) {
    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {
      tag: undefined,
      useDeltaSet: false,
      useAutoPagination: false,
      autoSync: true
    };
    (0, _classCallCheck2.default)(this, CacheStore);
    this.collectionName = collectionName;
    this.tag = options.tag;
    this.useDeltaSet = options.useDeltaSet === true;
    this.useAutoPagination = options.useAutoPagination === true || options.autoPagination;
    this.autoSync = options.autoSync === true;
  }

  (0, _createClass2.default)(CacheStore, [{
    key: "find",
    value: function find(query) {
      var _this2 = this;

      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
      var autoSync = options.autoSync === true || this.autoSync;
      var cache = new _cache.DataStoreCache(this.collectionName, this.tag);

      var stream = _observable.default.create(
      /*#__PURE__*/
      function () {
        var _ref = (0, _asyncToGenerator2.default)(
        /*#__PURE__*/
        _regenerator.default.mark(function _callee(observer) {
          var cachedDocs, docs;
          return _regenerator.default.wrap(function _callee$(_context) {
            while (1) {
              switch (_context.prev = _context.next) {
                case 0:
                  _context.prev = 0;
                  _context.next = 3;
                  return cache.find(query);

                case 3:
                  cachedDocs = _context.sent;
                  observer.next(cachedDocs);

                  if (!autoSync) {
                    _context.next = 12;
                    break;
                  }

                  _context.next = 8;
                  return _this2.pull(query, options);

                case 8:
                  _context.next = 10;
                  return cache.find(query);

                case 10:
                  docs = _context.sent;
                  observer.next(docs);

                case 12:
                  observer.complete();
                  _context.next = 18;
                  break;

                case 15:
                  _context.prev = 15;
                  _context.t0 = _context["catch"](0);
                  observer.error(_context.t0);

                case 18:
                case "end":
                  return _context.stop();
              }
            }
          }, _callee, this, [[0, 15]]);
        }));

        return function (_x) {
          return _ref.apply(this, arguments);
        };
      }());

      return stream;
    }
  }, {
    key: "count",
    value: function count(query) {
      var _this3 = this;

      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
      var autoSync = options.autoSync === true || this.autoSync;
      var cache = new _cache.DataStoreCache(this.collectionName, this.tag);

      var stream = _observable.default.create(
      /*#__PURE__*/
      function () {
        var _ref2 = (0, _asyncToGenerator2.default)(
        /*#__PURE__*/
        _regenerator.default.mark(function _callee2(observer) {
          var cacheCount, network, count;
          return _regenerator.default.wrap(function _callee2$(_context2) {
            while (1) {
              switch (_context2.prev = _context2.next) {
                case 0:
                  _context2.prev = 0;
                  _context2.next = 3;
                  return cache.count(query);

                case 3:
                  cacheCount = _context2.sent;
                  observer.next(cacheCount);

                  if (!autoSync) {
                    _context2.next = 11;
                    break;
                  }

                  network = new _networkstore.NetworkStore(_this3.collectionName);
                  _context2.next = 9;
                  return network.count(query, options).toPromise();

                case 9:
                  count = _context2.sent;
                  observer.next(count);

                case 11:
                  observer.complete();
                  _context2.next = 17;
                  break;

                case 14:
                  _context2.prev = 14;
                  _context2.t0 = _context2["catch"](0);
                  observer.error(_context2.t0);

                case 17:
                case "end":
                  return _context2.stop();
              }
            }
          }, _callee2, this, [[0, 14]]);
        }));

        return function (_x2) {
          return _ref2.apply(this, arguments);
        };
      }());

      return stream;
    }
  }, {
    key: "group",
    value: function group(aggregation) {
      var _this4 = this;

      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
      var autoSync = options.autoSync === true || this.autoSync;
      var cache = new _cache.DataStoreCache(this.collectionName, this.tag);

      var stream = _observable.default.create(
      /*#__PURE__*/
      function () {
        var _ref3 = (0, _asyncToGenerator2.default)(
        /*#__PURE__*/
        _regenerator.default.mark(function _callee3(observer) {
          var cacheResult, network, networkResult;
          return _regenerator.default.wrap(function _callee3$(_context3) {
            while (1) {
              switch (_context3.prev = _context3.next) {
                case 0:
                  _context3.prev = 0;
                  _context3.next = 3;
                  return cache.group(aggregation);

                case 3:
                  cacheResult = _context3.sent;
                  observer.next(cacheResult);

                  if (!autoSync) {
                    _context3.next = 11;
                    break;
                  }

                  network = new _networkstore.NetworkStore(_this4.collectionName);
                  _context3.next = 9;
                  return network.group(aggregation, options).toPromise();

                case 9:
                  networkResult = _context3.sent;
                  observer.next(networkResult);

                case 11:
                  observer.complete();
                  _context3.next = 17;
                  break;

                case 14:
                  _context3.prev = 14;
                  _context3.t0 = _context3["catch"](0);
                  observer.error(_context3.t0);

                case 17:
                case "end":
                  return _context3.stop();
              }
            }
          }, _callee3, this, [[0, 14]]);
        }));

        return function (_x3) {
          return _ref3.apply(this, arguments);
        };
      }());

      return stream;
    }
  }, {
    key: "findById",
    value: function findById(id) {
      var _this5 = this;

      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

      var stream = _observable.default.create(
      /*#__PURE__*/
      function () {
        var _ref4 = (0, _asyncToGenerator2.default)(
        /*#__PURE__*/
        _regenerator.default.mark(function _callee4(observer) {
          var autoSync, cache, cachedDoc, doc;
          return _regenerator.default.wrap(function _callee4$(_context4) {
            while (1) {
              switch (_context4.prev = _context4.next) {
                case 0:
                  _context4.prev = 0;

                  if (id) {
                    _context4.next = 5;
                    break;
                  }

                  observer.next(undefined);
                  _context4.next = 22;
                  break;

                case 5:
                  autoSync = options.autoSync === true || _this5.autoSync;
                  cache = new _cache.DataStoreCache(_this5.collectionName, _this5.tag);
                  _context4.next = 9;
                  return cache.findById(id);

                case 9:
                  cachedDoc = _context4.sent;

                  if (cachedDoc) {
                    _context4.next = 16;
                    break;
                  }

                  if (autoSync) {
                    _context4.next = 13;
                    break;
                  }

                  throw new _notFound.default();

                case 13:
                  observer.next(undefined);
                  _context4.next = 17;
                  break;

                case 16:
                  observer.next(cachedDoc);

                case 17:
                  if (!autoSync) {
                    _context4.next = 22;
                    break;
                  }

                  _context4.next = 20;
                  return _this5.pullById(id, options);

                case 20:
                  doc = _context4.sent;
                  observer.next(doc);

                case 22:
                  observer.complete();
                  _context4.next = 28;
                  break;

                case 25:
                  _context4.prev = 25;
                  _context4.t0 = _context4["catch"](0);
                  observer.error(_context4.t0);

                case 28:
                case "end":
                  return _context4.stop();
              }
            }
          }, _callee4, this, [[0, 25]]);
        }));

        return function (_x4) {
          return _ref4.apply(this, arguments);
        };
      }());

      return stream;
    }
  }, {
    key: "create",
    value: function () {
      var _create = (0, _asyncToGenerator2.default)(
      /*#__PURE__*/
      _regenerator.default.mark(function _callee5(doc) {
        var options,
            autoSync,
            cache,
            sync,
            cachedDoc,
            syncDoc,
            query,
            pushResults,
            pushResult,
            _args5 = arguments;
        return _regenerator.default.wrap(function _callee5$(_context5) {
          while (1) {
            switch (_context5.prev = _context5.next) {
              case 0:
                options = _args5.length > 1 && _args5[1] !== undefined ? _args5[1] : {};

                if (!(0, _isArray.default)(doc)) {
                  _context5.next = 3;
                  break;
                }

                throw new _kinvey.default('Unable to create an array of entities.', 'Please create entities one by one.');

              case 3:
                autoSync = options.autoSync === true || this.autoSync;
                cache = new _cache.DataStoreCache(this.collectionName, this.tag);
                sync = new _sync2.Sync(this.collectionName, this.tag);
                _context5.next = 8;
                return cache.save(doc);

              case 8:
                cachedDoc = _context5.sent;
                _context5.next = 11;
                return sync.addCreateSyncEvent(cachedDoc);

              case 11:
                syncDoc = _context5.sent;

                if (!autoSync) {
                  _context5.next = 21;
                  break;
                }

                query = new _query.default().equalTo('_id', syncDoc._id);
                _context5.next = 16;
                return sync.push(query, options);

              case 16:
                pushResults = _context5.sent;
                pushResult = pushResults.shift();

                if (!pushResult.error) {
                  _context5.next = 20;
                  break;
                }

                throw pushResult.error;

              case 20:
                return _context5.abrupt("return", pushResult.entity);

              case 21:
                return _context5.abrupt("return", cachedDoc);

              case 22:
              case "end":
                return _context5.stop();
            }
          }
        }, _callee5, this);
      }));

      function create(_x5) {
        return _create.apply(this, arguments);
      }

      return create;
    }()
  }, {
    key: "update",
    value: function () {
      var _update = (0, _asyncToGenerator2.default)(
      /*#__PURE__*/
      _regenerator.default.mark(function _callee6(doc) {
        var options,
            autoSync,
            cache,
            sync,
            cachedDoc,
            syncDoc,
            query,
            pushResults,
            pushResult,
            _args6 = arguments;
        return _regenerator.default.wrap(function _callee6$(_context6) {
          while (1) {
            switch (_context6.prev = _context6.next) {
              case 0:
                options = _args6.length > 1 && _args6[1] !== undefined ? _args6[1] : {};

                if (!(0, _isArray.default)(doc)) {
                  _context6.next = 3;
                  break;
                }

                throw new _kinvey.default('Unable to update an array of entities.', 'Please update entities one by one.');

              case 3:
                if (doc._id) {
                  _context6.next = 5;
                  break;
                }

                throw new _kinvey.default('The entity provided does not contain an _id. An _id is required to update the entity.', doc);

              case 5:
                autoSync = options.autoSync === true || this.autoSync;
                cache = new _cache.DataStoreCache(this.collectionName, this.tag);
                sync = new _sync2.Sync(this.collectionName, this.tag);
                _context6.next = 10;
                return cache.save(doc);

              case 10:
                cachedDoc = _context6.sent;
                _context6.next = 13;
                return sync.addUpdateSyncEvent(cachedDoc);

              case 13:
                syncDoc = _context6.sent;

                if (!autoSync) {
                  _context6.next = 23;
                  break;
                }

                query = new _query.default().equalTo('_id', syncDoc._id);
                _context6.next = 18;
                return sync.push(query, options);

              case 18:
                pushResults = _context6.sent;
                pushResult = pushResults.shift();

                if (!pushResult.error) {
                  _context6.next = 22;
                  break;
                }

                throw pushResult.error;

              case 22:
                return _context6.abrupt("return", pushResult.entity);

              case 23:
                return _context6.abrupt("return", cachedDoc);

              case 24:
              case "end":
                return _context6.stop();
            }
          }
        }, _callee6, this);
      }));

      function update(_x6) {
        return _update.apply(this, arguments);
      }

      return update;
    }()
  }, {
    key: "save",
    value: function save(doc, options) {
      if (doc._id) {
        return this.update(doc, options);
      }

      return this.create(doc, options);
    }
  }, {
    key: "remove",
    value: function () {
      var _remove = (0, _asyncToGenerator2.default)(
      /*#__PURE__*/
      _regenerator.default.mark(function _callee7(query) {
        var options,
            autoSync,
            cache,
            sync,
            count,
            docs,
            findQuery,
            syncDocs,
            pushQuery,
            pushResults,
            _args7 = arguments;
        return _regenerator.default.wrap(function _callee7$(_context7) {
          while (1) {
            switch (_context7.prev = _context7.next) {
              case 0:
                options = _args7.length > 1 && _args7[1] !== undefined ? _args7[1] : {};
                autoSync = options.autoSync === true || this.autoSync;
                cache = new _cache.DataStoreCache(this.collectionName, this.tag);
                sync = new _sync2.Sync(this.collectionName, this.tag);
                count = 0; // Find the docs that will be removed from the cache that match the query

                _context7.next = 7;
                return cache.find(query);

              case 7:
                docs = _context7.sent;

                if (!(docs.length > 0)) {
                  _context7.next = 14;
                  break;
                }

                _context7.next = 11;
                return cache.remove(query);

              case 11:
                count = _context7.sent;
                _context7.next = 14;
                return sync.addDeleteSyncEvent(docs);

              case 14:
                if (!autoSync) {
                  _context7.next = 25;
                  break;
                }

                findQuery = (0, _sync2.queryToSyncQuery)(query, this.collectionName);
                _context7.next = 18;
                return sync.find(findQuery);

              case 18:
                syncDocs = _context7.sent;

                if (!(syncDocs.length > 0)) {
                  _context7.next = 25;
                  break;
                }

                pushQuery = new _query.default().contains('_id', syncDocs.map(function (doc) {
                  return doc._id;
                }));
                _context7.next = 23;
                return sync.push(pushQuery);

              case 23:
                pushResults = _context7.sent;
                count = pushResults.reduce(function (count, pushResult) {
                  if (pushResult.error) {
                    return count - 1;
                  }

                  return count;
                }, count || syncDocs.length);

              case 25:
                return _context7.abrupt("return", {
                  count: count
                });

              case 26:
              case "end":
                return _context7.stop();
            }
          }
        }, _callee7, this);
      }));

      function remove(_x7) {
        return _remove.apply(this, arguments);
      }

      return remove;
    }()
  }, {
    key: "removeById",
    value: function () {
      var _removeById = (0, _asyncToGenerator2.default)(
      /*#__PURE__*/
      _regenerator.default.mark(function _callee8(id) {
        var options,
            autoSync,
            cache,
            sync,
            count,
            doc,
            syncDoc,
            query,
            pushResults,
            pushResult,
            _args8 = arguments;
        return _regenerator.default.wrap(function _callee8$(_context8) {
          while (1) {
            switch (_context8.prev = _context8.next) {
              case 0:
                options = _args8.length > 1 && _args8[1] !== undefined ? _args8[1] : {};
                autoSync = options.autoSync === true || this.autoSync;
                cache = new _cache.DataStoreCache(this.collectionName, this.tag);
                sync = new _sync2.Sync(this.collectionName, this.tag);
                count = 0;

                if (!id) {
                  _context8.next = 28;
                  break;
                }

                _context8.next = 8;
                return cache.findById(id);

              case 8:
                doc = _context8.sent;

                if (!doc) {
                  _context8.next = 27;
                  break;
                }

                _context8.next = 12;
                return cache.removeById(id);

              case 12:
                count = _context8.sent;
                _context8.next = 15;
                return sync.addDeleteSyncEvent(doc);

              case 15:
                syncDoc = _context8.sent;

                if (!(autoSync && syncDoc)) {
                  _context8.next = 24;
                  break;
                }

                query = new _query.default().equalTo('_id', syncDoc._id);
                _context8.next = 20;
                return sync.push(query);

              case 20:
                pushResults = _context8.sent;

                if (pushResults.length > 0) {
                  pushResult = pushResults.shift();

                  if (pushResult.error) {
                    count -= 1;
                  }
                }

                _context8.next = 25;
                break;

              case 24:
                count = 1;

              case 25:
                _context8.next = 28;
                break;

              case 27:
                throw new _notFound.default();

              case 28:
                return _context8.abrupt("return", {
                  count: count
                });

              case 29:
              case "end":
                return _context8.stop();
            }
          }
        }, _callee8, this);
      }));

      function removeById(_x8) {
        return _removeById.apply(this, arguments);
      }

      return removeById;
    }()
  }, {
    key: "clear",
    value: function () {
      var _clear = (0, _asyncToGenerator2.default)(
      /*#__PURE__*/
      _regenerator.default.mark(function _callee9(query) {
        var cache, count, queryCache;
        return _regenerator.default.wrap(function _callee9$(_context9) {
          while (1) {
            switch (_context9.prev = _context9.next) {
              case 0:
                // Remove the docs from the cache
                cache = new _cache.DataStoreCache(this.collectionName, this.tag);
                _context9.next = 3;
                return cache.remove(query);

              case 3:
                count = _context9.sent;
                _context9.next = 6;
                return this.clearSync(query);

              case 6:
                // Clear the query cache
                if (!query) {
                  queryCache = new _cache.QueryCache(this.tag);
                  queryCache.remove();
                } // Return the cound


                return _context9.abrupt("return", {
                  count: count
                });

              case 8:
              case "end":
                return _context9.stop();
            }
          }
        }, _callee9, this);
      }));

      function clear(_x9) {
        return _clear.apply(this, arguments);
      }

      return clear;
    }()
  }, {
    key: "push",
    value: function push(query, options) {
      var sync = new _sync2.Sync(this.collectionName, this.tag);
      return sync.push(null, options);
    }
  }, {
    key: "pull",
    value: function () {
      var _pull = (0, _asyncToGenerator2.default)(
      /*#__PURE__*/
      _regenerator.default.mark(function _callee10(query) {
        var options,
            network,
            cache,
            queryCache,
            useDeltaSet,
            useAutoPagination,
            count,
            key,
            queryCacheDoc,
            queryObject,
            _getConfig,
            apiProtocol,
            apiHost,
            appKey,
            url,
            request,
            _response,
            _response$data,
            changed,
            deleted,
            removeQuery,
            _response2,
            _count,
            pageSize,
            pageCount,
            pageQueries,
            pagePromises,
            pageCounts,
            totalPageCount,
            response,
            docs,
            _args10 = arguments;

        return _regenerator.default.wrap(function _callee10$(_context10) {
          while (1) {
            switch (_context10.prev = _context10.next) {
              case 0:
                options = _args10.length > 1 && _args10[1] !== undefined ? _args10[1] : {};
                network = new _networkstore.NetworkStore(this.collectionName);
                cache = new _cache.DataStoreCache(this.collectionName, this.tag);
                queryCache = new _cache.QueryCache(this.tag);
                useDeltaSet = options.useDeltaSet === true || this.useDeltaSet;
                useAutoPagination = options.useAutoPagination === true || options.autoPagination || this.useAutoPagination; // Push sync queue

                _context10.next = 8;
                return this.pendingSyncCount();

              case 8:
                count = _context10.sent;

                if (!(count > 0)) {
                  _context10.next = 13;
                  break;
                }

                if (!(count === 1)) {
                  _context10.next = 12;
                  break;
                }

                throw new _kinvey.default("Unable to pull entities from the backend. There is ".concat(count, " entity") + ' that needs to be pushed to the backend.');

              case 12:
                throw new _kinvey.default("Unable to pull entities from the backend. There are ".concat(count, " entities") + ' that need to be pushed to the backend.');

              case 13:
                if (!(useDeltaSet && (!query || query.skip === 0 && query.limit === Infinity))) {
                  _context10.next = 45;
                  break;
                }

                _context10.prev = 14;
                key = queryCache.serializeQuery(query);
                _context10.next = 18;
                return queryCache.findByKey(key);

              case 18:
                queryCacheDoc = _context10.sent;

                if (!(queryCacheDoc && queryCacheDoc.lastRequest)) {
                  _context10.next = 39;
                  break;
                }

                queryObject = {
                  since: queryCacheDoc.lastRequest
                };

                if (query) {
                  queryObject = Object.assign({}, query.toQueryObject(), queryObject);
                } // Delta Set request


                _getConfig = (0, _config.get)(), apiProtocol = _getConfig.apiProtocol, apiHost = _getConfig.apiHost, appKey = _getConfig.appKey;
                url = (0, _utils.formatKinveyUrl)(apiProtocol, apiHost, "/appdata/".concat(appKey, "/").concat(this.collectionName, "/_deltaset"), queryObject);
                request = new _request.KinveyRequest({
                  method: _request.RequestMethod.GET,
                  auth: _auth.Auth.Session,
                  url: url
                });
                _context10.next = 27;
                return request.execute();

              case 27:
                _response = _context10.sent;
                _response$data = _response.data, changed = _response$data.changed, deleted = _response$data.deleted; // Delete the docs that have been deleted

                if (!(Array.isArray(deleted) && deleted.length > 0)) {
                  _context10.next = 33;
                  break;
                }

                removeQuery = new _query.default().contains('_id', deleted.map(function (doc) {
                  return doc._id;
                }));
                _context10.next = 33;
                return cache.remove(removeQuery);

              case 33:
                if (!(Array.isArray(changed) && changed.length > 0)) {
                  _context10.next = 36;
                  break;
                }

                _context10.next = 36;
                return cache.save(changed);

              case 36:
                _context10.next = 38;
                return queryCache.save(query, _response);

              case 38:
                return _context10.abrupt("return", changed.length);

              case 39:
                _context10.next = 45;
                break;

              case 41:
                _context10.prev = 41;
                _context10.t0 = _context10["catch"](14);

                if (!(!(_context10.t0 instanceof _missingConfiguration.default) && !(_context10.t0 instanceof _parameterValueOutOfRange.default))) {
                  _context10.next = 45;
                  break;
                }

                throw _context10.t0;

              case 45:
                if (!useAutoPagination) {
                  _context10.next = 62;
                  break;
                }

                _context10.next = 48;
                return cache.clear();

              case 48:
                _context10.next = 50;
                return network.count(query, Object.assign({}, options, {
                  rawResponse: true
                })).toPromise();

              case 50:
                _response2 = _context10.sent;
                _count = 'count' in _response2.data ? _response2.data.count : Infinity; // Create the pages

                pageSize = options.autoPaginationPageSize || options.autoPagination && options.autoPagination.pageSize || PAGE_LIMIT;
                pageCount = Math.ceil(_count / pageSize);
                pageQueries = (0, _times.default)(pageCount, function (i) {
                  var pageQuery = new _query.default(query);
                  pageQuery.skip = i * pageSize;
                  pageQuery.limit = Math.min(_count - i * pageSize, pageSize);
                  return pageQuery;
                }); // Process the pages

                pagePromises = pageQueries.map(function (pageQuery) {
                  return network.find(pageQuery, options).toPromise().then(function (docs) {
                    return cache.save(docs);
                  }).then(function (docs) {
                    return docs.length;
                  });
                });
                _context10.next = 58;
                return Promise.all(pagePromises);

              case 58:
                pageCounts = _context10.sent;
                totalPageCount = pageCounts.reduce(function (totalCount, pageCount) {
                  return totalCount + pageCount;
                }, 0); // Update the query cache

                queryCache.save(query, _response2); // Return the total page count

                return _context10.abrupt("return", totalPageCount);

              case 62:
                _context10.next = 64;
                return network.find(query, Object.assign({}, options, {
                  rawResponse: true
                })).toPromise();

              case 64:
                response = _context10.sent;
                docs = response.data; // Clear the cache if a query was not provided

                if (query) {
                  _context10.next = 69;
                  break;
                }

                _context10.next = 69;
                return cache.clear();

              case 69:
                _context10.next = 71;
                return cache.save(docs);

              case 71:
                _context10.next = 73;
                return queryCache.save(query, response);

              case 73:
                return _context10.abrupt("return", docs.length);

              case 74:
              case "end":
                return _context10.stop();
            }
          }
        }, _callee10, this, [[14, 41]]);
      }));

      function pull(_x10) {
        return _pull.apply(this, arguments);
      }

      return pull;
    }()
  }, {
    key: "pullById",
    value: function () {
      var _pullById = (0, _asyncToGenerator2.default)(
      /*#__PURE__*/
      _regenerator.default.mark(function _callee11(id) {
        var options,
            network,
            cache,
            count,
            doc,
            _args11 = arguments;
        return _regenerator.default.wrap(function _callee11$(_context11) {
          while (1) {
            switch (_context11.prev = _context11.next) {
              case 0:
                options = _args11.length > 1 && _args11[1] !== undefined ? _args11[1] : {};
                network = new _networkstore.NetworkStore(this.collectionName);
                cache = new _cache.DataStoreCache(this.collectionName, this.tag); // Push sync queue

                _context11.next = 5;
                return this.pendingSyncCount();

              case 5:
                count = _context11.sent;

                if (!(count > 0)) {
                  _context11.next = 10;
                  break;
                }

                if (!(count === 1)) {
                  _context11.next = 9;
                  break;
                }

                throw new _kinvey.default("Unable to pull entities from the backend. There is ".concat(count, " entity") + ' that needs to be pushed to the backend.');

              case 9:
                throw new _kinvey.default("Unable to pull entities from the backend. There are ".concat(count, " entities") + ' that need to be pushed to the backend.');

              case 10:
                _context11.prev = 10;
                _context11.next = 13;
                return network.findById(id, options).toPromise();

              case 13:
                doc = _context11.sent;
                _context11.next = 16;
                return cache.save(doc);

              case 16:
                return _context11.abrupt("return", doc);

              case 19:
                _context11.prev = 19;
                _context11.t0 = _context11["catch"](10);

                if (!(_context11.t0 instanceof _notFound.default)) {
                  _context11.next = 24;
                  break;
                }

                _context11.next = 24;
                return cache.removeById(id);

              case 24:
                throw _context11.t0;

              case 25:
              case "end":
                return _context11.stop();
            }
          }
        }, _callee11, this, [[10, 19]]);
      }));

      function pullById(_x11) {
        return _pullById.apply(this, arguments);
      }

      return pullById;
    }()
  }, {
    key: "sync",
    value: function () {
      var _sync = (0, _asyncToGenerator2.default)(
      /*#__PURE__*/
      _regenerator.default.mark(function _callee12(query, options) {
        var push, pull;
        return _regenerator.default.wrap(function _callee12$(_context12) {
          while (1) {
            switch (_context12.prev = _context12.next) {
              case 0:
                _context12.next = 2;
                return this.push(null, options);

              case 2:
                push = _context12.sent;
                _context12.next = 5;
                return this.pull(query, options);

              case 5:
                pull = _context12.sent;
                return _context12.abrupt("return", {
                  push: push,
                  pull: pull
                });

              case 7:
              case "end":
                return _context12.stop();
            }
          }
        }, _callee12, this);
      }));

      function sync(_x12, _x13) {
        return _sync.apply(this, arguments);
      }

      return sync;
    }()
  }, {
    key: "pendingSyncDocs",
    value: function pendingSyncDocs(query) {
      var sync = new _sync2.Sync(this.collectionName, this.tag);
      var findQuery = (0, _sync2.queryToSyncQuery)(query, this.collectionName);
      return sync.find(findQuery);
    }
  }, {
    key: "pendingSyncEntities",
    value: function pendingSyncEntities(query) {
      return this.pendingSyncDocs(query);
    }
  }, {
    key: "pendingSyncCount",
    value: function pendingSyncCount(query) {
      var sync = new _sync2.Sync(this.collectionName, this.tag);
      var findQuery = (0, _sync2.queryToSyncQuery)(query, this.collectionName);
      return sync.count(findQuery);
    }
  }, {
    key: "clearSync",
    value: function () {
      var _clearSync = (0, _asyncToGenerator2.default)(
      /*#__PURE__*/
      _regenerator.default.mark(function _callee13(query) {
        var sync, clearQuery;
        return _regenerator.default.wrap(function _callee13$(_context13) {
          while (1) {
            switch (_context13.prev = _context13.next) {
              case 0:
                sync = new _sync2.Sync(this.collectionName, this.tag);
                clearQuery = (0, _sync2.queryToSyncQuery)(query, this.collectionName);
                return _context13.abrupt("return", sync.remove(clearQuery));

              case 3:
              case "end":
                return _context13.stop();
            }
          }
        }, _callee13, this);
      }));

      function clearSync(_x14) {
        return _clearSync.apply(this, arguments);
      }

      return clearSync;
    }()
  }, {
    key: "subscribe",
    value: function () {
      var _subscribe = (0, _asyncToGenerator2.default)(
      /*#__PURE__*/
      _regenerator.default.mark(function _callee14(receiver) {
        var network;
        return _regenerator.default.wrap(function _callee14$(_context14) {
          while (1) {
            switch (_context14.prev = _context14.next) {
              case 0:
                network = new _networkstore.NetworkStore(this.collectionName);
                _context14.next = 3;
                return network.subscribe(receiver);

              case 3:
                return _context14.abrupt("return", this);

              case 4:
              case "end":
                return _context14.stop();
            }
          }
        }, _callee14, this);
      }));

      function subscribe(_x15) {
        return _subscribe.apply(this, arguments);
      }

      return subscribe;
    }()
  }, {
    key: "unsubscribe",
    value: function () {
      var _unsubscribe = (0, _asyncToGenerator2.default)(
      /*#__PURE__*/
      _regenerator.default.mark(function _callee15() {
        var network;
        return _regenerator.default.wrap(function _callee15$(_context15) {
          while (1) {
            switch (_context15.prev = _context15.next) {
              case 0:
                network = new _networkstore.NetworkStore(this.collectionName);
                _context15.next = 3;
                return network.unsubscribe();

              case 3:
                return _context15.abrupt("return", this);

              case 4:
              case "end":
                return _context15.stop();
            }
          }
        }, _callee15, this);
      }));

      function unsubscribe() {
        return _unsubscribe.apply(this, arguments);
      }

      return unsubscribe;
    }()
  }, {
    key: "pathname",
    get: function get() {
      var _getConfig2 = (0, _config.get)(),
          appKey = _getConfig2.appKey;

      return "/".concat(NAMESPACE, "/").concat(appKey, "/").concat(this.collectionName);
    }
  }]);
  return CacheStore;
}();

exports.CacheStore = CacheStore;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/datastore/index.js":
/*!**********************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/datastore/index.js ***!
  \**********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.collection = collection;
exports.getInstance = getInstance;
exports.clear = clear;
exports.clearCache = clearCache;
exports.DataStoreType = void 0;

var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js"));

var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));

var _isString = _interopRequireDefault(__webpack_require__(/*! lodash/isString */ "./node_modules/lodash/isString.js"));

var _kinvey = _interopRequireDefault(__webpack_require__(/*! ../errors/kinvey */ "./packages/kinvey-html5-sdk/src/errors/kinvey.js"));

var _cache = __webpack_require__(/*! ./cache */ "./packages/kinvey-html5-sdk/src/datastore/cache.js");

var _networkstore = __webpack_require__(/*! ./networkstore */ "./packages/kinvey-html5-sdk/src/datastore/networkstore.js");

var _cachestore = __webpack_require__(/*! ./cachestore */ "./packages/kinvey-html5-sdk/src/datastore/cachestore.js");

var DataStoreType = {
  Cache: 'Cache',
  Network: 'Network',
  Sync: 'Sync'
};
exports.DataStoreType = DataStoreType;

function collection(collectionName) {
  var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : DataStoreType.Cache;
  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
  var datastore;
  var tagWasPassed = options && 'tag' in options;

  if (collectionName == null || !(0, _isString.default)(collectionName)) {
    throw new _kinvey.default('A collection is required and must be a string.');
  }

  if (tagWasPassed && !(0, _cache.isValidTag)(options.tag)) {
    throw new _kinvey.default('Please provide a valid data store tag.');
  }

  if (type === DataStoreType.Network) {
    if (tagWasPassed) {
      throw new _kinvey.default('The tagged option is not valid for data stores of type "Network"');
    }

    datastore = new _networkstore.NetworkStore(collectionName);
  } else if (type === DataStoreType.Cache) {
    datastore = new _cachestore.CacheStore(collectionName, Object.assign({}, options, {
      autoSync: true
    }));
  } else if (type === DataStoreType.Sync) {
    datastore = new _cachestore.CacheStore(collectionName, Object.assign({}, options, {
      autoSync: false
    }));
  } else {
    throw new Error('Unknown data store type.');
  }

  return datastore;
}

function getInstance(collection, type, options) {
  return collection(collection, type, options);
}

function clear() {
  return _clear2.apply(this, arguments);
}

function _clear2() {
  _clear2 = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee() {
    return _regenerator.default.wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            return _context.abrupt("return", (0, _cache.clear)());

          case 1:
          case "end":
            return _context.stop();
        }
      }
    }, _callee, this);
  }));
  return _clear2.apply(this, arguments);
}

function clearCache() {
  return _clearCache.apply(this, arguments);
}

function _clearCache() {
  _clearCache = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee2() {
    return _regenerator.default.wrap(function _callee2$(_context2) {
      while (1) {
        switch (_context2.prev = _context2.next) {
          case 0:
            return _context2.abrupt("return", clear());

          case 1:
          case "end":
            return _context2.stop();
        }
      }
    }, _callee2, this);
  }));
  return _clearCache.apply(this, arguments);
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/datastore/networkstore.js":
/*!*****************************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/datastore/networkstore.js ***!
  \*****************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireWildcard = __webpack_require__(/*! @babel/runtime/helpers/interopRequireWildcard */ "./node_modules/@babel/runtime/helpers/interopRequireWildcard.js");

var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.createRequest = createRequest;
exports.NetworkStore = void 0;

var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js"));

var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _createClass2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/createClass */ "./node_modules/@babel/runtime/helpers/createClass.js"));

var _isArray = _interopRequireDefault(__webpack_require__(/*! lodash/isArray */ "./node_modules/lodash/isArray.js"));

var _config = __webpack_require__(/*! ../kinvey/config */ "./packages/kinvey-html5-sdk/src/kinvey/config.js");

var _device = __webpack_require__(/*! ../kinvey/device */ "./packages/kinvey-html5-sdk/src/kinvey/device.js");

var _observable = _interopRequireDefault(__webpack_require__(/*! ../observable */ "./packages/kinvey-html5-sdk/src/observable.js"));

var _session = __webpack_require__(/*! ../session */ "./packages/kinvey-html5-sdk/src/session/index.js");

var _aggregation = _interopRequireDefault(__webpack_require__(/*! ../aggregation */ "./packages/kinvey-html5-sdk/src/aggregation/index.js"));

var Live = _interopRequireWildcard(__webpack_require__(/*! ../live */ "./packages/kinvey-html5-sdk/src/live.js"));

var _query = _interopRequireDefault(__webpack_require__(/*! ../query */ "./packages/kinvey-html5-sdk/src/query.js"));

var _utils = __webpack_require__(/*! ../http/utils */ "./packages/kinvey-html5-sdk/src/http/utils.js");

var _request = __webpack_require__(/*! ../http/request */ "./packages/kinvey-html5-sdk/src/http/request.js");

var _auth = __webpack_require__(/*! ../http/auth */ "./packages/kinvey-html5-sdk/src/http/auth.js");

var _kinvey = _interopRequireDefault(__webpack_require__(/*! ../errors/kinvey */ "./packages/kinvey-html5-sdk/src/errors/kinvey.js"));

var NAMESPACE = 'appdata';

function createRequest(method, url, body) {
  return new _request.KinveyRequest({
    method: method,
    auth: _auth.Auth.Session,
    url: url,
    body: body
  });
}

var NetworkStore =
/*#__PURE__*/
function () {
  function NetworkStore(collectionName) {
    (0, _classCallCheck2.default)(this, NetworkStore);
    this.collectionName = collectionName;
  }
  /**
   * @deprecated 4.0.0 - Use collectionName instead.
   */


  (0, _createClass2.default)(NetworkStore, [{
    key: "find",
    value: function find(query) {
      var _this = this;

      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

      var stream = _observable.default.create(
      /*#__PURE__*/
      function () {
        var _ref = (0, _asyncToGenerator2.default)(
        /*#__PURE__*/
        _regenerator.default.mark(function _callee(observer) {
          var _getConfig, apiProtocol, apiHost, _options$rawResponse, rawResponse, timeout, properties, trace, skipBL, kinveyFileTTL, kinveyFileTLS, queryObject, url, request, response;

          return _regenerator.default.wrap(function _callee$(_context) {
            while (1) {
              switch (_context.prev = _context.next) {
                case 0:
                  _context.prev = 0;

                  if (!(query && !(query instanceof _query.default))) {
                    _context.next = 3;
                    break;
                  }

                  throw new _kinvey.default('Invalid query. It must be an instance of the Query class.');

                case 3:
                  _getConfig = (0, _config.get)(), apiProtocol = _getConfig.apiProtocol, apiHost = _getConfig.apiHost;
                  _options$rawResponse = options.rawResponse, rawResponse = _options$rawResponse === void 0 ? false : _options$rawResponse, timeout = options.timeout, properties = options.properties, trace = options.trace, skipBL = options.skipBL, kinveyFileTTL = options.kinveyFileTTL, kinveyFileTLS = options.kinveyFileTLS;
                  queryObject = Object.assign({}, query ? query.toQueryObject() : {}, {
                    kinveyfile_ttl: kinveyFileTTL,
                    kinveyfile_tls: kinveyFileTLS
                  });
                  url = (0, _utils.formatKinveyUrl)(apiProtocol, apiHost, _this.pathname, queryObject);
                  request = createRequest(_request.RequestMethod.GET, url);
                  request.headers.customRequestProperties = properties;
                  request.timeout = timeout;
                  _context.next = 12;
                  return request.execute();

                case 12:
                  response = _context.sent;

                  if (rawResponse === true) {
                    observer.next(response);
                  } else {
                    observer.next(response.data);
                  }

                  observer.complete();
                  _context.next = 20;
                  break;

                case 17:
                  _context.prev = 17;
                  _context.t0 = _context["catch"](0);
                  observer.error(_context.t0);

                case 20:
                case "end":
                  return _context.stop();
              }
            }
          }, _callee, this, [[0, 17]]);
        }));

        return function (_x) {
          return _ref.apply(this, arguments);
        };
      }());

      return stream;
    }
  }, {
    key: "count",
    value: function count(query) {
      var _this2 = this;

      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

      var stream = _observable.default.create(
      /*#__PURE__*/
      function () {
        var _ref2 = (0, _asyncToGenerator2.default)(
        /*#__PURE__*/
        _regenerator.default.mark(function _callee2(observer) {
          var _getConfig2, apiProtocol, apiHost, _options$rawResponse2, rawResponse, timeout, properties, trace, skipBL, queryObject, url, request, response;

          return _regenerator.default.wrap(function _callee2$(_context2) {
            while (1) {
              switch (_context2.prev = _context2.next) {
                case 0:
                  _context2.prev = 0;

                  if (!(query && !(query instanceof _query.default))) {
                    _context2.next = 3;
                    break;
                  }

                  throw new _kinvey.default('Invalid query. It must be an instance of the Query class.');

                case 3:
                  _getConfig2 = (0, _config.get)(), apiProtocol = _getConfig2.apiProtocol, apiHost = _getConfig2.apiHost;
                  _options$rawResponse2 = options.rawResponse, rawResponse = _options$rawResponse2 === void 0 ? false : _options$rawResponse2, timeout = options.timeout, properties = options.properties, trace = options.trace, skipBL = options.skipBL;
                  queryObject = Object.assign({}, query ? query.toQueryObject() : {}, {});
                  url = (0, _utils.formatKinveyUrl)(apiProtocol, apiHost, "".concat(_this2.pathname, "/_count"), queryObject);
                  request = createRequest(_request.RequestMethod.GET, url);
                  request.headers.customRequestProperties = properties;
                  request.timeout = timeout;
                  _context2.next = 12;
                  return request.execute();

                case 12:
                  response = _context2.sent;

                  if (rawResponse === true) {
                    observer.next(response);
                  } else {
                    observer.next(response.data.count);
                  }

                  observer.complete();
                  _context2.next = 20;
                  break;

                case 17:
                  _context2.prev = 17;
                  _context2.t0 = _context2["catch"](0);
                  observer.error(_context2.t0);

                case 20:
                case "end":
                  return _context2.stop();
              }
            }
          }, _callee2, this, [[0, 17]]);
        }));

        return function (_x2) {
          return _ref2.apply(this, arguments);
        };
      }());

      return stream;
    }
  }, {
    key: "group",
    value: function group(aggregation) {
      var _this3 = this;

      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

      var stream = _observable.default.create(
      /*#__PURE__*/
      function () {
        var _ref3 = (0, _asyncToGenerator2.default)(
        /*#__PURE__*/
        _regenerator.default.mark(function _callee3(observer) {
          var _getConfig3, apiProtocol, apiHost, _options$rawResponse3, rawResponse, timeout, properties, trace, skipBL, queryObject, url, request, response;

          return _regenerator.default.wrap(function _callee3$(_context3) {
            while (1) {
              switch (_context3.prev = _context3.next) {
                case 0:
                  _context3.prev = 0;

                  if (aggregation instanceof _aggregation.default) {
                    _context3.next = 3;
                    break;
                  }

                  throw new _kinvey.default('Invalid aggregation. It must be an instance of the Aggregation class.');

                case 3:
                  _getConfig3 = (0, _config.get)(), apiProtocol = _getConfig3.apiProtocol, apiHost = _getConfig3.apiHost;
                  _options$rawResponse3 = options.rawResponse, rawResponse = _options$rawResponse3 === void 0 ? false : _options$rawResponse3, timeout = options.timeout, properties = options.properties, trace = options.trace, skipBL = options.skipBL;
                  queryObject = {};
                  url = (0, _utils.formatKinveyUrl)(apiProtocol, apiHost, "".concat(_this3.pathname, "/_group"), queryObject);
                  request = createRequest(_request.RequestMethod.POST, url, aggregation.toPlainObject());
                  request.headers.customRequestProperties = properties;
                  request.timeout = timeout;
                  _context3.next = 12;
                  return request.execute();

                case 12:
                  response = _context3.sent;

                  if (rawResponse === true) {
                    observer.next(response);
                  } else {
                    observer.next(response.data);
                  }

                  observer.complete();
                  _context3.next = 20;
                  break;

                case 17:
                  _context3.prev = 17;
                  _context3.t0 = _context3["catch"](0);
                  observer.error(_context3.t0);

                case 20:
                case "end":
                  return _context3.stop();
              }
            }
          }, _callee3, this, [[0, 17]]);
        }));

        return function (_x3) {
          return _ref3.apply(this, arguments);
        };
      }());

      return stream;
    }
  }, {
    key: "findById",
    value: function findById(id) {
      var _this4 = this;

      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

      var stream = _observable.default.create(
      /*#__PURE__*/
      function () {
        var _ref4 = (0, _asyncToGenerator2.default)(
        /*#__PURE__*/
        _regenerator.default.mark(function _callee4(observer) {
          var _getConfig4, apiProtocol, apiHost, _options$rawResponse4, rawResponse, timeout, properties, trace, skipBL, kinveyFileTTL, kinveyFileTLS, queryObject, url, request, response;

          return _regenerator.default.wrap(function _callee4$(_context4) {
            while (1) {
              switch (_context4.prev = _context4.next) {
                case 0:
                  _context4.prev = 0;

                  if (!id) {
                    _context4.next = 15;
                    break;
                  }

                  _getConfig4 = (0, _config.get)(), apiProtocol = _getConfig4.apiProtocol, apiHost = _getConfig4.apiHost;
                  _options$rawResponse4 = options.rawResponse, rawResponse = _options$rawResponse4 === void 0 ? false : _options$rawResponse4, timeout = options.timeout, properties = options.properties, trace = options.trace, skipBL = options.skipBL, kinveyFileTTL = options.kinveyFileTTL, kinveyFileTLS = options.kinveyFileTLS;
                  queryObject = {
                    kinveyfile_ttl: kinveyFileTTL,
                    kinveyfile_tls: kinveyFileTLS
                  };
                  url = (0, _utils.formatKinveyUrl)(apiProtocol, apiHost, "".concat(_this4.pathname, "/").concat(id), queryObject);
                  request = createRequest(_request.RequestMethod.GET, url);
                  request.headers.customRequestProperties = properties;
                  request.timeout = timeout;
                  _context4.next = 11;
                  return request.execute();

                case 11:
                  response = _context4.sent;

                  if (rawResponse === true) {
                    observer.next(response);
                  } else {
                    observer.next(response.data);
                  }

                  _context4.next = 16;
                  break;

                case 15:
                  observer.next(undefined);

                case 16:
                  observer.complete();
                  _context4.next = 22;
                  break;

                case 19:
                  _context4.prev = 19;
                  _context4.t0 = _context4["catch"](0);
                  observer.error(_context4.t0);

                case 22:
                case "end":
                  return _context4.stop();
              }
            }
          }, _callee4, this, [[0, 19]]);
        }));

        return function (_x4) {
          return _ref4.apply(this, arguments);
        };
      }());

      return stream;
    }
  }, {
    key: "create",
    value: function () {
      var _create = (0, _asyncToGenerator2.default)(
      /*#__PURE__*/
      _regenerator.default.mark(function _callee5(doc) {
        var options,
            _getConfig5,
            apiProtocol,
            apiHost,
            _options$rawResponse5,
            rawResponse,
            timeout,
            properties,
            trace,
            skipBL,
            queryObject,
            url,
            request,
            response,
            _args5 = arguments;

        return _regenerator.default.wrap(function _callee5$(_context5) {
          while (1) {
            switch (_context5.prev = _context5.next) {
              case 0:
                options = _args5.length > 1 && _args5[1] !== undefined ? _args5[1] : {};

                if (!(0, _isArray.default)(doc)) {
                  _context5.next = 3;
                  break;
                }

                throw new _kinvey.default('Unable to create an array of entities.', 'Please create entities one by one.');

              case 3:
                _getConfig5 = (0, _config.get)(), apiProtocol = _getConfig5.apiProtocol, apiHost = _getConfig5.apiHost;
                _options$rawResponse5 = options.rawResponse, rawResponse = _options$rawResponse5 === void 0 ? false : _options$rawResponse5, timeout = options.timeout, properties = options.properties, trace = options.trace, skipBL = options.skipBL;
                queryObject = {};
                url = (0, _utils.formatKinveyUrl)(apiProtocol, apiHost, this.pathname, queryObject);
                request = createRequest(_request.RequestMethod.POST, url, doc);
                request.headers.customRequestProperties = properties;
                request.timeout = timeout;
                _context5.next = 12;
                return request.execute();

              case 12:
                response = _context5.sent;

                if (!(rawResponse === true)) {
                  _context5.next = 15;
                  break;
                }

                return _context5.abrupt("return", response);

              case 15:
                return _context5.abrupt("return", response.data);

              case 16:
              case "end":
                return _context5.stop();
            }
          }
        }, _callee5, this);
      }));

      function create(_x5) {
        return _create.apply(this, arguments);
      }

      return create;
    }()
  }, {
    key: "update",
    value: function () {
      var _update = (0, _asyncToGenerator2.default)(
      /*#__PURE__*/
      _regenerator.default.mark(function _callee6(doc) {
        var options,
            _getConfig6,
            apiProtocol,
            apiHost,
            _options$rawResponse6,
            rawResponse,
            timeout,
            properties,
            trace,
            skipBL,
            queryObject,
            url,
            request,
            response,
            _args6 = arguments;

        return _regenerator.default.wrap(function _callee6$(_context6) {
          while (1) {
            switch (_context6.prev = _context6.next) {
              case 0:
                options = _args6.length > 1 && _args6[1] !== undefined ? _args6[1] : {};

                if (!(0, _isArray.default)(doc)) {
                  _context6.next = 3;
                  break;
                }

                throw new _kinvey.default('Unable to update an array of entities.', 'Please update entities one by one.');

              case 3:
                if (doc._id) {
                  _context6.next = 5;
                  break;
                }

                throw new _kinvey.default('The entity provided does not contain an _id. An _id is required to update the entity.', doc);

              case 5:
                _getConfig6 = (0, _config.get)(), apiProtocol = _getConfig6.apiProtocol, apiHost = _getConfig6.apiHost;
                _options$rawResponse6 = options.rawResponse, rawResponse = _options$rawResponse6 === void 0 ? false : _options$rawResponse6, timeout = options.timeout, properties = options.properties, trace = options.trace, skipBL = options.skipBL;
                queryObject = {};
                url = (0, _utils.formatKinveyUrl)(apiProtocol, apiHost, "".concat(this.pathname, "/").concat(doc._id), queryObject);
                request = createRequest(_request.RequestMethod.PUT, url, doc);
                request.headers.customRequestProperties = properties;
                request.timeout = timeout;
                _context6.next = 14;
                return request.execute();

              case 14:
                response = _context6.sent;

                if (!(rawResponse === true)) {
                  _context6.next = 17;
                  break;
                }

                return _context6.abrupt("return", response);

              case 17:
                return _context6.abrupt("return", response.data);

              case 18:
              case "end":
                return _context6.stop();
            }
          }
        }, _callee6, this);
      }));

      function update(_x6) {
        return _update.apply(this, arguments);
      }

      return update;
    }()
  }, {
    key: "save",
    value: function save(doc, options) {
      if (doc._id) {
        return this.update(doc, options);
      }

      return this.create(doc, options);
    }
  }, {
    key: "remove",
    value: function () {
      var _remove = (0, _asyncToGenerator2.default)(
      /*#__PURE__*/
      _regenerator.default.mark(function _callee7(query) {
        var options,
            _getConfig7,
            apiProtocol,
            apiHost,
            _options$rawResponse7,
            rawResponse,
            timeout,
            properties,
            trace,
            skipBL,
            queryObject,
            url,
            request,
            response,
            _args7 = arguments;

        return _regenerator.default.wrap(function _callee7$(_context7) {
          while (1) {
            switch (_context7.prev = _context7.next) {
              case 0:
                options = _args7.length > 1 && _args7[1] !== undefined ? _args7[1] : {};

                if (!(query && !(query instanceof _query.default))) {
                  _context7.next = 3;
                  break;
                }

                throw new _kinvey.default('Invalid query. It must be an instance of the Query class.');

              case 3:
                _getConfig7 = (0, _config.get)(), apiProtocol = _getConfig7.apiProtocol, apiHost = _getConfig7.apiHost;
                _options$rawResponse7 = options.rawResponse, rawResponse = _options$rawResponse7 === void 0 ? false : _options$rawResponse7, timeout = options.timeout, properties = options.properties, trace = options.trace, skipBL = options.skipBL;
                queryObject = Object.assign({}, query ? query.toQueryObject() : {}, {});
                url = (0, _utils.formatKinveyUrl)(apiProtocol, apiHost, this.pathname, queryObject);
                request = createRequest(_request.RequestMethod.DELETE, url);
                request.headers.customRequestProperties = properties;
                request.timeout = timeout;
                _context7.next = 12;
                return request.execute();

              case 12:
                response = _context7.sent;

                if (!(rawResponse === true)) {
                  _context7.next = 15;
                  break;
                }

                return _context7.abrupt("return", response);

              case 15:
                return _context7.abrupt("return", response.data);

              case 16:
              case "end":
                return _context7.stop();
            }
          }
        }, _callee7, this);
      }));

      function remove(_x7) {
        return _remove.apply(this, arguments);
      }

      return remove;
    }()
  }, {
    key: "removeById",
    value: function () {
      var _removeById = (0, _asyncToGenerator2.default)(
      /*#__PURE__*/
      _regenerator.default.mark(function _callee8(id) {
        var options,
            _getConfig8,
            apiProtocol,
            apiHost,
            _options$rawResponse8,
            rawResponse,
            timeout,
            properties,
            trace,
            skipBL,
            queryObject,
            url,
            request,
            response,
            _args8 = arguments;

        return _regenerator.default.wrap(function _callee8$(_context8) {
          while (1) {
            switch (_context8.prev = _context8.next) {
              case 0:
                options = _args8.length > 1 && _args8[1] !== undefined ? _args8[1] : {};
                _getConfig8 = (0, _config.get)(), apiProtocol = _getConfig8.apiProtocol, apiHost = _getConfig8.apiHost;
                _options$rawResponse8 = options.rawResponse, rawResponse = _options$rawResponse8 === void 0 ? false : _options$rawResponse8, timeout = options.timeout, properties = options.properties, trace = options.trace, skipBL = options.skipBL;
                queryObject = {};
                url = (0, _utils.formatKinveyUrl)(apiProtocol, apiHost, "".concat(this.pathname, "/").concat(id), queryObject);
                request = createRequest(_request.RequestMethod.DELETE, url);
                request.headers.customRequestProperties = properties;
                request.timeout = timeout;
                _context8.next = 10;
                return request.execute();

              case 10:
                response = _context8.sent;

                if (!(rawResponse === true)) {
                  _context8.next = 13;
                  break;
                }

                return _context8.abrupt("return", response);

              case 13:
                return _context8.abrupt("return", response.data);

              case 14:
              case "end":
                return _context8.stop();
            }
          }
        }, _callee8, this);
      }));

      function removeById(_x8) {
        return _removeById.apply(this, arguments);
      }

      return removeById;
    }()
  }, {
    key: "subscribe",
    value: function () {
      var _subscribe = (0, _asyncToGenerator2.default)(
      /*#__PURE__*/
      _regenerator.default.mark(function _callee9(receiver) {
        var _getConfig9, apiProtocol, apiHost, deviceId, request;

        return _regenerator.default.wrap(function _callee9$(_context9) {
          while (1) {
            switch (_context9.prev = _context9.next) {
              case 0:
                if (Live.isRegistered()) {
                  _context9.next = 2;
                  break;
                }

                throw new _kinvey.default('Please call Kinvey.User.registerForLiveService() before you subscribe for to the collection.');

              case 2:
                _getConfig9 = (0, _config.get)(), apiProtocol = _getConfig9.apiProtocol, apiHost = _getConfig9.apiHost;
                deviceId = (0, _device.getId)();
                request = new _request.KinveyRequest({
                  method: _request.RequestMethod.POST,
                  auth: _auth.Auth.Session,
                  url: (0, _utils.formatKinveyUrl)(apiProtocol, apiHost, "".concat(this.pathname, "/_subscribe")),
                  body: {
                    deviceId: deviceId
                  }
                });
                _context9.next = 7;
                return request.execute();

              case 7:
                Live.subscribeToChannel(this.channelName, receiver);
                Live.subscribeToChannel(this.personalChannelName, receiver);
                return _context9.abrupt("return", this);

              case 10:
              case "end":
                return _context9.stop();
            }
          }
        }, _callee9, this);
      }));

      function subscribe(_x9) {
        return _subscribe.apply(this, arguments);
      }

      return subscribe;
    }()
  }, {
    key: "unsubscribe",
    value: function () {
      var _unsubscribe = (0, _asyncToGenerator2.default)(
      /*#__PURE__*/
      _regenerator.default.mark(function _callee10() {
        var _getConfig10, apiProtocol, apiHost, deviceId, request;

        return _regenerator.default.wrap(function _callee10$(_context10) {
          while (1) {
            switch (_context10.prev = _context10.next) {
              case 0:
                _getConfig10 = (0, _config.get)(), apiProtocol = _getConfig10.apiProtocol, apiHost = _getConfig10.apiHost;
                deviceId = (0, _device.getId)();
                request = new _request.KinveyRequest({
                  method: _request.RequestMethod.POST,
                  auth: _auth.Auth.Session,
                  url: (0, _utils.formatKinveyUrl)(apiProtocol, apiHost, "".concat(this.pathname, "/_unsubscribe")),
                  body: {
                    deviceId: deviceId
                  }
                });
                _context10.next = 5;
                return request.execute();

              case 5:
                Live.unsubscribeFromChannel(this.channelName);
                Live.unsubscribeFromChannel(this.personalChannelName);
                return _context10.abrupt("return", this);

              case 8:
              case "end":
                return _context10.stop();
            }
          }
        }, _callee10, this);
      }));

      function unsubscribe() {
        return _unsubscribe.apply(this, arguments);
      }

      return unsubscribe;
    }()
  }, {
    key: "collection",
    get: function get() {
      return this.collectionName;
    }
  }, {
    key: "pathname",
    get: function get() {
      var _getConfig11 = (0, _config.get)(),
          appKey = _getConfig11.appKey;

      return "/".concat(NAMESPACE, "/").concat(appKey, "/").concat(this.collectionName);
    }
  }, {
    key: "channelName",
    get: function get() {
      var _getConfig12 = (0, _config.get)(),
          appKey = _getConfig12.appKey;

      return "".concat(appKey, ".c-").concat(this.collectionName);
    }
  }, {
    key: "personalChannelName",
    get: function get() {
      var session = (0, _session.get)();
      return "".concat(this.channelName, ".u-").concat(session._id);
    }
  }]);
  return NetworkStore;
}();

exports.NetworkStore = NetworkStore;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/datastore/sync.js":
/*!*********************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/datastore/sync.js ***!
  \*********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.queryToSyncQuery = queryToSyncQuery;
exports.Sync = exports.SyncEvent = void 0;

var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js"));

var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));

var _createClass2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/createClass */ "./node_modules/@babel/runtime/helpers/createClass.js"));

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _defineProperty2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/defineProperty */ "./node_modules/@babel/runtime/helpers/defineProperty.js"));

var _query = _interopRequireDefault(__webpack_require__(/*! ../query */ "./packages/kinvey-html5-sdk/src/query.js"));

var _sync = _interopRequireDefault(__webpack_require__(/*! ../errors/sync */ "./packages/kinvey-html5-sdk/src/errors/sync.js"));

var _notFound = _interopRequireDefault(__webpack_require__(/*! ../errors/notFound */ "./packages/kinvey-html5-sdk/src/errors/notFound.js"));

var _networkstore = __webpack_require__(/*! ./networkstore */ "./packages/kinvey-html5-sdk/src/datastore/networkstore.js");

var _cache = __webpack_require__(/*! ./cache */ "./packages/kinvey-html5-sdk/src/datastore/cache.js");

var SYNC_CACHE_TAG = 'kinvey_sync';
var PUSH_IN_PROGRESS = {};

function markPushStart(collectionName) {
  PUSH_IN_PROGRESS[collectionName] = true;
}

function markPushEnd(collectionName) {
  PUSH_IN_PROGRESS[collectionName] = false;
}

function queryToSyncQuery(query, collectionName) {
  if (query && query instanceof _query.default) {
    var newFilter = Object.keys(query.filter).reduce(function (filter, field) {
      return Object.assign({}, filter, (0, _defineProperty2.default)({}, "entity.".concat(field), query.filter[field]));
    }, {});
    var newSort = Object.keys(query.sort).reduce(function (sort, field) {
      return Object.assign({}, sort, (0, _defineProperty2.default)({}, "entity.".concat(field), query.sort[field]));
    }, {});
    var syncQuery = new _query.default({
      filter: newFilter,
      sort: newSort,
      skip: query.skip,
      limit: query.limit
    });

    if (collectionName) {
      syncQuery.equalTo('collection', collectionName);
    }

    return syncQuery;
  }

  return null;
}

var SyncEvent = {
  Create: 'POST',
  Update: 'PUT',
  Delete: 'DELETE'
};
exports.SyncEvent = SyncEvent;

var SyncCache =
/*#__PURE__*/
function (_DataStoreCache) {
  (0, _inherits2.default)(SyncCache, _DataStoreCache);

  function SyncCache(tag) {
    (0, _classCallCheck2.default)(this, SyncCache);
    return (0, _possibleConstructorReturn2.default)(this, (0, _getPrototypeOf2.default)(SyncCache).call(this, SYNC_CACHE_TAG, tag));
  }

  return SyncCache;
}(_cache.DataStoreCache);

var Sync =
/*#__PURE__*/
function () {
  function Sync(collectionName, tag) {
    (0, _classCallCheck2.default)(this, Sync);
    this.collectionName = collectionName;
    this.tag = tag;
  }

  (0, _createClass2.default)(Sync, [{
    key: "isPushInProgress",
    value: function isPushInProgress() {
      return PUSH_IN_PROGRESS[this.collectionName] === true;
    }
  }, {
    key: "find",
    value: function find(query) {
      var syncCache = new SyncCache(this.tag);
      return syncCache.find(query);
    }
  }, {
    key: "findById",
    value: function findById(id) {
      var syncCache = new SyncCache(this.tag);
      return syncCache.findById(id);
    }
  }, {
    key: "count",
    value: function count(query) {
      var syncCache = new SyncCache(this.tag);
      return syncCache.count(query);
    }
  }, {
    key: "addCreateSyncEvent",
    value: function addCreateSyncEvent(docs) {
      return this.addSyncEvent(SyncEvent.Create, docs);
    }
  }, {
    key: "addUpdateSyncEvent",
    value: function addUpdateSyncEvent(docs) {
      return this.addSyncEvent(SyncEvent.Update, docs);
    }
  }, {
    key: "addDeleteSyncEvent",
    value: function addDeleteSyncEvent(docs) {
      return this.addSyncEvent(SyncEvent.Delete, docs);
    }
  }, {
    key: "addSyncEvent",
    value: function () {
      var _addSyncEvent = (0, _asyncToGenerator2.default)(
      /*#__PURE__*/
      _regenerator.default.mark(function _callee(event, docs) {
        var _this = this;

        var syncCache, singular, syncDocs, docsToSync, docWithNoId, query;
        return _regenerator.default.wrap(function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                syncCache = new SyncCache(this.tag);
                singular = false;
                syncDocs = [];
                docsToSync = docs;

                if (!Array.isArray(docs)) {
                  singular = true;
                  docsToSync = [docs];
                }

                if (!(docsToSync.length > 0)) {
                  _context.next = 16;
                  break;
                }

                docWithNoId = docsToSync.find(function (doc) {
                  return !doc._id;
                });

                if (!docWithNoId) {
                  _context.next = 9;
                  break;
                }

                throw new _sync.default('A doc is missing an _id. All docs must have an _id in order to be added to the sync collection.');

              case 9:
                // Remove existing sync events that match the docs
                query = new _query.default().contains('entityId', docsToSync.map(function (doc) {
                  return doc._id;
                }));
                _context.next = 12;
                return this.remove(query);

              case 12:
                // Don't add delete events for docs that were created offline
                if (event === SyncEvent.Delete) {
                  docsToSync = docsToSync.filter(function (doc) {
                    if (doc._kmd && doc._kmd.local === true) {
                      return false;
                    }

                    return true;
                  });
                } // Add sync events for the docs


                _context.next = 15;
                return syncCache.save(docsToSync.map(function (doc) {
                  return {
                    entityId: doc._id,
                    entity: doc,
                    collection: _this.collectionName,
                    state: {
                      operation: event
                    }
                  };
                }));

              case 15:
                syncDocs = _context.sent;

              case 16:
                return _context.abrupt("return", singular ? syncDocs.shift() : syncDocs);

              case 17:
              case "end":
                return _context.stop();
            }
          }
        }, _callee, this);
      }));

      function addSyncEvent(_x, _x2) {
        return _addSyncEvent.apply(this, arguments);
      }

      return addSyncEvent;
    }()
  }, {
    key: "push",
    value: function () {
      var _push = (0, _asyncToGenerator2.default)(
      /*#__PURE__*/
      _regenerator.default.mark(function _callee4(query, options) {
        var _this2 = this;

        var network, cache, syncCache, batchSize, syncDocs, i, batchPush;
        return _regenerator.default.wrap(function _callee4$(_context4) {
          while (1) {
            switch (_context4.prev = _context4.next) {
              case 0:
                network = new _networkstore.NetworkStore(this.collectionName);
                cache = new _cache.DataStoreCache(this.collectionName, this.tag);
                syncCache = new SyncCache(this.tag);

                if (!this.isPushInProgress()) {
                  _context4.next = 5;
                  break;
                }

                throw new _sync.default('Data is already being pushed to the backend. Please wait for it to complete before pushing new data to the backend.');

              case 5:
                batchSize = 100;
                _context4.next = 8;
                return syncCache.find(query);

              case 8:
                syncDocs = _context4.sent;

                if (!(syncDocs.length > 0)) {
                  _context4.next = 13;
                  break;
                }

                i = 0;

                batchPush =
                /*#__PURE__*/
                function () {
                  var _ref = (0, _asyncToGenerator2.default)(
                  /*#__PURE__*/
                  _regenerator.default.mark(function _callee3() {
                    var pushResults,
                        batch,
                        results,
                        _args3 = arguments;
                    return _regenerator.default.wrap(function _callee3$(_context3) {
                      while (1) {
                        switch (_context3.prev = _context3.next) {
                          case 0:
                            pushResults = _args3.length > 0 && _args3[0] !== undefined ? _args3[0] : [];
                            markPushStart(_this2.collectionName);

                            if (!(i >= syncDocs.length)) {
                              _context3.next = 5;
                              break;
                            }

                            markPushEnd(_this2.collectionName);
                            return _context3.abrupt("return", pushResults);

                          case 5:
                            batch = syncDocs.slice(i, i + batchSize);
                            i += batchSize;
                            _context3.next = 9;
                            return Promise.all(batch.map(
                            /*#__PURE__*/
                            function () {
                              var _ref2 = (0, _asyncToGenerator2.default)(
                              /*#__PURE__*/
                              _regenerator.default.mark(function _callee2(syncDoc) {
                                var _id, entityId, _syncDoc$state, state, event, doc, local;

                                return _regenerator.default.wrap(function _callee2$(_context2) {
                                  while (1) {
                                    switch (_context2.prev = _context2.next) {
                                      case 0:
                                        _id = syncDoc._id, entityId = syncDoc.entityId, _syncDoc$state = syncDoc.state, state = _syncDoc$state === void 0 ? {
                                          operation: undefined
                                        } : _syncDoc$state;
                                        event = state.operation;

                                        if (!(event === SyncEvent.Delete)) {
                                          _context2.next = 23;
                                          break;
                                        }

                                        _context2.prev = 3;
                                        _context2.prev = 4;
                                        _context2.next = 7;
                                        return network.removeById(entityId, options);

                                      case 7:
                                        _context2.next = 13;
                                        break;

                                      case 9:
                                        _context2.prev = 9;
                                        _context2.t0 = _context2["catch"](4);

                                        if (_context2.t0 instanceof _notFound.default) {
                                          _context2.next = 13;
                                          break;
                                        }

                                        throw _context2.t0;

                                      case 13:
                                        _context2.next = 15;
                                        return syncCache.removeById(_id);

                                      case 15:
                                        return _context2.abrupt("return", {
                                          _id: entityId,
                                          operation: event
                                        });

                                      case 18:
                                        _context2.prev = 18;
                                        _context2.t1 = _context2["catch"](3);
                                        return _context2.abrupt("return", {
                                          _id: entityId,
                                          operation: event,
                                          error: _context2.t1
                                        });

                                      case 21:
                                        _context2.next = 52;
                                        break;

                                      case 23:
                                        if (!(event === SyncEvent.Create || event === SyncEvent.Update)) {
                                          _context2.next = 52;
                                          break;
                                        }

                                        _context2.next = 26;
                                        return cache.findById(entityId);

                                      case 26:
                                        doc = _context2.sent;
                                        local = false;
                                        _context2.prev = 28;

                                        if (!(event === SyncEvent.Create)) {
                                          _context2.next = 36;
                                          break;
                                        }

                                        if (doc._kmd && doc._kmd.local === true) {
                                          local = true; // tslint:disable-next-line:no-delete

                                          delete doc._id; // tslint:disable-next-line:no-delete

                                          delete doc._kmd.local;
                                        }

                                        _context2.next = 33;
                                        return network.create(doc, options);

                                      case 33:
                                        doc = _context2.sent;
                                        _context2.next = 39;
                                        break;

                                      case 36:
                                        _context2.next = 38;
                                        return network.update(doc, options);

                                      case 38:
                                        doc = _context2.sent;

                                      case 39:
                                        _context2.next = 41;
                                        return syncCache.removeById(_id);

                                      case 41:
                                        _context2.next = 43;
                                        return cache.save(doc);

                                      case 43:
                                        if (!local) {
                                          _context2.next = 46;
                                          break;
                                        }

                                        _context2.next = 46;
                                        return cache.removeById(entityId);

                                      case 46:
                                        return _context2.abrupt("return", {
                                          _id: entityId,
                                          operation: event,
                                          entity: doc
                                        });

                                      case 49:
                                        _context2.prev = 49;
                                        _context2.t2 = _context2["catch"](28);
                                        return _context2.abrupt("return", {
                                          _id: entityId,
                                          operation: event,
                                          entity: doc,
                                          error: _context2.t2
                                        });

                                      case 52:
                                        return _context2.abrupt("return", {
                                          _id: _id,
                                          operation: event,
                                          error: new Error('Unable to push item in sync table because the event was not recognized.')
                                        });

                                      case 53:
                                      case "end":
                                        return _context2.stop();
                                    }
                                  }
                                }, _callee2, this, [[3, 18], [4, 9], [28, 49]]);
                              }));

                              return function (_x5) {
                                return _ref2.apply(this, arguments);
                              };
                            }()));

                          case 9:
                            results = _context3.sent;
                            markPushEnd(_this2.collectionName); // Push remaining docs

                            return _context3.abrupt("return", batchPush(pushResults.concat(results)));

                          case 12:
                          case "end":
                            return _context3.stop();
                        }
                      }
                    }, _callee3, this);
                  }));

                  return function batchPush() {
                    return _ref.apply(this, arguments);
                  };
                }();

                return _context4.abrupt("return", batchPush());

              case 13:
                return _context4.abrupt("return", []);

              case 14:
              case "end":
                return _context4.stop();
            }
          }
        }, _callee4, this);
      }));

      function push(_x3, _x4) {
        return _push.apply(this, arguments);
      }

      return push;
    }()
  }, {
    key: "remove",
    value: function () {
      var _remove = (0, _asyncToGenerator2.default)(
      /*#__PURE__*/
      _regenerator.default.mark(function _callee5(query) {
        var syncCache;
        return _regenerator.default.wrap(function _callee5$(_context5) {
          while (1) {
            switch (_context5.prev = _context5.next) {
              case 0:
                syncCache = new SyncCache(this.tag);
                return _context5.abrupt("return", syncCache.remove(query));

              case 2:
              case "end":
                return _context5.stop();
            }
          }
        }, _callee5, this);
      }));

      function remove(_x6) {
        return _remove.apply(this, arguments);
      }

      return remove;
    }()
  }, {
    key: "removeById",
    value: function () {
      var _removeById = (0, _asyncToGenerator2.default)(
      /*#__PURE__*/
      _regenerator.default.mark(function _callee6(id) {
        var syncCache;
        return _regenerator.default.wrap(function _callee6$(_context6) {
          while (1) {
            switch (_context6.prev = _context6.next) {
              case 0:
                syncCache = new SyncCache(this.tag);
                return _context6.abrupt("return", syncCache.removeById(id));

              case 2:
              case "end":
                return _context6.stop();
            }
          }
        }, _callee6, this);
      }));

      function removeById(_x7) {
        return _removeById.apply(this, arguments);
      }

      return removeById;
    }()
  }, {
    key: "clear",
    value: function () {
      var _clear = (0, _asyncToGenerator2.default)(
      /*#__PURE__*/
      _regenerator.default.mark(function _callee7() {
        var syncCache;
        return _regenerator.default.wrap(function _callee7$(_context7) {
          while (1) {
            switch (_context7.prev = _context7.next) {
              case 0:
                syncCache = new SyncCache(this.tag);
                return _context7.abrupt("return", syncCache.remove());

              case 2:
              case "end":
                return _context7.stop();
            }
          }
        }, _callee7, this);
      }));

      function clear() {
        return _clear.apply(this, arguments);
      }

      return clear;
    }()
  }]);
  return Sync;
}();

exports.Sync = Sync;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/endpoint.js":
/*!***************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/endpoint.js ***!
  \***************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = endpoint;

var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js"));

var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));

var _isString = _interopRequireDefault(__webpack_require__(/*! lodash/isString */ "./node_modules/lodash/isString.js"));

var _utils = __webpack_require__(/*! ./http/utils */ "./packages/kinvey-html5-sdk/src/http/utils.js");

var _request = __webpack_require__(/*! ./http/request */ "./packages/kinvey-html5-sdk/src/http/request.js");

var _auth = __webpack_require__(/*! ./http/auth */ "./packages/kinvey-html5-sdk/src/http/auth.js");

var _config = __webpack_require__(/*! ./kinvey/config */ "./packages/kinvey-html5-sdk/src/kinvey/config.js");

var _kinvey = _interopRequireDefault(__webpack_require__(/*! ./errors/kinvey */ "./packages/kinvey-html5-sdk/src/errors/kinvey.js"));

var RPC_NAMESPACE = 'rpc';

function endpoint(_x, _x2) {
  return _endpoint.apply(this, arguments);
}

function _endpoint() {
  _endpoint = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee(endpoint, args) {
    var options,
        _getConfig,
        apiProtocol,
        apiHost,
        appKey,
        request,
        response,
        _args = arguments;

    return _regenerator.default.wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            options = _args.length > 2 && _args[2] !== undefined ? _args[2] : {};

            if ((0, _isString.default)(endpoint)) {
              _context.next = 3;
              break;
            }

            throw new _kinvey.default('An endpoint is required and must be a string.');

          case 3:
            _getConfig = (0, _config.get)(), apiProtocol = _getConfig.apiProtocol, apiHost = _getConfig.apiHost, appKey = _getConfig.appKey;
            request = new _request.KinveyRequest({
              method: _request.RequestMethod.POST,
              auth: _auth.Auth.Session,
              url: (0, _utils.formatKinveyUrl)(apiProtocol, apiHost, "/".concat(RPC_NAMESPACE, "/").concat(appKey, "/custom/").concat(endpoint)),
              body: args,
              timeout: options.timeout
            });
            _context.next = 7;
            return request.execute();

          case 7:
            response = _context.sent;
            return _context.abrupt("return", response.data);

          case 9:
          case "end":
            return _context.stop();
        }
      }
    }, _callee, this);
  }));
  return _endpoint.apply(this, arguments);
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/errors/activeUser.js":
/*!************************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/errors/activeUser.js ***!
  \************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf3 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _assertThisInitialized2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js"));

var _base = _interopRequireDefault(__webpack_require__(/*! ./base */ "./packages/kinvey-html5-sdk/src/errors/base.js"));

var ActiveUserError =
/*#__PURE__*/
function (_BaseError) {
  (0, _inherits2.default)(ActiveUserError, _BaseError);

  function ActiveUserError() {
    var _getPrototypeOf2;

    var _this;

    var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'An active user already exists.';
    (0, _classCallCheck2.default)(this, ActiveUserError);

    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    // Pass remaining arguments (including vendor specific ones) to parent constructor
    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(ActiveUserError)).call.apply(_getPrototypeOf2, [this, message].concat(args))); // Maintains proper stack trace for where our error was thrown (only available on V8)

    if (Error.captureStackTrace) {
      Error.captureStackTrace((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), ActiveUserError);
    } // Custom debugging information


    _this.name = 'ActiveUserError';
    return _this;
  }

  return ActiveUserError;
}(_base.default);

exports.default = ActiveUserError;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/errors/apiVersionNotAvailable.js":
/*!************************************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/errors/apiVersionNotAvailable.js ***!
  \************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf3 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _assertThisInitialized2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js"));

var _base = _interopRequireDefault(__webpack_require__(/*! ./base */ "./packages/kinvey-html5-sdk/src/errors/base.js"));

var APIVersionNotAvailableError =
/*#__PURE__*/
function (_BaseError) {
  (0, _inherits2.default)(APIVersionNotAvailableError, _BaseError);

  function APIVersionNotAvailableError() {
    var _getPrototypeOf2;

    var _this;

    var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'This API version is not available for your app.';
    (0, _classCallCheck2.default)(this, APIVersionNotAvailableError);

    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    // Pass remaining arguments (including vendor specific ones) to parent constructor
    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(APIVersionNotAvailableError)).call.apply(_getPrototypeOf2, [this, message].concat(args))); // Maintains proper stack trace for where our error was thrown (only available on V8)

    if (Error.captureStackTrace) {
      Error.captureStackTrace((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), APIVersionNotAvailableError);
    } // Custom debugging information


    _this.name = 'APIVersionNotAvailableError';
    return _this;
  }

  return APIVersionNotAvailableError;
}(_base.default);

exports.default = APIVersionNotAvailableError;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/errors/apiVersionNotImplemented.js":
/*!**************************************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/errors/apiVersionNotImplemented.js ***!
  \**************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf3 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _assertThisInitialized2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js"));

var _base = _interopRequireDefault(__webpack_require__(/*! ./base */ "./packages/kinvey-html5-sdk/src/errors/base.js"));

var APIVersionNotImplementedError =
/*#__PURE__*/
function (_BaseError) {
  (0, _inherits2.default)(APIVersionNotImplementedError, _BaseError);

  function APIVersionNotImplementedError() {
    var _getPrototypeOf2;

    var _this;

    var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'This API version is not implemented.';
    (0, _classCallCheck2.default)(this, APIVersionNotImplementedError);

    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    // Pass remaining arguments (including vendor specific ones) to parent constructor
    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(APIVersionNotImplementedError)).call.apply(_getPrototypeOf2, [this, message].concat(args))); // Maintains proper stack trace for where our error was thrown (only available on V8)

    if (Error.captureStackTrace) {
      Error.captureStackTrace((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), APIVersionNotImplementedError);
    } // Custom debugging information


    _this.name = 'APIVersionNotImplementedError';
    return _this;
  }

  return APIVersionNotImplementedError;
}(_base.default);

exports.default = APIVersionNotImplementedError;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/errors/appProblem.js":
/*!************************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/errors/appProblem.js ***!
  \************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf3 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _assertThisInitialized2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js"));

var _base = _interopRequireDefault(__webpack_require__(/*! ./base */ "./packages/kinvey-html5-sdk/src/errors/base.js"));

var AppProblemError =
/*#__PURE__*/
function (_BaseError) {
  (0, _inherits2.default)(AppProblemError, _BaseError);

  function AppProblemError() {
    var _getPrototypeOf2;

    var _this;

    var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'There is a problem with this app backend that prevents execution of this operation. Please contact support@kinvey.com for assistance.';
    (0, _classCallCheck2.default)(this, AppProblemError);

    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    // Pass remaining arguments (including vendor specific ones) to parent constructor
    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(AppProblemError)).call.apply(_getPrototypeOf2, [this, message].concat(args))); // Maintains proper stack trace for where our error was thrown (only available on V8)

    if (Error.captureStackTrace) {
      Error.captureStackTrace((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), AppProblemError);
    } // Custom debugging information


    _this.name = 'AppProblemError';
    return _this;
  }

  return AppProblemError;
}(_base.default);

exports.default = AppProblemError;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/errors/badRequest.js":
/*!************************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/errors/badRequest.js ***!
  \************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf3 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _assertThisInitialized2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js"));

var _base = _interopRequireDefault(__webpack_require__(/*! ./base */ "./packages/kinvey-html5-sdk/src/errors/base.js"));

var BadRequestError =
/*#__PURE__*/
function (_BaseError) {
  (0, _inherits2.default)(BadRequestError, _BaseError);

  function BadRequestError() {
    var _getPrototypeOf2;

    var _this;

    var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'Unable to understand request.';
    (0, _classCallCheck2.default)(this, BadRequestError);

    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    // Pass remaining arguments (including vendor specific ones) to parent constructor
    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(BadRequestError)).call.apply(_getPrototypeOf2, [this, message].concat(args))); // Maintains proper stack trace for where our error was thrown (only available on V8)

    if (Error.captureStackTrace) {
      Error.captureStackTrace((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), BadRequestError);
    } // Custom debugging information


    _this.name = 'BadRequestError';
    return _this;
  }

  return BadRequestError;
}(_base.default);

exports.default = BadRequestError;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/errors/base.js":
/*!******************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/errors/base.js ***!
  \******************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf3 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _assertThisInitialized2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js"));

var _wrapNativeSuper2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/wrapNativeSuper */ "./node_modules/@babel/runtime/helpers/wrapNativeSuper.js"));

var BaseError =
/*#__PURE__*/
function (_Error) {
  (0, _inherits2.default)(BaseError, _Error);

  function BaseError() {
    var _getPrototypeOf2;

    var _this;

    var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'An error occurred.';
    var debug = arguments.length > 1 ? arguments[1] : undefined;
    var code = arguments.length > 2 ? arguments[2] : undefined;
    var kinveyRequestId = arguments.length > 3 ? arguments[3] : undefined;
    (0, _classCallCheck2.default)(this, BaseError);

    for (var _len = arguments.length, args = new Array(_len > 4 ? _len - 4 : 0), _key = 4; _key < _len; _key++) {
      args[_key - 4] = arguments[_key];
    }

    // Pass remaining arguments (including vendor specific ones) to parent constructor
    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(BaseError)).call.apply(_getPrototypeOf2, [this].concat(args))); // Maintains proper stack trace for where our error was thrown (only available on V8)

    if (Error.captureStackTrace) {
      Error.captureStackTrace((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), BaseError);
    } // Custom debugging information


    _this.name = 'BaseError';
    _this.message = message;
    _this.debug = debug;
    _this.code = code;
    _this.kinveyRequestId = kinveyRequestId;
    return _this;
  }

  return BaseError;
}((0, _wrapNativeSuper2.default)(Error));

exports.default = BaseError;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/errors/bl.js":
/*!****************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/errors/bl.js ***!
  \****************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf3 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _assertThisInitialized2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js"));

var _base = _interopRequireDefault(__webpack_require__(/*! ./base */ "./packages/kinvey-html5-sdk/src/errors/base.js"));

var BLError =
/*#__PURE__*/
function (_BaseError) {
  (0, _inherits2.default)(BLError, _BaseError);

  function BLError() {
    var _getPrototypeOf2;

    var _this;

    var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'The Business Logic script did not complete.';
    (0, _classCallCheck2.default)(this, BLError);

    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    // Pass remaining arguments (including vendor specific ones) to parent constructor
    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(BLError)).call.apply(_getPrototypeOf2, [this, message].concat(args))); // Maintains proper stack trace for where our error was thrown (only available on V8)

    if (Error.captureStackTrace) {
      Error.captureStackTrace((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), BLError);
    } // Custom debugging information


    _this.name = 'BLError';
    return _this;
  }

  return BLError;
}(_base.default);

exports.default = BLError;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/errors/corsDisabled.js":
/*!**************************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/errors/corsDisabled.js ***!
  \**************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf3 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _assertThisInitialized2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js"));

var _base = _interopRequireDefault(__webpack_require__(/*! ./base */ "./packages/kinvey-html5-sdk/src/errors/base.js"));

var CORSDisabledError =
/*#__PURE__*/
function (_BaseError) {
  (0, _inherits2.default)(CORSDisabledError, _BaseError);

  function CORSDisabledError() {
    var _getPrototypeOf2;

    var _this;

    var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'Cross Origin Support is disabled for this application.';
    (0, _classCallCheck2.default)(this, CORSDisabledError);

    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    // Pass remaining arguments (including vendor specific ones) to parent constructor
    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(CORSDisabledError)).call.apply(_getPrototypeOf2, [this, message].concat(args))); // Maintains proper stack trace for where our error was thrown (only available on V8)

    if (Error.captureStackTrace) {
      Error.captureStackTrace((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), CORSDisabledError);
    } // Custom debugging information


    _this.name = 'CORSDisabledError';
    return _this;
  }

  return CORSDisabledError;
}(_base.default);

exports.default = CORSDisabledError;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/errors/duplicateEndUsers.js":
/*!*******************************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/errors/duplicateEndUsers.js ***!
  \*******************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf3 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _assertThisInitialized2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js"));

var _base = _interopRequireDefault(__webpack_require__(/*! ./base */ "./packages/kinvey-html5-sdk/src/errors/base.js"));

var DuplicateEndUsersError =
/*#__PURE__*/
function (_BaseError) {
  (0, _inherits2.default)(DuplicateEndUsersError, _BaseError);

  function DuplicateEndUsersError() {
    var _getPrototypeOf2;

    var _this;

    var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'More than one user registered with this username for this application.';
    (0, _classCallCheck2.default)(this, DuplicateEndUsersError);

    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    // Pass remaining arguments (including vendor specific ones) to parent constructor
    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(DuplicateEndUsersError)).call.apply(_getPrototypeOf2, [this, message].concat(args))); // Maintains proper stack trace for where our error was thrown (only available on V8)

    if (Error.captureStackTrace) {
      Error.captureStackTrace((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), DuplicateEndUsersError);
    } // Custom debugging information


    _this.name = 'DuplicateEndUsersError';
    return _this;
  }

  return DuplicateEndUsersError;
}(_base.default);

exports.default = DuplicateEndUsersError;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/errors/featureUnavailable.js":
/*!********************************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/errors/featureUnavailable.js ***!
  \********************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf3 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _assertThisInitialized2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js"));

var _base = _interopRequireDefault(__webpack_require__(/*! ./base */ "./packages/kinvey-html5-sdk/src/errors/base.js"));

var FeatureUnavailableError =
/*#__PURE__*/
function (_BaseError) {
  (0, _inherits2.default)(FeatureUnavailableError, _BaseError);

  function FeatureUnavailableError() {
    var _getPrototypeOf2;

    var _this;

    var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'Requested functionality is unavailable in this API version.';
    (0, _classCallCheck2.default)(this, FeatureUnavailableError);

    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    // Pass remaining arguments (including vendor specific ones) to parent constructor
    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(FeatureUnavailableError)).call.apply(_getPrototypeOf2, [this, message].concat(args))); // Maintains proper stack trace for where our error was thrown (only available on V8)

    if (Error.captureStackTrace) {
      Error.captureStackTrace((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), FeatureUnavailableError);
    } // Custom debugging information


    _this.name = 'FeatureUnavailableError';
    return _this;
  }

  return FeatureUnavailableError;
}(_base.default);

exports.default = FeatureUnavailableError;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/errors/incompleteRequestBody.js":
/*!***********************************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/errors/incompleteRequestBody.js ***!
  \***********************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf3 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _assertThisInitialized2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js"));

var _base = _interopRequireDefault(__webpack_require__(/*! ./base */ "./packages/kinvey-html5-sdk/src/errors/base.js"));

var IncompleteRequestBodyError =
/*#__PURE__*/
function (_BaseError) {
  (0, _inherits2.default)(IncompleteRequestBodyError, _BaseError);

  function IncompleteRequestBodyError() {
    var _getPrototypeOf2;

    var _this;

    var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'The request body is either missing or incomplete.';
    (0, _classCallCheck2.default)(this, IncompleteRequestBodyError);

    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    // Pass remaining arguments (including vendor specific ones) to parent constructor
    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(IncompleteRequestBodyError)).call.apply(_getPrototypeOf2, [this, message].concat(args))); // Maintains proper stack trace for where our error was thrown (only available on V8)

    if (Error.captureStackTrace) {
      Error.captureStackTrace((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), IncompleteRequestBodyError);
    } // Custom debugging information


    _this.name = 'IncompleteRequestBodyError';
    return _this;
  }

  return IncompleteRequestBodyError;
}(_base.default);

exports.default = IncompleteRequestBodyError;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/errors/indirectCollectionAccessDisallowed.js":
/*!************************************************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/errors/indirectCollectionAccessDisallowed.js ***!
  \************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf3 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _assertThisInitialized2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js"));

var _base = _interopRequireDefault(__webpack_require__(/*! ./base */ "./packages/kinvey-html5-sdk/src/errors/base.js"));

var IndirectCollectionAccessDisallowedError =
/*#__PURE__*/
function (_BaseError) {
  (0, _inherits2.default)(IndirectCollectionAccessDisallowedError, _BaseError);

  function IndirectCollectionAccessDisallowedError() {
    var _getPrototypeOf2;

    var _this;

    var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'Please use the appropriate API to access this collection for this app backend.';
    (0, _classCallCheck2.default)(this, IndirectCollectionAccessDisallowedError);

    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    // Pass remaining arguments (including vendor specific ones) to parent constructor
    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(IndirectCollectionAccessDisallowedError)).call.apply(_getPrototypeOf2, [this, message].concat(args))); // Maintains proper stack trace for where our error was thrown (only available on V8)

    if (Error.captureStackTrace) {
      Error.captureStackTrace((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), IndirectCollectionAccessDisallowedError);
    } // Custom debugging information


    _this.name = 'IndirectCollectionAccessDisallowedError';
    return _this;
  }

  return IndirectCollectionAccessDisallowedError;
}(_base.default);

exports.default = IndirectCollectionAccessDisallowedError;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/errors/insufficientCredentials.js":
/*!*************************************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/errors/insufficientCredentials.js ***!
  \*************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf3 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _assertThisInitialized2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js"));

var _base = _interopRequireDefault(__webpack_require__(/*! ./base */ "./packages/kinvey-html5-sdk/src/errors/base.js"));

var InsufficientCredentialsError =
/*#__PURE__*/
function (_BaseError) {
  (0, _inherits2.default)(InsufficientCredentialsError, _BaseError);

  function InsufficientCredentialsError() {
    var _getPrototypeOf2;

    var _this;

    var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'The credentials used to authenticate this request are not authorized to run this operation. Please retry your request with appropriate credentials.';
    (0, _classCallCheck2.default)(this, InsufficientCredentialsError);

    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    // Pass remaining arguments (including vendor specific ones) to parent constructor
    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(InsufficientCredentialsError)).call.apply(_getPrototypeOf2, [this, message].concat(args))); // Maintains proper stack trace for where our error was thrown (only available on V8)

    if (Error.captureStackTrace) {
      Error.captureStackTrace((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), InsufficientCredentialsError);
    } // Custom debugging information


    _this.name = 'InsufficientCredentialsError';
    return _this;
  }

  return InsufficientCredentialsError;
}(_base.default);

exports.default = InsufficientCredentialsError;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/errors/invalidCredentials.js":
/*!********************************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/errors/invalidCredentials.js ***!
  \********************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf3 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _assertThisInitialized2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js"));

var _base = _interopRequireDefault(__webpack_require__(/*! ./base */ "./packages/kinvey-html5-sdk/src/errors/base.js"));

var InvalidCredentialsError =
/*#__PURE__*/
function (_BaseError) {
  (0, _inherits2.default)(InvalidCredentialsError, _BaseError);

  function InvalidCredentialsError() {
    var _getPrototypeOf2;

    var _this;

    var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'Invalid credentials. Please retry your request with correct credentials.';
    (0, _classCallCheck2.default)(this, InvalidCredentialsError);

    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    // Pass remaining arguments (including vendor specific ones) to parent constructor
    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(InvalidCredentialsError)).call.apply(_getPrototypeOf2, [this, message].concat(args))); // Maintains proper stack trace for where our error was thrown (only available on V8)

    if (Error.captureStackTrace) {
      Error.captureStackTrace((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), InvalidCredentialsError);
    } // Custom debugging information


    _this.name = 'InvalidCredentialsError';
    return _this;
  }

  return InvalidCredentialsError;
}(_base.default);

exports.default = InvalidCredentialsError;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/errors/invalidIdentifier.js":
/*!*******************************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/errors/invalidIdentifier.js ***!
  \*******************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf3 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _assertThisInitialized2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js"));

var _base = _interopRequireDefault(__webpack_require__(/*! ./base */ "./packages/kinvey-html5-sdk/src/errors/base.js"));

var InvalidIdentifierError =
/*#__PURE__*/
function (_BaseError) {
  (0, _inherits2.default)(InvalidIdentifierError, _BaseError);

  function InvalidIdentifierError() {
    var _getPrototypeOf2;

    var _this;

    var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'One of more identifier names in the request has an invalid format.';
    (0, _classCallCheck2.default)(this, InvalidIdentifierError);

    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    // Pass remaining arguments (including vendor specific ones) to parent constructor
    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(InvalidIdentifierError)).call.apply(_getPrototypeOf2, [this, message].concat(args))); // Maintains proper stack trace for where our error was thrown (only available on V8)

    if (Error.captureStackTrace) {
      Error.captureStackTrace((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), InvalidIdentifierError);
    } // Custom debugging information


    _this.name = 'InvalidIdentifierError';
    return _this;
  }

  return InvalidIdentifierError;
}(_base.default);

exports.default = InvalidIdentifierError;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/errors/invalidQuerySyntax.js":
/*!********************************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/errors/invalidQuerySyntax.js ***!
  \********************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf3 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _assertThisInitialized2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js"));

var _base = _interopRequireDefault(__webpack_require__(/*! ./base */ "./packages/kinvey-html5-sdk/src/errors/base.js"));

var InvalidQuerySyntaxError =
/*#__PURE__*/
function (_BaseError) {
  (0, _inherits2.default)(InvalidQuerySyntaxError, _BaseError);

  function InvalidQuerySyntaxError() {
    var _getPrototypeOf2;

    var _this;

    var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'The query string in the request has an invalid syntax.';
    (0, _classCallCheck2.default)(this, InvalidQuerySyntaxError);

    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    // Pass remaining arguments (including vendor specific ones) to parent constructor
    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(InvalidQuerySyntaxError)).call.apply(_getPrototypeOf2, [this, message].concat(args))); // Maintains proper stack trace for where our error was thrown (only available on V8)

    if (Error.captureStackTrace) {
      Error.captureStackTrace((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), InvalidQuerySyntaxError);
    } // Custom debugging information


    _this.name = 'InvalidQuerySyntaxError';
    return _this;
  }

  return InvalidQuerySyntaxError;
}(_base.default);

exports.default = InvalidQuerySyntaxError;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/errors/jsonParse.js":
/*!***********************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/errors/jsonParse.js ***!
  \***********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf3 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _assertThisInitialized2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js"));

var _base = _interopRequireDefault(__webpack_require__(/*! ./base */ "./packages/kinvey-html5-sdk/src/errors/base.js"));

var JSONParseError =
/*#__PURE__*/
function (_BaseError) {
  (0, _inherits2.default)(JSONParseError, _BaseError);

  function JSONParseError() {
    var _getPrototypeOf2;

    var _this;

    var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'Unable to parse the JSON in the request.';
    (0, _classCallCheck2.default)(this, JSONParseError);

    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    // Pass remaining arguments (including vendor specific ones) to parent constructor
    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(JSONParseError)).call.apply(_getPrototypeOf2, [this, message].concat(args))); // Maintains proper stack trace for where our error was thrown (only available on V8)

    if (Error.captureStackTrace) {
      Error.captureStackTrace((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), JSONParseError);
    } // Custom debugging information


    _this.name = 'JSONParseError';
    return _this;
  }

  return JSONParseError;
}(_base.default);

exports.default = JSONParseError;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/errors/kinvey.js":
/*!********************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/errors/kinvey.js ***!
  \********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf3 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _assertThisInitialized2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js"));

var _base = _interopRequireDefault(__webpack_require__(/*! ./base */ "./packages/kinvey-html5-sdk/src/errors/base.js"));

var KinveyError =
/*#__PURE__*/
function (_BaseError) {
  (0, _inherits2.default)(KinveyError, _BaseError);

  function KinveyError() {
    var _getPrototypeOf2;

    var _this;

    var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'An error occurred.';
    (0, _classCallCheck2.default)(this, KinveyError);

    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    // Pass remaining arguments (including vendor specific ones) to parent constructor
    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(KinveyError)).call.apply(_getPrototypeOf2, [this, message].concat(args))); // Maintains proper stack trace for where our error was thrown (only available on V8)

    if (Error.captureStackTrace) {
      Error.captureStackTrace((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), KinveyError);
    } // Custom debugging information


    _this.name = 'KinveyError';
    return _this;
  }

  return KinveyError;
}(_base.default);

exports.default = KinveyError;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/errors/kinveyInternalErrorRetry.js":
/*!**************************************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/errors/kinveyInternalErrorRetry.js ***!
  \**************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf3 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _assertThisInitialized2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js"));

var _base = _interopRequireDefault(__webpack_require__(/*! ./base */ "./packages/kinvey-html5-sdk/src/errors/base.js"));

var KinveyInternalErrorRetry =
/*#__PURE__*/
function (_BaseError) {
  (0, _inherits2.default)(KinveyInternalErrorRetry, _BaseError);

  function KinveyInternalErrorRetry() {
    var _getPrototypeOf2;

    var _this;

    var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'The Kinvey server encountered an unexpected error. Please retry your request.';
    (0, _classCallCheck2.default)(this, KinveyInternalErrorRetry);

    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    // Pass remaining arguments (including vendor specific ones) to parent constructor
    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(KinveyInternalErrorRetry)).call.apply(_getPrototypeOf2, [this, message].concat(args))); // Maintains proper stack trace for where our error was thrown (only available on V8)

    if (Error.captureStackTrace) {
      Error.captureStackTrace((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), KinveyInternalErrorRetry);
    } // Custom debugging information


    _this.name = 'KinveyInternalErrorRetry';
    return _this;
  }

  return KinveyInternalErrorRetry;
}(_base.default);

exports.default = KinveyInternalErrorRetry;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/errors/kinveyInternalErrorStop.js":
/*!*************************************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/errors/kinveyInternalErrorStop.js ***!
  \*************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf3 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _assertThisInitialized2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js"));

var _base = _interopRequireDefault(__webpack_require__(/*! ./base */ "./packages/kinvey-html5-sdk/src/errors/base.js"));

var KinveyInternalErrorStop =
/*#__PURE__*/
function (_BaseError) {
  (0, _inherits2.default)(KinveyInternalErrorStop, _BaseError);

  function KinveyInternalErrorStop() {
    var _getPrototypeOf2;

    var _this;

    var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'The Kinvey server encountered an unexpected error. Please contact support@kinvey.com for assistance.';
    (0, _classCallCheck2.default)(this, KinveyInternalErrorStop);

    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    // Pass remaining arguments (including vendor specific ones) to parent constructor
    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(KinveyInternalErrorStop)).call.apply(_getPrototypeOf2, [this, message].concat(args))); // Maintains proper stack trace for where our error was thrown (only available on V8)

    if (Error.captureStackTrace) {
      Error.captureStackTrace((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), KinveyInternalErrorStop);
    } // Custom debugging information


    _this.name = 'KinveyInternalErrorStop';
    return _this;
  }

  return KinveyInternalErrorStop;
}(_base.default);

exports.default = KinveyInternalErrorStop;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/errors/missingConfiguration.js":
/*!**********************************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/errors/missingConfiguration.js ***!
  \**********************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf3 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _assertThisInitialized2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js"));

var _base = _interopRequireDefault(__webpack_require__(/*! ./base */ "./packages/kinvey-html5-sdk/src/errors/base.js"));

var MissingConfigurationError =
/*#__PURE__*/
function (_BaseError) {
  (0, _inherits2.default)(MissingConfigurationError, _BaseError);

  function MissingConfigurationError() {
    var _getPrototypeOf2;

    var _this;

    var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'Missing configuration error.';
    (0, _classCallCheck2.default)(this, MissingConfigurationError);

    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    // Pass remaining arguments (including vendor specific ones) to parent constructor
    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(MissingConfigurationError)).call.apply(_getPrototypeOf2, [this, message].concat(args))); // Maintains proper stack trace for where our error was thrown (only available on V8)

    if (Error.captureStackTrace) {
      Error.captureStackTrace((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), MissingConfigurationError);
    } // Custom debugging information


    _this.name = 'MissingConfigurationError';
    return _this;
  }

  return MissingConfigurationError;
}(_base.default);

exports.default = MissingConfigurationError;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/errors/missingQuery.js":
/*!**************************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/errors/missingQuery.js ***!
  \**************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf3 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _assertThisInitialized2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js"));

var _base = _interopRequireDefault(__webpack_require__(/*! ./base */ "./packages/kinvey-html5-sdk/src/errors/base.js"));

var MissingQueryError =
/*#__PURE__*/
function (_BaseError) {
  (0, _inherits2.default)(MissingQueryError, _BaseError);

  function MissingQueryError() {
    var _getPrototypeOf2;

    var _this;

    var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'The request is missing a query string.';
    (0, _classCallCheck2.default)(this, MissingQueryError);

    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    // Pass remaining arguments (including vendor specific ones) to parent constructor
    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(MissingQueryError)).call.apply(_getPrototypeOf2, [this, message].concat(args))); // Maintains proper stack trace for where our error was thrown (only available on V8)

    if (Error.captureStackTrace) {
      Error.captureStackTrace((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), MissingQueryError);
    } // Custom debugging information


    _this.name = 'MissingQueryError';
    return _this;
  }

  return MissingQueryError;
}(_base.default);

exports.default = MissingQueryError;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/errors/missingRequestHeader.js":
/*!**********************************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/errors/missingRequestHeader.js ***!
  \**********************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf3 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _assertThisInitialized2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js"));

var _base = _interopRequireDefault(__webpack_require__(/*! ./base */ "./packages/kinvey-html5-sdk/src/errors/base.js"));

var MissingRequestHeaderError =
/*#__PURE__*/
function (_BaseError) {
  (0, _inherits2.default)(MissingRequestHeaderError, _BaseError);

  function MissingRequestHeaderError() {
    var _getPrototypeOf2;

    var _this;

    var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'The request is missing a required header.';
    (0, _classCallCheck2.default)(this, MissingRequestHeaderError);

    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    // Pass remaining arguments (including vendor specific ones) to parent constructor
    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(MissingRequestHeaderError)).call.apply(_getPrototypeOf2, [this, message].concat(args))); // Maintains proper stack trace for where our error was thrown (only available on V8)

    if (Error.captureStackTrace) {
      Error.captureStackTrace((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), MissingRequestHeaderError);
    } // Custom debugging information


    _this.name = 'MissingRequestHeaderError';
    return _this;
  }

  return MissingRequestHeaderError;
}(_base.default);

exports.default = MissingRequestHeaderError;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/errors/missingRequestParameter.js":
/*!*************************************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/errors/missingRequestParameter.js ***!
  \*************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf3 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _assertThisInitialized2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js"));

var _base = _interopRequireDefault(__webpack_require__(/*! ./base */ "./packages/kinvey-html5-sdk/src/errors/base.js"));

var MissingRequestParameterError =
/*#__PURE__*/
function (_BaseError) {
  (0, _inherits2.default)(MissingRequestParameterError, _BaseError);

  function MissingRequestParameterError() {
    var _getPrototypeOf2;

    var _this;

    var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'A required parameter is missing from the request.';
    (0, _classCallCheck2.default)(this, MissingRequestParameterError);

    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    // Pass remaining arguments (including vendor specific ones) to parent constructor
    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(MissingRequestParameterError)).call.apply(_getPrototypeOf2, [this, message].concat(args))); // Maintains proper stack trace for where our error was thrown (only available on V8)

    if (Error.captureStackTrace) {
      Error.captureStackTrace((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), MissingRequestParameterError);
    } // Custom debugging information


    _this.name = 'MissingRequestParameterError';
    return _this;
  }

  return MissingRequestParameterError;
}(_base.default);

exports.default = MissingRequestParameterError;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/errors/networkConnection.js":
/*!*******************************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/errors/networkConnection.js ***!
  \*******************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf3 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _assertThisInitialized2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js"));

var _base = _interopRequireDefault(__webpack_require__(/*! ./base */ "./packages/kinvey-html5-sdk/src/errors/base.js"));

var NetworkConnectionError =
/*#__PURE__*/
function (_BaseError) {
  (0, _inherits2.default)(NetworkConnectionError, _BaseError);

  function NetworkConnectionError() {
    var _getPrototypeOf2;

    var _this;

    var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'There was an error connecting to the network.';
    (0, _classCallCheck2.default)(this, NetworkConnectionError);

    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    // Pass remaining arguments (including vendor specific ones) to parent constructor
    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(NetworkConnectionError)).call.apply(_getPrototypeOf2, [this, message].concat(args))); // Maintains proper stack trace for where our error was thrown (only available on V8)

    if (Error.captureStackTrace) {
      Error.captureStackTrace((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), NetworkConnectionError);
    } // Custom debugging information


    _this.name = 'NetworkConnectionError';
    return _this;
  }

  return NetworkConnectionError;
}(_base.default);

exports.default = NetworkConnectionError;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/errors/notFound.js":
/*!**********************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/errors/notFound.js ***!
  \**********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf3 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _assertThisInitialized2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js"));

var _base = _interopRequireDefault(__webpack_require__(/*! ./base */ "./packages/kinvey-html5-sdk/src/errors/base.js"));

var NotFoundError =
/*#__PURE__*/
function (_BaseError) {
  (0, _inherits2.default)(NotFoundError, _BaseError);

  function NotFoundError() {
    var _getPrototypeOf2;

    var _this;

    var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'The entity was not found.';
    var debug = arguments.length > 1 ? arguments[1] : undefined;
    var code = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 404;
    (0, _classCallCheck2.default)(this, NotFoundError);

    for (var _len = arguments.length, args = new Array(_len > 3 ? _len - 3 : 0), _key = 3; _key < _len; _key++) {
      args[_key - 3] = arguments[_key];
    }

    // Pass remaining arguments (including vendor specific ones) to parent constructor
    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(NotFoundError)).call.apply(_getPrototypeOf2, [this, message, debug, code].concat(args))); // Maintains proper stack trace for where our error was thrown (only available on V8)

    if (Error.captureStackTrace) {
      Error.captureStackTrace((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), NotFoundError);
    } // Custom debugging information


    _this.name = 'NotFoundError';
    return _this;
  }

  return NotFoundError;
}(_base.default);

exports.default = NotFoundError;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/errors/parameterValueOutOfRange.js":
/*!**************************************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/errors/parameterValueOutOfRange.js ***!
  \**************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf3 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _assertThisInitialized2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js"));

var _base = _interopRequireDefault(__webpack_require__(/*! ./base */ "./packages/kinvey-html5-sdk/src/errors/base.js"));

var ParameterValueOutOfRangeError =
/*#__PURE__*/
function (_BaseError) {
  (0, _inherits2.default)(ParameterValueOutOfRangeError, _BaseError);

  function ParameterValueOutOfRangeError() {
    var _getPrototypeOf2;

    var _this;

    var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'The value specified for one of the request parameters is out of range.';
    (0, _classCallCheck2.default)(this, ParameterValueOutOfRangeError);

    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    // Pass remaining arguments (including vendor specific ones) to parent constructor
    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(ParameterValueOutOfRangeError)).call.apply(_getPrototypeOf2, [this, message].concat(args))); // Maintains proper stack trace for where our error was thrown (only available on V8)

    if (Error.captureStackTrace) {
      Error.captureStackTrace((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), ParameterValueOutOfRangeError);
    } // Custom debugging information


    _this.name = 'ParameterValueOutOfRangeError';
    return _this;
  }

  return ParameterValueOutOfRangeError;
}(_base.default);

exports.default = ParameterValueOutOfRangeError;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/errors/query.js":
/*!*******************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/errors/query.js ***!
  \*******************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf3 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _assertThisInitialized2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js"));

var _base = _interopRequireDefault(__webpack_require__(/*! ./base */ "./packages/kinvey-html5-sdk/src/errors/base.js"));

var QueryError =
/*#__PURE__*/
function (_BaseError) {
  (0, _inherits2.default)(QueryError, _BaseError);

  function QueryError() {
    var _getPrototypeOf2;

    var _this;

    var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'An error occurred with the query.';
    (0, _classCallCheck2.default)(this, QueryError);

    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    // Pass remaining arguments (including vendor specific ones) to parent constructor
    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(QueryError)).call.apply(_getPrototypeOf2, [this, message].concat(args))); // Maintains proper stack trace for where our error was thrown (only available on V8)

    if (Error.captureStackTrace) {
      Error.captureStackTrace((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), QueryError);
    } // Custom debugging information


    _this.name = 'QueryError';
    return _this;
  }

  return QueryError;
}(_base.default);

exports.default = QueryError;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/errors/resultSetSizeExceeded.js":
/*!***********************************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/errors/resultSetSizeExceeded.js ***!
  \***********************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf3 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _assertThisInitialized2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js"));

var _base = _interopRequireDefault(__webpack_require__(/*! ./base */ "./packages/kinvey-html5-sdk/src/errors/base.js"));

var ResultSetSizeExceededError =
/*#__PURE__*/
function (_BaseError) {
  (0, _inherits2.default)(ResultSetSizeExceededError, _BaseError);

  function ResultSetSizeExceededError() {
    var _getPrototypeOf2;

    var _this;

    var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'Result set size exceeded.';
    (0, _classCallCheck2.default)(this, ResultSetSizeExceededError);

    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    // Pass remaining arguments (including vendor specific ones) to parent constructor
    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(ResultSetSizeExceededError)).call.apply(_getPrototypeOf2, [this, message].concat(args))); // Maintains proper stack trace for where our error was thrown (only available on V8)

    if (Error.captureStackTrace) {
      Error.captureStackTrace((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), ResultSetSizeExceededError);
    } // Custom debugging information


    _this.name = 'ResultSetSizeExceededError';
    return _this;
  }

  return ResultSetSizeExceededError;
}(_base.default);

exports.default = ResultSetSizeExceededError;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/errors/server.js":
/*!********************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/errors/server.js ***!
  \********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf3 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _assertThisInitialized2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js"));

var _base = _interopRequireDefault(__webpack_require__(/*! ./base */ "./packages/kinvey-html5-sdk/src/errors/base.js"));

var ServerError =
/*#__PURE__*/
function (_BaseError) {
  (0, _inherits2.default)(ServerError, _BaseError);

  function ServerError() {
    var _getPrototypeOf2;

    var _this;

    var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'An error occurred on the server.';
    var debug = arguments.length > 1 ? arguments[1] : undefined;
    var code = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 500;
    (0, _classCallCheck2.default)(this, ServerError);

    for (var _len = arguments.length, args = new Array(_len > 3 ? _len - 3 : 0), _key = 3; _key < _len; _key++) {
      args[_key - 3] = arguments[_key];
    }

    // Pass remaining arguments (including vendor specific ones) to parent constructor
    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(ServerError)).call.apply(_getPrototypeOf2, [this, message, debug, code].concat(args))); // Maintains proper stack trace for where our error was thrown (only available on V8)

    if (Error.captureStackTrace) {
      Error.captureStackTrace((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), ServerError);
    } // Custom debugging information


    _this.name = 'ServerError';
    return _this;
  }

  return ServerError;
}(_base.default);

exports.default = ServerError;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/errors/staleRequest.js":
/*!**************************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/errors/staleRequest.js ***!
  \**************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf3 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _assertThisInitialized2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js"));

var _base = _interopRequireDefault(__webpack_require__(/*! ./base */ "./packages/kinvey-html5-sdk/src/errors/base.js"));

var StaleRequestError =
/*#__PURE__*/
function (_BaseError) {
  (0, _inherits2.default)(StaleRequestError, _BaseError);

  function StaleRequestError() {
    var _getPrototypeOf2;

    var _this;

    var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'The time window for this request has expired.';
    (0, _classCallCheck2.default)(this, StaleRequestError);

    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    // Pass remaining arguments (including vendor specific ones) to parent constructor
    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(StaleRequestError)).call.apply(_getPrototypeOf2, [this, message].concat(args))); // Maintains proper stack trace for where our error was thrown (only available on V8)

    if (Error.captureStackTrace) {
      Error.captureStackTrace((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), StaleRequestError);
    } // Custom debugging information


    _this.name = 'StaleRequestError';
    return _this;
  }

  return StaleRequestError;
}(_base.default);

exports.default = StaleRequestError;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/errors/sync.js":
/*!******************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/errors/sync.js ***!
  \******************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf3 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _assertThisInitialized2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js"));

var _base = _interopRequireDefault(__webpack_require__(/*! ./base */ "./packages/kinvey-html5-sdk/src/errors/base.js"));

var SyncError =
/*#__PURE__*/
function (_BaseError) {
  (0, _inherits2.default)(SyncError, _BaseError);

  function SyncError() {
    var _getPrototypeOf2;

    var _this;

    var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'An error occurred during sync.';
    (0, _classCallCheck2.default)(this, SyncError);

    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    // Pass remaining arguments (including vendor specific ones) to parent constructor
    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(SyncError)).call.apply(_getPrototypeOf2, [this, message].concat(args))); // Maintains proper stack trace for where our error was thrown (only available on V8)

    if (Error.captureStackTrace) {
      Error.captureStackTrace((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), SyncError);
    } // Custom debugging information


    _this.name = 'SyncError';
    return _this;
  }

  return SyncError;
}(_base.default);

exports.default = SyncError;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/errors/timeout.js":
/*!*********************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/errors/timeout.js ***!
  \*********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf3 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _assertThisInitialized2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js"));

var _base = _interopRequireDefault(__webpack_require__(/*! ./base */ "./packages/kinvey-html5-sdk/src/errors/base.js"));

var TimeoutError =
/*#__PURE__*/
function (_BaseError) {
  (0, _inherits2.default)(TimeoutError, _BaseError);

  function TimeoutError() {
    var _getPrototypeOf2;

    var _this;

    var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'The request timed out.';
    (0, _classCallCheck2.default)(this, TimeoutError);

    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    // Pass remaining arguments (including vendor specific ones) to parent constructor
    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(TimeoutError)).call.apply(_getPrototypeOf2, [this, message].concat(args))); // Maintains proper stack trace for where our error was thrown (only available on V8)

    if (Error.captureStackTrace) {
      Error.captureStackTrace((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), TimeoutError);
    } // Custom debugging information


    _this.name = 'TimeoutError';
    return _this;
  }

  return TimeoutError;
}(_base.default);

exports.default = TimeoutError;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/errors/userAlreadyExists.js":
/*!*******************************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/errors/userAlreadyExists.js ***!
  \*******************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf3 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _assertThisInitialized2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js"));

var _base = _interopRequireDefault(__webpack_require__(/*! ./base */ "./packages/kinvey-html5-sdk/src/errors/base.js"));

var UserAlreadyExistsError =
/*#__PURE__*/
function (_BaseError) {
  (0, _inherits2.default)(UserAlreadyExistsError, _BaseError);

  function UserAlreadyExistsError() {
    var _getPrototypeOf2;

    var _this;

    var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'This username is already taken. Please retry your request with a different username.';
    (0, _classCallCheck2.default)(this, UserAlreadyExistsError);

    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    // Pass remaining arguments (including vendor specific ones) to parent constructor
    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(UserAlreadyExistsError)).call.apply(_getPrototypeOf2, [this, message].concat(args))); // Maintains proper stack trace for where our error was thrown (only available on V8)

    if (Error.captureStackTrace) {
      Error.captureStackTrace((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), UserAlreadyExistsError);
    } // Custom debugging information


    _this.name = 'UserAlreadyExistsError';
    return _this;
  }

  return UserAlreadyExistsError;
}(_base.default);

exports.default = UserAlreadyExistsError;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/errors/writesToCollectionDisallowed.js":
/*!******************************************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/errors/writesToCollectionDisallowed.js ***!
  \******************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf3 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _assertThisInitialized2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/assertThisInitialized */ "./node_modules/@babel/runtime/helpers/assertThisInitialized.js"));

var _base = _interopRequireDefault(__webpack_require__(/*! ./base */ "./packages/kinvey-html5-sdk/src/errors/base.js"));

var WritesToCollectionDisallowedError =
/*#__PURE__*/
function (_BaseError) {
  (0, _inherits2.default)(WritesToCollectionDisallowedError, _BaseError);

  function WritesToCollectionDisallowedError() {
    var _getPrototypeOf2;

    var _this;

    var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'This collection is configured to disallow any modifications to an existing entity or creation of new entities.';
    (0, _classCallCheck2.default)(this, WritesToCollectionDisallowedError);

    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    // Pass remaining arguments (including vendor specific ones) to parent constructor
    _this = (0, _possibleConstructorReturn2.default)(this, (_getPrototypeOf2 = (0, _getPrototypeOf3.default)(WritesToCollectionDisallowedError)).call.apply(_getPrototypeOf2, [this, message].concat(args))); // Maintains proper stack trace for where our error was thrown (only available on V8)

    if (Error.captureStackTrace) {
      Error.captureStackTrace((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)), WritesToCollectionDisallowedError);
    } // Custom debugging information


    _this.name = 'WritesToCollectionDisallowedError';
    return _this;
  }

  return WritesToCollectionDisallowedError;
}(_base.default);

exports.default = WritesToCollectionDisallowedError;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/files/create.js":
/*!*******************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/files/create.js ***!
  \*******************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = create;

var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js"));

var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));

var _upload = _interopRequireDefault(__webpack_require__(/*! ./upload */ "./packages/kinvey-html5-sdk/src/files/upload.js"));

function create(_x, _x2, _x3) {
  return _create.apply(this, arguments);
}

function _create() {
  _create = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee(file, metadata, options) {
    return _regenerator.default.wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            return _context.abrupt("return", (0, _upload.default)(file, metadata, options));

          case 1:
          case "end":
            return _context.stop();
        }
      }
    }, _callee, this);
  }));
  return _create.apply(this, arguments);
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/files/download.js":
/*!*********************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/files/download.js ***!
  \*********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = download;

var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js"));

var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));

var _isNumber = _interopRequireDefault(__webpack_require__(/*! lodash/isNumber */ "./node_modules/lodash/isNumber.js"));

var _config = __webpack_require__(/*! ../kinvey/config */ "./packages/kinvey-html5-sdk/src/kinvey/config.js");

var _utils = __webpack_require__(/*! ../http/utils */ "./packages/kinvey-html5-sdk/src/http/utils.js");

var _request = __webpack_require__(/*! ../http/request */ "./packages/kinvey-html5-sdk/src/http/request.js");

var _auth = __webpack_require__(/*! ../http/auth */ "./packages/kinvey-html5-sdk/src/http/auth.js");

var _downloadByUrl = _interopRequireDefault(__webpack_require__(/*! ./downloadByUrl */ "./packages/kinvey-html5-sdk/src/files/downloadByUrl.js"));

var NAMESPACE = 'blob';

function download(_x) {
  return _download.apply(this, arguments);
}

function _download() {
  _download = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee(id) {
    var options,
        _getConfig,
        apiProtocol,
        apiHost,
        appKey,
        _options$stream,
        stream,
        _options$tls,
        tls,
        ttl,
        queryStringObject,
        request,
        response,
        file,
        _args = arguments;

    return _regenerator.default.wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            options = _args.length > 1 && _args[1] !== undefined ? _args[1] : {};
            _getConfig = (0, _config.get)(), apiProtocol = _getConfig.apiProtocol, apiHost = _getConfig.apiHost, appKey = _getConfig.appKey;
            _options$stream = options.stream, stream = _options$stream === void 0 ? false : _options$stream, _options$tls = options.tls, tls = _options$tls === void 0 ? true : _options$tls, ttl = options.ttl;
            queryStringObject = Object.assign({}, {
              tls: tls === true
            });

            if ((0, _isNumber.default)(ttl)) {
              queryStringObject.ttl_in_seconds = parseInt(ttl, 10);
            }

            request = new _request.KinveyRequest({
              method: _request.RequestMethod.GET,
              auth: _auth.Auth.Default,
              url: (0, _utils.formatKinveyUrl)(apiProtocol, apiHost, "/".concat(NAMESPACE, "/").concat(appKey, "/").concat(id), queryStringObject),
              timeout: options.timeout
            });
            _context.next = 8;
            return request.execute();

          case 8:
            response = _context.sent;
            file = response.data;

            if (!stream) {
              _context.next = 12;
              break;
            }

            return _context.abrupt("return", file);

          case 12:
            return _context.abrupt("return", (0, _downloadByUrl.default)(file._downloadURL, options));

          case 13:
          case "end":
            return _context.stop();
        }
      }
    }, _callee, this);
  }));
  return _download.apply(this, arguments);
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/files/downloadByUrl.js":
/*!**************************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/files/downloadByUrl.js ***!
  \**************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = downloadByUrl;

var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js"));

var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));

var _request = __webpack_require__(/*! ../http/request */ "./packages/kinvey-html5-sdk/src/http/request.js");

function downloadByUrl(_x) {
  return _downloadByUrl.apply(this, arguments);
}

function _downloadByUrl() {
  _downloadByUrl = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee(url) {
    var options,
        request,
        response,
        _args = arguments;
    return _regenerator.default.wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            options = _args.length > 1 && _args[1] !== undefined ? _args[1] : {};
            request = new _request.Request({
              method: _request.RequestMethod.GET,
              url: url,
              timeout: options.timeout
            });
            _context.next = 4;
            return request.execute();

          case 4:
            response = _context.sent;
            return _context.abrupt("return", response.data);

          case 6:
          case "end":
            return _context.stop();
        }
      }
    }, _callee, this);
  }));
  return _downloadByUrl.apply(this, arguments);
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/files/find.js":
/*!*****************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/files/find.js ***!
  \*****************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = find;

var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js"));

var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));

var _isNumber = _interopRequireDefault(__webpack_require__(/*! lodash/isNumber */ "./node_modules/lodash/isNumber.js"));

var _config = __webpack_require__(/*! ../kinvey/config */ "./packages/kinvey-html5-sdk/src/kinvey/config.js");

var _query = _interopRequireDefault(__webpack_require__(/*! ../query */ "./packages/kinvey-html5-sdk/src/query.js"));

var _kinvey = _interopRequireDefault(__webpack_require__(/*! ../errors/kinvey */ "./packages/kinvey-html5-sdk/src/errors/kinvey.js"));

var _utils = __webpack_require__(/*! ../http/utils */ "./packages/kinvey-html5-sdk/src/http/utils.js");

var _request = __webpack_require__(/*! ../http/request */ "./packages/kinvey-html5-sdk/src/http/request.js");

var _auth = __webpack_require__(/*! ../http/auth */ "./packages/kinvey-html5-sdk/src/http/auth.js");

var _downloadByUrl = _interopRequireDefault(__webpack_require__(/*! ./downloadByUrl */ "./packages/kinvey-html5-sdk/src/files/downloadByUrl.js"));

var NAMESPACE = 'blob';

function find() {
  return _find.apply(this, arguments);
}

function _find() {
  _find = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee() {
    var query,
        options,
        _getConfig,
        apiProtocol,
        apiHost,
        appKey,
        _options$download,
        download,
        _options$tls,
        tls,
        ttl,
        queryStringObject,
        request,
        response,
        files,
        _args = arguments;

    return _regenerator.default.wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            query = _args.length > 0 && _args[0] !== undefined ? _args[0] : new _query.default();
            options = _args.length > 1 && _args[1] !== undefined ? _args[1] : {};
            _getConfig = (0, _config.get)(), apiProtocol = _getConfig.apiProtocol, apiHost = _getConfig.apiHost, appKey = _getConfig.appKey;
            _options$download = options.download, download = _options$download === void 0 ? false : _options$download, _options$tls = options.tls, tls = _options$tls === void 0 ? true : _options$tls, ttl = options.ttl;
            queryStringObject = Object.assign({}, {
              tls: tls === true
            });

            if (!query) {
              _context.next = 9;
              break;
            }

            if (query instanceof _query.default) {
              _context.next = 8;
              break;
            }

            throw new _kinvey.default('Invalid query. It must be an instance of the Query class.');

          case 8:
            queryStringObject = Object.assign({}, queryStringObject, query.toQueryObject());

          case 9:
            if ((0, _isNumber.default)(ttl)) {
              queryStringObject.ttl_in_seconds = parseInt(ttl, 10);
            }

            request = new _request.KinveyRequest({
              method: _request.RequestMethod.GET,
              auth: _auth.Auth.Default,
              url: (0, _utils.formatKinveyUrl)(apiProtocol, apiHost, "/".concat(NAMESPACE, "/").concat(appKey), queryStringObject),
              timeout: options.timeout
            });
            _context.next = 13;
            return request.execute();

          case 13:
            response = _context.sent;
            files = response.data;

            if (!(download === true)) {
              _context.next = 17;
              break;
            }

            return _context.abrupt("return", Promise.all(files.map(function (file) {
              return (0, _downloadByUrl.default)(file._downloadURL, options);
            })));

          case 17:
            return _context.abrupt("return", files);

          case 18:
          case "end":
            return _context.stop();
        }
      }
    }, _callee, this);
  }));
  return _find.apply(this, arguments);
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/files/findById.js":
/*!*********************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/files/findById.js ***!
  \*********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = findById;

var _download = _interopRequireDefault(__webpack_require__(/*! ./download */ "./packages/kinvey-html5-sdk/src/files/download.js"));

function findById(id, options) {
  return (0, _download.default)(id, options);
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/files/index.js":
/*!******************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/files/index.js ***!
  \******************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
Object.defineProperty(exports, "create", {
  enumerable: true,
  get: function get() {
    return _create.default;
  }
});
Object.defineProperty(exports, "download", {
  enumerable: true,
  get: function get() {
    return _download.default;
  }
});
Object.defineProperty(exports, "downloadByUrl", {
  enumerable: true,
  get: function get() {
    return _downloadByUrl.default;
  }
});
Object.defineProperty(exports, "find", {
  enumerable: true,
  get: function get() {
    return _find.default;
  }
});
Object.defineProperty(exports, "findById", {
  enumerable: true,
  get: function get() {
    return _findById.default;
  }
});
Object.defineProperty(exports, "remove", {
  enumerable: true,
  get: function get() {
    return _remove.default;
  }
});
Object.defineProperty(exports, "removeById", {
  enumerable: true,
  get: function get() {
    return _removeById.default;
  }
});
Object.defineProperty(exports, "stream", {
  enumerable: true,
  get: function get() {
    return _stream.default;
  }
});
Object.defineProperty(exports, "update", {
  enumerable: true,
  get: function get() {
    return _update.default;
  }
});
Object.defineProperty(exports, "upload", {
  enumerable: true,
  get: function get() {
    return _upload.default;
  }
});

var _create = _interopRequireDefault(__webpack_require__(/*! ./create */ "./packages/kinvey-html5-sdk/src/files/create.js"));

var _download = _interopRequireDefault(__webpack_require__(/*! ./download */ "./packages/kinvey-html5-sdk/src/files/download.js"));

var _downloadByUrl = _interopRequireDefault(__webpack_require__(/*! ./downloadByUrl */ "./packages/kinvey-html5-sdk/src/files/downloadByUrl.js"));

var _find = _interopRequireDefault(__webpack_require__(/*! ./find */ "./packages/kinvey-html5-sdk/src/files/find.js"));

var _findById = _interopRequireDefault(__webpack_require__(/*! ./findById */ "./packages/kinvey-html5-sdk/src/files/findById.js"));

var _remove = _interopRequireDefault(__webpack_require__(/*! ./remove */ "./packages/kinvey-html5-sdk/src/files/remove.js"));

var _removeById = _interopRequireDefault(__webpack_require__(/*! ./removeById */ "./packages/kinvey-html5-sdk/src/files/removeById.js"));

var _stream = _interopRequireDefault(__webpack_require__(/*! ./stream */ "./packages/kinvey-html5-sdk/src/files/stream.js"));

var _update = _interopRequireDefault(__webpack_require__(/*! ./update */ "./packages/kinvey-html5-sdk/src/files/update.js"));

var _upload = _interopRequireDefault(__webpack_require__(/*! ./upload */ "./packages/kinvey-html5-sdk/src/files/upload.js"));

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/files/remove.js":
/*!*******************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/files/remove.js ***!
  \*******************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = remove;

var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js"));

var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));

var _kinvey = _interopRequireDefault(__webpack_require__(/*! ../errors/kinvey */ "./packages/kinvey-html5-sdk/src/errors/kinvey.js"));

function remove() {
  return _remove.apply(this, arguments);
}

function _remove() {
  _remove = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee() {
    return _regenerator.default.wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            throw new _kinvey.default('Please use removeById() to remove files one by one.');

          case 1:
          case "end":
            return _context.stop();
        }
      }
    }, _callee, this);
  }));
  return _remove.apply(this, arguments);
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/files/removeById.js":
/*!***********************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/files/removeById.js ***!
  \***********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = removeById;

var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js"));

var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));

var _utils = __webpack_require__(/*! ../http/utils */ "./packages/kinvey-html5-sdk/src/http/utils.js");

var _request = __webpack_require__(/*! ../http/request */ "./packages/kinvey-html5-sdk/src/http/request.js");

var _auth = __webpack_require__(/*! ../http/auth */ "./packages/kinvey-html5-sdk/src/http/auth.js");

var _config = __webpack_require__(/*! ../kinvey/config */ "./packages/kinvey-html5-sdk/src/kinvey/config.js");

var NAMESPACE = 'blob';

function removeById(_x) {
  return _removeById.apply(this, arguments);
}

function _removeById() {
  _removeById = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee(id) {
    var options,
        _getConfig,
        apiProtocol,
        apiHost,
        appKey,
        request,
        response,
        _args = arguments;

    return _regenerator.default.wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            options = _args.length > 1 && _args[1] !== undefined ? _args[1] : {};
            _getConfig = (0, _config.get)(), apiProtocol = _getConfig.apiProtocol, apiHost = _getConfig.apiHost, appKey = _getConfig.appKey;
            request = new _request.KinveyRequest({
              method: _request.RequestMethod.DELETE,
              auth: _auth.Auth.Default,
              url: (0, _utils.formatKinveyUrl)(apiProtocol, apiHost, "/".concat(NAMESPACE, "/").concat(appKey, "/").concat(id)),
              timeout: options.timeout
            });
            _context.next = 5;
            return request.execute();

          case 5:
            response = _context.sent;
            return _context.abrupt("return", response.data);

          case 7:
          case "end":
            return _context.stop();
        }
      }
    }, _callee, this);
  }));
  return _removeById.apply(this, arguments);
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/files/stream.js":
/*!*******************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/files/stream.js ***!
  \*******************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = stream;

var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js"));

var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));

var _findById = _interopRequireDefault(__webpack_require__(/*! ./findById */ "./packages/kinvey-html5-sdk/src/files/findById.js"));

function stream(_x, _x2) {
  return _stream.apply(this, arguments);
}

function _stream() {
  _stream = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee(id, options) {
    return _regenerator.default.wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            return _context.abrupt("return", (0, _findById.default)(id, Object.assign({}, options, {
              stream: true
            })));

          case 1:
          case "end":
            return _context.stop();
        }
      }
    }, _callee, this);
  }));
  return _stream.apply(this, arguments);
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/files/update.js":
/*!*******************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/files/update.js ***!
  \*******************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = update;

var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js"));

var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));

var _upload = _interopRequireDefault(__webpack_require__(/*! ./upload */ "./packages/kinvey-html5-sdk/src/files/upload.js"));

function update(_x, _x2, _x3) {
  return _update.apply(this, arguments);
}

function _update() {
  _update = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee(file, metadata, options) {
    return _regenerator.default.wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            return _context.abrupt("return", (0, _upload.default)(file, metadata, options));

          case 1:
          case "end":
            return _context.stop();
        }
      }
    }, _callee, this);
  }));
  return _update.apply(this, arguments);
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/files/upload.js":
/*!*******************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/files/upload.js ***!
  \*******************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = upload;

var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js"));

var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));

var _utils = __webpack_require__(/*! ../http/utils */ "./packages/kinvey-html5-sdk/src/http/utils.js");

var _request = __webpack_require__(/*! ../http/request */ "./packages/kinvey-html5-sdk/src/http/request.js");

var _auth = __webpack_require__(/*! ../http/auth */ "./packages/kinvey-html5-sdk/src/http/auth.js");

var _headers = __webpack_require__(/*! ../http/headers */ "./packages/kinvey-html5-sdk/src/http/headers.js");

var _config = __webpack_require__(/*! ../kinvey/config */ "./packages/kinvey-html5-sdk/src/kinvey/config.js");

var _kinvey = _interopRequireDefault(__webpack_require__(/*! ../errors/kinvey */ "./packages/kinvey-html5-sdk/src/errors/kinvey.js"));

var NAMESPACE = 'blob';
var MAX_BACKOFF = 32 * 1000;

function transformMetadata() {
  var file = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
  var metadata = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
  var fileMetadata = Object.assign({}, {
    filename: file._filename || file.name,
    public: false,
    size: file.size || file.length,
    mimeType: file.mimeType || file.type || 'application/octet-stream'
  }, metadata);
  fileMetadata._filename = metadata.filename;
  delete fileMetadata.filename;
  fileMetadata._public = metadata.public;
  delete fileMetadata.public;
  return fileMetadata;
}

function saveFileMetadata(_x) {
  return _saveFileMetadata.apply(this, arguments);
}

function _saveFileMetadata() {
  _saveFileMetadata = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee(metadata) {
    var options,
        _getConfig,
        apiProtocol,
        apiHost,
        appKey,
        request,
        response,
        _args = arguments;

    return _regenerator.default.wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            options = _args.length > 1 && _args[1] !== undefined ? _args[1] : {};
            _getConfig = (0, _config.get)(), apiProtocol = _getConfig.apiProtocol, apiHost = _getConfig.apiHost, appKey = _getConfig.appKey;

            if (!(metadata.size <= 0)) {
              _context.next = 4;
              break;
            }

            throw new _kinvey.default('Unable to create a file with a size of 0.');

          case 4:
            request = new _request.KinveyRequest({
              method: metadata._id ? _request.RequestMethod.PUT : _request.RequestMethod.POST,
              headers: {
                'X-Kinvey-Content-Type': metadata.mimeType
              },
              auth: _auth.Auth.Default,
              url: metadata._id ? (0, _utils.formatKinveyUrl)(apiProtocol, apiHost, "/".concat(NAMESPACE, "/").concat(appKey, "/").concat(metadata._id)) : (0, _utils.formatKinveyUrl)(apiProtocol, apiHost, "/".concat(NAMESPACE, "/").concat(appKey)),
              body: metadata,
              timeout: options.timeout
            });
            _context.next = 7;
            return request.execute();

          case 7:
            response = _context.sent;
            return _context.abrupt("return", response.data);

          case 9:
          case "end":
            return _context.stop();
        }
      }
    }, _callee, this);
  }));
  return _saveFileMetadata.apply(this, arguments);
}

function checkUploadStatus(url, headers, metadata, timeout) {
  var requestHeaders = new _headers.Headers(headers);
  requestHeaders.set('Content-Type', metadata.mimeType);
  requestHeaders.set('Content-Range', "bytes */".concat(metadata.size));
  var request = new _request.Request({
    method: _request.RequestMethod.PUT,
    headers: requestHeaders,
    url: url,
    timeout: timeout
  });
  return request.execute();
}

function getStartIndex(rangeHeader, max) {
  var start = rangeHeader ? parseInt(rangeHeader.split('-')[1], 10) + 1 : 0;
  return start >= max ? max - 1 : start;
}

function randomInt(min, max) {
  return Math.floor(Math.random() * (max - min)) + min;
}

function uploadFile(_x2, _x3, _x4) {
  return _uploadFile.apply(this, arguments);
}

function _uploadFile() {
  _uploadFile = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee2(url, file, metadata) {
    var options,
        _options$count,
        count,
        _options$maxBackoff,
        maxBackoff,
        _options$start,
        start,
        requestHeaders,
        request,
        response,
        backoff,
        _args2 = arguments;

    return _regenerator.default.wrap(function _callee2$(_context2) {
      while (1) {
        switch (_context2.prev = _context2.next) {
          case 0:
            options = _args2.length > 3 && _args2[3] !== undefined ? _args2[3] : {};
            _options$count = options.count, count = _options$count === void 0 ? 0 : _options$count, _options$maxBackoff = options.maxBackoff, maxBackoff = _options$maxBackoff === void 0 ? MAX_BACKOFF : _options$maxBackoff;
            _options$start = options.start, start = _options$start === void 0 ? 0 : _options$start;
            requestHeaders = new _headers.Headers(options.headers);
            requestHeaders.set('Content-Type', metadata.mimeType);
            requestHeaders.set('Content-Range', "bytes ".concat(options.start, "-").concat(metadata.size - 1, "/").concat(metadata.size));
            request = new _request.Request({
              method: _request.RequestMethod.PUT,
              headers: requestHeaders,
              url: url,
              body: file.slice(options.start, metadata.size),
              timeout: options.timeout
            });
            _context2.next = 9;
            return request.execute();

          case 9:
            response = _context2.sent;

            if (response.isSuccess()) {
              _context2.next = 18;
              break;
            }

            if (!(response.statusCode >= 500 && response.statusCode < 600)) {
              _context2.next = 17;
              break;
            }

            backoff = Math.pow(2, options.count) + randomInt(1, 1001); // Calculate the exponential backoff

            if (!(backoff < options.maxBackoff)) {
              _context2.next = 17;
              break;
            }

            _context2.next = 16;
            return new Promise(function (resolve) {
              setTimeout(resolve, backoff);
            });

          case 16:
            return _context2.abrupt("return", uploadFile(url, file, metadata, {
              count: count + 1,
              start: start,
              maxBackoff: maxBackoff
            }));

          case 17:
            throw response.error;

          case 18:
            if (!(response.statusCode === 308)) {
              _context2.next = 21;
              break;
            }

            start = getStartIndex(response.headers.get('Range'), metadata.size);
            return _context2.abrupt("return", uploadFile(url, file, metadata, {
              count: 0,
              start: start,
              maxBackoff: maxBackoff
            }));

          case 21:
            return _context2.abrupt("return", response.data);

          case 22:
          case "end":
            return _context2.stop();
        }
      }
    }, _callee2, this);
  }));
  return _uploadFile.apply(this, arguments);
}

function upload() {
  return _upload.apply(this, arguments);
}

function _upload() {
  _upload = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee3() {
    var file,
        metadata,
        options,
        fileMetadata,
        kinveyFile,
        uploadStatusResponse,
        uploadOptions,
        _args3 = arguments;
    return _regenerator.default.wrap(function _callee3$(_context3) {
      while (1) {
        switch (_context3.prev = _context3.next) {
          case 0:
            file = _args3.length > 0 && _args3[0] !== undefined ? _args3[0] : {};
            metadata = _args3.length > 1 && _args3[1] !== undefined ? _args3[1] : {};
            options = _args3.length > 2 && _args3[2] !== undefined ? _args3[2] : {};
            fileMetadata = transformMetadata(file, metadata);
            _context3.next = 6;
            return saveFileMetadata(fileMetadata, options);

          case 6:
            kinveyFile = _context3.sent;
            _context3.next = 9;
            return checkUploadStatus(kinveyFile._uploadURL, kinveyFile._requiredHeaders, fileMetadata, options.timeout);

          case 9:
            uploadStatusResponse = _context3.sent;

            if (uploadStatusResponse.isSuccess()) {
              _context3.next = 12;
              break;
            }

            throw uploadStatusResponse.error;

          case 12:
            if (!(uploadStatusResponse.statusCode !== 200 && uploadStatusResponse.statusCode !== 201)) {
              _context3.next = 18;
              break;
            }

            if (!(uploadStatusResponse.statusCode !== 308)) {
              _context3.next = 15;
              break;
            }

            throw new _kinvey.default('Unexpected response for upload file status check request.');

          case 15:
            uploadOptions = {
              start: getStartIndex(uploadStatusResponse.headers.get('Range'), metadata.size),
              timeout: options.timeout,
              maxBackoff: options.maxBackoff,
              headers: kinveyFile._requiredHeaders
            };
            _context3.next = 18;
            return uploadFile(kinveyFile._uploadURL, file, fileMetadata, uploadOptions);

          case 18:
            delete kinveyFile._expiresAt;
            delete kinveyFile._requiredHeaders;
            delete kinveyFile._uploadURL;
            kinveyFile._data = file;
            return _context3.abrupt("return", kinveyFile);

          case 23:
          case "end":
            return _context3.stop();
        }
      }
    }, _callee3, this);
  }));
  return _upload.apply(this, arguments);
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/http/auth.js":
/*!****************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/http/auth.js ***!
  \****************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.app = app;
exports.master = master;
exports.session = session;
exports.basic = basic;
exports.defaultAuth = defaultAuth;
exports.all = all;
exports.Auth = void 0;

var _jsBase = __webpack_require__(/*! js-base64 */ "./node_modules/js-base64/base64.js");

var _activeUser = _interopRequireDefault(__webpack_require__(/*! ../errors/activeUser */ "./packages/kinvey-html5-sdk/src/errors/activeUser.js"));

function app(appKey, appSecret) {
  var credentials = _jsBase.Base64.encode("".concat(appKey, ":").concat(appSecret));

  return "Basic ".concat(credentials);
}

function master(appKey, masterSecret) {
  var credentials = _jsBase.Base64.encode("".concat(appKey, ":").concat(masterSecret));

  return "Basic ".concat(credentials);
}

function session(session) {
  if (!session || !session._kmd || !session._kmd.authtoken) {
    throw new _activeUser.default('There is no active user to authorize the request. Please login and retry the request.');
  }

  return "Kinvey ".concat(session._kmd.authtoken);
}

function basic(appKey, appSecret, masterSecret) {
  try {
    return app(appKey, appSecret);
  } catch (error) {
    return master(appKey, masterSecret);
  }
}

function defaultAuth(_session, appKey, masterSecret) {
  try {
    return session(_session);
  } catch (error) {
    return master(appKey, masterSecret);
  }
}

function all(_session, appKey, appSecret, masterSecret) {
  try {
    return session(_session);
  } catch (error) {
    return basic(appKey, appSecret, masterSecret);
  }
}

var Auth = {
  All: 'All',
  App: 'App',
  Basic: 'Basic',
  Default: 'Default',
  Master: 'Master',
  Session: 'Session'
};
exports.Auth = Auth;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/http/headers.js":
/*!*******************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/http/headers.js ***!
  \*******************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.KinveyHeaders = exports.Headers = void 0;

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _createClass2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/createClass */ "./node_modules/@babel/runtime/helpers/createClass.js"));

var _isArray = _interopRequireDefault(__webpack_require__(/*! lodash/isArray */ "./node_modules/lodash/isArray.js"));

var _isString = _interopRequireDefault(__webpack_require__(/*! lodash/isString */ "./node_modules/lodash/isString.js"));

var _isFunction = _interopRequireDefault(__webpack_require__(/*! lodash/isFunction */ "./node_modules/lodash/isFunction.js"));

var _isEmpty = _interopRequireDefault(__webpack_require__(/*! lodash/isEmpty */ "./node_modules/lodash/isEmpty.js"));

var _kinvey = _interopRequireDefault(__webpack_require__(/*! ../errors/kinvey */ "./packages/kinvey-html5-sdk/src/errors/kinvey.js"));

var X_KINVEY_REQUEST_START_HEADER = 'X-Kinvey-Request-Start';
var X_KINVEY_CUSTOM_REQUEST_PROPERTIES_HEADER = 'X-Kinvey-Custom-Request-Properties';

function isNotString(val) {
  return !(0, _isString.default)(val);
}

var Headers =
/*#__PURE__*/
function () {
  function Headers(headers) {
    var _this = this;

    (0, _classCallCheck2.default)(this, Headers);
    this.headers = new Map();
    this.normalizedNames = new Map();

    if (headers) {
      if (headers instanceof Headers) {
        headers.keys().forEach(function (header) {
          var value = headers.get(header);

          _this.set(header, value);
        });
      } else {
        Object.keys(headers).forEach(function (header) {
          var value = headers[header];

          _this.set(header, value);
        });
      }
    }
  }

  (0, _createClass2.default)(Headers, [{
    key: "has",
    value: function has(name) {
      if (!(0, _isString.default)(name)) {
        throw new Error('Please provide a name. Name must be a string.');
      }

      return this.headers.has(name.toLowerCase());
    }
  }, {
    key: "get",
    value: function get(name) {
      if (!(0, _isString.default)(name)) {
        throw new Error('Please provide a name. Name must be a string.');
      }

      return this.headers.get(name.toLowerCase());
    }
  }, {
    key: "keys",
    value: function keys() {
      return Array.from(this.normalizedNames.values());
    }
  }, {
    key: "set",
    value: function set(name, value) {
      if (!(0, _isString.default)(name)) {
        throw new Error('Please provide a name. Name must be a string.');
      }

      if (!(0, _isString.default)(value) && !(0, _isArray.default)(value) && !(0, _isFunction.default)(value) || (0, _isArray.default)(value) && value.some(isNotString)) {
        throw new Error('Please provide a value. Value must be a string or an array that contains only strings.');
      }

      var key = name.toLowerCase();

      if ((0, _isArray.default)(value)) {
        this.headers.set(key, value.join(','));
      } else if ((0, _isFunction.default)(value)) {
        var val = value();
        return this.set(name, val);
      } else {
        this.headers.set(key, value);
      }

      if (!this.normalizedNames.has(key)) {
        this.normalizedNames.set(key, name);
      }

      return this;
    }
  }, {
    key: "join",
    value: function join(headers) {
      var _this2 = this;

      if (headers instanceof Headers) {
        headers.keys().forEach(function (header) {
          var value = headers.get(header);

          _this2.set(header, value);
        });
      } else {
        Object.keys(headers).forEach(function (header) {
          var value = headers[header];

          _this2.set(header, value);
        });
      }

      return this;
    }
  }, {
    key: "delete",
    value: function _delete(name) {
      if (!(0, _isString.default)(name)) {
        throw new Error('Please provide a name. Name must be a string.');
      }

      return this.headers.delete(name.toLowerCase());
    }
  }, {
    key: "toObject",
    value: function toObject() {
      var _this3 = this;

      return this.keys().reduce(function (headers, header) {
        // eslint-disable-next-line no-param-reassign
        headers[header] = _this3.get(header);
        return headers;
      }, {});
    }
  }, {
    key: "contentType",
    get: function get() {
      return this.get('Content-Type');
    }
  }]);
  return Headers;
}();

exports.Headers = Headers;

function byteCount(str) {
  if (str) {
    var count = 0;
    var stringLength = str.length;

    for (var i = 0; i < stringLength; i += 1) {
      var partCount = encodeURI(str[i]).split('%').length;
      count += partCount === 1 ? 1 : partCount - 1;
    }

    return count;
  }

  return 0;
}

var KinveyHeaders =
/*#__PURE__*/
function (_Headers) {
  (0, _inherits2.default)(KinveyHeaders, _Headers);

  function KinveyHeaders(headers) {
    var _this4;

    (0, _classCallCheck2.default)(this, KinveyHeaders);
    _this4 = (0, _possibleConstructorReturn2.default)(this, (0, _getPrototypeOf2.default)(KinveyHeaders).call(this, headers)); // Add the Accept header

    if (!_this4.has('Accept')) {
      _this4.set('Accept', 'application/json; charset=utf-8');
    } // Add Content-Type header


    if (!_this4.has('Content-Type')) {
      _this4.set('Content-Type', 'application/json; charset=utf-8');
    } // Add the X-Kinvey-API-Version header


    if (!_this4.has('X-Kinvey-Api-Version')) {
      _this4.set('X-Kinvey-Api-Version', '4');
    }

    return _this4;
  }

  (0, _createClass2.default)(KinveyHeaders, [{
    key: "requestStart",
    get: function get() {
      return this.get(X_KINVEY_REQUEST_START_HEADER);
    }
  }, {
    key: "customRequestProperties",
    get: function get() {
      return this.get(X_KINVEY_CUSTOM_REQUEST_PROPERTIES_HEADER);
    },
    set: function set(properties) {
      var customRequestPropertiesVal = JSON.stringify(properties);

      if (!(0, _isEmpty.default)(customRequestPropertiesVal)) {
        var customRequestPropertiesByteCount = byteCount(customRequestPropertiesVal);

        if (customRequestPropertiesByteCount >= 2000) {
          throw new _kinvey.default("The custom properties are ".concat(customRequestPropertiesByteCount, " bytes.") + 'It must be less then 2000 bytes.', 'Please remove some custom properties.');
        }

        this.set(X_KINVEY_CUSTOM_REQUEST_PROPERTIES_HEADER, customRequestPropertiesVal);
      } else {
        this.delete('X-Kinvey-Custom-Request-Properties');
      }
    }
  }]);
  return KinveyHeaders;
}(Headers);

exports.KinveyHeaders = KinveyHeaders;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/http/http.js":
/*!****************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/http/http.js ***!
  \****************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = http;

var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js"));

var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));

var _axios = _interopRequireDefault(__webpack_require__(/*! axios */ "./node_modules/axios/index.js"));

var _timeout = _interopRequireDefault(__webpack_require__(/*! ../errors/timeout */ "./packages/kinvey-html5-sdk/src/errors/timeout.js"));

var _networkConnection = _interopRequireDefault(__webpack_require__(/*! ../errors/networkConnection */ "./packages/kinvey-html5-sdk/src/errors/networkConnection.js"));

function http(_x) {
  return _http.apply(this, arguments);
}

function _http() {
  _http = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee(request) {
    var response;
    return _regenerator.default.wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            _context.prev = 0;
            _context.next = 3;
            return (0, _axios.default)({
              headers: request.headers,
              method: request.method,
              url: request.url,
              data: request.body,
              timeout: request.timeout
            });

          case 3:
            response = _context.sent;
            _context.next = 23;
            break;

          case 6:
            _context.prev = 6;
            _context.t0 = _context["catch"](0);

            if (!_context.t0.response) {
              _context.next = 12;
              break;
            }

            // eslint-disable-next-line prefer-destructuring
            response = _context.t0.response;
            _context.next = 23;
            break;

          case 12:
            if (!_context.t0.request) {
              _context.next = 22;
              break;
            }

            if (!(_context.t0.code === 'ESOCKETTIMEDOUT' || _context.t0.code === 'ETIMEDOUT' || _context.t0.code === 'ECONNABORTED')) {
              _context.next = 17;
              break;
            }

            throw new _timeout.default('The network request timed out.');

          case 17:
            if (!(_context.t0.code === 'ENOENT')) {
              _context.next = 19;
              break;
            }

            throw new _networkConnection.default('You do not have a network connection.');

          case 19:
            throw _context.t0;

          case 22:
            throw _context.t0;

          case 23:
            return _context.abrupt("return", {
              statusCode: response.status,
              headers: response.headers,
              data: response.data
            });

          case 24:
          case "end":
            return _context.stop();
        }
      }
    }, _callee, this, [[0, 6]]);
  }));
  return _http.apply(this, arguments);
}

function browserDetect(ua) {
  // Cast arguments.
  var userAgent = ua.toLowerCase(); // User-Agent patterns.

  var rChrome = /(chrome)\/([\w]+)/;
  var rFirefox = /(firefox)\/([\w.]+)/;
  var rIE = /(msie) ([\w.]+)/i;
  var rOpera = /(opera)(?:.*version)?[ /]([\w.]+)/;
  var rSafari = /(safari)\/([\w.]+)/;
  return rChrome.exec(userAgent) || rFirefox.exec(userAgent) || rIE.exec(userAgent) || rOpera.exec(userAgent) || rSafari.exec(userAgent) || [];
}

function deviceInformation() {
  var sdkInfo = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
  var _sdkInfo$name = sdkInfo.name,
      name = _sdkInfo$name === void 0 ? 'SDK unknown (kinvey-http-web)' : _sdkInfo$name,
      _sdkInfo$version = sdkInfo.version,
      version = _sdkInfo$version === void 0 ? 'unknown' : _sdkInfo$version;
  var libraries = [];
  var browser;
  var platform;
  var browserVersion;
  var manufacturer; // Default platform, most likely this is just a plain web app.

  if ((platform === null || platform === undefined) && window.navigator) {
    browser = browserDetect(window.navigator.userAgent);
    platform = browser[1]; // eslint-disable-line prefer-destructuring

    browserVersion = browser[2]; // eslint-disable-line prefer-destructuring

    manufacturer = window.navigator.platform;
  } // Libraries.


  if (window.angular !== undefined) {
    // AngularJS.
    libraries.push("angularjs/".concat(window.angular.version.full));
  }

  if (window.Backbone !== undefined) {
    // Backbone.js.
    libraries.push("backbonejs/".concat(window.Backbone.VERSION));
  }

  if (window.Ember !== undefined) {
    // Ember.js.
    libraries.push("emberjs/".concat(window.Ember.VERSION));
  }

  if (window.jQuery !== undefined) {
    // jQuery.
    libraries.push("jquery/".concat(window.jQuery.fn.jquery));
  }

  if (window.ko !== undefined) {
    // Knockout.
    libraries.push("knockout/".concat(window.ko.version));
  }

  if (window.Zepto !== undefined) {
    // Zepto.js.
    libraries.push('zeptojs');
  } // Return the device information string.


  var parts = ["js-".concat(name, "/").concat(version)];

  if (libraries.length !== 0) {
    // Add external library information.
    parts.push("(".concat(libraries.sort().join(', '), ")"));
  }

  return parts.concat([platform, browserVersion, manufacturer]).map(function (part) {
    if (part) {
      return part.toString().replace(/\s/g, '_').toLowerCase();
    }

    return 'unknown';
  }).join(' ');
}

function deviceInfo(sdkInfo) {
  return {
    hv: 1,
    os: window.navigator.appVersion,
    ov: window.navigator.appVersion,
    sdk: sdkInfo || {
      name: 'SDK unknown (kinvey-http-web)',
      version: 'unknown'
    },
    pv: window.navigator.userAgent
  };
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/http/request.js":
/*!*******************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/http/request.js ***!
  \*******************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.KinveyRequest = exports.Request = exports.RequestMethod = void 0;

var _defineProperty2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/defineProperty */ "./node_modules/@babel/runtime/helpers/defineProperty.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _get2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/get */ "./node_modules/@babel/runtime/helpers/get.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js"));

var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _createClass2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/createClass */ "./node_modules/@babel/runtime/helpers/createClass.js"));

var _isNumber = _interopRequireDefault(__webpack_require__(/*! lodash/isNumber */ "./node_modules/lodash/isNumber.js"));

var _pQueue = _interopRequireDefault(__webpack_require__(/*! p-queue */ "./node_modules/p-queue/index.js"));

var _jsBase = __webpack_require__(/*! js-base64 */ "./node_modules/js-base64/base64.js");

var _kinvey = _interopRequireDefault(__webpack_require__(/*! ../errors/kinvey */ "./packages/kinvey-html5-sdk/src/errors/kinvey.js"));

var _invalidCredentials = _interopRequireDefault(__webpack_require__(/*! ../errors/invalidCredentials */ "./packages/kinvey-html5-sdk/src/errors/invalidCredentials.js"));

var _config = __webpack_require__(/*! ../kinvey/config */ "./packages/kinvey-html5-sdk/src/kinvey/config.js");

var _session = __webpack_require__(/*! ../session */ "./packages/kinvey-html5-sdk/src/session/index.js");

var _cache = __webpack_require__(/*! ../cache */ "./packages/kinvey-html5-sdk/src/cache/index.js");

var _headers = __webpack_require__(/*! ./headers */ "./packages/kinvey-html5-sdk/src/http/headers.js");

var _utils = __webpack_require__(/*! ./utils */ "./packages/kinvey-html5-sdk/src/http/utils.js");

var _response2 = _interopRequireDefault(__webpack_require__(/*! ./response */ "./packages/kinvey-html5-sdk/src/http/response.js"));

var _auth = __webpack_require__(/*! ./auth */ "./packages/kinvey-html5-sdk/src/http/auth.js");

var _http = _interopRequireDefault(__webpack_require__(/*! ./http */ "./packages/kinvey-html5-sdk/src/http/http.js"));

var REQUEST_QUEUE = new _pQueue.default();
var refreshTokenRequestInProgress = false;
var AUTHORIZATION_HEADER = 'Authorization';
var RequestMethod = {
  GET: 'GET',
  POST: 'POST',
  PUT: 'PUT',
  DELETE: 'DELETE'
};
exports.RequestMethod = RequestMethod;
var KINVEY_DEVICE_INFORMATION_HEADER = 'X-Kinvey-Device-Information';
var deviceInformation;
var KINVEY_DEVICE_INFO_HEADER = 'X-Kinvey-Device-Info';
var deviceInfo;

var Request =
/*#__PURE__*/
function () {
  function Request() {
    var request = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    (0, _classCallCheck2.default)(this, Request);
    var headers = request.headers,
        method = request.method,
        url = request.url,
        body = request.body,
        timeout = request.timeout;
    this.headers = headers;
    this.method = method;
    this.url = url;
    this.body = body;
    this.timeout = timeout;
  }

  (0, _createClass2.default)(Request, [{
    key: "execute",
    value: function () {
      var _execute = (0, _asyncToGenerator2.default)(
      /*#__PURE__*/
      _regenerator.default.mark(function _callee() {
        var responseObject, response;
        return _regenerator.default.wrap(function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                _context.next = 2;
                return (0, _http.default)({
                  headers: this.headers.toObject(),
                  method: this.method,
                  url: this.url,
                  body: (0, _utils.serialize)(this.headers.contentType, this.body),
                  timeout: this.timeout
                });

              case 2:
                responseObject = _context.sent;
                // Create a response
                response = new _response2.default({
                  statusCode: responseObject.statusCode,
                  headers: responseObject.headers,
                  data: responseObject.data
                }); // Return the response if it was successful

                if (!response.isSuccess()) {
                  _context.next = 6;
                  break;
                }

                return _context.abrupt("return", response);

              case 6:
                throw response.error;

              case 7:
              case "end":
                return _context.stop();
            }
          }
        }, _callee, this);
      }));

      function execute() {
        return _execute.apply(this, arguments);
      }

      return execute;
    }()
  }, {
    key: "headers",
    get: function get() {
      return this._headers;
    },
    set: function set(headers) {
      this._headers = new _headers.Headers(headers);
    }
  }, {
    key: "timeout",
    get: function get() {
      return this._timeout;
    },
    set: function set(timeout) {
      var _getConfig = (0, _config.get)(),
          defaultTimeout = _getConfig.defaultTimeout;

      var requestTimeout = typeof timeout === 'undefined' || timeout === null ? defaultTimeout : timeout;

      if (!(0, _isNumber.default)(requestTimeout) || isNaN(requestTimeout)) {
        throw new _kinvey.default('Invalid timeout. Timeout must be a number.');
      }

      this._timeout = requestTimeout;
    }
  }]);
  return Request;
}();

exports.Request = Request;

function isRefreshTokenRequestInProgress() {
  return refreshTokenRequestInProgress === true;
}

var KinveyRequest =
/*#__PURE__*/
function (_Request) {
  (0, _inherits2.default)(KinveyRequest, _Request);

  function KinveyRequest(request) {
    var _this;

    (0, _classCallCheck2.default)(this, KinveyRequest);
    _this = (0, _possibleConstructorReturn2.default)(this, (0, _getPrototypeOf2.default)(KinveyRequest).call(this, request));
    _this.headers = request.headers;
    _this.auth = request.auth;
    return _this;
  }

  (0, _createClass2.default)(KinveyRequest, [{
    key: "execute",
    value: function () {
      var _execute2 = (0, _asyncToGenerator2.default)(
      /*#__PURE__*/
      _regenerator.default.mark(function _callee2() {
        var _this2 = this;

        var retry,
            response,
            _getConfig2,
            appKey,
            appSecret,
            authProtocol,
            authHost,
            apiProtocol,
            apiHost,
            activeSession,
            socialIdentity,
            micIdentityKey,
            micIdentity,
            refreshRequest,
            refreshResponse,
            newMicIdentity,
            loginRequest,
            loginResponse,
            newSession,
            _response,
            url,
            request,
            _args2 = arguments;

        return _regenerator.default.wrap(function _callee2$(_context2) {
          while (1) {
            switch (_context2.prev = _context2.next) {
              case 0:
                retry = _args2.length > 0 && _args2[0] !== undefined ? _args2[0] : true;
                _context2.prev = 1;

                // Add the X-Kinvey-Device-Information header
                if (deviceInformation) {
                  this.headers.set(KINVEY_DEVICE_INFORMATION_HEADER, deviceInformation);
                } // Add the X-Kinvey-Device-Info header


                if (deviceInfo) {
                  this.headers.set(KINVEY_DEVICE_INFO_HEADER, JSON.stringify(deviceInfo));
                } // Set the authorization header


                if (this.auth) {
                  this.headers.set(AUTHORIZATION_HEADER, this.authorizationHeader);
                } // Execute the request


                _context2.next = 7;
                return (0, _get2.default)((0, _getPrototypeOf2.default)(KinveyRequest.prototype), "execute", this).call(this);

              case 7:
                response = _context2.sent;
                return _context2.abrupt("return", response);

              case 11:
                _context2.prev = 11;
                _context2.t0 = _context2["catch"](1);

                if (!retry) {
                  _context2.next = 61;
                  break;
                }

                if (!(_context2.t0 instanceof _invalidCredentials.default)) {
                  _context2.next = 59;
                  break;
                }

                if (!isRefreshTokenRequestInProgress()) {
                  _context2.next = 17;
                  break;
                }

                return _context2.abrupt("return", REQUEST_QUEUE.add(function () {
                  return _this2.execute(false).catch(function () {
                    return Promise.reject(_context2.t0);
                  });
                }));

              case 17:
                _getConfig2 = (0, _config.get)(), appKey = _getConfig2.appKey, appSecret = _getConfig2.appSecret, authProtocol = _getConfig2.authProtocol, authHost = _getConfig2.authHost, apiProtocol = _getConfig2.apiProtocol, apiHost = _getConfig2.apiHost;
                activeSession = (0, _session.get)();
                socialIdentity = activeSession && activeSession._socialIdentity || {};
                micIdentityKey = Object.keys(socialIdentity).find(function (sessionKey) {
                  return socialIdentity[sessionKey].identity === 'kinveyAuth';
                });
                micIdentity = socialIdentity[micIdentityKey];

                if (!(micIdentity && micIdentity.refresh_token && micIdentity.redirect_uri)) {
                  _context2.next = 48;
                  break;
                }

                _context2.prev = 23;
                // Pause the request queue
                REQUEST_QUEUE.pause();
                refreshTokenRequestInProgress = true; // Refresh the session

                refreshRequest = new KinveyRequest({
                  method: RequestMethod.POST,
                  headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                    Authorization: function Authorization() {
                      var credentials = _jsBase.Base64.encode("".concat(micIdentity.client_id, ":").concat(appSecret));

                      return "Basic ".concat(credentials);
                    }
                  },
                  url: (0, _utils.formatKinveyUrl)(authProtocol, authHost, '/oauth/token'),
                  body: {
                    grant_type: 'refresh_token',
                    client_id: micIdentity.client_id,
                    redirect_uri: micIdentity.redirect_uri,
                    refresh_token: micIdentity.refresh_token
                  }
                });
                _context2.next = 29;
                return refreshRequest.execute();

              case 29:
                refreshResponse = _context2.sent;
                // Create a new session
                newMicIdentity = Object.assign({}, refreshResponse.data, {
                  client_id: micIdentity.client_id,
                  redirect_uri: micIdentity.redirect_uri,
                  protocol: authProtocol,
                  host: authHost
                }); // Login the new MIC identity

                loginRequest = new KinveyRequest({
                  method: RequestMethod.POST,
                  auth: _auth.Auth.App,
                  url: (0, _utils.formatKinveyUrl)(apiProtocol, apiHost, "/user/".concat(appKey, "/login")),
                  properties: this.properties,
                  body: {
                    _socialIdentity: (0, _defineProperty2.default)({}, micIdentityKey, newMicIdentity)
                  }
                });
                _context2.next = 34;
                return loginRequest.execute();

              case 34:
                loginResponse = _context2.sent;
                newSession = loginResponse.data;
                newSession._socialIdentity[micIdentityKey] = Object.assign({}, newSession._socialIdentity[micIdentityKey], newMicIdentity); // Set the new session

                (0, _session.set)(newSession); // Redo the original request

                _context2.next = 40;
                return this.execute(false);

              case 40:
                _response = _context2.sent;
                // Start the request queue
                refreshTokenRequestInProgress = false;
                REQUEST_QUEUE.start(); // Return the response

                return _context2.abrupt("return", _response);

              case 46:
                _context2.prev = 46;
                _context2.t1 = _context2["catch"](23);

              case 48:
                _context2.prev = 48;
                // TODO: Unregister from live service
                // Logout
                url = (0, _utils.formatKinveyUrl)(apiProtocol, apiHost, "/user/".concat(appKey, "/_logout"));
                request = new KinveyRequest({
                  method: RequestMethod.POST,
                  auth: _auth.Auth.Session,
                  url: url
                });
                _context2.next = 53;
                return request.execute(false);

              case 53:
                // Remove the session
                (0, _session.remove)(); // Clear data

                (0, _cache.clear)(appKey);
                _context2.next = 59;
                break;

              case 57:
                _context2.prev = 57;
                _context2.t2 = _context2["catch"](48);

              case 59:
                // Start the request queue
                refreshTokenRequestInProgress = false;
                REQUEST_QUEUE.start();

              case 61:
                throw _context2.t0;

              case 62:
              case "end":
                return _context2.stop();
            }
          }
        }, _callee2, this, [[1, 11], [23, 46], [48, 57]]);
      }));

      function execute() {
        return _execute2.apply(this, arguments);
      }

      return execute;
    }()
  }, {
    key: "headers",
    get: function get() {
      return this._headers;
    },
    set: function set(headers) {
      this._headers = new _headers.KinveyHeaders(headers);
    }
  }, {
    key: "authorizationHeader",
    get: function get() {
      var _getConfig3 = (0, _config.get)(),
          appKey = _getConfig3.appKey,
          appSecret = _getConfig3.appSecret,
          masterSecret = _getConfig3.masterSecret;

      var session = (0, _session.get)();

      if (this.auth === _auth.Auth.App) {
        return (0, _auth.app)(appKey, appSecret);
      } else if (this.auth === _auth.Auth.Master) {
        return (0, _auth.master)(appKey, masterSecret);
      } else if (this.auth === _auth.Auth.Session) {
        return (0, _auth.session)(session);
      } else if (this.auth === _auth.Auth.Basic) {
        return (0, _auth.basic)(appKey, appSecret, masterSecret);
      } else if (this.auth === _auth.Auth.Default) {
        return (0, _auth.defaultAuth)(session, appKey, masterSecret);
      } else if (this.auth === _auth.Auth.All) {
        return (0, _auth.all)(session, appKey, appSecret, masterSecret);
      }

      return null;
    }
  }]);
  return KinveyRequest;
}(Request);

exports.KinveyRequest = KinveyRequest;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/http/response.js":
/*!********************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/http/response.js ***!
  \********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _createClass2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/createClass */ "./node_modules/@babel/runtime/helpers/createClass.js"));

var _apiVersionNotAvailable = _interopRequireDefault(__webpack_require__(/*! ../errors/apiVersionNotAvailable */ "./packages/kinvey-html5-sdk/src/errors/apiVersionNotAvailable.js"));

var _apiVersionNotImplemented = _interopRequireDefault(__webpack_require__(/*! ../errors/apiVersionNotImplemented */ "./packages/kinvey-html5-sdk/src/errors/apiVersionNotImplemented.js"));

var _appProblem = _interopRequireDefault(__webpack_require__(/*! ../errors/appProblem */ "./packages/kinvey-html5-sdk/src/errors/appProblem.js"));

var _badRequest = _interopRequireDefault(__webpack_require__(/*! ../errors/badRequest */ "./packages/kinvey-html5-sdk/src/errors/badRequest.js"));

var _bl = _interopRequireDefault(__webpack_require__(/*! ../errors/bl */ "./packages/kinvey-html5-sdk/src/errors/bl.js"));

var _corsDisabled = _interopRequireDefault(__webpack_require__(/*! ../errors/corsDisabled */ "./packages/kinvey-html5-sdk/src/errors/corsDisabled.js"));

var _duplicateEndUsers = _interopRequireDefault(__webpack_require__(/*! ../errors/duplicateEndUsers */ "./packages/kinvey-html5-sdk/src/errors/duplicateEndUsers.js"));

var _featureUnavailable = _interopRequireDefault(__webpack_require__(/*! ../errors/featureUnavailable */ "./packages/kinvey-html5-sdk/src/errors/featureUnavailable.js"));

var _incompleteRequestBody = _interopRequireDefault(__webpack_require__(/*! ../errors/incompleteRequestBody */ "./packages/kinvey-html5-sdk/src/errors/incompleteRequestBody.js"));

var _indirectCollectionAccessDisallowed = _interopRequireDefault(__webpack_require__(/*! ../errors/indirectCollectionAccessDisallowed */ "./packages/kinvey-html5-sdk/src/errors/indirectCollectionAccessDisallowed.js"));

var _insufficientCredentials = _interopRequireDefault(__webpack_require__(/*! ../errors/insufficientCredentials */ "./packages/kinvey-html5-sdk/src/errors/insufficientCredentials.js"));

var _invalidCredentials = _interopRequireDefault(__webpack_require__(/*! ../errors/invalidCredentials */ "./packages/kinvey-html5-sdk/src/errors/invalidCredentials.js"));

var _invalidIdentifier = _interopRequireDefault(__webpack_require__(/*! ../errors/invalidIdentifier */ "./packages/kinvey-html5-sdk/src/errors/invalidIdentifier.js"));

var _invalidQuerySyntax = _interopRequireDefault(__webpack_require__(/*! ../errors/invalidQuerySyntax */ "./packages/kinvey-html5-sdk/src/errors/invalidQuerySyntax.js"));

var _jsonParse = _interopRequireDefault(__webpack_require__(/*! ../errors/jsonParse */ "./packages/kinvey-html5-sdk/src/errors/jsonParse.js"));

var _kinvey = _interopRequireDefault(__webpack_require__(/*! ../errors/kinvey */ "./packages/kinvey-html5-sdk/src/errors/kinvey.js"));

var _kinveyInternalErrorRetry = _interopRequireDefault(__webpack_require__(/*! ../errors/kinveyInternalErrorRetry */ "./packages/kinvey-html5-sdk/src/errors/kinveyInternalErrorRetry.js"));

var _kinveyInternalErrorStop = _interopRequireDefault(__webpack_require__(/*! ../errors/kinveyInternalErrorStop */ "./packages/kinvey-html5-sdk/src/errors/kinveyInternalErrorStop.js"));

var _missingQuery = _interopRequireDefault(__webpack_require__(/*! ../errors/missingQuery */ "./packages/kinvey-html5-sdk/src/errors/missingQuery.js"));

var _missingRequestHeader = _interopRequireDefault(__webpack_require__(/*! ../errors/missingRequestHeader */ "./packages/kinvey-html5-sdk/src/errors/missingRequestHeader.js"));

var _missingRequestParameter = _interopRequireDefault(__webpack_require__(/*! ../errors/missingRequestParameter */ "./packages/kinvey-html5-sdk/src/errors/missingRequestParameter.js"));

var _missingConfiguration = _interopRequireDefault(__webpack_require__(/*! ../errors/missingConfiguration */ "./packages/kinvey-html5-sdk/src/errors/missingConfiguration.js"));

var _networkConnection = _interopRequireDefault(__webpack_require__(/*! ../errors/networkConnection */ "./packages/kinvey-html5-sdk/src/errors/networkConnection.js"));

var _notFound = _interopRequireDefault(__webpack_require__(/*! ../errors/notFound */ "./packages/kinvey-html5-sdk/src/errors/notFound.js"));

var _parameterValueOutOfRange = _interopRequireDefault(__webpack_require__(/*! ../errors/parameterValueOutOfRange */ "./packages/kinvey-html5-sdk/src/errors/parameterValueOutOfRange.js"));

var _resultSetSizeExceeded = _interopRequireDefault(__webpack_require__(/*! ../errors/resultSetSizeExceeded */ "./packages/kinvey-html5-sdk/src/errors/resultSetSizeExceeded.js"));

var _server = _interopRequireDefault(__webpack_require__(/*! ../errors/server */ "./packages/kinvey-html5-sdk/src/errors/server.js"));

var _staleRequest = _interopRequireDefault(__webpack_require__(/*! ../errors/staleRequest */ "./packages/kinvey-html5-sdk/src/errors/staleRequest.js"));

var _timeout = _interopRequireDefault(__webpack_require__(/*! ../errors/timeout */ "./packages/kinvey-html5-sdk/src/errors/timeout.js"));

var _userAlreadyExists = _interopRequireDefault(__webpack_require__(/*! ../errors/userAlreadyExists */ "./packages/kinvey-html5-sdk/src/errors/userAlreadyExists.js"));

var _writesToCollectionDisallowed = _interopRequireDefault(__webpack_require__(/*! ../errors/writesToCollectionDisallowed */ "./packages/kinvey-html5-sdk/src/errors/writesToCollectionDisallowed.js"));

var _headers = __webpack_require__(/*! ./headers */ "./packages/kinvey-html5-sdk/src/http/headers.js");

var _utils = __webpack_require__(/*! ./utils */ "./packages/kinvey-html5-sdk/src/http/utils.js");

var StatusCode = {
  Ok: 200,
  Created: 201,
  Empty: 204,
  MovedPermanently: 301,
  Found: 302,
  NotModified: 304,
  TemporaryRedirect: 307,
  PermanentRedirect: 308,
  Unauthorized: 401,
  Forbidden: 403,
  NotFound: 404,
  ServerError: 500
};

var Response =
/*#__PURE__*/
function () {
  function Response(response) {
    (0, _classCallCheck2.default)(this, Response);
    this.statusCode = response.statusCode;
    this.headers = response.headers;
    this.data = response.data;
  }

  (0, _createClass2.default)(Response, [{
    key: "isSuccess",
    value: function isSuccess() {
      return this.statusCode >= 200 && this.statusCode < 300 || this.statusCode === StatusCode.MovedPermanently || this.statusCode === StatusCode.Found || this.statusCode === StatusCode.NotModified || this.statusCode === StatusCode.TemporaryRedirect || this.statusCode === StatusCode.PermanentRedirect;
    }
  }, {
    key: "headers",
    get: function get() {
      return this._headers;
    },
    set: function set(headers) {
      this._headers = new _headers.Headers(headers);
    }
  }, {
    key: "data",
    get: function get() {
      return this._data;
    },
    set: function set(data) {
      this._data = (0, _utils.parse)(this.headers.contentType, data);
    }
  }, {
    key: "error",
    get: function get() {
      if (!this.isSuccess()) {
        var data = this.data || {};
        var name = data.name || data.error;
        var message = data.message || data.description;
        var debug = data.debug;
        var code = this.statusCode;
        var kinveyRequestId = this.headers.get('X-Kinvey-Request-ID');

        if (code === 'ESOCKETTIMEDOUT' || code === 'ETIMEDOUT') {
          return new _timeout.default('The network request timed out.');
        } else if (code === 'ENOENT') {
          return new _networkConnection.default('You do not have a network connection.');
        } else if (name === 'APIVersionNotAvailable') {
          return new _apiVersionNotAvailable.default(message, debug, code, kinveyRequestId);
        } else if (name === 'APIVersionNotImplemented') {
          return new _apiVersionNotImplemented.default(message, debug, code, kinveyRequestId);
        } else if (name === 'AppProblem') {
          return new _appProblem.default(message, debug, code, kinveyRequestId);
        } else if (name === 'AppProblem') {
          return new _appProblem.default(message, debug, code, kinveyRequestId);
        } else if (name === 'BadRequest') {
          return new _badRequest.default(message, debug, code, kinveyRequestId);
        } else if (name === 'BLInternalError' || name === 'BLRuntimeError' || name === 'BLSyntaxError' || name === 'BLTimeoutError' || name === 'BLViolationError') {
          return new _bl.default(message, debug, code, kinveyRequestId);
        } else if (name === 'CORSDisabled') {
          return new _corsDisabled.default(message, debug, code, kinveyRequestId);
        } else if (name === 'DuplicateEndUsers') {
          return new _duplicateEndUsers.default(message, debug, code, kinveyRequestId);
        } else if (name === 'FeatureUnavailable') {
          return new _featureUnavailable.default(message, debug, code, kinveyRequestId);
        } else if (name === 'IncompleteRequestBody') {
          return new _incompleteRequestBody.default(message, debug, code, kinveyRequestId);
        } else if (name === 'IndirectCollectionAccessDisallowed') {
          return new _indirectCollectionAccessDisallowed.default(message, debug, code, kinveyRequestId);
        } else if (name === 'InsufficientCredentials') {
          return new _insufficientCredentials.default(message, debug, code, kinveyRequestId);
        } else if (name === 'InvalidCredentials') {
          return new _invalidCredentials.default(message, debug, code, kinveyRequestId);
        } else if (name === 'InvalidIdentifier') {
          return new _invalidIdentifier.default(message, debug, code, kinveyRequestId);
        } else if (name === 'InvalidQuerySyntax') {
          return new _invalidQuerySyntax.default(message, debug, code, kinveyRequestId);
        } else if (name === 'JSONParseError') {
          return new _jsonParse.default(message, debug, code, kinveyRequestId);
        } else if (name === 'KinveyInternalErrorRetry') {
          return new _kinveyInternalErrorRetry.default(message, debug, code, kinveyRequestId);
        } else if (name === 'KinveyInternalErrorStop') {
          return new _kinveyInternalErrorStop.default(message, debug, code, kinveyRequestId);
        } else if (name === 'MissingQuery') {
          return new _missingQuery.default(message, debug, code, kinveyRequestId);
        } else if (name === 'MissingRequestHeader') {
          return new _missingRequestHeader.default(message, debug, code, kinveyRequestId);
        } else if (name === 'MissingRequestParameter') {
          return new _missingRequestParameter.default(message, debug, code, kinveyRequestId);
        } else if (name === 'MissingConfiguration') {
          return new _missingConfiguration.default(message, debug, code, kinveyRequestId);
        } else if (name === 'EntityNotFound' || name === 'CollectionNotFound' || name === 'AppNotFound' || name === 'UserNotFound' || name === 'BlobNotFound' || name === 'DocumentNotFound') {
          return new _notFound.default(message, debug, code, kinveyRequestId);
        } else if (name === 'ParameterValueOutOfRange') {
          return new _parameterValueOutOfRange.default(message, debug, code, kinveyRequestId);
        } else if (name === 'ResultSetSizeExceeded') {
          return new _resultSetSizeExceeded.default(message, debug, code, kinveyRequestId);
        } else if (name === 'ServerError') {
          return new _server.default(message, debug, code, kinveyRequestId);
        } else if (name === 'StaleRequest') {
          return new _staleRequest.default(message, debug, code, kinveyRequestId);
        } else if (name === 'UserAlreadyExists') {
          return new _userAlreadyExists.default(message, debug, code, kinveyRequestId);
        } else if (name === 'WritesToCollectionDisallowed') {
          return new _writesToCollectionDisallowed.default(message, debug, code, kinveyRequestId);
        } else if (code === StatusCode.Unauthorized || code === StatusCode.Forbidden) {
          return new _insufficientCredentials.default(message, debug, code, kinveyRequestId);
        } else if (code === StatusCode.NotFound) {
          return new _notFound.default(message, debug, code, kinveyRequestId);
        } else if (code === StatusCode.ServerError) {
          return new _server.default(message, debug, code, kinveyRequestId);
        }

        return new _kinvey.default(message, debug, code, kinveyRequestId);
      }

      return null;
    }
  }]);
  return Response;
}();

exports.default = Response;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/http/utils.js":
/*!*****************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/http/utils.js ***!
  \*****************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function(global) {

var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.formatKinveyUrl = formatKinveyUrl;
exports.serialize = serialize;
exports.parse = parse;

var _url = __webpack_require__(/*! url */ "./node_modules/url/url.js");

var _isString = _interopRequireDefault(__webpack_require__(/*! lodash/isString */ "./node_modules/lodash/isString.js"));

var _isPlainObject = _interopRequireDefault(__webpack_require__(/*! lodash/isPlainObject */ "./node_modules/lodash/isPlainObject.js"));

function clean(value) {
  if ((0, _isPlainObject.default)(value)) {
    return Object.keys(value).reduce(function (cleanVal, key) {
      var objVal = value[key];

      if ((0, _isPlainObject.default)(objVal)) {
        objVal = clean(objVal);
      }

      if (typeof objVal !== 'undefined' && objVal !== null) {
        cleanVal[key] = objVal;
      }

      return cleanVal;
    }, {});
  }

  return value;
}

function formatKinveyUrl(protocol, host, pathname, query) {
  var cleanQuery = clean(query);
  return (0, _url.format)({
    protocol: protocol,
    host: host,
    pathname: pathname,
    query: cleanQuery
  });
}

function serialize(contentType, body) {
  if (body && !(0, _isString.default)(body)) {
    if (contentType.indexOf('application/x-www-form-urlencoded') === 0) {
      var str = [];
      Object.keys(body).forEach(function (key) {
        str.push("".concat(global.encodeURIComponent(key), "=").concat(global.encodeURIComponent(body[key])));
      });
      return str.join('&');
    } else if (contentType.indexOf('application/json') === 0) {
      return JSON.stringify(body);
    }
  }

  return body;
}

function parse() {
  var contentType = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'application/json';
  var data = arguments.length > 1 ? arguments[1] : undefined;

  if ((0, _isString.default)(data)) {
    if (contentType.indexOf('application/json') === 0) {
      try {
        return JSON.parse(data);
      } catch (error) {// TODO: log error
      }
    }
  }

  return data;
}
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../../../node_modules/webpack/buildin/global.js */ "./node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/index.js":
/*!************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/index.js ***!
  \************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireWildcard = __webpack_require__(/*! @babel/runtime/helpers/interopRequireWildcard */ "./node_modules/@babel/runtime/helpers/interopRequireWildcard.js");

var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

var _acl = _interopRequireDefault(__webpack_require__(/*! ./acl */ "./packages/kinvey-html5-sdk/src/acl.js"));

var _store = __webpack_require__(/*! ./cache/store */ "./packages/kinvey-html5-sdk/src/cache/store.js");

var DataStore = _interopRequireWildcard(__webpack_require__(/*! ./datastore */ "./packages/kinvey-html5-sdk/src/datastore/index.js"));

var _kmd = _interopRequireDefault(__webpack_require__(/*! ./kmd */ "./packages/kinvey-html5-sdk/src/kmd.js"));

var _query = _interopRequireDefault(__webpack_require__(/*! ./query */ "./packages/kinvey-html5-sdk/src/query.js"));

var Files = _interopRequireWildcard(__webpack_require__(/*! ./files */ "./packages/kinvey-html5-sdk/src/files/index.js"));

var _endpoint = _interopRequireDefault(__webpack_require__(/*! ./endpoint */ "./packages/kinvey-html5-sdk/src/endpoint.js"));

var _aggregation = _interopRequireDefault(__webpack_require__(/*! ./aggregation */ "./packages/kinvey-html5-sdk/src/aggregation/index.js"));

var _init = _interopRequireDefault(__webpack_require__(/*! ./kinvey/init */ "./packages/kinvey-html5-sdk/src/kinvey/init.js"));

var _initialize = _interopRequireDefault(__webpack_require__(/*! ./kinvey/initialize */ "./packages/kinvey-html5-sdk/src/kinvey/initialize.js"));

var _appVersion = __webpack_require__(/*! ./kinvey/appVersion */ "./packages/kinvey-html5-sdk/src/kinvey/appVersion.js");

var _user = _interopRequireDefault(__webpack_require__(/*! ./user */ "./packages/kinvey-html5-sdk/src/user/index.js"));

// SDK
var SDK = {
  init: _init.default,
  initialize: _initialize.default,
  getAppVersion: _appVersion.get,
  setAppVersion: _appVersion.set,
  // Acl
  Acl: _acl.default,
  // Aggregation
  Aggregation: _aggregation.default,
  // DataStore
  DataStore: DataStore,
  DataStoreType: DataStore.DataStoreType,
  StorageProvider: _store.StorageProvider,
  // Custom Endpoint
  CustomEndpoint: {
    execute: _endpoint.default
  },
  // Files
  Files: Files,
  // Kmd
  Kmd: _kmd.default,
  Metadata: _kmd.default,
  // Query
  Query: _query.default,
  // User
  User: _user.default,
  AuthorizationGrant: _user.default.AuthorizationGrant
}; // Export

module.exports = SDK;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/kinvey/appVersion.js":
/*!************************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/kinvey/appVersion.js ***!
  \************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.get = get;
exports.set = set;

var _config = __webpack_require__(/*! ./config */ "./packages/kinvey-html5-sdk/src/kinvey/config.js");

/**
 * The version of your app. It will sent with Kinvey API requests
 * using the X-Kinvey-Api-Version header.
 *
 * @return {string} The version of your app.
 */
function get() {
  var config = (0, _config.get)();
  return config.appVersion;
}
/**
 * Set the version of your app. It will sent with Kinvey API requests
 * using the X-Kinvey-Api-Version header.
 *
 * @param  {string} appVersion  App version.
 */


function set(appVersion) {
  var config = (0, _config.get)();
  config.appVersion = appVersion;
  (0, _config.set)(config);
  return true;
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/kinvey/config.js":
/*!********************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/kinvey/config.js ***!
  \********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.get = get;
exports.set = set;
exports.remove = remove;

var _kinvey = _interopRequireDefault(__webpack_require__(/*! ../errors/kinvey */ "./packages/kinvey-html5-sdk/src/errors/kinvey.js"));

var map = new Map();
var appKey;

function getKey() {
  if (appKey) {
    return "".concat(appKey, ".config");
  }

  return undefined;
}

function get() {
  var key = getKey();

  if (key) {
    var config = map.get(key);

    if (config) {
      return config;
    }
  }

  throw new _kinvey.default('You have not initialized the Kinvey SDK.');
}

function set(config) {
  if (config && config.appKey) {
    appKey = config.appKey;
    var key = getKey();
    map.set(key, config);
    return true;
  }

  return false;
}

function remove() {
  var key = getKey();

  if (key) {
    map.delete(key);
    return true;
  }

  return false;
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/kinvey/device.js":
/*!********************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/kinvey/device.js ***!
  \********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getId = getId;

var _utils = __webpack_require__(/*! ./utils */ "./packages/kinvey-html5-sdk/src/kinvey/utils.js");

var _config = __webpack_require__(/*! ./config */ "./packages/kinvey-html5-sdk/src/kinvey/config.js");

// eslint-disable-next-line import/prefer-default-export
function getId() {
  var _getConfig = (0, _config.get)(),
      appKey = _getConfig.appKey;

  var key = "".concat(appKey, ".deviceId");
  var id = window.localStorage.getItem(key);

  if (!id) {
    id = (0, _utils.uuidv4)();
    window.localStorage.setItem(key, id);
  }

  return id;
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/kinvey/init.js":
/*!******************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/kinvey/init.js ***!
  \******************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = init;

var _isString = _interopRequireDefault(__webpack_require__(/*! lodash/isString */ "./node_modules/lodash/isString.js"));

var _isNumber = _interopRequireDefault(__webpack_require__(/*! lodash/isNumber */ "./node_modules/lodash/isNumber.js"));

var _url = __webpack_require__(/*! url */ "./node_modules/url/url.js");

var _kinvey = _interopRequireDefault(__webpack_require__(/*! ../errors/kinvey */ "./packages/kinvey-html5-sdk/src/errors/kinvey.js"));

var _config = __webpack_require__(/*! ./config */ "./packages/kinvey-html5-sdk/src/kinvey/config.js");

var DEFAULT_TIMEOUT = 60000;

function init() {
  var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
  var appKey = config.appKey,
      appSecret = config.appSecret,
      masterSecret = config.masterSecret,
      appVersion = config.appVersion,
      instanceId = config.instanceId,
      encryptionKey = config.encryptionKey,
      storage = config.storage;
  var defaultTimeout = (0, _isNumber.default)(config.defaultTimeout) && config.defaultTimeout >= 0 ? config.defaultTimeout : DEFAULT_TIMEOUT;
  var apiHostname = 'https://baas.kinvey.com';
  var authHostname = 'https://auth.kinvey.com';

  if (instanceId) {
    if (!(0, _isString.default)(instanceId)) {
      throw new _kinvey.default('Instance ID must be a string.');
    }

    apiHostname = "https://".concat(instanceId, "-baas.kinvey.com");
    authHostname = "https://".concat(instanceId, "-auth.kinvey.com");
  } else {
    if ((0, _isString.default)(config.apiHostname)) {
      apiHostname = /^https?:\/\//i.test(config.apiHostname) ? config.apiHostname : "https://".concat(config.apiHostname);
    }

    if ((0, _isString.default)(config.micHostname)) {
      authHostname = /^https?:\/\//i.test(config.micHostname) ? config.micHostname : "https://".concat(config.micHostname);
    }
  }

  if (!(0, _isString.default)(appKey)) {
    throw new _kinvey.default('An appKey is required and must be a string.');
  }

  if (!(0, _isString.default)(appSecret) && !(0, _isString.default)(masterSecret)) {
    throw new _kinvey.default('An appSecret is required and must be a string.');
  }

  if (appVersion && !(0, _isString.default)(appVersion)) {
    throw new _kinvey.default('An appVersion must be a string.');
  }

  if (encryptionKey && !(0, _isString.default)(encryptionKey)) {
    throw new _kinvey.default('An encryptionKey must be a string.');
  } // TODO: Add check in future
  // if (defaultTimeout != null && (!isNumber(defaultTimeout) || defaultTimeout < 1)) {
  //   throw new KineyError('A defaultTimeout must be a number greater then 0.');
  // }
  // Create the internal config


  var internalConfig = {
    appKey: appKey,
    appSecret: appSecret,
    masterSecret: masterSecret,
    encryptionKey: encryptionKey,
    appVersion: appVersion,
    _appVersion: appVersion,
    defaultTimeout: defaultTimeout,
    _defaultTimeout: defaultTimeout,
    storage: storage,
    apiProtocol: (0, _url.parse)(apiHostname).protocol,
    apiHost: (0, _url.parse)(apiHostname).host,
    apiHostname: apiHostname,
    authProtocol: (0, _url.parse)(authHostname).protocol,
    authHost: (0, _url.parse)(authHostname).host,
    authHostname: authHostname,
    micProtocol: (0, _url.parse)(authHostname).protocol,
    micHost: (0, _url.parse)(authHostname).host,
    micHostname: authHostname
  }; // Set the internal config

  (0, _config.set)(internalConfig); // Return the internal config

  return internalConfig;
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/kinvey/initialize.js":
/*!************************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/kinvey/initialize.js ***!
  \************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = initialize;

var _kinvey = _interopRequireDefault(__webpack_require__(/*! ../errors/kinvey */ "./packages/kinvey-html5-sdk/src/errors/kinvey.js"));

/**
 * @deprecated Please use init().
 */
function initialize() {
  return Promise.reject(new _kinvey.default('initialize() has been deprecated. Please use init().'));
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/kinvey/utils.js":
/*!*******************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/kinvey/utils.js ***!
  \*******************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.s4 = s4;
exports.uuidv4 = uuidv4;

function s4() {
  return Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);
}

function uuidv4() {
  return "".concat(s4()).concat(s4(), "-").concat(s4(), "-").concat(s4(), "-").concat(s4(), "-").concat(s4()).concat(s4()).concat(s4());
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/kmd.js":
/*!**********************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/kmd.js ***!
  \**********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _createClass2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/createClass */ "./node_modules/@babel/runtime/helpers/createClass.js"));

var _isPlainObject = _interopRequireDefault(__webpack_require__(/*! lodash/isPlainObject */ "./node_modules/lodash/isPlainObject.js"));

var _kinvey = _interopRequireDefault(__webpack_require__(/*! ./errors/kinvey */ "./packages/kinvey-html5-sdk/src/errors/kinvey.js"));

/**
 * This class provides a way to access the KMD (Kinvey Metadata)
 * information for an entity.
 */
var Kmd =
/*#__PURE__*/
function () {
  function Kmd(entity) {
    (0, _classCallCheck2.default)(this, Kmd);

    if (!(0, _isPlainObject.default)(entity)) {
      throw new _kinvey.default('entity argument must be an object');
    }

    entity._kmd = entity._kmd || {}; // eslint-disable-line no-param-reassign

    this.entity = entity;
  }
  /**
   * Get the auth token.
   *
   * @returns {string} _kmd.authtoken
   */


  (0, _createClass2.default)(Kmd, [{
    key: "isEmailConfirmed",

    /**
     * Checks if an email for a user has been confirmed.
     *
     * @returns {boolean} True if the email has been confirmed otherwise false
     */
    value: function isEmailConfirmed() {
      if (this.emailVerification) {
        return this.emailVerification.status === 'confirmed';
      }

      return false;
    }
    /**
     * Checks if the entity has been created locally.
     *
     * @returns {boolean} True if the entity has been created locally otherwise false
     */

  }, {
    key: "isLocal",
    value: function isLocal() {
      return this.entity._kmd.local === true;
    }
  }, {
    key: "toPlainObject",
    value: function toPlainObject() {
      return this.entity._kmd;
    }
  }, {
    key: "authtoken",
    get: function get() {
      return this.entity._kmd.authtoken;
    }
    /**
     * Get created at time.
     *
     * @returns {Date?} _kmd.ect
     */

  }, {
    key: "ect",
    get: function get() {
      return this.createdAt;
    }
    /**
     * Get created at time.
     *
     * @returns {Date?} _kmd.ect
     */

  }, {
    key: "createdAt",
    get: function get() {
      if (this.entity._kmd.ect) {
        return new Date(this.entity._kmd.ect);
      }

      return undefined;
    }
    /**
     * Get last modified time.
     *
     * @returns {Date?} _kmd.lmt
     */

  }, {
    key: "lmt",
    get: function get() {
      return this.updatedAt;
    }
    /**
     * Get last modified time.
     *
     * @returns {Date?} _kmd.lmt
     */

  }, {
    key: "lastModified",
    get: function get() {
      return this.updatedAt;
    }
    /**
     * Get last modified time.
     *
     * @returns {Date?} _kmd.lmt
     */

  }, {
    key: "updatedAt",
    get: function get() {
      if (this.entity._kmd.lmt) {
        return new Date(this.entity._kmd.lmt);
      }

      return undefined;
    }
    /**
     * Get the email verification details.
     *
     * @returns {Object} _kmd.emailVerification
     */

  }, {
    key: "emailVerification",
    get: function get() {
      if (this.entity._kmd.emailVerification) {
        return this.entity._kmd.emailVerification.status;
      }

      return undefined;
    }
  }]);
  return Kmd;
}();

exports.default = Kmd;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/live.js":
/*!***********************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/live.js ***!
  \***********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.isRegistered = isRegistered;
exports.register = register;
exports.unregister = unregister;
exports.subscribeToChannel = subscribeToChannel;
exports.unsubscribeFromChannel = unsubscribeFromChannel;
exports.Listener = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _createClass2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/createClass */ "./node_modules/@babel/runtime/helpers/createClass.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _isFunction = _interopRequireDefault(__webpack_require__(/*! lodash/isFunction */ "./node_modules/lodash/isFunction.js"));

var _pubnub = _interopRequireDefault(__webpack_require__(/*! pubnub */ "./node_modules/pubnub/dist/web/pubnub.min.js"));

var _events = __webpack_require__(/*! events */ "./node_modules/events/events.js");

var _kinvey = _interopRequireDefault(__webpack_require__(/*! ./errors/kinvey */ "./packages/kinvey-html5-sdk/src/errors/kinvey.js"));

var STATUS_PREFIX = 'status:';
var UNCLASSIFIED_EVENTS = 'pubNubEventsNotRouted';
var pubnub;
var listener;

function isValidChannelName(channelName) {
  return typeof channelName === 'string' && channelName !== '';
}

function isValidReceiver(receiver) {
  if (!receiver) {
    return false;
  }

  var onMessage = receiver.onMessage,
      onError = receiver.onError,
      onStatus = receiver.onStatus;
  return (0, _isFunction.default)(onMessage) || (0, _isFunction.default)(onError) || (0, _isFunction.default)(onStatus);
}

var Listener =
/*#__PURE__*/
function (_EventEmitter) {
  (0, _inherits2.default)(Listener, _EventEmitter);

  function Listener() {
    (0, _classCallCheck2.default)(this, Listener);
    return (0, _possibleConstructorReturn2.default)(this, (0, _getPrototypeOf2.default)(Listener).apply(this, arguments));
  }

  (0, _createClass2.default)(Listener, [{
    key: "message",
    value: function message(m) {
      this.emit(m.channel, m);
    }
  }, {
    key: "status",
    value: function status(s) {
      var _this = this;

      var _s$affectedChannels = s.affectedChannels,
          affectedChannels = _s$affectedChannels === void 0 ? [] : _s$affectedChannels,
          _s$affectedChannelGro = s.affectedChannelGroups,
          affectedChannelGroups = _s$affectedChannelGro === void 0 ? [] : _s$affectedChannelGro;
      var allChannels = affectedChannels.concat(affectedChannelGroups);
      var data = {
        error: s.error,
        category: s.category,
        operation: s.operation
      };

      if (allChannels.length > 0) {
        allChannels.forEach(function (channelOrGroup) {
          _this.emit("".concat(STATUS_PREFIX).concat(channelOrGroup), data);
        });
      } else {
        this.emit(UNCLASSIFIED_EVENTS, data);
      }
    }
  }]);
  return Listener;
}(_events.EventEmitter);

exports.Listener = Listener;

function isRegistered() {
  return !!pubnub && !!listener;
}

function register(config) {
  if (!isRegistered()) {
    pubnub = new _pubnub.default(config);
    listener = new Listener();
    pubnub.addListener(listener);
  }
}

function unregister() {
  if (isRegistered()) {
    pubnub.unsubscribeAll();
    pubnub = null;
    listener.removeAllListeners();
    listener = null;
  }
}

function subscribeToChannel(channelName) {
  var receiver = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

  if (!isRegistered()) {
    throw new _kinvey.default('Please register for the live service before you subscribe to a channel.');
  }

  var onMessage = receiver.onMessage,
      onError = receiver.onError,
      onStatus = receiver.onStatus;

  if (!isValidChannelName(channelName)) {
    throw new Error('Invalid channel name.');
  }

  if (!isValidReceiver(receiver)) {
    throw new Error('Invalid receiver.');
  }

  if (!isRegistered()) {
    throw new Error('Please register to the Live Service before you subscribe to the channel.');
  }

  if (listener && (0, _isFunction.default)(onMessage)) {
    listener.on(channelName, onMessage);
  }

  if (listener && (0, _isFunction.default)(onError)) {
    listener.on("".concat(STATUS_PREFIX).concat(channelName), function (status) {
      if (status.error) {
        onError(status);
      }
    });
  }

  if (listener && (0, _isFunction.default)(onStatus)) {
    listener.on("".concat(STATUS_PREFIX).concat(channelName), function (status) {
      if (!status.error) {
        onStatus(status);
      }
    });
  }
}

function unsubscribeFromChannel(channelName) {
  if (listener) {
    listener.removeAllListeners(channelName);
    listener.removeAllListeners("".concat(STATUS_PREFIX).concat(channelName));
  }
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/observable.js":
/*!*****************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/observable.js ***!
  \*****************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _createClass2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/createClass */ "./node_modules/@babel/runtime/helpers/createClass.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var _rxjs = __webpack_require__(/*! rxjs */ "./node_modules/rxjs/_esm5/index.js");

var KinveyObservable =
/*#__PURE__*/
function (_Observable) {
  (0, _inherits2.default)(KinveyObservable, _Observable);

  function KinveyObservable() {
    (0, _classCallCheck2.default)(this, KinveyObservable);
    return (0, _possibleConstructorReturn2.default)(this, (0, _getPrototypeOf2.default)(KinveyObservable).apply(this, arguments));
  }

  (0, _createClass2.default)(KinveyObservable, [{
    key: "toPromise",
    value: function toPromise() {
      var _this = this;

      return new Promise(function (resolve, reject) {
        var value;

        _this.subscribe(function (v) {
          value = v;
        }, reject, function () {
          resolve(value);
        });
      });
    }
  }]);
  return KinveyObservable;
}(_rxjs.Observable);

exports.default = KinveyObservable;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/query.js":
/*!************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/query.js ***!
  \************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _createClass2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/createClass */ "./node_modules/@babel/runtime/helpers/createClass.js"));

var _isNumber = _interopRequireDefault(__webpack_require__(/*! lodash/isNumber */ "./node_modules/lodash/isNumber.js"));

var _isString = _interopRequireDefault(__webpack_require__(/*! lodash/isString */ "./node_modules/lodash/isString.js"));

var _isPlainObject = _interopRequireDefault(__webpack_require__(/*! lodash/isPlainObject */ "./node_modules/lodash/isPlainObject.js"));

var _isObject = _interopRequireDefault(__webpack_require__(/*! lodash/isObject */ "./node_modules/lodash/isObject.js"));

var _isEmpty = _interopRequireDefault(__webpack_require__(/*! lodash/isEmpty */ "./node_modules/lodash/isEmpty.js"));

var _isArray = _interopRequireDefault(__webpack_require__(/*! lodash/isArray */ "./node_modules/lodash/isArray.js"));

var _sift = _interopRequireDefault(__webpack_require__(/*! sift */ "./node_modules/sift/src/index.js"));

var _query = _interopRequireDefault(__webpack_require__(/*! ./errors/query */ "./packages/kinvey-html5-sdk/src/errors/query.js"));

var UNSUPPORTED_CONDITIONS = ['$nearSphere'];
var PROTECTED_FIELDS = ['_id', '_acl'];

function nested(obj, dotProperty, value) {
  if (!dotProperty) {
    return value || obj;
  }

  var parts = dotProperty.split('.');
  var currentProperty = parts.shift();
  var currentObj = obj;

  while (currentProperty && typeof currentObj !== 'undefined') {
    currentObj = currentObj[currentProperty];
    currentProperty = parts.shift();
  }

  return typeof currentObj === 'undefined' ? value : currentObj;
}

var Query =
/*#__PURE__*/
function () {
  function Query(query) {
    (0, _classCallCheck2.default)(this, Query);
    var config = Object.assign({}, {
      fields: [],
      filter: {},
      sort: {},
      limit: Infinity,
      skip: 0
    }, query);
    this.fields = config.fields;
    this.filter = config.filter;
    this.sort = config.sort;
    this.limit = config.limit;
    this.skip = config.skip;
  }

  (0, _createClass2.default)(Query, [{
    key: "isSupportedOffline",

    /**
     * Returns true or false depending on if the query is able to be processed offline.
     *
     * @returns {boolean} True if the query is supported offline otherwise false.
     */
    value: function isSupportedOffline() {
      var _this = this;

      return Object.keys(this.filter).reduce(function (supported, key) {
        if (supported) {
          var value = _this.filter[key];
          return UNSUPPORTED_CONDITIONS.some(function (unsupportedConditions) {
            if (!value) {
              return true;
            }

            if (!(0, _isObject.default)(value)) {
              return true;
            }

            return !Object.keys(value).some(function (condition) {
              return condition === unsupportedConditions;
            });
          });
        }

        return supported;
      }, true);
    }
    /**
     * Adds an equal to filter to the query. Requires field to equal value.
     * Any existing filters on field will be discarded.
     * @see https://docs.mongodb.com/manual/reference/operator/query/#comparison
     *
     * @param {string} field Field
     * @param {*} value Value
     * @returns {Query} Query
     */

  }, {
    key: "equalTo",
    value: function equalTo(field, value) {
      return this.addFilter(field, value);
    }
    /**
     * Adds a not equal to filter to the query. Requires field not to equal
     * value.
     * @see https://docs.mongodb.com/manual/reference/operator/query/ne
     *
     * @param {string} field Field
     * @param {*} value Value
     * @returns {Query} Query
     */

  }, {
    key: "notEqualTo",
    value: function notEqualTo(field, value) {
      return this.addFilter(field, '$ne', value);
    }
    /**
     * Adds a contains filter to the query. Requires field to contain at least
     * one of the members of list.
     * @see https://docs.mongodb.com/manual/reference/operator/query/in
     *
     * @param {string} field Field
     * @param {Array} values List of values.
     * @throws {Error} A value is required.
     * @returns {Query} Query
     */

  }, {
    key: "contains",
    value: function contains(field, values) {
      if (!values) {
        throw new _query.default('You must supply a value.');
      }

      if (!Array.isArray(values)) {
        return this.addFilter(field, '$in', [values]);
      }

      return this.addFilter(field, '$in', values);
    }
    /**
     * Adds a not contained in filter to the query. Requires `field` not to
     * contain any of the members of `list`.
     * @see https://docs.mongodb.com/manual/reference/operator/query/nin
     *
     * @param {string} field Field
     * @param {Array} values List of values.
     * @throws {Error} A value is required.
     * @returns {Query} Query
     */

  }, {
    key: "notContainedIn",
    value: function notContainedIn(field, values) {
      if (!values) {
        throw new _query.default('You must supply a value.');
      }

      if (!Array.isArray(values)) {
        return this.addFilter(field, '$nin', [values]);
      }

      return this.addFilter(field, '$nin', values);
    }
    /**
     * Adds a contains all filter to the query. Requires `field` to contain all
     * members of `list`.
     * @see https://docs.mongodb.com/manual/reference/operator/query/all
     *
     * @param {string} field Field
     * @param {object|Array} values List of values.
     * @throws {Error} A value is required.
     * @returns {Query} Query
     */

  }, {
    key: "containsAll",
    value: function containsAll(field, values) {
      if (!values) {
        throw new _query.default('You must supply a value.');
      }

      if (!Array.isArray(values)) {
        return this.addFilter(field, '$all', [values]);
      }

      return this.addFilter(field, '$all', values);
    }
    /**
     * Adds a greater than filter to the query. Requires `field` to be greater
     * than `value`.
     * @see https://docs.mongodb.com/manual/reference/operator/query/gt
     *
     * @param {string} field Field
     * @param {number|string} value Value
     * @throws {Error} The value must be a number or string.
     * @returns {Query} Query
     */

  }, {
    key: "greaterThan",
    value: function greaterThan(field, value) {
      if (!(0, _isNumber.default)(value) && !(0, _isString.default)(value)) {
        throw new _query.default('You must supply a number or string.');
      }

      return this.addFilter(field, '$gt', value);
    }
    /**
     * Adds a greater than or equal to filter to the query. Requires `field` to
     * be greater than or equal to `value`.
     * @see https://docs.mongodb.com/manual/reference/operator/query/gte
     *
     * @param {string} field Field.
     * @param {number|string} value Value.
     * @throws {Error} The value must be a number or string.
     * @returns {Query} Query
     */

  }, {
    key: "greaterThanOrEqualTo",
    value: function greaterThanOrEqualTo(field, value) {
      if (!(0, _isNumber.default)(value) && !(0, _isString.default)(value)) {
        throw new _query.default('You must supply a number or string.');
      }

      return this.addFilter(field, '$gte', value);
    }
    /**
     * Adds a less than filter to the query. Requires `field` to be less than
     * `value`.
     * @see https://docs.mongodb.com/manual/reference/operator/query/lt
     *
     * @param {string} field Field
     * @param {number|string} value Value
     * @throws {Error} The value must be a number or string.
     * @returns {Query} Query
     */

  }, {
    key: "lessThan",
    value: function lessThan(field, value) {
      if (!(0, _isNumber.default)(value) && !(0, _isString.default)(value)) {
        throw new _query.default('You must supply a number or string.');
      }

      return this.addFilter(field, '$lt', value);
    }
    /**
     * Adds a less than or equal to filter to the query. Requires `field` to be
     * less than or equal to `value`.
     * @see https://docs.mongodb.com/manual/reference/operator/query/lte
     *
     * @param {string} field Field
     * @param {number|string} value Value
     * @throws {Error} The value must be a number or string.
     * @returns {Query} Query
     */

  }, {
    key: "lessThanOrEqualTo",
    value: function lessThanOrEqualTo(field, value) {
      if (!(0, _isNumber.default)(value) && !(0, _isString.default)(value)) {
        throw new _query.default('You must supply a number or string.');
      }

      return this.addFilter(field, '$lte', value);
    }
    /**
     * Adds an exists filter to the query. Requires `field` to exist if `flag` is
     * `true`, or not to exist if `flag` is `false`.
     * @see https://docs.mongodb.com/manual/reference/operator/query/exists
     *
     * @param {string} field Field
     * @param {boolean} [flag=true] The exists flag.
     * @returns {Query} Query
     */

  }, {
    key: "exists",
    value: function exists(field) {
      var flag = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;
      return this.addFilter(field, '$exists', flag === true);
    }
    /**
     * Adds a modulus filter to the query. Requires `field` modulo `divisor` to
     * have remainder `remainder`.
     * @see https://docs.mongodb.com/manual/reference/operator/query/mod
     *
     * @param {string} field Field
     * @param {number} divisor Divisor
     * @param {number} [remainder=0] Remainder
     * @throws {Error} The divisor must be a number.
     * @throws {Error} The remainder must be a number.
     * @returns {Query} Query
     */

  }, {
    key: "mod",
    value: function mod(field, divisor) {
      var remainder = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;

      if (!(0, _isNumber.default)(divisor)) {
        throw new _query.default('divisor must be a number');
      }

      if (!(0, _isNumber.default)(remainder)) {
        throw new _query.default('remainder must be a number');
      }

      return this.addFilter(field, '$mod', [divisor, remainder]);
    }
    /**
     * Adds a match filter to the query. Requires `field` to match `regExp`.
     * @see https://docs.mongodb.com/manual/reference/operator/query/regex
     *
     * @param {string} field Field
     * @param {RegExp|string} regExp Regular expression.
     * @param {Object} [options] Options
     * @param {boolean} [options.ignoreCase=inherit] Toggles case-insensitivity.
     * @param {boolean} [options.multiline=inherit] Toggles multiline matching.
     * @param {boolean} [options.extended=false] Toggles extended capability.
     * @param {boolean} [options.dotMatchesAll=false] Toggles dot matches all.
     * @throws {Error} The regExp must have '^' at the beginning of the expression to make it an anchored expression.
     * @throws {Error} The ignoreCase flag is not supported.
     * @returns {Query} Query
     */

  }, {
    key: "matches",
    value: function matches(field, expression) {
      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
      var flags = [];
      var regExp = expression;

      if (!(regExp instanceof RegExp)) {
        regExp = new RegExp(regExp);
      }

      if (regExp.source.indexOf('^') !== 0) {
        throw new _query.default('regExp must have \'^\' at the beginning of the expression to make it an anchored expression.');
      }

      if ((regExp.ignoreCase || options.ignoreCase) && options.ignoreCase !== false) {
        throw new _query.default('ignoreCase flag is not supported');
      }

      if ((regExp.multiline || options.multiline) && options.multiline !== false) {
        flags.push('m');
      }

      if (options.extended === true) {
        flags.push('x');
      }

      if (options.dotMatchesAll === true) {
        flags.push('s');
      }

      if (flags.length > 0) {
        this.addFilter(field, '$options', flags.join(''));
      }

      return this.addFilter(field, '$regex', regExp.source);
    }
    /**
     * Adds a near filter to the query. Requires `field` to be a coordinate
     * within `maxDistance` of `coord`. Sorts documents from nearest to farthest.
     * @see https://docs.mongodb.com/manual/reference/operator/query/near
     *
     * @param {string} field The field.
     * @param {Array<number, number>} coord The coordinate (longitude, latitude).
     * @param {number} [maxDistance] The maximum distance (miles).
     * @throws {Error} The coord must be a [number, number].
     * @returns {Query} Query
     */

  }, {
    key: "near",
    value: function near(field, coord, maxDistance) {
      if (!Array.isArray(coord) || !(0, _isNumber.default)(coord[0]) || !(0, _isNumber.default)(coord[1])) {
        throw new _query.default('coord must be a [number, number]');
      }

      var result = this.addFilter(field, '$nearSphere', [coord[0], coord[1]]);

      if ((0, _isNumber.default)(maxDistance)) {
        this.addFilter(field, '$maxDistance', maxDistance);
      }

      return result;
    }
    /**
     * Adds a within box filter to the query. Requires `field` to be a coordinate
     * within the bounds of the rectangle defined by `bottomLeftCoord`,
     * `bottomRightCoord`.
     * @see https://docs.mongodb.com/manual/reference/operator/query/box
     *
     * @param {string} field The field.
     * @param {Array<number, number>} bottomLeftCoord The bottom left coordinate (longitude, latitude).
     * @param {Array<number, number>} upperRightCoord The bottom right coordinate (longitude, latitude).
     * @throws {Error} The bottomLeftCoord must be a [number, number].
     * @throws {Error} The upperRightCoord must be a [number, number].
     * @returns {Query} Query
     */

  }, {
    key: "withinBox",
    value: function withinBox(field, bottomLeftCoord, upperRightCoord) {
      if (!Array.isArray(bottomLeftCoord) || !(0, _isNumber.default)(bottomLeftCoord[0]) || !(0, _isNumber.default)(bottomLeftCoord[1])) {
        throw new _query.default('bottomLeftCoord must be a [number, number]');
      }

      if (!Array.isArray(upperRightCoord) || !(0, _isNumber.default)(upperRightCoord[0]) || !(0, _isNumber.default)(upperRightCoord[1])) {
        throw new _query.default('upperRightCoord must be a [number, number]');
      }

      var coords = [[bottomLeftCoord[0], bottomLeftCoord[1]], [upperRightCoord[0], upperRightCoord[1]]];
      return this.addFilter(field, '$within', {
        $box: coords
      });
    }
    /**
     * Adds a within polygon filter to the query. Requires `field` to be a
     * coordinate within the bounds of the polygon defined by `coords`.
     * @see https://docs.mongodb.com/manual/reference/operator/query/polygon
     *
     * @param {string} field The field.
     * @param {Array<Array<number, number>>} coords List of coordinates.
     * @throws {Error} The coords must be a [[number, number]].
     * @returns {Query} Query
     */

  }, {
    key: "withinPolygon",
    value: function withinPolygon(field, coords) {
      if (Array.isArray(coords) === false || coords.length === 0 || coords[0].length > 3) {
        throw new _query.default('coords must be a [[number, number]]');
      }

      var withinCoords = coords.map(function (coord) {
        if (!(0, _isNumber.default)(coord[0]) || !(0, _isNumber.default)(coord[1])) {
          throw new _query.default('coords argument must be a [number, number]');
        }

        return [coord[0], coord[1]];
      });
      return this.addFilter(field, '$within', {
        $polygon: withinCoords
      });
    }
    /**
     * Adds a size filter to the query. Requires `field` to be an `Array` with
     * exactly `size` members.
     * @see https://docs.mongodb.com/manual/reference/operator/query/size
     *
     * @param {string} field Field
     * @param {number} size Size
     * @throws {Error} The size must be a number.
     * @returns {Query} Query
     */

  }, {
    key: "size",
    value: function size(field, _size) {
      if (!(0, _isNumber.default)(_size)) {
        throw new _query.default('size must be a number');
      }

      return this.addFilter(field, '$size', _size);
    }
    /**
     * Adds an ascending sort modifier to the query. Sorts by `field`, ascending.
     *
     * @param {string} field Field
     * @returns {Query} Query
     */

  }, {
    key: "ascending",
    value: function ascending(field) {
      if (this._parent) {
        this._parent.ascending(field);
      } else {
        if (!this.sort) {
          this.sort = {};
        }

        this.sort[field] = 1;
      }

      return this;
    }
    /**
     * Adds an descending sort modifier to the query. Sorts by `field`,
     * descending.
     *
     * @param {string} field Field
     * @returns {Query} Query
     */

  }, {
    key: "descending",
    value: function descending(field) {
      if (this._parent) {
        this._parent.descending(field);
      } else {
        if (!this.sort) {
          this.sort = {};
        }

        this.sort[field] = -1;
      }

      return this;
    }
    /**
     * Performs a logical AND operation on the query and the provided queries.
     * @see https://docs.mongodb.com/manual/reference/operator/query/and
     *
     * @param {...Query|...Object} args Queries
     * @throws {Error} Queries must be an array of Query instances or objects.
     * @returns {Query} Query
     */

  }, {
    key: "and",
    value: function and() {
      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
        args[_key] = arguments[_key];
      }

      // AND has highest precedence. Therefore, even if this query is part of a
      // JOIN already, apply it on this query.
      return this.join('$and', args);
    }
    /**
     * Performs a logical NOR operation on the query and the provided queries.
     * @see https://docs.mongodb.com/manual/reference/operator/query/nor
     *
     * @param {...Query|...Object} args Queries
     * @throws {Error} Queries must be an array of Query instances or objects.
     * @returns {Query} Query
     */

  }, {
    key: "nor",
    value: function nor() {
      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
        args[_key2] = arguments[_key2];
      }

      // NOR is preceded by AND. Therefore, if this query is part of an AND-join,
      // apply the NOR onto the parent to make sure AND indeed precedes NOR.
      if (this._parent && Object.hasOwnProperty.call(this._parent.filter, '$and')) {
        var _this$_parent;

        return (_this$_parent = this._parent).nor.apply(_this$_parent, args);
      }

      return this.join('$nor', args);
    }
    /**
     * Performs a logical OR operation on the query and the provided queries.
     * @see https://docs.mongodb.com/manual/reference/operator/query/or
     *
     * @param {...Query|...Object} args Queries.
     * @throws {Error} Queries must be an array of Query instances or objects.
     * @returns {Query} Query
     */

  }, {
    key: "or",
    value: function or() {
      for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
        args[_key3] = arguments[_key3];
      }

      // OR has lowest precedence. Therefore, if this query is part of any join,
      // apply the OR onto the parent to make sure OR has indeed the lowest
      // precedence.
      if (this._parent) {
        var _this$_parent2;

        return (_this$_parent2 = this._parent).or.apply(_this$_parent2, args);
      }

      return this.join('$or', args);
    }
    /**
     * Returns query string representation of the query as a JavaScript object.
     *
     * @returns {Object} Query string object.
     */

  }, {
    key: "toQueryObject",
    value: function toQueryObject() {
      var queryObject = {};

      if (Object.keys(this.filter).length > 0) {
        queryObject.query = this.filter;
      }

      if (this.fields.length > 0) {
        queryObject.fields = this.fields.join(',');
      }

      if ((0, _isNumber.default)(this.limit) && this.limit < Infinity) {
        queryObject.limit = this.limit;
      }

      if ((0, _isNumber.default)(this.skip) && this.skip > 0) {
        queryObject.skip = this.skip;
      }

      if (this.sort && Object.keys(this.sort).length > 0) {
        queryObject.sort = this.sort;
      }

      var keys = Object.keys(queryObject);
      keys.forEach(function (key) {
        queryObject[key] = (0, _isString.default)(queryObject[key]) ? queryObject[key] : JSON.stringify(queryObject[key]);
      });
      return queryObject;
    }
    /**
     * @deprecated
     * Please use Query.prototype.toQueryObject() instead.
     */

  }, {
    key: "toQueryString",
    value: function toQueryString() {
      return this.toQueryObject();
    }
    /**
     * Returns Object representation of the query.
     *
     * @returns {Object} Object
     */

  }, {
    key: "toPlainObject",
    value: function toPlainObject() {
      if (this._parent) {
        return this._parent.toPlainObject();
      } // Return set of parameters.


      var json = {
        fields: this.fields,
        filter: this.filter,
        sort: this.sort,
        skip: this.skip,
        limit: this.limit
      };
      return json;
    }
    /**
     * Returns query string representation of the query.
     *
     * @return {string} Query string string.
     */

  }, {
    key: "toString",
    value: function toString() {
      return JSON.stringify(this.toQueryString());
    }
    /**
     * @private
     * Adds a filter to the query.
     *
     * @param {string} field Field
     * @param {string} condition Condition
     * @param {*} values Values
     * @returns {Query} Query
     */

  }, {
    key: "addFilter",
    value: function addFilter(field) {
      var _ref = (arguments.length <= 1 ? 0 : arguments.length - 1) === 2 ? {
        condition: arguments.length <= 1 ? undefined : arguments[1],
        values: arguments.length <= 2 ? undefined : arguments[2]
      } : {
        condition: undefined,
        values: arguments.length <= 1 ? undefined : arguments[1]
      },
          condition = _ref.condition,
          values = _ref.values;

      if (!this.filter) {
        this.filter = {};
      }

      if (condition) {
        if (!this.filter[field]) {
          this.filter[field] = {};
        }

        this.filter[field][condition] = values;
      } else {
        this.filter[field] = values;
      }

      return this;
    }
    /**
     * @private
     * Joins the current query with another query using an operator.
     *
     * @param {string} operator Operator
     * @param {Query[]|object[]} queries Queries
     * @throws {Error} Queries must be an array of Query instances or objects.
     * @returns {Query} Query
     */

  }, {
    key: "join",
    value: function join(operator, queries) {
      var _this2 = this;

      var that = this;
      var filters = queries.map(function (query) {
        return query.filter;
      });

      if (filters.length === 0) {
        that = new Query();
        filters = [that.filter];
        that._parent = this; // Required for operator precedence
      }

      var currentFilter = Object.keys(this.filter).reduce(function (filter, key) {
        // eslint-disable-next-line no-param-reassign
        filter[key] = _this2.filter[key];
        delete _this2.filter[key];
        return filter;
      }, {});
      this.addFilter(operator, [currentFilter].concat(filters));
      return that;
    }
  }, {
    key: "process",
    value: function process() {
      var _this3 = this;

      var docs = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];

      if (!Array.isArray(docs)) {
        throw new Error('data argument must be of type: Array.');
      }

      if (!this.isSupportedOffline()) {
        throw new Error('This query is not able to run locally.');
      }

      if (docs.length > 0) {
        var processedDocs;

        if (this.filter && !(0, _isEmpty.default)(this.filter)) {
          processedDocs = (0, _sift.default)(this.filter, docs);
        } else {
          processedDocs = docs;
        }

        if (!(0, _isEmpty.default)(this.sort)) {
          // eslint-disable-next-line arrow-body-style
          processedDocs.sort(function (a, b) {
            return Object.keys(_this3.sort).reduce(function (result, field) {
              if (typeof result !== 'undefined') {
                return result;
              }

              if (Object.prototype.hasOwnProperty.call(_this3.sort, field)) {
                var aField = nested(a, field);
                var bField = nested(b, field);
                var modifier = _this3.sort[field]; // -1 (descending) or 1 (ascending)

                if (aField !== null && typeof aField !== 'undefined' && (bField === null || typeof bField === 'undefined')) {
                  return 1 * modifier;
                } else if (bField !== null && typeof bField !== 'undefined' && (aField === null || typeof aField === 'undefined')) {
                  return -1 * modifier;
                } else if (typeof aField === 'undefined' && bField === null) {
                  return 0;
                } else if (aField === null && typeof bField === 'undefined') {
                  return 0;
                } else if (aField !== bField) {
                  return (aField < bField ? -1 : 1) * modifier;
                }
              }

              return 0;
            }, undefined);
          });
        }

        if (this.skip > 0) {
          if (this.limit < Infinity) {
            processedDocs = processedDocs.slice(this.skip, this.skip + this.limit);
          } else {
            processedDocs = processedDocs.slice(this.skip);
          }
        } else if (this.limit < Infinity) {
          processedDocs = processedDocs.slice(0, this.limit);
        }

        if ((0, _isArray.default)(this.fields) && this.fields.length > 0) {
          processedDocs = processedDocs.map(function (doc) {
            var modifiedDoc = doc;
            Object.keys(modifiedDoc).forEach(function (key) {
              if (_this3.fields.indexOf(key) === -1 && PROTECTED_FIELDS.indexOf(key) === -1) {
                delete modifiedDoc[key];
              }
            });
            return modifiedDoc;
          });
        }

        return processedDocs;
      }

      return docs;
    }
  }, {
    key: "fields",
    get: function get() {
      return this._fields;
    },
    set: function set(fields) {
      if (!Array.isArray(fields)) {
        throw new _query.default('fields must be an Array');
      }

      if (this._parent) {
        this._parent.fields = fields;
      } else {
        this._fields = fields;
      }
    }
  }, {
    key: "sort",
    get: function get() {
      return this._sort;
    },
    set: function set(sort) {
      if (sort && !(0, _isPlainObject.default)(sort)) {
        throw new _query.default('sort must an Object');
      }

      if (this._parent) {
        this._parent.sort = sort;
      } else {
        this._sort = sort;
      }
    }
  }, {
    key: "limit",
    get: function get() {
      return this._limit;
    },
    set: function set(limit) {
      var _limit = limit;

      if ((0, _isString.default)(_limit)) {
        _limit = parseFloat(_limit);
      }

      if (limit && !(0, _isNumber.default)(_limit)) {
        throw new _query.default('limit must be a number');
      }

      if (this._parent) {
        this._parent.limit = _limit;
      } else {
        this._limit = _limit;
      }
    }
  }, {
    key: "skip",
    get: function get() {
      return this._skip;
    },
    set: function set(skip) {
      var _skip = skip;

      if ((0, _isString.default)(_skip)) {
        _skip = parseFloat(_skip);
      }

      if (!(0, _isNumber.default)(_skip)) {
        throw new _query.default('skip must be a number');
      }

      if (this._parent) {
        this._parent.skip = _skip;
      } else {
        this._skip = _skip;
      }
    }
  }]);
  return Query;
}();

exports.default = Query;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/session/index.js":
/*!********************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/session/index.js ***!
  \********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});

var _session = __webpack_require__(/*! ./session */ "./packages/kinvey-html5-sdk/src/session/session.js");

Object.keys(_session).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _session[key];
    }
  });
});

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/session/session.js":
/*!**********************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/session/session.js ***!
  \**********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.get = get;
exports.set = set;
exports.remove = remove;

var _utils = __webpack_require__(/*! ./utils */ "./packages/kinvey-html5-sdk/src/session/utils.js");

function get() {
  var key = (0, _utils.getKey)();
  var session = window.localStorage.getItem(key);

  if (session) {
    return JSON.parse(session);
  }

  return null;
}

function set(session) {
  var key = (0, _utils.getKey)();
  window.localStorage.setItem(key, JSON.stringify(session));
  return true;
}

function remove() {
  var key = (0, _utils.getKey)();
  window.localStorage.removeItem(key);
  return true;
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/session/utils.js":
/*!********************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/session/utils.js ***!
  \********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getKey = getKey;

var _config = __webpack_require__(/*! ../kinvey/config */ "./packages/kinvey-html5-sdk/src/kinvey/config.js");

// eslint-disable-next-line import/prefer-default-export
function getKey() {
  var _getConfig = (0, _config.get)(),
      appKey = _getConfig.appKey;

  return "".concat(appKey, ".active_user");
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/user/exists.js":
/*!******************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/user/exists.js ***!
  \******************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exists;

var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js"));

var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));

var _isString = _interopRequireDefault(__webpack_require__(/*! lodash/isString */ "./node_modules/lodash/isString.js"));

var _config = __webpack_require__(/*! ../kinvey/config */ "./packages/kinvey-html5-sdk/src/kinvey/config.js");

var _kinvey = _interopRequireDefault(__webpack_require__(/*! ../errors/kinvey */ "./packages/kinvey-html5-sdk/src/errors/kinvey.js"));

var _utils = __webpack_require__(/*! ../http/utils */ "./packages/kinvey-html5-sdk/src/http/utils.js");

var _request = __webpack_require__(/*! ../http/request */ "./packages/kinvey-html5-sdk/src/http/request.js");

var _auth = __webpack_require__(/*! ../http/auth */ "./packages/kinvey-html5-sdk/src/http/auth.js");

var RPC_NAMESPACE = 'rpc';

function exists(_x) {
  return _exists.apply(this, arguments);
}

function _exists() {
  _exists = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee(username) {
    var options,
        _getConfig,
        apiProtocol,
        apiHost,
        appKey,
        request,
        response,
        _args = arguments;

    return _regenerator.default.wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            options = _args.length > 1 && _args[1] !== undefined ? _args[1] : {};
            _getConfig = (0, _config.get)(), apiProtocol = _getConfig.apiProtocol, apiHost = _getConfig.apiHost, appKey = _getConfig.appKey;

            if (username) {
              _context.next = 4;
              break;
            }

            throw new _kinvey.default('A username was not provided.');

          case 4:
            if ((0, _isString.default)(username)) {
              _context.next = 6;
              break;
            }

            throw new _kinvey.default('The provided username is not a string.');

          case 6:
            request = new _request.KinveyRequest({
              method: _request.RequestMethod.POST,
              auth: _auth.Auth.App,
              url: (0, _utils.formatKinveyUrl)(apiProtocol, apiHost, "/".concat(RPC_NAMESPACE, "/").concat(appKey, "/check-username-exists")),
              body: {
                username: username
              },
              timeout: options.timeout
            });
            _context.next = 9;
            return request.execute();

          case 9:
            response = _context.sent;
            return _context.abrupt("return", response.data.usernameExists === true);

          case 11:
          case "end":
            return _context.stop();
        }
      }
    }, _callee, this);
  }));
  return _exists.apply(this, arguments);
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/user/forgotUsername.js":
/*!**************************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/user/forgotUsername.js ***!
  \**************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = forgotUsername;

var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js"));

var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));

var _isString = _interopRequireDefault(__webpack_require__(/*! lodash/isString */ "./node_modules/lodash/isString.js"));

var _config = __webpack_require__(/*! ../kinvey/config */ "./packages/kinvey-html5-sdk/src/kinvey/config.js");

var _kinvey = _interopRequireDefault(__webpack_require__(/*! ../errors/kinvey */ "./packages/kinvey-html5-sdk/src/errors/kinvey.js"));

var _utils = __webpack_require__(/*! ../http/utils */ "./packages/kinvey-html5-sdk/src/http/utils.js");

var _request = __webpack_require__(/*! ../http/request */ "./packages/kinvey-html5-sdk/src/http/request.js");

var _auth = __webpack_require__(/*! ../http/auth */ "./packages/kinvey-html5-sdk/src/http/auth.js");

var RPC_NAMESPACE = 'rpc';

function forgotUsername(_x) {
  return _forgotUsername.apply(this, arguments);
}

function _forgotUsername() {
  _forgotUsername = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee(email) {
    var options,
        _getConfig,
        apiProtocol,
        apiHost,
        appKey,
        request,
        response,
        _args = arguments;

    return _regenerator.default.wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            options = _args.length > 1 && _args[1] !== undefined ? _args[1] : {};
            _getConfig = (0, _config.get)(), apiProtocol = _getConfig.apiProtocol, apiHost = _getConfig.apiHost, appKey = _getConfig.appKey;

            if (email) {
              _context.next = 4;
              break;
            }

            throw new _kinvey.default('An email was not provided.');

          case 4:
            if ((0, _isString.default)(email)) {
              _context.next = 6;
              break;
            }

            throw new _kinvey.default('The provided email is not a string.');

          case 6:
            request = new _request.KinveyRequest({
              method: _request.RequestMethod.POST,
              auth: _auth.Auth.App,
              url: (0, _utils.formatKinveyUrl)(apiProtocol, apiHost, "/".concat(RPC_NAMESPACE, "/").concat(appKey, "/user-forgot-username")),
              body: {
                email: email
              },
              timeout: options.timeout
            });
            _context.next = 9;
            return request.execute();

          case 9:
            response = _context.sent;
            return _context.abrupt("return", response.data);

          case 11:
          case "end":
            return _context.stop();
        }
      }
    }, _callee, this);
  }));
  return _forgotUsername.apply(this, arguments);
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/user/index.js":
/*!*****************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/user/index.js ***!
  \*****************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _exists = _interopRequireDefault(__webpack_require__(/*! ./exists */ "./packages/kinvey-html5-sdk/src/user/exists.js"));

var _forgotUsername = _interopRequireDefault(__webpack_require__(/*! ./forgotUsername */ "./packages/kinvey-html5-sdk/src/user/forgotUsername.js"));

var _login = __webpack_require__(/*! ./login */ "./packages/kinvey-html5-sdk/src/user/login.js");

var _logout = _interopRequireDefault(__webpack_require__(/*! ./logout */ "./packages/kinvey-html5-sdk/src/user/logout.js"));

var _lookup = _interopRequireDefault(__webpack_require__(/*! ./lookup */ "./packages/kinvey-html5-sdk/src/user/lookup.js"));

var _me = _interopRequireDefault(__webpack_require__(/*! ./me */ "./packages/kinvey-html5-sdk/src/user/me.js"));

var _remove = _interopRequireDefault(__webpack_require__(/*! ./remove */ "./packages/kinvey-html5-sdk/src/user/remove.js"));

var _resetPassword = _interopRequireDefault(__webpack_require__(/*! ./resetPassword */ "./packages/kinvey-html5-sdk/src/user/resetPassword.js"));

var _restore = _interopRequireDefault(__webpack_require__(/*! ./restore */ "./packages/kinvey-html5-sdk/src/user/restore.js"));

var _signup = __webpack_require__(/*! ./signup */ "./packages/kinvey-html5-sdk/src/user/signup.js");

var _update = _interopRequireDefault(__webpack_require__(/*! ./update */ "./packages/kinvey-html5-sdk/src/user/update.js"));

var _user = __webpack_require__(/*! ./user */ "./packages/kinvey-html5-sdk/src/user/user.js");

var _verifyEmail = _interopRequireDefault(__webpack_require__(/*! ./verifyEmail */ "./packages/kinvey-html5-sdk/src/user/verifyEmail.js"));

_user.User.exists = _exists.default;
_user.User.forgotUsername = _forgotUsername.default;
_user.User.login = _login.login;
_user.User.loginWithRedirectUri = _login.loginWithRedirectUri;
_user.User.loginWithUsernamePassword = _login.loginWithUsernamePassword;
_user.User.loginWithMIC = _login.loginWithMIC;
_user.User.logout = _logout.default;
_user.User.lookup = _lookup.default;
_user.User.me = _me.default;
_user.User.remove = _remove.default;
_user.User.resetPassword = _resetPassword.default;
_user.User.restore = _restore.default;
_user.User.signup = _signup.signup;
_user.User.update = _update.default;
_user.User.verifyEmail = _verifyEmail.default;
_user.User.getActiveUser = _user.getActiveUser;
var _default = _user.User;
exports.default = _default;

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/user/login.js":
/*!*****************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/user/login.js ***!
  \*****************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireWildcard = __webpack_require__(/*! @babel/runtime/helpers/interopRequireWildcard */ "./node_modules/@babel/runtime/helpers/interopRequireWildcard.js");

var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.login = login;
exports.loginWithRedirectUri = loginWithRedirectUri;
exports.loginWithMIC = loginWithMIC;
exports.loginWithUsernamePassword = loginWithUsernamePassword;

var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js"));

var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));

var _isPlainObject = _interopRequireDefault(__webpack_require__(/*! lodash/isPlainObject */ "./node_modules/lodash/isPlainObject.js"));

var _config = __webpack_require__(/*! ../kinvey/config */ "./packages/kinvey-html5-sdk/src/kinvey/config.js");

var _activeUser = _interopRequireDefault(__webpack_require__(/*! ../errors/activeUser */ "./packages/kinvey-html5-sdk/src/errors/activeUser.js"));

var _kinvey = _interopRequireDefault(__webpack_require__(/*! ../errors/kinvey */ "./packages/kinvey-html5-sdk/src/errors/kinvey.js"));

var _notFound = _interopRequireDefault(__webpack_require__(/*! ../errors/notFound */ "./packages/kinvey-html5-sdk/src/errors/notFound.js"));

var _utils = __webpack_require__(/*! ../http/utils */ "./packages/kinvey-html5-sdk/src/http/utils.js");

var _request = __webpack_require__(/*! ../http/request */ "./packages/kinvey-html5-sdk/src/http/request.js");

var _auth = __webpack_require__(/*! ../http/auth */ "./packages/kinvey-html5-sdk/src/http/auth.js");

var _session = __webpack_require__(/*! ../session */ "./packages/kinvey-html5-sdk/src/session/index.js");

var _user = __webpack_require__(/*! ./user */ "./packages/kinvey-html5-sdk/src/user/user.js");

var _utils2 = __webpack_require__(/*! ./utils */ "./packages/kinvey-html5-sdk/src/user/utils.js");

var MIC = _interopRequireWildcard(__webpack_require__(/*! ./mic */ "./packages/kinvey-html5-sdk/src/user/mic.js"));

var _signup = __webpack_require__(/*! ./signup */ "./packages/kinvey-html5-sdk/src/user/signup.js");

var USER_NAMESPACE = 'user';

function login(_x, _x2) {
  return _login.apply(this, arguments);
}

function _login() {
  _login = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee(username, password) {
    var options,
        _getConfig,
        apiProtocol,
        apiHost,
        appKey,
        activeUser,
        credentials,
        request,
        response,
        session,
        _args = arguments;

    return _regenerator.default.wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            options = _args.length > 2 && _args[2] !== undefined ? _args[2] : {};
            _getConfig = (0, _config.get)(), apiProtocol = _getConfig.apiProtocol, apiHost = _getConfig.apiHost, appKey = _getConfig.appKey;
            activeUser = (0, _user.getActiveUser)();
            credentials = username;

            if (!activeUser) {
              _context.next = 6;
              break;
            }

            throw new _activeUser.default('An active user already exists. Please logout the active user before you login.');

          case 6:
            if (!(0, _isPlainObject.default)(credentials)) {
              credentials = {
                username: username,
                password: password
              };
            }

            if (credentials.username) {
              credentials.username = String(credentials.username).trim();
            }

            if (credentials.password) {
              credentials.password = String(credentials.password).trim();
            }

            if (!((!credentials.username || credentials.username === '' || !credentials.password || credentials.password === '') && !credentials._socialIdentity)) {
              _context.next = 11;
              break;
            }

            throw new _kinvey.default('Username and/or password missing. Please provide both a username and password to login.');

          case 11:
            request = new _request.KinveyRequest({
              method: _request.RequestMethod.POST,
              auth: _auth.Auth.App,
              url: (0, _utils.formatKinveyUrl)(apiProtocol, apiHost, "/".concat(USER_NAMESPACE, "/").concat(appKey, "/login")),
              body: credentials,
              timeout: options.timeout
            });
            _context.next = 14;
            return request.execute();

          case 14:
            response = _context.sent;
            session = response.data; // Remove sensitive data

            delete session.password; // Merge _socialIdentity

            if (credentials._socialIdentity) {
              session._socialIdentity = (0, _utils2.mergeSocialIdentity)(credentials._socialIdentity, session._socialIdentity);
            } // Store the active session


            (0, _session.set)(session); // Return the user

            return _context.abrupt("return", new _user.User(session));

          case 20:
          case "end":
            return _context.stop();
        }
      }
    }, _callee, this);
  }));
  return _login.apply(this, arguments);
}

function loginWithRedirectUri(_x3, _x4) {
  return _loginWithRedirectUri.apply(this, arguments);
}

function _loginWithRedirectUri() {
  _loginWithRedirectUri = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee2(redirectUri, options) {
    var activeUser, session, socialIdentity, credentials;
    return _regenerator.default.wrap(function _callee2$(_context2) {
      while (1) {
        switch (_context2.prev = _context2.next) {
          case 0:
            activeUser = (0, _user.getActiveUser)();

            if (!activeUser) {
              _context2.next = 3;
              break;
            }

            throw new _activeUser.default('An active user already exists. Please logout the active user before you login with Mobile Identity Connect.');

          case 3:
            _context2.next = 5;
            return MIC.loginWithRedirectUri(redirectUri, options);

          case 5:
            session = _context2.sent;
            socialIdentity = {};
            socialIdentity[MIC.IDENTITY] = session;
            credentials = {
              _socialIdentity: socialIdentity
            };
            _context2.prev = 9;
            _context2.next = 12;
            return login(credentials);

          case 12:
            return _context2.abrupt("return", _context2.sent);

          case 15:
            _context2.prev = 15;
            _context2.t0 = _context2["catch"](9);

            if (!(_context2.t0 instanceof _notFound.default)) {
              _context2.next = 21;
              break;
            }

            _context2.next = 20;
            return (0, _signup.signup)(credentials);

          case 20:
            return _context2.abrupt("return", _context2.sent);

          case 21:
            throw _context2.t0;

          case 22:
          case "end":
            return _context2.stop();
        }
      }
    }, _callee2, this, [[9, 15]]);
  }));
  return _loginWithRedirectUri.apply(this, arguments);
}

function loginWithMIC(_x5, _x6, _x7) {
  return _loginWithMIC.apply(this, arguments);
}

function _loginWithMIC() {
  _loginWithMIC = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee3(redirectUri, authorizationGrant, options) {
    return _regenerator.default.wrap(function _callee3$(_context3) {
      while (1) {
        switch (_context3.prev = _context3.next) {
          case 0:
            return _context3.abrupt("return", loginWithRedirectUri(redirectUri, options));

          case 1:
          case "end":
            return _context3.stop();
        }
      }
    }, _callee3, this);
  }));
  return _loginWithMIC.apply(this, arguments);
}

function loginWithUsernamePassword(_x8, _x9, _x10) {
  return _loginWithUsernamePassword.apply(this, arguments);
}

function _loginWithUsernamePassword() {
  _loginWithUsernamePassword = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee4(username, password, options) {
    var activeUser, session, socialIdentity, credentials;
    return _regenerator.default.wrap(function _callee4$(_context4) {
      while (1) {
        switch (_context4.prev = _context4.next) {
          case 0:
            activeUser = (0, _user.getActiveUser)();

            if (!activeUser) {
              _context4.next = 3;
              break;
            }

            throw new _activeUser.default('An active user already exists. Please logout the active user before you login with Mobile Identity Connect.');

          case 3:
            _context4.next = 5;
            return MIC.loginWithUsernamePassword(username, password, options);

          case 5:
            session = _context4.sent;
            socialIdentity = {};
            socialIdentity[MIC.IDENTITY] = session;
            credentials = {
              _socialIdentity: socialIdentity
            };
            _context4.prev = 9;
            _context4.next = 12;
            return login(credentials);

          case 12:
            return _context4.abrupt("return", _context4.sent);

          case 15:
            _context4.prev = 15;
            _context4.t0 = _context4["catch"](9);

            if (!(_context4.t0 instanceof _notFound.default)) {
              _context4.next = 21;
              break;
            }

            _context4.next = 20;
            return (0, _signup.signup)(credentials);

          case 20:
            return _context4.abrupt("return", _context4.sent);

          case 21:
            throw _context4.t0;

          case 22:
          case "end":
            return _context4.stop();
        }
      }
    }, _callee4, this, [[9, 15]]);
  }));
  return _loginWithUsernamePassword.apply(this, arguments);
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/user/logout.js":
/*!******************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/user/logout.js ***!
  \******************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = logout;

var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js"));

var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));

var _user = __webpack_require__(/*! ./user */ "./packages/kinvey-html5-sdk/src/user/user.js");

function logout(_x) {
  return _logout.apply(this, arguments);
}

function _logout() {
  _logout = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee(options) {
    var activeUser;
    return _regenerator.default.wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            activeUser = (0, _user.getActiveUser)();

            if (!activeUser) {
              _context.next = 3;
              break;
            }

            return _context.abrupt("return", activeUser.logout(options));

          case 3:
            return _context.abrupt("return", null);

          case 4:
          case "end":
            return _context.stop();
        }
      }
    }, _callee, this);
  }));
  return _logout.apply(this, arguments);
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/user/lookup.js":
/*!******************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/user/lookup.js ***!
  \******************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = lookup;

var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js"));

var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));

var _observable = _interopRequireDefault(__webpack_require__(/*! ../observable */ "./packages/kinvey-html5-sdk/src/observable.js"));

var _query = _interopRequireDefault(__webpack_require__(/*! ../query */ "./packages/kinvey-html5-sdk/src/query.js"));

var _kinvey = _interopRequireDefault(__webpack_require__(/*! ../errors/kinvey */ "./packages/kinvey-html5-sdk/src/errors/kinvey.js"));

var _config = __webpack_require__(/*! ../kinvey/config */ "./packages/kinvey-html5-sdk/src/kinvey/config.js");

var _utils = __webpack_require__(/*! ../http/utils */ "./packages/kinvey-html5-sdk/src/http/utils.js");

var _request = __webpack_require__(/*! ../http/request */ "./packages/kinvey-html5-sdk/src/http/request.js");

var _auth = __webpack_require__(/*! ../http/auth */ "./packages/kinvey-html5-sdk/src/http/auth.js");

var USER_NAMESPACE = 'user';

function lookup(query) {
  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

  var stream = _observable.default.create(
  /*#__PURE__*/
  function () {
    var _ref = (0, _asyncToGenerator2.default)(
    /*#__PURE__*/
    _regenerator.default.mark(function _callee(observer) {
      var _getConfig, apiProtocol, apiHost, appKey, request, response;

      return _regenerator.default.wrap(function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              _context.prev = 0;

              if (!(query && !(query instanceof _query.default))) {
                _context.next = 3;
                break;
              }

              throw new _kinvey.default('Invalid query. It must be an instance of the Query class.');

            case 3:
              _getConfig = (0, _config.get)(), apiProtocol = _getConfig.apiProtocol, apiHost = _getConfig.apiHost, appKey = _getConfig.appKey;
              request = new _request.KinveyRequest({
                method: _request.RequestMethod.POST,
                auth: _auth.Auth.Default,
                url: (0, _utils.formatKinveyUrl)(apiProtocol, apiHost, "/".concat(USER_NAMESPACE, "/").concat(appKey, "/_lookup")),
                body: query ? query.filter : undefined,
                timeout: options.timeout
              });
              _context.next = 7;
              return request.execute();

            case 7:
              response = _context.sent;
              observer.next(response.data);
              observer.complete();
              _context.next = 15;
              break;

            case 12:
              _context.prev = 12;
              _context.t0 = _context["catch"](0);
              observer.error(_context.t0);

            case 15:
            case "end":
              return _context.stop();
          }
        }
      }, _callee, this, [[0, 12]]);
    }));

    return function (_x) {
      return _ref.apply(this, arguments);
    };
  }());

  return stream;
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/user/me.js":
/*!**************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/user/me.js ***!
  \**************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = me;

var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js"));

var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));

var _user = __webpack_require__(/*! ./user */ "./packages/kinvey-html5-sdk/src/user/user.js");

function me() {
  return _me.apply(this, arguments);
}

function _me() {
  _me = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee() {
    var activeUser;
    return _regenerator.default.wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            activeUser = (0, _user.getActiveUser)();

            if (!activeUser) {
              _context.next = 3;
              break;
            }

            return _context.abrupt("return", activeUser.me());

          case 3:
            return _context.abrupt("return", null);

          case 4:
          case "end":
            return _context.stop();
        }
      }
    }, _callee, this);
  }));
  return _me.apply(this, arguments);
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/user/mic.js":
/*!***************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/user/mic.js ***!
  \***************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.loginWithRedirectUri = loginWithRedirectUri;
exports.loginWithUsernamePassword = loginWithUsernamePassword;
exports.IDENTITY = void 0;

var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js"));

var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));

var _isString = _interopRequireDefault(__webpack_require__(/*! lodash/isString */ "./node_modules/lodash/isString.js"));

var _urlJoin = _interopRequireDefault(__webpack_require__(/*! url-join */ "./node_modules/url-join/lib/url-join.js"));

var _url = __webpack_require__(/*! url */ "./node_modules/url/url.js");

var _jsBase = __webpack_require__(/*! js-base64 */ "./node_modules/js-base64/base64.js");

var _config = __webpack_require__(/*! ../kinvey/config */ "./packages/kinvey-html5-sdk/src/kinvey/config.js");

var _utils = __webpack_require__(/*! ../http/utils */ "./packages/kinvey-html5-sdk/src/http/utils.js");

var _request = __webpack_require__(/*! ../http/request */ "./packages/kinvey-html5-sdk/src/http/request.js");

var _popup = _interopRequireDefault(__webpack_require__(/*! ./popup */ "./packages/kinvey-html5-sdk/src/user/popup.js"));

var _kinvey = _interopRequireDefault(__webpack_require__(/*! ../errors/kinvey */ "./packages/kinvey-html5-sdk/src/errors/kinvey.js"));

var IDENTITY = 'kinveyAuth';
exports.IDENTITY = IDENTITY;

function getVersion() {
  var version = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 3;
  return String(version).indexOf('v') === 0 ? version : "v".concat(version);
}

function loginWithPopup(clientId, redirectUri, version) {
  return new Promise(
  /*#__PURE__*/
  function () {
    var _ref = (0, _asyncToGenerator2.default)(
    /*#__PURE__*/
    _regenerator.default.mark(function _callee(resolve, reject) {
      var _getConfig, authProtocol, authHost, query, url, popup, redirected;

      return _regenerator.default.wrap(function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              _getConfig = (0, _config.get)(), authProtocol = _getConfig.authProtocol, authHost = _getConfig.authHost;
              query = {
                client_id: clientId,
                redirect_uri: redirectUri,
                response_type: 'code',
                scope: 'openid'
              };
              url = (0, _utils.formatKinveyUrl)(authProtocol, authHost, (0, _urlJoin.default)(getVersion(version), '/oauth/auth'), query);
              popup = (0, _popup.default)(url);
              redirected = false;
              popup.onLoaded(function (event) {
                try {
                  if (event.url && event.url.indexOf(redirectUri) === 0 && redirected === false) {
                    var parsedUrl = (0, _url.parse)(event.url, true); // eslint-disable-next-line camelcase

                    var _ref2 = parsedUrl.query || {},
                        code = _ref2.code,
                        error = _ref2.error,
                        error_description = _ref2.error_description;

                    redirected = true;
                    popup.removeAllListeners();
                    popup.close();

                    if (code) {
                      resolve(code);
                    } else if (error) {
                      reject(new _kinvey.default(error, error_description));
                    } else {
                      reject(new _kinvey.default('No code or error was provided.'));
                    }
                  }
                } catch (error) {// Just catch the error
                }
              });
              popup.onClosed(function () {
                if (!redirected) {
                  popup.removeAllListeners();
                  reject(new _kinvey.default('Login has been cancelled.'));
                }
              });

            case 7:
            case "end":
              return _context.stop();
          }
        }
      }, _callee, this);
    }));

    return function (_x, _x2) {
      return _ref.apply(this, arguments);
    };
  }());
}

function getTokenWithCode(_x3, _x4, _x5) {
  return _getTokenWithCode.apply(this, arguments);
}

function _getTokenWithCode() {
  _getTokenWithCode = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee2(code, clientId, redirectUri) {
    var options,
        _getConfig2,
        authProtocol,
        authHost,
        request,
        response,
        token,
        _args2 = arguments;

    return _regenerator.default.wrap(function _callee2$(_context2) {
      while (1) {
        switch (_context2.prev = _context2.next) {
          case 0:
            options = _args2.length > 3 && _args2[3] !== undefined ? _args2[3] : {};
            _getConfig2 = (0, _config.get)(), authProtocol = _getConfig2.authProtocol, authHost = _getConfig2.authHost;
            request = new _request.KinveyRequest({
              method: _request.RequestMethod.POST,
              headers: {
                'Content-Type': 'application/x-www-form-urlencoded',
                Authorization: function Authorization() {
                  var _getConfig3 = (0, _config.get)(),
                      appSecret = _getConfig3.appSecret;

                  var credentials = _jsBase.Base64.encode("".concat(clientId, ":").concat(appSecret));

                  return "Basic ".concat(credentials);
                }
              },
              url: (0, _utils.formatKinveyUrl)(authProtocol, authHost, '/oauth/token'),
              body: {
                grant_type: 'authorization_code',
                client_id: clientId,
                redirect_uri: redirectUri,
                code: code
              },
              timeout: options.timeout
            });
            _context2.next = 5;
            return request.execute();

          case 5:
            response = _context2.sent;
            token = response.data;
            return _context2.abrupt("return", Object.assign({}, {
              identity: IDENTITY,
              client_id: clientId,
              redirect_uri: redirectUri,
              protocol: authProtocol,
              host: authHost
            }, token));

          case 8:
          case "end":
            return _context2.stop();
        }
      }
    }, _callee2, this);
  }));
  return _getTokenWithCode.apply(this, arguments);
}

function getTokenWithUsernamePassword(_x6, _x7, _x8) {
  return _getTokenWithUsernamePassword.apply(this, arguments);
}

function _getTokenWithUsernamePassword() {
  _getTokenWithUsernamePassword = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee3(username, password, clientId) {
    var options,
        _getConfig4,
        authProtocol,
        authHost,
        request,
        response,
        token,
        _args3 = arguments;

    return _regenerator.default.wrap(function _callee3$(_context3) {
      while (1) {
        switch (_context3.prev = _context3.next) {
          case 0:
            options = _args3.length > 3 && _args3[3] !== undefined ? _args3[3] : {};
            _getConfig4 = (0, _config.get)(), authProtocol = _getConfig4.authProtocol, authHost = _getConfig4.authHost;
            request = new _request.KinveyRequest({
              method: _request.RequestMethod.POST,
              headers: {
                'Content-Type': 'application/x-www-form-urlencoded',
                Authorization: function Authorization() {
                  var _getConfig5 = (0, _config.get)(),
                      appSecret = _getConfig5.appSecret;

                  var credentials = _jsBase.Base64.encode("".concat(clientId, ":").concat(appSecret));

                  return "Basic ".concat(credentials);
                }
              },
              url: (0, _utils.formatKinveyUrl)(authProtocol, authHost, '/oauth/token'),
              body: {
                grant_type: 'password',
                username: username,
                password: password
              },
              timeout: options.timeout
            });
            _context3.next = 5;
            return request.execute();

          case 5:
            response = _context3.sent;
            token = response.data;
            return _context3.abrupt("return", Object.assign({}, {
              identity: IDENTITY,
              client_id: clientId,
              protocol: authProtocol,
              host: authHost
            }, token));

          case 8:
          case "end":
            return _context3.stop();
        }
      }
    }, _callee3, this);
  }));
  return _getTokenWithUsernamePassword.apply(this, arguments);
}

function loginWithRedirectUri(_x9) {
  return _loginWithRedirectUri.apply(this, arguments);
}

function _loginWithRedirectUri() {
  _loginWithRedirectUri = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee4(redirectUri) {
    var options,
        _getConfig6,
        appKey,
        micId,
        version,
        clientId,
        code,
        token,
        _args4 = arguments;

    return _regenerator.default.wrap(function _callee4$(_context4) {
      while (1) {
        switch (_context4.prev = _context4.next) {
          case 0:
            options = _args4.length > 1 && _args4[1] !== undefined ? _args4[1] : {};
            _getConfig6 = (0, _config.get)(), appKey = _getConfig6.appKey;
            micId = options.micId, version = options.version;
            clientId = appKey;

            if ((0, _isString.default)(redirectUri)) {
              _context4.next = 6;
              break;
            }

            throw new _kinvey.default('A redirectUri is required and must be a string.');

          case 6:
            if ((0, _isString.default)(micId)) {
              clientId = "".concat(clientId, ".").concat(micId);
            }

            _context4.next = 9;
            return loginWithPopup(clientId, redirectUri, version);

          case 9:
            code = _context4.sent;
            _context4.next = 12;
            return getTokenWithCode(code, clientId, redirectUri, options);

          case 12:
            token = _context4.sent;
            return _context4.abrupt("return", token);

          case 14:
          case "end":
            return _context4.stop();
        }
      }
    }, _callee4, this);
  }));
  return _loginWithRedirectUri.apply(this, arguments);
}

function loginWithUsernamePassword(_x10, _x11) {
  return _loginWithUsernamePassword.apply(this, arguments);
}

function _loginWithUsernamePassword() {
  _loginWithUsernamePassword = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee5(username, password) {
    var options,
        _getConfig7,
        appKey,
        micId,
        clientId,
        token,
        _args5 = arguments;

    return _regenerator.default.wrap(function _callee5$(_context5) {
      while (1) {
        switch (_context5.prev = _context5.next) {
          case 0:
            options = _args5.length > 2 && _args5[2] !== undefined ? _args5[2] : {};
            _getConfig7 = (0, _config.get)(), appKey = _getConfig7.appKey;
            micId = options.micId;
            clientId = appKey;

            if (!(!(0, _isString.default)(username) || !(0, _isString.default)(password))) {
              _context5.next = 6;
              break;
            }

            throw new _kinvey.default('A username and password are required and must be a string.');

          case 6:
            if ((0, _isString.default)(micId)) {
              clientId = "".concat(clientId, ".").concat(micId);
            }

            _context5.next = 9;
            return getTokenWithUsernamePassword(username, password, clientId, options);

          case 9:
            token = _context5.sent;
            return _context5.abrupt("return", token);

          case 11:
          case "end":
            return _context5.stop();
        }
      }
    }, _callee5, this);
  }));
  return _loginWithUsernamePassword.apply(this, arguments);
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/user/popup.js":
/*!*****************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/user/popup.js ***!
  \*****************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = open;

var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js"));

var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _createClass2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/createClass */ "./node_modules/@babel/runtime/helpers/createClass.js"));

var _possibleConstructorReturn2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/possibleConstructorReturn */ "./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"));

var _getPrototypeOf2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/getPrototypeOf */ "./node_modules/@babel/runtime/helpers/getPrototypeOf.js"));

var _inherits2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/inherits */ "./node_modules/@babel/runtime/helpers/inherits.js"));

var EventEmitter = __webpack_require__(/*! events */ "./node_modules/events/events.js");

var LOADED_EVENT = 'loaded';
var CLOSED_EVENT = 'closed';
var ERROR_EVENT = 'error';

var Popup =
/*#__PURE__*/
function (_EventEmitter) {
  (0, _inherits2.default)(Popup, _EventEmitter);

  function Popup(popupWindow) {
    var _this;

    (0, _classCallCheck2.default)(this, Popup);
    _this = (0, _possibleConstructorReturn2.default)(this, (0, _getPrototypeOf2.default)(Popup).call(this));
    _this.popupWindow = popupWindow;
    _this.interval = window.setInterval(function () {
      if (popupWindow.closed) {
        _this.close();
      } else {
        try {
          var event = {
            url: popupWindow.location.href
          };

          _this.emit(LOADED_EVENT, event);
        } catch (error) {
          if (error.code !== window.DOMException.SECURITY_ERR) {
            _this.emit(ERROR_EVENT, error);
          }
        }
      }
    }, 100);
    return _this;
  }

  (0, _createClass2.default)(Popup, [{
    key: "isClosed",
    value: function isClosed() {
      return this.popupWindow.closed;
    }
  }, {
    key: "onLoaded",
    value: function onLoaded(listener) {
      return this.on(LOADED_EVENT, listener);
    }
  }, {
    key: "onClosed",
    value: function onClosed(listener) {
      return this.on(CLOSED_EVENT, listener);
    }
  }, {
    key: "onError",
    value: function onError(listener) {
      return this.on(ERROR_EVENT, listener);
    }
  }, {
    key: "close",
    value: function () {
      var _close = (0, _asyncToGenerator2.default)(
      /*#__PURE__*/
      _regenerator.default.mark(function _callee() {
        return _regenerator.default.wrap(function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                if (this.interval) {
                  window.clearInterval(this.interval);
                  this.interval = null;
                }

                if (this.popupWindow && !this.popupWindow.closed) {
                  this.popupWindow.close();
                  this.popupWindow = null;
                }

                this.emit(CLOSED_EVENT);
                return _context.abrupt("return", this);

              case 4:
              case "end":
                return _context.stop();
            }
          }
        }, _callee, this);
      }));

      function close() {
        return _close.apply(this, arguments);
      }

      return close;
    }()
  }], [{
    key: "open",
    value: function open(url) {
      var popupWindow = window.open(url, '_blank', 'toolbar=no,location=no');

      if (!popupWindow) {
        throw new Error('The popup was blocked.');
      }

      return new Popup(popupWindow);
    }
  }]);
  return Popup;
}(EventEmitter);

function open(url) {
  return Popup.open(url);
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/user/remove.js":
/*!******************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/user/remove.js ***!
  \******************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = remove;

var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js"));

var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));

var _isString = _interopRequireDefault(__webpack_require__(/*! lodash/isString */ "./node_modules/lodash/isString.js"));

var _config = __webpack_require__(/*! ../kinvey/config */ "./packages/kinvey-html5-sdk/src/kinvey/config.js");

var _kinvey = _interopRequireDefault(__webpack_require__(/*! ../errors/kinvey */ "./packages/kinvey-html5-sdk/src/errors/kinvey.js"));

var _utils = __webpack_require__(/*! ../http/utils */ "./packages/kinvey-html5-sdk/src/http/utils.js");

var _request = __webpack_require__(/*! ../http/request */ "./packages/kinvey-html5-sdk/src/http/request.js");

var _auth = __webpack_require__(/*! ../http/auth */ "./packages/kinvey-html5-sdk/src/http/auth.js");

var _user = __webpack_require__(/*! ./user */ "./packages/kinvey-html5-sdk/src/user/user.js");

function remove(_x) {
  return _remove.apply(this, arguments);
}

function _remove() {
  _remove = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee(id) {
    var options,
        _getConfig,
        apiProtocol,
        apiHost,
        appKey,
        hard,
        activeUser,
        url,
        request,
        response,
        _args = arguments;

    return _regenerator.default.wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            options = _args.length > 1 && _args[1] !== undefined ? _args[1] : {};
            _getConfig = (0, _config.get)(), apiProtocol = _getConfig.apiProtocol, apiHost = _getConfig.apiHost, appKey = _getConfig.appKey;
            hard = options.hard;
            activeUser = (0, _user.getActiveUser)();

            if (id) {
              _context.next = 6;
              break;
            }

            throw new _kinvey.default('An id was not provided.');

          case 6:
            if ((0, _isString.default)(id)) {
              _context.next = 8;
              break;
            }

            throw new _kinvey.default('The id provided is not a string.');

          case 8:
            // Remove the user from the backend
            url = (0, _utils.formatKinveyUrl)(apiProtocol, apiHost, "/user/".concat(appKey, "/").concat(id), {
              hard: hard ? hard === true : undefined
            });
            request = new _request.KinveyRequest({
              method: _request.RequestMethod.DELETE,
              auth: _auth.Auth.Default,
              url: url,
              timeout: options.timeout
            });
            _context.next = 12;
            return request.execute();

          case 12:
            response = _context.sent;

            if (!(activeUser._id === id)) {
              _context.next = 16;
              break;
            }

            _context.next = 16;
            return activeUser.logout();

          case 16:
            return _context.abrupt("return", response.data);

          case 17:
          case "end":
            return _context.stop();
        }
      }
    }, _callee, this);
  }));
  return _remove.apply(this, arguments);
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/user/resetPassword.js":
/*!*************************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/user/resetPassword.js ***!
  \*************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = resetPassword;

var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js"));

var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));

var _isString = _interopRequireDefault(__webpack_require__(/*! lodash/isString */ "./node_modules/lodash/isString.js"));

var _config = __webpack_require__(/*! ../kinvey/config */ "./packages/kinvey-html5-sdk/src/kinvey/config.js");

var _kinvey = _interopRequireDefault(__webpack_require__(/*! ../errors/kinvey */ "./packages/kinvey-html5-sdk/src/errors/kinvey.js"));

var _utils = __webpack_require__(/*! ../http/utils */ "./packages/kinvey-html5-sdk/src/http/utils.js");

var _request = __webpack_require__(/*! ../http/request */ "./packages/kinvey-html5-sdk/src/http/request.js");

var _auth = __webpack_require__(/*! ../http/auth */ "./packages/kinvey-html5-sdk/src/http/auth.js");

var RPC_NAMESPACE = 'rpc';

function resetPassword(_x) {
  return _resetPassword.apply(this, arguments);
}

function _resetPassword() {
  _resetPassword = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee(username) {
    var options,
        _getConfig,
        apiProtocol,
        apiHost,
        appKey,
        request,
        response,
        _args = arguments;

    return _regenerator.default.wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            options = _args.length > 1 && _args[1] !== undefined ? _args[1] : {};
            _getConfig = (0, _config.get)(), apiProtocol = _getConfig.apiProtocol, apiHost = _getConfig.apiHost, appKey = _getConfig.appKey;

            if (username) {
              _context.next = 4;
              break;
            }

            throw new _kinvey.default('A username was not provided.');

          case 4:
            if ((0, _isString.default)(username)) {
              _context.next = 6;
              break;
            }

            throw new _kinvey.default('The provided username is not a string.');

          case 6:
            request = new _request.KinveyRequest({
              method: _request.RequestMethod.POST,
              auth: _auth.Auth.App,
              url: (0, _utils.formatKinveyUrl)(apiProtocol, apiHost, "/".concat(RPC_NAMESPACE, "/").concat(appKey, "/").concat(username, "/user-password-reset-initiate")),
              timeout: options.timeout
            });
            _context.next = 9;
            return request.execute();

          case 9:
            response = _context.sent;
            return _context.abrupt("return", response.data);

          case 11:
          case "end":
            return _context.stop();
        }
      }
    }, _callee, this);
  }));
  return _resetPassword.apply(this, arguments);
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/user/restore.js":
/*!*******************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/user/restore.js ***!
  \*******************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = restore;

var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js"));

var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));

var _kinvey = _interopRequireDefault(__webpack_require__(/*! ../errors/kinvey */ "./packages/kinvey-html5-sdk/src/errors/kinvey.js"));

function restore() {
  return _restore.apply(this, arguments);
}

function _restore() {
  _restore = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee() {
    return _regenerator.default.wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            throw new _kinvey.default('This function requires a master secret to be provided for your application. We strongly advise not to do this.');

          case 1:
          case "end":
            return _context.stop();
        }
      }
    }, _callee, this);
  }));
  return _restore.apply(this, arguments);
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/user/signup.js":
/*!******************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/user/signup.js ***!
  \******************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.signup = signup;
exports.signupWithIdentity = signupWithIdentity;

var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js"));

var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));

var _isEmpty = _interopRequireDefault(__webpack_require__(/*! lodash/isEmpty */ "./node_modules/lodash/isEmpty.js"));

var _config = __webpack_require__(/*! ../kinvey/config */ "./packages/kinvey-html5-sdk/src/kinvey/config.js");

var _activeUser = _interopRequireDefault(__webpack_require__(/*! ../errors/activeUser */ "./packages/kinvey-html5-sdk/src/errors/activeUser.js"));

var _kinvey = _interopRequireDefault(__webpack_require__(/*! ../errors/kinvey */ "./packages/kinvey-html5-sdk/src/errors/kinvey.js"));

var _utils = __webpack_require__(/*! ../http/utils */ "./packages/kinvey-html5-sdk/src/http/utils.js");

var _request = __webpack_require__(/*! ../http/request */ "./packages/kinvey-html5-sdk/src/http/request.js");

var _auth = __webpack_require__(/*! ../http/auth */ "./packages/kinvey-html5-sdk/src/http/auth.js");

var _session = __webpack_require__(/*! ../session */ "./packages/kinvey-html5-sdk/src/session/index.js");

var _user = __webpack_require__(/*! ./user */ "./packages/kinvey-html5-sdk/src/user/user.js");

var USER_NAMESPACE = 'user';

function signup(_x) {
  return _signup.apply(this, arguments);
}

function _signup() {
  _signup = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee(data) {
    var options,
        _getConfig,
        apiProtocol,
        apiHost,
        appKey,
        activeUser,
        _options$state,
        state,
        url,
        request,
        response,
        session,
        _args = arguments;

    return _regenerator.default.wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            options = _args.length > 1 && _args[1] !== undefined ? _args[1] : {};
            _getConfig = (0, _config.get)(), apiProtocol = _getConfig.apiProtocol, apiHost = _getConfig.apiHost, appKey = _getConfig.appKey;
            activeUser = (0, _user.getActiveUser)();
            _options$state = options.state, state = _options$state === void 0 ? true : _options$state;

            if (!(state === true && activeUser)) {
              _context.next = 6;
              break;
            }

            throw new _activeUser.default('An active user already exists. Please logout the active user before you signup.');

          case 6:
            url = (0, _utils.formatKinveyUrl)(apiProtocol, apiHost, "/".concat(USER_NAMESPACE, "/").concat(appKey));
            request = new _request.KinveyRequest({
              method: _request.RequestMethod.POST,
              auth: _auth.Auth.App,
              url: url,
              timeout: options.timeout
            });

            if (data instanceof _user.User) {
              request.body = (0, _isEmpty.default)(data.data) ? null : data.data;
            } else {
              request.body = (0, _isEmpty.default)(data) ? null : data;
            }

            _context.next = 11;
            return request.execute();

          case 11:
            response = _context.sent;
            session = response.data;

            if (state === true) {
              (0, _session.set)(session);
            }

            return _context.abrupt("return", new _user.User(session));

          case 15:
          case "end":
            return _context.stop();
        }
      }
    }, _callee, this);
  }));
  return _signup.apply(this, arguments);
}

function signupWithIdentity() {
  return _signupWithIdentity.apply(this, arguments);
}

function _signupWithIdentity() {
  _signupWithIdentity = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee2() {
    return _regenerator.default.wrap(function _callee2$(_context2) {
      while (1) {
        switch (_context2.prev = _context2.next) {
          case 0:
            throw new _kinvey.default('This function has been deprecated. You should use MIC to login instead.');

          case 1:
          case "end":
            return _context2.stop();
        }
      }
    }, _callee2, this);
  }));
  return _signupWithIdentity.apply(this, arguments);
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/user/update.js":
/*!******************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/user/update.js ***!
  \******************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = update;

var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js"));

var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));

var _user = __webpack_require__(/*! ./user */ "./packages/kinvey-html5-sdk/src/user/user.js");

function update(_x) {
  return _update.apply(this, arguments);
}

function _update() {
  _update = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee(data) {
    var activeUser;
    return _regenerator.default.wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            activeUser = (0, _user.getActiveUser)();

            if (!activeUser) {
              _context.next = 3;
              break;
            }

            return _context.abrupt("return", activeUser.update(data));

          case 3:
            return _context.abrupt("return", null);

          case 4:
          case "end":
            return _context.stop();
        }
      }
    }, _callee, this);
  }));
  return _update.apply(this, arguments);
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/user/user.js":
/*!****************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/user/user.js ***!
  \****************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getActiveUser = getActiveUser;
exports.User = void 0;

var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js"));

var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));

var _classCallCheck2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/classCallCheck */ "./node_modules/@babel/runtime/helpers/classCallCheck.js"));

var _createClass2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/createClass */ "./node_modules/@babel/runtime/helpers/createClass.js"));

var _isArray = _interopRequireDefault(__webpack_require__(/*! lodash/isArray */ "./node_modules/lodash/isArray.js"));

var _acl = _interopRequireDefault(__webpack_require__(/*! ../acl */ "./packages/kinvey-html5-sdk/src/acl.js"));

var _kmd = _interopRequireDefault(__webpack_require__(/*! ../kmd */ "./packages/kinvey-html5-sdk/src/kmd.js"));

var _session = __webpack_require__(/*! ../session */ "./packages/kinvey-html5-sdk/src/session/index.js");

var _utils = __webpack_require__(/*! ../http/utils */ "./packages/kinvey-html5-sdk/src/http/utils.js");

var _request = __webpack_require__(/*! ../http/request */ "./packages/kinvey-html5-sdk/src/http/request.js");

var _auth = __webpack_require__(/*! ../http/auth */ "./packages/kinvey-html5-sdk/src/http/auth.js");

var _config = __webpack_require__(/*! ../kinvey/config */ "./packages/kinvey-html5-sdk/src/kinvey/config.js");

var _device = __webpack_require__(/*! ../kinvey/device */ "./packages/kinvey-html5-sdk/src/kinvey/device.js");

var _kinvey = _interopRequireDefault(__webpack_require__(/*! ../errors/kinvey */ "./packages/kinvey-html5-sdk/src/errors/kinvey.js"));

var _datastore = __webpack_require__(/*! ../datastore */ "./packages/kinvey-html5-sdk/src/datastore/index.js");

var _utils2 = __webpack_require__(/*! ./utils */ "./packages/kinvey-html5-sdk/src/user/utils.js");

var USER_NAMESPACE = 'user';

var User =
/*#__PURE__*/
function () {
  function User() {
    var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    (0, _classCallCheck2.default)(this, User);
    this.data = data;
  }

  (0, _createClass2.default)(User, [{
    key: "isActive",
    value: function isActive() {
      var activeUser = (0, _session.get)();

      if (activeUser && activeUser._id === this._id) {
        return true;
      }

      return false;
    }
  }, {
    key: "isEmailVerified",
    value: function isEmailVerified() {
      var metadata = this.metadata;

      if (metadata) {
        var status = metadata.emailVerification;
        return status === 'confirmed';
      }

      return false;
    }
  }, {
    key: "me",
    value: function () {
      var _me = (0, _asyncToGenerator2.default)(
      /*#__PURE__*/
      _regenerator.default.mark(function _callee() {
        var options,
            _getConfig,
            apiProtocol,
            apiHost,
            appKey,
            request,
            response,
            data,
            _args = arguments;

        return _regenerator.default.wrap(function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                options = _args.length > 0 && _args[0] !== undefined ? _args[0] : {};
                _getConfig = (0, _config.get)(), apiProtocol = _getConfig.apiProtocol, apiHost = _getConfig.apiHost, appKey = _getConfig.appKey;
                request = new _request.KinveyRequest({
                  method: _request.RequestMethod.GET,
                  auth: _auth.Auth.Session,
                  url: (0, _utils.formatKinveyUrl)(apiProtocol, apiHost, "/".concat(USER_NAMESPACE, "/").concat(appKey, "/_me")),
                  timeout: options.timeout
                });
                _context.next = 5;
                return request.execute();

              case 5:
                response = _context.sent;
                data = response.data; // Remove sensitive data

                delete data.password; // Merge _socialIdentity

                if (data._socialIdentity) {
                  data._socialIdentity = (0, _utils2.mergeSocialIdentity)(this._socialIdentity, data._socialIdentity);
                } // Update the active session


                if (this.isActive()) {
                  (0, _session.set)(data);
                }

                this.data = data;
                return _context.abrupt("return", this);

              case 12:
              case "end":
                return _context.stop();
            }
          }
        }, _callee, this);
      }));

      function me() {
        return _me.apply(this, arguments);
      }

      return me;
    }()
  }, {
    key: "update",
    value: function () {
      var _update = (0, _asyncToGenerator2.default)(
      /*#__PURE__*/
      _regenerator.default.mark(function _callee2(data) {
        var options,
            _getConfig2,
            apiProtocol,
            apiHost,
            appKey,
            body,
            request,
            response,
            updatedData,
            _args2 = arguments;

        return _regenerator.default.wrap(function _callee2$(_context2) {
          while (1) {
            switch (_context2.prev = _context2.next) {
              case 0:
                options = _args2.length > 1 && _args2[1] !== undefined ? _args2[1] : {};
                _getConfig2 = (0, _config.get)(), apiProtocol = _getConfig2.apiProtocol, apiHost = _getConfig2.apiHost, appKey = _getConfig2.appKey;
                body = Object.assign({}, this.data, data);

                if (data) {
                  _context2.next = 5;
                  break;
                }

                throw new _kinvey.default('No user was provided to be updated.');

              case 5:
                if (!(0, _isArray.default)(data)) {
                  _context2.next = 7;
                  break;
                }

                throw new _kinvey.default('Only one user can be updated at one time.');

              case 7:
                if (body._id) {
                  _context2.next = 9;
                  break;
                }

                throw new _kinvey.default('User must have an _id.');

              case 9:
                request = new _request.KinveyRequest({
                  method: _request.RequestMethod.PUT,
                  auth: _auth.Auth.Default,
                  url: (0, _utils.formatKinveyUrl)(apiProtocol, apiHost, "/".concat(USER_NAMESPACE, "/").concat(appKey, "/").concat(this._id)),
                  body: body,
                  timeout: options.timeout
                });
                _context2.next = 12;
                return request.execute();

              case 12:
                response = _context2.sent;
                updatedData = response.data; // Remove sensitive data

                delete updatedData.password; // Merge _socialIdentity

                if (updatedData._socialIdentity) {
                  updatedData._socialIdentity = (0, _utils2.mergeSocialIdentity)(this._socialIdentity, updatedData._socialIdentity);
                } // Update the active session


                if (this.isActive()) {
                  (0, _session.set)(updatedData);
                }

                this.data = updatedData;
                return _context2.abrupt("return", this);

              case 19:
              case "end":
                return _context2.stop();
            }
          }
        }, _callee2, this);
      }));

      function update(_x) {
        return _update.apply(this, arguments);
      }

      return update;
    }()
  }, {
    key: "registerForLiveService",
    value: function () {
      var _registerForLiveService = (0, _asyncToGenerator2.default)(
      /*#__PURE__*/
      _regenerator.default.mark(function _callee3() {
        var _getConfig3, apiProtocol, apiHost, appKey, deviceId, request, response, config;

        return _regenerator.default.wrap(function _callee3$(_context3) {
          while (1) {
            switch (_context3.prev = _context3.next) {
              case 0:
                if (Live.isRegistered()) {
                  _context3.next = 9;
                  break;
                }

                _getConfig3 = (0, _config.get)(), apiProtocol = _getConfig3.apiProtocol, apiHost = _getConfig3.apiHost, appKey = _getConfig3.appKey;
                deviceId = (0, _device.getId)();
                request = new _request.KinveyRequest({
                  method: _request.RequestMethod.POST,
                  auth: _auth.Auth.Session,
                  url: (0, _utils.formatKinveyUrl)(apiProtocol, apiHost, "/".concat(USER_NAMESPACE, "/").concat(appKey, "/").concat(this._id, "/register-realtime")),
                  body: {
                    deviceId: deviceId
                  }
                });
                _context3.next = 6;
                return request.execute();

              case 6:
                response = _context3.sent;
                config = Object.assign({}, {
                  ssl: true,
                  authKey: this.authtoken
                }, response.data);
                Live.register(config);

              case 9:
                return _context3.abrupt("return", true);

              case 10:
              case "end":
                return _context3.stop();
            }
          }
        }, _callee3, this);
      }));

      function registerForLiveService() {
        return _registerForLiveService.apply(this, arguments);
      }

      return registerForLiveService;
    }()
  }, {
    key: "unregisterFromLiveService",
    value: function () {
      var _unregisterFromLiveService = (0, _asyncToGenerator2.default)(
      /*#__PURE__*/
      _regenerator.default.mark(function _callee4() {
        var _getConfig4, apiProtocol, apiHost, appKey, deviceId, request;

        return _regenerator.default.wrap(function _callee4$(_context4) {
          while (1) {
            switch (_context4.prev = _context4.next) {
              case 0:
                if (!Live.isRegistered()) {
                  _context4.next = 7;
                  break;
                }

                _getConfig4 = (0, _config.get)(), apiProtocol = _getConfig4.apiProtocol, apiHost = _getConfig4.apiHost, appKey = _getConfig4.appKey;
                deviceId = (0, _device.getId)();
                request = new _request.KinveyRequest({
                  method: _request.RequestMethod.POST,
                  auth: _auth.Auth.Session,
                  url: (0, _utils.formatKinveyUrl)(apiProtocol, apiHost, "/".concat(USER_NAMESPACE, "/").concat(appKey, "/").concat(this._id, "/unregister-realtime")),
                  body: {
                    deviceId: deviceId
                  }
                });
                _context4.next = 6;
                return request.execute();

              case 6:
                Live.unregister();

              case 7:
                return _context4.abrupt("return", true);

              case 8:
              case "end":
                return _context4.stop();
            }
          }
        }, _callee4, this);
      }));

      function unregisterFromLiveService() {
        return _unregisterFromLiveService.apply(this, arguments);
      }

      return unregisterFromLiveService;
    }()
  }, {
    key: "logout",
    value: function () {
      var _logout = (0, _asyncToGenerator2.default)(
      /*#__PURE__*/
      _regenerator.default.mark(function _callee5() {
        var options,
            _getConfig5,
            apiProtocol,
            apiHost,
            appKey,
            url,
            request,
            _args5 = arguments;

        return _regenerator.default.wrap(function _callee5$(_context5) {
          while (1) {
            switch (_context5.prev = _context5.next) {
              case 0:
                options = _args5.length > 0 && _args5[0] !== undefined ? _args5[0] : {};
                _getConfig5 = (0, _config.get)(), apiProtocol = _getConfig5.apiProtocol, apiHost = _getConfig5.apiHost, appKey = _getConfig5.appKey;

                if (!this.isActive()) {
                  _context5.next = 15;
                  break;
                }

                _context5.prev = 3;
                // TODO: unregister from live service and push
                url = (0, _utils.formatKinveyUrl)(apiProtocol, apiHost, "/".concat(USER_NAMESPACE, "/").concat(appKey, "/_logout"));
                request = new _request.KinveyRequest({
                  method: _request.RequestMethod.POST,
                  auth: _auth.Auth.Session,
                  url: url,
                  timeout: options.timeout
                });
                _context5.next = 8;
                return request.execute();

              case 8:
                _context5.next = 12;
                break;

              case 10:
                _context5.prev = 10;
                _context5.t0 = _context5["catch"](3);

              case 12:
                (0, _session.remove)();
                _context5.next = 15;
                return (0, _datastore.clear)();

              case 15:
                return _context5.abrupt("return", this);

              case 16:
              case "end":
                return _context5.stop();
            }
          }
        }, _callee5, this, [[3, 10]]);
      }));

      function logout() {
        return _logout.apply(this, arguments);
      }

      return logout;
    }()
  }, {
    key: "_id",
    get: function get() {
      if (this.data) {
        return this.data._id;
      }

      return undefined;
    }
  }, {
    key: "_acl",
    get: function get() {
      if (this.data) {
        return new _acl.default(this.data);
      }

      return undefined;
    }
  }, {
    key: "_kmd",
    get: function get() {
      if (this.data) {
        return new _kmd.default(this.data);
      }

      return undefined;
    }
  }, {
    key: "metadata",
    get: function get() {
      return this._kmd;
    }
  }, {
    key: "authtoken",
    get: function get() {
      var kmd = this._kmd;

      if (kmd) {
        return kmd.authtoken;
      }

      return undefined;
    }
  }, {
    key: "_socialIdentity",
    get: function get() {
      return this.data._socialIdentity;
    }
  }, {
    key: "username",
    get: function get() {
      if (this.data) {
        return this.data.username;
      }

      return undefined;
    }
  }, {
    key: "email",
    get: function get() {
      if (this.data) {
        return this.data.email;
      }

      return undefined;
    }
  }]);
  return User;
}();

exports.User = User;

function getActiveUser() {
  var session = (0, _session.get)();

  if (session) {
    return new User(session);
  }

  return null;
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/user/utils.js":
/*!*****************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/user/utils.js ***!
  \*****************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.mergeSocialIdentity = mergeSocialIdentity;

// eslint-disable-next-line import/prefer-default-export
function mergeSocialIdentity() {
  var origSocialIdentity = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
  var newSocialIdentity = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
  var mergedSocialIdentity = JSON.parse(JSON.stringify(origSocialIdentity));
  return Object.keys(newSocialIdentity).reduce(function (socialIdentity, identity) {
    socialIdentity[identity] = Object.assign({}, origSocialIdentity[identity], newSocialIdentity[identity]);
    return socialIdentity;
  }, mergedSocialIdentity);
}

/***/ }),

/***/ "./packages/kinvey-html5-sdk/src/user/verifyEmail.js":
/*!***********************************************************!*\
  !*** ./packages/kinvey-html5-sdk/src/user/verifyEmail.js ***!
  \***********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ "./node_modules/@babel/runtime/helpers/interopRequireDefault.js");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = verifyEmail;

var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ "./node_modules/@babel/runtime/regenerator/index.js"));

var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ "./node_modules/@babel/runtime/helpers/asyncToGenerator.js"));

var _isString = _interopRequireDefault(__webpack_require__(/*! lodash/isString */ "./node_modules/lodash/isString.js"));

var _config = __webpack_require__(/*! ../kinvey/config */ "./packages/kinvey-html5-sdk/src/kinvey/config.js");

var _kinvey = _interopRequireDefault(__webpack_require__(/*! ../errors/kinvey */ "./packages/kinvey-html5-sdk/src/errors/kinvey.js"));

var _utils = __webpack_require__(/*! ../http/utils */ "./packages/kinvey-html5-sdk/src/http/utils.js");

var _request = __webpack_require__(/*! ../http/request */ "./packages/kinvey-html5-sdk/src/http/request.js");

var _auth = __webpack_require__(/*! ../http/auth */ "./packages/kinvey-html5-sdk/src/http/auth.js");

var RPC_NAMESPACE = 'rpc';

function verifyEmail(_x) {
  return _verifyEmail.apply(this, arguments);
}

function _verifyEmail() {
  _verifyEmail = (0, _asyncToGenerator2.default)(
  /*#__PURE__*/
  _regenerator.default.mark(function _callee(username) {
    var options,
        _getConfig,
        apiProtocol,
        apiHost,
        appKey,
        request,
        response,
        _args = arguments;

    return _regenerator.default.wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            options = _args.length > 1 && _args[1] !== undefined ? _args[1] : {};
            _getConfig = (0, _config.get)(), apiProtocol = _getConfig.apiProtocol, apiHost = _getConfig.apiHost, appKey = _getConfig.appKey;

            if (username) {
              _context.next = 4;
              break;
            }

            throw new _kinvey.default('A username was not provided.');

          case 4:
            if ((0, _isString.default)(username)) {
              _context.next = 6;
              break;
            }

            throw new _kinvey.default('The provided username is not a string.');

          case 6:
            request = new _request.KinveyRequest({
              method: _request.RequestMethod.POST,
              auth: _auth.Auth.App,
              url: (0, _utils.formatKinveyUrl)(apiProtocol, apiHost, "/".concat(RPC_NAMESPACE, "/").concat(appKey, "/").concat(username, "/user-email-verification-initiate")),
              timeout: options.timeout
            });
            _context.next = 9;
            return request.execute();

          case 9:
            response = _context.sent;
            return _context.abrupt("return", response.data);

          case 11:
          case "end":
            return _context.stop();
        }
      }
    }, _callee, this);
  }));
  return _verifyEmail.apply(this, arguments);
}

/***/ })

/******/ });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9LaW52ZXkvd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovL0tpbnZleS93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9hcnJheVdpdGhIb2xlcy5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXN5bmNUb0dlbmVyYXRvci5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjay5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jb25zdHJ1Y3QuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZGVmaW5lUHJvcGVydHkuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZ2V0LmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2dldFByb3RvdHlwZU9mLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2luaGVyaXRzLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdC5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2lzTmF0aXZlRnVuY3Rpb24uanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvaXRlcmFibGVUb0FycmF5TGltaXQuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvbm9uSXRlcmFibGVSZXN0LmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4uanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvc2V0UHJvdG90eXBlT2YuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvc2xpY2VkVG9BcnJheS5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9zdXBlclByb3BCYXNlLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL3R5cGVvZi5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy93cmFwTmF0aXZlU3VwZXIuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL3JlZ2VuZXJhdG9yL2luZGV4LmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9heGlvcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2FkYXB0ZXJzL3hoci5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2F4aW9zLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9heGlvcy9saWIvY2FuY2VsL0NhbmNlbC5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2NhbmNlbC9DYW5jZWxUb2tlbi5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2NhbmNlbC9pc0NhbmNlbC5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2NvcmUvQXhpb3MuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL2F4aW9zL2xpYi9jb3JlL0ludGVyY2VwdG9yTWFuYWdlci5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2NvcmUvY3JlYXRlRXJyb3IuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL2F4aW9zL2xpYi9jb3JlL2Rpc3BhdGNoUmVxdWVzdC5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2NvcmUvZW5oYW5jZUVycm9yLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9heGlvcy9saWIvY29yZS9zZXR0bGUuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL2F4aW9zL2xpYi9jb3JlL3RyYW5zZm9ybURhdGEuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL2F4aW9zL2xpYi9kZWZhdWx0cy5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2hlbHBlcnMvYmluZC5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2hlbHBlcnMvYnRvYS5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2hlbHBlcnMvYnVpbGRVUkwuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL2F4aW9zL2xpYi9oZWxwZXJzL2NvbWJpbmVVUkxzLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9heGlvcy9saWIvaGVscGVycy9jb29raWVzLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9heGlvcy9saWIvaGVscGVycy9pc0Fic29sdXRlVVJMLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9heGlvcy9saWIvaGVscGVycy9pc1VSTFNhbWVPcmlnaW4uanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL2F4aW9zL2xpYi9oZWxwZXJzL25vcm1hbGl6ZUhlYWRlck5hbWUuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL2F4aW9zL2xpYi9oZWxwZXJzL3BhcnNlSGVhZGVycy5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2hlbHBlcnMvc3ByZWFkLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9heGlvcy9saWIvdXRpbHMuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL2V2ZW50cy9ldmVudHMuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL2lzLWJ1ZmZlci9pbmRleC5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvanMtYmFzZTY0L2Jhc2U2NC5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvbG9kYXNoL19EYXRhVmlldy5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvbG9kYXNoL19NYXAuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL2xvZGFzaC9fUHJvbWlzZS5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvbG9kYXNoL19TZXQuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL2xvZGFzaC9fU3ltYm9sLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9sb2Rhc2gvX1dlYWtNYXAuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL2xvZGFzaC9fYmFzZUdldFRhZy5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvbG9kYXNoL19iYXNlSXNBcmd1bWVudHMuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL2xvZGFzaC9fYmFzZUlzTmF0aXZlLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9sb2Rhc2gvX2Jhc2VJc1R5cGVkQXJyYXkuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL2xvZGFzaC9fYmFzZUtleXMuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL2xvZGFzaC9fYmFzZVRpbWVzLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9sb2Rhc2gvX2Jhc2VVbmFyeS5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvbG9kYXNoL19jYXN0RnVuY3Rpb24uanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL2xvZGFzaC9fY29yZUpzRGF0YS5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvbG9kYXNoL19mcmVlR2xvYmFsLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9sb2Rhc2gvX2dldE5hdGl2ZS5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvbG9kYXNoL19nZXRQcm90b3R5cGUuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL2xvZGFzaC9fZ2V0UmF3VGFnLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9sb2Rhc2gvX2dldFRhZy5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvbG9kYXNoL19nZXRWYWx1ZS5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvbG9kYXNoL19pc01hc2tlZC5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvbG9kYXNoL19pc1Byb3RvdHlwZS5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvbG9kYXNoL19uYXRpdmVLZXlzLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9sb2Rhc2gvX25vZGVVdGlsLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9sb2Rhc2gvX29iamVjdFRvU3RyaW5nLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9sb2Rhc2gvX292ZXJBcmcuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL2xvZGFzaC9fcm9vdC5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvbG9kYXNoL190b1NvdXJjZS5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvbG9kYXNoL2lkZW50aXR5LmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9sb2Rhc2gvaXNBcmd1bWVudHMuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL2xvZGFzaC9pc0FycmF5LmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9sb2Rhc2gvaXNBcnJheUxpa2UuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL2xvZGFzaC9pc0J1ZmZlci5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvbG9kYXNoL2lzRW1wdHkuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL2xvZGFzaC9pc0Z1bmN0aW9uLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9sb2Rhc2gvaXNMZW5ndGguanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL2xvZGFzaC9pc051bWJlci5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvbG9kYXNoL2lzT2JqZWN0LmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9sb2Rhc2gvaXNPYmplY3RMaWtlLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9sb2Rhc2gvaXNQbGFpbk9iamVjdC5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvbG9kYXNoL2lzU3RyaW5nLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9sb2Rhc2gvaXNTeW1ib2wuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL2xvZGFzaC9pc1R5cGVkQXJyYXkuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL2xvZGFzaC9zdHViRmFsc2UuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL2xvZGFzaC90aW1lcy5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvbG9kYXNoL3RvRmluaXRlLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9sb2Rhc2gvdG9JbnRlZ2VyLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9sb2Rhc2gvdG9OdW1iZXIuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL2xva2lqcy9zcmMvbG9raS1pbmRleGVkLWFkYXB0ZXIuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL2xva2lqcy9zcmMvbG9raWpzLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9ub2RlLWxpYnMtYnJvd3Nlci9ub2RlX21vZHVsZXMvcHVueWNvZGUvcHVueWNvZGUuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL3AtcXVldWUvaW5kZXguanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL3Byb2Nlc3MvYnJvd3Nlci5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvcHVibnViL2Rpc3Qvd2ViL3B1Ym51Yi5taW4uanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL3F1ZXJ5c3RyaW5nLWVzMy9kZWNvZGUuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL3F1ZXJ5c3RyaW5nLWVzMy9lbmNvZGUuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL3F1ZXJ5c3RyaW5nLWVzMy9pbmRleC5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvcmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLW1vZHVsZS5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvcmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9yeGpzL19lc201L2luZGV4LmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9yeGpzL19lc201L2ludGVybmFsL0FzeW5jU3ViamVjdC5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvcnhqcy9fZXNtNS9pbnRlcm5hbC9CZWhhdmlvclN1YmplY3QuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL3J4anMvX2VzbTUvaW50ZXJuYWwvSW5uZXJTdWJzY3JpYmVyLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9yeGpzL19lc201L2ludGVybmFsL05vdGlmaWNhdGlvbi5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvcnhqcy9fZXNtNS9pbnRlcm5hbC9PYnNlcnZhYmxlLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9yeGpzL19lc201L2ludGVybmFsL09ic2VydmVyLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9yeGpzL19lc201L2ludGVybmFsL091dGVyU3Vic2NyaWJlci5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvcnhqcy9fZXNtNS9pbnRlcm5hbC9SZXBsYXlTdWJqZWN0LmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9yeGpzL19lc201L2ludGVybmFsL1NjaGVkdWxlci5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvcnhqcy9fZXNtNS9pbnRlcm5hbC9TdWJqZWN0LmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9yeGpzL19lc201L2ludGVybmFsL1N1YmplY3RTdWJzY3JpcHRpb24uanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL3J4anMvX2VzbTUvaW50ZXJuYWwvU3Vic2NyaWJlci5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvcnhqcy9fZXNtNS9pbnRlcm5hbC9TdWJzY3JpcHRpb24uanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL3J4anMvX2VzbTUvaW50ZXJuYWwvY29uZmlnLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9yeGpzL19lc201L2ludGVybmFsL29ic2VydmFibGUvQ29ubmVjdGFibGVPYnNlcnZhYmxlLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9yeGpzL19lc201L2ludGVybmFsL29ic2VydmFibGUvYmluZENhbGxiYWNrLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9yeGpzL19lc201L2ludGVybmFsL29ic2VydmFibGUvYmluZE5vZGVDYWxsYmFjay5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvcnhqcy9fZXNtNS9pbnRlcm5hbC9vYnNlcnZhYmxlL2NvbWJpbmVMYXRlc3QuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL3J4anMvX2VzbTUvaW50ZXJuYWwvb2JzZXJ2YWJsZS9jb25jYXQuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL3J4anMvX2VzbTUvaW50ZXJuYWwvb2JzZXJ2YWJsZS9kZWZlci5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvcnhqcy9fZXNtNS9pbnRlcm5hbC9vYnNlcnZhYmxlL2VtcHR5LmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9yeGpzL19lc201L2ludGVybmFsL29ic2VydmFibGUvZm9ya0pvaW4uanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL3J4anMvX2VzbTUvaW50ZXJuYWwvb2JzZXJ2YWJsZS9mcm9tLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9yeGpzL19lc201L2ludGVybmFsL29ic2VydmFibGUvZnJvbUFycmF5LmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9yeGpzL19lc201L2ludGVybmFsL29ic2VydmFibGUvZnJvbUV2ZW50LmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9yeGpzL19lc201L2ludGVybmFsL29ic2VydmFibGUvZnJvbUV2ZW50UGF0dGVybi5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvcnhqcy9fZXNtNS9pbnRlcm5hbC9vYnNlcnZhYmxlL2Zyb21JdGVyYWJsZS5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvcnhqcy9fZXNtNS9pbnRlcm5hbC9vYnNlcnZhYmxlL2Zyb21PYnNlcnZhYmxlLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9yeGpzL19lc201L2ludGVybmFsL29ic2VydmFibGUvZnJvbVByb21pc2UuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL3J4anMvX2VzbTUvaW50ZXJuYWwvb2JzZXJ2YWJsZS9nZW5lcmF0ZS5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvcnhqcy9fZXNtNS9pbnRlcm5hbC9vYnNlcnZhYmxlL2lpZi5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvcnhqcy9fZXNtNS9pbnRlcm5hbC9vYnNlcnZhYmxlL2ludGVydmFsLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9yeGpzL19lc201L2ludGVybmFsL29ic2VydmFibGUvbWVyZ2UuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL3J4anMvX2VzbTUvaW50ZXJuYWwvb2JzZXJ2YWJsZS9uZXZlci5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvcnhqcy9fZXNtNS9pbnRlcm5hbC9vYnNlcnZhYmxlL29mLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9yeGpzL19lc201L2ludGVybmFsL29ic2VydmFibGUvb25FcnJvclJlc3VtZU5leHQuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL3J4anMvX2VzbTUvaW50ZXJuYWwvb2JzZXJ2YWJsZS9wYWlycy5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvcnhqcy9fZXNtNS9pbnRlcm5hbC9vYnNlcnZhYmxlL3JhY2UuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL3J4anMvX2VzbTUvaW50ZXJuYWwvb2JzZXJ2YWJsZS9yYW5nZS5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvcnhqcy9fZXNtNS9pbnRlcm5hbC9vYnNlcnZhYmxlL3NjYWxhci5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvcnhqcy9fZXNtNS9pbnRlcm5hbC9vYnNlcnZhYmxlL3Rocm93RXJyb3IuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL3J4anMvX2VzbTUvaW50ZXJuYWwvb2JzZXJ2YWJsZS90aW1lci5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvcnhqcy9fZXNtNS9pbnRlcm5hbC9vYnNlcnZhYmxlL3VzaW5nLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9yeGpzL19lc201L2ludGVybmFsL29ic2VydmFibGUvemlwLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9yeGpzL19lc201L2ludGVybmFsL29wZXJhdG9ycy9jb25jYXRBbGwuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL3J4anMvX2VzbTUvaW50ZXJuYWwvb3BlcmF0b3JzL2dyb3VwQnkuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL3J4anMvX2VzbTUvaW50ZXJuYWwvb3BlcmF0b3JzL21hcC5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvcnhqcy9fZXNtNS9pbnRlcm5hbC9vcGVyYXRvcnMvbWVyZ2VBbGwuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL3J4anMvX2VzbTUvaW50ZXJuYWwvb3BlcmF0b3JzL21lcmdlTWFwLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9yeGpzL19lc201L2ludGVybmFsL29wZXJhdG9ycy9vYnNlcnZlT24uanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL3J4anMvX2VzbTUvaW50ZXJuYWwvb3BlcmF0b3JzL3JlZkNvdW50LmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9yeGpzL19lc201L2ludGVybmFsL3NjaGVkdWxlci9BY3Rpb24uanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL3J4anMvX2VzbTUvaW50ZXJuYWwvc2NoZWR1bGVyL0FuaW1hdGlvbkZyYW1lQWN0aW9uLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9yeGpzL19lc201L2ludGVybmFsL3NjaGVkdWxlci9BbmltYXRpb25GcmFtZVNjaGVkdWxlci5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvcnhqcy9fZXNtNS9pbnRlcm5hbC9zY2hlZHVsZXIvQXNhcEFjdGlvbi5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvcnhqcy9fZXNtNS9pbnRlcm5hbC9zY2hlZHVsZXIvQXNhcFNjaGVkdWxlci5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvcnhqcy9fZXNtNS9pbnRlcm5hbC9zY2hlZHVsZXIvQXN5bmNBY3Rpb24uanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL3J4anMvX2VzbTUvaW50ZXJuYWwvc2NoZWR1bGVyL0FzeW5jU2NoZWR1bGVyLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9yeGpzL19lc201L2ludGVybmFsL3NjaGVkdWxlci9RdWV1ZUFjdGlvbi5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvcnhqcy9fZXNtNS9pbnRlcm5hbC9zY2hlZHVsZXIvUXVldWVTY2hlZHVsZXIuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL3J4anMvX2VzbTUvaW50ZXJuYWwvc2NoZWR1bGVyL1ZpcnR1YWxUaW1lU2NoZWR1bGVyLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9yeGpzL19lc201L2ludGVybmFsL3NjaGVkdWxlci9hbmltYXRpb25GcmFtZS5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvcnhqcy9fZXNtNS9pbnRlcm5hbC9zY2hlZHVsZXIvYXNhcC5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvcnhqcy9fZXNtNS9pbnRlcm5hbC9zY2hlZHVsZXIvYXN5bmMuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL3J4anMvX2VzbTUvaW50ZXJuYWwvc2NoZWR1bGVyL3F1ZXVlLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9yeGpzL19lc201L2ludGVybmFsL3N5bWJvbC9pdGVyYXRvci5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvcnhqcy9fZXNtNS9pbnRlcm5hbC9zeW1ib2wvb2JzZXJ2YWJsZS5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvcnhqcy9fZXNtNS9pbnRlcm5hbC9zeW1ib2wvcnhTdWJzY3JpYmVyLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9yeGpzL19lc201L2ludGVybmFsL3V0aWwvQXJndW1lbnRPdXRPZlJhbmdlRXJyb3IuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL3J4anMvX2VzbTUvaW50ZXJuYWwvdXRpbC9FbXB0eUVycm9yLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9yeGpzL19lc201L2ludGVybmFsL3V0aWwvSW1tZWRpYXRlLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9yeGpzL19lc201L2ludGVybmFsL3V0aWwvT2JqZWN0VW5zdWJzY3JpYmVkRXJyb3IuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL3J4anMvX2VzbTUvaW50ZXJuYWwvdXRpbC9UaW1lb3V0RXJyb3IuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL3J4anMvX2VzbTUvaW50ZXJuYWwvdXRpbC9VbnN1YnNjcmlwdGlvbkVycm9yLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9yeGpzL19lc201L2ludGVybmFsL3V0aWwvY2FuUmVwb3J0RXJyb3IuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL3J4anMvX2VzbTUvaW50ZXJuYWwvdXRpbC9lcnJvck9iamVjdC5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvcnhqcy9fZXNtNS9pbnRlcm5hbC91dGlsL2hvc3RSZXBvcnRFcnJvci5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvcnhqcy9fZXNtNS9pbnRlcm5hbC91dGlsL2lkZW50aXR5LmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9yeGpzL19lc201L2ludGVybmFsL3V0aWwvaXNBcnJheS5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvcnhqcy9fZXNtNS9pbnRlcm5hbC91dGlsL2lzQXJyYXlMaWtlLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9yeGpzL19lc201L2ludGVybmFsL3V0aWwvaXNGdW5jdGlvbi5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvcnhqcy9fZXNtNS9pbnRlcm5hbC91dGlsL2lzSW50ZXJvcE9ic2VydmFibGUuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL3J4anMvX2VzbTUvaW50ZXJuYWwvdXRpbC9pc0l0ZXJhYmxlLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9yeGpzL19lc201L2ludGVybmFsL3V0aWwvaXNOdW1lcmljLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9yeGpzL19lc201L2ludGVybmFsL3V0aWwvaXNPYmplY3QuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL3J4anMvX2VzbTUvaW50ZXJuYWwvdXRpbC9pc09ic2VydmFibGUuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL3J4anMvX2VzbTUvaW50ZXJuYWwvdXRpbC9pc1Byb21pc2UuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL3J4anMvX2VzbTUvaW50ZXJuYWwvdXRpbC9pc1NjaGVkdWxlci5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvcnhqcy9fZXNtNS9pbnRlcm5hbC91dGlsL25vb3AuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL3J4anMvX2VzbTUvaW50ZXJuYWwvdXRpbC9waXBlLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9yeGpzL19lc201L2ludGVybmFsL3V0aWwvc3Vic2NyaWJlVG8uanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL3J4anMvX2VzbTUvaW50ZXJuYWwvdXRpbC9zdWJzY3JpYmVUb0FycmF5LmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9yeGpzL19lc201L2ludGVybmFsL3V0aWwvc3Vic2NyaWJlVG9JdGVyYWJsZS5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvcnhqcy9fZXNtNS9pbnRlcm5hbC91dGlsL3N1YnNjcmliZVRvT2JzZXJ2YWJsZS5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvcnhqcy9fZXNtNS9pbnRlcm5hbC91dGlsL3N1YnNjcmliZVRvUHJvbWlzZS5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvcnhqcy9fZXNtNS9pbnRlcm5hbC91dGlsL3N1YnNjcmliZVRvUmVzdWx0LmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9yeGpzL19lc201L2ludGVybmFsL3V0aWwvdG9TdWJzY3JpYmVyLmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy9yeGpzL19lc201L2ludGVybmFsL3V0aWwvdHJ5Q2F0Y2guanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL3NpZnQvc3JjL2luZGV4LmpzIiwid2VicGFjazovL0tpbnZleS8uL25vZGVfbW9kdWxlcy90c2xpYi90c2xpYi5lczYuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vbm9kZV9tb2R1bGVzL3VybC1qb2luL2xpYi91cmwtam9pbi5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvdXJsL3VybC5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9ub2RlX21vZHVsZXMvdXJsL3V0aWwuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Lyh3ZWJwYWNrKS9idWlsZGluL2dsb2JhbC5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvKHdlYnBhY2spL2J1aWxkaW4vbW9kdWxlLmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL2FjbC5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy9hZ2dyZWdhdGlvbi9hZ2dyZWdhdGlvbi5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy9hZ2dyZWdhdGlvbi9hdmVyYWdlLmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL2FnZ3JlZ2F0aW9uL2NvdW50LmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL2FnZ3JlZ2F0aW9uL2luZGV4LmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL2FnZ3JlZ2F0aW9uL21heC5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy9hZ2dyZWdhdGlvbi9taW4uanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vcGFja2FnZXMva2ludmV5LWh0bWw1LXNkay9zcmMvYWdncmVnYXRpb24vc3VtLmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL2NhY2hlL2luZGV4LmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL2NhY2hlL2luZGV4ZWRkYi5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy9jYWNoZS9tZW1vcnkuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vcGFja2FnZXMva2ludmV5LWh0bWw1LXNkay9zcmMvY2FjaGUvc3RvcmUuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vcGFja2FnZXMva2ludmV5LWh0bWw1LXNkay9zcmMvY2FjaGUvdXRpbHMuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vcGFja2FnZXMva2ludmV5LWh0bWw1LXNkay9zcmMvY2FjaGUvd2Vic3FsLmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL2RhdGFzdG9yZS9jYWNoZS5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy9kYXRhc3RvcmUvY2FjaGVzdG9yZS5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy9kYXRhc3RvcmUvaW5kZXguanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vcGFja2FnZXMva2ludmV5LWh0bWw1LXNkay9zcmMvZGF0YXN0b3JlL25ldHdvcmtzdG9yZS5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy9kYXRhc3RvcmUvc3luYy5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy9lbmRwb2ludC5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy9lcnJvcnMvYWN0aXZlVXNlci5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy9lcnJvcnMvYXBpVmVyc2lvbk5vdEF2YWlsYWJsZS5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy9lcnJvcnMvYXBpVmVyc2lvbk5vdEltcGxlbWVudGVkLmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL2Vycm9ycy9hcHBQcm9ibGVtLmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL2Vycm9ycy9iYWRSZXF1ZXN0LmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL2Vycm9ycy9iYXNlLmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL2Vycm9ycy9ibC5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy9lcnJvcnMvY29yc0Rpc2FibGVkLmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL2Vycm9ycy9kdXBsaWNhdGVFbmRVc2Vycy5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy9lcnJvcnMvZmVhdHVyZVVuYXZhaWxhYmxlLmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL2Vycm9ycy9pbmNvbXBsZXRlUmVxdWVzdEJvZHkuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vcGFja2FnZXMva2ludmV5LWh0bWw1LXNkay9zcmMvZXJyb3JzL2luZGlyZWN0Q29sbGVjdGlvbkFjY2Vzc0Rpc2FsbG93ZWQuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vcGFja2FnZXMva2ludmV5LWh0bWw1LXNkay9zcmMvZXJyb3JzL2luc3VmZmljaWVudENyZWRlbnRpYWxzLmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL2Vycm9ycy9pbnZhbGlkQ3JlZGVudGlhbHMuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vcGFja2FnZXMva2ludmV5LWh0bWw1LXNkay9zcmMvZXJyb3JzL2ludmFsaWRJZGVudGlmaWVyLmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL2Vycm9ycy9pbnZhbGlkUXVlcnlTeW50YXguanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vcGFja2FnZXMva2ludmV5LWh0bWw1LXNkay9zcmMvZXJyb3JzL2pzb25QYXJzZS5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy9lcnJvcnMva2ludmV5LmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL2Vycm9ycy9raW52ZXlJbnRlcm5hbEVycm9yUmV0cnkuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vcGFja2FnZXMva2ludmV5LWh0bWw1LXNkay9zcmMvZXJyb3JzL2tpbnZleUludGVybmFsRXJyb3JTdG9wLmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL2Vycm9ycy9taXNzaW5nQ29uZmlndXJhdGlvbi5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy9lcnJvcnMvbWlzc2luZ1F1ZXJ5LmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL2Vycm9ycy9taXNzaW5nUmVxdWVzdEhlYWRlci5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy9lcnJvcnMvbWlzc2luZ1JlcXVlc3RQYXJhbWV0ZXIuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vcGFja2FnZXMva2ludmV5LWh0bWw1LXNkay9zcmMvZXJyb3JzL25ldHdvcmtDb25uZWN0aW9uLmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL2Vycm9ycy9ub3RGb3VuZC5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy9lcnJvcnMvcGFyYW1ldGVyVmFsdWVPdXRPZlJhbmdlLmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL2Vycm9ycy9xdWVyeS5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy9lcnJvcnMvcmVzdWx0U2V0U2l6ZUV4Y2VlZGVkLmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL2Vycm9ycy9zZXJ2ZXIuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vcGFja2FnZXMva2ludmV5LWh0bWw1LXNkay9zcmMvZXJyb3JzL3N0YWxlUmVxdWVzdC5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy9lcnJvcnMvc3luYy5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy9lcnJvcnMvdGltZW91dC5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy9lcnJvcnMvdXNlckFscmVhZHlFeGlzdHMuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vcGFja2FnZXMva2ludmV5LWh0bWw1LXNkay9zcmMvZXJyb3JzL3dyaXRlc1RvQ29sbGVjdGlvbkRpc2FsbG93ZWQuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vcGFja2FnZXMva2ludmV5LWh0bWw1LXNkay9zcmMvZmlsZXMvY3JlYXRlLmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL2ZpbGVzL2Rvd25sb2FkLmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL2ZpbGVzL2Rvd25sb2FkQnlVcmwuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vcGFja2FnZXMva2ludmV5LWh0bWw1LXNkay9zcmMvZmlsZXMvZmluZC5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy9maWxlcy9maW5kQnlJZC5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy9maWxlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy9maWxlcy9yZW1vdmUuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vcGFja2FnZXMva2ludmV5LWh0bWw1LXNkay9zcmMvZmlsZXMvcmVtb3ZlQnlJZC5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy9maWxlcy9zdHJlYW0uanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vcGFja2FnZXMva2ludmV5LWh0bWw1LXNkay9zcmMvZmlsZXMvdXBkYXRlLmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL2ZpbGVzL3VwbG9hZC5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy9odHRwL2F1dGguanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vcGFja2FnZXMva2ludmV5LWh0bWw1LXNkay9zcmMvaHR0cC9oZWFkZXJzLmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL2h0dHAvaHR0cC5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy9odHRwL3JlcXVlc3QuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vcGFja2FnZXMva2ludmV5LWh0bWw1LXNkay9zcmMvaHR0cC9yZXNwb25zZS5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy9odHRwL3V0aWxzLmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL2luZGV4LmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL2tpbnZleS9hcHBWZXJzaW9uLmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL2tpbnZleS9jb25maWcuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vcGFja2FnZXMva2ludmV5LWh0bWw1LXNkay9zcmMva2ludmV5L2RldmljZS5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy9raW52ZXkvaW5pdC5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy9raW52ZXkvaW5pdGlhbGl6ZS5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy9raW52ZXkvdXRpbHMuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vcGFja2FnZXMva2ludmV5LWh0bWw1LXNkay9zcmMva21kLmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL2xpdmUuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vcGFja2FnZXMva2ludmV5LWh0bWw1LXNkay9zcmMvb2JzZXJ2YWJsZS5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy9xdWVyeS5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy9zZXNzaW9uL2luZGV4LmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL3Nlc3Npb24vc2Vzc2lvbi5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy9zZXNzaW9uL3V0aWxzLmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL3VzZXIvZXhpc3RzLmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL3VzZXIvZm9yZ290VXNlcm5hbWUuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vcGFja2FnZXMva2ludmV5LWh0bWw1LXNkay9zcmMvdXNlci9pbmRleC5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy91c2VyL2xvZ2luLmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL3VzZXIvbG9nb3V0LmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL3VzZXIvbG9va3VwLmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL3VzZXIvbWUuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vcGFja2FnZXMva2ludmV5LWh0bWw1LXNkay9zcmMvdXNlci9taWMuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vcGFja2FnZXMva2ludmV5LWh0bWw1LXNkay9zcmMvdXNlci9wb3B1cC5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy91c2VyL3JlbW92ZS5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy91c2VyL3Jlc2V0UGFzc3dvcmQuanMiLCJ3ZWJwYWNrOi8vS2ludmV5Ly4vcGFja2FnZXMva2ludmV5LWh0bWw1LXNkay9zcmMvdXNlci9yZXN0b3JlLmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL3VzZXIvc2lnbnVwLmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL3VzZXIvdXBkYXRlLmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL3VzZXIvdXNlci5qcyIsIndlYnBhY2s6Ly9LaW52ZXkvLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy91c2VyL3V0aWxzLmpzIiwid2VicGFjazovL0tpbnZleS8uL3BhY2thZ2VzL2tpbnZleS1odG1sNS1zZGsvc3JjL3VzZXIvdmVyaWZ5RW1haWwuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsTztBQ1ZBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOzs7QUFHQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0Esa0RBQTBDLGdDQUFnQztBQUMxRTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGdFQUF3RCxrQkFBa0I7QUFDMUU7QUFDQSx5REFBaUQsY0FBYztBQUMvRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaURBQXlDLGlDQUFpQztBQUMxRSx3SEFBZ0gsbUJBQW1CLEVBQUU7QUFDckk7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBMkIsMEJBQTBCLEVBQUU7QUFD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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLGVBQWUsU0FBUztBQUN4QjtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsR0FBRztBQUNILG9CQUFvQixTQUFTO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtB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Q0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPOztBQUVQO0FBQ0E7QUFDQTtBQUNBLE9BQU87O0FBRVA7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLE9BQU87O0FBRVA7QUFDQTtBQUNBO0FBQ0EsT0FBTzs7QUFFUDtBQUNBO0FBQ0EsT0FBTzs7QUFFUDtBQUNBO0FBQ0EsT0FBTzs7QUFFUDtBQUNBO0FBQ0EsT0FBTzs7QUFFUDtBQUNBO0FBQ0E7QUFDQSxPQUFPOztBQUVQO0FBQ0E7QUFDQSxPQUFPOztBQUVQO0FBQ0E7QUFDQSxPQUFPOztBQUVQO0FBQ0E7QUFDQSxPQUFPOztBQUVQLHlCQUF5QixlQUFlLG9CQUFvQjtBQUM1RDtBQUNBO0FBQ0E7QUFDQSxPQUFPOztBQUVQO0FBQ0E7QUFDQTtBQUNBLE9BQU87O0FBRVA7QUFDQTtBQUNBLE9BQU87O0FBRVA7QUFDQTtBQUNBLE9BQU87O0FBRVA7QUFDQTtBQUNBLE9BQU87O0FBRVA7QUFDQTtBQUNBLE9BQU87O0FBRVA7QUFDQTtBQUNBLE9BQU87O0FBRVA7QUFDQTtBQUNBLE9BQU87O0FBRVA7QUFDQTtBQUNBLE9BQU87O0FBRVA7QUFDQTtBQUNBLE9BQU87O0FBRVA7QUFDQTtBQUNBLE9BQU87O0FBRVA7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTzs7QUFFUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPOztBQUVQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPOztBQUVQO0FBQ0E7QUFDQSxPQUFPOztBQUVQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPOztBQUVQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPOztBQUVQO0FBQ0E7QUFDQSxPQUFPOztBQUVQO0FBQ0E7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VTtBQUMxQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsT0FBTztBQUNQOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsU0FBUztBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTzs7QUFFUDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFNBQVM7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixtQkFBTyxDQUFDLDBEQUFJO0FBQzlCLE9BQU87QUFDUDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGVBQWUsT0FBTztBQUN0QixlQUFlLFNBQVM7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsT0FB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QTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxTQUFTO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7O0FBRUEsYUFBYSxTQUFTO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7O0FBRUEsYUFBYSxTQUFTO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsT0FBTztBQUN0QixpQkFBaUIsT0FBTztBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsT0FBTztBQUN0QjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsZUFBZSxPQUFPO0FBQ3RCO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGVBQWUsT0FBTztBQUN0QjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87O0FBRVA7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsT0FBTztBQUN2QixnQkFBZ0IsT0FBTztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLE9BQU87O0FBRVA7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87O0FBRVA7QUFDQTtBQUNBO0FBQ0EsT0FBTzs7QUFFUDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPOztBQUVQO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixTQUFTO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSCxDQUFDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNyd09EO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBLG1CQUFtQixLQUEwQjtBQUM3QztBQUNBLGtCQUFrQixLQUF5QjtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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O0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0Esc0NBQXNDO0FBQ3RDOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0Esc0NBQXNDO0FBQ3RDOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHNDQUFzQztBQUN0Qzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOzs7Ozs7Ozs7Ozs7QUM1UkE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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O0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSwyQkFBMkI7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLG9DQUFvQyxjQUFjO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxpQ0FBaUMsa0JBQWtCO0FBQ25EO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxpQkFBaUI7O0FBRWpCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixpQkFBaUI7QUFDekM7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxZQUFZO0FBQ1o7QUFDQTs7QUFFQTtBQUNBLFlBQVk7QUFDWjs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBLDhDQUE4QyxRQUFRO0FBQ3REO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTs7QUFFQSxXQUFXO0FBQ1g7QUFDQTtBQUNBOztBQUVBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7O0FBRUEsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBLDhDQUE4QyxRQUFRO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7O0FBRUE7QUFDQSxLQUFLOztBQUVMO0FBQ0EsOENBQThDLFFBQVE7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0EsOENBQThDLFFBQVE7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7Ozs7Ozs7Ozs7OztBQ2h0QkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNtRDtBQUNpQztBQUNuQjtBQUNQO0FBQ2I7QUFDZ0I7QUFDSjtBQUNGO0FBQ1c7QUFDRztBQUNBO0FBQzJCO0FBQ0E7QUFDL0M7QUFDTTtBQUNKO0FBQ0k7QUFDWDtBQUNBO0FBQ1E7QUFDUTtBQUNzQjtBQUMxQjtBQUMwQjtBQUNSO0FBQ2Q7QUFDTTtBQUNRO0FBQ047QUFDZDtBQUNGO0FBQ0E7QUFDTTtBQUNSO0FBQ1U7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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsQ0FBQyxzREFBVTtBQUNaO0FBQ0EsSUFBSSwrQ0FBaUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxDQUFDLHNEQUFVO0FBQ1o7QUFDQSxJQUFJLCtDQUFpQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLDBEQUFZO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLENBQUMsc0RBQVU7QUFDaUI7QUFDN0I7QUFDQSxJQUFJLCtDQUFpQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxDQUFDLDBEQUFZO0FBQ2Q7Ozs7Ozs7Ozs7Ozs7QUNyTEE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ2lDO0FBQ1U7QUFDcEM7QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDc0I7QUFDdkI7QUFDQSxJQUFJLCtDQUFpQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsQ0FBQyxzREFBVTtBQUNaOzs7Ozs7Ozs7Ozs7O0FDNUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDc0M7QUFDTTtBQUNyQztBQUNQO0FBQ0E7QUFDQTtBQUNBLFdBQVcsMERBQVEs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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGtCQUFrQixtQkFBbUI7QUFDckM7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLG1CQUFtQjtBQUN2QztBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLGlCQUFpQjtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QixRQUFRO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxVQUFVLE1BQU07QUFDaEI7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNB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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsZUFBZTtBQUNmLGFBQWE7O0FBRWI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsZUFBZTtBQUNmLGFBQWE7O0FBRWI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGVBQWU7QUFDZixhQUFhOztBQUViO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtB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O0FBRVQ7QUFDQTtBQUNBO0FBQ0EsT0FBTzs7QUFFUDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0EsT0FBTzs7QUFFUDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0EsT0FBTzs7QUFFUDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWCxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBLE9BQU87O0FBRVA7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTzs7QUFFUDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULE9BQU87O0FBRVA7QUFDQTtBQUNBOztBQUVBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCOztBQUUxQjtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxpQkFBaUI7O0FBRWpCO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjs7QUFFakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxPQUFPOztBQUVQO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7O0FBRWpCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTzs7QUFFUDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjs7O0FBR2pCO0FBQ0E7QUFDQSxpQkFBaUI7O0FBRWpCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTzs7QUFFUDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkhBQTJIOztBQUUzSDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsZ0RBQWdEO0FBQ2hELGlCQUFpQjs7O0FBR2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBOztBQUVBO0FBQ0E7QUFDQSxvSEFBb0g7O0FBRXBIO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLDREQUE0RDtBQUM1RDtBQUNBLGlCQUFpQjs7QUFFakI7QUFDQTtBQUNBLHVGQUF1Rjs7QUFFdkY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsRUFBRTs7QUFFbkI7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0EsbUJBQW1CO0FBQ25CLGlCQUFpQjtBQUNqQjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLEtBQUs7O0FBRXRCLG1EQUFtRDs7QUFFbkQ7O0FBRUE7QUFDQTtBQUNBLDJEQUEyRDtBQUMzRDtBQUNBLGlCQUFpQjs7QUFFakI7QUFDQTtBQUNBLHFDQUFxQzs7QUFFckM7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxPQUFPOztBQUVQO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlGQUFpRjs7QUFFakY7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTzs7QUFFUDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCOztBQUVqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULE9BQU87O0FBRVA7QUFDQTtBQUNBOztBQUVBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTzs7QUFFUDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxPQUFPOztBQUVQO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FB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QUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWCxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBLE9BQU87O0FBRVA7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1gsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQSxPQUFPOztBQUVQO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULE9BQU87O0FBRVA7QUFDQTtBQUNBOztBQUVBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxPQUFPOztBQUVQO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsb0NBQW9DLElBQUk7QUFDdEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULE9BQU87O0FBRVA7QUFDQTtBQUNBOztBQUVBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7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Q0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxpQkFBaUI7O0FBRWpCO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxtQkFBbUI7QUFDbkIsaUJBQWlCOzs7QUFHakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7O0FBRWpCO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULE9BQU87O0FBRVA7QUFDQTtBQUNBOztBQUVBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUM7QUFDekM7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUM7O0FBRXpDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDOztBQUV6QztBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsdURBQXVEOztBQUV2RCx5REFBeUQ7O0FBRXpEO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDOztBQUV6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDOztBQUV6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDOztBQUV6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDLCtCQUErQjs7QUFFL0I7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCOztBQUU3QjtBQUNBO0FBQ0EsK0RBQStEOztBQUUvRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCLG1CQUFtQjs7QUFFbkI7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCOztBQUVqQjs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTzs7QUFFUDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULE9BQU87O0FBRVA7QUFDQTtBQUNBOztBQUVBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxPQUFPOztBQUVQO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTzs7QUFFUDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0EsQ0FBQzs7QUFFRCxvQjs7Ozs7Ozs7Ozs7O0FDMWtCYTs7QUFFYiw2QkFBNkIsbUJBQU8sQ0FBQyxvSEFBOEM7O0FBRW5GO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7O0FBRUEsMENBQTBDLG1CQUFPLENBQUMsc0ZBQTRCOztBQUU5RSxnREFBZ0QsbUJBQU8sQ0FBQywwR0FBeUM7O0FBRWpHLHVDQUF1QyxtQkFBTyxDQUFDLDBEQUFpQjs7QUFFaEUsYUFBYSxtQkFBTyxDQUFDLG1FQUFjOztBQUVuQyxlQUFlLG1CQUFPLENBQUMsdUVBQWdCOztBQUV2QyxZQUFZLG1CQUFPLENBQUMsaUVBQWE7O0FBRWpDLGNBQWMsbUJBQU8sQ0FBQyx5RUFBaUI7O0FBRXZDLHFDQUFxQyxtQkFBTyxDQUFDLHlFQUFpQjs7QUFFOUQ7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQSxDOzs7Ozs7Ozs7Ozs7QUNqRmE7O0FBRWIsNkJBQTZCLG1CQUFPLENBQUMsb0hBQThDOztBQUVuRjtBQUNBO0FBQ0EsQ0FBQztBQUNEOztBQUVBLDhDQUE4QyxtQkFBTyxDQUFDLHNHQUF1Qzs7QUFFN0YseURBQXlELG1CQUFPLENBQUMsNEhBQWtEOztBQUVuSCw4Q0FBOEMsbUJBQU8sQ0FBQyxzR0FBdUM7O0FBRTdGLHdDQUF3QyxtQkFBTyxDQUFDLDBGQUFpQzs7QUFFakYscURBQXFELG1CQUFPLENBQUMsb0hBQThDOztBQUUzRyxtQ0FBbUMsbUJBQU8sQ0FBQyw4REFBUTs7QUFFbkQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBLDBGQUEwRixhQUFhO0FBQ3ZHO0FBQ0E7O0FBRUE7QUFDQSwyTEFBMkw7O0FBRTNMO0FBQ0E7QUFDQSxLQUFLOzs7QUFHTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDOztBQUVELGtDOzs7Ozs7Ozs7Ozs7QUNyRGE7O0FBRWIsNkJBQTZCLG1CQUFPLENBQUMsb0hBQThDOztBQUVuRjtBQUNBO0FBQ0EsQ0FBQztBQUNEOztBQUVBLDhDQUE4QyxtQkFBTyxDQUFDLHNHQUF1Qzs7QUFFN0YseURBQXlELG1CQUFPLENBQUMsNEhBQWtEOztBQUVuSCw4Q0FBOEMsbUJBQU8sQ0FBQyxzR0FBdUM7O0FBRTdGLHdDQUF3QyxtQkFBTyxDQUFDLDBGQUFpQzs7QUFFakYscURBQXFELG1CQUFPLENBQUMsb0hBQThDOztBQUUzRyxtQ0FBbUMsbUJBQU8sQ0FBQyw4REFBUTs7QUFFbkQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBLDBGQUEwRixhQUFhO0FBQ3ZHO0FBQ0E7O0FBRUE7QUFDQSx1TUFBdU07O0FBRXZNO0FBQ0E7QUFDQSxLQUFLOzs7QUFHTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDOztBQUVELDhDOzs7Ozs7Ozs7Ozs7QUNyRGE7O0FBRWIsNkJBQTZCLG1CQUFPLENBQUMsb0hBQThDOztBQUVuRjtBQUNBO0FBQ0EsQ0FBQztBQUNEOztBQUVBLDhDQUE4QyxtQkFBTyxDQUFDLHNHQUF1Qzs7QUFFN0YseURBQXlELG1CQUFPLENBQUMsNEhBQWtEOztBQUVuSCw4Q0FBOEMsbUJBQU8sQ0FBQyxzR0FBdUM7O0FBRTdGLHdDQUF3QyxtQkFBTyxDQUFDLDBGQUFpQzs7QUFFakYscURBQXFELG1CQUFPLENBQUMsb0hBQThDOztBQUUzRyxtQ0FBbUMsbUJBQU8sQ0FBQyw4REFBUTs7QUFFbkQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBLDBGQUEwRixhQUFhO0FBQ3ZHO0FBQ0E7O0FBRUE7QUFDQSx5TUFBeU07O0FBRXpNO0FBQ0E7QUFDQSxLQUFLOzs7QUFHTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDOztBQUVELGdEOzs7Ozs7Ozs7Ozs7QUNyRGE7O0FBRWIsNkJBQTZCLG1CQUFPLENBQUMsb0hBQThDOztBQUVuRjtBQUNBO0FBQ0EsQ0FBQztBQUNEOztBQUVBLDhDQUE4QyxtQkFBTyxDQUFDLHNHQUF1Qzs7QUFFN0YseURBQXlELG1CQUFPLENBQUMsNEhBQWtEOztBQUVuSCw4Q0FBOEMsbUJBQU8sQ0FBQyxzR0FBdUM7O0FBRTdGLHdDQUF3QyxtQkFBTyxDQUFDLDBGQUFpQzs7QUFFakYscURBQXFELG1CQUFPLENBQUMsb0hBQThDOztBQUUzRyxtQ0FBbUMsbUJBQU8sQ0FBQyw4REFBUTs7QUFFbkQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBLDBGQUEwRixhQUFhO0FBQ3ZHO0FBQ0E7O0FBRUE7QUFDQSwyTEFBMkw7O0FBRTNMO0FBQ0E7QUFDQSxLQUFLOzs7QUFHTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDOztBQUVELGtDOzs7Ozs7Ozs7Ozs7QUNyRGE7O0FBRWIsNkJBQTZCLG1CQUFPLENBQUMsb0hBQThDOztBQUVuRjtBQUNBO0FBQ0EsQ0FBQztBQUNEOztBQUVBLDhDQUE4QyxtQkFBTyxDQUFDLHNHQUF1Qzs7QUFFN0YseURBQXlELG1CQUFPLENBQUMsNEhBQWtEOztBQUVuSCw4Q0FBOEMsbUJBQU8sQ0FBQyxzR0FBdUM7O0FBRTdGLHdDQUF3QyxtQkFBTyxDQUFDLDBGQUFpQzs7QUFFakYscURBQXFELG1CQUFPLENBQUMsb0hBQThDOztBQUUzRyxtQ0FBbUMsbUJBQU8sQ0FBQyw4REFBUTs7QUFFbkQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBLDBGQUEwRixhQUFhO0FBQ3ZHO0FBQ0E7O0FBRUE7QUFDQSwyTEFBMkw7O0FBRTNMO0FBQ0E7QUFDQSxLQUFLOzs7QUFHTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDOztBQUVELGtDOzs7Ozs7Ozs7Ozs7QUNyRGE7O0FBRWIsNkJBQTZCLG1CQUFPLENBQUMsb0hBQThDOztBQUVuRjtBQUNBO0FBQ0EsQ0FBQztBQUNEOztBQUVBLDhDQUE4QyxtQkFBTyxDQUFDLHNHQUF1Qzs7QUFFN0YseURBQXlELG1CQUFPLENBQUMsNEhBQWtEOztBQUVuSCw4Q0FBOEMsbUJBQU8sQ0FBQyxzR0FBdUM7O0FBRTdGLHdDQUF3QyxtQkFBTyxDQUFDLDBGQUFpQzs7QUFFakYscURBQXFELG1CQUFPLENBQUMsb0hBQThDOztBQUUzRywrQ0FBK0MsbUJBQU8sQ0FBQyx3R0FBd0M7O0FBRS9GO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSwwRkFBMEYsYUFBYTtBQUN2RztBQUNBOztBQUVBO0FBQ0EsNEtBQTRLOztBQUU1SztBQUNBO0FBQ0EsS0FBSzs7O0FBR0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDOztBQUVELDRCOzs7Ozs7Ozs7Ozs7QUM1RGE7O0FBRWIsNkJBQTZCLG1CQUFPLENBQUMsb0hBQThDOztBQUVuRjtBQUNBO0FBQ0EsQ0FBQztBQUNEOztBQUVBLDhDQUE4QyxtQkFBTyxDQUFDLHNHQUF1Qzs7QUFFN0YseURBQXlELG1CQUFPLENBQUMsNEhBQWtEOztBQUVuSCw4Q0FBOEMsbUJBQU8sQ0FBQyxzR0FBdUM7O0FBRTdGLHdDQUF3QyxtQkFBTyxDQUFDLDBGQUFpQzs7QUFFakYscURBQXFELG1CQUFPLENBQUMsb0hBQThDOztBQUUzRyxtQ0FBbUMsbUJBQU8sQ0FBQyw4REFBUTs7QUFFbkQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBLDBGQUEwRixhQUFhO0FBQ3ZHO0FBQ0E7O0FBRUE7QUFDQSxtTEFBbUw7O0FBRW5MO0FBQ0E7QUFDQSxLQUFLOzs7QUFHTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDOztBQUVELDBCOzs7Ozs7Ozs7Ozs7QUNyRGE7O0FBRWIsNkJBQTZCLG1CQUFPLENBQUMsb0hBQThDOztBQUVuRjtBQUNBO0FBQ0EsQ0FBQztBQUNEOztBQUVBLDhDQUE4QyxtQkFBTyxDQUFDLHNHQUF1Qzs7QUFFN0YseURBQXlELG1CQUFPLENBQUMsNEhBQWtEOztBQUVuSCw4Q0FBOEMsbUJBQU8sQ0FBQyxzR0FBdUM7O0FBRTdGLHdDQUF3QyxtQkFBTyxDQUFDLDBGQUFpQzs7QUFFakYscURBQXFELG1CQUFPLENBQUMsb0hBQThDOztBQUUzRyxtQ0FBbUMsbUJBQU8sQ0FBQyw4REFBUTs7QUFFbkQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBLDBGQUEwRixhQUFhO0FBQ3ZHO0FBQ0E7O0FBRUE7QUFDQSw2TEFBNkw7O0FBRTdMO0FBQ0E7QUFDQSxLQUFLOzs7QUFHTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDOztBQUVELG9DOzs7Ozs7Ozs7Ozs7QUNyRGE7O0FBRWIsNkJBQTZCLG1CQUFPLENBQUMsb0hBQThDOztBQUVuRjtBQUNBO0FBQ0EsQ0FBQztBQUNEOztBQUVBLDhDQUE4QyxtQkFBTyxDQUFDLHNHQUF1Qzs7QUFFN0YseURBQXlELG1CQUFPLENBQUMsNEhBQWtEOztBQUVuSCw4Q0FBOEMsbUJBQU8sQ0FBQyxzR0FBdUM7O0FBRTdGLHdDQUF3QyxtQkFBTyxDQUFDLDBGQUFpQzs7QUFFakYscURBQXFELG1CQUFPLENBQUMsb0hBQThDOztBQUUzRyxtQ0FBbUMsbUJBQU8sQ0FBQyw4REFBUTs7QUFFbkQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBLDBGQUEwRixhQUFhO0FBQ3ZHO0FBQ0E7O0FBRUE7QUFDQSxrTUFBa007O0FBRWxNO0FBQ0E7QUFDQSxLQUFLOzs7QUFHTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDOztBQUVELHlDOzs7Ozs7Ozs7Ozs7QUNyRGE7O0FBRWIsNkJBQTZCLG1CQUFPLENBQUMsb0hBQThDOztBQUVuRjtBQUNBO0FBQ0EsQ0FBQztBQUNEOztBQUVBLDhDQUE4QyxtQkFBTyxDQUFDLHNHQUF1Qzs7QUFFN0YseURBQXlELG1CQUFPLENBQUMsNEhBQWtEOztBQUVuSCw4Q0FBOEMsbUJBQU8sQ0FBQyxzR0FBdUM7O0FBRTdGLHdDQUF3QyxtQkFBTyxDQUFDLDBGQUFpQzs7QUFFakYscURBQXFELG1CQUFPLENBQUMsb0hBQThDOztBQUUzRyxtQ0FBbUMsbUJBQU8sQ0FBQyw4REFBUTs7QUFFbkQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBLDBGQUEwRixhQUFhO0FBQ3ZHO0FBQ0E7O0FBRUE7QUFDQSxtTUFBbU07O0FBRW5NO0FBQ0E7QUFDQSxLQUFLOzs7QUFHTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDOztBQUVELDBDOzs7Ozs7Ozs7Ozs7QUNyRGE7O0FBRWIsNkJBQTZCLG1CQUFPLENBQUMsb0hBQThDOztBQUVuRjtBQUNBO0FBQ0EsQ0FBQztBQUNEOztBQUVBLDhDQUE4QyxtQkFBTyxDQUFDLHNHQUF1Qzs7QUFFN0YseURBQXlELG1CQUFPLENBQUMsNEhBQWtEOztBQUVuSCw4Q0FBOEMsbUJBQU8sQ0FBQyxzR0FBdUM7O0FBRTdGLHdDQUF3QyxtQkFBTyxDQUFDLDBGQUFpQzs7QUFFakYscURBQXFELG1CQUFPLENBQUMsb0hBQThDOztBQUUzRyxtQ0FBbUMsbUJBQU8sQ0FBQyw4REFBUTs7QUFFbkQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBLDBGQUEwRixhQUFhO0FBQ3ZHO0FBQ0E7O0FBRUE7QUFDQSxzTUFBc007O0FBRXRNO0FBQ0E7QUFDQSxLQUFLOzs7QUFHTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDOztBQUVELDZDOzs7Ozs7Ozs7Ozs7QUNyRGE7O0FBRWIsNkJBQTZCLG1CQUFPLENBQUMsb0hBQThDOztBQUVuRjtBQUNBO0FBQ0EsQ0FBQztBQUNEOztBQUVBLDhDQUE4QyxtQkFBTyxDQUFDLHNHQUF1Qzs7QUFFN0YseURBQXlELG1CQUFPLENBQUMsNEhBQWtEOztBQUVuSCw4Q0FBOEMsbUJBQU8sQ0FBQyxzR0FBdUM7O0FBRTdGLHdDQUF3QyxtQkFBTyxDQUFDLDBGQUFpQzs7QUFFakYscURBQXFELG1CQUFPLENBQUMsb0hBQThDOztBQUUzRyxtQ0FBbUMsbUJBQU8sQ0FBQyw4REFBUTs7QUFFbkQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBLDBGQUEwRixhQUFhO0FBQ3ZHO0FBQ0E7O0FBRUE7QUFDQSxtTkFBbU47O0FBRW5OO0FBQ0E7QUFDQSxLQUFLOzs7QUFHTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDOztBQUVELDBEOzs7Ozs7Ozs7Ozs7QUNyRGE7O0FBRWIsNkJBQTZCLG1CQUFPLENBQUMsb0hBQThDOztBQUVuRjtBQUNBO0FBQ0EsQ0FBQztBQUNEOztBQUVBLDhDQUE4QyxtQkFBTyxDQUFDLHNHQUF1Qzs7QUFFN0YseURBQXlELG1CQUFPLENBQUMsNEhBQWtEOztBQUVuSCw4Q0FBOEMsbUJBQU8sQ0FBQyxzR0FBdUM7O0FBRTdGLHdDQUF3QyxtQkFBTyxDQUFDLDBGQUFpQzs7QUFFakYscURBQXFELG1CQUFPLENBQUMsb0hBQThDOztBQUUzRyxtQ0FBbUMsbUJBQU8sQ0FBQyw4REFBUTs7QUFFbkQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBLDBGQUEwRixhQUFhO0FBQ3ZHO0FBQ0E7O0FBRUE7QUFDQSx3TUFBd007O0FBRXhNO0FBQ0E7QUFDQSxLQUFLOzs7QUFHTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDOztBQUVELCtDOzs7Ozs7Ozs7Ozs7QUNyRGE7O0FBRWIsNkJBQTZCLG1CQUFPLENBQUMsb0hBQThDOztBQUVuRjtBQUNBO0FBQ0EsQ0FBQztBQUNEOztBQUVBLDhDQUE4QyxtQkFBTyxDQUFDLHNHQUF1Qzs7QUFFN0YseURBQXlELG1CQUFPLENBQUMsNEhBQWtEOztBQUVuSCw4Q0FBOEMsbUJBQU8sQ0FBQyxzR0FBdUM7O0FBRTdGLHdDQUF3QyxtQkFBTyxDQUFDLDBGQUFpQzs7QUFFakYscURBQXFELG1CQUFPLENBQUMsb0hBQThDOztBQUUzRyxtQ0FBbUMsbUJBQU8sQ0FBQyw4REFBUTs7QUFFbkQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBLDBGQUEwRixhQUFhO0FBQ3ZHO0FBQ0E7O0FBRUE7QUFDQSxtTUFBbU07O0FBRW5NO0FBQ0E7QUFDQSxLQUFLOzs7QUFHTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDOztBQUVELDBDOzs7Ozs7Ozs7Ozs7QUNyRGE7O0FBRWIsNkJBQTZCLG1CQUFPLENBQUMsb0hBQThDOztBQUVuRjtBQUNBO0FBQ0EsQ0FBQztBQUNEOztBQUVBLDhDQUE4QyxtQkFBTyxDQUFDLHNHQUF1Qzs7QUFFN0YseURBQXlELG1CQUFPLENBQUMsNEhBQWtEOztBQUVuSCw4Q0FBOEMsbUJBQU8sQ0FBQyxzR0FBdUM7O0FBRTdGLHdDQUF3QyxtQkFBTyxDQUFDLDBGQUFpQzs7QUFFakYscURBQXFELG1CQUFPLENBQUMsb0hBQThDOztBQUUzRyxtQ0FBbUMsbUJBQU8sQ0FBQyw4REFBUTs7QUFFbkQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBLDBGQUEwRixhQUFhO0FBQ3ZHO0FBQ0E7O0FBRUE7QUFDQSxrTUFBa007O0FBRWxNO0FBQ0E7QUFDQSxLQUFLOzs7QUFHTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDOztBQUVELHlDOzs7Ozs7Ozs7Ozs7QUNyRGE7O0FBRWIsNkJBQTZCLG1CQUFPLENBQUMsb0hBQThDOztBQUVuRjtBQUNBO0FBQ0EsQ0FBQztBQUNEOztBQUVBLDhDQUE4QyxtQkFBTyxDQUFDLHNHQUF1Qzs7QUFFN0YseURBQXlELG1CQUFPLENBQUMsNEhBQWtEOztBQUVuSCw4Q0FBOEMsbUJBQU8sQ0FBQyxzR0FBdUM7O0FBRTdGLHdDQUF3QyxtQkFBTyxDQUFDLDBGQUFpQzs7QUFFakYscURBQXFELG1CQUFPLENBQUMsb0hBQThDOztBQUUzRyxtQ0FBbUMsbUJBQU8sQ0FBQyw4REFBUTs7QUFFbkQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBLDBGQUEwRixhQUFhO0FBQ3ZHO0FBQ0E7O0FBRUE7QUFDQSxtTUFBbU07O0FBRW5NO0FBQ0E7QUFDQSxLQUFLOzs7QUFHTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDOztBQUVELDBDOzs7Ozs7Ozs7Ozs7QUNyRGE7O0FBRWIsNkJBQTZCLG1CQUFPLENBQUMsb0hBQThDOztBQUVuRjtBQUNBO0FBQ0EsQ0FBQztBQUNEOztBQUVBLDhDQUE4QyxtQkFBTyxDQUFDLHNHQUF1Qzs7QUFFN0YseURBQXlELG1CQUFPLENBQUMsNEhBQWtEOztBQUVuSCw4Q0FBOEMsbUJBQU8sQ0FBQyxzR0FBdUM7O0FBRTdGLHdDQUF3QyxtQkFBTyxDQUFDLDBGQUFpQzs7QUFFakYscURBQXFELG1CQUFPLENBQUMsb0hBQThDOztBQUUzRyxtQ0FBbUMsbUJBQU8sQ0FBQyw4REFBUTs7QUFFbkQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBLDBGQUEwRixhQUFhO0FBQ3ZHO0FBQ0E7O0FBRUE7QUFDQSwwTEFBMEw7O0FBRTFMO0FBQ0E7QUFDQSxLQUFLOzs7QUFHTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDOztBQUVELGlDOzs7Ozs7Ozs7Ozs7QUNyRGE7O0FBRWIsNkJBQTZCLG1CQUFPLENBQUMsb0hBQThDOztBQUVuRjtBQUNBO0FBQ0EsQ0FBQztBQUNEOztBQUVBLDhDQUE4QyxtQkFBTyxDQUFDLHNHQUF1Qzs7QUFFN0YseURBQXlELG1CQUFPLENBQUMsNEhBQWtEOztBQUVuSCw4Q0FBOEMsbUJBQU8sQ0FBQyxzR0FBdUM7O0FBRTdGLHdDQUF3QyxtQkFBTyxDQUFDLDBGQUFpQzs7QUFFakYscURBQXFELG1CQUFPLENBQUMsb0hBQThDOztBQUUzRyxtQ0FBbUMsbUJBQU8sQ0FBQyw4REFBUTs7QUFFbkQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBLDBGQUEwRixhQUFhO0FBQ3ZHO0FBQ0E7O0FBRUE7QUFDQSx1TEFBdUw7O0FBRXZMO0FBQ0E7QUFDQSxLQUFLOzs7QUFHTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDOztBQUVELDhCOzs7Ozs7Ozs7Ozs7QUNyRGE7O0FBRWIsNkJBQTZCLG1CQUFPLENBQUMsb0hBQThDOztBQUVuRjtBQUNBO0FBQ0EsQ0FBQztBQUNEOztBQUVBLDhDQUE4QyxtQkFBTyxDQUFDLHNHQUF1Qzs7QUFFN0YseURBQXlELG1CQUFPLENBQUMsNEhBQWtEOztBQUVuSCw4Q0FBOEMsbUJBQU8sQ0FBQyxzR0FBdUM7O0FBRTdGLHdDQUF3QyxtQkFBTyxDQUFDLDBGQUFpQzs7QUFFakYscURBQXFELG1CQUFPLENBQUMsb0hBQThDOztBQUUzRyxtQ0FBbUMsbUJBQU8sQ0FBQyw4REFBUTs7QUFFbkQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBLDBGQUEwRixhQUFhO0FBQ3ZHO0FBQ0E7O0FBRUE7QUFDQSxvTUFBb007O0FBRXBNO0FBQ0E7QUFDQSxLQUFLOzs7QUFHTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDOztBQUVELDJDOzs7Ozs7Ozs7Ozs7QUNyRGE7O0FBRWIsNkJBQTZCLG1CQUFPLENBQUMsb0hBQThDOztBQUVuRjtBQUNBO0FBQ0EsQ0FBQztBQUNEOztBQUVBLDhDQUE4QyxtQkFBTyxDQUFDLHNHQUF1Qzs7QUFFN0YseURBQXlELG1CQUFPLENBQUMsNEhBQWtEOztBQUVuSCw4Q0FBOEMsbUJBQU8sQ0FBQyxzR0FBdUM7O0FBRTdGLHdDQUF3QyxtQkFBTyxDQUFDLDBGQUFpQzs7QUFFakYscURBQXFELG1CQUFPLENBQUMsb0hBQThDOztBQUUzRyxtQ0FBbUMsbUJBQU8sQ0FBQyw4REFBUTs7QUFFbkQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBLDBGQUEwRixhQUFhO0FBQ3ZHO0FBQ0E7O0FBRUE7QUFDQSxtTUFBbU07O0FBRW5NO0FBQ0E7QUFDQSxLQUFLOzs7QUFHTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDOztBQUVELDBDOzs7Ozs7Ozs7Ozs7QUNyRGE7O0FBRWIsNkJBQTZCLG1CQUFPLENBQUMsb0hBQThDOztBQUVuRjtBQUNBO0FBQ0EsQ0FBQztBQUNEOztBQUVBLDhDQUE4QyxtQkFBTyxDQUFDLHNHQUF1Qzs7QUFFN0YseURBQXlELG1CQUFPLENBQUMsNEhBQWtEOztBQUVuSCw4Q0FBOEMsbUJBQU8sQ0FBQyxzR0FBdUM7O0FBRTdGLHdDQUF3QyxtQkFBTyxDQUFDLDBGQUFpQzs7QUFFakYscURBQXFELG1CQUFPLENBQUMsb0hBQThDOztBQUUzRyxtQ0FBbUMsbUJBQU8sQ0FBQyw4REFBUTs7QUFFbkQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBLDBGQUEwRixhQUFhO0FBQ3ZHO0FBQ0E7O0FBRUE7QUFDQSxxTUFBcU07O0FBRXJNO0FBQ0E7QUFDQSxLQUFLOzs7QUFHTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDOztBQUVELDRDOzs7Ozs7Ozs7Ozs7QUNyRGE7O0FBRWIsNkJBQTZCLG1CQUFPLENBQUMsb0hBQThDOztBQUVuRjtBQUNBO0FBQ0EsQ0FBQztBQUNEOztBQUVBLDhDQUE4QyxtQkFBTyxDQUFDLHNHQUF1Qzs7QUFFN0YseURBQXlELG1CQUFPLENBQUMsNEhBQWtEOztBQUVuSCw4Q0FBOEMsbUJBQU8sQ0FBQyxzR0FBdUM7O0FBRTdGLHdDQUF3QyxtQkFBTyxDQUFDLDBGQUFpQzs7QUFFakYscURBQXFELG1CQUFPLENBQUMsb0hBQThDOztBQUUzRyxtQ0FBbUMsbUJBQU8sQ0FBQyw4REFBUTs7QUFFbkQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBLDBGQUEwRixhQUFhO0FBQ3ZHO0FBQ0E7O0FBRUE7QUFDQSw2TEFBNkw7O0FBRTdMO0FBQ0E7QUFDQSxLQUFLOzs7QUFHTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDOztBQUVELG9DOzs7Ozs7Ozs7Ozs7QUNyRGE7O0FBRWIsNkJBQTZCLG1CQUFPLENBQUMsb0hBQThDOztBQUVuRjtBQUNBO0FBQ0EsQ0FBQztBQUNEOztBQUVBLDhDQUE4QyxtQkFBTyxDQUFDLHNHQUF1Qzs7QUFFN0YseURBQXlELG1CQUFPLENBQUMsNEhBQWtEOztBQUVuSCw4Q0FBOEMsbUJBQU8sQ0FBQyxzR0FBdUM7O0FBRTdGLHdDQUF3QyxtQkFBTyxDQUFDLDBGQUFpQzs7QUFFakYscURBQXFELG1CQUFPLENBQUMsb0hBQThDOztBQUUzRyxtQ0FBbUMsbUJBQU8sQ0FBQyw4REFBUTs7QUFFbkQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBLDBGQUEwRixhQUFhO0FBQ3ZHO0FBQ0E7O0FBRUE7QUFDQSxxTUFBcU07O0FBRXJNO0FBQ0E7QUFDQSxLQUFLOzs7QUFHTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDOztBQUVELDRDOzs7Ozs7Ozs7Ozs7QUNyRGE7O0FBRWIsNkJBQTZCLG1CQUFPLENBQUMsb0hBQThDOztBQUVuRjtBQUNBO0FBQ0EsQ0FBQztBQUNEOztBQUVBLDhDQUE4QyxtQkFBTyxDQUFDLHNHQUF1Qzs7QUFFN0YseURBQXlELG1CQUFPLENBQUMsNEhBQWtEOztBQUVuSCw4Q0FBOEMsbUJBQU8sQ0FBQyxzR0FBdUM7O0FBRTdGLHdDQUF3QyxtQkFBTyxDQUFDLDBGQUFpQzs7QUFFakYscURBQXFELG1CQUFPLENBQUMsb0hBQThDOztBQUUzRyxtQ0FBbUMsbUJBQU8sQ0FBQyw4REFBUTs7QUFFbkQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBLDBGQUEwRixhQUFhO0FBQ3ZHO0FBQ0E7O0FBRUE7QUFDQSx3TUFBd007O0FBRXhNO0FBQ0E7QUFDQSxLQUFLOzs7QUFHTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDOztBQUVELCtDOzs7Ozs7Ozs7Ozs7QUNyRGE7O0FBRWIsNkJBQTZCLG1CQUFPLENBQUMsb0hBQThDOztBQUVuRjtBQUNBO0FBQ0EsQ0FBQztBQUNEOztBQUVBLDhDQUE4QyxtQkFBTyxDQUFDLHNHQUF1Qzs7QUFFN0YseURBQXlELG1CQUFPLENBQUMsNEhBQWtEOztBQUVuSCw4Q0FBOEMsbUJBQU8sQ0FBQyxzR0FBdUM7O0FBRTdGLHdDQUF3QyxtQkFBTyxDQUFDLDBGQUFpQzs7QUFFakYscURBQXFELG1CQUFPLENBQUMsb0hBQThDOztBQUUzRyxtQ0FBbUMsbUJBQU8sQ0FBQyw4REFBUTs7QUFFbkQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBLDBGQUEwRixhQUFhO0FBQ3ZHO0FBQ0E7O0FBRUE7QUFDQSxrTUFBa007O0FBRWxNO0FBQ0E7QUFDQSxLQUFLOzs7QUFHTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxDQUFDOztBQUVELHlDOzs7Ozs7Ozs7Ozs7QUNyRGE7O0FBRWIsNkJBQTZCLG1CQUFPLENBQUMsb0hBQThDOztBQUVuRjtBQUNBO0FBQ0EsQ0FBQztBQUNEOztBQUVBLDhDQUE4QyxtQkFBTyxDQUFDLHNHQUF1Qzs7QUFFN0YseURBQXlELG1CQUFPLENBQUMsNEhBQWtEOztBQUVuSCw4Q0FBOEMsbUJBQU8sQ0FBQyxzR0FBdUM7O0FBRTdGLHdDQUF3QyxtQkFBTyxDQUFDLDBGQUFpQzs7QUFFakYscURBQXFELG1CQUFPLENBQUMsb0hBQThDOztBQUUzRyxtQ0FBbUMsbUJBQU8sQ0FBQyw4REFBUTs7QUFFbkQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSwwRkFBMEYsYUFBYTtBQUN2RztBQUNBOztBQUVBO0FBQ0Esc01BQXNNOztBQUV0TTtBQUNBO0FBQ0EsS0FBSzs7O0FBR0w7QUFDQTtBQUNBOztBQUVBO0FBQ0EsQ0FBQzs7QUFFRCxnQzs7Ozs7Ozs7Ozs7O0FDdkRhOztBQUViLDZCQUE2QixtQkFBTyxDQUFDLG9IQUE4Qzs7QUFFbkY7QUFDQTtBQUNBLENBQUM7QUFDRDs7QUFFQSw4Q0FBOEMsbUJBQU8sQ0FBQyxzR0FBdUM7O0FBRTdGLHlEQUF5RCxtQkFBTyxDQUFDLDRIQUFrRDs7QUFFbkgsOENBQThDLG1CQUFPLENBQUMsc0dBQXVDOztBQUU3Rix3Q0FBd0MsbUJBQU8sQ0FBQywwRkFBaUM7O0FBRWpGLHFEQUFxRCxtQkFBTyxDQUFDLG9IQUE4Qzs7QUFFM0csbUNBQW1DLG1CQUFPLENBQUMsOERBQVE7O0FBRW5EO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQSwwRkFBMEYsYUFBYTtBQUN2RztBQUNBOztBQUVBO0FBQ0EseU1BQXlNOztBQUV6TTtBQUNBO0FBQ0EsS0FBSzs7O0FBR0w7QUFDQTtBQUNBOztBQUVBO0FBQ0EsQ0FBQzs7QUFFRCxnRDs7Ozs7Ozs7Ozs7O0FDckRhOztBQUViLDZCQUE2QixtQkFBTyxDQUFDLG9IQUE4Qzs7QUFFbkY7QUFDQTtBQUNBLENBQUM7QUFDRDs7QUFFQSw4Q0FBOEMsbUJBQU8sQ0FBQyxzR0FBdUM7O0FBRTdGLHlEQUF5RCxtQkFBTyxDQUFDLDRIQUFrRDs7QUFFbkgsOENBQThDLG1CQUFPLENBQUMsc0dBQXVDOztBQUU3Rix3Q0FBd0MsbUJBQU8sQ0FBQywwRkFBaUM7O0FBRWpGLHFEQUFxRCxtQkFBTyxDQUFDLG9IQUE4Qzs7QUFFM0csbUNBQW1DLG1CQUFPLENBQUMsOERBQVE7O0FBRW5EO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQSwwRkFBMEYsYUFBYTtBQUN2RztBQUNBOztBQUVBO0FBQ0Esc0xBQXNMOztBQUV0TDtBQUNBO0FBQ0EsS0FBSzs7O0FBR0w7QUFDQTtBQUNBOztBQUVBO0FBQ0EsQ0FBQzs7QUFFRCw2Qjs7Ozs7Ozs7Ozs7O0FDckRhOztBQUViLDZCQUE2QixtQkFBTyxDQUFDLG9IQUE4Qzs7QUFFbkY7QUFDQTtBQUNBLENBQUM7QUFDRDs7QUFFQSw4Q0FBOEMsbUJBQU8sQ0FBQyxzR0FBdUM7O0FBRTdGLHlEQUF5RCxtQkFBTyxDQUFDLDRIQUFrRDs7QUFFbkgsOENBQThDLG1CQUFPLENBQUMsc0dBQXVDOztBQUU3Rix3Q0FBd0MsbUJBQU8sQ0FBQywwRkFBaUM7O0FBRWpGLHFEQUFxRCxtQkFBTyxDQUFDLG9IQUE4Qzs7QUFFM0csbUNBQW1DLG1CQUFPLENBQUMsOERBQVE7O0FBRW5EO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQSwwRkFBMEYsYUFBYTtBQUN2RztBQUNBOztBQUVBO0FBQ0Esc01BQXNNOztBQUV0TTtBQUNBO0FBQ0EsS0FBSzs7O0FBR0w7QUFDQTtBQUNBOztBQUVBO0FBQ0EsQ0FBQzs7QUFFRCw2Qzs7Ozs7Ozs7Ozs7O0FDckRhOztBQUViLDZCQUE2QixtQkFBTyxDQUFDLG9IQUE4Qzs7QUFFbkY7QUFDQTtBQUNBLENBQUM7QUFDRDs7QUFFQSw4Q0FBOEMsbUJBQU8sQ0FBQyxzR0FBdUM7O0FBRTdGLHlEQUF5RCxtQkFBTyxDQUFDLDRIQUFrRDs7QUFFbkgsOENBQThDLG1CQUFPLENBQUMsc0dBQXVDOztBQUU3Rix3Q0FBd0MsbUJBQU8sQ0FBQywwRkFBaUM7O0FBRWpGLHFEQUFxRCxtQkFBTyxDQUFDLG9IQUE4Qzs7QUFFM0csbUNBQW1DLG1CQUFPLENBQUMsOERBQVE7O0FBRW5EO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsMEZBQTBGLGFBQWE7QUFDdkc7QUFDQTs7QUFFQTtBQUNBLG9NQUFvTTs7QUFFcE07QUFDQTtBQUNBLEtBQUs7OztBQUdMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLENBQUM7O0FBRUQsOEI7Ozs7Ozs7Ozs7OztBQ3ZEYTs7QUFFYiw2QkFBNkIsbUJBQU8sQ0FBQyxvSEFBOEM7O0FBRW5GO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7O0FBRUEsOENBQThDLG1CQUFPLENBQUMsc0dBQXVDOztBQUU3Rix5REFBeUQsbUJBQU8sQ0FBQyw0SEFBa0Q7O0FBRW5ILDhDQUE4QyxtQkFBTyxDQUFDLHNHQUF1Qzs7QUFFN0Ysd0NBQXdDLG1CQUFPLENBQUMsMEZBQWlDOztBQUVqRixxREFBcUQsbUJBQU8sQ0FBQyxvSEFBOEM7O0FBRTNHLG1DQUFtQyxtQkFBTyxDQUFDLDhEQUFROztBQUVuRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUEsMEZBQTBGLGFBQWE7QUFDdkc7QUFDQTs7QUFFQTtBQUNBLDZMQUE2TDs7QUFFN0w7QUFDQTtBQUNBLEtBQUs7OztBQUdMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLENBQUM7O0FBRUQsb0M7Ozs7Ozs7Ozs7OztBQ3JEYTs7QUFFYiw2QkFBNkIsbUJBQU8sQ0FBQyxvSEFBOEM7O0FBRW5GO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7O0FBRUEsOENBQThDLG1CQUFPLENBQUMsc0dBQXVDOztBQUU3Rix5REFBeUQsbUJBQU8sQ0FBQyw0SEFBa0Q7O0FBRW5ILDhDQUE4QyxtQkFBTyxDQUFDLHNHQUF1Qzs7QUFFN0Ysd0NBQXdDLG1CQUFPLENBQUMsMEZBQWlDOztBQUVqRixxREFBcUQsbUJBQU8sQ0FBQyxvSEFBOEM7O0FBRTNHLG1DQUFtQyxtQkFBTyxDQUFDLDhEQUFROztBQUVuRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUEsMEZBQTBGLGFBQWE7QUFDdkc7QUFDQTs7QUFFQTtBQUNBLHFMQUFxTDs7QUFFckw7QUFDQTtBQUNBLEtBQUs7OztBQUdMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLENBQUM7O0FBRUQsNEI7Ozs7Ozs7Ozs7OztBQ3JEYTs7QUFFYiw2QkFBNkIsbUJBQU8sQ0FBQyxvSEFBOEM7O0FBRW5GO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7O0FBRUEsOENBQThDLG1CQUFPLENBQUMsc0dBQXVDOztBQUU3Rix5REFBeUQsbUJBQU8sQ0FBQyw0SEFBa0Q7O0FBRW5ILDhDQUE4QyxtQkFBTyxDQUFDLHNHQUF1Qzs7QUFFN0Ysd0NBQXdDLG1CQUFPLENBQUMsMEZBQWlDOztBQUVqRixxREFBcUQsbUJBQU8sQ0FBQyxvSEFBOEM7O0FBRTNHLG1DQUFtQyxtQkFBTyxDQUFDLDhEQUFROztBQUVuRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUEsMEZBQTBGLGFBQWE7QUFDdkc7QUFDQTs7QUFFQTtBQUNBLHdMQUF3TDs7QUFFeEw7QUFDQTtBQUNBLEtBQUs7OztBQUdMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLENBQUM7O0FBRUQsK0I7Ozs7Ozs7Ozs7OztBQ3JEYTs7QUFFYiw2QkFBNkIsbUJBQU8sQ0FBQyxvSEFBOEM7O0FBRW5GO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7O0FBRUEsOENBQThDLG1CQUFPLENBQUMsc0dBQXVDOztBQUU3Rix5REFBeUQsbUJBQU8sQ0FBQyw0SEFBa0Q7O0FBRW5ILDhDQUE4QyxtQkFBTyxDQUFDLHNHQUF1Qzs7QUFFN0Ysd0NBQXdDLG1CQUFPLENBQUMsMEZBQWlDOztBQUVqRixxREFBcUQsbUJBQU8sQ0FBQyxvSEFBOEM7O0FBRTNHLG1DQUFtQyxtQkFBTyxDQUFDLDhEQUFROztBQUVuRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUEsMEZBQTBGLGFBQWE7QUFDdkc7QUFDQTs7QUFFQTtBQUNBLGtNQUFrTTs7QUFFbE07QUFDQTtBQUNBLEtBQUs7OztBQUdMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLENBQUM7O0FBRUQseUM7Ozs7Ozs7Ozs7OztBQ3JEYTs7QUFFYiw2QkFBNkIsbUJBQU8sQ0FBQyxvSEFBOEM7O0FBRW5GO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7O0FBRUEsOENBQThDLG1CQUFPLENBQUMsc0dBQXVDOztBQUU3Rix5REFBeUQsbUJBQU8sQ0FBQyw0SEFBa0Q7O0FBRW5ILDhDQUE4QyxtQkFBTyxDQUFDLHNHQUF1Qzs7QUFFN0Ysd0NBQXdDLG1CQUFPLENBQUMsMEZBQWlDOztBQUVqRixxREFBcUQsbUJBQU8sQ0FBQyxvSEFBOEM7O0FBRTNHLG1DQUFtQyxtQkFBTyxDQUFDLDhEQUFROztBQUVuRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUEsMEZBQTBGLGFBQWE7QUFDdkc7QUFDQTs7QUFFQTtBQUNBLDZNQUE2TTs7QUFFN007QUFDQTtBQUNBLEtBQUs7OztBQUdMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLENBQUM7O0FBRUQsb0Q7Ozs7Ozs7Ozs7OztBQ3JEYTs7QUFFYiw2QkFBNkIsbUJBQU8sQ0FBQyxvSEFBOEM7O0FBRW5GO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7O0FBRUEsMENBQTBDLG1CQUFPLENBQUMsc0ZBQTRCOztBQUU5RSxnREFBZ0QsbUJBQU8sQ0FBQywwR0FBeUM7O0FBRWpHLHFDQUFxQyxtQkFBTyxDQUFDLGlFQUFVOztBQUV2RDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0EsQzs7Ozs7Ozs7Ozs7O0FDckNhOztBQUViLDZCQUE2QixtQkFBTyxDQUFDLG9IQUE4Qzs7QUFFbkY7QUFDQTtBQUNBLENBQUM7QUFDRDs7QUFFQSwwQ0FBMEMsbUJBQU8sQ0FBQyxzRkFBNEI7O0FBRTlFLGdEQUFnRCxtQkFBTyxDQUFDLDBHQUF5Qzs7QUFFakcsdUNBQXVDLG1CQUFPLENBQUMsMERBQWlCOztBQUVoRSxjQUFjLG1CQUFPLENBQUMsMEVBQWtCOztBQUV4QyxhQUFhLG1CQUFPLENBQUMsb0VBQWU7O0FBRXBDLGVBQWUsbUJBQU8sQ0FBQyx3RUFBaUI7O0FBRXhDLFlBQVksbUJBQU8sQ0FBQyxrRUFBYzs7QUFFbEMsNENBQTRDLG1CQUFPLENBQUMsK0VBQWlCOztBQUVyRTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnREFBZ0Q7QUFDaEQ7QUFDQSxhQUFhOztBQUViO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQSxDOzs7Ozs7Ozs7Ozs7QUNqR2E7O0FBRWIsNkJBQTZCLG1CQUFPLENBQUMsb0hBQThDOztBQUVuRjtBQUNBO0FBQ0EsQ0FBQztBQUNEOztBQUVBLDBDQUEwQyxtQkFBTyxDQUFDLHNGQUE0Qjs7QUFFOUUsZ0RBQWdELG1CQUFPLENBQUMsMEdBQXlDOztBQUVqRyxlQUFlLG1CQUFPLENBQUMsd0VBQWlCOztBQUV4QztBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBLEM7Ozs7Ozs7Ozs7OztBQ3BEYTs7QUFFYiw2QkFBNkIsbUJBQU8sQ0FBQyxvSEFBOEM7O0FBRW5GO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7O0FBRUEsMENBQTBDLG1CQUFPLENBQUMsc0ZBQTRCOztBQUU5RSxnREFBZ0QsbUJBQU8sQ0FBQywwR0FBeUM7O0FBRWpHLHVDQUF1QyxtQkFBTyxDQUFDLDBEQUFpQjs7QUFFaEUsY0FBYyxtQkFBTyxDQUFDLDBFQUFrQjs7QUFFeEMsb0NBQW9DLG1CQUFPLENBQUMsMERBQVU7O0FBRXRELHFDQUFxQyxtQkFBTyxDQUFDLDBFQUFrQjs7QUFFL0QsYUFBYSxtQkFBTyxDQUFDLG9FQUFlOztBQUVwQyxlQUFlLG1CQUFPLENBQUMsd0VBQWlCOztBQUV4QyxZQUFZLG1CQUFPLENBQUMsa0VBQWM7O0FBRWxDLDRDQUE0QyxtQkFBTyxDQUFDLCtFQUFpQjs7QUFFckU7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdEQUFnRDtBQUNoRDtBQUNBLGFBQWE7O0FBRWI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSxnREFBZ0Q7O0FBRWhEO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGFBQWE7O0FBRWI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBLEM7Ozs7Ozs7Ozs7OztBQ3pIYTs7QUFFYiw2QkFBNkIsbUJBQU8sQ0FBQyxvSEFBOEM7O0FBRW5GO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7O0FBRUEsdUNBQXVDLG1CQUFPLENBQUMscUVBQVk7O0FBRTNEO0FBQ0E7QUFDQSxDOzs7Ozs7Ozs7Ozs7QUNiYTs7QUFFYiw2QkFBNkIsbUJBQU8sQ0FBQyxvSEFBOEM7O0FBRW5GO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQscUNBQXFDLG1CQUFPLENBQUMsaUVBQVU7O0FBRXZELHVDQUF1QyxtQkFBTyxDQUFDLHFFQUFZOztBQUUzRCw0Q0FBNEMsbUJBQU8sQ0FBQywrRUFBaUI7O0FBRXJFLG1DQUFtQyxtQkFBTyxDQUFDLDZEQUFROztBQUVuRCx1Q0FBdUMsbUJBQU8sQ0FBQyxxRUFBWTs7QUFFM0QscUNBQXFDLG1CQUFPLENBQUMsaUVBQVU7O0FBRXZELHlDQUF5QyxtQkFBTyxDQUFDLHlFQUFjOztBQUUvRCxxQ0FBcUMsbUJBQU8sQ0FBQyxpRUFBVTs7QUFFdkQscUNBQXFDLG1CQUFPLENBQUMsaUVBQVU7O0FBRXZELHFDQUFxQyxtQkFBTyxDQUFDLGlFQUFVLEc7Ozs7Ozs7Ozs7OztBQ3RGMUM7O0FBRWIsNkJBQTZCLG1CQUFPLENBQUMsb0hBQThDOztBQUVuRjtBQUNBO0FBQ0EsQ0FBQztBQUNEOztBQUVBLDBDQUEwQyxtQkFBTyxDQUFDLHNGQUE0Qjs7QUFFOUUsZ0RBQWdELG1CQUFPLENBQUMsMEdBQXlDOztBQUVqRyxxQ0FBcUMsbUJBQU8sQ0FBQywwRUFBa0I7O0FBRS9EO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQSxDOzs7Ozs7Ozs7Ozs7QUNyQ2E7O0FBRWIsNkJBQTZCLG1CQUFPLENBQUMsb0hBQThDOztBQUVuRjtBQUNBO0FBQ0EsQ0FBQztBQUNEOztBQUVBLDBDQUEwQyxtQkFBTyxDQUFDLHNGQUE0Qjs7QUFFOUUsZ0RBQWdELG1CQUFPLENBQUMsMEdBQXlDOztBQUVqRyxhQUFhLG1CQUFPLENBQUMsb0VBQWU7O0FBRXBDLGVBQWUsbUJBQU8sQ0FBQyx3RUFBaUI7O0FBRXhDLFlBQVksbUJBQU8sQ0FBQyxrRUFBYzs7QUFFbEMsY0FBYyxtQkFBTyxDQUFDLDBFQUFrQjs7QUFFeEM7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0EsQzs7Ozs7Ozs7Ozs7O0FDbkVhOztBQUViLDZCQUE2QixtQkFBTyxDQUFDLG9IQUE4Qzs7QUFFbkY7QUFDQTtBQUNBLENBQUM7QUFDRDs7QUFFQSwwQ0FBMEMsbUJBQU8sQ0FBQyxzRkFBNEI7O0FBRTlFLGdEQUFnRCxtQkFBTyxDQUFDLDBHQUF5Qzs7QUFFakcsdUNBQXVDLG1CQUFPLENBQUMscUVBQVk7O0FBRTNEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0ZBQXdGO0FBQ3hGO0FBQ0EsYUFBYTs7QUFFYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBLEM7Ozs7Ozs7Ozs7OztBQ3ZDYTs7QUFFYiw2QkFBNkIsbUJBQU8sQ0FBQyxvSEFBOEM7O0FBRW5GO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7O0FBRUEsMENBQTBDLG1CQUFPLENBQUMsc0ZBQTRCOztBQUU5RSxnREFBZ0QsbUJBQU8sQ0FBQywwR0FBeUM7O0FBRWpHLHFDQUFxQyxtQkFBTyxDQUFDLGlFQUFVOztBQUV2RDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0EsQzs7Ozs7Ozs7Ozs7O0FDckNhOztBQUViLDZCQUE2QixtQkFBTyxDQUFDLG9IQUE4Qzs7QUFFbkY7QUFDQTtBQUNBLENBQUM7QUFDRDs7QUFFQSwwQ0FBMEMsbUJBQU8sQ0FBQyxzRkFBNEI7O0FBRTlFLGdEQUFnRCxtQkFBTyxDQUFDLDBHQUF5Qzs7QUFFakcsYUFBYSxtQkFBTyxDQUFDLG9FQUFlOztBQUVwQyxlQUFlLG1CQUFPLENBQUMsd0VBQWlCOztBQUV4QyxZQUFZLG1CQUFPLENBQUMsa0VBQWM7O0FBRWxDLGVBQWUsbUJBQU8sQ0FBQyx3RUFBaUI7O0FBRXhDLGNBQWMsbUJBQU8sQ0FBQywwRUFBa0I7O0FBRXhDLHFDQUFxQyxtQkFBTyxDQUFDLDBFQUFrQjs7QUFFL0Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUM7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxzRUFBc0U7O0FBRXRFO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7O0FBRWI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7O0FBRWI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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Q0E7QUFDQTs7QUFFQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVDQUF1Qzs7QUFFdkM7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLDRDQUE0Qzs7QUFFNUMsNENBQTRDOztBQUU1QztBQUNBO0FBQ0EsaUJBQWlCOzs7QUFHakI7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxPQUFPOztBQUVQO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLHlDQUF5QztBQUN6QztBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxPQUFPOztBQUVQO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTzs7QUFFUDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTzs7QUFFUDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsQ0FBQzs7QUFFRDs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEM7Ozs7Ozs7Ozs7OztBQ3BlYTs7QUFFYjtBQUNBO0FBQ0EsQ0FBQztBQUNEOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtDQUErQztBQUMvQztBQUNBLEdBQUc7QUFDSCxDOzs7Ozs7Ozs7Ozs7QUNoQmE7O0FBRWIsNkJBQTZCLG1CQUFPLENBQUMsb0hBQThDOztBQUVuRjtBQUNBO0FBQ0EsQ0FBQztBQUNEOztBQUVBLDBDQUEwQyxtQkFBTyxDQUFDLHNGQUE0Qjs7QUFFOUUsZ0RBQWdELG1CQUFPLENBQUMsMEdBQXlDOztBQUVqRyx1Q0FBdUMsbUJBQU8sQ0FBQywwREFBaUI7O0FBRWhFLGNBQWMsbUJBQU8sQ0FBQywwRUFBa0I7O0FBRXhDLHFDQUFxQyxtQkFBTyxDQUFDLDBFQUFrQjs7QUFFL0QsYUFBYSxtQkFBTyxDQUFDLG9FQUFlOztBQUVwQyxlQUFlLG1CQUFPLENBQUMsd0VBQWlCOztBQUV4QyxZQUFZLG1CQUFPLENBQUMsa0VBQWM7O0FBRWxDOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0EsQyIsImZpbGUiOiJraW52ZXktaHRtbDUtc2RrLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHtcblx0aWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnKVxuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuXHRlbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZClcblx0XHRkZWZpbmUoW10sIGZhY3RvcnkpO1xuXHRlbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jylcblx0XHRleHBvcnRzW1wiS2ludmV5XCJdID0gZmFjdG9yeSgpO1xuXHRlbHNlXG5cdFx0cm9vdFtcIktpbnZleVwiXSA9IGZhY3RvcnkoKTtcbn0pKHdpbmRvdywgZnVuY3Rpb24oKSB7XG5yZXR1cm4gIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IFwiLi9wYWNrYWdlcy9raW52ZXktaHRtbDUtc2RrL3NyYy9pbmRleC5qc1wiKTtcbiIsImZ1bmN0aW9uIF9hcnJheVdpdGhIb2xlcyhhcnIpIHtcbiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIGFycjtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBfYXJyYXlXaXRoSG9sZXM7IiwiZnVuY3Rpb24gX2Fzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKSB7XG4gIGlmIChzZWxmID09PSB2b2lkIDApIHtcbiAgICB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7XG4gIH1cblxuICByZXR1cm4gc2VsZjtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBfYXNzZXJ0VGhpc0luaXRpYWxpemVkOyIsImZ1bmN0aW9uIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywga2V5LCBhcmcpIHtcbiAgdHJ5IHtcbiAgICB2YXIgaW5mbyA9IGdlbltrZXldKGFyZyk7XG4gICAgdmFyIHZhbHVlID0gaW5mby52YWx1ZTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZWplY3QoZXJyb3IpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmIChpbmZvLmRvbmUpIHtcbiAgICByZXNvbHZlKHZhbHVlKTtcbiAgfSBlbHNlIHtcbiAgICBQcm9taXNlLnJlc29sdmUodmFsdWUpLnRoZW4oX25leHQsIF90aHJvdyk7XG4gIH1cbn1cblxuZnVuY3Rpb24gX2FzeW5jVG9HZW5lcmF0b3IoZm4pIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXMsXG4gICAgICAgIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIHZhciBnZW4gPSBmbi5hcHBseShzZWxmLCBhcmdzKTtcblxuICAgICAgZnVuY3Rpb24gX25leHQodmFsdWUpIHtcbiAgICAgICAgYXN5bmNHZW5lcmF0b3JTdGVwKGdlbiwgcmVzb2x2ZSwgcmVqZWN0LCBfbmV4dCwgX3Rocm93LCBcIm5leHRcIiwgdmFsdWUpO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBfdGhyb3coZXJyKSB7XG4gICAgICAgIGFzeW5jR2VuZXJhdG9yU3RlcChnZW4sIHJlc29sdmUsIHJlamVjdCwgX25leHQsIF90aHJvdywgXCJ0aHJvd1wiLCBlcnIpO1xuICAgICAgfVxuXG4gICAgICBfbmV4dCh1bmRlZmluZWQpO1xuICAgIH0pO1xuICB9O1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IF9hc3luY1RvR2VuZXJhdG9yOyIsImZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHtcbiAgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpO1xuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gX2NsYXNzQ2FsbENoZWNrOyIsInZhciBzZXRQcm90b3R5cGVPZiA9IHJlcXVpcmUoXCIuL3NldFByb3RvdHlwZU9mXCIpO1xuXG5mdW5jdGlvbiBpc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKSB7XG4gIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJ1bmRlZmluZWRcIiB8fCAhUmVmbGVjdC5jb25zdHJ1Y3QpIHJldHVybiBmYWxzZTtcbiAgaWYgKFJlZmxlY3QuY29uc3RydWN0LnNoYW0pIHJldHVybiBmYWxzZTtcbiAgaWYgKHR5cGVvZiBQcm94eSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gdHJ1ZTtcblxuICB0cnkge1xuICAgIERhdGUucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoUmVmbGVjdC5jb25zdHJ1Y3QoRGF0ZSwgW10sIGZ1bmN0aW9uICgpIHt9KSk7XG4gICAgcmV0dXJuIHRydWU7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cblxuZnVuY3Rpb24gX2NvbnN0cnVjdChQYXJlbnQsIGFyZ3MsIENsYXNzKSB7XG4gIGlmIChpc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKSkge1xuICAgIG1vZHVsZS5leHBvcnRzID0gX2NvbnN0cnVjdCA9IFJlZmxlY3QuY29uc3RydWN0O1xuICB9IGVsc2Uge1xuICAgIG1vZHVsZS5leHBvcnRzID0gX2NvbnN0cnVjdCA9IGZ1bmN0aW9uIF9jb25zdHJ1Y3QoUGFyZW50LCBhcmdzLCBDbGFzcykge1xuICAgICAgdmFyIGEgPSBbbnVsbF07XG4gICAgICBhLnB1c2guYXBwbHkoYSwgYXJncyk7XG4gICAgICB2YXIgQ29uc3RydWN0b3IgPSBGdW5jdGlvbi5iaW5kLmFwcGx5KFBhcmVudCwgYSk7XG4gICAgICB2YXIgaW5zdGFuY2UgPSBuZXcgQ29uc3RydWN0b3IoKTtcbiAgICAgIGlmIChDbGFzcykgc2V0UHJvdG90eXBlT2YoaW5zdGFuY2UsIENsYXNzLnByb3RvdHlwZSk7XG4gICAgICByZXR1cm4gaW5zdGFuY2U7XG4gICAgfTtcbiAgfVxuXG4gIHJldHVybiBfY29uc3RydWN0LmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gX2NvbnN0cnVjdDsiLCJmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldO1xuICAgIGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTtcbiAgICBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7XG4gICAgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7XG4gIH1cbn1cblxuZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykge1xuICBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTtcbiAgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpO1xuICByZXR1cm4gQ29uc3RydWN0b3I7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gX2NyZWF0ZUNsYXNzOyIsImZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHtcbiAgaWYgKGtleSBpbiBvYmopIHtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHtcbiAgICAgIHZhbHVlOiB2YWx1ZSxcbiAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICB3cml0YWJsZTogdHJ1ZVxuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIG9ialtrZXldID0gdmFsdWU7XG4gIH1cblxuICByZXR1cm4gb2JqO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IF9kZWZpbmVQcm9wZXJ0eTsiLCJ2YXIgZ2V0UHJvdG90eXBlT2YgPSByZXF1aXJlKFwiLi9nZXRQcm90b3R5cGVPZlwiKTtcblxudmFyIHN1cGVyUHJvcEJhc2UgPSByZXF1aXJlKFwiLi9zdXBlclByb3BCYXNlXCIpO1xuXG5mdW5jdGlvbiBfZ2V0KHRhcmdldCwgcHJvcGVydHksIHJlY2VpdmVyKSB7XG4gIGlmICh0eXBlb2YgUmVmbGVjdCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBSZWZsZWN0LmdldCkge1xuICAgIG1vZHVsZS5leHBvcnRzID0gX2dldCA9IFJlZmxlY3QuZ2V0O1xuICB9IGVsc2Uge1xuICAgIG1vZHVsZS5leHBvcnRzID0gX2dldCA9IGZ1bmN0aW9uIF9nZXQodGFyZ2V0LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpIHtcbiAgICAgIHZhciBiYXNlID0gc3VwZXJQcm9wQmFzZSh0YXJnZXQsIHByb3BlcnR5KTtcbiAgICAgIGlmICghYmFzZSkgcmV0dXJuO1xuICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGJhc2UsIHByb3BlcnR5KTtcblxuICAgICAgaWYgKGRlc2MuZ2V0KSB7XG4gICAgICAgIHJldHVybiBkZXNjLmdldC5jYWxsKHJlY2VpdmVyKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGRlc2MudmFsdWU7XG4gICAgfTtcbiAgfVxuXG4gIHJldHVybiBfZ2V0KHRhcmdldCwgcHJvcGVydHksIHJlY2VpdmVyIHx8IHRhcmdldCk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gX2dldDsiLCJmdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2Yobykge1xuICBtb2R1bGUuZXhwb3J0cyA9IF9nZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5nZXRQcm90b3R5cGVPZiA6IGZ1bmN0aW9uIF9nZXRQcm90b3R5cGVPZihvKSB7XG4gICAgcmV0dXJuIG8uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihvKTtcbiAgfTtcbiAgcmV0dXJuIF9nZXRQcm90b3R5cGVPZihvKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBfZ2V0UHJvdG90eXBlT2Y7IiwidmFyIHNldFByb3RvdHlwZU9mID0gcmVxdWlyZShcIi4vc2V0UHJvdG90eXBlT2ZcIik7XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykge1xuICBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uXCIpO1xuICB9XG5cbiAgc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7XG4gICAgY29uc3RydWN0b3I6IHtcbiAgICAgIHZhbHVlOiBzdWJDbGFzcyxcbiAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfVxuICB9KTtcbiAgaWYgKHN1cGVyQ2xhc3MpIHNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBfaW5oZXJpdHM7IiwiZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHtcbiAgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHtcbiAgICBkZWZhdWx0OiBvYmpcbiAgfTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0OyIsImZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikge1xuICBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7XG4gICAgcmV0dXJuIG9iajtcbiAgfSBlbHNlIHtcbiAgICB2YXIgbmV3T2JqID0ge307XG5cbiAgICBpZiAob2JqICE9IG51bGwpIHtcbiAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHtcbiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHtcbiAgICAgICAgICB2YXIgZGVzYyA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSAmJiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID8gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIGtleSkgOiB7fTtcblxuICAgICAgICAgIGlmIChkZXNjLmdldCB8fCBkZXNjLnNldCkge1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5ld09iaiwga2V5LCBkZXNjKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbmV3T2JqW2tleV0gPSBvYmpba2V5XTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBuZXdPYmouZGVmYXVsdCA9IG9iajtcbiAgICByZXR1cm4gbmV3T2JqO1xuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQ7IiwiZnVuY3Rpb24gX2lzTmF0aXZlRnVuY3Rpb24oZm4pIHtcbiAgcmV0dXJuIEZ1bmN0aW9uLnRvU3RyaW5nLmNhbGwoZm4pLmluZGV4T2YoXCJbbmF0aXZlIGNvZGVdXCIpICE9PSAtMTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBfaXNOYXRpdmVGdW5jdGlvbjsiLCJmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5TGltaXQoYXJyLCBpKSB7XG4gIHZhciBfYXJyID0gW107XG4gIHZhciBfbiA9IHRydWU7XG4gIHZhciBfZCA9IGZhbHNlO1xuICB2YXIgX2UgPSB1bmRlZmluZWQ7XG5cbiAgdHJ5IHtcbiAgICBmb3IgKHZhciBfaSA9IGFycltTeW1ib2wuaXRlcmF0b3JdKCksIF9zOyAhKF9uID0gKF9zID0gX2kubmV4dCgpKS5kb25lKTsgX24gPSB0cnVlKSB7XG4gICAgICBfYXJyLnB1c2goX3MudmFsdWUpO1xuXG4gICAgICBpZiAoaSAmJiBfYXJyLmxlbmd0aCA9PT0gaSkgYnJlYWs7XG4gICAgfVxuICB9IGNhdGNoIChlcnIpIHtcbiAgICBfZCA9IHRydWU7XG4gICAgX2UgPSBlcnI7XG4gIH0gZmluYWxseSB7XG4gICAgdHJ5IHtcbiAgICAgIGlmICghX24gJiYgX2lbXCJyZXR1cm5cIl0gIT0gbnVsbCkgX2lbXCJyZXR1cm5cIl0oKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgaWYgKF9kKSB0aHJvdyBfZTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gX2Fycjtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBfaXRlcmFibGVUb0FycmF5TGltaXQ7IiwiZnVuY3Rpb24gX25vbkl0ZXJhYmxlUmVzdCgpIHtcbiAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2VcIik7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gX25vbkl0ZXJhYmxlUmVzdDsiLCJ2YXIgX3R5cGVvZiA9IHJlcXVpcmUoXCIuLi9oZWxwZXJzL3R5cGVvZlwiKTtcblxudmFyIGFzc2VydFRoaXNJbml0aWFsaXplZCA9IHJlcXVpcmUoXCIuL2Fzc2VydFRoaXNJbml0aWFsaXplZFwiKTtcblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkge1xuICBpZiAoY2FsbCAmJiAoX3R5cGVvZihjYWxsKSA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSkge1xuICAgIHJldHVybiBjYWxsO1xuICB9XG5cbiAgcmV0dXJuIGFzc2VydFRoaXNJbml0aWFsaXplZChzZWxmKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjsiLCJmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkge1xuICBtb2R1bGUuZXhwb3J0cyA9IF9zZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbiBfc2V0UHJvdG90eXBlT2YobywgcCkge1xuICAgIG8uX19wcm90b19fID0gcDtcbiAgICByZXR1cm4gbztcbiAgfTtcblxuICByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IF9zZXRQcm90b3R5cGVPZjsiLCJ2YXIgYXJyYXlXaXRoSG9sZXMgPSByZXF1aXJlKFwiLi9hcnJheVdpdGhIb2xlc1wiKTtcblxudmFyIGl0ZXJhYmxlVG9BcnJheUxpbWl0ID0gcmVxdWlyZShcIi4vaXRlcmFibGVUb0FycmF5TGltaXRcIik7XG5cbnZhciBub25JdGVyYWJsZVJlc3QgPSByZXF1aXJlKFwiLi9ub25JdGVyYWJsZVJlc3RcIik7XG5cbmZ1bmN0aW9uIF9zbGljZWRUb0FycmF5KGFyciwgaSkge1xuICByZXR1cm4gYXJyYXlXaXRoSG9sZXMoYXJyKSB8fCBpdGVyYWJsZVRvQXJyYXlMaW1pdChhcnIsIGkpIHx8IG5vbkl0ZXJhYmxlUmVzdCgpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IF9zbGljZWRUb0FycmF5OyIsInZhciBnZXRQcm90b3R5cGVPZiA9IHJlcXVpcmUoXCIuL2dldFByb3RvdHlwZU9mXCIpO1xuXG5mdW5jdGlvbiBfc3VwZXJQcm9wQmFzZShvYmplY3QsIHByb3BlcnR5KSB7XG4gIHdoaWxlICghT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpKSB7XG4gICAgb2JqZWN0ID0gZ2V0UHJvdG90eXBlT2Yob2JqZWN0KTtcbiAgICBpZiAob2JqZWN0ID09PSBudWxsKSBicmVhaztcbiAgfVxuXG4gIHJldHVybiBvYmplY3Q7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gX3N1cGVyUHJvcEJhc2U7IiwiZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IGlmICh0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gXCJzeW1ib2xcIikgeyBfdHlwZW9mMiA9IGZ1bmN0aW9uIF90eXBlb2YyKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfTsgfSBlbHNlIHsgX3R5cGVvZjIgPSBmdW5jdGlvbiBfdHlwZW9mMihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7IH07IH0gcmV0dXJuIF90eXBlb2YyKG9iaik7IH1cblxuZnVuY3Rpb24gX3R5cGVvZihvYmopIHtcbiAgaWYgKHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBfdHlwZW9mMihTeW1ib2wuaXRlcmF0b3IpID09PSBcInN5bWJvbFwiKSB7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHtcbiAgICAgIHJldHVybiBfdHlwZW9mMihvYmopO1xuICAgIH07XG4gIH0gZWxzZSB7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHtcbiAgICAgIHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/IFwic3ltYm9sXCIgOiBfdHlwZW9mMihvYmopO1xuICAgIH07XG4gIH1cblxuICByZXR1cm4gX3R5cGVvZihvYmopO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IF90eXBlb2Y7IiwidmFyIGdldFByb3RvdHlwZU9mID0gcmVxdWlyZShcIi4vZ2V0UHJvdG90eXBlT2ZcIik7XG5cbnZhciBzZXRQcm90b3R5cGVPZiA9IHJlcXVpcmUoXCIuL3NldFByb3RvdHlwZU9mXCIpO1xuXG52YXIgaXNOYXRpdmVGdW5jdGlvbiA9IHJlcXVpcmUoXCIuL2lzTmF0aXZlRnVuY3Rpb25cIik7XG5cbnZhciBjb25zdHJ1Y3QgPSByZXF1aXJlKFwiLi9jb25zdHJ1Y3RcIik7XG5cbmZ1bmN0aW9uIF93cmFwTmF0aXZlU3VwZXIoQ2xhc3MpIHtcbiAgdmFyIF9jYWNoZSA9IHR5cGVvZiBNYXAgPT09IFwiZnVuY3Rpb25cIiA/IG5ldyBNYXAoKSA6IHVuZGVmaW5lZDtcblxuICBtb2R1bGUuZXhwb3J0cyA9IF93cmFwTmF0aXZlU3VwZXIgPSBmdW5jdGlvbiBfd3JhcE5hdGl2ZVN1cGVyKENsYXNzKSB7XG4gICAgaWYgKENsYXNzID09PSBudWxsIHx8ICFpc05hdGl2ZUZ1bmN0aW9uKENsYXNzKSkgcmV0dXJuIENsYXNzO1xuXG4gICAgaWYgKHR5cGVvZiBDbGFzcyAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb25cIik7XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiBfY2FjaGUgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIGlmIChfY2FjaGUuaGFzKENsYXNzKSkgcmV0dXJuIF9jYWNoZS5nZXQoQ2xhc3MpO1xuXG4gICAgICBfY2FjaGUuc2V0KENsYXNzLCBXcmFwcGVyKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBXcmFwcGVyKCkge1xuICAgICAgcmV0dXJuIGNvbnN0cnVjdChDbGFzcywgYXJndW1lbnRzLCBnZXRQcm90b3R5cGVPZih0aGlzKS5jb25zdHJ1Y3Rvcik7XG4gICAgfVxuXG4gICAgV3JhcHBlci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKENsYXNzLnByb3RvdHlwZSwge1xuICAgICAgY29uc3RydWN0b3I6IHtcbiAgICAgICAgdmFsdWU6IFdyYXBwZXIsXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHNldFByb3RvdHlwZU9mKFdyYXBwZXIsIENsYXNzKTtcbiAgfTtcblxuICByZXR1cm4gX3dyYXBOYXRpdmVTdXBlcihDbGFzcyk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gX3dyYXBOYXRpdmVTdXBlcjsiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJyZWdlbmVyYXRvci1ydW50aW1lXCIpO1xuIiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuL2xpYi9heGlvcycpOyIsIid1c2Ugc3RyaWN0JztcblxudmFyIHV0aWxzID0gcmVxdWlyZSgnLi8uLi91dGlscycpO1xudmFyIHNldHRsZSA9IHJlcXVpcmUoJy4vLi4vY29yZS9zZXR0bGUnKTtcbnZhciBidWlsZFVSTCA9IHJlcXVpcmUoJy4vLi4vaGVscGVycy9idWlsZFVSTCcpO1xudmFyIHBhcnNlSGVhZGVycyA9IHJlcXVpcmUoJy4vLi4vaGVscGVycy9wYXJzZUhlYWRlcnMnKTtcbnZhciBpc1VSTFNhbWVPcmlnaW4gPSByZXF1aXJlKCcuLy4uL2hlbHBlcnMvaXNVUkxTYW1lT3JpZ2luJyk7XG52YXIgY3JlYXRlRXJyb3IgPSByZXF1aXJlKCcuLi9jb3JlL2NyZWF0ZUVycm9yJyk7XG52YXIgYnRvYSA9ICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB3aW5kb3cuYnRvYSAmJiB3aW5kb3cuYnRvYS5iaW5kKHdpbmRvdykpIHx8IHJlcXVpcmUoJy4vLi4vaGVscGVycy9idG9hJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24geGhyQWRhcHRlcihjb25maWcpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIGRpc3BhdGNoWGhyUmVxdWVzdChyZXNvbHZlLCByZWplY3QpIHtcbiAgICB2YXIgcmVxdWVzdERhdGEgPSBjb25maWcuZGF0YTtcbiAgICB2YXIgcmVxdWVzdEhlYWRlcnMgPSBjb25maWcuaGVhZGVycztcblxuICAgIGlmICh1dGlscy5pc0Zvcm1EYXRhKHJlcXVlc3REYXRhKSkge1xuICAgICAgZGVsZXRlIHJlcXVlc3RIZWFkZXJzWydDb250ZW50LVR5cGUnXTsgLy8gTGV0IHRoZSBicm93c2VyIHNldCBpdFxuICAgIH1cblxuICAgIHZhciByZXF1ZXN0ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgdmFyIGxvYWRFdmVudCA9ICdvbnJlYWR5c3RhdGVjaGFuZ2UnO1xuICAgIHZhciB4RG9tYWluID0gZmFsc2U7XG5cbiAgICAvLyBGb3IgSUUgOC85IENPUlMgc3VwcG9ydFxuICAgIC8vIE9ubHkgc3VwcG9ydHMgUE9TVCBhbmQgR0VUIGNhbGxzIGFuZCBkb2Vzbid0IHJldHVybnMgdGhlIHJlc3BvbnNlIGhlYWRlcnMuXG4gICAgLy8gRE9OJ1QgZG8gdGhpcyBmb3IgdGVzdGluZyBiL2MgWE1MSHR0cFJlcXVlc3QgaXMgbW9ja2VkLCBub3QgWERvbWFpblJlcXVlc3QuXG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAndGVzdCcgJiZcbiAgICAgICAgdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiZcbiAgICAgICAgd2luZG93LlhEb21haW5SZXF1ZXN0ICYmICEoJ3dpdGhDcmVkZW50aWFscycgaW4gcmVxdWVzdCkgJiZcbiAgICAgICAgIWlzVVJMU2FtZU9yaWdpbihjb25maWcudXJsKSkge1xuICAgICAgcmVxdWVzdCA9IG5ldyB3aW5kb3cuWERvbWFpblJlcXVlc3QoKTtcbiAgICAgIGxvYWRFdmVudCA9ICdvbmxvYWQnO1xuICAgICAgeERvbWFpbiA9IHRydWU7XG4gICAgICByZXF1ZXN0Lm9ucHJvZ3Jlc3MgPSBmdW5jdGlvbiBoYW5kbGVQcm9ncmVzcygpIHt9O1xuICAgICAgcmVxdWVzdC5vbnRpbWVvdXQgPSBmdW5jdGlvbiBoYW5kbGVUaW1lb3V0KCkge307XG4gICAgfVxuXG4gICAgLy8gSFRUUCBiYXNpYyBhdXRoZW50aWNhdGlvblxuICAgIGlmIChjb25maWcuYXV0aCkge1xuICAgICAgdmFyIHVzZXJuYW1lID0gY29uZmlnLmF1dGgudXNlcm5hbWUgfHwgJyc7XG4gICAgICB2YXIgcGFzc3dvcmQgPSBjb25maWcuYXV0aC5wYXNzd29yZCB8fCAnJztcbiAgICAgIHJlcXVlc3RIZWFkZXJzLkF1dGhvcml6YXRpb24gPSAnQmFzaWMgJyArIGJ0b2EodXNlcm5hbWUgKyAnOicgKyBwYXNzd29yZCk7XG4gICAgfVxuXG4gICAgcmVxdWVzdC5vcGVuKGNvbmZpZy5tZXRob2QudG9VcHBlckNhc2UoKSwgYnVpbGRVUkwoY29uZmlnLnVybCwgY29uZmlnLnBhcmFtcywgY29uZmlnLnBhcmFtc1NlcmlhbGl6ZXIpLCB0cnVlKTtcblxuICAgIC8vIFNldCB0aGUgcmVxdWVzdCB0aW1lb3V0IGluIE1TXG4gICAgcmVxdWVzdC50aW1lb3V0ID0gY29uZmlnLnRpbWVvdXQ7XG5cbiAgICAvLyBMaXN0ZW4gZm9yIHJlYWR5IHN0YXRlXG4gICAgcmVxdWVzdFtsb2FkRXZlbnRdID0gZnVuY3Rpb24gaGFuZGxlTG9hZCgpIHtcbiAgICAgIGlmICghcmVxdWVzdCB8fCAocmVxdWVzdC5yZWFkeVN0YXRlICE9PSA0ICYmICF4RG9tYWluKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIFRoZSByZXF1ZXN0IGVycm9yZWQgb3V0IGFuZCB3ZSBkaWRuJ3QgZ2V0IGEgcmVzcG9uc2UsIHRoaXMgd2lsbCBiZVxuICAgICAgLy8gaGFuZGxlZCBieSBvbmVycm9yIGluc3RlYWRcbiAgICAgIC8vIFdpdGggb25lIGV4Y2VwdGlvbjogcmVxdWVzdCB0aGF0IHVzaW5nIGZpbGU6IHByb3RvY29sLCBtb3N0IGJyb3dzZXJzXG4gICAgICAvLyB3aWxsIHJldHVybiBzdGF0dXMgYXMgMCBldmVuIHRob3VnaCBpdCdzIGEgc3VjY2Vzc2Z1bCByZXF1ZXN0XG4gICAgICBpZiAocmVxdWVzdC5zdGF0dXMgPT09IDAgJiYgIShyZXF1ZXN0LnJlc3BvbnNlVVJMICYmIHJlcXVlc3QucmVzcG9uc2VVUkwuaW5kZXhPZignZmlsZTonKSA9PT0gMCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBQcmVwYXJlIHRoZSByZXNwb25zZVxuICAgICAgdmFyIHJlc3BvbnNlSGVhZGVycyA9ICdnZXRBbGxSZXNwb25zZUhlYWRlcnMnIGluIHJlcXVlc3QgPyBwYXJzZUhlYWRlcnMocmVxdWVzdC5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKSkgOiBudWxsO1xuICAgICAgdmFyIHJlc3BvbnNlRGF0YSA9ICFjb25maWcucmVzcG9uc2VUeXBlIHx8IGNvbmZpZy5yZXNwb25zZVR5cGUgPT09ICd0ZXh0JyA/IHJlcXVlc3QucmVzcG9uc2VUZXh0IDogcmVxdWVzdC5yZXNwb25zZTtcbiAgICAgIHZhciByZXNwb25zZSA9IHtcbiAgICAgICAgZGF0YTogcmVzcG9uc2VEYXRhLFxuICAgICAgICAvLyBJRSBzZW5kcyAxMjIzIGluc3RlYWQgb2YgMjA0IChodHRwczovL2dpdGh1Yi5jb20vYXhpb3MvYXhpb3MvaXNzdWVzLzIwMSlcbiAgICAgICAgc3RhdHVzOiByZXF1ZXN0LnN0YXR1cyA9PT0gMTIyMyA/IDIwNCA6IHJlcXVlc3Quc3RhdHVzLFxuICAgICAgICBzdGF0dXNUZXh0OiByZXF1ZXN0LnN0YXR1cyA9PT0gMTIyMyA/ICdObyBDb250ZW50JyA6IHJlcXVlc3Quc3RhdHVzVGV4dCxcbiAgICAgICAgaGVhZGVyczogcmVzcG9uc2VIZWFkZXJzLFxuICAgICAgICBjb25maWc6IGNvbmZpZyxcbiAgICAgICAgcmVxdWVzdDogcmVxdWVzdFxuICAgICAgfTtcblxuICAgICAgc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgcmVzcG9uc2UpO1xuXG4gICAgICAvLyBDbGVhbiB1cCByZXF1ZXN0XG4gICAgICByZXF1ZXN0ID0gbnVsbDtcbiAgICB9O1xuXG4gICAgLy8gSGFuZGxlIGxvdyBsZXZlbCBuZXR3b3JrIGVycm9yc1xuICAgIHJlcXVlc3Qub25lcnJvciA9IGZ1bmN0aW9uIGhhbmRsZUVycm9yKCkge1xuICAgICAgLy8gUmVhbCBlcnJvcnMgYXJlIGhpZGRlbiBmcm9tIHVzIGJ5IHRoZSBicm93c2VyXG4gICAgICAvLyBvbmVycm9yIHNob3VsZCBvbmx5IGZpcmUgaWYgaXQncyBhIG5ldHdvcmsgZXJyb3JcbiAgICAgIHJlamVjdChjcmVhdGVFcnJvcignTmV0d29yayBFcnJvcicsIGNvbmZpZywgbnVsbCwgcmVxdWVzdCkpO1xuXG4gICAgICAvLyBDbGVhbiB1cCByZXF1ZXN0XG4gICAgICByZXF1ZXN0ID0gbnVsbDtcbiAgICB9O1xuXG4gICAgLy8gSGFuZGxlIHRpbWVvdXRcbiAgICByZXF1ZXN0Lm9udGltZW91dCA9IGZ1bmN0aW9uIGhhbmRsZVRpbWVvdXQoKSB7XG4gICAgICByZWplY3QoY3JlYXRlRXJyb3IoJ3RpbWVvdXQgb2YgJyArIGNvbmZpZy50aW1lb3V0ICsgJ21zIGV4Y2VlZGVkJywgY29uZmlnLCAnRUNPTk5BQk9SVEVEJyxcbiAgICAgICAgcmVxdWVzdCkpO1xuXG4gICAgICAvLyBDbGVhbiB1cCByZXF1ZXN0XG4gICAgICByZXF1ZXN0ID0gbnVsbDtcbiAgICB9O1xuXG4gICAgLy8gQWRkIHhzcmYgaGVhZGVyXG4gICAgLy8gVGhpcyBpcyBvbmx5IGRvbmUgaWYgcnVubmluZyBpbiBhIHN0YW5kYXJkIGJyb3dzZXIgZW52aXJvbm1lbnQuXG4gICAgLy8gU3BlY2lmaWNhbGx5IG5vdCBpZiB3ZSdyZSBpbiBhIHdlYiB3b3JrZXIsIG9yIHJlYWN0LW5hdGl2ZS5cbiAgICBpZiAodXRpbHMuaXNTdGFuZGFyZEJyb3dzZXJFbnYoKSkge1xuICAgICAgdmFyIGNvb2tpZXMgPSByZXF1aXJlKCcuLy4uL2hlbHBlcnMvY29va2llcycpO1xuXG4gICAgICAvLyBBZGQgeHNyZiBoZWFkZXJcbiAgICAgIHZhciB4c3JmVmFsdWUgPSAoY29uZmlnLndpdGhDcmVkZW50aWFscyB8fCBpc1VSTFNhbWVPcmlnaW4oY29uZmlnLnVybCkpICYmIGNvbmZpZy54c3JmQ29va2llTmFtZSA/XG4gICAgICAgICAgY29va2llcy5yZWFkKGNvbmZpZy54c3JmQ29va2llTmFtZSkgOlxuICAgICAgICAgIHVuZGVmaW5lZDtcblxuICAgICAgaWYgKHhzcmZWYWx1ZSkge1xuICAgICAgICByZXF1ZXN0SGVhZGVyc1tjb25maWcueHNyZkhlYWRlck5hbWVdID0geHNyZlZhbHVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEFkZCBoZWFkZXJzIHRvIHRoZSByZXF1ZXN0XG4gICAgaWYgKCdzZXRSZXF1ZXN0SGVhZGVyJyBpbiByZXF1ZXN0KSB7XG4gICAgICB1dGlscy5mb3JFYWNoKHJlcXVlc3RIZWFkZXJzLCBmdW5jdGlvbiBzZXRSZXF1ZXN0SGVhZGVyKHZhbCwga2V5KSB7XG4gICAgICAgIGlmICh0eXBlb2YgcmVxdWVzdERhdGEgPT09ICd1bmRlZmluZWQnICYmIGtleS50b0xvd2VyQ2FzZSgpID09PSAnY29udGVudC10eXBlJykge1xuICAgICAgICAgIC8vIFJlbW92ZSBDb250ZW50LVR5cGUgaWYgZGF0YSBpcyB1bmRlZmluZWRcbiAgICAgICAgICBkZWxldGUgcmVxdWVzdEhlYWRlcnNba2V5XTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBPdGhlcndpc2UgYWRkIGhlYWRlciB0byB0aGUgcmVxdWVzdFxuICAgICAgICAgIHJlcXVlc3Quc2V0UmVxdWVzdEhlYWRlcihrZXksIHZhbCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIEFkZCB3aXRoQ3JlZGVudGlhbHMgdG8gcmVxdWVzdCBpZiBuZWVkZWRcbiAgICBpZiAoY29uZmlnLndpdGhDcmVkZW50aWFscykge1xuICAgICAgcmVxdWVzdC53aXRoQ3JlZGVudGlhbHMgPSB0cnVlO1xuICAgIH1cblxuICAgIC8vIEFkZCByZXNwb25zZVR5cGUgdG8gcmVxdWVzdCBpZiBuZWVkZWRcbiAgICBpZiAoY29uZmlnLnJlc3BvbnNlVHlwZSkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgcmVxdWVzdC5yZXNwb25zZVR5cGUgPSBjb25maWcucmVzcG9uc2VUeXBlO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAvLyBFeHBlY3RlZCBET01FeGNlcHRpb24gdGhyb3duIGJ5IGJyb3dzZXJzIG5vdCBjb21wYXRpYmxlIFhNTEh0dHBSZXF1ZXN0IExldmVsIDIuXG4gICAgICAgIC8vIEJ1dCwgdGhpcyBjYW4gYmUgc3VwcHJlc3NlZCBmb3IgJ2pzb24nIHR5cGUgYXMgaXQgY2FuIGJlIHBhcnNlZCBieSBkZWZhdWx0ICd0cmFuc2Zvcm1SZXNwb25zZScgZnVuY3Rpb24uXG4gICAgICAgIGlmIChjb25maWcucmVzcG9uc2VUeXBlICE9PSAnanNvbicpIHtcbiAgICAgICAgICB0aHJvdyBlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gSGFuZGxlIHByb2dyZXNzIGlmIG5lZWRlZFxuICAgIGlmICh0eXBlb2YgY29uZmlnLm9uRG93bmxvYWRQcm9ncmVzcyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdwcm9ncmVzcycsIGNvbmZpZy5vbkRvd25sb2FkUHJvZ3Jlc3MpO1xuICAgIH1cblxuICAgIC8vIE5vdCBhbGwgYnJvd3NlcnMgc3VwcG9ydCB1cGxvYWQgZXZlbnRzXG4gICAgaWYgKHR5cGVvZiBjb25maWcub25VcGxvYWRQcm9ncmVzcyA9PT0gJ2Z1bmN0aW9uJyAmJiByZXF1ZXN0LnVwbG9hZCkge1xuICAgICAgcmVxdWVzdC51cGxvYWQuYWRkRXZlbnRMaXN0ZW5lcigncHJvZ3Jlc3MnLCBjb25maWcub25VcGxvYWRQcm9ncmVzcyk7XG4gICAgfVxuXG4gICAgaWYgKGNvbmZpZy5jYW5jZWxUb2tlbikge1xuICAgICAgLy8gSGFuZGxlIGNhbmNlbGxhdGlvblxuICAgICAgY29uZmlnLmNhbmNlbFRva2VuLnByb21pc2UudGhlbihmdW5jdGlvbiBvbkNhbmNlbGVkKGNhbmNlbCkge1xuICAgICAgICBpZiAoIXJlcXVlc3QpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICByZXF1ZXN0LmFib3J0KCk7XG4gICAgICAgIHJlamVjdChjYW5jZWwpO1xuICAgICAgICAvLyBDbGVhbiB1cCByZXF1ZXN0XG4gICAgICAgIHJlcXVlc3QgPSBudWxsO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKHJlcXVlc3REYXRhID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHJlcXVlc3REYXRhID0gbnVsbDtcbiAgICB9XG5cbiAgICAvLyBTZW5kIHRoZSByZXF1ZXN0XG4gICAgcmVxdWVzdC5zZW5kKHJlcXVlc3REYXRhKTtcbiAgfSk7XG59O1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgdXRpbHMgPSByZXF1aXJlKCcuL3V0aWxzJyk7XG52YXIgYmluZCA9IHJlcXVpcmUoJy4vaGVscGVycy9iaW5kJyk7XG52YXIgQXhpb3MgPSByZXF1aXJlKCcuL2NvcmUvQXhpb3MnKTtcbnZhciBkZWZhdWx0cyA9IHJlcXVpcmUoJy4vZGVmYXVsdHMnKTtcblxuLyoqXG4gKiBDcmVhdGUgYW4gaW5zdGFuY2Ugb2YgQXhpb3NcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gZGVmYXVsdENvbmZpZyBUaGUgZGVmYXVsdCBjb25maWcgZm9yIHRoZSBpbnN0YW5jZVxuICogQHJldHVybiB7QXhpb3N9IEEgbmV3IGluc3RhbmNlIG9mIEF4aW9zXG4gKi9cbmZ1bmN0aW9uIGNyZWF0ZUluc3RhbmNlKGRlZmF1bHRDb25maWcpIHtcbiAgdmFyIGNvbnRleHQgPSBuZXcgQXhpb3MoZGVmYXVsdENvbmZpZyk7XG4gIHZhciBpbnN0YW5jZSA9IGJpbmQoQXhpb3MucHJvdG90eXBlLnJlcXVlc3QsIGNvbnRleHQpO1xuXG4gIC8vIENvcHkgYXhpb3MucHJvdG90eXBlIHRvIGluc3RhbmNlXG4gIHV0aWxzLmV4dGVuZChpbnN0YW5jZSwgQXhpb3MucHJvdG90eXBlLCBjb250ZXh0KTtcblxuICAvLyBDb3B5IGNvbnRleHQgdG8gaW5zdGFuY2VcbiAgdXRpbHMuZXh0ZW5kKGluc3RhbmNlLCBjb250ZXh0KTtcblxuICByZXR1cm4gaW5zdGFuY2U7XG59XG5cbi8vIENyZWF0ZSB0aGUgZGVmYXVsdCBpbnN0YW5jZSB0byBiZSBleHBvcnRlZFxudmFyIGF4aW9zID0gY3JlYXRlSW5zdGFuY2UoZGVmYXVsdHMpO1xuXG4vLyBFeHBvc2UgQXhpb3MgY2xhc3MgdG8gYWxsb3cgY2xhc3MgaW5oZXJpdGFuY2VcbmF4aW9zLkF4aW9zID0gQXhpb3M7XG5cbi8vIEZhY3RvcnkgZm9yIGNyZWF0aW5nIG5ldyBpbnN0YW5jZXNcbmF4aW9zLmNyZWF0ZSA9IGZ1bmN0aW9uIGNyZWF0ZShpbnN0YW5jZUNvbmZpZykge1xuICByZXR1cm4gY3JlYXRlSW5zdGFuY2UodXRpbHMubWVyZ2UoZGVmYXVsdHMsIGluc3RhbmNlQ29uZmlnKSk7XG59O1xuXG4vLyBFeHBvc2UgQ2FuY2VsICYgQ2FuY2VsVG9rZW5cbmF4aW9zLkNhbmNlbCA9IHJlcXVpcmUoJy4vY2FuY2VsL0NhbmNlbCcpO1xuYXhpb3MuQ2FuY2VsVG9rZW4gPSByZXF1aXJlKCcuL2NhbmNlbC9DYW5jZWxUb2tlbicpO1xuYXhpb3MuaXNDYW5jZWwgPSByZXF1aXJlKCcuL2NhbmNlbC9pc0NhbmNlbCcpO1xuXG4vLyBFeHBvc2UgYWxsL3NwcmVhZFxuYXhpb3MuYWxsID0gZnVuY3Rpb24gYWxsKHByb21pc2VzKSB7XG4gIHJldHVybiBQcm9taXNlLmFsbChwcm9taXNlcyk7XG59O1xuYXhpb3Muc3ByZWFkID0gcmVxdWlyZSgnLi9oZWxwZXJzL3NwcmVhZCcpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGF4aW9zO1xuXG4vLyBBbGxvdyB1c2Ugb2YgZGVmYXVsdCBpbXBvcnQgc3ludGF4IGluIFR5cGVTY3JpcHRcbm1vZHVsZS5leHBvcnRzLmRlZmF1bHQgPSBheGlvcztcbiIsIid1c2Ugc3RyaWN0JztcblxuLyoqXG4gKiBBIGBDYW5jZWxgIGlzIGFuIG9iamVjdCB0aGF0IGlzIHRocm93biB3aGVuIGFuIG9wZXJhdGlvbiBpcyBjYW5jZWxlZC5cbiAqXG4gKiBAY2xhc3NcbiAqIEBwYXJhbSB7c3RyaW5nPX0gbWVzc2FnZSBUaGUgbWVzc2FnZS5cbiAqL1xuZnVuY3Rpb24gQ2FuY2VsKG1lc3NhZ2UpIHtcbiAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZTtcbn1cblxuQ2FuY2VsLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uIHRvU3RyaW5nKCkge1xuICByZXR1cm4gJ0NhbmNlbCcgKyAodGhpcy5tZXNzYWdlID8gJzogJyArIHRoaXMubWVzc2FnZSA6ICcnKTtcbn07XG5cbkNhbmNlbC5wcm90b3R5cGUuX19DQU5DRUxfXyA9IHRydWU7XG5cbm1vZHVsZS5leHBvcnRzID0gQ2FuY2VsO1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgQ2FuY2VsID0gcmVxdWlyZSgnLi9DYW5jZWwnKTtcblxuLyoqXG4gKiBBIGBDYW5jZWxUb2tlbmAgaXMgYW4gb2JqZWN0IHRoYXQgY2FuIGJlIHVzZWQgdG8gcmVxdWVzdCBjYW5jZWxsYXRpb24gb2YgYW4gb3BlcmF0aW9uLlxuICpcbiAqIEBjbGFzc1xuICogQHBhcmFtIHtGdW5jdGlvbn0gZXhlY3V0b3IgVGhlIGV4ZWN1dG9yIGZ1bmN0aW9uLlxuICovXG5mdW5jdGlvbiBDYW5jZWxUb2tlbihleGVjdXRvcikge1xuICBpZiAodHlwZW9mIGV4ZWN1dG9yICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignZXhlY3V0b3IgbXVzdCBiZSBhIGZ1bmN0aW9uLicpO1xuICB9XG5cbiAgdmFyIHJlc29sdmVQcm9taXNlO1xuICB0aGlzLnByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiBwcm9taXNlRXhlY3V0b3IocmVzb2x2ZSkge1xuICAgIHJlc29sdmVQcm9taXNlID0gcmVzb2x2ZTtcbiAgfSk7XG5cbiAgdmFyIHRva2VuID0gdGhpcztcbiAgZXhlY3V0b3IoZnVuY3Rpb24gY2FuY2VsKG1lc3NhZ2UpIHtcbiAgICBpZiAodG9rZW4ucmVhc29uKSB7XG4gICAgICAvLyBDYW5jZWxsYXRpb24gaGFzIGFscmVhZHkgYmVlbiByZXF1ZXN0ZWRcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0b2tlbi5yZWFzb24gPSBuZXcgQ2FuY2VsKG1lc3NhZ2UpO1xuICAgIHJlc29sdmVQcm9taXNlKHRva2VuLnJlYXNvbik7XG4gIH0pO1xufVxuXG4vKipcbiAqIFRocm93cyBhIGBDYW5jZWxgIGlmIGNhbmNlbGxhdGlvbiBoYXMgYmVlbiByZXF1ZXN0ZWQuXG4gKi9cbkNhbmNlbFRva2VuLnByb3RvdHlwZS50aHJvd0lmUmVxdWVzdGVkID0gZnVuY3Rpb24gdGhyb3dJZlJlcXVlc3RlZCgpIHtcbiAgaWYgKHRoaXMucmVhc29uKSB7XG4gICAgdGhyb3cgdGhpcy5yZWFzb247XG4gIH1cbn07XG5cbi8qKlxuICogUmV0dXJucyBhbiBvYmplY3QgdGhhdCBjb250YWlucyBhIG5ldyBgQ2FuY2VsVG9rZW5gIGFuZCBhIGZ1bmN0aW9uIHRoYXQsIHdoZW4gY2FsbGVkLFxuICogY2FuY2VscyB0aGUgYENhbmNlbFRva2VuYC5cbiAqL1xuQ2FuY2VsVG9rZW4uc291cmNlID0gZnVuY3Rpb24gc291cmNlKCkge1xuICB2YXIgY2FuY2VsO1xuICB2YXIgdG9rZW4gPSBuZXcgQ2FuY2VsVG9rZW4oZnVuY3Rpb24gZXhlY3V0b3IoYykge1xuICAgIGNhbmNlbCA9IGM7XG4gIH0pO1xuICByZXR1cm4ge1xuICAgIHRva2VuOiB0b2tlbixcbiAgICBjYW5jZWw6IGNhbmNlbFxuICB9O1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBDYW5jZWxUb2tlbjtcbiIsIid1c2Ugc3RyaWN0JztcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBpc0NhbmNlbCh2YWx1ZSkge1xuICByZXR1cm4gISEodmFsdWUgJiYgdmFsdWUuX19DQU5DRUxfXyk7XG59O1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgZGVmYXVsdHMgPSByZXF1aXJlKCcuLy4uL2RlZmF1bHRzJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCcuLy4uL3V0aWxzJyk7XG52YXIgSW50ZXJjZXB0b3JNYW5hZ2VyID0gcmVxdWlyZSgnLi9JbnRlcmNlcHRvck1hbmFnZXInKTtcbnZhciBkaXNwYXRjaFJlcXVlc3QgPSByZXF1aXJlKCcuL2Rpc3BhdGNoUmVxdWVzdCcpO1xuXG4vKipcbiAqIENyZWF0ZSBhIG5ldyBpbnN0YW5jZSBvZiBBeGlvc1xuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBpbnN0YW5jZUNvbmZpZyBUaGUgZGVmYXVsdCBjb25maWcgZm9yIHRoZSBpbnN0YW5jZVxuICovXG5mdW5jdGlvbiBBeGlvcyhpbnN0YW5jZUNvbmZpZykge1xuICB0aGlzLmRlZmF1bHRzID0gaW5zdGFuY2VDb25maWc7XG4gIHRoaXMuaW50ZXJjZXB0b3JzID0ge1xuICAgIHJlcXVlc3Q6IG5ldyBJbnRlcmNlcHRvck1hbmFnZXIoKSxcbiAgICByZXNwb25zZTogbmV3IEludGVyY2VwdG9yTWFuYWdlcigpXG4gIH07XG59XG5cbi8qKlxuICogRGlzcGF0Y2ggYSByZXF1ZXN0XG4gKlxuICogQHBhcmFtIHtPYmplY3R9IGNvbmZpZyBUaGUgY29uZmlnIHNwZWNpZmljIGZvciB0aGlzIHJlcXVlc3QgKG1lcmdlZCB3aXRoIHRoaXMuZGVmYXVsdHMpXG4gKi9cbkF4aW9zLnByb3RvdHlwZS5yZXF1ZXN0ID0gZnVuY3Rpb24gcmVxdWVzdChjb25maWcpIHtcbiAgLyplc2xpbnQgbm8tcGFyYW0tcmVhc3NpZ246MCovXG4gIC8vIEFsbG93IGZvciBheGlvcygnZXhhbXBsZS91cmwnWywgY29uZmlnXSkgYSBsYSBmZXRjaCBBUElcbiAgaWYgKHR5cGVvZiBjb25maWcgPT09ICdzdHJpbmcnKSB7XG4gICAgY29uZmlnID0gdXRpbHMubWVyZ2Uoe1xuICAgICAgdXJsOiBhcmd1bWVudHNbMF1cbiAgICB9LCBhcmd1bWVudHNbMV0pO1xuICB9XG5cbiAgY29uZmlnID0gdXRpbHMubWVyZ2UoZGVmYXVsdHMsIHttZXRob2Q6ICdnZXQnfSwgdGhpcy5kZWZhdWx0cywgY29uZmlnKTtcbiAgY29uZmlnLm1ldGhvZCA9IGNvbmZpZy5tZXRob2QudG9Mb3dlckNhc2UoKTtcblxuICAvLyBIb29rIHVwIGludGVyY2VwdG9ycyBtaWRkbGV3YXJlXG4gIHZhciBjaGFpbiA9IFtkaXNwYXRjaFJlcXVlc3QsIHVuZGVmaW5lZF07XG4gIHZhciBwcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKGNvbmZpZyk7XG5cbiAgdGhpcy5pbnRlcmNlcHRvcnMucmVxdWVzdC5mb3JFYWNoKGZ1bmN0aW9uIHVuc2hpZnRSZXF1ZXN0SW50ZXJjZXB0b3JzKGludGVyY2VwdG9yKSB7XG4gICAgY2hhaW4udW5zaGlmdChpbnRlcmNlcHRvci5mdWxmaWxsZWQsIGludGVyY2VwdG9yLnJlamVjdGVkKTtcbiAgfSk7XG5cbiAgdGhpcy5pbnRlcmNlcHRvcnMucmVzcG9uc2UuZm9yRWFjaChmdW5jdGlvbiBwdXNoUmVzcG9uc2VJbnRlcmNlcHRvcnMoaW50ZXJjZXB0b3IpIHtcbiAgICBjaGFpbi5wdXNoKGludGVyY2VwdG9yLmZ1bGZpbGxlZCwgaW50ZXJjZXB0b3IucmVqZWN0ZWQpO1xuICB9KTtcblxuICB3aGlsZSAoY2hhaW4ubGVuZ3RoKSB7XG4gICAgcHJvbWlzZSA9IHByb21pc2UudGhlbihjaGFpbi5zaGlmdCgpLCBjaGFpbi5zaGlmdCgpKTtcbiAgfVxuXG4gIHJldHVybiBwcm9taXNlO1xufTtcblxuLy8gUHJvdmlkZSBhbGlhc2VzIGZvciBzdXBwb3J0ZWQgcmVxdWVzdCBtZXRob2RzXG51dGlscy5mb3JFYWNoKFsnZGVsZXRlJywgJ2dldCcsICdoZWFkJywgJ29wdGlvbnMnXSwgZnVuY3Rpb24gZm9yRWFjaE1ldGhvZE5vRGF0YShtZXRob2QpIHtcbiAgLyplc2xpbnQgZnVuYy1uYW1lczowKi9cbiAgQXhpb3MucHJvdG90eXBlW21ldGhvZF0gPSBmdW5jdGlvbih1cmwsIGNvbmZpZykge1xuICAgIHJldHVybiB0aGlzLnJlcXVlc3QodXRpbHMubWVyZ2UoY29uZmlnIHx8IHt9LCB7XG4gICAgICBtZXRob2Q6IG1ldGhvZCxcbiAgICAgIHVybDogdXJsXG4gICAgfSkpO1xuICB9O1xufSk7XG5cbnV0aWxzLmZvckVhY2goWydwb3N0JywgJ3B1dCcsICdwYXRjaCddLCBmdW5jdGlvbiBmb3JFYWNoTWV0aG9kV2l0aERhdGEobWV0aG9kKSB7XG4gIC8qZXNsaW50IGZ1bmMtbmFtZXM6MCovXG4gIEF4aW9zLnByb3RvdHlwZVttZXRob2RdID0gZnVuY3Rpb24odXJsLCBkYXRhLCBjb25maWcpIHtcbiAgICByZXR1cm4gdGhpcy5yZXF1ZXN0KHV0aWxzLm1lcmdlKGNvbmZpZyB8fCB7fSwge1xuICAgICAgbWV0aG9kOiBtZXRob2QsXG4gICAgICB1cmw6IHVybCxcbiAgICAgIGRhdGE6IGRhdGFcbiAgICB9KSk7XG4gIH07XG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBBeGlvcztcbiIsIid1c2Ugc3RyaWN0JztcblxudmFyIHV0aWxzID0gcmVxdWlyZSgnLi8uLi91dGlscycpO1xuXG5mdW5jdGlvbiBJbnRlcmNlcHRvck1hbmFnZXIoKSB7XG4gIHRoaXMuaGFuZGxlcnMgPSBbXTtcbn1cblxuLyoqXG4gKiBBZGQgYSBuZXcgaW50ZXJjZXB0b3IgdG8gdGhlIHN0YWNrXG4gKlxuICogQHBhcmFtIHtGdW5jdGlvbn0gZnVsZmlsbGVkIFRoZSBmdW5jdGlvbiB0byBoYW5kbGUgYHRoZW5gIGZvciBhIGBQcm9taXNlYFxuICogQHBhcmFtIHtGdW5jdGlvbn0gcmVqZWN0ZWQgVGhlIGZ1bmN0aW9uIHRvIGhhbmRsZSBgcmVqZWN0YCBmb3IgYSBgUHJvbWlzZWBcbiAqXG4gKiBAcmV0dXJuIHtOdW1iZXJ9IEFuIElEIHVzZWQgdG8gcmVtb3ZlIGludGVyY2VwdG9yIGxhdGVyXG4gKi9cbkludGVyY2VwdG9yTWFuYWdlci5wcm90b3R5cGUudXNlID0gZnVuY3Rpb24gdXNlKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpIHtcbiAgdGhpcy5oYW5kbGVycy5wdXNoKHtcbiAgICBmdWxmaWxsZWQ6IGZ1bGZpbGxlZCxcbiAgICByZWplY3RlZDogcmVqZWN0ZWRcbiAgfSk7XG4gIHJldHVybiB0aGlzLmhhbmRsZXJzLmxlbmd0aCAtIDE7XG59O1xuXG4vKipcbiAqIFJlbW92ZSBhbiBpbnRlcmNlcHRvciBmcm9tIHRoZSBzdGFja1xuICpcbiAqIEBwYXJhbSB7TnVtYmVyfSBpZCBUaGUgSUQgdGhhdCB3YXMgcmV0dXJuZWQgYnkgYHVzZWBcbiAqL1xuSW50ZXJjZXB0b3JNYW5hZ2VyLnByb3RvdHlwZS5lamVjdCA9IGZ1bmN0aW9uIGVqZWN0KGlkKSB7XG4gIGlmICh0aGlzLmhhbmRsZXJzW2lkXSkge1xuICAgIHRoaXMuaGFuZGxlcnNbaWRdID0gbnVsbDtcbiAgfVxufTtcblxuLyoqXG4gKiBJdGVyYXRlIG92ZXIgYWxsIHRoZSByZWdpc3RlcmVkIGludGVyY2VwdG9yc1xuICpcbiAqIFRoaXMgbWV0aG9kIGlzIHBhcnRpY3VsYXJseSB1c2VmdWwgZm9yIHNraXBwaW5nIG92ZXIgYW55XG4gKiBpbnRlcmNlcHRvcnMgdGhhdCBtYXkgaGF2ZSBiZWNvbWUgYG51bGxgIGNhbGxpbmcgYGVqZWN0YC5cbiAqXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgZnVuY3Rpb24gdG8gY2FsbCBmb3IgZWFjaCBpbnRlcmNlcHRvclxuICovXG5JbnRlcmNlcHRvck1hbmFnZXIucHJvdG90eXBlLmZvckVhY2ggPSBmdW5jdGlvbiBmb3JFYWNoKGZuKSB7XG4gIHV0aWxzLmZvckVhY2godGhpcy5oYW5kbGVycywgZnVuY3Rpb24gZm9yRWFjaEhhbmRsZXIoaCkge1xuICAgIGlmIChoICE9PSBudWxsKSB7XG4gICAgICBmbihoKTtcbiAgICB9XG4gIH0pO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBJbnRlcmNlcHRvck1hbmFnZXI7XG4iLCIndXNlIHN0cmljdCc7XG5cbnZhciBlbmhhbmNlRXJyb3IgPSByZXF1aXJlKCcuL2VuaGFuY2VFcnJvcicpO1xuXG4vKipcbiAqIENyZWF0ZSBhbiBFcnJvciB3aXRoIHRoZSBzcGVjaWZpZWQgbWVzc2FnZSwgY29uZmlnLCBlcnJvciBjb2RlLCByZXF1ZXN0IGFuZCByZXNwb25zZS5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZSBUaGUgZXJyb3IgbWVzc2FnZS5cbiAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWcgVGhlIGNvbmZpZy5cbiAqIEBwYXJhbSB7c3RyaW5nfSBbY29kZV0gVGhlIGVycm9yIGNvZGUgKGZvciBleGFtcGxlLCAnRUNPTk5BQk9SVEVEJykuXG4gKiBAcGFyYW0ge09iamVjdH0gW3JlcXVlc3RdIFRoZSByZXF1ZXN0LlxuICogQHBhcmFtIHtPYmplY3R9IFtyZXNwb25zZV0gVGhlIHJlc3BvbnNlLlxuICogQHJldHVybnMge0Vycm9yfSBUaGUgY3JlYXRlZCBlcnJvci5cbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBjcmVhdGVFcnJvcihtZXNzYWdlLCBjb25maWcsIGNvZGUsIHJlcXVlc3QsIHJlc3BvbnNlKSB7XG4gIHZhciBlcnJvciA9IG5ldyBFcnJvcihtZXNzYWdlKTtcbiAgcmV0dXJuIGVuaGFuY2VFcnJvcihlcnJvciwgY29uZmlnLCBjb2RlLCByZXF1ZXN0LCByZXNwb25zZSk7XG59O1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgdXRpbHMgPSByZXF1aXJlKCcuLy4uL3V0aWxzJyk7XG52YXIgdHJhbnNmb3JtRGF0YSA9IHJlcXVpcmUoJy4vdHJhbnNmb3JtRGF0YScpO1xudmFyIGlzQ2FuY2VsID0gcmVxdWlyZSgnLi4vY2FuY2VsL2lzQ2FuY2VsJyk7XG52YXIgZGVmYXVsdHMgPSByZXF1aXJlKCcuLi9kZWZhdWx0cycpO1xudmFyIGlzQWJzb2x1dGVVUkwgPSByZXF1aXJlKCcuLy4uL2hlbHBlcnMvaXNBYnNvbHV0ZVVSTCcpO1xudmFyIGNvbWJpbmVVUkxzID0gcmVxdWlyZSgnLi8uLi9oZWxwZXJzL2NvbWJpbmVVUkxzJyk7XG5cbi8qKlxuICogVGhyb3dzIGEgYENhbmNlbGAgaWYgY2FuY2VsbGF0aW9uIGhhcyBiZWVuIHJlcXVlc3RlZC5cbiAqL1xuZnVuY3Rpb24gdGhyb3dJZkNhbmNlbGxhdGlvblJlcXVlc3RlZChjb25maWcpIHtcbiAgaWYgKGNvbmZpZy5jYW5jZWxUb2tlbikge1xuICAgIGNvbmZpZy5jYW5jZWxUb2tlbi50aHJvd0lmUmVxdWVzdGVkKCk7XG4gIH1cbn1cblxuLyoqXG4gKiBEaXNwYXRjaCBhIHJlcXVlc3QgdG8gdGhlIHNlcnZlciB1c2luZyB0aGUgY29uZmlndXJlZCBhZGFwdGVyLlxuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBjb25maWcgVGhlIGNvbmZpZyB0aGF0IGlzIHRvIGJlIHVzZWQgZm9yIHRoZSByZXF1ZXN0XG4gKiBAcmV0dXJucyB7UHJvbWlzZX0gVGhlIFByb21pc2UgdG8gYmUgZnVsZmlsbGVkXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gZGlzcGF0Y2hSZXF1ZXN0KGNvbmZpZykge1xuICB0aHJvd0lmQ2FuY2VsbGF0aW9uUmVxdWVzdGVkKGNvbmZpZyk7XG5cbiAgLy8gU3VwcG9ydCBiYXNlVVJMIGNvbmZpZ1xuICBpZiAoY29uZmlnLmJhc2VVUkwgJiYgIWlzQWJzb2x1dGVVUkwoY29uZmlnLnVybCkpIHtcbiAgICBjb25maWcudXJsID0gY29tYmluZVVSTHMoY29uZmlnLmJhc2VVUkwsIGNvbmZpZy51cmwpO1xuICB9XG5cbiAgLy8gRW5zdXJlIGhlYWRlcnMgZXhpc3RcbiAgY29uZmlnLmhlYWRlcnMgPSBjb25maWcuaGVhZGVycyB8fCB7fTtcblxuICAvLyBUcmFuc2Zvcm0gcmVxdWVzdCBkYXRhXG4gIGNvbmZpZy5kYXRhID0gdHJhbnNmb3JtRGF0YShcbiAgICBjb25maWcuZGF0YSxcbiAgICBjb25maWcuaGVhZGVycyxcbiAgICBjb25maWcudHJhbnNmb3JtUmVxdWVzdFxuICApO1xuXG4gIC8vIEZsYXR0ZW4gaGVhZGVyc1xuICBjb25maWcuaGVhZGVycyA9IHV0aWxzLm1lcmdlKFxuICAgIGNvbmZpZy5oZWFkZXJzLmNvbW1vbiB8fCB7fSxcbiAgICBjb25maWcuaGVhZGVyc1tjb25maWcubWV0aG9kXSB8fCB7fSxcbiAgICBjb25maWcuaGVhZGVycyB8fCB7fVxuICApO1xuXG4gIHV0aWxzLmZvckVhY2goXG4gICAgWydkZWxldGUnLCAnZ2V0JywgJ2hlYWQnLCAncG9zdCcsICdwdXQnLCAncGF0Y2gnLCAnY29tbW9uJ10sXG4gICAgZnVuY3Rpb24gY2xlYW5IZWFkZXJDb25maWcobWV0aG9kKSB7XG4gICAgICBkZWxldGUgY29uZmlnLmhlYWRlcnNbbWV0aG9kXTtcbiAgICB9XG4gICk7XG5cbiAgdmFyIGFkYXB0ZXIgPSBjb25maWcuYWRhcHRlciB8fCBkZWZhdWx0cy5hZGFwdGVyO1xuXG4gIHJldHVybiBhZGFwdGVyKGNvbmZpZykudGhlbihmdW5jdGlvbiBvbkFkYXB0ZXJSZXNvbHV0aW9uKHJlc3BvbnNlKSB7XG4gICAgdGhyb3dJZkNhbmNlbGxhdGlvblJlcXVlc3RlZChjb25maWcpO1xuXG4gICAgLy8gVHJhbnNmb3JtIHJlc3BvbnNlIGRhdGFcbiAgICByZXNwb25zZS5kYXRhID0gdHJhbnNmb3JtRGF0YShcbiAgICAgIHJlc3BvbnNlLmRhdGEsXG4gICAgICByZXNwb25zZS5oZWFkZXJzLFxuICAgICAgY29uZmlnLnRyYW5zZm9ybVJlc3BvbnNlXG4gICAgKTtcblxuICAgIHJldHVybiByZXNwb25zZTtcbiAgfSwgZnVuY3Rpb24gb25BZGFwdGVyUmVqZWN0aW9uKHJlYXNvbikge1xuICAgIGlmICghaXNDYW5jZWwocmVhc29uKSkge1xuICAgICAgdGhyb3dJZkNhbmNlbGxhdGlvblJlcXVlc3RlZChjb25maWcpO1xuXG4gICAgICAvLyBUcmFuc2Zvcm0gcmVzcG9uc2UgZGF0YVxuICAgICAgaWYgKHJlYXNvbiAmJiByZWFzb24ucmVzcG9uc2UpIHtcbiAgICAgICAgcmVhc29uLnJlc3BvbnNlLmRhdGEgPSB0cmFuc2Zvcm1EYXRhKFxuICAgICAgICAgIHJlYXNvbi5yZXNwb25zZS5kYXRhLFxuICAgICAgICAgIHJlYXNvbi5yZXNwb25zZS5oZWFkZXJzLFxuICAgICAgICAgIGNvbmZpZy50cmFuc2Zvcm1SZXNwb25zZVxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChyZWFzb24pO1xuICB9KTtcbn07XG4iLCIndXNlIHN0cmljdCc7XG5cbi8qKlxuICogVXBkYXRlIGFuIEVycm9yIHdpdGggdGhlIHNwZWNpZmllZCBjb25maWcsIGVycm9yIGNvZGUsIGFuZCByZXNwb25zZS5cbiAqXG4gKiBAcGFyYW0ge0Vycm9yfSBlcnJvciBUaGUgZXJyb3IgdG8gdXBkYXRlLlxuICogQHBhcmFtIHtPYmplY3R9IGNvbmZpZyBUaGUgY29uZmlnLlxuICogQHBhcmFtIHtzdHJpbmd9IFtjb2RlXSBUaGUgZXJyb3IgY29kZSAoZm9yIGV4YW1wbGUsICdFQ09OTkFCT1JURUQnKS5cbiAqIEBwYXJhbSB7T2JqZWN0fSBbcmVxdWVzdF0gVGhlIHJlcXVlc3QuXG4gKiBAcGFyYW0ge09iamVjdH0gW3Jlc3BvbnNlXSBUaGUgcmVzcG9uc2UuXG4gKiBAcmV0dXJucyB7RXJyb3J9IFRoZSBlcnJvci5cbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBlbmhhbmNlRXJyb3IoZXJyb3IsIGNvbmZpZywgY29kZSwgcmVxdWVzdCwgcmVzcG9uc2UpIHtcbiAgZXJyb3IuY29uZmlnID0gY29uZmlnO1xuICBpZiAoY29kZSkge1xuICAgIGVycm9yLmNvZGUgPSBjb2RlO1xuICB9XG4gIGVycm9yLnJlcXVlc3QgPSByZXF1ZXN0O1xuICBlcnJvci5yZXNwb25zZSA9IHJlc3BvbnNlO1xuICByZXR1cm4gZXJyb3I7XG59O1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgY3JlYXRlRXJyb3IgPSByZXF1aXJlKCcuL2NyZWF0ZUVycm9yJyk7XG5cbi8qKlxuICogUmVzb2x2ZSBvciByZWplY3QgYSBQcm9taXNlIGJhc2VkIG9uIHJlc3BvbnNlIHN0YXR1cy5cbiAqXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSByZXNvbHZlIEEgZnVuY3Rpb24gdGhhdCByZXNvbHZlcyB0aGUgcHJvbWlzZS5cbiAqIEBwYXJhbSB7RnVuY3Rpb259IHJlamVjdCBBIGZ1bmN0aW9uIHRoYXQgcmVqZWN0cyB0aGUgcHJvbWlzZS5cbiAqIEBwYXJhbSB7b2JqZWN0fSByZXNwb25zZSBUaGUgcmVzcG9uc2UuXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgcmVzcG9uc2UpIHtcbiAgdmFyIHZhbGlkYXRlU3RhdHVzID0gcmVzcG9uc2UuY29uZmlnLnZhbGlkYXRlU3RhdHVzO1xuICAvLyBOb3RlOiBzdGF0dXMgaXMgbm90IGV4cG9zZWQgYnkgWERvbWFpblJlcXVlc3RcbiAgaWYgKCFyZXNwb25zZS5zdGF0dXMgfHwgIXZhbGlkYXRlU3RhdHVzIHx8IHZhbGlkYXRlU3RhdHVzKHJlc3BvbnNlLnN0YXR1cykpIHtcbiAgICByZXNvbHZlKHJlc3BvbnNlKTtcbiAgfSBlbHNlIHtcbiAgICByZWplY3QoY3JlYXRlRXJyb3IoXG4gICAgICAnUmVxdWVzdCBmYWlsZWQgd2l0aCBzdGF0dXMgY29kZSAnICsgcmVzcG9uc2Uuc3RhdHVzLFxuICAgICAgcmVzcG9uc2UuY29uZmlnLFxuICAgICAgbnVsbCxcbiAgICAgIHJlc3BvbnNlLnJlcXVlc3QsXG4gICAgICByZXNwb25zZVxuICAgICkpO1xuICB9XG59O1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgdXRpbHMgPSByZXF1aXJlKCcuLy4uL3V0aWxzJyk7XG5cbi8qKlxuICogVHJhbnNmb3JtIHRoZSBkYXRhIGZvciBhIHJlcXVlc3Qgb3IgYSByZXNwb25zZVxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fFN0cmluZ30gZGF0YSBUaGUgZGF0YSB0byBiZSB0cmFuc2Zvcm1lZFxuICogQHBhcmFtIHtBcnJheX0gaGVhZGVycyBUaGUgaGVhZGVycyBmb3IgdGhlIHJlcXVlc3Qgb3IgcmVzcG9uc2VcbiAqIEBwYXJhbSB7QXJyYXl8RnVuY3Rpb259IGZucyBBIHNpbmdsZSBmdW5jdGlvbiBvciBBcnJheSBvZiBmdW5jdGlvbnNcbiAqIEByZXR1cm5zIHsqfSBUaGUgcmVzdWx0aW5nIHRyYW5zZm9ybWVkIGRhdGFcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiB0cmFuc2Zvcm1EYXRhKGRhdGEsIGhlYWRlcnMsIGZucykge1xuICAvKmVzbGludCBuby1wYXJhbS1yZWFzc2lnbjowKi9cbiAgdXRpbHMuZm9yRWFjaChmbnMsIGZ1bmN0aW9uIHRyYW5zZm9ybShmbikge1xuICAgIGRhdGEgPSBmbihkYXRhLCBoZWFkZXJzKTtcbiAgfSk7XG5cbiAgcmV0dXJuIGRhdGE7XG59O1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgdXRpbHMgPSByZXF1aXJlKCcuL3V0aWxzJyk7XG52YXIgbm9ybWFsaXplSGVhZGVyTmFtZSA9IHJlcXVpcmUoJy4vaGVscGVycy9ub3JtYWxpemVIZWFkZXJOYW1lJyk7XG5cbnZhciBERUZBVUxUX0NPTlRFTlRfVFlQRSA9IHtcbiAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnXG59O1xuXG5mdW5jdGlvbiBzZXRDb250ZW50VHlwZUlmVW5zZXQoaGVhZGVycywgdmFsdWUpIHtcbiAgaWYgKCF1dGlscy5pc1VuZGVmaW5lZChoZWFkZXJzKSAmJiB1dGlscy5pc1VuZGVmaW5lZChoZWFkZXJzWydDb250ZW50LVR5cGUnXSkpIHtcbiAgICBoZWFkZXJzWydDb250ZW50LVR5cGUnXSA9IHZhbHVlO1xuICB9XG59XG5cbmZ1bmN0aW9uIGdldERlZmF1bHRBZGFwdGVyKCkge1xuICB2YXIgYWRhcHRlcjtcbiAgaWYgKHR5cGVvZiBYTUxIdHRwUmVxdWVzdCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAvLyBGb3IgYnJvd3NlcnMgdXNlIFhIUiBhZGFwdGVyXG4gICAgYWRhcHRlciA9IHJlcXVpcmUoJy4vYWRhcHRlcnMveGhyJyk7XG4gIH0gZWxzZSBpZiAodHlwZW9mIHByb2Nlc3MgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgLy8gRm9yIG5vZGUgdXNlIEhUVFAgYWRhcHRlclxuICAgIGFkYXB0ZXIgPSByZXF1aXJlKCcuL2FkYXB0ZXJzL2h0dHAnKTtcbiAgfVxuICByZXR1cm4gYWRhcHRlcjtcbn1cblxudmFyIGRlZmF1bHRzID0ge1xuICBhZGFwdGVyOiBnZXREZWZhdWx0QWRhcHRlcigpLFxuXG4gIHRyYW5zZm9ybVJlcXVlc3Q6IFtmdW5jdGlvbiB0cmFuc2Zvcm1SZXF1ZXN0KGRhdGEsIGhlYWRlcnMpIHtcbiAgICBub3JtYWxpemVIZWFkZXJOYW1lKGhlYWRlcnMsICdDb250ZW50LVR5cGUnKTtcbiAgICBpZiAodXRpbHMuaXNGb3JtRGF0YShkYXRhKSB8fFxuICAgICAgdXRpbHMuaXNBcnJheUJ1ZmZlcihkYXRhKSB8fFxuICAgICAgdXRpbHMuaXNCdWZmZXIoZGF0YSkgfHxcbiAgICAgIHV0aWxzLmlzU3RyZWFtKGRhdGEpIHx8XG4gICAgICB1dGlscy5pc0ZpbGUoZGF0YSkgfHxcbiAgICAgIHV0aWxzLmlzQmxvYihkYXRhKVxuICAgICkge1xuICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfVxuICAgIGlmICh1dGlscy5pc0FycmF5QnVmZmVyVmlldyhkYXRhKSkge1xuICAgICAgcmV0dXJuIGRhdGEuYnVmZmVyO1xuICAgIH1cbiAgICBpZiAodXRpbHMuaXNVUkxTZWFyY2hQYXJhbXMoZGF0YSkpIHtcbiAgICAgIHNldENvbnRlbnRUeXBlSWZVbnNldChoZWFkZXJzLCAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkO2NoYXJzZXQ9dXRmLTgnKTtcbiAgICAgIHJldHVybiBkYXRhLnRvU3RyaW5nKCk7XG4gICAgfVxuICAgIGlmICh1dGlscy5pc09iamVjdChkYXRhKSkge1xuICAgICAgc2V0Q29udGVudFR5cGVJZlVuc2V0KGhlYWRlcnMsICdhcHBsaWNhdGlvbi9qc29uO2NoYXJzZXQ9dXRmLTgnKTtcbiAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShkYXRhKTtcbiAgICB9XG4gICAgcmV0dXJuIGRhdGE7XG4gIH1dLFxuXG4gIHRyYW5zZm9ybVJlc3BvbnNlOiBbZnVuY3Rpb24gdHJhbnNmb3JtUmVzcG9uc2UoZGF0YSkge1xuICAgIC8qZXNsaW50IG5vLXBhcmFtLXJlYXNzaWduOjAqL1xuICAgIGlmICh0eXBlb2YgZGF0YSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGRhdGEgPSBKU09OLnBhcnNlKGRhdGEpO1xuICAgICAgfSBjYXRjaCAoZSkgeyAvKiBJZ25vcmUgKi8gfVxuICAgIH1cbiAgICByZXR1cm4gZGF0YTtcbiAgfV0sXG5cbiAgLyoqXG4gICAqIEEgdGltZW91dCBpbiBtaWxsaXNlY29uZHMgdG8gYWJvcnQgYSByZXF1ZXN0LiBJZiBzZXQgdG8gMCAoZGVmYXVsdCkgYVxuICAgKiB0aW1lb3V0IGlzIG5vdCBjcmVhdGVkLlxuICAgKi9cbiAgdGltZW91dDogMCxcblxuICB4c3JmQ29va2llTmFtZTogJ1hTUkYtVE9LRU4nLFxuICB4c3JmSGVhZGVyTmFtZTogJ1gtWFNSRi1UT0tFTicsXG5cbiAgbWF4Q29udGVudExlbmd0aDogLTEsXG5cbiAgdmFsaWRhdGVTdGF0dXM6IGZ1bmN0aW9uIHZhbGlkYXRlU3RhdHVzKHN0YXR1cykge1xuICAgIHJldHVybiBzdGF0dXMgPj0gMjAwICYmIHN0YXR1cyA8IDMwMDtcbiAgfVxufTtcblxuZGVmYXVsdHMuaGVhZGVycyA9IHtcbiAgY29tbW9uOiB7XG4gICAgJ0FjY2VwdCc6ICdhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L3BsYWluLCAqLyonXG4gIH1cbn07XG5cbnV0aWxzLmZvckVhY2goWydkZWxldGUnLCAnZ2V0JywgJ2hlYWQnXSwgZnVuY3Rpb24gZm9yRWFjaE1ldGhvZE5vRGF0YShtZXRob2QpIHtcbiAgZGVmYXVsdHMuaGVhZGVyc1ttZXRob2RdID0ge307XG59KTtcblxudXRpbHMuZm9yRWFjaChbJ3Bvc3QnLCAncHV0JywgJ3BhdGNoJ10sIGZ1bmN0aW9uIGZvckVhY2hNZXRob2RXaXRoRGF0YShtZXRob2QpIHtcbiAgZGVmYXVsdHMuaGVhZGVyc1ttZXRob2RdID0gdXRpbHMubWVyZ2UoREVGQVVMVF9DT05URU5UX1RZUEUpO1xufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gZGVmYXVsdHM7XG4iLCIndXNlIHN0cmljdCc7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gYmluZChmbiwgdGhpc0FyZykge1xuICByZXR1cm4gZnVuY3Rpb24gd3JhcCgpIHtcbiAgICB2YXIgYXJncyA9IG5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3MubGVuZ3RoOyBpKyspIHtcbiAgICAgIGFyZ3NbaV0gPSBhcmd1bWVudHNbaV07XG4gICAgfVxuICAgIHJldHVybiBmbi5hcHBseSh0aGlzQXJnLCBhcmdzKTtcbiAgfTtcbn07XG4iLCIndXNlIHN0cmljdCc7XG5cbi8vIGJ0b2EgcG9seWZpbGwgZm9yIElFPDEwIGNvdXJ0ZXN5IGh0dHBzOi8vZ2l0aHViLmNvbS9kYXZpZGNoYW1iZXJzL0Jhc2U2NC5qc1xuXG52YXIgY2hhcnMgPSAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLz0nO1xuXG5mdW5jdGlvbiBFKCkge1xuICB0aGlzLm1lc3NhZ2UgPSAnU3RyaW5nIGNvbnRhaW5zIGFuIGludmFsaWQgY2hhcmFjdGVyJztcbn1cbkUucHJvdG90eXBlID0gbmV3IEVycm9yO1xuRS5wcm90b3R5cGUuY29kZSA9IDU7XG5FLnByb3RvdHlwZS5uYW1lID0gJ0ludmFsaWRDaGFyYWN0ZXJFcnJvcic7XG5cbmZ1bmN0aW9uIGJ0b2EoaW5wdXQpIHtcbiAgdmFyIHN0ciA9IFN0cmluZyhpbnB1dCk7XG4gIHZhciBvdXRwdXQgPSAnJztcbiAgZm9yIChcbiAgICAvLyBpbml0aWFsaXplIHJlc3VsdCBhbmQgY291bnRlclxuICAgIHZhciBibG9jaywgY2hhckNvZGUsIGlkeCA9IDAsIG1hcCA9IGNoYXJzO1xuICAgIC8vIGlmIHRoZSBuZXh0IHN0ciBpbmRleCBkb2VzIG5vdCBleGlzdDpcbiAgICAvLyAgIGNoYW5nZSB0aGUgbWFwcGluZyB0YWJsZSB0byBcIj1cIlxuICAgIC8vICAgY2hlY2sgaWYgZCBoYXMgbm8gZnJhY3Rpb25hbCBkaWdpdHNcbiAgICBzdHIuY2hhckF0KGlkeCB8IDApIHx8IChtYXAgPSAnPScsIGlkeCAlIDEpO1xuICAgIC8vIFwiOCAtIGlkeCAlIDEgKiA4XCIgZ2VuZXJhdGVzIHRoZSBzZXF1ZW5jZSAyLCA0LCA2LCA4XG4gICAgb3V0cHV0ICs9IG1hcC5jaGFyQXQoNjMgJiBibG9jayA+PiA4IC0gaWR4ICUgMSAqIDgpXG4gICkge1xuICAgIGNoYXJDb2RlID0gc3RyLmNoYXJDb2RlQXQoaWR4ICs9IDMgLyA0KTtcbiAgICBpZiAoY2hhckNvZGUgPiAweEZGKSB7XG4gICAgICB0aHJvdyBuZXcgRSgpO1xuICAgIH1cbiAgICBibG9jayA9IGJsb2NrIDw8IDggfCBjaGFyQ29kZTtcbiAgfVxuICByZXR1cm4gb3V0cHV0O1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGJ0b2E7XG4iLCIndXNlIHN0cmljdCc7XG5cbnZhciB1dGlscyA9IHJlcXVpcmUoJy4vLi4vdXRpbHMnKTtcblxuZnVuY3Rpb24gZW5jb2RlKHZhbCkge1xuICByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KHZhbCkuXG4gICAgcmVwbGFjZSgvJTQwL2dpLCAnQCcpLlxuICAgIHJlcGxhY2UoLyUzQS9naSwgJzonKS5cbiAgICByZXBsYWNlKC8lMjQvZywgJyQnKS5cbiAgICByZXBsYWNlKC8lMkMvZ2ksICcsJykuXG4gICAgcmVwbGFjZSgvJTIwL2csICcrJykuXG4gICAgcmVwbGFjZSgvJTVCL2dpLCAnWycpLlxuICAgIHJlcGxhY2UoLyU1RC9naSwgJ10nKTtcbn1cblxuLyoqXG4gKiBCdWlsZCBhIFVSTCBieSBhcHBlbmRpbmcgcGFyYW1zIHRvIHRoZSBlbmRcbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsIFRoZSBiYXNlIG9mIHRoZSB1cmwgKGUuZy4sIGh0dHA6Ly93d3cuZ29vZ2xlLmNvbSlcbiAqIEBwYXJhbSB7b2JqZWN0fSBbcGFyYW1zXSBUaGUgcGFyYW1zIHRvIGJlIGFwcGVuZGVkXG4gKiBAcmV0dXJucyB7c3RyaW5nfSBUaGUgZm9ybWF0dGVkIHVybFxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGJ1aWxkVVJMKHVybCwgcGFyYW1zLCBwYXJhbXNTZXJpYWxpemVyKSB7XG4gIC8qZXNsaW50IG5vLXBhcmFtLXJlYXNzaWduOjAqL1xuICBpZiAoIXBhcmFtcykge1xuICAgIHJldHVybiB1cmw7XG4gIH1cblxuICB2YXIgc2VyaWFsaXplZFBhcmFtcztcbiAgaWYgKHBhcmFtc1NlcmlhbGl6ZXIpIHtcbiAgICBzZXJpYWxpemVkUGFyYW1zID0gcGFyYW1zU2VyaWFsaXplcihwYXJhbXMpO1xuICB9IGVsc2UgaWYgKHV0aWxzLmlzVVJMU2VhcmNoUGFyYW1zKHBhcmFtcykpIHtcbiAgICBzZXJpYWxpemVkUGFyYW1zID0gcGFyYW1zLnRvU3RyaW5nKCk7XG4gIH0gZWxzZSB7XG4gICAgdmFyIHBhcnRzID0gW107XG5cbiAgICB1dGlscy5mb3JFYWNoKHBhcmFtcywgZnVuY3Rpb24gc2VyaWFsaXplKHZhbCwga2V5KSB7XG4gICAgICBpZiAodmFsID09PSBudWxsIHx8IHR5cGVvZiB2YWwgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgaWYgKHV0aWxzLmlzQXJyYXkodmFsKSkge1xuICAgICAgICBrZXkgPSBrZXkgKyAnW10nO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFsID0gW3ZhbF07XG4gICAgICB9XG5cbiAgICAgIHV0aWxzLmZvckVhY2godmFsLCBmdW5jdGlvbiBwYXJzZVZhbHVlKHYpIHtcbiAgICAgICAgaWYgKHV0aWxzLmlzRGF0ZSh2KSkge1xuICAgICAgICAgIHYgPSB2LnRvSVNPU3RyaW5nKCk7XG4gICAgICAgIH0gZWxzZSBpZiAodXRpbHMuaXNPYmplY3QodikpIHtcbiAgICAgICAgICB2ID0gSlNPTi5zdHJpbmdpZnkodik7XG4gICAgICAgIH1cbiAgICAgICAgcGFydHMucHVzaChlbmNvZGUoa2V5KSArICc9JyArIGVuY29kZSh2KSk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIHNlcmlhbGl6ZWRQYXJhbXMgPSBwYXJ0cy5qb2luKCcmJyk7XG4gIH1cblxuICBpZiAoc2VyaWFsaXplZFBhcmFtcykge1xuICAgIHVybCArPSAodXJsLmluZGV4T2YoJz8nKSA9PT0gLTEgPyAnPycgOiAnJicpICsgc2VyaWFsaXplZFBhcmFtcztcbiAgfVxuXG4gIHJldHVybiB1cmw7XG59O1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgVVJMIGJ5IGNvbWJpbmluZyB0aGUgc3BlY2lmaWVkIFVSTHNcbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gYmFzZVVSTCBUaGUgYmFzZSBVUkxcbiAqIEBwYXJhbSB7c3RyaW5nfSByZWxhdGl2ZVVSTCBUaGUgcmVsYXRpdmUgVVJMXG4gKiBAcmV0dXJucyB7c3RyaW5nfSBUaGUgY29tYmluZWQgVVJMXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gY29tYmluZVVSTHMoYmFzZVVSTCwgcmVsYXRpdmVVUkwpIHtcbiAgcmV0dXJuIHJlbGF0aXZlVVJMXG4gICAgPyBiYXNlVVJMLnJlcGxhY2UoL1xcLyskLywgJycpICsgJy8nICsgcmVsYXRpdmVVUkwucmVwbGFjZSgvXlxcLysvLCAnJylcbiAgICA6IGJhc2VVUkw7XG59O1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgdXRpbHMgPSByZXF1aXJlKCcuLy4uL3V0aWxzJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gKFxuICB1dGlscy5pc1N0YW5kYXJkQnJvd3NlckVudigpID9cblxuICAvLyBTdGFuZGFyZCBicm93c2VyIGVudnMgc3VwcG9ydCBkb2N1bWVudC5jb29raWVcbiAgKGZ1bmN0aW9uIHN0YW5kYXJkQnJvd3NlckVudigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgd3JpdGU6IGZ1bmN0aW9uIHdyaXRlKG5hbWUsIHZhbHVlLCBleHBpcmVzLCBwYXRoLCBkb21haW4sIHNlY3VyZSkge1xuICAgICAgICB2YXIgY29va2llID0gW107XG4gICAgICAgIGNvb2tpZS5wdXNoKG5hbWUgKyAnPScgKyBlbmNvZGVVUklDb21wb25lbnQodmFsdWUpKTtcblxuICAgICAgICBpZiAodXRpbHMuaXNOdW1iZXIoZXhwaXJlcykpIHtcbiAgICAgICAgICBjb29raWUucHVzaCgnZXhwaXJlcz0nICsgbmV3IERhdGUoZXhwaXJlcykudG9HTVRTdHJpbmcoKSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodXRpbHMuaXNTdHJpbmcocGF0aCkpIHtcbiAgICAgICAgICBjb29raWUucHVzaCgncGF0aD0nICsgcGF0aCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodXRpbHMuaXNTdHJpbmcoZG9tYWluKSkge1xuICAgICAgICAgIGNvb2tpZS5wdXNoKCdkb21haW49JyArIGRvbWFpbik7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoc2VjdXJlID09PSB0cnVlKSB7XG4gICAgICAgICAgY29va2llLnB1c2goJ3NlY3VyZScpO1xuICAgICAgICB9XG5cbiAgICAgICAgZG9jdW1lbnQuY29va2llID0gY29va2llLmpvaW4oJzsgJyk7XG4gICAgICB9LFxuXG4gICAgICByZWFkOiBmdW5jdGlvbiByZWFkKG5hbWUpIHtcbiAgICAgICAgdmFyIG1hdGNoID0gZG9jdW1lbnQuY29va2llLm1hdGNoKG5ldyBSZWdFeHAoJyhefDtcXFxccyopKCcgKyBuYW1lICsgJyk9KFteO10qKScpKTtcbiAgICAgICAgcmV0dXJuIChtYXRjaCA/IGRlY29kZVVSSUNvbXBvbmVudChtYXRjaFszXSkgOiBudWxsKTtcbiAgICAgIH0sXG5cbiAgICAgIHJlbW92ZTogZnVuY3Rpb24gcmVtb3ZlKG5hbWUpIHtcbiAgICAgICAgdGhpcy53cml0ZShuYW1lLCAnJywgRGF0ZS5ub3coKSAtIDg2NDAwMDAwKTtcbiAgICAgIH1cbiAgICB9O1xuICB9KSgpIDpcblxuICAvLyBOb24gc3RhbmRhcmQgYnJvd3NlciBlbnYgKHdlYiB3b3JrZXJzLCByZWFjdC1uYXRpdmUpIGxhY2sgbmVlZGVkIHN1cHBvcnQuXG4gIChmdW5jdGlvbiBub25TdGFuZGFyZEJyb3dzZXJFbnYoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHdyaXRlOiBmdW5jdGlvbiB3cml0ZSgpIHt9LFxuICAgICAgcmVhZDogZnVuY3Rpb24gcmVhZCgpIHsgcmV0dXJuIG51bGw7IH0sXG4gICAgICByZW1vdmU6IGZ1bmN0aW9uIHJlbW92ZSgpIHt9XG4gICAgfTtcbiAgfSkoKVxuKTtcbiIsIid1c2Ugc3RyaWN0JztcblxuLyoqXG4gKiBEZXRlcm1pbmVzIHdoZXRoZXIgdGhlIHNwZWNpZmllZCBVUkwgaXMgYWJzb2x1dGVcbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsIFRoZSBVUkwgdG8gdGVzdFxuICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgdGhlIHNwZWNpZmllZCBVUkwgaXMgYWJzb2x1dGUsIG90aGVyd2lzZSBmYWxzZVxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGlzQWJzb2x1dGVVUkwodXJsKSB7XG4gIC8vIEEgVVJMIGlzIGNvbnNpZGVyZWQgYWJzb2x1dGUgaWYgaXQgYmVnaW5zIHdpdGggXCI8c2NoZW1lPjovL1wiIG9yIFwiLy9cIiAocHJvdG9jb2wtcmVsYXRpdmUgVVJMKS5cbiAgLy8gUkZDIDM5ODYgZGVmaW5lcyBzY2hlbWUgbmFtZSBhcyBhIHNlcXVlbmNlIG9mIGNoYXJhY3RlcnMgYmVnaW5uaW5nIHdpdGggYSBsZXR0ZXIgYW5kIGZvbGxvd2VkXG4gIC8vIGJ5IGFueSBjb21iaW5hdGlvbiBvZiBsZXR0ZXJzLCBkaWdpdHMsIHBsdXMsIHBlcmlvZCwgb3IgaHlwaGVuLlxuICByZXR1cm4gL14oW2Etel1bYS16XFxkXFwrXFwtXFwuXSo6KT9cXC9cXC8vaS50ZXN0KHVybCk7XG59O1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgdXRpbHMgPSByZXF1aXJlKCcuLy4uL3V0aWxzJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gKFxuICB1dGlscy5pc1N0YW5kYXJkQnJvd3NlckVudigpID9cblxuICAvLyBTdGFuZGFyZCBicm93c2VyIGVudnMgaGF2ZSBmdWxsIHN1cHBvcnQgb2YgdGhlIEFQSXMgbmVlZGVkIHRvIHRlc3RcbiAgLy8gd2hldGhlciB0aGUgcmVxdWVzdCBVUkwgaXMgb2YgdGhlIHNhbWUgb3JpZ2luIGFzIGN1cnJlbnQgbG9jYXRpb24uXG4gIChmdW5jdGlvbiBzdGFuZGFyZEJyb3dzZXJFbnYoKSB7XG4gICAgdmFyIG1zaWUgPSAvKG1zaWV8dHJpZGVudCkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpO1xuICAgIHZhciB1cmxQYXJzaW5nTm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcbiAgICB2YXIgb3JpZ2luVVJMO1xuXG4gICAgLyoqXG4gICAgKiBQYXJzZSBhIFVSTCB0byBkaXNjb3ZlciBpdCdzIGNvbXBvbmVudHNcbiAgICAqXG4gICAgKiBAcGFyYW0ge1N0cmluZ30gdXJsIFRoZSBVUkwgdG8gYmUgcGFyc2VkXG4gICAgKiBAcmV0dXJucyB7T2JqZWN0fVxuICAgICovXG4gICAgZnVuY3Rpb24gcmVzb2x2ZVVSTCh1cmwpIHtcbiAgICAgIHZhciBocmVmID0gdXJsO1xuXG4gICAgICBpZiAobXNpZSkge1xuICAgICAgICAvLyBJRSBuZWVkcyBhdHRyaWJ1dGUgc2V0IHR3aWNlIHRvIG5vcm1hbGl6ZSBwcm9wZXJ0aWVzXG4gICAgICAgIHVybFBhcnNpbmdOb2RlLnNldEF0dHJpYnV0ZSgnaHJlZicsIGhyZWYpO1xuICAgICAgICBocmVmID0gdXJsUGFyc2luZ05vZGUuaHJlZjtcbiAgICAgIH1cblxuICAgICAgdXJsUGFyc2luZ05vZGUuc2V0QXR0cmlidXRlKCdocmVmJywgaHJlZik7XG5cbiAgICAgIC8vIHVybFBhcnNpbmdOb2RlIHByb3ZpZGVzIHRoZSBVcmxVdGlscyBpbnRlcmZhY2UgLSBodHRwOi8vdXJsLnNwZWMud2hhdHdnLm9yZy8jdXJsdXRpbHNcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGhyZWY6IHVybFBhcnNpbmdOb2RlLmhyZWYsXG4gICAgICAgIHByb3RvY29sOiB1cmxQYXJzaW5nTm9kZS5wcm90b2NvbCA/IHVybFBhcnNpbmdOb2RlLnByb3RvY29sLnJlcGxhY2UoLzokLywgJycpIDogJycsXG4gICAgICAgIGhvc3Q6IHVybFBhcnNpbmdOb2RlLmhvc3QsXG4gICAgICAgIHNlYXJjaDogdXJsUGFyc2luZ05vZGUuc2VhcmNoID8gdXJsUGFyc2luZ05vZGUuc2VhcmNoLnJlcGxhY2UoL15cXD8vLCAnJykgOiAnJyxcbiAgICAgICAgaGFzaDogdXJsUGFyc2luZ05vZGUuaGFzaCA/IHVybFBhcnNpbmdOb2RlLmhhc2gucmVwbGFjZSgvXiMvLCAnJykgOiAnJyxcbiAgICAgICAgaG9zdG5hbWU6IHVybFBhcnNpbmdOb2RlLmhvc3RuYW1lLFxuICAgICAgICBwb3J0OiB1cmxQYXJzaW5nTm9kZS5wb3J0LFxuICAgICAgICBwYXRobmFtZTogKHVybFBhcnNpbmdOb2RlLnBhdGhuYW1lLmNoYXJBdCgwKSA9PT0gJy8nKSA/XG4gICAgICAgICAgICAgICAgICB1cmxQYXJzaW5nTm9kZS5wYXRobmFtZSA6XG4gICAgICAgICAgICAgICAgICAnLycgKyB1cmxQYXJzaW5nTm9kZS5wYXRobmFtZVxuICAgICAgfTtcbiAgICB9XG5cbiAgICBvcmlnaW5VUkwgPSByZXNvbHZlVVJMKHdpbmRvdy5sb2NhdGlvbi5ocmVmKTtcblxuICAgIC8qKlxuICAgICogRGV0ZXJtaW5lIGlmIGEgVVJMIHNoYXJlcyB0aGUgc2FtZSBvcmlnaW4gYXMgdGhlIGN1cnJlbnQgbG9jYXRpb25cbiAgICAqXG4gICAgKiBAcGFyYW0ge1N0cmluZ30gcmVxdWVzdFVSTCBUaGUgVVJMIHRvIHRlc3RcbiAgICAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIFVSTCBzaGFyZXMgdGhlIHNhbWUgb3JpZ2luLCBvdGhlcndpc2UgZmFsc2VcbiAgICAqL1xuICAgIHJldHVybiBmdW5jdGlvbiBpc1VSTFNhbWVPcmlnaW4ocmVxdWVzdFVSTCkge1xuICAgICAgdmFyIHBhcnNlZCA9ICh1dGlscy5pc1N0cmluZyhyZXF1ZXN0VVJMKSkgPyByZXNvbHZlVVJMKHJlcXVlc3RVUkwpIDogcmVxdWVzdFVSTDtcbiAgICAgIHJldHVybiAocGFyc2VkLnByb3RvY29sID09PSBvcmlnaW5VUkwucHJvdG9jb2wgJiZcbiAgICAgICAgICAgIHBhcnNlZC5ob3N0ID09PSBvcmlnaW5VUkwuaG9zdCk7XG4gICAgfTtcbiAgfSkoKSA6XG5cbiAgLy8gTm9uIHN0YW5kYXJkIGJyb3dzZXIgZW52cyAod2ViIHdvcmtlcnMsIHJlYWN0LW5hdGl2ZSkgbGFjayBuZWVkZWQgc3VwcG9ydC5cbiAgKGZ1bmN0aW9uIG5vblN0YW5kYXJkQnJvd3NlckVudigpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gaXNVUkxTYW1lT3JpZ2luKCkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgfSkoKVxuKTtcbiIsIid1c2Ugc3RyaWN0JztcblxudmFyIHV0aWxzID0gcmVxdWlyZSgnLi4vdXRpbHMnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBub3JtYWxpemVIZWFkZXJOYW1lKGhlYWRlcnMsIG5vcm1hbGl6ZWROYW1lKSB7XG4gIHV0aWxzLmZvckVhY2goaGVhZGVycywgZnVuY3Rpb24gcHJvY2Vzc0hlYWRlcih2YWx1ZSwgbmFtZSkge1xuICAgIGlmIChuYW1lICE9PSBub3JtYWxpemVkTmFtZSAmJiBuYW1lLnRvVXBwZXJDYXNlKCkgPT09IG5vcm1hbGl6ZWROYW1lLnRvVXBwZXJDYXNlKCkpIHtcbiAgICAgIGhlYWRlcnNbbm9ybWFsaXplZE5hbWVdID0gdmFsdWU7XG4gICAgICBkZWxldGUgaGVhZGVyc1tuYW1lXTtcbiAgICB9XG4gIH0pO1xufTtcbiIsIid1c2Ugc3RyaWN0JztcblxudmFyIHV0aWxzID0gcmVxdWlyZSgnLi8uLi91dGlscycpO1xuXG4vLyBIZWFkZXJzIHdob3NlIGR1cGxpY2F0ZXMgYXJlIGlnbm9yZWQgYnkgbm9kZVxuLy8gYy5mLiBodHRwczovL25vZGVqcy5vcmcvYXBpL2h0dHAuaHRtbCNodHRwX21lc3NhZ2VfaGVhZGVyc1xudmFyIGlnbm9yZUR1cGxpY2F0ZU9mID0gW1xuICAnYWdlJywgJ2F1dGhvcml6YXRpb24nLCAnY29udGVudC1sZW5ndGgnLCAnY29udGVudC10eXBlJywgJ2V0YWcnLFxuICAnZXhwaXJlcycsICdmcm9tJywgJ2hvc3QnLCAnaWYtbW9kaWZpZWQtc2luY2UnLCAnaWYtdW5tb2RpZmllZC1zaW5jZScsXG4gICdsYXN0LW1vZGlmaWVkJywgJ2xvY2F0aW9uJywgJ21heC1mb3J3YXJkcycsICdwcm94eS1hdXRob3JpemF0aW9uJyxcbiAgJ3JlZmVyZXInLCAncmV0cnktYWZ0ZXInLCAndXNlci1hZ2VudCdcbl07XG5cbi8qKlxuICogUGFyc2UgaGVhZGVycyBpbnRvIGFuIG9iamVjdFxuICpcbiAqIGBgYFxuICogRGF0ZTogV2VkLCAyNyBBdWcgMjAxNCAwODo1ODo0OSBHTVRcbiAqIENvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vanNvblxuICogQ29ubmVjdGlvbjoga2VlcC1hbGl2ZVxuICogVHJhbnNmZXItRW5jb2Rpbmc6IGNodW5rZWRcbiAqIGBgYFxuICpcbiAqIEBwYXJhbSB7U3RyaW5nfSBoZWFkZXJzIEhlYWRlcnMgbmVlZGluZyB0byBiZSBwYXJzZWRcbiAqIEByZXR1cm5zIHtPYmplY3R9IEhlYWRlcnMgcGFyc2VkIGludG8gYW4gb2JqZWN0XG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gcGFyc2VIZWFkZXJzKGhlYWRlcnMpIHtcbiAgdmFyIHBhcnNlZCA9IHt9O1xuICB2YXIga2V5O1xuICB2YXIgdmFsO1xuICB2YXIgaTtcblxuICBpZiAoIWhlYWRlcnMpIHsgcmV0dXJuIHBhcnNlZDsgfVxuXG4gIHV0aWxzLmZvckVhY2goaGVhZGVycy5zcGxpdCgnXFxuJyksIGZ1bmN0aW9uIHBhcnNlcihsaW5lKSB7XG4gICAgaSA9IGxpbmUuaW5kZXhPZignOicpO1xuICAgIGtleSA9IHV0aWxzLnRyaW0obGluZS5zdWJzdHIoMCwgaSkpLnRvTG93ZXJDYXNlKCk7XG4gICAgdmFsID0gdXRpbHMudHJpbShsaW5lLnN1YnN0cihpICsgMSkpO1xuXG4gICAgaWYgKGtleSkge1xuICAgICAgaWYgKHBhcnNlZFtrZXldICYmIGlnbm9yZUR1cGxpY2F0ZU9mLmluZGV4T2Yoa2V5KSA+PSAwKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmIChrZXkgPT09ICdzZXQtY29va2llJykge1xuICAgICAgICBwYXJzZWRba2V5XSA9IChwYXJzZWRba2V5XSA/IHBhcnNlZFtrZXldIDogW10pLmNvbmNhdChbdmFsXSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwYXJzZWRba2V5XSA9IHBhcnNlZFtrZXldID8gcGFyc2VkW2tleV0gKyAnLCAnICsgdmFsIDogdmFsO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIHBhcnNlZDtcbn07XG4iLCIndXNlIHN0cmljdCc7XG5cbi8qKlxuICogU3ludGFjdGljIHN1Z2FyIGZvciBpbnZva2luZyBhIGZ1bmN0aW9uIGFuZCBleHBhbmRpbmcgYW4gYXJyYXkgZm9yIGFyZ3VtZW50cy5cbiAqXG4gKiBDb21tb24gdXNlIGNhc2Ugd291bGQgYmUgdG8gdXNlIGBGdW5jdGlvbi5wcm90b3R5cGUuYXBwbHlgLlxuICpcbiAqICBgYGBqc1xuICogIGZ1bmN0aW9uIGYoeCwgeSwgeikge31cbiAqICB2YXIgYXJncyA9IFsxLCAyLCAzXTtcbiAqICBmLmFwcGx5KG51bGwsIGFyZ3MpO1xuICogIGBgYFxuICpcbiAqIFdpdGggYHNwcmVhZGAgdGhpcyBleGFtcGxlIGNhbiBiZSByZS13cml0dGVuLlxuICpcbiAqICBgYGBqc1xuICogIHNwcmVhZChmdW5jdGlvbih4LCB5LCB6KSB7fSkoWzEsIDIsIDNdKTtcbiAqICBgYGBcbiAqXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFja1xuICogQHJldHVybnMge0Z1bmN0aW9ufVxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHNwcmVhZChjYWxsYmFjaykge1xuICByZXR1cm4gZnVuY3Rpb24gd3JhcChhcnIpIHtcbiAgICByZXR1cm4gY2FsbGJhY2suYXBwbHkobnVsbCwgYXJyKTtcbiAgfTtcbn07XG4iLCIndXNlIHN0cmljdCc7XG5cbnZhciBiaW5kID0gcmVxdWlyZSgnLi9oZWxwZXJzL2JpbmQnKTtcbnZhciBpc0J1ZmZlciA9IHJlcXVpcmUoJ2lzLWJ1ZmZlcicpO1xuXG4vKmdsb2JhbCB0b1N0cmluZzp0cnVlKi9cblxuLy8gdXRpbHMgaXMgYSBsaWJyYXJ5IG9mIGdlbmVyaWMgaGVscGVyIGZ1bmN0aW9ucyBub24tc3BlY2lmaWMgdG8gYXhpb3NcblxudmFyIHRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZztcblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyBhbiBBcnJheVxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSB2YWwgVGhlIHZhbHVlIHRvIHRlc3RcbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHZhbHVlIGlzIGFuIEFycmF5LCBvdGhlcndpc2UgZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNBcnJheSh2YWwpIHtcbiAgcmV0dXJuIHRvU3RyaW5nLmNhbGwodmFsKSA9PT0gJ1tvYmplY3QgQXJyYXldJztcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyBhbiBBcnJheUJ1ZmZlclxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSB2YWwgVGhlIHZhbHVlIHRvIHRlc3RcbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHZhbHVlIGlzIGFuIEFycmF5QnVmZmVyLCBvdGhlcndpc2UgZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNBcnJheUJ1ZmZlcih2YWwpIHtcbiAgcmV0dXJuIHRvU3RyaW5nLmNhbGwodmFsKSA9PT0gJ1tvYmplY3QgQXJyYXlCdWZmZXJdJztcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyBhIEZvcm1EYXRhXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHZhbCBUaGUgdmFsdWUgdG8gdGVzdFxuICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgdmFsdWUgaXMgYW4gRm9ybURhdGEsIG90aGVyd2lzZSBmYWxzZVxuICovXG5mdW5jdGlvbiBpc0Zvcm1EYXRhKHZhbCkge1xuICByZXR1cm4gKHR5cGVvZiBGb3JtRGF0YSAhPT0gJ3VuZGVmaW5lZCcpICYmICh2YWwgaW5zdGFuY2VvZiBGb3JtRGF0YSk7XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lIGlmIGEgdmFsdWUgaXMgYSB2aWV3IG9uIGFuIEFycmF5QnVmZmVyXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHZhbCBUaGUgdmFsdWUgdG8gdGVzdFxuICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgdmFsdWUgaXMgYSB2aWV3IG9uIGFuIEFycmF5QnVmZmVyLCBvdGhlcndpc2UgZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNBcnJheUJ1ZmZlclZpZXcodmFsKSB7XG4gIHZhciByZXN1bHQ7XG4gIGlmICgodHlwZW9mIEFycmF5QnVmZmVyICE9PSAndW5kZWZpbmVkJykgJiYgKEFycmF5QnVmZmVyLmlzVmlldykpIHtcbiAgICByZXN1bHQgPSBBcnJheUJ1ZmZlci5pc1ZpZXcodmFsKTtcbiAgfSBlbHNlIHtcbiAgICByZXN1bHQgPSAodmFsKSAmJiAodmFsLmJ1ZmZlcikgJiYgKHZhbC5idWZmZXIgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcik7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyBhIFN0cmluZ1xuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSB2YWwgVGhlIHZhbHVlIHRvIHRlc3RcbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHZhbHVlIGlzIGEgU3RyaW5nLCBvdGhlcndpc2UgZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNTdHJpbmcodmFsKSB7XG4gIHJldHVybiB0eXBlb2YgdmFsID09PSAnc3RyaW5nJztcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyBhIE51bWJlclxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSB2YWwgVGhlIHZhbHVlIHRvIHRlc3RcbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHZhbHVlIGlzIGEgTnVtYmVyLCBvdGhlcndpc2UgZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNOdW1iZXIodmFsKSB7XG4gIHJldHVybiB0eXBlb2YgdmFsID09PSAnbnVtYmVyJztcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyB1bmRlZmluZWRcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gdmFsIFRoZSB2YWx1ZSB0byB0ZXN0XG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB0aGUgdmFsdWUgaXMgdW5kZWZpbmVkLCBvdGhlcndpc2UgZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNVbmRlZmluZWQodmFsKSB7XG4gIHJldHVybiB0eXBlb2YgdmFsID09PSAndW5kZWZpbmVkJztcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyBhbiBPYmplY3RcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gdmFsIFRoZSB2YWx1ZSB0byB0ZXN0XG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB2YWx1ZSBpcyBhbiBPYmplY3QsIG90aGVyd2lzZSBmYWxzZVxuICovXG5mdW5jdGlvbiBpc09iamVjdCh2YWwpIHtcbiAgcmV0dXJuIHZhbCAhPT0gbnVsbCAmJiB0eXBlb2YgdmFsID09PSAnb2JqZWN0Jztcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyBhIERhdGVcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gdmFsIFRoZSB2YWx1ZSB0byB0ZXN0XG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB2YWx1ZSBpcyBhIERhdGUsIG90aGVyd2lzZSBmYWxzZVxuICovXG5mdW5jdGlvbiBpc0RhdGUodmFsKSB7XG4gIHJldHVybiB0b1N0cmluZy5jYWxsKHZhbCkgPT09ICdbb2JqZWN0IERhdGVdJztcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyBhIEZpbGVcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gdmFsIFRoZSB2YWx1ZSB0byB0ZXN0XG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB2YWx1ZSBpcyBhIEZpbGUsIG90aGVyd2lzZSBmYWxzZVxuICovXG5mdW5jdGlvbiBpc0ZpbGUodmFsKSB7XG4gIHJldHVybiB0b1N0cmluZy5jYWxsKHZhbCkgPT09ICdbb2JqZWN0IEZpbGVdJztcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyBhIEJsb2JcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gdmFsIFRoZSB2YWx1ZSB0byB0ZXN0XG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB2YWx1ZSBpcyBhIEJsb2IsIG90aGVyd2lzZSBmYWxzZVxuICovXG5mdW5jdGlvbiBpc0Jsb2IodmFsKSB7XG4gIHJldHVybiB0b1N0cmluZy5jYWxsKHZhbCkgPT09ICdbb2JqZWN0IEJsb2JdJztcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyBhIEZ1bmN0aW9uXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHZhbCBUaGUgdmFsdWUgdG8gdGVzdFxuICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgdmFsdWUgaXMgYSBGdW5jdGlvbiwgb3RoZXJ3aXNlIGZhbHNlXG4gKi9cbmZ1bmN0aW9uIGlzRnVuY3Rpb24odmFsKSB7XG4gIHJldHVybiB0b1N0cmluZy5jYWxsKHZhbCkgPT09ICdbb2JqZWN0IEZ1bmN0aW9uXSc7XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lIGlmIGEgdmFsdWUgaXMgYSBTdHJlYW1cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gdmFsIFRoZSB2YWx1ZSB0byB0ZXN0XG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB2YWx1ZSBpcyBhIFN0cmVhbSwgb3RoZXJ3aXNlIGZhbHNlXG4gKi9cbmZ1bmN0aW9uIGlzU3RyZWFtKHZhbCkge1xuICByZXR1cm4gaXNPYmplY3QodmFsKSAmJiBpc0Z1bmN0aW9uKHZhbC5waXBlKTtcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyBhIFVSTFNlYXJjaFBhcmFtcyBvYmplY3RcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gdmFsIFRoZSB2YWx1ZSB0byB0ZXN0XG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB2YWx1ZSBpcyBhIFVSTFNlYXJjaFBhcmFtcyBvYmplY3QsIG90aGVyd2lzZSBmYWxzZVxuICovXG5mdW5jdGlvbiBpc1VSTFNlYXJjaFBhcmFtcyh2YWwpIHtcbiAgcmV0dXJuIHR5cGVvZiBVUkxTZWFyY2hQYXJhbXMgIT09ICd1bmRlZmluZWQnICYmIHZhbCBpbnN0YW5jZW9mIFVSTFNlYXJjaFBhcmFtcztcbn1cblxuLyoqXG4gKiBUcmltIGV4Y2VzcyB3aGl0ZXNwYWNlIG9mZiB0aGUgYmVnaW5uaW5nIGFuZCBlbmQgb2YgYSBzdHJpbmdcbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gc3RyIFRoZSBTdHJpbmcgdG8gdHJpbVxuICogQHJldHVybnMge1N0cmluZ30gVGhlIFN0cmluZyBmcmVlZCBvZiBleGNlc3Mgd2hpdGVzcGFjZVxuICovXG5mdW5jdGlvbiB0cmltKHN0cikge1xuICByZXR1cm4gc3RyLnJlcGxhY2UoL15cXHMqLywgJycpLnJlcGxhY2UoL1xccyokLywgJycpO1xufVxuXG4vKipcbiAqIERldGVybWluZSBpZiB3ZSdyZSBydW5uaW5nIGluIGEgc3RhbmRhcmQgYnJvd3NlciBlbnZpcm9ubWVudFxuICpcbiAqIFRoaXMgYWxsb3dzIGF4aW9zIHRvIHJ1biBpbiBhIHdlYiB3b3JrZXIsIGFuZCByZWFjdC1uYXRpdmUuXG4gKiBCb3RoIGVudmlyb25tZW50cyBzdXBwb3J0IFhNTEh0dHBSZXF1ZXN0LCBidXQgbm90IGZ1bGx5IHN0YW5kYXJkIGdsb2JhbHMuXG4gKlxuICogd2ViIHdvcmtlcnM6XG4gKiAgdHlwZW9mIHdpbmRvdyAtPiB1bmRlZmluZWRcbiAqICB0eXBlb2YgZG9jdW1lbnQgLT4gdW5kZWZpbmVkXG4gKlxuICogcmVhY3QtbmF0aXZlOlxuICogIG5hdmlnYXRvci5wcm9kdWN0IC0+ICdSZWFjdE5hdGl2ZSdcbiAqL1xuZnVuY3Rpb24gaXNTdGFuZGFyZEJyb3dzZXJFbnYoKSB7XG4gIGlmICh0eXBlb2YgbmF2aWdhdG9yICE9PSAndW5kZWZpbmVkJyAmJiBuYXZpZ2F0b3IucHJvZHVjdCA9PT0gJ1JlYWN0TmF0aXZlJykge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICByZXR1cm4gKFxuICAgIHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmXG4gICAgdHlwZW9mIGRvY3VtZW50ICE9PSAndW5kZWZpbmVkJ1xuICApO1xufVxuXG4vKipcbiAqIEl0ZXJhdGUgb3ZlciBhbiBBcnJheSBvciBhbiBPYmplY3QgaW52b2tpbmcgYSBmdW5jdGlvbiBmb3IgZWFjaCBpdGVtLlxuICpcbiAqIElmIGBvYmpgIGlzIGFuIEFycmF5IGNhbGxiYWNrIHdpbGwgYmUgY2FsbGVkIHBhc3NpbmdcbiAqIHRoZSB2YWx1ZSwgaW5kZXgsIGFuZCBjb21wbGV0ZSBhcnJheSBmb3IgZWFjaCBpdGVtLlxuICpcbiAqIElmICdvYmonIGlzIGFuIE9iamVjdCBjYWxsYmFjayB3aWxsIGJlIGNhbGxlZCBwYXNzaW5nXG4gKiB0aGUgdmFsdWUsIGtleSwgYW5kIGNvbXBsZXRlIG9iamVjdCBmb3IgZWFjaCBwcm9wZXJ0eS5cbiAqXG4gKiBAcGFyYW0ge09iamVjdHxBcnJheX0gb2JqIFRoZSBvYmplY3QgdG8gaXRlcmF0ZVxuICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGNhbGxiYWNrIHRvIGludm9rZSBmb3IgZWFjaCBpdGVtXG4gKi9cbmZ1bmN0aW9uIGZvckVhY2gob2JqLCBmbikge1xuICAvLyBEb24ndCBib3RoZXIgaWYgbm8gdmFsdWUgcHJvdmlkZWRcbiAgaWYgKG9iaiA9PT0gbnVsbCB8fCB0eXBlb2Ygb2JqID09PSAndW5kZWZpbmVkJykge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIC8vIEZvcmNlIGFuIGFycmF5IGlmIG5vdCBhbHJlYWR5IHNvbWV0aGluZyBpdGVyYWJsZVxuICBpZiAodHlwZW9mIG9iaiAhPT0gJ29iamVjdCcpIHtcbiAgICAvKmVzbGludCBuby1wYXJhbS1yZWFzc2lnbjowKi9cbiAgICBvYmogPSBbb2JqXTtcbiAgfVxuXG4gIGlmIChpc0FycmF5KG9iaikpIHtcbiAgICAvLyBJdGVyYXRlIG92ZXIgYXJyYXkgdmFsdWVzXG4gICAgZm9yICh2YXIgaSA9IDAsIGwgPSBvYmoubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICBmbi5jYWxsKG51bGwsIG9ialtpXSwgaSwgb2JqKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgLy8gSXRlcmF0ZSBvdmVyIG9iamVjdCBrZXlzXG4gICAgZm9yICh2YXIga2V5IGluIG9iaikge1xuICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHtcbiAgICAgICAgZm4uY2FsbChudWxsLCBvYmpba2V5XSwga2V5LCBvYmopO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIEFjY2VwdHMgdmFyYXJncyBleHBlY3RpbmcgZWFjaCBhcmd1bWVudCB0byBiZSBhbiBvYmplY3QsIHRoZW5cbiAqIGltbXV0YWJseSBtZXJnZXMgdGhlIHByb3BlcnRpZXMgb2YgZWFjaCBvYmplY3QgYW5kIHJldHVybnMgcmVzdWx0LlxuICpcbiAqIFdoZW4gbXVsdGlwbGUgb2JqZWN0cyBjb250YWluIHRoZSBzYW1lIGtleSB0aGUgbGF0ZXIgb2JqZWN0IGluXG4gKiB0aGUgYXJndW1lbnRzIGxpc3Qgd2lsbCB0YWtlIHByZWNlZGVuY2UuXG4gKlxuICogRXhhbXBsZTpcbiAqXG4gKiBgYGBqc1xuICogdmFyIHJlc3VsdCA9IG1lcmdlKHtmb286IDEyM30sIHtmb286IDQ1Nn0pO1xuICogY29uc29sZS5sb2cocmVzdWx0LmZvbyk7IC8vIG91dHB1dHMgNDU2XG4gKiBgYGBcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gb2JqMSBPYmplY3QgdG8gbWVyZ2VcbiAqIEByZXR1cm5zIHtPYmplY3R9IFJlc3VsdCBvZiBhbGwgbWVyZ2UgcHJvcGVydGllc1xuICovXG5mdW5jdGlvbiBtZXJnZSgvKiBvYmoxLCBvYmoyLCBvYmozLCAuLi4gKi8pIHtcbiAgdmFyIHJlc3VsdCA9IHt9O1xuICBmdW5jdGlvbiBhc3NpZ25WYWx1ZSh2YWwsIGtleSkge1xuICAgIGlmICh0eXBlb2YgcmVzdWx0W2tleV0gPT09ICdvYmplY3QnICYmIHR5cGVvZiB2YWwgPT09ICdvYmplY3QnKSB7XG4gICAgICByZXN1bHRba2V5XSA9IG1lcmdlKHJlc3VsdFtrZXldLCB2YWwpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXN1bHRba2V5XSA9IHZhbDtcbiAgICB9XG4gIH1cblxuICBmb3IgKHZhciBpID0gMCwgbCA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICBmb3JFYWNoKGFyZ3VtZW50c1tpXSwgYXNzaWduVmFsdWUpO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59XG5cbi8qKlxuICogRXh0ZW5kcyBvYmplY3QgYSBieSBtdXRhYmx5IGFkZGluZyB0byBpdCB0aGUgcHJvcGVydGllcyBvZiBvYmplY3QgYi5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gYSBUaGUgb2JqZWN0IHRvIGJlIGV4dGVuZGVkXG4gKiBAcGFyYW0ge09iamVjdH0gYiBUaGUgb2JqZWN0IHRvIGNvcHkgcHJvcGVydGllcyBmcm9tXG4gKiBAcGFyYW0ge09iamVjdH0gdGhpc0FyZyBUaGUgb2JqZWN0IHRvIGJpbmQgZnVuY3Rpb24gdG9cbiAqIEByZXR1cm4ge09iamVjdH0gVGhlIHJlc3VsdGluZyB2YWx1ZSBvZiBvYmplY3QgYVxuICovXG5mdW5jdGlvbiBleHRlbmQoYSwgYiwgdGhpc0FyZykge1xuICBmb3JFYWNoKGIsIGZ1bmN0aW9uIGFzc2lnblZhbHVlKHZhbCwga2V5KSB7XG4gICAgaWYgKHRoaXNBcmcgJiYgdHlwZW9mIHZhbCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgYVtrZXldID0gYmluZCh2YWwsIHRoaXNBcmcpO1xuICAgIH0gZWxzZSB7XG4gICAgICBhW2tleV0gPSB2YWw7XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIGE7XG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBpc0FycmF5OiBpc0FycmF5LFxuICBpc0FycmF5QnVmZmVyOiBpc0FycmF5QnVmZmVyLFxuICBpc0J1ZmZlcjogaXNCdWZmZXIsXG4gIGlzRm9ybURhdGE6IGlzRm9ybURhdGEsXG4gIGlzQXJyYXlCdWZmZXJWaWV3OiBpc0FycmF5QnVmZmVyVmlldyxcbiAgaXNTdHJpbmc6IGlzU3RyaW5nLFxuICBpc051bWJlcjogaXNOdW1iZXIsXG4gIGlzT2JqZWN0OiBpc09iamVjdCxcbiAgaXNVbmRlZmluZWQ6IGlzVW5kZWZpbmVkLFxuICBpc0RhdGU6IGlzRGF0ZSxcbiAgaXNGaWxlOiBpc0ZpbGUsXG4gIGlzQmxvYjogaXNCbG9iLFxuICBpc0Z1bmN0aW9uOiBpc0Z1bmN0aW9uLFxuICBpc1N0cmVhbTogaXNTdHJlYW0sXG4gIGlzVVJMU2VhcmNoUGFyYW1zOiBpc1VSTFNlYXJjaFBhcmFtcyxcbiAgaXNTdGFuZGFyZEJyb3dzZXJFbnY6IGlzU3RhbmRhcmRCcm93c2VyRW52LFxuICBmb3JFYWNoOiBmb3JFYWNoLFxuICBtZXJnZTogbWVyZ2UsXG4gIGV4dGVuZDogZXh0ZW5kLFxuICB0cmltOiB0cmltXG59O1xuIiwiLy8gQ29weXJpZ2h0IEpveWVudCwgSW5jLiBhbmQgb3RoZXIgTm9kZSBjb250cmlidXRvcnMuXG4vL1xuLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGFcbi8vIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGVcbi8vIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZ1xuLy8gd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLFxuLy8gZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdFxuLy8gcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlXG4vLyBmb2xsb3dpbmcgY29uZGl0aW9uczpcbi8vXG4vLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZFxuLy8gaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4vL1xuLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTU1xuLy8gT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRlxuLy8gTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTlxuLy8gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sXG4vLyBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1Jcbi8vIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEVcbi8vIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuXG5cbmZ1bmN0aW9uIEV2ZW50RW1pdHRlcigpIHtcbiAgdGhpcy5fZXZlbnRzID0gdGhpcy5fZXZlbnRzIHx8IHt9O1xuICB0aGlzLl9tYXhMaXN0ZW5lcnMgPSB0aGlzLl9tYXhMaXN0ZW5lcnMgfHwgdW5kZWZpbmVkO1xufVxubW9kdWxlLmV4cG9ydHMgPSBFdmVudEVtaXR0ZXI7XG5cbi8vIEJhY2t3YXJkcy1jb21wYXQgd2l0aCBub2RlIDAuMTAueFxuRXZlbnRFbWl0dGVyLkV2ZW50RW1pdHRlciA9IEV2ZW50RW1pdHRlcjtcblxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5fZXZlbnRzID0gdW5kZWZpbmVkO1xuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5fbWF4TGlzdGVuZXJzID0gdW5kZWZpbmVkO1xuXG4vLyBCeSBkZWZhdWx0IEV2ZW50RW1pdHRlcnMgd2lsbCBwcmludCBhIHdhcm5pbmcgaWYgbW9yZSB0aGFuIDEwIGxpc3RlbmVycyBhcmVcbi8vIGFkZGVkIHRvIGl0LiBUaGlzIGlzIGEgdXNlZnVsIGRlZmF1bHQgd2hpY2ggaGVscHMgZmluZGluZyBtZW1vcnkgbGVha3MuXG5FdmVudEVtaXR0ZXIuZGVmYXVsdE1heExpc3RlbmVycyA9IDEwO1xuXG4vLyBPYnZpb3VzbHkgbm90IGFsbCBFbWl0dGVycyBzaG91bGQgYmUgbGltaXRlZCB0byAxMC4gVGhpcyBmdW5jdGlvbiBhbGxvd3Ncbi8vIHRoYXQgdG8gYmUgaW5jcmVhc2VkLiBTZXQgdG8gemVybyBmb3IgdW5saW1pdGVkLlxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5zZXRNYXhMaXN0ZW5lcnMgPSBmdW5jdGlvbihuKSB7XG4gIGlmICghaXNOdW1iZXIobikgfHwgbiA8IDAgfHwgaXNOYU4obikpXG4gICAgdGhyb3cgVHlwZUVycm9yKCduIG11c3QgYmUgYSBwb3NpdGl2ZSBudW1iZXInKTtcbiAgdGhpcy5fbWF4TGlzdGVuZXJzID0gbjtcbiAgcmV0dXJuIHRoaXM7XG59O1xuXG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLmVtaXQgPSBmdW5jdGlvbih0eXBlKSB7XG4gIHZhciBlciwgaGFuZGxlciwgbGVuLCBhcmdzLCBpLCBsaXN0ZW5lcnM7XG5cbiAgaWYgKCF0aGlzLl9ldmVudHMpXG4gICAgdGhpcy5fZXZlbnRzID0ge307XG5cbiAgLy8gSWYgdGhlcmUgaXMgbm8gJ2Vycm9yJyBldmVudCBsaXN0ZW5lciB0aGVuIHRocm93LlxuICBpZiAodHlwZSA9PT0gJ2Vycm9yJykge1xuICAgIGlmICghdGhpcy5fZXZlbnRzLmVycm9yIHx8XG4gICAgICAgIChpc09iamVjdCh0aGlzLl9ldmVudHMuZXJyb3IpICYmICF0aGlzLl9ldmVudHMuZXJyb3IubGVuZ3RoKSkge1xuICAgICAgZXIgPSBhcmd1bWVudHNbMV07XG4gICAgICBpZiAoZXIgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgICB0aHJvdyBlcjsgLy8gVW5oYW5kbGVkICdlcnJvcicgZXZlbnRcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIEF0IGxlYXN0IGdpdmUgc29tZSBraW5kIG9mIGNvbnRleHQgdG8gdGhlIHVzZXJcbiAgICAgICAgdmFyIGVyciA9IG5ldyBFcnJvcignVW5jYXVnaHQsIHVuc3BlY2lmaWVkIFwiZXJyb3JcIiBldmVudC4gKCcgKyBlciArICcpJyk7XG4gICAgICAgIGVyci5jb250ZXh0ID0gZXI7XG4gICAgICAgIHRocm93IGVycjtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBoYW5kbGVyID0gdGhpcy5fZXZlbnRzW3R5cGVdO1xuXG4gIGlmIChpc1VuZGVmaW5lZChoYW5kbGVyKSlcbiAgICByZXR1cm4gZmFsc2U7XG5cbiAgaWYgKGlzRnVuY3Rpb24oaGFuZGxlcikpIHtcbiAgICBzd2l0Y2ggKGFyZ3VtZW50cy5sZW5ndGgpIHtcbiAgICAgIC8vIGZhc3QgY2FzZXNcbiAgICAgIGNhc2UgMTpcbiAgICAgICAgaGFuZGxlci5jYWxsKHRoaXMpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgMjpcbiAgICAgICAgaGFuZGxlci5jYWxsKHRoaXMsIGFyZ3VtZW50c1sxXSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAzOlxuICAgICAgICBoYW5kbGVyLmNhbGwodGhpcywgYXJndW1lbnRzWzFdLCBhcmd1bWVudHNbMl0pO1xuICAgICAgICBicmVhaztcbiAgICAgIC8vIHNsb3dlclxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7XG4gICAgICAgIGhhbmRsZXIuYXBwbHkodGhpcywgYXJncyk7XG4gICAgfVxuICB9IGVsc2UgaWYgKGlzT2JqZWN0KGhhbmRsZXIpKSB7XG4gICAgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7XG4gICAgbGlzdGVuZXJzID0gaGFuZGxlci5zbGljZSgpO1xuICAgIGxlbiA9IGxpc3RlbmVycy5sZW5ndGg7XG4gICAgZm9yIChpID0gMDsgaSA8IGxlbjsgaSsrKVxuICAgICAgbGlzdGVuZXJzW2ldLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICB9XG5cbiAgcmV0dXJuIHRydWU7XG59O1xuXG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLmFkZExpc3RlbmVyID0gZnVuY3Rpb24odHlwZSwgbGlzdGVuZXIpIHtcbiAgdmFyIG07XG5cbiAgaWYgKCFpc0Z1bmN0aW9uKGxpc3RlbmVyKSlcbiAgICB0aHJvdyBUeXBlRXJyb3IoJ2xpc3RlbmVyIG11c3QgYmUgYSBmdW5jdGlvbicpO1xuXG4gIGlmICghdGhpcy5fZXZlbnRzKVxuICAgIHRoaXMuX2V2ZW50cyA9IHt9O1xuXG4gIC8vIFRvIGF2b2lkIHJlY3Vyc2lvbiBpbiB0aGUgY2FzZSB0aGF0IHR5cGUgPT09IFwibmV3TGlzdGVuZXJcIiEgQmVmb3JlXG4gIC8vIGFkZGluZyBpdCB0byB0aGUgbGlzdGVuZXJzLCBmaXJzdCBlbWl0IFwibmV3TGlzdGVuZXJcIi5cbiAgaWYgKHRoaXMuX2V2ZW50cy5uZXdMaXN0ZW5lcilcbiAgICB0aGlzLmVtaXQoJ25ld0xpc3RlbmVyJywgdHlwZSxcbiAgICAgICAgICAgICAgaXNGdW5jdGlvbihsaXN0ZW5lci5saXN0ZW5lcikgP1xuICAgICAgICAgICAgICBsaXN0ZW5lci5saXN0ZW5lciA6IGxpc3RlbmVyKTtcblxuICBpZiAoIXRoaXMuX2V2ZW50c1t0eXBlXSlcbiAgICAvLyBPcHRpbWl6ZSB0aGUgY2FzZSBvZiBvbmUgbGlzdGVuZXIuIERvbid0IG5lZWQgdGhlIGV4dHJhIGFycmF5IG9iamVjdC5cbiAgICB0aGlzLl9ldmVudHNbdHlwZV0gPSBsaXN0ZW5lcjtcbiAgZWxzZSBpZiAoaXNPYmplY3QodGhpcy5fZXZlbnRzW3R5cGVdKSlcbiAgICAvLyBJZiB3ZSd2ZSBhbHJlYWR5IGdvdCBhbiBhcnJheSwganVzdCBhcHBlbmQuXG4gICAgdGhpcy5fZXZlbnRzW3R5cGVdLnB1c2gobGlzdGVuZXIpO1xuICBlbHNlXG4gICAgLy8gQWRkaW5nIHRoZSBzZWNvbmQgZWxlbWVudCwgbmVlZCB0byBjaGFuZ2UgdG8gYXJyYXkuXG4gICAgdGhpcy5fZXZlbnRzW3R5cGVdID0gW3RoaXMuX2V2ZW50c1t0eXBlXSwgbGlzdGVuZXJdO1xuXG4gIC8vIENoZWNrIGZvciBsaXN0ZW5lciBsZWFrXG4gIGlmIChpc09iamVjdCh0aGlzLl9ldmVudHNbdHlwZV0pICYmICF0aGlzLl9ldmVudHNbdHlwZV0ud2FybmVkKSB7XG4gICAgaWYgKCFpc1VuZGVmaW5lZCh0aGlzLl9tYXhMaXN0ZW5lcnMpKSB7XG4gICAgICBtID0gdGhpcy5fbWF4TGlzdGVuZXJzO1xuICAgIH0gZWxzZSB7XG4gICAgICBtID0gRXZlbnRFbWl0dGVyLmRlZmF1bHRNYXhMaXN0ZW5lcnM7XG4gICAgfVxuXG4gICAgaWYgKG0gJiYgbSA+IDAgJiYgdGhpcy5fZXZlbnRzW3R5cGVdLmxlbmd0aCA+IG0pIHtcbiAgICAgIHRoaXMuX2V2ZW50c1t0eXBlXS53YXJuZWQgPSB0cnVlO1xuICAgICAgY29uc29sZS5lcnJvcignKG5vZGUpIHdhcm5pbmc6IHBvc3NpYmxlIEV2ZW50RW1pdHRlciBtZW1vcnkgJyArXG4gICAgICAgICAgICAgICAgICAgICdsZWFrIGRldGVjdGVkLiAlZCBsaXN0ZW5lcnMgYWRkZWQuICcgK1xuICAgICAgICAgICAgICAgICAgICAnVXNlIGVtaXR0ZXIuc2V0TWF4TGlzdGVuZXJzKCkgdG8gaW5jcmVhc2UgbGltaXQuJyxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZXZlbnRzW3R5cGVdLmxlbmd0aCk7XG4gICAgICBpZiAodHlwZW9mIGNvbnNvbGUudHJhY2UgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgLy8gbm90IHN1cHBvcnRlZCBpbiBJRSAxMFxuICAgICAgICBjb25zb2xlLnRyYWNlKCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHRoaXM7XG59O1xuXG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLm9uID0gRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5hZGRMaXN0ZW5lcjtcblxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5vbmNlID0gZnVuY3Rpb24odHlwZSwgbGlzdGVuZXIpIHtcbiAgaWYgKCFpc0Z1bmN0aW9uKGxpc3RlbmVyKSlcbiAgICB0aHJvdyBUeXBlRXJyb3IoJ2xpc3RlbmVyIG11c3QgYmUgYSBmdW5jdGlvbicpO1xuXG4gIHZhciBmaXJlZCA9IGZhbHNlO1xuXG4gIGZ1bmN0aW9uIGcoKSB7XG4gICAgdGhpcy5yZW1vdmVMaXN0ZW5lcih0eXBlLCBnKTtcblxuICAgIGlmICghZmlyZWQpIHtcbiAgICAgIGZpcmVkID0gdHJ1ZTtcbiAgICAgIGxpc3RlbmVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfVxuICB9XG5cbiAgZy5saXN0ZW5lciA9IGxpc3RlbmVyO1xuICB0aGlzLm9uKHR5cGUsIGcpO1xuXG4gIHJldHVybiB0aGlzO1xufTtcblxuLy8gZW1pdHMgYSAncmVtb3ZlTGlzdGVuZXInIGV2ZW50IGlmZiB0aGUgbGlzdGVuZXIgd2FzIHJlbW92ZWRcbkV2ZW50RW1pdHRlci5wcm90b3R5cGUucmVtb3ZlTGlzdGVuZXIgPSBmdW5jdGlvbih0eXBlLCBsaXN0ZW5lcikge1xuICB2YXIgbGlzdCwgcG9zaXRpb24sIGxlbmd0aCwgaTtcblxuICBpZiAoIWlzRnVuY3Rpb24obGlzdGVuZXIpKVxuICAgIHRocm93IFR5cGVFcnJvcignbGlzdGVuZXIgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7XG5cbiAgaWYgKCF0aGlzLl9ldmVudHMgfHwgIXRoaXMuX2V2ZW50c1t0eXBlXSlcbiAgICByZXR1cm4gdGhpcztcblxuICBsaXN0ID0gdGhpcy5fZXZlbnRzW3R5cGVdO1xuICBsZW5ndGggPSBsaXN0Lmxlbmd0aDtcbiAgcG9zaXRpb24gPSAtMTtcblxuICBpZiAobGlzdCA9PT0gbGlzdGVuZXIgfHxcbiAgICAgIChpc0Z1bmN0aW9uKGxpc3QubGlzdGVuZXIpICYmIGxpc3QubGlzdGVuZXIgPT09IGxpc3RlbmVyKSkge1xuICAgIGRlbGV0ZSB0aGlzLl9ldmVudHNbdHlwZV07XG4gICAgaWYgKHRoaXMuX2V2ZW50cy5yZW1vdmVMaXN0ZW5lcilcbiAgICAgIHRoaXMuZW1pdCgncmVtb3ZlTGlzdGVuZXInLCB0eXBlLCBsaXN0ZW5lcik7XG5cbiAgfSBlbHNlIGlmIChpc09iamVjdChsaXN0KSkge1xuICAgIGZvciAoaSA9IGxlbmd0aDsgaS0tID4gMDspIHtcbiAgICAgIGlmIChsaXN0W2ldID09PSBsaXN0ZW5lciB8fFxuICAgICAgICAgIChsaXN0W2ldLmxpc3RlbmVyICYmIGxpc3RbaV0ubGlzdGVuZXIgPT09IGxpc3RlbmVyKSkge1xuICAgICAgICBwb3NpdGlvbiA9IGk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChwb3NpdGlvbiA8IDApXG4gICAgICByZXR1cm4gdGhpcztcblxuICAgIGlmIChsaXN0Lmxlbmd0aCA9PT0gMSkge1xuICAgICAgbGlzdC5sZW5ndGggPSAwO1xuICAgICAgZGVsZXRlIHRoaXMuX2V2ZW50c1t0eXBlXTtcbiAgICB9IGVsc2Uge1xuICAgICAgbGlzdC5zcGxpY2UocG9zaXRpb24sIDEpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLl9ldmVudHMucmVtb3ZlTGlzdGVuZXIpXG4gICAgICB0aGlzLmVtaXQoJ3JlbW92ZUxpc3RlbmVyJywgdHlwZSwgbGlzdGVuZXIpO1xuICB9XG5cbiAgcmV0dXJuIHRoaXM7XG59O1xuXG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLnJlbW92ZUFsbExpc3RlbmVycyA9IGZ1bmN0aW9uKHR5cGUpIHtcbiAgdmFyIGtleSwgbGlzdGVuZXJzO1xuXG4gIGlmICghdGhpcy5fZXZlbnRzKVxuICAgIHJldHVybiB0aGlzO1xuXG4gIC8vIG5vdCBsaXN0ZW5pbmcgZm9yIHJlbW92ZUxpc3RlbmVyLCBubyBuZWVkIHRvIGVtaXRcbiAgaWYgKCF0aGlzLl9ldmVudHMucmVtb3ZlTGlzdGVuZXIpIHtcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMClcbiAgICAgIHRoaXMuX2V2ZW50cyA9IHt9O1xuICAgIGVsc2UgaWYgKHRoaXMuX2V2ZW50c1t0eXBlXSlcbiAgICAgIGRlbGV0ZSB0aGlzLl9ldmVudHNbdHlwZV07XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvLyBlbWl0IHJlbW92ZUxpc3RlbmVyIGZvciBhbGwgbGlzdGVuZXJzIG9uIGFsbCBldmVudHNcbiAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApIHtcbiAgICBmb3IgKGtleSBpbiB0aGlzLl9ldmVudHMpIHtcbiAgICAgIGlmIChrZXkgPT09ICdyZW1vdmVMaXN0ZW5lcicpIGNvbnRpbnVlO1xuICAgICAgdGhpcy5yZW1vdmVBbGxMaXN0ZW5lcnMoa2V5KTtcbiAgICB9XG4gICAgdGhpcy5yZW1vdmVBbGxMaXN0ZW5lcnMoJ3JlbW92ZUxpc3RlbmVyJyk7XG4gICAgdGhpcy5fZXZlbnRzID0ge307XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICBsaXN0ZW5lcnMgPSB0aGlzLl9ldmVudHNbdHlwZV07XG5cbiAgaWYgKGlzRnVuY3Rpb24obGlzdGVuZXJzKSkge1xuICAgIHRoaXMucmVtb3ZlTGlzdGVuZXIodHlwZSwgbGlzdGVuZXJzKTtcbiAgfSBlbHNlIGlmIChsaXN0ZW5lcnMpIHtcbiAgICAvLyBMSUZPIG9yZGVyXG4gICAgd2hpbGUgKGxpc3RlbmVycy5sZW5ndGgpXG4gICAgICB0aGlzLnJlbW92ZUxpc3RlbmVyKHR5cGUsIGxpc3RlbmVyc1tsaXN0ZW5lcnMubGVuZ3RoIC0gMV0pO1xuICB9XG4gIGRlbGV0ZSB0aGlzLl9ldmVudHNbdHlwZV07XG5cbiAgcmV0dXJuIHRoaXM7XG59O1xuXG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLmxpc3RlbmVycyA9IGZ1bmN0aW9uKHR5cGUpIHtcbiAgdmFyIHJldDtcbiAgaWYgKCF0aGlzLl9ldmVudHMgfHwgIXRoaXMuX2V2ZW50c1t0eXBlXSlcbiAgICByZXQgPSBbXTtcbiAgZWxzZSBpZiAoaXNGdW5jdGlvbih0aGlzLl9ldmVudHNbdHlwZV0pKVxuICAgIHJldCA9IFt0aGlzLl9ldmVudHNbdHlwZV1dO1xuICBlbHNlXG4gICAgcmV0ID0gdGhpcy5fZXZlbnRzW3R5cGVdLnNsaWNlKCk7XG4gIHJldHVybiByZXQ7XG59O1xuXG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLmxpc3RlbmVyQ291bnQgPSBmdW5jdGlvbih0eXBlKSB7XG4gIGlmICh0aGlzLl9ldmVudHMpIHtcbiAgICB2YXIgZXZsaXN0ZW5lciA9IHRoaXMuX2V2ZW50c1t0eXBlXTtcblxuICAgIGlmIChpc0Z1bmN0aW9uKGV2bGlzdGVuZXIpKVxuICAgICAgcmV0dXJuIDE7XG4gICAgZWxzZSBpZiAoZXZsaXN0ZW5lcilcbiAgICAgIHJldHVybiBldmxpc3RlbmVyLmxlbmd0aDtcbiAgfVxuICByZXR1cm4gMDtcbn07XG5cbkV2ZW50RW1pdHRlci5saXN0ZW5lckNvdW50ID0gZnVuY3Rpb24oZW1pdHRlciwgdHlwZSkge1xuICByZXR1cm4gZW1pdHRlci5saXN0ZW5lckNvdW50KHR5cGUpO1xufTtcblxuZnVuY3Rpb24gaXNGdW5jdGlvbihhcmcpIHtcbiAgcmV0dXJuIHR5cGVvZiBhcmcgPT09ICdmdW5jdGlvbic7XG59XG5cbmZ1bmN0aW9uIGlzTnVtYmVyKGFyZykge1xuICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ251bWJlcic7XG59XG5cbmZ1bmN0aW9uIGlzT2JqZWN0KGFyZykge1xuICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ29iamVjdCcgJiYgYXJnICE9PSBudWxsO1xufVxuXG5mdW5jdGlvbiBpc1VuZGVmaW5lZChhcmcpIHtcbiAgcmV0dXJuIGFyZyA9PT0gdm9pZCAwO1xufVxuIiwiLyohXG4gKiBEZXRlcm1pbmUgaWYgYW4gb2JqZWN0IGlzIGEgQnVmZmVyXG4gKlxuICogQGF1dGhvciAgIEZlcm9zcyBBYm91a2hhZGlqZWggPGh0dHBzOi8vZmVyb3NzLm9yZz5cbiAqIEBsaWNlbnNlICBNSVRcbiAqL1xuXG4vLyBUaGUgX2lzQnVmZmVyIGNoZWNrIGlzIGZvciBTYWZhcmkgNS03IHN1cHBvcnQsIGJlY2F1c2UgaXQncyBtaXNzaW5nXG4vLyBPYmplY3QucHJvdG90eXBlLmNvbnN0cnVjdG9yLiBSZW1vdmUgdGhpcyBldmVudHVhbGx5XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChvYmopIHtcbiAgcmV0dXJuIG9iaiAhPSBudWxsICYmIChpc0J1ZmZlcihvYmopIHx8IGlzU2xvd0J1ZmZlcihvYmopIHx8ICEhb2JqLl9pc0J1ZmZlcilcbn1cblxuZnVuY3Rpb24gaXNCdWZmZXIgKG9iaikge1xuICByZXR1cm4gISFvYmouY29uc3RydWN0b3IgJiYgdHlwZW9mIG9iai5jb25zdHJ1Y3Rvci5pc0J1ZmZlciA9PT0gJ2Z1bmN0aW9uJyAmJiBvYmouY29uc3RydWN0b3IuaXNCdWZmZXIob2JqKVxufVxuXG4vLyBGb3IgTm9kZSB2MC4xMCBzdXBwb3J0LiBSZW1vdmUgdGhpcyBldmVudHVhbGx5LlxuZnVuY3Rpb24gaXNTbG93QnVmZmVyIChvYmopIHtcbiAgcmV0dXJuIHR5cGVvZiBvYmoucmVhZEZsb2F0TEUgPT09ICdmdW5jdGlvbicgJiYgdHlwZW9mIG9iai5zbGljZSA9PT0gJ2Z1bmN0aW9uJyAmJiBpc0J1ZmZlcihvYmouc2xpY2UoMCwgMCkpXG59XG4iLCIvKlxuICogIGJhc2U2NC5qc1xuICpcbiAqICBMaWNlbnNlZCB1bmRlciB0aGUgQlNEIDMtQ2xhdXNlIExpY2Vuc2UuXG4gKiAgICBodHRwOi8vb3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvQlNELTMtQ2xhdXNlXG4gKlxuICogIFJlZmVyZW5jZXM6XG4gKiAgICBodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0Jhc2U2NFxuICovXG47KGZ1bmN0aW9uIChnbG9iYWwsIGZhY3RvcnkpIHtcbiAgICB0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCdcbiAgICAgICAgPyBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoZ2xvYmFsKVxuICAgICAgICA6IHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZFxuICAgICAgICA/IGRlZmluZShmYWN0b3J5KSA6IGZhY3RvcnkoZ2xvYmFsKVxufSgoXG4gICAgdHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnID8gc2VsZlxuICAgICAgICA6IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnID8gd2luZG93XG4gICAgICAgIDogdHlwZW9mIGdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcgPyBnbG9iYWxcbjogdGhpc1xuKSwgZnVuY3Rpb24oZ2xvYmFsKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIC8vIGV4aXN0aW5nIHZlcnNpb24gZm9yIG5vQ29uZmxpY3QoKVxuICAgIHZhciBfQmFzZTY0ID0gZ2xvYmFsLkJhc2U2NDtcbiAgICB2YXIgdmVyc2lvbiA9IFwiMi41LjBcIjtcbiAgICAvLyBpZiBub2RlLmpzIGFuZCBOT1QgUmVhY3QgTmF0aXZlLCB3ZSB1c2UgQnVmZmVyXG4gICAgdmFyIGJ1ZmZlcjtcbiAgICBpZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgJiYgbW9kdWxlLmV4cG9ydHMpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGJ1ZmZlciA9IGV2YWwoXCJyZXF1aXJlKCdidWZmZXInKS5CdWZmZXJcIik7XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgYnVmZmVyID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8vIGNvbnN0YW50c1xuICAgIHZhciBiNjRjaGFyc1xuICAgICAgICA9ICdBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvJztcbiAgICB2YXIgYjY0dGFiID0gZnVuY3Rpb24oYmluKSB7XG4gICAgICAgIHZhciB0ID0ge307XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gYmluLmxlbmd0aDsgaSA8IGw7IGkrKykgdFtiaW4uY2hhckF0KGkpXSA9IGk7XG4gICAgICAgIHJldHVybiB0O1xuICAgIH0oYjY0Y2hhcnMpO1xuICAgIHZhciBmcm9tQ2hhckNvZGUgPSBTdHJpbmcuZnJvbUNoYXJDb2RlO1xuICAgIC8vIGVuY29kZXIgc3R1ZmZcbiAgICB2YXIgY2JfdXRvYiA9IGZ1bmN0aW9uKGMpIHtcbiAgICAgICAgaWYgKGMubGVuZ3RoIDwgMikge1xuICAgICAgICAgICAgdmFyIGNjID0gYy5jaGFyQ29kZUF0KDApO1xuICAgICAgICAgICAgcmV0dXJuIGNjIDwgMHg4MCA/IGNcbiAgICAgICAgICAgICAgICA6IGNjIDwgMHg4MDAgPyAoZnJvbUNoYXJDb2RlKDB4YzAgfCAoY2MgPj4+IDYpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArIGZyb21DaGFyQ29kZSgweDgwIHwgKGNjICYgMHgzZikpKVxuICAgICAgICAgICAgICAgIDogKGZyb21DaGFyQ29kZSgweGUwIHwgKChjYyA+Pj4gMTIpICYgMHgwZikpXG4gICAgICAgICAgICAgICAgICAgKyBmcm9tQ2hhckNvZGUoMHg4MCB8ICgoY2MgPj4+ICA2KSAmIDB4M2YpKVxuICAgICAgICAgICAgICAgICAgICsgZnJvbUNoYXJDb2RlKDB4ODAgfCAoIGNjICAgICAgICAgJiAweDNmKSkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIGNjID0gMHgxMDAwMFxuICAgICAgICAgICAgICAgICsgKGMuY2hhckNvZGVBdCgwKSAtIDB4RDgwMCkgKiAweDQwMFxuICAgICAgICAgICAgICAgICsgKGMuY2hhckNvZGVBdCgxKSAtIDB4REMwMCk7XG4gICAgICAgICAgICByZXR1cm4gKGZyb21DaGFyQ29kZSgweGYwIHwgKChjYyA+Pj4gMTgpICYgMHgwNykpXG4gICAgICAgICAgICAgICAgICAgICsgZnJvbUNoYXJDb2RlKDB4ODAgfCAoKGNjID4+PiAxMikgJiAweDNmKSlcbiAgICAgICAgICAgICAgICAgICAgKyBmcm9tQ2hhckNvZGUoMHg4MCB8ICgoY2MgPj4+ICA2KSAmIDB4M2YpKVxuICAgICAgICAgICAgICAgICAgICArIGZyb21DaGFyQ29kZSgweDgwIHwgKCBjYyAgICAgICAgICYgMHgzZikpKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgdmFyIHJlX3V0b2IgPSAvW1xcdUQ4MDAtXFx1REJGRl1bXFx1REMwMC1cXHVERkZGRl18W15cXHgwMC1cXHg3Rl0vZztcbiAgICB2YXIgdXRvYiA9IGZ1bmN0aW9uKHUpIHtcbiAgICAgICAgcmV0dXJuIHUucmVwbGFjZShyZV91dG9iLCBjYl91dG9iKTtcbiAgICB9O1xuICAgIHZhciBjYl9lbmNvZGUgPSBmdW5jdGlvbihjY2MpIHtcbiAgICAgICAgdmFyIHBhZGxlbiA9IFswLCAyLCAxXVtjY2MubGVuZ3RoICUgM10sXG4gICAgICAgIG9yZCA9IGNjYy5jaGFyQ29kZUF0KDApIDw8IDE2XG4gICAgICAgICAgICB8ICgoY2NjLmxlbmd0aCA+IDEgPyBjY2MuY2hhckNvZGVBdCgxKSA6IDApIDw8IDgpXG4gICAgICAgICAgICB8ICgoY2NjLmxlbmd0aCA+IDIgPyBjY2MuY2hhckNvZGVBdCgyKSA6IDApKSxcbiAgICAgICAgY2hhcnMgPSBbXG4gICAgICAgICAgICBiNjRjaGFycy5jaGFyQXQoIG9yZCA+Pj4gMTgpLFxuICAgICAgICAgICAgYjY0Y2hhcnMuY2hhckF0KChvcmQgPj4+IDEyKSAmIDYzKSxcbiAgICAgICAgICAgIHBhZGxlbiA+PSAyID8gJz0nIDogYjY0Y2hhcnMuY2hhckF0KChvcmQgPj4+IDYpICYgNjMpLFxuICAgICAgICAgICAgcGFkbGVuID49IDEgPyAnPScgOiBiNjRjaGFycy5jaGFyQXQob3JkICYgNjMpXG4gICAgICAgIF07XG4gICAgICAgIHJldHVybiBjaGFycy5qb2luKCcnKTtcbiAgICB9O1xuICAgIHZhciBidG9hID0gZ2xvYmFsLmJ0b2EgPyBmdW5jdGlvbihiKSB7XG4gICAgICAgIHJldHVybiBnbG9iYWwuYnRvYShiKTtcbiAgICB9IDogZnVuY3Rpb24oYikge1xuICAgICAgICByZXR1cm4gYi5yZXBsYWNlKC9bXFxzXFxTXXsxLDN9L2csIGNiX2VuY29kZSk7XG4gICAgfTtcbiAgICB2YXIgX2VuY29kZSA9IGJ1ZmZlciA/XG4gICAgICAgIGJ1ZmZlci5mcm9tICYmIFVpbnQ4QXJyYXkgJiYgYnVmZmVyLmZyb20gIT09IFVpbnQ4QXJyYXkuZnJvbVxuICAgICAgICA/IGZ1bmN0aW9uICh1KSB7XG4gICAgICAgICAgICByZXR1cm4gKHUuY29uc3RydWN0b3IgPT09IGJ1ZmZlci5jb25zdHJ1Y3RvciA/IHUgOiBidWZmZXIuZnJvbSh1KSlcbiAgICAgICAgICAgICAgICAudG9TdHJpbmcoJ2Jhc2U2NCcpXG4gICAgICAgIH1cbiAgICAgICAgOiAgZnVuY3Rpb24gKHUpIHtcbiAgICAgICAgICAgIHJldHVybiAodS5jb25zdHJ1Y3RvciA9PT0gYnVmZmVyLmNvbnN0cnVjdG9yID8gdSA6IG5ldyAgYnVmZmVyKHUpKVxuICAgICAgICAgICAgICAgIC50b1N0cmluZygnYmFzZTY0JylcbiAgICAgICAgfVxuICAgICAgICA6IGZ1bmN0aW9uICh1KSB7IHJldHVybiBidG9hKHV0b2IodSkpIH1cbiAgICA7XG4gICAgdmFyIGVuY29kZSA9IGZ1bmN0aW9uKHUsIHVyaXNhZmUpIHtcbiAgICAgICAgcmV0dXJuICF1cmlzYWZlXG4gICAgICAgICAgICA/IF9lbmNvZGUoU3RyaW5nKHUpKVxuICAgICAgICAgICAgOiBfZW5jb2RlKFN0cmluZyh1KSkucmVwbGFjZSgvWytcXC9dL2csIGZ1bmN0aW9uKG0wKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG0wID09ICcrJyA/ICctJyA6ICdfJztcbiAgICAgICAgICAgIH0pLnJlcGxhY2UoLz0vZywgJycpO1xuICAgIH07XG4gICAgdmFyIGVuY29kZVVSSSA9IGZ1bmN0aW9uKHUpIHsgcmV0dXJuIGVuY29kZSh1LCB0cnVlKSB9O1xuICAgIC8vIGRlY29kZXIgc3R1ZmZcbiAgICB2YXIgcmVfYnRvdSA9IG5ldyBSZWdFeHAoW1xuICAgICAgICAnW1xceEMwLVxceERGXVtcXHg4MC1cXHhCRl0nLFxuICAgICAgICAnW1xceEUwLVxceEVGXVtcXHg4MC1cXHhCRl17Mn0nLFxuICAgICAgICAnW1xceEYwLVxceEY3XVtcXHg4MC1cXHhCRl17M30nXG4gICAgXS5qb2luKCd8JyksICdnJyk7XG4gICAgdmFyIGNiX2J0b3UgPSBmdW5jdGlvbihjY2NjKSB7XG4gICAgICAgIHN3aXRjaChjY2NjLmxlbmd0aCkge1xuICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICB2YXIgY3AgPSAoKDB4MDcgJiBjY2NjLmNoYXJDb2RlQXQoMCkpIDw8IDE4KVxuICAgICAgICAgICAgICAgIHwgICAgKCgweDNmICYgY2NjYy5jaGFyQ29kZUF0KDEpKSA8PCAxMilcbiAgICAgICAgICAgICAgICB8ICAgICgoMHgzZiAmIGNjY2MuY2hhckNvZGVBdCgyKSkgPDwgIDYpXG4gICAgICAgICAgICAgICAgfCAgICAgKDB4M2YgJiBjY2NjLmNoYXJDb2RlQXQoMykpLFxuICAgICAgICAgICAgb2Zmc2V0ID0gY3AgLSAweDEwMDAwO1xuICAgICAgICAgICAgcmV0dXJuIChmcm9tQ2hhckNvZGUoKG9mZnNldCAgPj4+IDEwKSArIDB4RDgwMClcbiAgICAgICAgICAgICAgICAgICAgKyBmcm9tQ2hhckNvZGUoKG9mZnNldCAmIDB4M0ZGKSArIDB4REMwMCkpO1xuICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICByZXR1cm4gZnJvbUNoYXJDb2RlKFxuICAgICAgICAgICAgICAgICgoMHgwZiAmIGNjY2MuY2hhckNvZGVBdCgwKSkgPDwgMTIpXG4gICAgICAgICAgICAgICAgICAgIHwgKCgweDNmICYgY2NjYy5jaGFyQ29kZUF0KDEpKSA8PCA2KVxuICAgICAgICAgICAgICAgICAgICB8ICAoMHgzZiAmIGNjY2MuY2hhckNvZGVBdCgyKSlcbiAgICAgICAgICAgICk7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gIGZyb21DaGFyQ29kZShcbiAgICAgICAgICAgICAgICAoKDB4MWYgJiBjY2NjLmNoYXJDb2RlQXQoMCkpIDw8IDYpXG4gICAgICAgICAgICAgICAgICAgIHwgICgweDNmICYgY2NjYy5jaGFyQ29kZUF0KDEpKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgdmFyIGJ0b3UgPSBmdW5jdGlvbihiKSB7XG4gICAgICAgIHJldHVybiBiLnJlcGxhY2UocmVfYnRvdSwgY2JfYnRvdSk7XG4gICAgfTtcbiAgICB2YXIgY2JfZGVjb2RlID0gZnVuY3Rpb24oY2NjYykge1xuICAgICAgICB2YXIgbGVuID0gY2NjYy5sZW5ndGgsXG4gICAgICAgIHBhZGxlbiA9IGxlbiAlIDQsXG4gICAgICAgIG4gPSAobGVuID4gMCA/IGI2NHRhYltjY2NjLmNoYXJBdCgwKV0gPDwgMTggOiAwKVxuICAgICAgICAgICAgfCAobGVuID4gMSA/IGI2NHRhYltjY2NjLmNoYXJBdCgxKV0gPDwgMTIgOiAwKVxuICAgICAgICAgICAgfCAobGVuID4gMiA/IGI2NHRhYltjY2NjLmNoYXJBdCgyKV0gPDwgIDYgOiAwKVxuICAgICAgICAgICAgfCAobGVuID4gMyA/IGI2NHRhYltjY2NjLmNoYXJBdCgzKV0gICAgICAgOiAwKSxcbiAgICAgICAgY2hhcnMgPSBbXG4gICAgICAgICAgICBmcm9tQ2hhckNvZGUoIG4gPj4+IDE2KSxcbiAgICAgICAgICAgIGZyb21DaGFyQ29kZSgobiA+Pj4gIDgpICYgMHhmZiksXG4gICAgICAgICAgICBmcm9tQ2hhckNvZGUoIG4gICAgICAgICAmIDB4ZmYpXG4gICAgICAgIF07XG4gICAgICAgIGNoYXJzLmxlbmd0aCAtPSBbMCwgMCwgMiwgMV1bcGFkbGVuXTtcbiAgICAgICAgcmV0dXJuIGNoYXJzLmpvaW4oJycpO1xuICAgIH07XG4gICAgdmFyIF9hdG9iID0gZ2xvYmFsLmF0b2IgPyBmdW5jdGlvbihhKSB7XG4gICAgICAgIHJldHVybiBnbG9iYWwuYXRvYihhKTtcbiAgICB9IDogZnVuY3Rpb24oYSl7XG4gICAgICAgIHJldHVybiBhLnJlcGxhY2UoL1xcU3sxLDR9L2csIGNiX2RlY29kZSk7XG4gICAgfTtcbiAgICB2YXIgYXRvYiA9IGZ1bmN0aW9uKGEpIHtcbiAgICAgICAgcmV0dXJuIF9hdG9iKFN0cmluZyhhKS5yZXBsYWNlKC9bXkEtWmEtejAtOVxcK1xcL10vZywgJycpKTtcbiAgICB9O1xuICAgIHZhciBfZGVjb2RlID0gYnVmZmVyID9cbiAgICAgICAgYnVmZmVyLmZyb20gJiYgVWludDhBcnJheSAmJiBidWZmZXIuZnJvbSAhPT0gVWludDhBcnJheS5mcm9tXG4gICAgICAgID8gZnVuY3Rpb24oYSkge1xuICAgICAgICAgICAgcmV0dXJuIChhLmNvbnN0cnVjdG9yID09PSBidWZmZXIuY29uc3RydWN0b3JcbiAgICAgICAgICAgICAgICAgICAgPyBhIDogYnVmZmVyLmZyb20oYSwgJ2Jhc2U2NCcpKS50b1N0cmluZygpO1xuICAgICAgICB9XG4gICAgICAgIDogZnVuY3Rpb24oYSkge1xuICAgICAgICAgICAgcmV0dXJuIChhLmNvbnN0cnVjdG9yID09PSBidWZmZXIuY29uc3RydWN0b3JcbiAgICAgICAgICAgICAgICAgICAgPyBhIDogbmV3IGJ1ZmZlcihhLCAnYmFzZTY0JykpLnRvU3RyaW5nKCk7XG4gICAgICAgIH1cbiAgICAgICAgOiBmdW5jdGlvbihhKSB7IHJldHVybiBidG91KF9hdG9iKGEpKSB9O1xuICAgIHZhciBkZWNvZGUgPSBmdW5jdGlvbihhKXtcbiAgICAgICAgcmV0dXJuIF9kZWNvZGUoXG4gICAgICAgICAgICBTdHJpbmcoYSkucmVwbGFjZSgvWy1fXS9nLCBmdW5jdGlvbihtMCkgeyByZXR1cm4gbTAgPT0gJy0nID8gJysnIDogJy8nIH0pXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoL1teQS1aYS16MC05XFwrXFwvXS9nLCAnJylcbiAgICAgICAgKTtcbiAgICB9O1xuICAgIHZhciBub0NvbmZsaWN0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBCYXNlNjQgPSBnbG9iYWwuQmFzZTY0O1xuICAgICAgICBnbG9iYWwuQmFzZTY0ID0gX0Jhc2U2NDtcbiAgICAgICAgcmV0dXJuIEJhc2U2NDtcbiAgICB9O1xuICAgIC8vIGV4cG9ydCBCYXNlNjRcbiAgICBnbG9iYWwuQmFzZTY0ID0ge1xuICAgICAgICBWRVJTSU9OOiB2ZXJzaW9uLFxuICAgICAgICBhdG9iOiBhdG9iLFxuICAgICAgICBidG9hOiBidG9hLFxuICAgICAgICBmcm9tQmFzZTY0OiBkZWNvZGUsXG4gICAgICAgIHRvQmFzZTY0OiBlbmNvZGUsXG4gICAgICAgIHV0b2I6IHV0b2IsXG4gICAgICAgIGVuY29kZTogZW5jb2RlLFxuICAgICAgICBlbmNvZGVVUkk6IGVuY29kZVVSSSxcbiAgICAgICAgYnRvdTogYnRvdSxcbiAgICAgICAgZGVjb2RlOiBkZWNvZGUsXG4gICAgICAgIG5vQ29uZmxpY3Q6IG5vQ29uZmxpY3QsXG4gICAgICAgIF9fYnVmZmVyX186IGJ1ZmZlclxuICAgIH07XG4gICAgLy8gaWYgRVM1IGlzIGF2YWlsYWJsZSwgbWFrZSBCYXNlNjQuZXh0ZW5kU3RyaW5nKCkgYXZhaWxhYmxlXG4gICAgaWYgKHR5cGVvZiBPYmplY3QuZGVmaW5lUHJvcGVydHkgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdmFyIG5vRW51bSA9IGZ1bmN0aW9uKHYpe1xuICAgICAgICAgICAgcmV0dXJuIHt2YWx1ZTp2LGVudW1lcmFibGU6ZmFsc2Usd3JpdGFibGU6dHJ1ZSxjb25maWd1cmFibGU6dHJ1ZX07XG4gICAgICAgIH07XG4gICAgICAgIGdsb2JhbC5CYXNlNjQuZXh0ZW5kU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFxuICAgICAgICAgICAgICAgIFN0cmluZy5wcm90b3R5cGUsICdmcm9tQmFzZTY0Jywgbm9FbnVtKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlY29kZSh0aGlzKVxuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShcbiAgICAgICAgICAgICAgICBTdHJpbmcucHJvdG90eXBlLCAndG9CYXNlNjQnLCBub0VudW0oZnVuY3Rpb24gKHVyaXNhZmUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVuY29kZSh0aGlzLCB1cmlzYWZlKVxuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShcbiAgICAgICAgICAgICAgICBTdHJpbmcucHJvdG90eXBlLCAndG9CYXNlNjRVUkknLCBub0VudW0oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZW5jb2RlKHRoaXMsIHRydWUpXG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICB9O1xuICAgIH1cbiAgICAvL1xuICAgIC8vIGV4cG9ydCBCYXNlNjQgdG8gdGhlIG5hbWVzcGFjZVxuICAgIC8vXG4gICAgaWYgKGdsb2JhbFsnTWV0ZW9yJ10pIHsgLy8gTWV0ZW9yLmpzXG4gICAgICAgIEJhc2U2NCA9IGdsb2JhbC5CYXNlNjQ7XG4gICAgfVxuICAgIC8vIG1vZHVsZS5leHBvcnRzIGFuZCBBTUQgYXJlIG11dHVhbGx5IGV4Y2x1c2l2ZS5cbiAgICAvLyBtb2R1bGUuZXhwb3J0cyBoYXMgcHJlY2VkZW5jZS5cbiAgICBpZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgJiYgbW9kdWxlLmV4cG9ydHMpIHtcbiAgICAgICAgbW9kdWxlLmV4cG9ydHMuQmFzZTY0ID0gZ2xvYmFsLkJhc2U2NDtcbiAgICB9XG4gICAgZWxzZSBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG4gICAgICAgIC8vIEFNRC4gUmVnaXN0ZXIgYXMgYW4gYW5vbnltb3VzIG1vZHVsZS5cbiAgICAgICAgZGVmaW5lKFtdLCBmdW5jdGlvbigpeyByZXR1cm4gZ2xvYmFsLkJhc2U2NCB9KTtcbiAgICB9XG4gICAgLy8gdGhhdCdzIGl0IVxuICAgIHJldHVybiB7QmFzZTY0OiBnbG9iYWwuQmFzZTY0fVxufSkpO1xuIiwidmFyIGdldE5hdGl2ZSA9IHJlcXVpcmUoJy4vX2dldE5hdGl2ZScpLFxuICAgIHJvb3QgPSByZXF1aXJlKCcuL19yb290Jyk7XG5cbi8qIEJ1aWx0LWluIG1ldGhvZCByZWZlcmVuY2VzIHRoYXQgYXJlIHZlcmlmaWVkIHRvIGJlIG5hdGl2ZS4gKi9cbnZhciBEYXRhVmlldyA9IGdldE5hdGl2ZShyb290LCAnRGF0YVZpZXcnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBEYXRhVmlldztcbiIsInZhciBnZXROYXRpdmUgPSByZXF1aXJlKCcuL19nZXROYXRpdmUnKSxcbiAgICByb290ID0gcmVxdWlyZSgnLi9fcm9vdCcpO1xuXG4vKiBCdWlsdC1pbiBtZXRob2QgcmVmZXJlbmNlcyB0aGF0IGFyZSB2ZXJpZmllZCB0byBiZSBuYXRpdmUuICovXG52YXIgTWFwID0gZ2V0TmF0aXZlKHJvb3QsICdNYXAnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBNYXA7XG4iLCJ2YXIgZ2V0TmF0aXZlID0gcmVxdWlyZSgnLi9fZ2V0TmF0aXZlJyksXG4gICAgcm9vdCA9IHJlcXVpcmUoJy4vX3Jvb3QnKTtcblxuLyogQnVpbHQtaW4gbWV0aG9kIHJlZmVyZW5jZXMgdGhhdCBhcmUgdmVyaWZpZWQgdG8gYmUgbmF0aXZlLiAqL1xudmFyIFByb21pc2UgPSBnZXROYXRpdmUocm9vdCwgJ1Byb21pc2UnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBQcm9taXNlO1xuIiwidmFyIGdldE5hdGl2ZSA9IHJlcXVpcmUoJy4vX2dldE5hdGl2ZScpLFxuICAgIHJvb3QgPSByZXF1aXJlKCcuL19yb290Jyk7XG5cbi8qIEJ1aWx0LWluIG1ldGhvZCByZWZlcmVuY2VzIHRoYXQgYXJlIHZlcmlmaWVkIHRvIGJlIG5hdGl2ZS4gKi9cbnZhciBTZXQgPSBnZXROYXRpdmUocm9vdCwgJ1NldCcpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFNldDtcbiIsInZhciByb290ID0gcmVxdWlyZSgnLi9fcm9vdCcpO1xuXG4vKiogQnVpbHQtaW4gdmFsdWUgcmVmZXJlbmNlcy4gKi9cbnZhciBTeW1ib2wgPSByb290LlN5bWJvbDtcblxubW9kdWxlLmV4cG9ydHMgPSBTeW1ib2w7XG4iLCJ2YXIgZ2V0TmF0aXZlID0gcmVxdWlyZSgnLi9fZ2V0TmF0aXZlJyksXG4gICAgcm9vdCA9IHJlcXVpcmUoJy4vX3Jvb3QnKTtcblxuLyogQnVpbHQtaW4gbWV0aG9kIHJlZmVyZW5jZXMgdGhhdCBhcmUgdmVyaWZpZWQgdG8gYmUgbmF0aXZlLiAqL1xudmFyIFdlYWtNYXAgPSBnZXROYXRpdmUocm9vdCwgJ1dlYWtNYXAnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBXZWFrTWFwO1xuIiwidmFyIFN5bWJvbCA9IHJlcXVpcmUoJy4vX1N5bWJvbCcpLFxuICAgIGdldFJhd1RhZyA9IHJlcXVpcmUoJy4vX2dldFJhd1RhZycpLFxuICAgIG9iamVjdFRvU3RyaW5nID0gcmVxdWlyZSgnLi9fb2JqZWN0VG9TdHJpbmcnKTtcblxuLyoqIGBPYmplY3QjdG9TdHJpbmdgIHJlc3VsdCByZWZlcmVuY2VzLiAqL1xudmFyIG51bGxUYWcgPSAnW29iamVjdCBOdWxsXScsXG4gICAgdW5kZWZpbmVkVGFnID0gJ1tvYmplY3QgVW5kZWZpbmVkXSc7XG5cbi8qKiBCdWlsdC1pbiB2YWx1ZSByZWZlcmVuY2VzLiAqL1xudmFyIHN5bVRvU3RyaW5nVGFnID0gU3ltYm9sID8gU3ltYm9sLnRvU3RyaW5nVGFnIDogdW5kZWZpbmVkO1xuXG4vKipcbiAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBnZXRUYWdgIHdpdGhvdXQgZmFsbGJhY2tzIGZvciBidWdneSBlbnZpcm9ubWVudHMuXG4gKlxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHF1ZXJ5LlxuICogQHJldHVybnMge3N0cmluZ30gUmV0dXJucyB0aGUgYHRvU3RyaW5nVGFnYC5cbiAqL1xuZnVuY3Rpb24gYmFzZUdldFRhZyh2YWx1ZSkge1xuICBpZiAodmFsdWUgPT0gbnVsbCkge1xuICAgIHJldHVybiB2YWx1ZSA9PT0gdW5kZWZpbmVkID8gdW5kZWZpbmVkVGFnIDogbnVsbFRhZztcbiAgfVxuICByZXR1cm4gKHN5bVRvU3RyaW5nVGFnICYmIHN5bVRvU3RyaW5nVGFnIGluIE9iamVjdCh2YWx1ZSkpXG4gICAgPyBnZXRSYXdUYWcodmFsdWUpXG4gICAgOiBvYmplY3RUb1N0cmluZyh2YWx1ZSk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gYmFzZUdldFRhZztcbiIsInZhciBiYXNlR2V0VGFnID0gcmVxdWlyZSgnLi9fYmFzZUdldFRhZycpLFxuICAgIGlzT2JqZWN0TGlrZSA9IHJlcXVpcmUoJy4vaXNPYmplY3RMaWtlJyk7XG5cbi8qKiBgT2JqZWN0I3RvU3RyaW5nYCByZXN1bHQgcmVmZXJlbmNlcy4gKi9cbnZhciBhcmdzVGFnID0gJ1tvYmplY3QgQXJndW1lbnRzXSc7XG5cbi8qKlxuICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8uaXNBcmd1bWVudHNgLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGFuIGBhcmd1bWVudHNgIG9iamVjdCxcbiAqL1xuZnVuY3Rpb24gYmFzZUlzQXJndW1lbnRzKHZhbHVlKSB7XG4gIHJldHVybiBpc09iamVjdExpa2UodmFsdWUpICYmIGJhc2VHZXRUYWcodmFsdWUpID09IGFyZ3NUYWc7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gYmFzZUlzQXJndW1lbnRzO1xuIiwidmFyIGlzRnVuY3Rpb24gPSByZXF1aXJlKCcuL2lzRnVuY3Rpb24nKSxcbiAgICBpc01hc2tlZCA9IHJlcXVpcmUoJy4vX2lzTWFza2VkJyksXG4gICAgaXNPYmplY3QgPSByZXF1aXJlKCcuL2lzT2JqZWN0JyksXG4gICAgdG9Tb3VyY2UgPSByZXF1aXJlKCcuL190b1NvdXJjZScpO1xuXG4vKipcbiAqIFVzZWQgdG8gbWF0Y2ggYFJlZ0V4cGBcbiAqIFtzeW50YXggY2hhcmFjdGVyc10oaHR0cDovL2VjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvNy4wLyNzZWMtcGF0dGVybnMpLlxuICovXG52YXIgcmVSZWdFeHBDaGFyID0gL1tcXFxcXiQuKis/KClbXFxde318XS9nO1xuXG4vKiogVXNlZCB0byBkZXRlY3QgaG9zdCBjb25zdHJ1Y3RvcnMgKFNhZmFyaSkuICovXG52YXIgcmVJc0hvc3RDdG9yID0gL15cXFtvYmplY3QgLis/Q29uc3RydWN0b3JcXF0kLztcblxuLyoqIFVzZWQgZm9yIGJ1aWx0LWluIG1ldGhvZCByZWZlcmVuY2VzLiAqL1xudmFyIGZ1bmNQcm90byA9IEZ1bmN0aW9uLnByb3RvdHlwZSxcbiAgICBvYmplY3RQcm90byA9IE9iamVjdC5wcm90b3R5cGU7XG5cbi8qKiBVc2VkIHRvIHJlc29sdmUgdGhlIGRlY29tcGlsZWQgc291cmNlIG9mIGZ1bmN0aW9ucy4gKi9cbnZhciBmdW5jVG9TdHJpbmcgPSBmdW5jUHJvdG8udG9TdHJpbmc7XG5cbi8qKiBVc2VkIHRvIGNoZWNrIG9iamVjdHMgZm9yIG93biBwcm9wZXJ0aWVzLiAqL1xudmFyIGhhc093blByb3BlcnR5ID0gb2JqZWN0UHJvdG8uaGFzT3duUHJvcGVydHk7XG5cbi8qKiBVc2VkIHRvIGRldGVjdCBpZiBhIG1ldGhvZCBpcyBuYXRpdmUuICovXG52YXIgcmVJc05hdGl2ZSA9IFJlZ0V4cCgnXicgK1xuICBmdW5jVG9TdHJpbmcuY2FsbChoYXNPd25Qcm9wZXJ0eSkucmVwbGFjZShyZVJlZ0V4cENoYXIsICdcXFxcJCYnKVxuICAucmVwbGFjZSgvaGFzT3duUHJvcGVydHl8KGZ1bmN0aW9uKS4qPyg/PVxcXFxcXCgpfCBmb3IgLis/KD89XFxcXFxcXSkvZywgJyQxLio/JykgKyAnJCdcbik7XG5cbi8qKlxuICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8uaXNOYXRpdmVgIHdpdGhvdXQgYmFkIHNoaW0gY2hlY2tzLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGEgbmF0aXZlIGZ1bmN0aW9uLFxuICogIGVsc2UgYGZhbHNlYC5cbiAqL1xuZnVuY3Rpb24gYmFzZUlzTmF0aXZlKHZhbHVlKSB7XG4gIGlmICghaXNPYmplY3QodmFsdWUpIHx8IGlzTWFza2VkKHZhbHVlKSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICB2YXIgcGF0dGVybiA9IGlzRnVuY3Rpb24odmFsdWUpID8gcmVJc05hdGl2ZSA6IHJlSXNIb3N0Q3RvcjtcbiAgcmV0dXJuIHBhdHRlcm4udGVzdCh0b1NvdXJjZSh2YWx1ZSkpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGJhc2VJc05hdGl2ZTtcbiIsInZhciBiYXNlR2V0VGFnID0gcmVxdWlyZSgnLi9fYmFzZUdldFRhZycpLFxuICAgIGlzTGVuZ3RoID0gcmVxdWlyZSgnLi9pc0xlbmd0aCcpLFxuICAgIGlzT2JqZWN0TGlrZSA9IHJlcXVpcmUoJy4vaXNPYmplY3RMaWtlJyk7XG5cbi8qKiBgT2JqZWN0I3RvU3RyaW5nYCByZXN1bHQgcmVmZXJlbmNlcy4gKi9cbnZhciBhcmdzVGFnID0gJ1tvYmplY3QgQXJndW1lbnRzXScsXG4gICAgYXJyYXlUYWcgPSAnW29iamVjdCBBcnJheV0nLFxuICAgIGJvb2xUYWcgPSAnW29iamVjdCBCb29sZWFuXScsXG4gICAgZGF0ZVRhZyA9ICdbb2JqZWN0IERhdGVdJyxcbiAgICBlcnJvclRhZyA9ICdbb2JqZWN0IEVycm9yXScsXG4gICAgZnVuY1RhZyA9ICdbb2JqZWN0IEZ1bmN0aW9uXScsXG4gICAgbWFwVGFnID0gJ1tvYmplY3QgTWFwXScsXG4gICAgbnVtYmVyVGFnID0gJ1tvYmplY3QgTnVtYmVyXScsXG4gICAgb2JqZWN0VGFnID0gJ1tvYmplY3QgT2JqZWN0XScsXG4gICAgcmVnZXhwVGFnID0gJ1tvYmplY3QgUmVnRXhwXScsXG4gICAgc2V0VGFnID0gJ1tvYmplY3QgU2V0XScsXG4gICAgc3RyaW5nVGFnID0gJ1tvYmplY3QgU3RyaW5nXScsXG4gICAgd2Vha01hcFRhZyA9ICdbb2JqZWN0IFdlYWtNYXBdJztcblxudmFyIGFycmF5QnVmZmVyVGFnID0gJ1tvYmplY3QgQXJyYXlCdWZmZXJdJyxcbiAgICBkYXRhVmlld1RhZyA9ICdbb2JqZWN0IERhdGFWaWV3XScsXG4gICAgZmxvYXQzMlRhZyA9ICdbb2JqZWN0IEZsb2F0MzJBcnJheV0nLFxuICAgIGZsb2F0NjRUYWcgPSAnW29iamVjdCBGbG9hdDY0QXJyYXldJyxcbiAgICBpbnQ4VGFnID0gJ1tvYmplY3QgSW50OEFycmF5XScsXG4gICAgaW50MTZUYWcgPSAnW29iamVjdCBJbnQxNkFycmF5XScsXG4gICAgaW50MzJUYWcgPSAnW29iamVjdCBJbnQzMkFycmF5XScsXG4gICAgdWludDhUYWcgPSAnW29iamVjdCBVaW50OEFycmF5XScsXG4gICAgdWludDhDbGFtcGVkVGFnID0gJ1tvYmplY3QgVWludDhDbGFtcGVkQXJyYXldJyxcbiAgICB1aW50MTZUYWcgPSAnW29iamVjdCBVaW50MTZBcnJheV0nLFxuICAgIHVpbnQzMlRhZyA9ICdbb2JqZWN0IFVpbnQzMkFycmF5XSc7XG5cbi8qKiBVc2VkIHRvIGlkZW50aWZ5IGB0b1N0cmluZ1RhZ2AgdmFsdWVzIG9mIHR5cGVkIGFycmF5cy4gKi9cbnZhciB0eXBlZEFycmF5VGFncyA9IHt9O1xudHlwZWRBcnJheVRhZ3NbZmxvYXQzMlRhZ10gPSB0eXBlZEFycmF5VGFnc1tmbG9hdDY0VGFnXSA9XG50eXBlZEFycmF5VGFnc1tpbnQ4VGFnXSA9IHR5cGVkQXJyYXlUYWdzW2ludDE2VGFnXSA9XG50eXBlZEFycmF5VGFnc1tpbnQzMlRhZ10gPSB0eXBlZEFycmF5VGFnc1t1aW50OFRhZ10gPVxudHlwZWRBcnJheVRhZ3NbdWludDhDbGFtcGVkVGFnXSA9IHR5cGVkQXJyYXlUYWdzW3VpbnQxNlRhZ10gPVxudHlwZWRBcnJheVRhZ3NbdWludDMyVGFnXSA9IHRydWU7XG50eXBlZEFycmF5VGFnc1thcmdzVGFnXSA9IHR5cGVkQXJyYXlUYWdzW2FycmF5VGFnXSA9XG50eXBlZEFycmF5VGFnc1thcnJheUJ1ZmZlclRhZ10gPSB0eXBlZEFycmF5VGFnc1tib29sVGFnXSA9XG50eXBlZEFycmF5VGFnc1tkYXRhVmlld1RhZ10gPSB0eXBlZEFycmF5VGFnc1tkYXRlVGFnXSA9XG50eXBlZEFycmF5VGFnc1tlcnJvclRhZ10gPSB0eXBlZEFycmF5VGFnc1tmdW5jVGFnXSA9XG50eXBlZEFycmF5VGFnc1ttYXBUYWddID0gdHlwZWRBcnJheVRhZ3NbbnVtYmVyVGFnXSA9XG50eXBlZEFycmF5VGFnc1tvYmplY3RUYWddID0gdHlwZWRBcnJheVRhZ3NbcmVnZXhwVGFnXSA9XG50eXBlZEFycmF5VGFnc1tzZXRUYWddID0gdHlwZWRBcnJheVRhZ3Nbc3RyaW5nVGFnXSA9XG50eXBlZEFycmF5VGFnc1t3ZWFrTWFwVGFnXSA9IGZhbHNlO1xuXG4vKipcbiAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLmlzVHlwZWRBcnJheWAgd2l0aG91dCBOb2RlLmpzIG9wdGltaXphdGlvbnMuXG4gKlxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgYSB0eXBlZCBhcnJheSwgZWxzZSBgZmFsc2VgLlxuICovXG5mdW5jdGlvbiBiYXNlSXNUeXBlZEFycmF5KHZhbHVlKSB7XG4gIHJldHVybiBpc09iamVjdExpa2UodmFsdWUpICYmXG4gICAgaXNMZW5ndGgodmFsdWUubGVuZ3RoKSAmJiAhIXR5cGVkQXJyYXlUYWdzW2Jhc2VHZXRUYWcodmFsdWUpXTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBiYXNlSXNUeXBlZEFycmF5O1xuIiwidmFyIGlzUHJvdG90eXBlID0gcmVxdWlyZSgnLi9faXNQcm90b3R5cGUnKSxcbiAgICBuYXRpdmVLZXlzID0gcmVxdWlyZSgnLi9fbmF0aXZlS2V5cycpO1xuXG4vKiogVXNlZCBmb3IgYnVpbHQtaW4gbWV0aG9kIHJlZmVyZW5jZXMuICovXG52YXIgb2JqZWN0UHJvdG8gPSBPYmplY3QucHJvdG90eXBlO1xuXG4vKiogVXNlZCB0byBjaGVjayBvYmplY3RzIGZvciBvd24gcHJvcGVydGllcy4gKi9cbnZhciBoYXNPd25Qcm9wZXJ0eSA9IG9iamVjdFByb3RvLmhhc093blByb3BlcnR5O1xuXG4vKipcbiAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLmtleXNgIHdoaWNoIGRvZXNuJ3QgdHJlYXQgc3BhcnNlIGFycmF5cyBhcyBkZW5zZS5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIHF1ZXJ5LlxuICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBhcnJheSBvZiBwcm9wZXJ0eSBuYW1lcy5cbiAqL1xuZnVuY3Rpb24gYmFzZUtleXMob2JqZWN0KSB7XG4gIGlmICghaXNQcm90b3R5cGUob2JqZWN0KSkge1xuICAgIHJldHVybiBuYXRpdmVLZXlzKG9iamVjdCk7XG4gIH1cbiAgdmFyIHJlc3VsdCA9IFtdO1xuICBmb3IgKHZhciBrZXkgaW4gT2JqZWN0KG9iamVjdCkpIHtcbiAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIGtleSkgJiYga2V5ICE9ICdjb25zdHJ1Y3RvcicpIHtcbiAgICAgIHJlc3VsdC5wdXNoKGtleSk7XG4gICAgfVxuICB9XG4gIHJldHVybiByZXN1bHQ7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gYmFzZUtleXM7XG4iLCIvKipcbiAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLnRpbWVzYCB3aXRob3V0IHN1cHBvcnQgZm9yIGl0ZXJhdGVlIHNob3J0aGFuZHNcbiAqIG9yIG1heCBhcnJheSBsZW5ndGggY2hlY2tzLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0ge251bWJlcn0gbiBUaGUgbnVtYmVyIG9mIHRpbWVzIHRvIGludm9rZSBgaXRlcmF0ZWVgLlxuICogQHBhcmFtIHtGdW5jdGlvbn0gaXRlcmF0ZWUgVGhlIGZ1bmN0aW9uIGludm9rZWQgcGVyIGl0ZXJhdGlvbi5cbiAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgYXJyYXkgb2YgcmVzdWx0cy5cbiAqL1xuZnVuY3Rpb24gYmFzZVRpbWVzKG4sIGl0ZXJhdGVlKSB7XG4gIHZhciBpbmRleCA9IC0xLFxuICAgICAgcmVzdWx0ID0gQXJyYXkobik7XG5cbiAgd2hpbGUgKCsraW5kZXggPCBuKSB7XG4gICAgcmVzdWx0W2luZGV4XSA9IGl0ZXJhdGVlKGluZGV4KTtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGJhc2VUaW1lcztcbiIsIi8qKlxuICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8udW5hcnlgIHdpdGhvdXQgc3VwcG9ydCBmb3Igc3RvcmluZyBtZXRhZGF0YS5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuYyBUaGUgZnVuY3Rpb24gdG8gY2FwIGFyZ3VtZW50cyBmb3IuXG4gKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBjYXBwZWQgZnVuY3Rpb24uXG4gKi9cbmZ1bmN0aW9uIGJhc2VVbmFyeShmdW5jKSB7XG4gIHJldHVybiBmdW5jdGlvbih2YWx1ZSkge1xuICAgIHJldHVybiBmdW5jKHZhbHVlKTtcbiAgfTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBiYXNlVW5hcnk7XG4iLCJ2YXIgaWRlbnRpdHkgPSByZXF1aXJlKCcuL2lkZW50aXR5Jyk7XG5cbi8qKlxuICogQ2FzdHMgYHZhbHVlYCB0byBgaWRlbnRpdHlgIGlmIGl0J3Mgbm90IGEgZnVuY3Rpb24uXG4gKlxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGluc3BlY3QuXG4gKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgY2FzdCBmdW5jdGlvbi5cbiAqL1xuZnVuY3Rpb24gY2FzdEZ1bmN0aW9uKHZhbHVlKSB7XG4gIHJldHVybiB0eXBlb2YgdmFsdWUgPT0gJ2Z1bmN0aW9uJyA/IHZhbHVlIDogaWRlbnRpdHk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gY2FzdEZ1bmN0aW9uO1xuIiwidmFyIHJvb3QgPSByZXF1aXJlKCcuL19yb290Jyk7XG5cbi8qKiBVc2VkIHRvIGRldGVjdCBvdmVycmVhY2hpbmcgY29yZS1qcyBzaGltcy4gKi9cbnZhciBjb3JlSnNEYXRhID0gcm9vdFsnX19jb3JlLWpzX3NoYXJlZF9fJ107XG5cbm1vZHVsZS5leHBvcnRzID0gY29yZUpzRGF0YTtcbiIsIi8qKiBEZXRlY3QgZnJlZSB2YXJpYWJsZSBgZ2xvYmFsYCBmcm9tIE5vZGUuanMuICovXG52YXIgZnJlZUdsb2JhbCA9IHR5cGVvZiBnbG9iYWwgPT0gJ29iamVjdCcgJiYgZ2xvYmFsICYmIGdsb2JhbC5PYmplY3QgPT09IE9iamVjdCAmJiBnbG9iYWw7XG5cbm1vZHVsZS5leHBvcnRzID0gZnJlZUdsb2JhbDtcbiIsInZhciBiYXNlSXNOYXRpdmUgPSByZXF1aXJlKCcuL19iYXNlSXNOYXRpdmUnKSxcbiAgICBnZXRWYWx1ZSA9IHJlcXVpcmUoJy4vX2dldFZhbHVlJyk7XG5cbi8qKlxuICogR2V0cyB0aGUgbmF0aXZlIGZ1bmN0aW9uIGF0IGBrZXlgIG9mIGBvYmplY3RgLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gcXVlcnkuXG4gKiBAcGFyYW0ge3N0cmluZ30ga2V5IFRoZSBrZXkgb2YgdGhlIG1ldGhvZCB0byBnZXQuXG4gKiBAcmV0dXJucyB7Kn0gUmV0dXJucyB0aGUgZnVuY3Rpb24gaWYgaXQncyBuYXRpdmUsIGVsc2UgYHVuZGVmaW5lZGAuXG4gKi9cbmZ1bmN0aW9uIGdldE5hdGl2ZShvYmplY3QsIGtleSkge1xuICB2YXIgdmFsdWUgPSBnZXRWYWx1ZShvYmplY3QsIGtleSk7XG4gIHJldHVybiBiYXNlSXNOYXRpdmUodmFsdWUpID8gdmFsdWUgOiB1bmRlZmluZWQ7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gZ2V0TmF0aXZlO1xuIiwidmFyIG92ZXJBcmcgPSByZXF1aXJlKCcuL19vdmVyQXJnJyk7XG5cbi8qKiBCdWlsdC1pbiB2YWx1ZSByZWZlcmVuY2VzLiAqL1xudmFyIGdldFByb3RvdHlwZSA9IG92ZXJBcmcoT2JqZWN0LmdldFByb3RvdHlwZU9mLCBPYmplY3QpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGdldFByb3RvdHlwZTtcbiIsInZhciBTeW1ib2wgPSByZXF1aXJlKCcuL19TeW1ib2wnKTtcblxuLyoqIFVzZWQgZm9yIGJ1aWx0LWluIG1ldGhvZCByZWZlcmVuY2VzLiAqL1xudmFyIG9iamVjdFByb3RvID0gT2JqZWN0LnByb3RvdHlwZTtcblxuLyoqIFVzZWQgdG8gY2hlY2sgb2JqZWN0cyBmb3Igb3duIHByb3BlcnRpZXMuICovXG52YXIgaGFzT3duUHJvcGVydHkgPSBvYmplY3RQcm90by5oYXNPd25Qcm9wZXJ0eTtcblxuLyoqXG4gKiBVc2VkIHRvIHJlc29sdmUgdGhlXG4gKiBbYHRvU3RyaW5nVGFnYF0oaHR0cDovL2VjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvNy4wLyNzZWMtb2JqZWN0LnByb3RvdHlwZS50b3N0cmluZylcbiAqIG9mIHZhbHVlcy5cbiAqL1xudmFyIG5hdGl2ZU9iamVjdFRvU3RyaW5nID0gb2JqZWN0UHJvdG8udG9TdHJpbmc7XG5cbi8qKiBCdWlsdC1pbiB2YWx1ZSByZWZlcmVuY2VzLiAqL1xudmFyIHN5bVRvU3RyaW5nVGFnID0gU3ltYm9sID8gU3ltYm9sLnRvU3RyaW5nVGFnIDogdW5kZWZpbmVkO1xuXG4vKipcbiAqIEEgc3BlY2lhbGl6ZWQgdmVyc2lvbiBvZiBgYmFzZUdldFRhZ2Agd2hpY2ggaWdub3JlcyBgU3ltYm9sLnRvU3RyaW5nVGFnYCB2YWx1ZXMuXG4gKlxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHF1ZXJ5LlxuICogQHJldHVybnMge3N0cmluZ30gUmV0dXJucyB0aGUgcmF3IGB0b1N0cmluZ1RhZ2AuXG4gKi9cbmZ1bmN0aW9uIGdldFJhd1RhZyh2YWx1ZSkge1xuICB2YXIgaXNPd24gPSBoYXNPd25Qcm9wZXJ0eS5jYWxsKHZhbHVlLCBzeW1Ub1N0cmluZ1RhZyksXG4gICAgICB0YWcgPSB2YWx1ZVtzeW1Ub1N0cmluZ1RhZ107XG5cbiAgdHJ5IHtcbiAgICB2YWx1ZVtzeW1Ub1N0cmluZ1RhZ10gPSB1bmRlZmluZWQ7XG4gICAgdmFyIHVubWFza2VkID0gdHJ1ZTtcbiAgfSBjYXRjaCAoZSkge31cblxuICB2YXIgcmVzdWx0ID0gbmF0aXZlT2JqZWN0VG9TdHJpbmcuY2FsbCh2YWx1ZSk7XG4gIGlmICh1bm1hc2tlZCkge1xuICAgIGlmIChpc093bikge1xuICAgICAgdmFsdWVbc3ltVG9TdHJpbmdUYWddID0gdGFnO1xuICAgIH0gZWxzZSB7XG4gICAgICBkZWxldGUgdmFsdWVbc3ltVG9TdHJpbmdUYWddO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGdldFJhd1RhZztcbiIsInZhciBEYXRhVmlldyA9IHJlcXVpcmUoJy4vX0RhdGFWaWV3JyksXG4gICAgTWFwID0gcmVxdWlyZSgnLi9fTWFwJyksXG4gICAgUHJvbWlzZSA9IHJlcXVpcmUoJy4vX1Byb21pc2UnKSxcbiAgICBTZXQgPSByZXF1aXJlKCcuL19TZXQnKSxcbiAgICBXZWFrTWFwID0gcmVxdWlyZSgnLi9fV2Vha01hcCcpLFxuICAgIGJhc2VHZXRUYWcgPSByZXF1aXJlKCcuL19iYXNlR2V0VGFnJyksXG4gICAgdG9Tb3VyY2UgPSByZXF1aXJlKCcuL190b1NvdXJjZScpO1xuXG4vKiogYE9iamVjdCN0b1N0cmluZ2AgcmVzdWx0IHJlZmVyZW5jZXMuICovXG52YXIgbWFwVGFnID0gJ1tvYmplY3QgTWFwXScsXG4gICAgb2JqZWN0VGFnID0gJ1tvYmplY3QgT2JqZWN0XScsXG4gICAgcHJvbWlzZVRhZyA9ICdbb2JqZWN0IFByb21pc2VdJyxcbiAgICBzZXRUYWcgPSAnW29iamVjdCBTZXRdJyxcbiAgICB3ZWFrTWFwVGFnID0gJ1tvYmplY3QgV2Vha01hcF0nO1xuXG52YXIgZGF0YVZpZXdUYWcgPSAnW29iamVjdCBEYXRhVmlld10nO1xuXG4vKiogVXNlZCB0byBkZXRlY3QgbWFwcywgc2V0cywgYW5kIHdlYWttYXBzLiAqL1xudmFyIGRhdGFWaWV3Q3RvclN0cmluZyA9IHRvU291cmNlKERhdGFWaWV3KSxcbiAgICBtYXBDdG9yU3RyaW5nID0gdG9Tb3VyY2UoTWFwKSxcbiAgICBwcm9taXNlQ3RvclN0cmluZyA9IHRvU291cmNlKFByb21pc2UpLFxuICAgIHNldEN0b3JTdHJpbmcgPSB0b1NvdXJjZShTZXQpLFxuICAgIHdlYWtNYXBDdG9yU3RyaW5nID0gdG9Tb3VyY2UoV2Vha01hcCk7XG5cbi8qKlxuICogR2V0cyB0aGUgYHRvU3RyaW5nVGFnYCBvZiBgdmFsdWVgLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBxdWVyeS5cbiAqIEByZXR1cm5zIHtzdHJpbmd9IFJldHVybnMgdGhlIGB0b1N0cmluZ1RhZ2AuXG4gKi9cbnZhciBnZXRUYWcgPSBiYXNlR2V0VGFnO1xuXG4vLyBGYWxsYmFjayBmb3IgZGF0YSB2aWV3cywgbWFwcywgc2V0cywgYW5kIHdlYWsgbWFwcyBpbiBJRSAxMSBhbmQgcHJvbWlzZXMgaW4gTm9kZS5qcyA8IDYuXG5pZiAoKERhdGFWaWV3ICYmIGdldFRhZyhuZXcgRGF0YVZpZXcobmV3IEFycmF5QnVmZmVyKDEpKSkgIT0gZGF0YVZpZXdUYWcpIHx8XG4gICAgKE1hcCAmJiBnZXRUYWcobmV3IE1hcCkgIT0gbWFwVGFnKSB8fFxuICAgIChQcm9taXNlICYmIGdldFRhZyhQcm9taXNlLnJlc29sdmUoKSkgIT0gcHJvbWlzZVRhZykgfHxcbiAgICAoU2V0ICYmIGdldFRhZyhuZXcgU2V0KSAhPSBzZXRUYWcpIHx8XG4gICAgKFdlYWtNYXAgJiYgZ2V0VGFnKG5ldyBXZWFrTWFwKSAhPSB3ZWFrTWFwVGFnKSkge1xuICBnZXRUYWcgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgIHZhciByZXN1bHQgPSBiYXNlR2V0VGFnKHZhbHVlKSxcbiAgICAgICAgQ3RvciA9IHJlc3VsdCA9PSBvYmplY3RUYWcgPyB2YWx1ZS5jb25zdHJ1Y3RvciA6IHVuZGVmaW5lZCxcbiAgICAgICAgY3RvclN0cmluZyA9IEN0b3IgPyB0b1NvdXJjZShDdG9yKSA6ICcnO1xuXG4gICAgaWYgKGN0b3JTdHJpbmcpIHtcbiAgICAgIHN3aXRjaCAoY3RvclN0cmluZykge1xuICAgICAgICBjYXNlIGRhdGFWaWV3Q3RvclN0cmluZzogcmV0dXJuIGRhdGFWaWV3VGFnO1xuICAgICAgICBjYXNlIG1hcEN0b3JTdHJpbmc6IHJldHVybiBtYXBUYWc7XG4gICAgICAgIGNhc2UgcHJvbWlzZUN0b3JTdHJpbmc6IHJldHVybiBwcm9taXNlVGFnO1xuICAgICAgICBjYXNlIHNldEN0b3JTdHJpbmc6IHJldHVybiBzZXRUYWc7XG4gICAgICAgIGNhc2Ugd2Vha01hcEN0b3JTdHJpbmc6IHJldHVybiB3ZWFrTWFwVGFnO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGdldFRhZztcbiIsIi8qKlxuICogR2V0cyB0aGUgdmFsdWUgYXQgYGtleWAgb2YgYG9iamVjdGAuXG4gKlxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7T2JqZWN0fSBbb2JqZWN0XSBUaGUgb2JqZWN0IHRvIHF1ZXJ5LlxuICogQHBhcmFtIHtzdHJpbmd9IGtleSBUaGUga2V5IG9mIHRoZSBwcm9wZXJ0eSB0byBnZXQuXG4gKiBAcmV0dXJucyB7Kn0gUmV0dXJucyB0aGUgcHJvcGVydHkgdmFsdWUuXG4gKi9cbmZ1bmN0aW9uIGdldFZhbHVlKG9iamVjdCwga2V5KSB7XG4gIHJldHVybiBvYmplY3QgPT0gbnVsbCA/IHVuZGVmaW5lZCA6IG9iamVjdFtrZXldO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGdldFZhbHVlO1xuIiwidmFyIGNvcmVKc0RhdGEgPSByZXF1aXJlKCcuL19jb3JlSnNEYXRhJyk7XG5cbi8qKiBVc2VkIHRvIGRldGVjdCBtZXRob2RzIG1hc3F1ZXJhZGluZyBhcyBuYXRpdmUuICovXG52YXIgbWFza1NyY0tleSA9IChmdW5jdGlvbigpIHtcbiAgdmFyIHVpZCA9IC9bXi5dKyQvLmV4ZWMoY29yZUpzRGF0YSAmJiBjb3JlSnNEYXRhLmtleXMgJiYgY29yZUpzRGF0YS5rZXlzLklFX1BST1RPIHx8ICcnKTtcbiAgcmV0dXJuIHVpZCA/ICgnU3ltYm9sKHNyYylfMS4nICsgdWlkKSA6ICcnO1xufSgpKTtcblxuLyoqXG4gKiBDaGVja3MgaWYgYGZ1bmNgIGhhcyBpdHMgc291cmNlIG1hc2tlZC5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuYyBUaGUgZnVuY3Rpb24gdG8gY2hlY2suXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYGZ1bmNgIGlzIG1hc2tlZCwgZWxzZSBgZmFsc2VgLlxuICovXG5mdW5jdGlvbiBpc01hc2tlZChmdW5jKSB7XG4gIHJldHVybiAhIW1hc2tTcmNLZXkgJiYgKG1hc2tTcmNLZXkgaW4gZnVuYyk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gaXNNYXNrZWQ7XG4iLCIvKiogVXNlZCBmb3IgYnVpbHQtaW4gbWV0aG9kIHJlZmVyZW5jZXMuICovXG52YXIgb2JqZWN0UHJvdG8gPSBPYmplY3QucHJvdG90eXBlO1xuXG4vKipcbiAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGxpa2VseSBhIHByb3RvdHlwZSBvYmplY3QuXG4gKlxuICogQHByaXZhdGVcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgYSBwcm90b3R5cGUsIGVsc2UgYGZhbHNlYC5cbiAqL1xuZnVuY3Rpb24gaXNQcm90b3R5cGUodmFsdWUpIHtcbiAgdmFyIEN0b3IgPSB2YWx1ZSAmJiB2YWx1ZS5jb25zdHJ1Y3RvcixcbiAgICAgIHByb3RvID0gKHR5cGVvZiBDdG9yID09ICdmdW5jdGlvbicgJiYgQ3Rvci5wcm90b3R5cGUpIHx8IG9iamVjdFByb3RvO1xuXG4gIHJldHVybiB2YWx1ZSA9PT0gcHJvdG87XG59XG5cbm1vZHVsZS5leHBvcnRzID0gaXNQcm90b3R5cGU7XG4iLCJ2YXIgb3ZlckFyZyA9IHJlcXVpcmUoJy4vX292ZXJBcmcnKTtcblxuLyogQnVpbHQtaW4gbWV0aG9kIHJlZmVyZW5jZXMgZm9yIHRob3NlIHdpdGggdGhlIHNhbWUgbmFtZSBhcyBvdGhlciBgbG9kYXNoYCBtZXRob2RzLiAqL1xudmFyIG5hdGl2ZUtleXMgPSBvdmVyQXJnKE9iamVjdC5rZXlzLCBPYmplY3QpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IG5hdGl2ZUtleXM7XG4iLCJ2YXIgZnJlZUdsb2JhbCA9IHJlcXVpcmUoJy4vX2ZyZWVHbG9iYWwnKTtcblxuLyoqIERldGVjdCBmcmVlIHZhcmlhYmxlIGBleHBvcnRzYC4gKi9cbnZhciBmcmVlRXhwb3J0cyA9IHR5cGVvZiBleHBvcnRzID09ICdvYmplY3QnICYmIGV4cG9ydHMgJiYgIWV4cG9ydHMubm9kZVR5cGUgJiYgZXhwb3J0cztcblxuLyoqIERldGVjdCBmcmVlIHZhcmlhYmxlIGBtb2R1bGVgLiAqL1xudmFyIGZyZWVNb2R1bGUgPSBmcmVlRXhwb3J0cyAmJiB0eXBlb2YgbW9kdWxlID09ICdvYmplY3QnICYmIG1vZHVsZSAmJiAhbW9kdWxlLm5vZGVUeXBlICYmIG1vZHVsZTtcblxuLyoqIERldGVjdCB0aGUgcG9wdWxhciBDb21tb25KUyBleHRlbnNpb24gYG1vZHVsZS5leHBvcnRzYC4gKi9cbnZhciBtb2R1bGVFeHBvcnRzID0gZnJlZU1vZHVsZSAmJiBmcmVlTW9kdWxlLmV4cG9ydHMgPT09IGZyZWVFeHBvcnRzO1xuXG4vKiogRGV0ZWN0IGZyZWUgdmFyaWFibGUgYHByb2Nlc3NgIGZyb20gTm9kZS5qcy4gKi9cbnZhciBmcmVlUHJvY2VzcyA9IG1vZHVsZUV4cG9ydHMgJiYgZnJlZUdsb2JhbC5wcm9jZXNzO1xuXG4vKiogVXNlZCB0byBhY2Nlc3MgZmFzdGVyIE5vZGUuanMgaGVscGVycy4gKi9cbnZhciBub2RlVXRpbCA9IChmdW5jdGlvbigpIHtcbiAgdHJ5IHtcbiAgICAvLyBVc2UgYHV0aWwudHlwZXNgIGZvciBOb2RlLmpzIDEwKy5cbiAgICB2YXIgdHlwZXMgPSBmcmVlTW9kdWxlICYmIGZyZWVNb2R1bGUucmVxdWlyZSAmJiBmcmVlTW9kdWxlLnJlcXVpcmUoJ3V0aWwnKS50eXBlcztcblxuICAgIGlmICh0eXBlcykge1xuICAgICAgcmV0dXJuIHR5cGVzO1xuICAgIH1cblxuICAgIC8vIExlZ2FjeSBgcHJvY2Vzcy5iaW5kaW5nKCd1dGlsJylgIGZvciBOb2RlLmpzIDwgMTAuXG4gICAgcmV0dXJuIGZyZWVQcm9jZXNzICYmIGZyZWVQcm9jZXNzLmJpbmRpbmcgJiYgZnJlZVByb2Nlc3MuYmluZGluZygndXRpbCcpO1xuICB9IGNhdGNoIChlKSB7fVxufSgpKTtcblxubW9kdWxlLmV4cG9ydHMgPSBub2RlVXRpbDtcbiIsIi8qKiBVc2VkIGZvciBidWlsdC1pbiBtZXRob2QgcmVmZXJlbmNlcy4gKi9cbnZhciBvYmplY3RQcm90byA9IE9iamVjdC5wcm90b3R5cGU7XG5cbi8qKlxuICogVXNlZCB0byByZXNvbHZlIHRoZVxuICogW2B0b1N0cmluZ1RhZ2BdKGh0dHA6Ly9lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzcuMC8jc2VjLW9iamVjdC5wcm90b3R5cGUudG9zdHJpbmcpXG4gKiBvZiB2YWx1ZXMuXG4gKi9cbnZhciBuYXRpdmVPYmplY3RUb1N0cmluZyA9IG9iamVjdFByb3RvLnRvU3RyaW5nO1xuXG4vKipcbiAqIENvbnZlcnRzIGB2YWx1ZWAgdG8gYSBzdHJpbmcgdXNpbmcgYE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmdgLlxuICpcbiAqIEBwcml2YXRlXG4gKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjb252ZXJ0LlxuICogQHJldHVybnMge3N0cmluZ30gUmV0dXJucyB0aGUgY29udmVydGVkIHN0cmluZy5cbiAqL1xuZnVuY3Rpb24gb2JqZWN0VG9TdHJpbmcodmFsdWUpIHtcbiAgcmV0dXJuIG5hdGl2ZU9iamVjdFRvU3RyaW5nLmNhbGwodmFsdWUpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IG9iamVjdFRvU3RyaW5nO1xuIiwiLyoqXG4gKiBDcmVhdGVzIGEgdW5hcnkgZnVuY3Rpb24gdGhhdCBpbnZva2VzIGBmdW5jYCB3aXRoIGl0cyBhcmd1bWVudCB0cmFuc2Zvcm1lZC5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuYyBUaGUgZnVuY3Rpb24gdG8gd3JhcC5cbiAqIEBwYXJhbSB7RnVuY3Rpb259IHRyYW5zZm9ybSBUaGUgYXJndW1lbnQgdHJhbnNmb3JtLlxuICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgZnVuY3Rpb24uXG4gKi9cbmZ1bmN0aW9uIG92ZXJBcmcoZnVuYywgdHJhbnNmb3JtKSB7XG4gIHJldHVybiBmdW5jdGlvbihhcmcpIHtcbiAgICByZXR1cm4gZnVuYyh0cmFuc2Zvcm0oYXJnKSk7XG4gIH07XG59XG5cbm1vZHVsZS5leHBvcnRzID0gb3ZlckFyZztcbiIsInZhciBmcmVlR2xvYmFsID0gcmVxdWlyZSgnLi9fZnJlZUdsb2JhbCcpO1xuXG4vKiogRGV0ZWN0IGZyZWUgdmFyaWFibGUgYHNlbGZgLiAqL1xudmFyIGZyZWVTZWxmID0gdHlwZW9mIHNlbGYgPT0gJ29iamVjdCcgJiYgc2VsZiAmJiBzZWxmLk9iamVjdCA9PT0gT2JqZWN0ICYmIHNlbGY7XG5cbi8qKiBVc2VkIGFzIGEgcmVmZXJlbmNlIHRvIHRoZSBnbG9iYWwgb2JqZWN0LiAqL1xudmFyIHJvb3QgPSBmcmVlR2xvYmFsIHx8IGZyZWVTZWxmIHx8IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCk7XG5cbm1vZHVsZS5leHBvcnRzID0gcm9vdDtcbiIsIi8qKiBVc2VkIGZvciBidWlsdC1pbiBtZXRob2QgcmVmZXJlbmNlcy4gKi9cbnZhciBmdW5jUHJvdG8gPSBGdW5jdGlvbi5wcm90b3R5cGU7XG5cbi8qKiBVc2VkIHRvIHJlc29sdmUgdGhlIGRlY29tcGlsZWQgc291cmNlIG9mIGZ1bmN0aW9ucy4gKi9cbnZhciBmdW5jVG9TdHJpbmcgPSBmdW5jUHJvdG8udG9TdHJpbmc7XG5cbi8qKlxuICogQ29udmVydHMgYGZ1bmNgIHRvIGl0cyBzb3VyY2UgY29kZS5cbiAqXG4gKiBAcHJpdmF0ZVxuICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuYyBUaGUgZnVuY3Rpb24gdG8gY29udmVydC5cbiAqIEByZXR1cm5zIHtzdHJpbmd9IFJldHVybnMgdGhlIHNvdXJjZSBjb2RlLlxuICovXG5mdW5jdGlvbiB0b1NvdXJjZShmdW5jKSB7XG4gIGlmIChmdW5jICE9IG51bGwpIHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGZ1bmNUb1N0cmluZy5jYWxsKGZ1bmMpO1xuICAgIH0gY2F0Y2ggKGUpIHt9XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiAoZnVuYyArICcnKTtcbiAgICB9IGNhdGNoIChlKSB7fVxuICB9XG4gIHJldHVybiAnJztcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB0b1NvdXJjZTtcbiIsIi8qKlxuICogVGhpcyBtZXRob2QgcmV0dXJucyB0aGUgZmlyc3QgYXJndW1lbnQgaXQgcmVjZWl2ZXMuXG4gKlxuICogQHN0YXRpY1xuICogQHNpbmNlIDAuMS4wXG4gKiBAbWVtYmVyT2YgX1xuICogQGNhdGVnb3J5IFV0aWxcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgQW55IHZhbHVlLlxuICogQHJldHVybnMgeyp9IFJldHVybnMgYHZhbHVlYC5cbiAqIEBleGFtcGxlXG4gKlxuICogdmFyIG9iamVjdCA9IHsgJ2EnOiAxIH07XG4gKlxuICogY29uc29sZS5sb2coXy5pZGVudGl0eShvYmplY3QpID09PSBvYmplY3QpO1xuICogLy8gPT4gdHJ1ZVxuICovXG5mdW5jdGlvbiBpZGVudGl0eSh2YWx1ZSkge1xuICByZXR1cm4gdmFsdWU7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gaWRlbnRpdHk7XG4iLCJ2YXIgYmFzZUlzQXJndW1lbnRzID0gcmVxdWlyZSgnLi9fYmFzZUlzQXJndW1lbnRzJyksXG4gICAgaXNPYmplY3RMaWtlID0gcmVxdWlyZSgnLi9pc09iamVjdExpa2UnKTtcblxuLyoqIFVzZWQgZm9yIGJ1aWx0LWluIG1ldGhvZCByZWZlcmVuY2VzLiAqL1xudmFyIG9iamVjdFByb3RvID0gT2JqZWN0LnByb3RvdHlwZTtcblxuLyoqIFVzZWQgdG8gY2hlY2sgb2JqZWN0cyBmb3Igb3duIHByb3BlcnRpZXMuICovXG52YXIgaGFzT3duUHJvcGVydHkgPSBvYmplY3RQcm90by5oYXNPd25Qcm9wZXJ0eTtcblxuLyoqIEJ1aWx0LWluIHZhbHVlIHJlZmVyZW5jZXMuICovXG52YXIgcHJvcGVydHlJc0VudW1lcmFibGUgPSBvYmplY3RQcm90by5wcm9wZXJ0eUlzRW51bWVyYWJsZTtcblxuLyoqXG4gKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBsaWtlbHkgYW4gYGFyZ3VtZW50c2Agb2JqZWN0LlxuICpcbiAqIEBzdGF0aWNcbiAqIEBtZW1iZXJPZiBfXG4gKiBAc2luY2UgMC4xLjBcbiAqIEBjYXRlZ29yeSBMYW5nXG4gKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGFuIGBhcmd1bWVudHNgIG9iamVjdCxcbiAqICBlbHNlIGBmYWxzZWAuXG4gKiBAZXhhbXBsZVxuICpcbiAqIF8uaXNBcmd1bWVudHMoZnVuY3Rpb24oKSB7IHJldHVybiBhcmd1bWVudHM7IH0oKSk7XG4gKiAvLyA9PiB0cnVlXG4gKlxuICogXy5pc0FyZ3VtZW50cyhbMSwgMiwgM10pO1xuICogLy8gPT4gZmFsc2VcbiAqL1xudmFyIGlzQXJndW1lbnRzID0gYmFzZUlzQXJndW1lbnRzKGZ1bmN0aW9uKCkgeyByZXR1cm4gYXJndW1lbnRzOyB9KCkpID8gYmFzZUlzQXJndW1lbnRzIDogZnVuY3Rpb24odmFsdWUpIHtcbiAgcmV0dXJuIGlzT2JqZWN0TGlrZSh2YWx1ZSkgJiYgaGFzT3duUHJvcGVydHkuY2FsbCh2YWx1ZSwgJ2NhbGxlZScpICYmXG4gICAgIXByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwodmFsdWUsICdjYWxsZWUnKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gaXNBcmd1bWVudHM7XG4iLCIvKipcbiAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGNsYXNzaWZpZWQgYXMgYW4gYEFycmF5YCBvYmplY3QuXG4gKlxuICogQHN0YXRpY1xuICogQG1lbWJlck9mIF9cbiAqIEBzaW5jZSAwLjEuMFxuICogQGNhdGVnb3J5IExhbmdcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgYW4gYXJyYXksIGVsc2UgYGZhbHNlYC5cbiAqIEBleGFtcGxlXG4gKlxuICogXy5pc0FycmF5KFsxLCAyLCAzXSk7XG4gKiAvLyA9PiB0cnVlXG4gKlxuICogXy5pc0FycmF5KGRvY3VtZW50LmJvZHkuY2hpbGRyZW4pO1xuICogLy8gPT4gZmFsc2VcbiAqXG4gKiBfLmlzQXJyYXkoJ2FiYycpO1xuICogLy8gPT4gZmFsc2VcbiAqXG4gKiBfLmlzQXJyYXkoXy5ub29wKTtcbiAqIC8vID0+IGZhbHNlXG4gKi9cbnZhciBpc0FycmF5ID0gQXJyYXkuaXNBcnJheTtcblxubW9kdWxlLmV4cG9ydHMgPSBpc0FycmF5O1xuIiwidmFyIGlzRnVuY3Rpb24gPSByZXF1aXJlKCcuL2lzRnVuY3Rpb24nKSxcbiAgICBpc0xlbmd0aCA9IHJlcXVpcmUoJy4vaXNMZW5ndGgnKTtcblxuLyoqXG4gKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBhcnJheS1saWtlLiBBIHZhbHVlIGlzIGNvbnNpZGVyZWQgYXJyYXktbGlrZSBpZiBpdCdzXG4gKiBub3QgYSBmdW5jdGlvbiBhbmQgaGFzIGEgYHZhbHVlLmxlbmd0aGAgdGhhdCdzIGFuIGludGVnZXIgZ3JlYXRlciB0aGFuIG9yXG4gKiBlcXVhbCB0byBgMGAgYW5kIGxlc3MgdGhhbiBvciBlcXVhbCB0byBgTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVJgLlxuICpcbiAqIEBzdGF0aWNcbiAqIEBtZW1iZXJPZiBfXG4gKiBAc2luY2UgNC4wLjBcbiAqIEBjYXRlZ29yeSBMYW5nXG4gKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGFycmF5LWxpa2UsIGVsc2UgYGZhbHNlYC5cbiAqIEBleGFtcGxlXG4gKlxuICogXy5pc0FycmF5TGlrZShbMSwgMiwgM10pO1xuICogLy8gPT4gdHJ1ZVxuICpcbiAqIF8uaXNBcnJheUxpa2UoZG9jdW1lbnQuYm9keS5jaGlsZHJlbik7XG4gKiAvLyA9PiB0cnVlXG4gKlxuICogXy5pc0FycmF5TGlrZSgnYWJjJyk7XG4gKiAvLyA9PiB0cnVlXG4gKlxuICogXy5pc0FycmF5TGlrZShfLm5vb3ApO1xuICogLy8gPT4gZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNBcnJheUxpa2UodmFsdWUpIHtcbiAgcmV0dXJuIHZhbHVlICE9IG51bGwgJiYgaXNMZW5ndGgodmFsdWUubGVuZ3RoKSAmJiAhaXNGdW5jdGlvbih2YWx1ZSk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gaXNBcnJheUxpa2U7XG4iLCJ2YXIgcm9vdCA9IHJlcXVpcmUoJy4vX3Jvb3QnKSxcbiAgICBzdHViRmFsc2UgPSByZXF1aXJlKCcuL3N0dWJGYWxzZScpO1xuXG4vKiogRGV0ZWN0IGZyZWUgdmFyaWFibGUgYGV4cG9ydHNgLiAqL1xudmFyIGZyZWVFeHBvcnRzID0gdHlwZW9mIGV4cG9ydHMgPT0gJ29iamVjdCcgJiYgZXhwb3J0cyAmJiAhZXhwb3J0cy5ub2RlVHlwZSAmJiBleHBvcnRzO1xuXG4vKiogRGV0ZWN0IGZyZWUgdmFyaWFibGUgYG1vZHVsZWAuICovXG52YXIgZnJlZU1vZHVsZSA9IGZyZWVFeHBvcnRzICYmIHR5cGVvZiBtb2R1bGUgPT0gJ29iamVjdCcgJiYgbW9kdWxlICYmICFtb2R1bGUubm9kZVR5cGUgJiYgbW9kdWxlO1xuXG4vKiogRGV0ZWN0IHRoZSBwb3B1bGFyIENvbW1vbkpTIGV4dGVuc2lvbiBgbW9kdWxlLmV4cG9ydHNgLiAqL1xudmFyIG1vZHVsZUV4cG9ydHMgPSBmcmVlTW9kdWxlICYmIGZyZWVNb2R1bGUuZXhwb3J0cyA9PT0gZnJlZUV4cG9ydHM7XG5cbi8qKiBCdWlsdC1pbiB2YWx1ZSByZWZlcmVuY2VzLiAqL1xudmFyIEJ1ZmZlciA9IG1vZHVsZUV4cG9ydHMgPyByb290LkJ1ZmZlciA6IHVuZGVmaW5lZDtcblxuLyogQnVpbHQtaW4gbWV0aG9kIHJlZmVyZW5jZXMgZm9yIHRob3NlIHdpdGggdGhlIHNhbWUgbmFtZSBhcyBvdGhlciBgbG9kYXNoYCBtZXRob2RzLiAqL1xudmFyIG5hdGl2ZUlzQnVmZmVyID0gQnVmZmVyID8gQnVmZmVyLmlzQnVmZmVyIDogdW5kZWZpbmVkO1xuXG4vKipcbiAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGEgYnVmZmVyLlxuICpcbiAqIEBzdGF0aWNcbiAqIEBtZW1iZXJPZiBfXG4gKiBAc2luY2UgNC4zLjBcbiAqIEBjYXRlZ29yeSBMYW5nXG4gKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGEgYnVmZmVyLCBlbHNlIGBmYWxzZWAuXG4gKiBAZXhhbXBsZVxuICpcbiAqIF8uaXNCdWZmZXIobmV3IEJ1ZmZlcigyKSk7XG4gKiAvLyA9PiB0cnVlXG4gKlxuICogXy5pc0J1ZmZlcihuZXcgVWludDhBcnJheSgyKSk7XG4gKiAvLyA9PiBmYWxzZVxuICovXG52YXIgaXNCdWZmZXIgPSBuYXRpdmVJc0J1ZmZlciB8fCBzdHViRmFsc2U7XG5cbm1vZHVsZS5leHBvcnRzID0gaXNCdWZmZXI7XG4iLCJ2YXIgYmFzZUtleXMgPSByZXF1aXJlKCcuL19iYXNlS2V5cycpLFxuICAgIGdldFRhZyA9IHJlcXVpcmUoJy4vX2dldFRhZycpLFxuICAgIGlzQXJndW1lbnRzID0gcmVxdWlyZSgnLi9pc0FyZ3VtZW50cycpLFxuICAgIGlzQXJyYXkgPSByZXF1aXJlKCcuL2lzQXJyYXknKSxcbiAgICBpc0FycmF5TGlrZSA9IHJlcXVpcmUoJy4vaXNBcnJheUxpa2UnKSxcbiAgICBpc0J1ZmZlciA9IHJlcXVpcmUoJy4vaXNCdWZmZXInKSxcbiAgICBpc1Byb3RvdHlwZSA9IHJlcXVpcmUoJy4vX2lzUHJvdG90eXBlJyksXG4gICAgaXNUeXBlZEFycmF5ID0gcmVxdWlyZSgnLi9pc1R5cGVkQXJyYXknKTtcblxuLyoqIGBPYmplY3QjdG9TdHJpbmdgIHJlc3VsdCByZWZlcmVuY2VzLiAqL1xudmFyIG1hcFRhZyA9ICdbb2JqZWN0IE1hcF0nLFxuICAgIHNldFRhZyA9ICdbb2JqZWN0IFNldF0nO1xuXG4vKiogVXNlZCBmb3IgYnVpbHQtaW4gbWV0aG9kIHJlZmVyZW5jZXMuICovXG52YXIgb2JqZWN0UHJvdG8gPSBPYmplY3QucHJvdG90eXBlO1xuXG4vKiogVXNlZCB0byBjaGVjayBvYmplY3RzIGZvciBvd24gcHJvcGVydGllcy4gKi9cbnZhciBoYXNPd25Qcm9wZXJ0eSA9IG9iamVjdFByb3RvLmhhc093blByb3BlcnR5O1xuXG4vKipcbiAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGFuIGVtcHR5IG9iamVjdCwgY29sbGVjdGlvbiwgbWFwLCBvciBzZXQuXG4gKlxuICogT2JqZWN0cyBhcmUgY29uc2lkZXJlZCBlbXB0eSBpZiB0aGV5IGhhdmUgbm8gb3duIGVudW1lcmFibGUgc3RyaW5nIGtleWVkXG4gKiBwcm9wZXJ0aWVzLlxuICpcbiAqIEFycmF5LWxpa2UgdmFsdWVzIHN1Y2ggYXMgYGFyZ3VtZW50c2Agb2JqZWN0cywgYXJyYXlzLCBidWZmZXJzLCBzdHJpbmdzLCBvclxuICogalF1ZXJ5LWxpa2UgY29sbGVjdGlvbnMgYXJlIGNvbnNpZGVyZWQgZW1wdHkgaWYgdGhleSBoYXZlIGEgYGxlbmd0aGAgb2YgYDBgLlxuICogU2ltaWxhcmx5LCBtYXBzIGFuZCBzZXRzIGFyZSBjb25zaWRlcmVkIGVtcHR5IGlmIHRoZXkgaGF2ZSBhIGBzaXplYCBvZiBgMGAuXG4gKlxuICogQHN0YXRpY1xuICogQG1lbWJlck9mIF9cbiAqIEBzaW5jZSAwLjEuMFxuICogQGNhdGVnb3J5IExhbmdcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgZW1wdHksIGVsc2UgYGZhbHNlYC5cbiAqIEBleGFtcGxlXG4gKlxuICogXy5pc0VtcHR5KG51bGwpO1xuICogLy8gPT4gdHJ1ZVxuICpcbiAqIF8uaXNFbXB0eSh0cnVlKTtcbiAqIC8vID0+IHRydWVcbiAqXG4gKiBfLmlzRW1wdHkoMSk7XG4gKiAvLyA9PiB0cnVlXG4gKlxuICogXy5pc0VtcHR5KFsxLCAyLCAzXSk7XG4gKiAvLyA9PiBmYWxzZVxuICpcbiAqIF8uaXNFbXB0eSh7ICdhJzogMSB9KTtcbiAqIC8vID0+IGZhbHNlXG4gKi9cbmZ1bmN0aW9uIGlzRW1wdHkodmFsdWUpIHtcbiAgaWYgKHZhbHVlID09IG51bGwpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICBpZiAoaXNBcnJheUxpa2UodmFsdWUpICYmXG4gICAgICAoaXNBcnJheSh2YWx1ZSkgfHwgdHlwZW9mIHZhbHVlID09ICdzdHJpbmcnIHx8IHR5cGVvZiB2YWx1ZS5zcGxpY2UgPT0gJ2Z1bmN0aW9uJyB8fFxuICAgICAgICBpc0J1ZmZlcih2YWx1ZSkgfHwgaXNUeXBlZEFycmF5KHZhbHVlKSB8fCBpc0FyZ3VtZW50cyh2YWx1ZSkpKSB7XG4gICAgcmV0dXJuICF2YWx1ZS5sZW5ndGg7XG4gIH1cbiAgdmFyIHRhZyA9IGdldFRhZyh2YWx1ZSk7XG4gIGlmICh0YWcgPT0gbWFwVGFnIHx8IHRhZyA9PSBzZXRUYWcpIHtcbiAgICByZXR1cm4gIXZhbHVlLnNpemU7XG4gIH1cbiAgaWYgKGlzUHJvdG90eXBlKHZhbHVlKSkge1xuICAgIHJldHVybiAhYmFzZUtleXModmFsdWUpLmxlbmd0aDtcbiAgfVxuICBmb3IgKHZhciBrZXkgaW4gdmFsdWUpIHtcbiAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbCh2YWx1ZSwga2V5KSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gdHJ1ZTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBpc0VtcHR5O1xuIiwidmFyIGJhc2VHZXRUYWcgPSByZXF1aXJlKCcuL19iYXNlR2V0VGFnJyksXG4gICAgaXNPYmplY3QgPSByZXF1aXJlKCcuL2lzT2JqZWN0Jyk7XG5cbi8qKiBgT2JqZWN0I3RvU3RyaW5nYCByZXN1bHQgcmVmZXJlbmNlcy4gKi9cbnZhciBhc3luY1RhZyA9ICdbb2JqZWN0IEFzeW5jRnVuY3Rpb25dJyxcbiAgICBmdW5jVGFnID0gJ1tvYmplY3QgRnVuY3Rpb25dJyxcbiAgICBnZW5UYWcgPSAnW29iamVjdCBHZW5lcmF0b3JGdW5jdGlvbl0nLFxuICAgIHByb3h5VGFnID0gJ1tvYmplY3QgUHJveHldJztcblxuLyoqXG4gKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBjbGFzc2lmaWVkIGFzIGEgYEZ1bmN0aW9uYCBvYmplY3QuXG4gKlxuICogQHN0YXRpY1xuICogQG1lbWJlck9mIF9cbiAqIEBzaW5jZSAwLjEuMFxuICogQGNhdGVnb3J5IExhbmdcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgYSBmdW5jdGlvbiwgZWxzZSBgZmFsc2VgLlxuICogQGV4YW1wbGVcbiAqXG4gKiBfLmlzRnVuY3Rpb24oXyk7XG4gKiAvLyA9PiB0cnVlXG4gKlxuICogXy5pc0Z1bmN0aW9uKC9hYmMvKTtcbiAqIC8vID0+IGZhbHNlXG4gKi9cbmZ1bmN0aW9uIGlzRnVuY3Rpb24odmFsdWUpIHtcbiAgaWYgKCFpc09iamVjdCh2YWx1ZSkpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgLy8gVGhlIHVzZSBvZiBgT2JqZWN0I3RvU3RyaW5nYCBhdm9pZHMgaXNzdWVzIHdpdGggdGhlIGB0eXBlb2ZgIG9wZXJhdG9yXG4gIC8vIGluIFNhZmFyaSA5IHdoaWNoIHJldHVybnMgJ29iamVjdCcgZm9yIHR5cGVkIGFycmF5cyBhbmQgb3RoZXIgY29uc3RydWN0b3JzLlxuICB2YXIgdGFnID0gYmFzZUdldFRhZyh2YWx1ZSk7XG4gIHJldHVybiB0YWcgPT0gZnVuY1RhZyB8fCB0YWcgPT0gZ2VuVGFnIHx8IHRhZyA9PSBhc3luY1RhZyB8fCB0YWcgPT0gcHJveHlUYWc7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gaXNGdW5jdGlvbjtcbiIsIi8qKiBVc2VkIGFzIHJlZmVyZW5jZXMgZm9yIHZhcmlvdXMgYE51bWJlcmAgY29uc3RhbnRzLiAqL1xudmFyIE1BWF9TQUZFX0lOVEVHRVIgPSA5MDA3MTk5MjU0NzQwOTkxO1xuXG4vKipcbiAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGEgdmFsaWQgYXJyYXktbGlrZSBsZW5ndGguXG4gKlxuICogKipOb3RlOioqIFRoaXMgbWV0aG9kIGlzIGxvb3NlbHkgYmFzZWQgb25cbiAqIFtgVG9MZW5ndGhgXShodHRwOi8vZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi83LjAvI3NlYy10b2xlbmd0aCkuXG4gKlxuICogQHN0YXRpY1xuICogQG1lbWJlck9mIF9cbiAqIEBzaW5jZSA0LjAuMFxuICogQGNhdGVnb3J5IExhbmdcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgYSB2YWxpZCBsZW5ndGgsIGVsc2UgYGZhbHNlYC5cbiAqIEBleGFtcGxlXG4gKlxuICogXy5pc0xlbmd0aCgzKTtcbiAqIC8vID0+IHRydWVcbiAqXG4gKiBfLmlzTGVuZ3RoKE51bWJlci5NSU5fVkFMVUUpO1xuICogLy8gPT4gZmFsc2VcbiAqXG4gKiBfLmlzTGVuZ3RoKEluZmluaXR5KTtcbiAqIC8vID0+IGZhbHNlXG4gKlxuICogXy5pc0xlbmd0aCgnMycpO1xuICogLy8gPT4gZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNMZW5ndGgodmFsdWUpIHtcbiAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PSAnbnVtYmVyJyAmJlxuICAgIHZhbHVlID4gLTEgJiYgdmFsdWUgJSAxID09IDAgJiYgdmFsdWUgPD0gTUFYX1NBRkVfSU5URUdFUjtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBpc0xlbmd0aDtcbiIsInZhciBiYXNlR2V0VGFnID0gcmVxdWlyZSgnLi9fYmFzZUdldFRhZycpLFxuICAgIGlzT2JqZWN0TGlrZSA9IHJlcXVpcmUoJy4vaXNPYmplY3RMaWtlJyk7XG5cbi8qKiBgT2JqZWN0I3RvU3RyaW5nYCByZXN1bHQgcmVmZXJlbmNlcy4gKi9cbnZhciBudW1iZXJUYWcgPSAnW29iamVjdCBOdW1iZXJdJztcblxuLyoqXG4gKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBjbGFzc2lmaWVkIGFzIGEgYE51bWJlcmAgcHJpbWl0aXZlIG9yIG9iamVjdC5cbiAqXG4gKiAqKk5vdGU6KiogVG8gZXhjbHVkZSBgSW5maW5pdHlgLCBgLUluZmluaXR5YCwgYW5kIGBOYU5gLCB3aGljaCBhcmVcbiAqIGNsYXNzaWZpZWQgYXMgbnVtYmVycywgdXNlIHRoZSBgXy5pc0Zpbml0ZWAgbWV0aG9kLlxuICpcbiAqIEBzdGF0aWNcbiAqIEBtZW1iZXJPZiBfXG4gKiBAc2luY2UgMC4xLjBcbiAqIEBjYXRlZ29yeSBMYW5nXG4gKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGEgbnVtYmVyLCBlbHNlIGBmYWxzZWAuXG4gKiBAZXhhbXBsZVxuICpcbiAqIF8uaXNOdW1iZXIoMyk7XG4gKiAvLyA9PiB0cnVlXG4gKlxuICogXy5pc051bWJlcihOdW1iZXIuTUlOX1ZBTFVFKTtcbiAqIC8vID0+IHRydWVcbiAqXG4gKiBfLmlzTnVtYmVyKEluZmluaXR5KTtcbiAqIC8vID0+IHRydWVcbiAqXG4gKiBfLmlzTnVtYmVyKCczJyk7XG4gKiAvLyA9PiBmYWxzZVxuICovXG5mdW5jdGlvbiBpc051bWJlcih2YWx1ZSkge1xuICByZXR1cm4gdHlwZW9mIHZhbHVlID09ICdudW1iZXInIHx8XG4gICAgKGlzT2JqZWN0TGlrZSh2YWx1ZSkgJiYgYmFzZUdldFRhZyh2YWx1ZSkgPT0gbnVtYmVyVGFnKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBpc051bWJlcjtcbiIsIi8qKlxuICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgdGhlXG4gKiBbbGFuZ3VhZ2UgdHlwZV0oaHR0cDovL3d3dy5lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzcuMC8jc2VjLWVjbWFzY3JpcHQtbGFuZ3VhZ2UtdHlwZXMpXG4gKiBvZiBgT2JqZWN0YC4gKGUuZy4gYXJyYXlzLCBmdW5jdGlvbnMsIG9iamVjdHMsIHJlZ2V4ZXMsIGBuZXcgTnVtYmVyKDApYCwgYW5kIGBuZXcgU3RyaW5nKCcnKWApXG4gKlxuICogQHN0YXRpY1xuICogQG1lbWJlck9mIF9cbiAqIEBzaW5jZSAwLjEuMFxuICogQGNhdGVnb3J5IExhbmdcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgYW4gb2JqZWN0LCBlbHNlIGBmYWxzZWAuXG4gKiBAZXhhbXBsZVxuICpcbiAqIF8uaXNPYmplY3Qoe30pO1xuICogLy8gPT4gdHJ1ZVxuICpcbiAqIF8uaXNPYmplY3QoWzEsIDIsIDNdKTtcbiAqIC8vID0+IHRydWVcbiAqXG4gKiBfLmlzT2JqZWN0KF8ubm9vcCk7XG4gKiAvLyA9PiB0cnVlXG4gKlxuICogXy5pc09iamVjdChudWxsKTtcbiAqIC8vID0+IGZhbHNlXG4gKi9cbmZ1bmN0aW9uIGlzT2JqZWN0KHZhbHVlKSB7XG4gIHZhciB0eXBlID0gdHlwZW9mIHZhbHVlO1xuICByZXR1cm4gdmFsdWUgIT0gbnVsbCAmJiAodHlwZSA9PSAnb2JqZWN0JyB8fCB0eXBlID09ICdmdW5jdGlvbicpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGlzT2JqZWN0O1xuIiwiLyoqXG4gKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBvYmplY3QtbGlrZS4gQSB2YWx1ZSBpcyBvYmplY3QtbGlrZSBpZiBpdCdzIG5vdCBgbnVsbGBcbiAqIGFuZCBoYXMgYSBgdHlwZW9mYCByZXN1bHQgb2YgXCJvYmplY3RcIi5cbiAqXG4gKiBAc3RhdGljXG4gKiBAbWVtYmVyT2YgX1xuICogQHNpbmNlIDQuMC4wXG4gKiBAY2F0ZWdvcnkgTGFuZ1xuICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBvYmplY3QtbGlrZSwgZWxzZSBgZmFsc2VgLlxuICogQGV4YW1wbGVcbiAqXG4gKiBfLmlzT2JqZWN0TGlrZSh7fSk7XG4gKiAvLyA9PiB0cnVlXG4gKlxuICogXy5pc09iamVjdExpa2UoWzEsIDIsIDNdKTtcbiAqIC8vID0+IHRydWVcbiAqXG4gKiBfLmlzT2JqZWN0TGlrZShfLm5vb3ApO1xuICogLy8gPT4gZmFsc2VcbiAqXG4gKiBfLmlzT2JqZWN0TGlrZShudWxsKTtcbiAqIC8vID0+IGZhbHNlXG4gKi9cbmZ1bmN0aW9uIGlzT2JqZWN0TGlrZSh2YWx1ZSkge1xuICByZXR1cm4gdmFsdWUgIT0gbnVsbCAmJiB0eXBlb2YgdmFsdWUgPT0gJ29iamVjdCc7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gaXNPYmplY3RMaWtlO1xuIiwidmFyIGJhc2VHZXRUYWcgPSByZXF1aXJlKCcuL19iYXNlR2V0VGFnJyksXG4gICAgZ2V0UHJvdG90eXBlID0gcmVxdWlyZSgnLi9fZ2V0UHJvdG90eXBlJyksXG4gICAgaXNPYmplY3RMaWtlID0gcmVxdWlyZSgnLi9pc09iamVjdExpa2UnKTtcblxuLyoqIGBPYmplY3QjdG9TdHJpbmdgIHJlc3VsdCByZWZlcmVuY2VzLiAqL1xudmFyIG9iamVjdFRhZyA9ICdbb2JqZWN0IE9iamVjdF0nO1xuXG4vKiogVXNlZCBmb3IgYnVpbHQtaW4gbWV0aG9kIHJlZmVyZW5jZXMuICovXG52YXIgZnVuY1Byb3RvID0gRnVuY3Rpb24ucHJvdG90eXBlLFxuICAgIG9iamVjdFByb3RvID0gT2JqZWN0LnByb3RvdHlwZTtcblxuLyoqIFVzZWQgdG8gcmVzb2x2ZSB0aGUgZGVjb21waWxlZCBzb3VyY2Ugb2YgZnVuY3Rpb25zLiAqL1xudmFyIGZ1bmNUb1N0cmluZyA9IGZ1bmNQcm90by50b1N0cmluZztcblxuLyoqIFVzZWQgdG8gY2hlY2sgb2JqZWN0cyBmb3Igb3duIHByb3BlcnRpZXMuICovXG52YXIgaGFzT3duUHJvcGVydHkgPSBvYmplY3RQcm90by5oYXNPd25Qcm9wZXJ0eTtcblxuLyoqIFVzZWQgdG8gaW5mZXIgdGhlIGBPYmplY3RgIGNvbnN0cnVjdG9yLiAqL1xudmFyIG9iamVjdEN0b3JTdHJpbmcgPSBmdW5jVG9TdHJpbmcuY2FsbChPYmplY3QpO1xuXG4vKipcbiAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGEgcGxhaW4gb2JqZWN0LCB0aGF0IGlzLCBhbiBvYmplY3QgY3JlYXRlZCBieSB0aGVcbiAqIGBPYmplY3RgIGNvbnN0cnVjdG9yIG9yIG9uZSB3aXRoIGEgYFtbUHJvdG90eXBlXV1gIG9mIGBudWxsYC5cbiAqXG4gKiBAc3RhdGljXG4gKiBAbWVtYmVyT2YgX1xuICogQHNpbmNlIDAuOC4wXG4gKiBAY2F0ZWdvcnkgTGFuZ1xuICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBhIHBsYWluIG9iamVjdCwgZWxzZSBgZmFsc2VgLlxuICogQGV4YW1wbGVcbiAqXG4gKiBmdW5jdGlvbiBGb28oKSB7XG4gKiAgIHRoaXMuYSA9IDE7XG4gKiB9XG4gKlxuICogXy5pc1BsYWluT2JqZWN0KG5ldyBGb28pO1xuICogLy8gPT4gZmFsc2VcbiAqXG4gKiBfLmlzUGxhaW5PYmplY3QoWzEsIDIsIDNdKTtcbiAqIC8vID0+IGZhbHNlXG4gKlxuICogXy5pc1BsYWluT2JqZWN0KHsgJ3gnOiAwLCAneSc6IDAgfSk7XG4gKiAvLyA9PiB0cnVlXG4gKlxuICogXy5pc1BsYWluT2JqZWN0KE9iamVjdC5jcmVhdGUobnVsbCkpO1xuICogLy8gPT4gdHJ1ZVxuICovXG5mdW5jdGlvbiBpc1BsYWluT2JqZWN0KHZhbHVlKSB7XG4gIGlmICghaXNPYmplY3RMaWtlKHZhbHVlKSB8fCBiYXNlR2V0VGFnKHZhbHVlKSAhPSBvYmplY3RUYWcpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgdmFyIHByb3RvID0gZ2V0UHJvdG90eXBlKHZhbHVlKTtcbiAgaWYgKHByb3RvID09PSBudWxsKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgdmFyIEN0b3IgPSBoYXNPd25Qcm9wZXJ0eS5jYWxsKHByb3RvLCAnY29uc3RydWN0b3InKSAmJiBwcm90by5jb25zdHJ1Y3RvcjtcbiAgcmV0dXJuIHR5cGVvZiBDdG9yID09ICdmdW5jdGlvbicgJiYgQ3RvciBpbnN0YW5jZW9mIEN0b3IgJiZcbiAgICBmdW5jVG9TdHJpbmcuY2FsbChDdG9yKSA9PSBvYmplY3RDdG9yU3RyaW5nO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGlzUGxhaW5PYmplY3Q7XG4iLCJ2YXIgYmFzZUdldFRhZyA9IHJlcXVpcmUoJy4vX2Jhc2VHZXRUYWcnKSxcbiAgICBpc0FycmF5ID0gcmVxdWlyZSgnLi9pc0FycmF5JyksXG4gICAgaXNPYmplY3RMaWtlID0gcmVxdWlyZSgnLi9pc09iamVjdExpa2UnKTtcblxuLyoqIGBPYmplY3QjdG9TdHJpbmdgIHJlc3VsdCByZWZlcmVuY2VzLiAqL1xudmFyIHN0cmluZ1RhZyA9ICdbb2JqZWN0IFN0cmluZ10nO1xuXG4vKipcbiAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGNsYXNzaWZpZWQgYXMgYSBgU3RyaW5nYCBwcmltaXRpdmUgb3Igb2JqZWN0LlxuICpcbiAqIEBzdGF0aWNcbiAqIEBzaW5jZSAwLjEuMFxuICogQG1lbWJlck9mIF9cbiAqIEBjYXRlZ29yeSBMYW5nXG4gKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGEgc3RyaW5nLCBlbHNlIGBmYWxzZWAuXG4gKiBAZXhhbXBsZVxuICpcbiAqIF8uaXNTdHJpbmcoJ2FiYycpO1xuICogLy8gPT4gdHJ1ZVxuICpcbiAqIF8uaXNTdHJpbmcoMSk7XG4gKiAvLyA9PiBmYWxzZVxuICovXG5mdW5jdGlvbiBpc1N0cmluZyh2YWx1ZSkge1xuICByZXR1cm4gdHlwZW9mIHZhbHVlID09ICdzdHJpbmcnIHx8XG4gICAgKCFpc0FycmF5KHZhbHVlKSAmJiBpc09iamVjdExpa2UodmFsdWUpICYmIGJhc2VHZXRUYWcodmFsdWUpID09IHN0cmluZ1RhZyk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gaXNTdHJpbmc7XG4iLCJ2YXIgYmFzZUdldFRhZyA9IHJlcXVpcmUoJy4vX2Jhc2VHZXRUYWcnKSxcbiAgICBpc09iamVjdExpa2UgPSByZXF1aXJlKCcuL2lzT2JqZWN0TGlrZScpO1xuXG4vKiogYE9iamVjdCN0b1N0cmluZ2AgcmVzdWx0IHJlZmVyZW5jZXMuICovXG52YXIgc3ltYm9sVGFnID0gJ1tvYmplY3QgU3ltYm9sXSc7XG5cbi8qKlxuICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgY2xhc3NpZmllZCBhcyBhIGBTeW1ib2xgIHByaW1pdGl2ZSBvciBvYmplY3QuXG4gKlxuICogQHN0YXRpY1xuICogQG1lbWJlck9mIF9cbiAqIEBzaW5jZSA0LjAuMFxuICogQGNhdGVnb3J5IExhbmdcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgYSBzeW1ib2wsIGVsc2UgYGZhbHNlYC5cbiAqIEBleGFtcGxlXG4gKlxuICogXy5pc1N5bWJvbChTeW1ib2wuaXRlcmF0b3IpO1xuICogLy8gPT4gdHJ1ZVxuICpcbiAqIF8uaXNTeW1ib2woJ2FiYycpO1xuICogLy8gPT4gZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNTeW1ib2wodmFsdWUpIHtcbiAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PSAnc3ltYm9sJyB8fFxuICAgIChpc09iamVjdExpa2UodmFsdWUpICYmIGJhc2VHZXRUYWcodmFsdWUpID09IHN5bWJvbFRhZyk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gaXNTeW1ib2w7XG4iLCJ2YXIgYmFzZUlzVHlwZWRBcnJheSA9IHJlcXVpcmUoJy4vX2Jhc2VJc1R5cGVkQXJyYXknKSxcbiAgICBiYXNlVW5hcnkgPSByZXF1aXJlKCcuL19iYXNlVW5hcnknKSxcbiAgICBub2RlVXRpbCA9IHJlcXVpcmUoJy4vX25vZGVVdGlsJyk7XG5cbi8qIE5vZGUuanMgaGVscGVyIHJlZmVyZW5jZXMuICovXG52YXIgbm9kZUlzVHlwZWRBcnJheSA9IG5vZGVVdGlsICYmIG5vZGVVdGlsLmlzVHlwZWRBcnJheTtcblxuLyoqXG4gKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBjbGFzc2lmaWVkIGFzIGEgdHlwZWQgYXJyYXkuXG4gKlxuICogQHN0YXRpY1xuICogQG1lbWJlck9mIF9cbiAqIEBzaW5jZSAzLjAuMFxuICogQGNhdGVnb3J5IExhbmdcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgYSB0eXBlZCBhcnJheSwgZWxzZSBgZmFsc2VgLlxuICogQGV4YW1wbGVcbiAqXG4gKiBfLmlzVHlwZWRBcnJheShuZXcgVWludDhBcnJheSk7XG4gKiAvLyA9PiB0cnVlXG4gKlxuICogXy5pc1R5cGVkQXJyYXkoW10pO1xuICogLy8gPT4gZmFsc2VcbiAqL1xudmFyIGlzVHlwZWRBcnJheSA9IG5vZGVJc1R5cGVkQXJyYXkgPyBiYXNlVW5hcnkobm9kZUlzVHlwZWRBcnJheSkgOiBiYXNlSXNUeXBlZEFycmF5O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGlzVHlwZWRBcnJheTtcbiIsIi8qKlxuICogVGhpcyBtZXRob2QgcmV0dXJucyBgZmFsc2VgLlxuICpcbiAqIEBzdGF0aWNcbiAqIEBtZW1iZXJPZiBfXG4gKiBAc2luY2UgNC4xMy4wXG4gKiBAY2F0ZWdvcnkgVXRpbFxuICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYGZhbHNlYC5cbiAqIEBleGFtcGxlXG4gKlxuICogXy50aW1lcygyLCBfLnN0dWJGYWxzZSk7XG4gKiAvLyA9PiBbZmFsc2UsIGZhbHNlXVxuICovXG5mdW5jdGlvbiBzdHViRmFsc2UoKSB7XG4gIHJldHVybiBmYWxzZTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBzdHViRmFsc2U7XG4iLCJ2YXIgYmFzZVRpbWVzID0gcmVxdWlyZSgnLi9fYmFzZVRpbWVzJyksXG4gICAgY2FzdEZ1bmN0aW9uID0gcmVxdWlyZSgnLi9fY2FzdEZ1bmN0aW9uJyksXG4gICAgdG9JbnRlZ2VyID0gcmVxdWlyZSgnLi90b0ludGVnZXInKTtcblxuLyoqIFVzZWQgYXMgcmVmZXJlbmNlcyBmb3IgdmFyaW91cyBgTnVtYmVyYCBjb25zdGFudHMuICovXG52YXIgTUFYX1NBRkVfSU5URUdFUiA9IDkwMDcxOTkyNTQ3NDA5OTE7XG5cbi8qKiBVc2VkIGFzIHJlZmVyZW5jZXMgZm9yIHRoZSBtYXhpbXVtIGxlbmd0aCBhbmQgaW5kZXggb2YgYW4gYXJyYXkuICovXG52YXIgTUFYX0FSUkFZX0xFTkdUSCA9IDQyOTQ5NjcyOTU7XG5cbi8qIEJ1aWx0LWluIG1ldGhvZCByZWZlcmVuY2VzIGZvciB0aG9zZSB3aXRoIHRoZSBzYW1lIG5hbWUgYXMgb3RoZXIgYGxvZGFzaGAgbWV0aG9kcy4gKi9cbnZhciBuYXRpdmVNaW4gPSBNYXRoLm1pbjtcblxuLyoqXG4gKiBJbnZva2VzIHRoZSBpdGVyYXRlZSBgbmAgdGltZXMsIHJldHVybmluZyBhbiBhcnJheSBvZiB0aGUgcmVzdWx0cyBvZlxuICogZWFjaCBpbnZvY2F0aW9uLiBUaGUgaXRlcmF0ZWUgaXMgaW52b2tlZCB3aXRoIG9uZSBhcmd1bWVudDsgKGluZGV4KS5cbiAqXG4gKiBAc3RhdGljXG4gKiBAc2luY2UgMC4xLjBcbiAqIEBtZW1iZXJPZiBfXG4gKiBAY2F0ZWdvcnkgVXRpbFxuICogQHBhcmFtIHtudW1iZXJ9IG4gVGhlIG51bWJlciBvZiB0aW1lcyB0byBpbnZva2UgYGl0ZXJhdGVlYC5cbiAqIEBwYXJhbSB7RnVuY3Rpb259IFtpdGVyYXRlZT1fLmlkZW50aXR5XSBUaGUgZnVuY3Rpb24gaW52b2tlZCBwZXIgaXRlcmF0aW9uLlxuICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBhcnJheSBvZiByZXN1bHRzLlxuICogQGV4YW1wbGVcbiAqXG4gKiBfLnRpbWVzKDMsIFN0cmluZyk7XG4gKiAvLyA9PiBbJzAnLCAnMScsICcyJ11cbiAqXG4gKiAgXy50aW1lcyg0LCBfLmNvbnN0YW50KDApKTtcbiAqIC8vID0+IFswLCAwLCAwLCAwXVxuICovXG5mdW5jdGlvbiB0aW1lcyhuLCBpdGVyYXRlZSkge1xuICBuID0gdG9JbnRlZ2VyKG4pO1xuICBpZiAobiA8IDEgfHwgbiA+IE1BWF9TQUZFX0lOVEVHRVIpIHtcbiAgICByZXR1cm4gW107XG4gIH1cbiAgdmFyIGluZGV4ID0gTUFYX0FSUkFZX0xFTkdUSCxcbiAgICAgIGxlbmd0aCA9IG5hdGl2ZU1pbihuLCBNQVhfQVJSQVlfTEVOR1RIKTtcblxuICBpdGVyYXRlZSA9IGNhc3RGdW5jdGlvbihpdGVyYXRlZSk7XG4gIG4gLT0gTUFYX0FSUkFZX0xFTkdUSDtcblxuICB2YXIgcmVzdWx0ID0gYmFzZVRpbWVzKGxlbmd0aCwgaXRlcmF0ZWUpO1xuICB3aGlsZSAoKytpbmRleCA8IG4pIHtcbiAgICBpdGVyYXRlZShpbmRleCk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB0aW1lcztcbiIsInZhciB0b051bWJlciA9IHJlcXVpcmUoJy4vdG9OdW1iZXInKTtcblxuLyoqIFVzZWQgYXMgcmVmZXJlbmNlcyBmb3IgdmFyaW91cyBgTnVtYmVyYCBjb25zdGFudHMuICovXG52YXIgSU5GSU5JVFkgPSAxIC8gMCxcbiAgICBNQVhfSU5URUdFUiA9IDEuNzk3NjkzMTM0ODYyMzE1N2UrMzA4O1xuXG4vKipcbiAqIENvbnZlcnRzIGB2YWx1ZWAgdG8gYSBmaW5pdGUgbnVtYmVyLlxuICpcbiAqIEBzdGF0aWNcbiAqIEBtZW1iZXJPZiBfXG4gKiBAc2luY2UgNC4xMi4wXG4gKiBAY2F0ZWdvcnkgTGFuZ1xuICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY29udmVydC5cbiAqIEByZXR1cm5zIHtudW1iZXJ9IFJldHVybnMgdGhlIGNvbnZlcnRlZCBudW1iZXIuXG4gKiBAZXhhbXBsZVxuICpcbiAqIF8udG9GaW5pdGUoMy4yKTtcbiAqIC8vID0+IDMuMlxuICpcbiAqIF8udG9GaW5pdGUoTnVtYmVyLk1JTl9WQUxVRSk7XG4gKiAvLyA9PiA1ZS0zMjRcbiAqXG4gKiBfLnRvRmluaXRlKEluZmluaXR5KTtcbiAqIC8vID0+IDEuNzk3NjkzMTM0ODYyMzE1N2UrMzA4XG4gKlxuICogXy50b0Zpbml0ZSgnMy4yJyk7XG4gKiAvLyA9PiAzLjJcbiAqL1xuZnVuY3Rpb24gdG9GaW5pdGUodmFsdWUpIHtcbiAgaWYgKCF2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZSA9PT0gMCA/IHZhbHVlIDogMDtcbiAgfVxuICB2YWx1ZSA9IHRvTnVtYmVyKHZhbHVlKTtcbiAgaWYgKHZhbHVlID09PSBJTkZJTklUWSB8fCB2YWx1ZSA9PT0gLUlORklOSVRZKSB7XG4gICAgdmFyIHNpZ24gPSAodmFsdWUgPCAwID8gLTEgOiAxKTtcbiAgICByZXR1cm4gc2lnbiAqIE1BWF9JTlRFR0VSO1xuICB9XG4gIHJldHVybiB2YWx1ZSA9PT0gdmFsdWUgPyB2YWx1ZSA6IDA7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gdG9GaW5pdGU7XG4iLCJ2YXIgdG9GaW5pdGUgPSByZXF1aXJlKCcuL3RvRmluaXRlJyk7XG5cbi8qKlxuICogQ29udmVydHMgYHZhbHVlYCB0byBhbiBpbnRlZ2VyLlxuICpcbiAqICoqTm90ZToqKiBUaGlzIG1ldGhvZCBpcyBsb29zZWx5IGJhc2VkIG9uXG4gKiBbYFRvSW50ZWdlcmBdKGh0dHA6Ly93d3cuZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi83LjAvI3NlYy10b2ludGVnZXIpLlxuICpcbiAqIEBzdGF0aWNcbiAqIEBtZW1iZXJPZiBfXG4gKiBAc2luY2UgNC4wLjBcbiAqIEBjYXRlZ29yeSBMYW5nXG4gKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjb252ZXJ0LlxuICogQHJldHVybnMge251bWJlcn0gUmV0dXJucyB0aGUgY29udmVydGVkIGludGVnZXIuXG4gKiBAZXhhbXBsZVxuICpcbiAqIF8udG9JbnRlZ2VyKDMuMik7XG4gKiAvLyA9PiAzXG4gKlxuICogXy50b0ludGVnZXIoTnVtYmVyLk1JTl9WQUxVRSk7XG4gKiAvLyA9PiAwXG4gKlxuICogXy50b0ludGVnZXIoSW5maW5pdHkpO1xuICogLy8gPT4gMS43OTc2OTMxMzQ4NjIzMTU3ZSszMDhcbiAqXG4gKiBfLnRvSW50ZWdlcignMy4yJyk7XG4gKiAvLyA9PiAzXG4gKi9cbmZ1bmN0aW9uIHRvSW50ZWdlcih2YWx1ZSkge1xuICB2YXIgcmVzdWx0ID0gdG9GaW5pdGUodmFsdWUpLFxuICAgICAgcmVtYWluZGVyID0gcmVzdWx0ICUgMTtcblxuICByZXR1cm4gcmVzdWx0ID09PSByZXN1bHQgPyAocmVtYWluZGVyID8gcmVzdWx0IC0gcmVtYWluZGVyIDogcmVzdWx0KSA6IDA7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gdG9JbnRlZ2VyO1xuIiwidmFyIGlzT2JqZWN0ID0gcmVxdWlyZSgnLi9pc09iamVjdCcpLFxuICAgIGlzU3ltYm9sID0gcmVxdWlyZSgnLi9pc1N5bWJvbCcpO1xuXG4vKiogVXNlZCBhcyByZWZlcmVuY2VzIGZvciB2YXJpb3VzIGBOdW1iZXJgIGNvbnN0YW50cy4gKi9cbnZhciBOQU4gPSAwIC8gMDtcblxuLyoqIFVzZWQgdG8gbWF0Y2ggbGVhZGluZyBhbmQgdHJhaWxpbmcgd2hpdGVzcGFjZS4gKi9cbnZhciByZVRyaW0gPSAvXlxccyt8XFxzKyQvZztcblxuLyoqIFVzZWQgdG8gZGV0ZWN0IGJhZCBzaWduZWQgaGV4YWRlY2ltYWwgc3RyaW5nIHZhbHVlcy4gKi9cbnZhciByZUlzQmFkSGV4ID0gL15bLStdMHhbMC05YS1mXSskL2k7XG5cbi8qKiBVc2VkIHRvIGRldGVjdCBiaW5hcnkgc3RyaW5nIHZhbHVlcy4gKi9cbnZhciByZUlzQmluYXJ5ID0gL14wYlswMV0rJC9pO1xuXG4vKiogVXNlZCB0byBkZXRlY3Qgb2N0YWwgc3RyaW5nIHZhbHVlcy4gKi9cbnZhciByZUlzT2N0YWwgPSAvXjBvWzAtN10rJC9pO1xuXG4vKiogQnVpbHQtaW4gbWV0aG9kIHJlZmVyZW5jZXMgd2l0aG91dCBhIGRlcGVuZGVuY3kgb24gYHJvb3RgLiAqL1xudmFyIGZyZWVQYXJzZUludCA9IHBhcnNlSW50O1xuXG4vKipcbiAqIENvbnZlcnRzIGB2YWx1ZWAgdG8gYSBudW1iZXIuXG4gKlxuICogQHN0YXRpY1xuICogQG1lbWJlck9mIF9cbiAqIEBzaW5jZSA0LjAuMFxuICogQGNhdGVnb3J5IExhbmdcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHByb2Nlc3MuXG4gKiBAcmV0dXJucyB7bnVtYmVyfSBSZXR1cm5zIHRoZSBudW1iZXIuXG4gKiBAZXhhbXBsZVxuICpcbiAqIF8udG9OdW1iZXIoMy4yKTtcbiAqIC8vID0+IDMuMlxuICpcbiAqIF8udG9OdW1iZXIoTnVtYmVyLk1JTl9WQUxVRSk7XG4gKiAvLyA9PiA1ZS0zMjRcbiAqXG4gKiBfLnRvTnVtYmVyKEluZmluaXR5KTtcbiAqIC8vID0+IEluZmluaXR5XG4gKlxuICogXy50b051bWJlcignMy4yJyk7XG4gKiAvLyA9PiAzLjJcbiAqL1xuZnVuY3Rpb24gdG9OdW1iZXIodmFsdWUpIHtcbiAgaWYgKHR5cGVvZiB2YWx1ZSA9PSAnbnVtYmVyJykge1xuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxuICBpZiAoaXNTeW1ib2wodmFsdWUpKSB7XG4gICAgcmV0dXJuIE5BTjtcbiAgfVxuICBpZiAoaXNPYmplY3QodmFsdWUpKSB7XG4gICAgdmFyIG90aGVyID0gdHlwZW9mIHZhbHVlLnZhbHVlT2YgPT0gJ2Z1bmN0aW9uJyA/IHZhbHVlLnZhbHVlT2YoKSA6IHZhbHVlO1xuICAgIHZhbHVlID0gaXNPYmplY3Qob3RoZXIpID8gKG90aGVyICsgJycpIDogb3RoZXI7XG4gIH1cbiAgaWYgKHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykge1xuICAgIHJldHVybiB2YWx1ZSA9PT0gMCA/IHZhbHVlIDogK3ZhbHVlO1xuICB9XG4gIHZhbHVlID0gdmFsdWUucmVwbGFjZShyZVRyaW0sICcnKTtcbiAgdmFyIGlzQmluYXJ5ID0gcmVJc0JpbmFyeS50ZXN0KHZhbHVlKTtcbiAgcmV0dXJuIChpc0JpbmFyeSB8fCByZUlzT2N0YWwudGVzdCh2YWx1ZSkpXG4gICAgPyBmcmVlUGFyc2VJbnQodmFsdWUuc2xpY2UoMiksIGlzQmluYXJ5ID8gMiA6IDgpXG4gICAgOiAocmVJc0JhZEhleC50ZXN0KHZhbHVlKSA/IE5BTiA6ICt2YWx1ZSk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gdG9OdW1iZXI7XG4iLCIvKlxuICBMb2tpIEluZGV4ZWREYiBBZGFwdGVyIChuZWVkIHRvIGluY2x1ZGUgdGhpcyBzY3JpcHQgdG8gdXNlIGl0KVxuXG4gIENvbnNvbGUgVXNhZ2UgY2FuIGJlIHVzZWQgZm9yIG1hbmFnZW1lbnQvZGlhZ25vc3RpYywgaGVyZSBhcmUgYSBmZXcgZXhhbXBsZXMgOlxuICBhZGFwdGVyLmdldERhdGFiYXNlTGlzdCgpOyAvLyB3aXRoIG5vIGNhbGxiYWNrIHBhc3NlZCwgdGhpcyBtZXRob2Qgd2lsbCBsb2cgcmVzdWx0cyB0byBjb25zb2xlXG4gIGFkYXB0ZXIuc2F2ZURhdGFiYXNlKCdVc2VyRGF0YWJhc2UnLCBKU09OLnN0cmluZ2lmeShteURiKSk7XG4gIGFkYXB0ZXIubG9hZERhdGFiYXNlKCdVc2VyRGF0YWJhc2UnKTsgLy8gd2lsbCBsb2cgdGhlIHNlcmlhbGl6ZWQgZGIgdG8gY29uc29sZVxuICBhZGFwdGVyLmRlbGV0ZURhdGFiYXNlKCdVc2VyRGF0YWJhc2UnKTtcbiovXG5cbihmdW5jdGlvbiAocm9vdCwgZmFjdG9yeSkge1xuICAgIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcbiAgICAgICAgLy8gQU1EXG4gICAgICAgIGRlZmluZShbXSwgZmFjdG9yeSk7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgLy8gTm9kZSwgQ29tbW9uSlMtbGlrZVxuICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICAvLyBCcm93c2VyIGdsb2JhbHMgKHJvb3QgaXMgd2luZG93KVxuICAgICAgICByb290Lkxva2lJbmRleGVkQWRhcHRlciA9IGZhY3RvcnkoKTtcbiAgICB9XG59KHRoaXMsIGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIChmdW5jdGlvbigpIHtcblxuICAgIC8qKlxuICAgICAqIExva2kgcGVyc2lzdGVuY2UgYWRhcHRlciBjbGFzcyBmb3IgaW5kZXhlZERiLlxuICAgICAqICAgICBUaGlzIGNsYXNzIGZ1bGZpbGxzIGFic3RyYWN0IGFkYXB0ZXIgaW50ZXJmYWNlIHdoaWNoIGNhbiBiZSBhcHBsaWVkIHRvIG90aGVyIHN0b3JhZ2UgbWV0aG9kcy4gXG4gICAgICogICAgIFV0aWxpemVzIHRoZSBpbmNsdWRlZCBMb2tpQ2F0YWxvZyBhcHAva2V5L3ZhbHVlIGRhdGFiYXNlIGZvciBhY3R1YWwgZGF0YWJhc2UgcGVyc2lzdGVuY2UuXG4gICAgICogICAgIEluZGV4ZWRkYiBpcyBoaWdobHkgYXN5bmMsIGJ1dCB0aGlzIGFkYXB0ZXIgaGFzIGJlZW4gbWFkZSAnY29uc29sZS1mcmllbmRseScgYXMgd2VsbC5cbiAgICAgKiAgICAgQW55d2hlcmUgYSBjYWxsYmFjayBpcyBvbWl0dGVkLCBpdCBzaG91bGQgcmV0dXJuIHJlc3VsdHMgKGlmIGFwcGxpY2FibGUpIHRvIGNvbnNvbGUuXG4gICAgICogICAgIEluZGV4ZWREYiBzdG9yYWdlIGlzIHByb3ZpZGVkIHBlci1kb21haW4sIHNvIHdlIGltcGxlbWVudCBhcHAva2V5L3ZhbHVlIGRhdGFiYXNlIHRvIFxuICAgICAqICAgICBhbGxvdyBzZXBhcmF0ZSBjb250ZXh0cyBmb3Igc2VwYXJhdGUgYXBwcyB3aXRoaW4gYSBkb21haW4uXG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIHZhciBpZGJBZGFwdGVyID0gbmV3IExva2lJbmRleGVkQWRhcHRlcignZmluYW5jZScpO1xuICAgICAqXG4gICAgICogQGNvbnN0cnVjdG9yIExva2lJbmRleGVkQWRhcHRlclxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGFwcG5hbWUgLSAoT3B0aW9uYWwpIEFwcGxpY2F0aW9uIG5hbWUgY29udGV4dCBjYW4gYmUgdXNlZCB0byBkaXN0aW5ndWlzaCBzdWJkb21haW5zLCAnbG9raScgYnkgZGVmYXVsdFxuICAgICAqIEBwYXJhbSB7b2JqZWN0PX0gb3B0aW9ucyBDb25maWd1cmF0aW9uIG9wdGlvbnMgZm9yIHRoZSBhZGFwdGVyXG4gICAgICogQHBhcmFtIHtib29sZWFufSBvcHRpb25zLmNsb3NlQWZ0ZXJTYXZlIFdoZXRoZXIgdGhlIGluZGV4ZWREQiBkYXRhYmFzZSBzaG91bGQgYmUgY2xvc2VkIGFmdGVyIHNhdmluZy5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBMb2tpSW5kZXhlZEFkYXB0ZXIoYXBwbmFtZSwgb3B0aW9ucylcbiAgICB7XG4gICAgICB0aGlzLmFwcCA9ICdsb2tpJztcbiAgICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cbiAgICAgIGlmICh0eXBlb2YgKGFwcG5hbWUpICE9PSAndW5kZWZpbmVkJylcbiAgICAgIHtcbiAgICAgICAgdGhpcy5hcHAgPSBhcHBuYW1lO1xuICAgICAgfVxuXG4gICAgICAvLyBrZWVwIHJlZmVyZW5jZSB0byBjYXRhbG9nIGNsYXNzIGZvciBiYXNlIEFLViBvcGVyYXRpb25zXG4gICAgICB0aGlzLmNhdGFsb2cgPSBudWxsO1xuXG4gICAgICBpZiAoIXRoaXMuY2hlY2tBdmFpbGFiaWxpdHkoKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2luZGV4ZWREQiBkb2VzIG5vdCBzZWVtIHRvIGJlIHN1cHBvcnRlZCBmb3IgeW91ciBlbnZpcm9ubWVudCcpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVzZWQgZm9yIGNsb3NpbmcgdGhlIGluZGV4ZWRkYiBkYXRhYmFzZS5cbiAgICAgKi9cbiAgICBMb2tpSW5kZXhlZEFkYXB0ZXIucHJvdG90eXBlLmNsb3NlRGF0YWJhc2UgPSBmdW5jdGlvbiAoKVxuICAgIHtcbiAgICAgIGlmICh0aGlzLmNhdGFsb2cgJiYgdGhpcy5jYXRhbG9nLmRiKSB7XG4gICAgICAgIHRoaXMuY2F0YWxvZy5kYi5jbG9zZSgpO1xuICAgICAgICB0aGlzLmNhdGFsb2cuZGIgPSBudWxsO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBVc2VkIHRvIGNoZWNrIGlmIGFkYXB0ZXIgaXMgYXZhaWxhYmxlXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gdHJ1ZSBpZiBpbmRleGVkZGIgaXMgYXZhaWxhYmxlLCBmYWxzZSBpZiBub3QuXG4gICAgICogQG1lbWJlcm9mIExva2lJbmRleGVkQWRhcHRlclxuICAgICAqL1xuICAgIExva2lJbmRleGVkQWRhcHRlci5wcm90b3R5cGUuY2hlY2tBdmFpbGFiaWxpdHkgPSBmdW5jdGlvbigpXG4gICAge1xuICAgICAgaWYgKHR5cGVvZiBpbmRleGVkREIgIT09ICd1bmRlZmluZWQnICYmIGluZGV4ZWREQikgcmV0dXJuIHRydWU7XG5cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUmV0cmlldmVzIGEgc2VyaWFsaXplZCBkYiBzdHJpbmcgZnJvbSB0aGUgY2F0YWxvZy5cbiAgICAgKlxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gTE9BRFxuICAgICAqIHZhciBpZGJBZGFwdGVyID0gbmV3IExva2lJbmRleGVkQWRhcHRlcignZmluYW5jZScpO1xuICAgICAqIHZhciBkYiA9IG5ldyBsb2tpKCd0ZXN0JywgeyBhZGFwdGVyOiBpZGJBZGFwdGVyIH0pO1xuICAgICAqICAgZGIubG9hZERhdGFiYXNlKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAqICAgY29uc29sZS5sb2coJ2RvbmUnKTtcbiAgICAgKiB9KTtcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBkYm5hbWUgLSB0aGUgbmFtZSBvZiB0aGUgZGF0YWJhc2UgdG8gcmV0cmlldmUuXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbn0gY2FsbGJhY2sgLSBjYWxsYmFjayBzaG91bGQgYWNjZXB0IHN0cmluZyBwYXJhbSBjb250YWluaW5nIHNlcmlhbGl6ZWQgZGIgc3RyaW5nLlxuICAgICAqIEBtZW1iZXJvZiBMb2tpSW5kZXhlZEFkYXB0ZXJcbiAgICAgKi9cbiAgICBMb2tpSW5kZXhlZEFkYXB0ZXIucHJvdG90eXBlLmxvYWREYXRhYmFzZSA9IGZ1bmN0aW9uKGRibmFtZSwgY2FsbGJhY2spXG4gICAge1xuICAgICAgdmFyIGFwcE5hbWUgPSB0aGlzLmFwcDtcbiAgICAgIHZhciBhZGFwdGVyID0gdGhpcztcblxuICAgICAgLy8gbGF6eSBvcGVuL2NyZWF0ZSBkYiByZWZlcmVuY2Ugc28gZG9udCAtbmVlZC0gY2FsbGJhY2sgaW4gY29uc3RydWN0b3JcbiAgICAgIGlmICh0aGlzLmNhdGFsb2cgPT09IG51bGwgfHwgdGhpcy5jYXRhbG9nLmRiID09PSBudWxsKSB7XG4gICAgICAgIHRoaXMuY2F0YWxvZyA9IG5ldyBMb2tpQ2F0YWxvZyhmdW5jdGlvbihjYXQpIHtcbiAgICAgICAgICBhZGFwdGVyLmNhdGFsb2cgPSBjYXQ7XG5cbiAgICAgICAgICBhZGFwdGVyLmxvYWREYXRhYmFzZShkYm5hbWUsIGNhbGxiYWNrKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBsb29rdXAgdXAgZGIgc3RyaW5nIGluIEFLViBkYlxuICAgICAgdGhpcy5jYXRhbG9nLmdldEFwcEtleShhcHBOYW1lLCBkYm5hbWUsIGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICBpZiAodHlwZW9mIChjYWxsYmFjaykgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICBpZiAocmVzdWx0LmlkID09PSAwKSB7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgICAgY2FsbGJhY2socmVzdWx0LnZhbCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgLy8gc3VwcG9ydCBjb25zb2xlIHVzZSBvZiBhcGlcbiAgICAgICAgICBjb25zb2xlLmxvZyhyZXN1bHQudmFsKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfTtcblxuICAgIC8vIGFsaWFzXG4gICAgTG9raUluZGV4ZWRBZGFwdGVyLnByb3RvdHlwZS5sb2FkS2V5ID0gTG9raUluZGV4ZWRBZGFwdGVyLnByb3RvdHlwZS5sb2FkRGF0YWJhc2U7XG5cbiAgICAvKipcbiAgICAgKiBTYXZlcyBhIHNlcmlhbGl6ZWQgZGIgdG8gdGhlIGNhdGFsb2cuXG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIFNBVkUgOiB3aWxsIHNhdmUgQXBwL0tleS9WYWwgYXMgJ2ZpbmFuY2UnLyd0ZXN0Jy97c2VyaWFsaXplZERifVxuICAgICAqIHZhciBpZGJBZGFwdGVyID0gbmV3IExva2lJbmRleGVkQWRhcHRlcignZmluYW5jZScpO1xuICAgICAqIHZhciBkYiA9IG5ldyBsb2tpKCd0ZXN0JywgeyBhZGFwdGVyOiBpZGJBZGFwdGVyIH0pO1xuICAgICAqIHZhciBjb2xsID0gZGIuYWRkQ29sbGVjdGlvbigndGVzdENvbGwnKTtcbiAgICAgKiBjb2xsLmluc2VydCh7dGVzdDogJ3ZhbCd9KTtcbiAgICAgKiBkYi5zYXZlRGF0YWJhc2UoKTsgIC8vIGNvdWxkIHBhc3MgY2FsbGJhY2sgaWYgbmVlZGVkIGZvciBhc3luYyBjb21wbGV0ZVxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGRibmFtZSAtIHRoZSBuYW1lIHRvIGdpdmUgdGhlIHNlcmlhbGl6ZWQgZGF0YWJhc2Ugd2l0aGluIHRoZSBjYXRhbG9nLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBkYnN0cmluZyAtIHRoZSBzZXJpYWxpemVkIGRiIHN0cmluZyB0byBzYXZlLlxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IGNhbGxiYWNrIC0gKE9wdGlvbmFsKSBjYWxsYmFjayBwYXNzZWQgb2JqLnN1Y2Nlc3Mgd2l0aCB0cnVlIG9yIGZhbHNlXG4gICAgICogQG1lbWJlcm9mIExva2lJbmRleGVkQWRhcHRlclxuICAgICAqL1xuICAgIExva2lJbmRleGVkQWRhcHRlci5wcm90b3R5cGUuc2F2ZURhdGFiYXNlID0gZnVuY3Rpb24oZGJuYW1lLCBkYnN0cmluZywgY2FsbGJhY2spXG4gICAge1xuICAgICAgdmFyIGFwcE5hbWUgPSB0aGlzLmFwcDtcbiAgICAgIHZhciBhZGFwdGVyID0gdGhpcztcblxuICAgICAgZnVuY3Rpb24gc2F2ZUNhbGxiYWNrKHJlc3VsdCkge1xuICAgICAgICBpZiAocmVzdWx0ICYmIHJlc3VsdC5zdWNjZXNzID09PSB0cnVlKSB7XG4gICAgICAgICAgY2FsbGJhY2sobnVsbCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgY2FsbGJhY2sobmV3IEVycm9yKFwiRXJyb3Igc2F2aW5nIGRhdGFiYXNlXCIpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChhZGFwdGVyLm9wdGlvbnMuY2xvc2VBZnRlclNhdmUpIHtcbiAgICAgICAgICBhZGFwdGVyLmNsb3NlRGF0YWJhc2UoKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBsYXp5IG9wZW4vY3JlYXRlIGRiIHJlZmVyZW5jZSBzbyBkb250IC1uZWVkLSBjYWxsYmFjayBpbiBjb25zdHJ1Y3RvclxuICAgICAgaWYgKHRoaXMuY2F0YWxvZyA9PT0gbnVsbCB8fCB0aGlzLmNhdGFsb2cuZGIgPT09IG51bGwpIHtcbiAgICAgICAgdGhpcy5jYXRhbG9nID0gbmV3IExva2lDYXRhbG9nKGZ1bmN0aW9uKGNhdCkge1xuICAgICAgICAgIGFkYXB0ZXIuc2F2ZURhdGFiYXNlKGRibmFtZSwgZGJzdHJpbmcsIHNhdmVDYWxsYmFjayk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gc2V0IChhZGQvdXBkYXRlKSBlbnRyeSB0byBBS1YgZGF0YWJhc2VcbiAgICAgIHRoaXMuY2F0YWxvZy5zZXRBcHBLZXkoYXBwTmFtZSwgZGJuYW1lLCBkYnN0cmluZywgc2F2ZUNhbGxiYWNrKTtcbiAgICB9O1xuXG4gICAgLy8gYWxpYXNcbiAgICBMb2tpSW5kZXhlZEFkYXB0ZXIucHJvdG90eXBlLnNhdmVLZXkgPSBMb2tpSW5kZXhlZEFkYXB0ZXIucHJvdG90eXBlLnNhdmVEYXRhYmFzZTtcblxuICAgIC8qKlxuICAgICAqIERlbGV0ZXMgYSBzZXJpYWxpemVkIGRiIGZyb20gdGhlIGNhdGFsb2cuXG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIERFTEVURSBEQVRBQkFTRVxuICAgICAqIC8vIGRlbGV0ZSAnZmluYW5jZScvJ3Rlc3QnIHZhbHVlIGZyb20gY2F0YWxvZ1xuICAgICAqIGlkYkFkYXB0ZXIuZGVsZXRlRGF0YWJhc2UoJ3Rlc3QnLCBmdW5jdGlvbiB7XG4gICAgICogICAvLyBkYXRhYmFzZSBkZWxldGVkXG4gICAgICogfSk7XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZGJuYW1lIC0gdGhlIG5hbWUgb2YgdGhlIGRhdGFiYXNlIHRvIGRlbGV0ZSBmcm9tIHRoZSBjYXRhbG9nLlxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb249fSBjYWxsYmFjayAtIChPcHRpb25hbCkgZXhlY3V0ZWQgb24gZGF0YWJhc2UgZGVsZXRlXG4gICAgICogQG1lbWJlcm9mIExva2lJbmRleGVkQWRhcHRlclxuICAgICAqL1xuICAgIExva2lJbmRleGVkQWRhcHRlci5wcm90b3R5cGUuZGVsZXRlRGF0YWJhc2UgPSBmdW5jdGlvbihkYm5hbWUsIGNhbGxiYWNrKVxuICAgIHtcbiAgICAgIHZhciBhcHBOYW1lID0gdGhpcy5hcHA7XG4gICAgICB2YXIgYWRhcHRlciA9IHRoaXM7XG5cbiAgICAgIC8vIGxhenkgb3Blbi9jcmVhdGUgZGIgcmVmZXJlbmNlIGFuZCBwYXNzIGNhbGxiYWNrIGFoZWFkXG4gICAgICBpZiAodGhpcy5jYXRhbG9nID09PSBudWxsIHx8IHRoaXMuY2F0YWxvZy5kYiA9PT0gbnVsbCkge1xuICAgICAgICB0aGlzLmNhdGFsb2cgPSBuZXcgTG9raUNhdGFsb2coZnVuY3Rpb24oY2F0KSB7XG4gICAgICAgICAgYWRhcHRlci5jYXRhbG9nID0gY2F0O1xuXG4gICAgICAgICAgYWRhcHRlci5kZWxldGVEYXRhYmFzZShkYm5hbWUsIGNhbGxiYWNrKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBjYXRhbG9nIHdhcyBhbHJlYWR5IGluaXRpYWxpemVkLCBzbyBqdXN0IGxvb2t1cCBvYmplY3QgYW5kIGRlbGV0ZSBieSBpZFxuICAgICAgdGhpcy5jYXRhbG9nLmdldEFwcEtleShhcHBOYW1lLCBkYm5hbWUsIGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICB2YXIgaWQgPSByZXN1bHQuaWQ7XG5cbiAgICAgICAgaWYgKGlkICE9PSAwKSB7XG4gICAgICAgICAgYWRhcHRlci5jYXRhbG9nLmRlbGV0ZUFwcEtleShpZCwgY2FsbGJhY2spO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiAoY2FsbGJhY2spID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgY2FsbGJhY2soeyBzdWNjZXNzOiB0cnVlIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgLy8gYWxpYXNcbiAgICBMb2tpSW5kZXhlZEFkYXB0ZXIucHJvdG90eXBlLmRlbGV0ZUtleSA9IExva2lJbmRleGVkQWRhcHRlci5wcm90b3R5cGUuZGVsZXRlRGF0YWJhc2U7XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIGFsbCBkYXRhYmFzZSBwYXJ0aXRpb25zIGFuZCBwYWdlcyB3aXRoIHRoZSBiYXNlIGZpbGVuYW1lIHBhc3NlZCBpbi5cbiAgICAgKiBUaGlzIHV0aWxpdHkgbWV0aG9kIGRvZXMgbm90ICh5ZXQpIGd1YXJhbnRlZSBhc3luYyBkZWxldGlvbnMgd2lsbCBiZSBjb21wbGV0ZWQgYmVmb3JlIHJldHVybmluZ1xuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGRibmFtZSAtIHRoZSBiYXNlIGZpbGVuYW1lIHdoaWNoIGNvbnRhaW5lciwgcGFydGl0aW9ucywgb3IgcGFnZXMgYXJlIGRlcml2ZWRcbiAgICAgKiBAbWVtYmVyb2YgTG9raUluZGV4ZWRBZGFwdGVyXG4gICAgICovXG4gICAgTG9raUluZGV4ZWRBZGFwdGVyLnByb3RvdHlwZS5kZWxldGVEYXRhYmFzZVBhcnRpdGlvbnMgPSBmdW5jdGlvbihkYm5hbWUpIHtcbiAgICAgIHZhciBzZWxmPXRoaXM7XG4gICAgICB0aGlzLmdldERhdGFiYXNlTGlzdChmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgcmVzdWx0LmZvckVhY2goZnVuY3Rpb24oc3RyKSB7XG4gICAgICAgICAgaWYgKHN0ci5zdGFydHNXaXRoKGRibmFtZSkpIHtcbiAgICAgICAgICAgIHNlbGYuZGVsZXRlRGF0YWJhc2Uoc3RyKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFJldHJpZXZlcyBvYmplY3QgYXJyYXkgb2YgY2F0YWxvZyBlbnRyaWVzIGZvciBjdXJyZW50IGFwcC5cbiAgICAgKlxuICAgICAqIEBleGFtcGxlXG4gICAgICogaWRiQWRhcHRlci5nZXREYXRhYmFzZUxpc3QoZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICogICAvLyByZXN1bHQgaXMgYXJyYXkgb2Ygc3RyaW5nIG5hbWVzIGZvciB0aGF0IGFwcGNvbnRleHQgKCdmaW5hbmNlJylcbiAgICAgKiAgIHJlc3VsdC5mb3JFYWNoKGZ1bmN0aW9uKHN0cikge1xuICAgICAqICAgICBjb25zb2xlLmxvZyhzdHIpO1xuICAgICAqICAgfSk7XG4gICAgICogfSk7XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBjYWxsYmFjayAtIHNob3VsZCBhY2NlcHQgYXJyYXkgb2YgZGF0YWJhc2UgbmFtZXMgaW4gdGhlIGNhdGFsb2cgZm9yIGN1cnJlbnQgYXBwLlxuICAgICAqIEBtZW1iZXJvZiBMb2tpSW5kZXhlZEFkYXB0ZXJcbiAgICAgKi9cbiAgICBMb2tpSW5kZXhlZEFkYXB0ZXIucHJvdG90eXBlLmdldERhdGFiYXNlTGlzdCA9IGZ1bmN0aW9uKGNhbGxiYWNrKVxuICAgIHtcbiAgICAgIHZhciBhcHBOYW1lID0gdGhpcy5hcHA7XG4gICAgICB2YXIgYWRhcHRlciA9IHRoaXM7XG5cbiAgICAgIC8vIGxhenkgb3Blbi9jcmVhdGUgZGIgcmVmZXJlbmNlIHNvIGRvbnQgLW5lZWQtIGNhbGxiYWNrIGluIGNvbnN0cnVjdG9yXG4gICAgICBpZiAodGhpcy5jYXRhbG9nID09PSBudWxsIHx8IHRoaXMuY2F0YWxvZy5kYiA9PT0gbnVsbCkge1xuICAgICAgICB0aGlzLmNhdGFsb2cgPSBuZXcgTG9raUNhdGFsb2coZnVuY3Rpb24oY2F0KSB7XG4gICAgICAgICAgYWRhcHRlci5jYXRhbG9nID0gY2F0O1xuXG4gICAgICAgICAgYWRhcHRlci5nZXREYXRhYmFzZUxpc3QoY2FsbGJhY2spO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIGNhdGFsb2cgYWxyZWFkeSBpbml0aWFsaXplZFxuICAgICAgLy8gZ2V0IGFsbCBrZXlzIGZvciBjdXJyZW50IGFwcE5hbWUsIGFuZCB0cmFuc3Bvc2UgcmVzdWx0cyBzbyBqdXN0IHN0cmluZyBhcnJheVxuICAgICAgdGhpcy5jYXRhbG9nLmdldEFwcEtleXMoYXBwTmFtZSwgZnVuY3Rpb24ocmVzdWx0cykge1xuICAgICAgICB2YXIgbmFtZXMgPSBbXTtcblxuICAgICAgICBmb3IodmFyIGlkeCA9IDA7IGlkeCA8IHJlc3VsdHMubGVuZ3RoOyBpZHgrKykge1xuICAgICAgICAgIG5hbWVzLnB1c2gocmVzdWx0c1tpZHhdLmtleSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodHlwZW9mIChjYWxsYmFjaykgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICBjYWxsYmFjayhuYW1lcyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgbmFtZXMuZm9yRWFjaChmdW5jdGlvbihvYmopIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKG9iaik7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICAvLyBhbGlhc1xuICAgIExva2lJbmRleGVkQWRhcHRlci5wcm90b3R5cGUuZ2V0S2V5TGlzdCA9IExva2lJbmRleGVkQWRhcHRlci5wcm90b3R5cGUuZ2V0RGF0YWJhc2VMaXN0O1xuXG4gICAgLyoqXG4gICAgICogQWxsb3dzIHJldHJpZXZhbCBvZiBsaXN0IG9mIGFsbCBrZXlzIGluIGNhdGFsb2cgYWxvbmcgd2l0aCBzaXplXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBjYWxsYmFjayAtIChPcHRpb25hbCkgY2FsbGJhY2sgdG8gYWNjZXB0IHJlc3VsdCBhcnJheS5cbiAgICAgKiBAbWVtYmVyb2YgTG9raUluZGV4ZWRBZGFwdGVyXG4gICAgICovXG4gICAgTG9raUluZGV4ZWRBZGFwdGVyLnByb3RvdHlwZS5nZXRDYXRhbG9nU3VtbWFyeSA9IGZ1bmN0aW9uKGNhbGxiYWNrKVxuICAgIHtcbiAgICAgIHZhciBhcHBOYW1lID0gdGhpcy5hcHA7XG4gICAgICB2YXIgYWRhcHRlciA9IHRoaXM7XG5cbiAgICAgIC8vIGxhenkgb3Blbi9jcmVhdGUgZGIgcmVmZXJlbmNlXG4gICAgICBpZiAodGhpcy5jYXRhbG9nID09PSBudWxsIHx8IHRoaXMuY2F0YWxvZy5kYiA9PT0gbnVsbCkge1xuICAgICAgICB0aGlzLmNhdGFsb2cgPSBuZXcgTG9raUNhdGFsb2coZnVuY3Rpb24oY2F0KSB7XG4gICAgICAgICAgYWRhcHRlci5jYXRhbG9nID0gY2F0O1xuXG4gICAgICAgICAgYWRhcHRlci5nZXRDYXRhbG9nU3VtbWFyeShjYWxsYmFjayk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gY2F0YWxvZyBhbHJlYWR5IGluaXRpYWxpemVkXG4gICAgICAvLyBnZXQgYWxsIGtleXMgZm9yIGN1cnJlbnQgYXBwTmFtZSwgYW5kIHRyYW5zcG9zZSByZXN1bHRzIHNvIGp1c3Qgc3RyaW5nIGFycmF5XG4gICAgICB0aGlzLmNhdGFsb2cuZ2V0QWxsS2V5cyhmdW5jdGlvbihyZXN1bHRzKSB7XG4gICAgICAgIHZhciBlbnRyaWVzID0gW107XG4gICAgICAgIHZhciBvYmosXG4gICAgICAgICAgc2l6ZSxcbiAgICAgICAgICBvYXBwLFxuICAgICAgICAgIG9rZXksXG4gICAgICAgICAgb3ZhbDtcblxuICAgICAgICBmb3IodmFyIGlkeCA9IDA7IGlkeCA8IHJlc3VsdHMubGVuZ3RoOyBpZHgrKykge1xuICAgICAgICAgIG9iaiA9IHJlc3VsdHNbaWR4XTtcbiAgICAgICAgICBvYXBwID0gb2JqLmFwcCB8fCAnJztcbiAgICAgICAgICBva2V5ID0gb2JqLmtleSB8fCAnJztcbiAgICAgICAgICBvdmFsID0gb2JqLnZhbCB8fCAnJztcblxuICAgICAgICAgIC8vIGFwcCBhbmQga2V5IGFyZSBjb21wb3NpdGVkIGludG8gYW4gYXBwa2V5IGNvbHVtbiBzbyB3ZSB3aWxsIG11bHQgYnkgMlxuICAgICAgICAgIHNpemUgPSBvYXBwLmxlbmd0aCAqIDIgKyBva2V5Lmxlbmd0aCAqIDIgKyBvdmFsLmxlbmd0aCArIDE7XG5cbiAgICAgICAgICBlbnRyaWVzLnB1c2goeyBcImFwcFwiOiBvYmouYXBwLCBcImtleVwiOiBvYmoua2V5LCBcInNpemVcIjogc2l6ZSB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0eXBlb2YgKGNhbGxiYWNrKSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgIGNhbGxiYWNrKGVudHJpZXMpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIGVudHJpZXMuZm9yRWFjaChmdW5jdGlvbihvYmopIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKG9iaik7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBMb2tpQ2F0YWxvZyAtIHVuZGVybHlpbmcgQXBwL0tleS9WYWx1ZSBjYXRhbG9nIHBlcnNpc3RlbmNlXG4gICAgICogICAgVGhpcyBub24taW50ZXJmYWNlIGNsYXNzIGltcGxlbWVudHMgdGhlIGFjdHVhbCBwZXJzaXN0ZW5jZS5cbiAgICAgKiAgICBVc2VkIGJ5IHRoZSBJbmRleGVkQWRhcHRlciBjbGFzcy5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBMb2tpQ2F0YWxvZyhjYWxsYmFjaylcbiAgICB7XG4gICAgICB0aGlzLmRiID0gbnVsbDtcbiAgICAgIHRoaXMuaW5pdGlhbGl6ZUxva2lDYXRhbG9nKGNhbGxiYWNrKTtcbiAgICB9XG5cbiAgICBMb2tpQ2F0YWxvZy5wcm90b3R5cGUuaW5pdGlhbGl6ZUxva2lDYXRhbG9nID0gZnVuY3Rpb24oY2FsbGJhY2spIHtcbiAgICAgIHZhciBvcGVuUmVxdWVzdCA9IGluZGV4ZWREQi5vcGVuKCdMb2tpQ2F0YWxvZycsIDEpO1xuICAgICAgdmFyIGNhdCA9IHRoaXM7XG5cbiAgICAgIC8vIElmIGRhdGFiYXNlIGRvZXNuJ3QgZXhpc3QgeWV0IG9yIGl0cyB2ZXJzaW9uIGlzIGxvd2VyIHRoYW4gb3VyIHZlcnNpb24gc3BlY2lmaWVkIGFib3ZlICgybmQgcGFyYW0gaW4gbGluZSBhYm92ZSlcbiAgICAgIG9wZW5SZXF1ZXN0Lm9udXBncmFkZW5lZWRlZCA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgdmFyIHRoaXNEQiA9IGUudGFyZ2V0LnJlc3VsdDtcbiAgICAgICAgaWYgKHRoaXNEQi5vYmplY3RTdG9yZU5hbWVzLmNvbnRhaW5zKCdMb2tpQUtWJykpIHtcbiAgICAgICAgICB0aGlzREIuZGVsZXRlT2JqZWN0U3RvcmUoJ0xva2lBS1YnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmKCF0aGlzREIub2JqZWN0U3RvcmVOYW1lcy5jb250YWlucygnTG9raUFLVicpKSB7XG4gICAgICAgICAgdmFyIG9iamVjdFN0b3JlID0gdGhpc0RCLmNyZWF0ZU9iamVjdFN0b3JlKCdMb2tpQUtWJywgeyBrZXlQYXRoOiAnaWQnLCBhdXRvSW5jcmVtZW50OnRydWUgfSk7XG4gICAgICAgICAgb2JqZWN0U3RvcmUuY3JlYXRlSW5kZXgoJ2FwcCcsICdhcHAnLCB7dW5pcXVlOmZhbHNlfSk7XG4gICAgICAgICAgb2JqZWN0U3RvcmUuY3JlYXRlSW5kZXgoJ2tleScsICdrZXknLCB7dW5pcXVlOmZhbHNlfSk7XG4gICAgICAgICAgLy8gaGFjayB0byBzaW11bGF0ZSBjb21wb3NpdGUga2V5IHNpbmNlIG92ZXJoZWFkIGlzIGxvdyAobWFpbiBzaXplIHNob3VsZCBiZSBpbiB2YWwgZmllbGQpXG4gICAgICAgICAgLy8gdXNlciAobWUpIHJlcXVpcmVkIHRvIGR1cGxpY2F0ZSB0aGUgYXBwIGFuZCBrZXkgaW50byBjb21tYSBkZWxpbWl0ZWQgYXBwa2V5IGZpZWxkIG9mZiBvYmplY3RcbiAgICAgICAgICAvLyBUaGlzIHdpbGwgYWxsb3cgcmV0cmlldmluZyBzaW5nbGUgcmVjb3JkIHdpdGggdGhhdCBjb21wb3NpdGUga2V5IGFzIHdlbGwgYXNcbiAgICAgICAgICAvLyBzdGlsbCBzdXBwb3J0aW5nIG9wZW5pbmcgY3Vyc29ycyBvbiBhcHAgb3Iga2V5IGFsb25lXG4gICAgICAgICAgb2JqZWN0U3RvcmUuY3JlYXRlSW5kZXgoJ2FwcGtleScsICdhcHBrZXknLCB7dW5pcXVlOnRydWV9KTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgb3BlblJlcXVlc3Qub25zdWNjZXNzID0gZnVuY3Rpb24oZSkge1xuICAgICAgICBjYXQuZGIgPSBlLnRhcmdldC5yZXN1bHQ7XG5cbiAgICAgICAgaWYgKHR5cGVvZiAoY2FsbGJhY2spID09PSAnZnVuY3Rpb24nKSBjYWxsYmFjayhjYXQpO1xuICAgICAgfTtcblxuICAgICAgb3BlblJlcXVlc3Qub25lcnJvciA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgdGhyb3cgZTtcbiAgICAgIH07XG4gICAgfTtcblxuICAgIExva2lDYXRhbG9nLnByb3RvdHlwZS5nZXRBcHBLZXkgPSBmdW5jdGlvbihhcHAsIGtleSwgY2FsbGJhY2spIHtcbiAgICAgIHZhciB0cmFuc2FjdGlvbiA9IHRoaXMuZGIudHJhbnNhY3Rpb24oWydMb2tpQUtWJ10sICdyZWFkb25seScpO1xuICAgICAgdmFyIHN0b3JlID0gdHJhbnNhY3Rpb24ub2JqZWN0U3RvcmUoJ0xva2lBS1YnKTtcbiAgICAgIHZhciBpbmRleCA9IHN0b3JlLmluZGV4KCdhcHBrZXknKTtcbiAgICAgIHZhciBhcHBrZXkgPSBhcHAgKyBcIixcIiArIGtleTtcbiAgICAgIHZhciByZXF1ZXN0ID0gaW5kZXguZ2V0KGFwcGtleSk7XG5cbiAgICAgIHJlcXVlc3Qub25zdWNjZXNzID0gKGZ1bmN0aW9uKHVzZXJjYWxsYmFjaykge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24oZSkge1xuICAgICAgICAgIHZhciBscmVzID0gZS50YXJnZXQucmVzdWx0O1xuXG4gICAgICAgICAgaWYgKGxyZXMgPT09IG51bGwgfHwgdHlwZW9mKGxyZXMpID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgbHJlcyA9IHtcbiAgICAgICAgICAgICAgaWQ6IDAsXG4gICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlXG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmICh0eXBlb2YodXNlcmNhbGxiYWNrKSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgdXNlcmNhbGxiYWNrKGxyZXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGxyZXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgIH0pKGNhbGxiYWNrKTtcblxuICAgICAgcmVxdWVzdC5vbmVycm9yID0gKGZ1bmN0aW9uKHVzZXJjYWxsYmFjaykge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24oZSkge1xuICAgICAgICAgIGlmICh0eXBlb2YodXNlcmNhbGxiYWNrKSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgdXNlcmNhbGxiYWNrKHsgaWQ6IDAsIHN1Y2Nlc3M6IGZhbHNlIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IGU7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgfSkoY2FsbGJhY2spO1xuICAgIH07XG5cbiAgICBMb2tpQ2F0YWxvZy5wcm90b3R5cGUuZ2V0QXBwS2V5QnlJZCA9IGZ1bmN0aW9uIChpZCwgY2FsbGJhY2ssIGRhdGEpIHtcbiAgICAgIHZhciB0cmFuc2FjdGlvbiA9IHRoaXMuZGIudHJhbnNhY3Rpb24oWydMb2tpQUtWJ10sICdyZWFkb25seScpO1xuICAgICAgdmFyIHN0b3JlID0gdHJhbnNhY3Rpb24ub2JqZWN0U3RvcmUoJ0xva2lBS1YnKTtcbiAgICAgIHZhciByZXF1ZXN0ID0gc3RvcmUuZ2V0KGlkKTtcblxuICAgICAgcmVxdWVzdC5vbnN1Y2Nlc3MgPSAoZnVuY3Rpb24oZGF0YSwgdXNlcmNhbGxiYWNrKXtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICBpZiAodHlwZW9mKHVzZXJjYWxsYmFjaykgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHVzZXJjYWxsYmFjayhlLnRhcmdldC5yZXN1bHQsIGRhdGEpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGUudGFyZ2V0LnJlc3VsdCk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgfSkoZGF0YSwgY2FsbGJhY2spO1xuICAgIH07XG5cbiAgICBMb2tpQ2F0YWxvZy5wcm90b3R5cGUuc2V0QXBwS2V5ID0gZnVuY3Rpb24gKGFwcCwga2V5LCB2YWwsIGNhbGxiYWNrKSB7XG4gICAgICB2YXIgdHJhbnNhY3Rpb24gPSB0aGlzLmRiLnRyYW5zYWN0aW9uKFsnTG9raUFLViddLCAncmVhZHdyaXRlJyk7XG4gICAgICB2YXIgc3RvcmUgPSB0cmFuc2FjdGlvbi5vYmplY3RTdG9yZSgnTG9raUFLVicpO1xuICAgICAgdmFyIGluZGV4ID0gc3RvcmUuaW5kZXgoJ2FwcGtleScpO1xuICAgICAgdmFyIGFwcGtleSA9IGFwcCArIFwiLFwiICsga2V5O1xuICAgICAgdmFyIHJlcXVlc3QgPSBpbmRleC5nZXQoYXBwa2V5KTtcblxuICAgICAgLy8gZmlyc3QgdHJ5IHRvIHJldHJpZXZlIGFuIGV4aXN0aW5nIG9iamVjdCBieSB0aGF0IGtleVxuICAgICAgLy8gbmVlZCB0byBkbyB0aGlzIGJlY2F1c2UgdG8gdXBkYXRlIGFuIG9iamVjdCB5b3UgbmVlZCB0byBoYXZlIGlkIGluIG9iamVjdCwgb3RoZXJ3aXNlIGl0IHdpbGwgYXBwZW5kIGlkIHdpdGggbmV3IGF1dG9jb3VudGVyIGFuZCBjbGFzaCB0aGUgdW5pcXVlIGluZGV4IGFwcGtleVxuICAgICAgcmVxdWVzdC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbihlKSB7XG4gICAgICAgIHZhciByZXMgPSBlLnRhcmdldC5yZXN1bHQ7XG5cbiAgICAgICAgaWYgKHJlcyA9PT0gbnVsbCB8fCByZXMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIHJlcyA9IHtcbiAgICAgICAgICAgIGFwcDphcHAsXG4gICAgICAgICAgICBrZXk6a2V5LFxuICAgICAgICAgICAgYXBwa2V5OiBhcHAgKyAnLCcgKyBrZXksXG4gICAgICAgICAgICB2YWw6dmFsXG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICByZXMudmFsID0gdmFsO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHJlcXVlc3RQdXQgPSBzdG9yZS5wdXQocmVzKTtcblxuICAgICAgICByZXF1ZXN0UHV0Lm9uZXJyb3IgPSAoZnVuY3Rpb24odXNlcmNhbGxiYWNrKSB7XG4gICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YodXNlcmNhbGxiYWNrKSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICB1c2VyY2FsbGJhY2soeyBzdWNjZXNzOiBmYWxzZSB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdMb2tpQ2F0YWxvZy5zZXRBcHBLZXkgKHNldCkgb25lcnJvcicpO1xuICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKHJlcXVlc3QuZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH07XG5cbiAgICAgICAgfSkoY2FsbGJhY2spO1xuXG4gICAgICAgIHJlcXVlc3RQdXQub25zdWNjZXNzID0gKGZ1bmN0aW9uKHVzZXJjYWxsYmFjaykge1xuICAgICAgICAgIHJldHVybiBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mKHVzZXJjYWxsYmFjaykgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgdXNlcmNhbGxiYWNrKHsgc3VjY2VzczogdHJ1ZSB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9O1xuICAgICAgICB9KShjYWxsYmFjayk7XG4gICAgICB9O1xuXG4gICAgICByZXF1ZXN0Lm9uZXJyb3IgPSAoZnVuY3Rpb24odXNlcmNhbGxiYWNrKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZih1c2VyY2FsbGJhY2spID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICB1c2VyY2FsbGJhY2soeyBzdWNjZXNzOiBmYWxzZSB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdMb2tpQ2F0YWxvZy5zZXRBcHBLZXkgKGdldCkgb25lcnJvcicpO1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihyZXF1ZXN0LmVycm9yKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9KShjYWxsYmFjayk7XG4gICAgfTtcblxuICAgIExva2lDYXRhbG9nLnByb3RvdHlwZS5kZWxldGVBcHBLZXkgPSBmdW5jdGlvbiAoaWQsIGNhbGxiYWNrKSB7XG4gICAgICB2YXIgdHJhbnNhY3Rpb24gPSB0aGlzLmRiLnRyYW5zYWN0aW9uKFsnTG9raUFLViddLCAncmVhZHdyaXRlJyk7XG4gICAgICB2YXIgc3RvcmUgPSB0cmFuc2FjdGlvbi5vYmplY3RTdG9yZSgnTG9raUFLVicpO1xuICAgICAgdmFyIHJlcXVlc3QgPSBzdG9yZS5kZWxldGUoaWQpO1xuXG4gICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IChmdW5jdGlvbih1c2VyY2FsbGJhY2spIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGV2dCkge1xuICAgICAgICAgIGlmICh0eXBlb2YodXNlcmNhbGxiYWNrKSA9PT0gJ2Z1bmN0aW9uJykgdXNlcmNhbGxiYWNrKHsgc3VjY2VzczogdHJ1ZSB9KTtcbiAgICAgICAgfTtcbiAgICAgIH0pKGNhbGxiYWNrKTtcblxuICAgICAgcmVxdWVzdC5vbmVycm9yID0gKGZ1bmN0aW9uKHVzZXJjYWxsYmFjaykge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24oZXZ0KSB7XG4gICAgICAgICAgaWYgKHR5cGVvZih1c2VyY2FsbGJhY2spID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICB1c2VyY2FsbGJhY2soeyBzdWNjZXNzOiBmYWxzZSB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdMb2tpQ2F0YWxvZy5kZWxldGVBcHBLZXkgcmFpc2VkIG9uZXJyb3InKTtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IocmVxdWVzdC5lcnJvcik7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgfSkoY2FsbGJhY2spO1xuICAgIH07XG5cbiAgICBMb2tpQ2F0YWxvZy5wcm90b3R5cGUuZ2V0QXBwS2V5cyA9IGZ1bmN0aW9uKGFwcCwgY2FsbGJhY2spIHtcbiAgICAgIHZhciB0cmFuc2FjdGlvbiA9IHRoaXMuZGIudHJhbnNhY3Rpb24oWydMb2tpQUtWJ10sICdyZWFkb25seScpO1xuICAgICAgdmFyIHN0b3JlID0gdHJhbnNhY3Rpb24ub2JqZWN0U3RvcmUoJ0xva2lBS1YnKTtcbiAgICAgIHZhciBpbmRleCA9IHN0b3JlLmluZGV4KCdhcHAnKTtcblxuICAgICAgLy8gV2Ugd2FudCBjdXJzb3IgdG8gYWxsIHZhbHVlcyBtYXRjaGluZyBvdXIgKHNpbmdsZSkgYXBwIHBhcmFtXG4gICAgICB2YXIgc2luZ2xlS2V5UmFuZ2UgPSBJREJLZXlSYW5nZS5vbmx5KGFwcCk7XG5cbiAgICAgIC8vIFRvIHVzZSBvbmUgb2YgdGhlIGtleSByYW5nZXMsIHBhc3MgaXQgaW4gYXMgdGhlIGZpcnN0IGFyZ3VtZW50IG9mIG9wZW5DdXJzb3IoKS9vcGVuS2V5Q3Vyc29yKClcbiAgICAgIHZhciBjdXJzb3IgPSBpbmRleC5vcGVuQ3Vyc29yKHNpbmdsZUtleVJhbmdlKTtcblxuICAgICAgLy8gY3Vyc29yIGludGVybmFsbHksIHB1c2hpbmcgcmVzdWx0cyBpbnRvIHRoaXMuZGF0YVtdIGFuZCByZXR1cm5cbiAgICAgIC8vIHRoaXMuZGF0YVtdIHdoZW4gZG9uZSAoc2ltaWxhciB0byBzZXJ2aWNlKVxuICAgICAgdmFyIGxvY2FsZGF0YSA9IFtdO1xuXG4gICAgICBjdXJzb3Iub25zdWNjZXNzID0gKGZ1bmN0aW9uKGRhdGEsIGNhbGxiYWNrKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgdmFyIGN1cnNvciA9IGUudGFyZ2V0LnJlc3VsdDtcbiAgICAgICAgICBpZiAoY3Vyc29yKSB7XG4gICAgICAgICAgICB2YXIgY3Vyck9iamVjdCA9IGN1cnNvci52YWx1ZTtcblxuICAgICAgICAgICAgZGF0YS5wdXNoKGN1cnJPYmplY3QpO1xuXG4gICAgICAgICAgICBjdXJzb3IuY29udGludWUoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mKGNhbGxiYWNrKSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICBjYWxsYmFjayhkYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9KShsb2NhbGRhdGEsIGNhbGxiYWNrKTtcblxuICAgICAgY3Vyc29yLm9uZXJyb3IgPSAoZnVuY3Rpb24odXNlcmNhbGxiYWNrKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZih1c2VyY2FsbGJhY2spID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICB1c2VyY2FsbGJhY2sobnVsbCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignTG9raUNhdGFsb2cuZ2V0QXBwS2V5cyByYWlzZWQgb25lcnJvcicpO1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9KShjYWxsYmFjayk7XG5cbiAgICB9O1xuXG4gICAgLy8gSGlkZSAnY3Vyc29yaW5nJyBhbmQgcmV0dXJuIGFycmF5IG9mIHsgaWQ6IGlkLCBrZXk6IGtleSB9XG4gICAgTG9raUNhdGFsb2cucHJvdG90eXBlLmdldEFsbEtleXMgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgIHZhciB0cmFuc2FjdGlvbiA9IHRoaXMuZGIudHJhbnNhY3Rpb24oWydMb2tpQUtWJ10sICdyZWFkb25seScpO1xuICAgICAgdmFyIHN0b3JlID0gdHJhbnNhY3Rpb24ub2JqZWN0U3RvcmUoJ0xva2lBS1YnKTtcbiAgICAgIHZhciBjdXJzb3IgPSBzdG9yZS5vcGVuQ3Vyc29yKCk7XG5cbiAgICAgIHZhciBsb2NhbGRhdGEgPSBbXTtcblxuICAgICAgY3Vyc29yLm9uc3VjY2VzcyA9IChmdW5jdGlvbihkYXRhLCBjYWxsYmFjaykge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24oZSkge1xuICAgICAgICAgIHZhciBjdXJzb3IgPSBlLnRhcmdldC5yZXN1bHQ7XG4gICAgICAgICAgaWYgKGN1cnNvcikge1xuICAgICAgICAgICAgdmFyIGN1cnJPYmplY3QgPSBjdXJzb3IudmFsdWU7XG5cbiAgICAgICAgICAgIGRhdGEucHVzaChjdXJyT2JqZWN0KTtcblxuICAgICAgICAgICAgY3Vyc29yLmNvbnRpbnVlKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKHR5cGVvZihjYWxsYmFjaykgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgY2FsbGJhY2soZGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgfSkobG9jYWxkYXRhLCBjYWxsYmFjayk7XG5cbiAgICAgIGN1cnNvci5vbmVycm9yID0gKGZ1bmN0aW9uKHVzZXJjYWxsYmFjaykge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24oZSkge1xuICAgICAgICAgIGlmICh0eXBlb2YodXNlcmNhbGxiYWNrKSA9PT0gJ2Z1bmN0aW9uJykgdXNlcmNhbGxiYWNrKG51bGwpO1xuICAgICAgICB9O1xuICAgICAgfSkoY2FsbGJhY2spO1xuXG4gICAgfTtcblxuICAgIHJldHVybiBMb2tpSW5kZXhlZEFkYXB0ZXI7XG5cbiAgfSgpKTtcbn0pKTtcbiIsIi8qKlxuICogTG9raUpTXG4gKiBAYXV0aG9yIEpvZSBNaW5pY2hpbm8gPGpvZS5taW5pY2hpbm9AZ21haWwuY29tPlxuICpcbiAqIEEgbGlnaHR3ZWlnaHQgZG9jdW1lbnQgb3JpZW50ZWQgamF2YXNjcmlwdCBkYXRhYmFzZVxuICovXG4oZnVuY3Rpb24gKHJvb3QsIGZhY3RvcnkpIHtcbiAgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuICAgIC8vIEFNRFxuICAgIGRlZmluZShbXSwgZmFjdG9yeSk7XG4gIH0gZWxzZSBpZiAodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKSB7XG4gICAgLy8gQ29tbW9uSlNcbiAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcbiAgfSBlbHNlIHtcbiAgICAvLyBCcm93c2VyIGdsb2JhbHNcbiAgICByb290Lmxva2kgPSBmYWN0b3J5KCk7XG4gIH1cbn0odGhpcywgZnVuY3Rpb24gKCkge1xuXG4gIHJldHVybiAoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIHZhciBoYXNPd25Qcm9wZXJ0eSA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7XG5cbiAgICB2YXIgVXRpbHMgPSB7XG4gICAgICBjb3B5UHJvcGVydGllczogZnVuY3Rpb24gKHNyYywgZGVzdCkge1xuICAgICAgICB2YXIgcHJvcDtcbiAgICAgICAgZm9yIChwcm9wIGluIHNyYykge1xuICAgICAgICAgIGRlc3RbcHJvcF0gPSBzcmNbcHJvcF07XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICAvLyB1c2VkIHRvIHJlY3Vyc2l2ZWx5IHNjYW4gaGllcmFyY2hpY2FsIHRyYW5zZm9ybSBzdGVwIG9iamVjdCBmb3IgcGFyYW0gc3Vic3RpdHV0aW9uXG4gICAgICByZXNvbHZlVHJhbnNmb3JtT2JqZWN0OiBmdW5jdGlvbiAoc3ViT2JqLCBwYXJhbXMsIGRlcHRoKSB7XG4gICAgICAgIHZhciBwcm9wLFxuICAgICAgICAgIHBuYW1lO1xuXG4gICAgICAgIGlmICh0eXBlb2YgZGVwdGggIT09ICdudW1iZXInKSB7XG4gICAgICAgICAgZGVwdGggPSAwO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCsrZGVwdGggPj0gMTApIHJldHVybiBzdWJPYmo7XG5cbiAgICAgICAgZm9yIChwcm9wIGluIHN1Yk9iaikge1xuICAgICAgICAgIGlmICh0eXBlb2Ygc3ViT2JqW3Byb3BdID09PSAnc3RyaW5nJyAmJiBzdWJPYmpbcHJvcF0uaW5kZXhPZihcIlslbGt0eHBdXCIpID09PSAwKSB7XG4gICAgICAgICAgICBwbmFtZSA9IHN1Yk9ialtwcm9wXS5zdWJzdHJpbmcoOCk7XG4gICAgICAgICAgICBpZiAocGFyYW1zLmhhc093blByb3BlcnR5KHBuYW1lKSkge1xuICAgICAgICAgICAgICBzdWJPYmpbcHJvcF0gPSBwYXJhbXNbcG5hbWVdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHN1Yk9ialtwcm9wXSA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgICAgc3ViT2JqW3Byb3BdID0gVXRpbHMucmVzb2x2ZVRyYW5zZm9ybU9iamVjdChzdWJPYmpbcHJvcF0sIHBhcmFtcywgZGVwdGgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzdWJPYmo7XG4gICAgICB9LFxuICAgICAgLy8gdG9wIGxldmVsIHV0aWxpdHkgdG8gcmVzb2x2ZSBhbiBlbnRpcmUgKHNpbmdsZSkgdHJhbnNmb3JtIChhcnJheSBvZiBzdGVwcykgZm9yIHBhcmFtZXRlciBzdWJzdGl0dXRpb25cbiAgICAgIHJlc29sdmVUcmFuc2Zvcm1QYXJhbXM6IGZ1bmN0aW9uICh0cmFuc2Zvcm0sIHBhcmFtcykge1xuICAgICAgICB2YXIgaWR4LFxuICAgICAgICAgIGNsb25lZFN0ZXAsXG4gICAgICAgICAgcmVzb2x2ZWRUcmFuc2Zvcm0gPSBbXTtcblxuICAgICAgICBpZiAodHlwZW9mIHBhcmFtcyA9PT0gJ3VuZGVmaW5lZCcpIHJldHVybiB0cmFuc2Zvcm07XG5cbiAgICAgICAgLy8gaXRlcmF0ZSBhbGwgc3RlcHMgaW4gdGhlIHRyYW5zZm9ybSBhcnJheVxuICAgICAgICBmb3IgKGlkeCA9IDA7IGlkeCA8IHRyYW5zZm9ybS5sZW5ndGg7IGlkeCsrKSB7XG4gICAgICAgICAgLy8gY2xvbmUgdHJhbnNmb3JtIHNvIG91ciBzY2FuL3JlcGxhY2UgY2FuIG9wZXJhdGUgZGlyZWN0bHkgb24gY2xvbmVkIHRyYW5zZm9ybVxuICAgICAgICAgIGNsb25lZFN0ZXAgPSBjbG9uZSh0cmFuc2Zvcm1baWR4XSwgXCJzaGFsbG93LXJlY3Vyc2Utb2JqZWN0c1wiKTtcbiAgICAgICAgICByZXNvbHZlZFRyYW5zZm9ybS5wdXNoKFV0aWxzLnJlc29sdmVUcmFuc2Zvcm1PYmplY3QoY2xvbmVkU3RlcCwgcGFyYW1zKSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcmVzb2x2ZWRUcmFuc2Zvcm07XG4gICAgICB9LFxuXG4gICAgICAvLyBCeSBkZWZhdWx0IChpZiB1c2luZ0RvdE5vdGF0aW9uIGlzIGZhbHNlKSwgbG9va3MgdXAgcGF0aCBpblxuICAgICAgLy8gb2JqZWN0IHZpYSBgb2JqZWN0W3BhdGhdYFxuICAgICAgLy9cbiAgICAgIC8vIElmIGB1c2luZ0RvdE5vdGF0aW9uYCBpcyB0cnVlLCB0aGVuIHRoZSBwYXRoIGlzIGFzc3VtZWQgdG9cbiAgICAgIC8vIHJlcHJlc2VudCBhIG5lc3RlZCBwYXRoLiBJdCBjYW4gYmUgaW4gdGhlIGZvcm0gb2YgYW4gYXJyYXkgb2ZcbiAgICAgIC8vIGZpZWxkIG5hbWVzLCBvciBhIHBlcmlvZCBkZWxpbWl0ZWQgc3RyaW5nLiBUaGUgZnVuY3Rpb24gd2lsbFxuICAgICAgLy8gbG9vayB1cCB0aGUgdmFsdWUgb2Ygb2JqZWN0W3BhdGhbMF1dLCBhbmQgdGhlbiBjYWxsXG4gICAgICAvLyByZXN1bHRbcGF0aFsxXV0gb24gdGhlIHJlc3VsdCwgZXRjIGV0Yy5cbiAgICAgIC8vXG4gICAgICAvLyBJZiBgdXNpbmdEb3ROb3RhdGlvbmAgaXMgdHJ1ZSwgdGhpcyBmdW5jdGlvbiBzdGlsbCBzdXBwb3J0c1xuICAgICAgLy8gbm9uIG5lc3RlZCBmaWVsZHMuXG4gICAgICAvL1xuICAgICAgLy8gYHVzaW5nRG90Tm90YXRpb25gIGlzIGEgcGVyZm9ybWFuY2Ugb3B0aW1pemF0aW9uLiBUaGUgY2FsbGVyXG4gICAgICAvLyBtYXkga25vdyB0aGF0IGEgcGF0aCBpcyAqbm90KiBuZXN0ZWQuIEluIHdoaWNoIGNhc2UsIHRoaXNcbiAgICAgIC8vIGZ1bmN0aW9uIGF2b2lkcyBhIGNvc3RseSBzdHJpbmcuc3BsaXQoJy4nKVxuICAgICAgLy9cbiAgICAgIC8vIGV4YW1wbGVzOlxuICAgICAgLy8gZ2V0SW4oe2E6IDF9LCBcImFcIikgPT4gMVxuICAgICAgLy8gZ2V0SW4oe2E6IDF9LCBcImFcIiwgdHJ1ZSkgPT4gMVxuICAgICAgLy8gZ2V0SW4oe2E6IHtiOiAxfX0sIFtcImFcIiwgXCJiXCJdLCB0cnVlKSA9PiAxXG4gICAgICAvLyBnZXRJbih7YToge2I6IDF9fSwgXCJhLmJcIiwgdHJ1ZSkgPT4gMVxuICAgICAgZ2V0SW46IGZ1bmN0aW9uIChvYmplY3QsIHBhdGgsIHVzaW5nRG90Tm90YXRpb24pIHtcbiAgICAgICAgaWYgKG9iamVjdCA9PSBudWxsKSB7XG4gICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXVzaW5nRG90Tm90YXRpb24pIHtcbiAgICAgICAgICByZXR1cm4gb2JqZWN0W3BhdGhdO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHR5cGVvZihwYXRoKSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgIHBhdGggPSBwYXRoLnNwbGl0KFwiLlwiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghQXJyYXkuaXNBcnJheShwYXRoKSkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInBhdGggbXVzdCBiZSBhIHN0cmluZyBvciBhcnJheS4gRm91bmQgXCIgKyB0eXBlb2YocGF0aCkpO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGluZGV4ID0gMCxcbiAgICAgICAgICBsZW5ndGggPSBwYXRoLmxlbmd0aDtcblxuICAgICAgICB3aGlsZSAob2JqZWN0ICE9IG51bGwgJiYgaW5kZXggPCBsZW5ndGgpIHtcbiAgICAgICAgICBvYmplY3QgPSBvYmplY3RbcGF0aFtpbmRleCsrXV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChpbmRleCAmJiBpbmRleCA9PSBsZW5ndGgpID8gb2JqZWN0IDogdW5kZWZpbmVkO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvLyB3cmFwcGluZyBpbiBvYmplY3QgdG8gZXhwb3NlIHRvIGRlZmF1bHQgZXhwb3J0IGZvciBwb3RlbnRpYWwgdXNlciBvdmVycmlkZS5cbiAgICAvLyB3YXJuaW5nOiBvdmVycmlkaW5nIHRoZXNlIG1ldGhvZHMgd2lsbCBvdmVycmlkZSBiZWhhdmlvciBmb3IgYWxsIGxva2kgZGIgaW5zdGFuY2VzIGluIG1lbW9yeS5cbiAgICAvLyB3YXJuaW5nOiBpZiB5b3UgdXNlIGJpbmFyeSBpbmRpY2VzIHRoZXNlIGNvbXBhcmF0b3JzIHNob3VsZCBiZSB0aGUgc2FtZSBmb3IgYWxsIGluc2VydHMvdXBkYXRlcy9yZW1vdmVzLlxuICAgIHZhciBDb21wYXJhdG9ycyA9IHtcbiAgICAgIGFlcTogYWVxSGVscGVyLFxuICAgICAgbHQ6IGx0SGVscGVyLFxuICAgICAgZ3Q6IGd0SGVscGVyXG4gICAgfTtcblxuICAgIC8qKiBIZWxwZXIgZnVuY3Rpb24gZm9yIGRldGVybWluaW5nICdsb2tpJyBhYnN0cmFjdCBlcXVhbGl0eSB3aGljaCBpcyBhIGxpdHRsZSBtb3JlIGFic3RyYWN0IHRoYW4gPT1cbiAgICAgKiAgICAgYWVxSGVscGVyKDUsICc1JykgPT09IHRydWVcbiAgICAgKiAgICAgYWVxSGVscGVyKDUuMCwgJzUnKSA9PT0gdHJ1ZVxuICAgICAqICAgICBhZXFIZWxwZXIobmV3IERhdGUoXCIxLzEvMjAxMVwiKSwgbmV3IERhdGUoXCIxLzEvMjAxMVwiKSkgPT09IHRydWVcbiAgICAgKiAgICAgYWVxSGVscGVyKHthOjF9LCB7ejo0fSkgPT09IHRydWUgKGFsbCBvYmplY3RzIHNvcnRlZCBlcXVhbGx5KVxuICAgICAqICAgICBhZXFIZWxwZXIoWzEsIDIsIDNdLCBbMSwgM10pID09PSBmYWxzZVxuICAgICAqICAgICBhZXFIZWxwZXIoWzEsIDIsIDNdLCBbMSwgMiwgM10pID09PSB0cnVlXG4gICAgICogICAgIGFlcUhlbHBlcih1bmRlZmluZWQsIG51bGwpID09PSB0cnVlXG4gICAgICovXG4gICAgZnVuY3Rpb24gYWVxSGVscGVyKHByb3AxLCBwcm9wMikge1xuICAgICAgdmFyIGN2MSwgY3YyLCB0MSwgdDI7XG5cbiAgICAgIGlmIChwcm9wMSA9PT0gcHJvcDIpIHJldHVybiB0cnVlO1xuXG4gICAgICAvLyAnZmFsc3knIGFuZCBCb29sZWFuIGhhbmRsaW5nXG4gICAgICBpZiAoIXByb3AxIHx8ICFwcm9wMiB8fCBwcm9wMSA9PT0gdHJ1ZSB8fCBwcm9wMiA9PT0gdHJ1ZSB8fCBwcm9wMSAhPT0gcHJvcDEgfHwgcHJvcDIgIT09IHByb3AyKSB7XG4gICAgICAgIC8vIGRhdGVzIGFuZCBOYU4gY29uZGl0aW9ucyAodHlwZWQgZGF0ZXMgYmVmb3JlIHNlcmlhbGl6YXRpb24pXG4gICAgICAgIHN3aXRjaCAocHJvcDEpIHtcbiAgICAgICAgICBjYXNlIHVuZGVmaW5lZDogdDEgPSAxOyBicmVhaztcbiAgICAgICAgICBjYXNlIG51bGw6IHQxID0gMTsgYnJlYWs7XG4gICAgICAgICAgY2FzZSBmYWxzZTogdDEgPSAzOyBicmVhaztcbiAgICAgICAgICBjYXNlIHRydWU6IHQxID0gNDsgYnJlYWs7XG4gICAgICAgICAgY2FzZSBcIlwiOiB0MSA9IDU7IGJyZWFrO1xuICAgICAgICAgIGRlZmF1bHQ6IHQxID0gKHByb3AxID09PSBwcm9wMSk/OTowOyBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIHN3aXRjaCAocHJvcDIpIHtcbiAgICAgICAgICBjYXNlIHVuZGVmaW5lZDogdDIgPSAxOyBicmVhaztcbiAgICAgICAgICBjYXNlIG51bGw6IHQyID0gMTsgYnJlYWs7XG4gICAgICAgICAgY2FzZSBmYWxzZTogdDIgPSAzOyBicmVhaztcbiAgICAgICAgICBjYXNlIHRydWU6IHQyID0gNDsgYnJlYWs7XG4gICAgICAgICAgY2FzZSBcIlwiOiB0MiA9IDU7IGJyZWFrO1xuICAgICAgICAgIGRlZmF1bHQ6IHQyID0gKHByb3AyID09PSBwcm9wMik/OTowOyBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIG9uZSBvciBib3RoIGlzIGVkZ2UgY2FzZVxuICAgICAgICBpZiAodDEgIT09IDkgfHwgdDIgIT09IDkpIHtcbiAgICAgICAgICByZXR1cm4gKHQxPT09dDIpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIEhhbmRsZSAnTnVtYmVyLWxpa2UnIGNvbXBhcmlzb25zXG4gICAgICBjdjEgPSBOdW1iZXIocHJvcDEpO1xuICAgICAgY3YyID0gTnVtYmVyKHByb3AyKTtcblxuICAgICAgLy8gaWYgb25lIG9yIGJvdGggYXJlICdudW1iZXItbGlrZScuLi5cbiAgICAgIGlmIChjdjEgPT09IGN2MSB8fCBjdjIgPT09IGN2Mikge1xuICAgICAgICByZXR1cm4gKGN2MSA9PT0gY3YyKTtcbiAgICAgIH1cblxuICAgICAgLy8gbm90IHN0cmljdCBlcXVhbCBub3IgbGVzcyB0aGFuIG5vciBndCBzbyBtdXN0IGJlIG1peGVkIHR5cGVzLCBjb252ZXJ0IHRvIHN0cmluZyBhbmQgdXNlIHRoYXQgdG8gY29tcGFyZVxuICAgICAgY3YxID0gcHJvcDEudG9TdHJpbmcoKTtcbiAgICAgIGN2MiA9IHByb3AyLnRvU3RyaW5nKCk7XG5cbiAgICAgIHJldHVybiAoY3YxID09IGN2Mik7XG4gICAgfVxuXG4gICAgLyoqIEhlbHBlciBmdW5jdGlvbiBmb3IgZGV0ZXJtaW5pbmcgJ2xlc3MtdGhhbicgY29uZGl0aW9ucyBmb3Igb3BzLCBzb3J0aW5nLCBhbmQgYmluYXJ5IGluZGljZXMuXG4gICAgICogICAgIEluIHRoZSBmdXR1cmUgd2UgbWlnaHQgd2FudCAkbHQgYW5kICRndCBvcHMgdG8gdXNlIHRoZWlyIG93biBmdW5jdGlvbmFsaXR5L2hlbHBlci5cbiAgICAgKiAgICAgU2luY2UgYmluYXJ5IGluZGljZXMgb24gYSBwcm9wZXJ0eSBtaWdodCBuZWVkIHRvIGluZGV4IFsxMiwgTmFOLCBuZXcgRGF0ZSgpLCBJbmZpbml0eV0sIHdlXG4gICAgICogICAgIG5lZWQgdGhpcyBmdW5jdGlvbiAoYXMgd2VsbCBhcyBndEhlbHBlcikgdG8gYWx3YXlzIGVuc3VyZSBvbmUgdmFsdWUgaXMgTFQsIEdULCBvciBFUSB0byBhbm90aGVyLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGx0SGVscGVyKHByb3AxLCBwcm9wMiwgZXF1YWwpIHtcbiAgICAgIHZhciBjdjEsIGN2MiwgdDEsIHQyO1xuXG4gICAgICAvLyBpZiBvbmUgb2YgdGhlIHBhcmFtcyBpcyBmYWxzeSBvciBzdHJpY3RseSB0cnVlIG9yIG5vdCBlcXVhbCB0byBpdHNlbGZcbiAgICAgIC8vIDAsIDAuMCwgXCJcIiwgTmFOLCBudWxsLCB1bmRlZmluZWQsIG5vdCBkZWZpbmVkLCBmYWxzZSwgdHJ1ZVxuICAgICAgaWYgKCFwcm9wMSB8fCAhcHJvcDIgfHwgcHJvcDEgPT09IHRydWUgfHwgcHJvcDIgPT09IHRydWUgfHwgcHJvcDEgIT09IHByb3AxIHx8IHByb3AyICE9PSBwcm9wMikge1xuICAgICAgICBzd2l0Y2ggKHByb3AxKSB7XG4gICAgICAgICAgY2FzZSB1bmRlZmluZWQ6IHQxID0gMTsgYnJlYWs7XG4gICAgICAgICAgY2FzZSBudWxsOiB0MSA9IDE7IGJyZWFrO1xuICAgICAgICAgIGNhc2UgZmFsc2U6IHQxID0gMzsgYnJlYWs7XG4gICAgICAgICAgY2FzZSB0cnVlOiB0MSA9IDQ7IGJyZWFrO1xuICAgICAgICAgIGNhc2UgXCJcIjogdDEgPSA1OyBicmVhaztcbiAgICAgICAgICAvLyBpZiBzdHJpY3QgZXF1YWwgcHJvYmFibHkgMCBzbyBzb3J0IGhpZ2hlciwgb3RoZXJ3aXNlIHByb2JhYmx5IE5hTiBzbyBzb3J0IGxvd2VyIHRoYW4gZXZlbiBudWxsXG4gICAgICAgICAgZGVmYXVsdDogdDEgPSAocHJvcDEgPT09IHByb3AxKT85OjA7IGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgc3dpdGNoIChwcm9wMikge1xuICAgICAgICAgIGNhc2UgdW5kZWZpbmVkOiB0MiA9IDE7IGJyZWFrO1xuICAgICAgICAgIGNhc2UgbnVsbDogdDIgPSAxOyBicmVhaztcbiAgICAgICAgICBjYXNlIGZhbHNlOiB0MiA9IDM7IGJyZWFrO1xuICAgICAgICAgIGNhc2UgdHJ1ZTogdDIgPSA0OyBicmVhaztcbiAgICAgICAgICBjYXNlIFwiXCI6IHQyID0gNTsgYnJlYWs7XG4gICAgICAgICAgZGVmYXVsdDogdDIgPSAocHJvcDIgPT09IHByb3AyKT85OjA7IGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gb25lIG9yIGJvdGggaXMgZWRnZSBjYXNlXG4gICAgICAgIGlmICh0MSAhPT0gOSB8fCB0MiAhPT0gOSkge1xuICAgICAgICAgIHJldHVybiAodDE9PT10Mik/ZXF1YWw6KHQxPHQyKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBpZiBib3RoIGFyZSBudW1iZXJzIChzdHJpbmcgZW5jb2RlZCBvciBub3QpLCBjb21wYXJlIGFzIG51bWJlcnNcbiAgICAgIGN2MSA9IE51bWJlcihwcm9wMSk7XG4gICAgICBjdjIgPSBOdW1iZXIocHJvcDIpO1xuXG4gICAgICBpZiAoY3YxID09PSBjdjEgJiYgY3YyID09PSBjdjIpIHtcbiAgICAgICAgaWYgKGN2MSA8IGN2MikgcmV0dXJuIHRydWU7XG4gICAgICAgIGlmIChjdjEgPiBjdjIpIHJldHVybiBmYWxzZTtcbiAgICAgICAgcmV0dXJuIGVxdWFsO1xuICAgICAgfVxuXG4gICAgICBpZiAoY3YxID09PSBjdjEgJiYgY3YyICE9PSBjdjIpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG5cbiAgICAgIGlmIChjdjIgPT09IGN2MiAmJiBjdjEgIT09IGN2MSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG5cbiAgICAgIGlmIChwcm9wMSA8IHByb3AyKSByZXR1cm4gdHJ1ZTtcbiAgICAgIGlmIChwcm9wMSA+IHByb3AyKSByZXR1cm4gZmFsc2U7XG4gICAgICBpZiAocHJvcDEgPT0gcHJvcDIpIHJldHVybiBlcXVhbDtcblxuICAgICAgLy8gbm90IHN0cmljdCBlcXVhbCBub3IgbGVzcyB0aGFuIG5vciBndCBzbyBtdXN0IGJlIG1peGVkIHR5cGVzLCBjb252ZXJ0IHRvIHN0cmluZyBhbmQgdXNlIHRoYXQgdG8gY29tcGFyZVxuICAgICAgY3YxID0gcHJvcDEudG9TdHJpbmcoKTtcbiAgICAgIGN2MiA9IHByb3AyLnRvU3RyaW5nKCk7XG5cbiAgICAgIGlmIChjdjEgPCBjdjIpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG5cbiAgICAgIGlmIChjdjEgPT0gY3YyKSB7XG4gICAgICAgIHJldHVybiBlcXVhbDtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGd0SGVscGVyKHByb3AxLCBwcm9wMiwgZXF1YWwpIHtcbiAgICAgIHZhciBjdjEsIGN2MiwgdDEsIHQyO1xuXG4gICAgICAvLyAnZmFsc3knIGFuZCBCb29sZWFuIGhhbmRsaW5nXG4gICAgICBpZiAoIXByb3AxIHx8ICFwcm9wMiB8fCBwcm9wMSA9PT0gdHJ1ZSB8fCBwcm9wMiA9PT0gdHJ1ZSB8fCBwcm9wMSAhPT0gcHJvcDEgfHwgcHJvcDIgIT09IHByb3AyKSB7XG4gICAgICAgIHN3aXRjaCAocHJvcDEpIHtcbiAgICAgICAgICBjYXNlIHVuZGVmaW5lZDogdDEgPSAxOyBicmVhaztcbiAgICAgICAgICBjYXNlIG51bGw6IHQxID0gMTsgYnJlYWs7XG4gICAgICAgICAgY2FzZSBmYWxzZTogdDEgPSAzOyBicmVhaztcbiAgICAgICAgICBjYXNlIHRydWU6IHQxID0gNDsgYnJlYWs7XG4gICAgICAgICAgY2FzZSBcIlwiOiB0MSA9IDU7IGJyZWFrO1xuICAgICAgICAgIC8vIE5hTiAwXG4gICAgICAgICAgZGVmYXVsdDogdDEgPSAocHJvcDEgPT09IHByb3AxKT85OjA7IGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgc3dpdGNoIChwcm9wMikge1xuICAgICAgICAgIGNhc2UgdW5kZWZpbmVkOiB0MiA9IDE7IGJyZWFrO1xuICAgICAgICAgIGNhc2UgbnVsbDogdDIgPSAxOyBicmVhaztcbiAgICAgICAgICBjYXNlIGZhbHNlOiB0MiA9IDM7IGJyZWFrO1xuICAgICAgICAgIGNhc2UgdHJ1ZTogdDIgPSA0OyBicmVhaztcbiAgICAgICAgICBjYXNlIFwiXCI6IHQyID0gNTsgYnJlYWs7XG4gICAgICAgICAgZGVmYXVsdDogdDIgPSAocHJvcDIgPT09IHByb3AyKT85OjA7IGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gb25lIG9yIGJvdGggaXMgZWRnZSBjYXNlXG4gICAgICAgIGlmICh0MSAhPT0gOSB8fCB0MiAhPT0gOSkge1xuICAgICAgICAgIHJldHVybiAodDE9PT10Mik/ZXF1YWw6KHQxPnQyKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBpZiBib3RoIGFyZSBudW1iZXJzIChzdHJpbmcgZW5jb2RlZCBvciBub3QpLCBjb21wYXJlIGFzIG51bWJlcnNcbiAgICAgIGN2MSA9IE51bWJlcihwcm9wMSk7XG4gICAgICBjdjIgPSBOdW1iZXIocHJvcDIpO1xuICAgICAgaWYgKGN2MSA9PT0gY3YxICYmIGN2MiA9PT0gY3YyKSB7XG4gICAgICAgIGlmIChjdjEgPiBjdjIpIHJldHVybiB0cnVlO1xuICAgICAgICBpZiAoY3YxIDwgY3YyKSByZXR1cm4gZmFsc2U7XG4gICAgICAgIHJldHVybiBlcXVhbDtcbiAgICAgIH1cblxuICAgICAgaWYgKGN2MSA9PT0gY3YxICYmIGN2MiAhPT0gY3YyKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgaWYgKGN2MiA9PT0gY3YyICYmIGN2MSAhPT0gY3YxKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuXG4gICAgICBpZiAocHJvcDEgPiBwcm9wMikgcmV0dXJuIHRydWU7XG4gICAgICBpZiAocHJvcDEgPCBwcm9wMikgcmV0dXJuIGZhbHNlO1xuICAgICAgaWYgKHByb3AxID09IHByb3AyKSByZXR1cm4gZXF1YWw7XG5cbiAgICAgIC8vIG5vdCBzdHJpY3QgZXF1YWwgbm9yIGxlc3MgdGhhbiBub3IgZ3Qgc28gbXVzdCBiZSBkYXRlcyBvciBtaXhlZCB0eXBlc1xuICAgICAgLy8gY29udmVydCB0byBzdHJpbmcgYW5kIHVzZSB0aGF0IHRvIGNvbXBhcmVcbiAgICAgIGN2MSA9IHByb3AxLnRvU3RyaW5nKCk7XG4gICAgICBjdjIgPSBwcm9wMi50b1N0cmluZygpO1xuXG4gICAgICBpZiAoY3YxID4gY3YyKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuXG4gICAgICBpZiAoY3YxID09IGN2Mikge1xuICAgICAgICByZXR1cm4gZXF1YWw7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzb3J0SGVscGVyKHByb3AxLCBwcm9wMiwgZGVzYykge1xuICAgICAgaWYgKENvbXBhcmF0b3JzLmFlcShwcm9wMSwgcHJvcDIpKSByZXR1cm4gMDtcblxuICAgICAgaWYgKENvbXBhcmF0b3JzLmx0KHByb3AxLCBwcm9wMiwgZmFsc2UpKSB7XG4gICAgICAgIHJldHVybiAoZGVzYykgPyAoMSkgOiAoLTEpO1xuICAgICAgfVxuXG4gICAgICBpZiAoQ29tcGFyYXRvcnMuZ3QocHJvcDEsIHByb3AyLCBmYWxzZSkpIHtcbiAgICAgICAgcmV0dXJuIChkZXNjKSA/ICgtMSkgOiAoMSk7XG4gICAgICB9XG5cbiAgICAgIC8vIG5vdCBsdCwgbm90IGd0IHNvIGltcGxpZWQgZXF1YWxpdHktLSBkYXRlIGNvbXBhdGlibGVcbiAgICAgIHJldHVybiAwO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGNvbXBvdW5kZXZhbCgpIC0gaGVscGVyIGZ1bmN0aW9uIGZvciBjb21wb3VuZHNvcnQoKSwgcGVyZm9ybWluZyBpbmRpdmlkdWFsIG9iamVjdCBjb21wYXJpc29uc1xuICAgICAqXG4gICAgICogQHBhcmFtIHthcnJheX0gcHJvcGVydGllcyAtIGFycmF5IG9mIHByb3BlcnR5IG5hbWVzLCBpbiBvcmRlciwgYnkgd2hpY2ggdG8gZXZhbHVhdGUgc29ydCBvcmRlclxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBvYmoxIC0gZmlyc3Qgb2JqZWN0IHRvIGNvbXBhcmVcbiAgICAgKiBAcGFyYW0ge29iamVjdH0gb2JqMiAtIHNlY29uZCBvYmplY3QgdG8gY29tcGFyZVxuICAgICAqIEByZXR1cm5zIHtpbnRlZ2VyfSAwLCAtMSwgb3IgMSB0byBkZXNpZ25hdGUgaWYgaWRlbnRpY2FsIChzb3J0d2lzZSkgb3Igd2hpY2ggc2hvdWxkIGJlIGZpcnN0XG4gICAgICovXG4gICAgZnVuY3Rpb24gY29tcG91bmRldmFsKHByb3BlcnRpZXMsIG9iajEsIG9iajIpIHtcbiAgICAgIHZhciByZXMgPSAwO1xuICAgICAgdmFyIHByb3AsIGZpZWxkLCB2YWwxLCB2YWwyLCBhcnIsIHBhdGg7XG4gICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gcHJvcGVydGllcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBwcm9wID0gcHJvcGVydGllc1tpXTtcbiAgICAgICAgZmllbGQgPSBwcm9wWzBdO1xuICAgICAgICBpZiAofmZpZWxkLmluZGV4T2YoJy4nKSkge1xuICAgICAgICAgIGFyciA9IGZpZWxkLnNwbGl0KCcuJyk7XG4gICAgICAgICAgdmFsMSA9IFV0aWxzLmdldEluKG9iajEsIGFyciwgdHJ1ZSk7XG4gICAgICAgICAgdmFsMiA9IFV0aWxzLmdldEluKG9iajIsIGFyciwgdHJ1ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdmFsMSA9IG9iajFbZmllbGRdO1xuICAgICAgICAgIHZhbDIgPSBvYmoyW2ZpZWxkXTtcbiAgICAgICAgfVxuICAgICAgICByZXMgPSBzb3J0SGVscGVyKHZhbDEsIHZhbDIsIHByb3BbMV0pO1xuICAgICAgICBpZiAocmVzICE9PSAwKSB7XG4gICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIDA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogZG90U3ViU2NhbiAtIGhlbHBlciBmdW5jdGlvbiB1c2VkIGZvciBkb3Qgbm90YXRpb24gcXVlcmllcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSByb290IC0gb2JqZWN0IHRvIHRyYXZlcnNlXG4gICAgICogQHBhcmFtIHthcnJheX0gcGF0aHMgLSBhcnJheSBvZiBwcm9wZXJ0aWVzIHRvIGRyaWxsIGludG9cbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBmdW4gLSBldmFsdWF0aW9uIGZ1bmN0aW9uIHRvIHRlc3Qgd2l0aFxuICAgICAqIEBwYXJhbSB7YW55fSB2YWx1ZSAtIGNvbXBhcmF0aXZlIHZhbHVlIHRvIGFsc28gcGFzcyB0byAoY29tcGFyZSkgZnVuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHBvZmZzZXQgLSBpbmRleCBvZiB0aGUgaXRlbSBpbiAncGF0aHMnIHRvIHN0YXJ0IHRoZSBzdWItc2NhbiBmcm9tXG4gICAgICovXG4gICAgZnVuY3Rpb24gZG90U3ViU2Nhbihyb290LCBwYXRocywgZnVuLCB2YWx1ZSwgcG9mZnNldCkge1xuICAgICAgdmFyIHBhdGhPZmZzZXQgPSBwb2Zmc2V0IHx8IDA7XG4gICAgICB2YXIgcGF0aCA9IHBhdGhzW3BhdGhPZmZzZXRdO1xuXG4gICAgICB2YXIgdmFsdWVGb3VuZCA9IGZhbHNlO1xuICAgICAgdmFyIGVsZW1lbnQ7XG4gICAgICBpZiAodHlwZW9mIHJvb3QgPT09ICdvYmplY3QnICYmIHBhdGggaW4gcm9vdCkge1xuICAgICAgICBlbGVtZW50ID0gcm9vdFtwYXRoXTtcbiAgICAgIH1cbiAgICAgIGlmIChwYXRoT2Zmc2V0ICsgMSA+PSBwYXRocy5sZW5ndGgpIHtcbiAgICAgICAgLy8gaWYgd2UgaGF2ZSBhbHJlYWR5IGV4cGFuZGVkIG91dCB0aGUgZG90IG5vdGF0aW9uLFxuICAgICAgICAvLyB0aGVuIGp1c3QgZXZhbHVhdGUgdGhlIHRlc3QgZnVuY3Rpb24gYW5kIHZhbHVlIG9uIHRoZSBlbGVtZW50XG4gICAgICAgIHZhbHVlRm91bmQgPSBmdW4oZWxlbWVudCwgdmFsdWUpO1xuICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KGVsZW1lbnQpKSB7XG4gICAgICAgIGZvciAodmFyIGluZGV4ID0gMCwgbGVuID0gZWxlbWVudC5sZW5ndGg7IGluZGV4IDwgbGVuOyBpbmRleCArPSAxKSB7XG4gICAgICAgICAgdmFsdWVGb3VuZCA9IGRvdFN1YlNjYW4oZWxlbWVudFtpbmRleF0sIHBhdGhzLCBmdW4sIHZhbHVlLCBwYXRoT2Zmc2V0ICsgMSk7XG4gICAgICAgICAgaWYgKHZhbHVlRm91bmQgPT09IHRydWUpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFsdWVGb3VuZCA9IGRvdFN1YlNjYW4oZWxlbWVudCwgcGF0aHMsIGZ1biwgdmFsdWUsIHBhdGhPZmZzZXQgKyAxKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHZhbHVlRm91bmQ7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY29udGFpbnNDaGVja0ZuKGEpIHtcbiAgICAgIGlmICh0eXBlb2YgYSA9PT0gJ3N0cmluZycgfHwgQXJyYXkuaXNBcnJheShhKSkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGIpIHtcbiAgICAgICAgICByZXR1cm4gYS5pbmRleE9mKGIpICE9PSAtMTtcbiAgICAgICAgfTtcbiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGEgPT09ICdvYmplY3QnICYmIGEgIT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChiKSB7XG4gICAgICAgICAgcmV0dXJuIGhhc093blByb3BlcnR5LmNhbGwoYSwgYik7XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkb1F1ZXJ5T3AodmFsLCBvcCkge1xuICAgICAgZm9yICh2YXIgcCBpbiBvcCkge1xuICAgICAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbChvcCwgcCkpIHtcbiAgICAgICAgICByZXR1cm4gTG9raU9wc1twXSh2YWwsIG9wW3BdKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHZhciBMb2tpT3BzID0ge1xuICAgICAgLy8gY29tcGFyaXNvbiBvcGVyYXRvcnNcbiAgICAgIC8vIGEgaXMgdGhlIHZhbHVlIGluIHRoZSBjb2xsZWN0aW9uXG4gICAgICAvLyBiIGlzIHRoZSBxdWVyeSB2YWx1ZVxuICAgICAgJGVxOiBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICByZXR1cm4gYSA9PT0gYjtcbiAgICAgIH0sXG5cbiAgICAgIC8vIGFic3RyYWN0L2xvb3NlIGVxdWFsaXR5XG4gICAgICAkYWVxOiBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICByZXR1cm4gYSA9PSBiO1xuICAgICAgfSxcblxuICAgICAgJG5lOiBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICAvLyBlY21hIDUgc2FmZSB0ZXN0IGZvciBOYU5cbiAgICAgICAgaWYgKGIgIT09IGIpIHtcbiAgICAgICAgICAvLyBlY21hIDUgdGVzdCB2YWx1ZSBpcyBub3QgTmFOXG4gICAgICAgICAgcmV0dXJuIChhID09PSBhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBhICE9PSBiO1xuICAgICAgfSxcbiAgICAgIC8vIGRhdGUgZXF1YWxpdHkgLyBsb2tpIGFic3RyYWN0IGVxdWFsaXR5IHRlc3RcbiAgICAgICRkdGVxOiBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICByZXR1cm4gQ29tcGFyYXRvcnMuYWVxKGEsIGIpO1xuICAgICAgfSxcblxuICAgICAgLy8gbG9raSBjb21wYXJpc29uczogcmV0dXJuIGlkZW50aWNhbCB1bmluZGV4ZWQgcmVzdWx0cyBhcyBpbmRleGVkIGNvbXBhcmlzb25zXG4gICAgICAkZ3Q6IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgIHJldHVybiBDb21wYXJhdG9ycy5ndChhLCBiLCBmYWxzZSk7XG4gICAgICB9LFxuXG4gICAgICAkZ3RlOiBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICByZXR1cm4gQ29tcGFyYXRvcnMuZ3QoYSwgYiwgdHJ1ZSk7XG4gICAgICB9LFxuXG4gICAgICAkbHQ6IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgIHJldHVybiBDb21wYXJhdG9ycy5sdChhLCBiLCBmYWxzZSk7XG4gICAgICB9LFxuXG4gICAgICAkbHRlOiBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICByZXR1cm4gQ29tcGFyYXRvcnMubHQoYSwgYiwgdHJ1ZSk7XG4gICAgICB9LFxuXG4gICAgICAvLyBsaWdodHdlaWdodCBqYXZhc2NyaXB0IGNvbXBhcmlzb25zXG4gICAgICAkamd0OiBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICByZXR1cm4gYSA+IGI7XG4gICAgICB9LFxuXG4gICAgICAkamd0ZTogZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgcmV0dXJuIGEgPj0gYjtcbiAgICAgIH0sXG5cbiAgICAgICRqbHQ6IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgIHJldHVybiBhIDwgYjtcbiAgICAgIH0sXG5cbiAgICAgICRqbHRlOiBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICByZXR1cm4gYSA8PSBiO1xuICAgICAgfSxcblxuICAgICAgLy8gZXggOiBjb2xsLmZpbmQoeydvcmRlckNvdW50JzogeyRiZXR3ZWVuOiBbMTAsIDUwXX19KTtcbiAgICAgICRiZXR3ZWVuOiBmdW5jdGlvbiAoYSwgdmFscykge1xuICAgICAgICBpZiAoYSA9PT0gdW5kZWZpbmVkIHx8IGEgPT09IG51bGwpIHJldHVybiBmYWxzZTtcbiAgICAgICAgcmV0dXJuIChDb21wYXJhdG9ycy5ndChhLCB2YWxzWzBdLCB0cnVlKSAmJiBDb21wYXJhdG9ycy5sdChhLCB2YWxzWzFdLCB0cnVlKSk7XG4gICAgICB9LFxuXG4gICAgICAkamJldHdlZW46IGZ1bmN0aW9uIChhLCB2YWxzKSB7XG4gICAgICAgIGlmIChhID09PSB1bmRlZmluZWQgfHwgYSA9PT0gbnVsbCkgcmV0dXJuIGZhbHNlO1xuICAgICAgICByZXR1cm4gKGEgPj0gdmFsc1swXSAmJiBhIDw9IHZhbHNbMV0pO1xuICAgICAgfSxcblxuICAgICAgJGluOiBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICByZXR1cm4gYi5pbmRleE9mKGEpICE9PSAtMTtcbiAgICAgIH0sXG5cbiAgICAgICRuaW46IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgIHJldHVybiBiLmluZGV4T2YoYSkgPT09IC0xO1xuICAgICAgfSxcblxuICAgICAgJGtleWluOiBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICByZXR1cm4gYSBpbiBiO1xuICAgICAgfSxcblxuICAgICAgJG5rZXlpbjogZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgcmV0dXJuICEoYSBpbiBiKTtcbiAgICAgIH0sXG5cbiAgICAgICRkZWZpbmVkaW46IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgIHJldHVybiBiW2FdICE9PSB1bmRlZmluZWQ7XG4gICAgICB9LFxuXG4gICAgICAkdW5kZWZpbmVkaW46IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgIHJldHVybiBiW2FdID09PSB1bmRlZmluZWQ7XG4gICAgICB9LFxuXG4gICAgICAkcmVnZXg6IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgIHJldHVybiBiLnRlc3QoYSk7XG4gICAgICB9LFxuXG4gICAgICAkY29udGFpbnNTdHJpbmc6IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgIHJldHVybiAodHlwZW9mIGEgPT09ICdzdHJpbmcnKSAmJiAoYS5pbmRleE9mKGIpICE9PSAtMSk7XG4gICAgICB9LFxuXG4gICAgICAkY29udGFpbnNOb25lOiBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICByZXR1cm4gIUxva2lPcHMuJGNvbnRhaW5zQW55KGEsIGIpO1xuICAgICAgfSxcblxuICAgICAgJGNvbnRhaW5zQW55OiBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICB2YXIgY2hlY2tGbiA9IGNvbnRhaW5zQ2hlY2tGbihhKTtcbiAgICAgICAgaWYgKGNoZWNrRm4gIT09IG51bGwpIHtcbiAgICAgICAgICByZXR1cm4gKEFycmF5LmlzQXJyYXkoYikpID8gKGIuc29tZShjaGVja0ZuKSkgOiAoY2hlY2tGbihiKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfSxcblxuICAgICAgJGNvbnRhaW5zOiBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICB2YXIgY2hlY2tGbiA9IGNvbnRhaW5zQ2hlY2tGbihhKTtcbiAgICAgICAgaWYgKGNoZWNrRm4gIT09IG51bGwpIHtcbiAgICAgICAgICByZXR1cm4gKEFycmF5LmlzQXJyYXkoYikpID8gKGIuZXZlcnkoY2hlY2tGbikpIDogKGNoZWNrRm4oYikpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH0sXG5cbiAgICAgICR0eXBlOiBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICB2YXIgdHlwZSA9IHR5cGVvZiBhO1xuICAgICAgICBpZiAodHlwZSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShhKSkge1xuICAgICAgICAgICAgdHlwZSA9ICdhcnJheSc7XG4gICAgICAgICAgfSBlbHNlIGlmIChhIGluc3RhbmNlb2YgRGF0ZSkge1xuICAgICAgICAgICAgdHlwZSA9ICdkYXRlJztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICh0eXBlb2YgYiAhPT0gJ29iamVjdCcpID8gKHR5cGUgPT09IGIpIDogZG9RdWVyeU9wKHR5cGUsIGIpO1xuICAgICAgfSxcblxuICAgICAgJGZpbml0ZTogZnVuY3Rpb24oYSwgYikge1xuICAgICAgICByZXR1cm4gKGIgPT09IGlzRmluaXRlKGEpKTtcbiAgICAgIH0sXG5cbiAgICAgICRzaXplOiBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShhKSkge1xuICAgICAgICAgIHJldHVybiAodHlwZW9mIGIgIT09ICdvYmplY3QnKSA/IChhLmxlbmd0aCA9PT0gYikgOiBkb1F1ZXJ5T3AoYS5sZW5ndGgsIGIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH0sXG5cbiAgICAgICRsZW46IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICByZXR1cm4gKHR5cGVvZiBiICE9PSAnb2JqZWN0JykgPyAoYS5sZW5ndGggPT09IGIpIDogZG9RdWVyeU9wKGEubGVuZ3RoLCBiKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9LFxuXG4gICAgICAkd2hlcmU6IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgIHJldHVybiBiKGEpID09PSB0cnVlO1xuICAgICAgfSxcblxuICAgICAgLy8gZmllbGQtbGV2ZWwgbG9naWNhbCBvcGVyYXRvcnNcbiAgICAgIC8vIGEgaXMgdGhlIHZhbHVlIGluIHRoZSBjb2xsZWN0aW9uXG4gICAgICAvLyBiIGlzIHRoZSBuZXN0ZWQgcXVlcnkgb3BlcmF0aW9uIChmb3IgJyRub3QnKVxuICAgICAgLy8gICBvciBhbiBhcnJheSBvZiBuZXN0ZWQgcXVlcnkgb3BlcmF0aW9ucyAoZm9yICckYW5kJyBhbmQgJyRvcicpXG4gICAgICAkbm90OiBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICByZXR1cm4gIWRvUXVlcnlPcChhLCBiKTtcbiAgICAgIH0sXG5cbiAgICAgICRhbmQ6IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgIGZvciAodmFyIGlkeCA9IDAsIGxlbiA9IGIubGVuZ3RoOyBpZHggPCBsZW47IGlkeCArPSAxKSB7XG4gICAgICAgICAgaWYgKCFkb1F1ZXJ5T3AoYSwgYltpZHhdKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH0sXG5cbiAgICAgICRvcjogZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgZm9yICh2YXIgaWR4ID0gMCwgbGVuID0gYi5sZW5ndGg7IGlkeCA8IGxlbjsgaWR4ICs9IDEpIHtcbiAgICAgICAgICBpZiAoZG9RdWVyeU9wKGEsIGJbaWR4XSkpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9LFxuXG4gICAgICAkZXhpc3RzOiBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICBpZiAoYikge1xuICAgICAgICAgIHJldHVybiBhICE9PSB1bmRlZmluZWQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIGEgPT09IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG5cbiAgICAvLyBpZiBhbiBvcCBpcyByZWdpc3RlcmVkIGluIHRoaXMgb2JqZWN0LCBvdXIgJ2NhbGN1bGF0ZVJhbmdlJyBjYW4gdXNlIGl0IHdpdGggb3VyIGJpbmFyeSBpbmRpY2VzLlxuICAgIC8vIGlmIHRoZSBvcCBpcyByZWdpc3RlcmVkIHRvIGEgZnVuY3Rpb24sIHdlIHdpbGwgcnVuIHRoYXQgZnVuY3Rpb24vb3AgYXMgYSAybmQgcGFzcyBmaWx0ZXIgb24gcmVzdWx0cy5cbiAgICAvLyB0aG9zZSAybmQgcGFzcyBmaWx0ZXIgZnVuY3Rpb25zIHNob3VsZCBiZSBzaW1pbGFyIHRvIExva2lPcHMgZnVuY3Rpb25zLCBhY2NlcHRpbmcgMiB2YWxzIHRvIGNvbXBhcmUuXG4gICAgdmFyIGluZGV4ZWRPcHMgPSB7XG4gICAgICAkZXE6IExva2lPcHMuJGVxLFxuICAgICAgJGFlcTogdHJ1ZSxcbiAgICAgICRkdGVxOiB0cnVlLFxuICAgICAgJGd0OiB0cnVlLFxuICAgICAgJGd0ZTogdHJ1ZSxcbiAgICAgICRsdDogdHJ1ZSxcbiAgICAgICRsdGU6IHRydWUsXG4gICAgICAkaW46IHRydWUsXG4gICAgICAkYmV0d2VlbjogdHJ1ZVxuICAgIH07XG5cbiAgICBmdW5jdGlvbiBjbG9uZShkYXRhLCBtZXRob2QpIHtcbiAgICAgIGlmIChkYXRhID09PSBudWxsIHx8IGRhdGEgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cblxuICAgICAgdmFyIGNsb25lTWV0aG9kID0gbWV0aG9kIHx8ICdwYXJzZS1zdHJpbmdpZnknLFxuICAgICAgICBjbG9uZWQ7XG5cbiAgICAgIHN3aXRjaCAoY2xvbmVNZXRob2QpIHtcbiAgICAgIGNhc2UgXCJwYXJzZS1zdHJpbmdpZnlcIjpcbiAgICAgICAgY2xvbmVkID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShkYXRhKSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBcImpxdWVyeS1leHRlbmQtZGVlcFwiOlxuICAgICAgICBjbG9uZWQgPSBqUXVlcnkuZXh0ZW5kKHRydWUsIHt9LCBkYXRhKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFwic2hhbGxvd1wiOlxuICAgICAgICAvLyBtb3JlIGNvbXBhdGlibGUgbWV0aG9kIGZvciBvbGRlciBicm93c2Vyc1xuICAgICAgICBjbG9uZWQgPSBPYmplY3QuY3JlYXRlKGRhdGEuY29uc3RydWN0b3IucHJvdG90eXBlKTtcbiAgICAgICAgT2JqZWN0LmtleXMoZGF0YSkubWFwKGZ1bmN0aW9uIChpKSB7XG4gICAgICAgICAgY2xvbmVkW2ldID0gZGF0YVtpXTtcbiAgICAgICAgfSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBcInNoYWxsb3ctYXNzaWduXCI6XG4gICAgICAgIC8vIHNob3VsZCBiZSBzdXBwb3J0ZWQgYnkgbmV3ZXIgZW52aXJvbm1lbnRzL2Jyb3dzZXJzXG4gICAgICAgIGNsb25lZCA9IE9iamVjdC5jcmVhdGUoZGF0YS5jb25zdHJ1Y3Rvci5wcm90b3R5cGUpO1xuICAgICAgICBPYmplY3QuYXNzaWduKGNsb25lZCwgZGF0YSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBcInNoYWxsb3ctcmVjdXJzZS1vYmplY3RzXCI6XG4gICAgICAgIC8vIHNoYWxsb3cgY2xvbmUgdG9wIGxldmVsIHByb3BlcnRpZXNcbiAgICAgICAgY2xvbmVkID0gY2xvbmUoZGF0YSwgXCJzaGFsbG93XCIpO1xuICAgICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKGRhdGEpO1xuICAgICAgICAvLyBmb3IgZWFjaCBvZiB0aGUgdG9wIGxldmVsIHByb3BlcnRpZXMgd2hpY2ggYXJlIG9iamVjdCBsaXRlcmFscywgcmVjdXJzaXZlbHkgc2hhbGxvdyBjb3B5XG4gICAgICAgIGtleXMuZm9yRWFjaChmdW5jdGlvbihrZXkpIHtcbiAgICAgICAgICBpZiAodHlwZW9mIGRhdGFba2V5XSA9PT0gXCJvYmplY3RcIiAmJiBkYXRhW2tleV0uY29uc3RydWN0b3IubmFtZSA9PT0gXCJPYmplY3RcIikgIHtcbiAgICAgICAgICAgIGNsb25lZFtrZXldID0gY2xvbmUoZGF0YVtrZXldLCBcInNoYWxsb3ctcmVjdXJzZS1vYmplY3RzXCIpO1xuICAgICAgICAgIH1lbHNlIGlmKEFycmF5LmlzQXJyYXkoZGF0YVtrZXldKSl7XG4gICAgICAgICAgICBjbG9uZWRba2V5XSA9IGNsb25lT2JqZWN0QXJyYXkoZGF0YVtrZXldLCBcInNoYWxsb3ctcmVjdXJzZS1vYmplY3RzXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBjbG9uZWQ7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY2xvbmVPYmplY3RBcnJheShvYmphcnJheSwgbWV0aG9kKSB7XG4gICAgICBpZiAobWV0aG9kID09IFwicGFyc2Utc3RyaW5naWZ5XCIpIHtcbiAgICAgICAgcmV0dXJuIGNsb25lKG9iamFycmF5LCBtZXRob2QpO1xuICAgICAgfVxuICAgICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IG9iamFycmF5Lmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIHJlc3VsdFtpXSA9IGNsb25lKG9iamFycmF5W2ldLCBtZXRob2QpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBsb2NhbFN0b3JhZ2VBdmFpbGFibGUoKSB7XG4gICAgICB0cnkge1xuICAgICAgICByZXR1cm4gKHdpbmRvdyAmJiB3aW5kb3cubG9jYWxTdG9yYWdlICE9PSB1bmRlZmluZWQgJiYgd2luZG93LmxvY2FsU3RvcmFnZSAhPT0gbnVsbCk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG5cblxuICAgIC8qKlxuICAgICAqIExva2lFdmVudEVtaXR0ZXIgaXMgYSBtaW5pbWFsaXN0IHZlcnNpb24gb2YgRXZlbnRFbWl0dGVyLiBJdCBlbmFibGVzIGFueVxuICAgICAqIGNvbnN0cnVjdG9yIHRoYXQgaW5oZXJpdHMgRXZlbnRFbWl0dGVyIHRvIGVtaXQgZXZlbnRzIGFuZCB0cmlnZ2VyXG4gICAgICogbGlzdGVuZXJzIHRoYXQgaGF2ZSBiZWVuIGFkZGVkIHRvIHRoZSBldmVudCB0aHJvdWdoIHRoZSBvbihldmVudCwgY2FsbGJhY2spIG1ldGhvZFxuICAgICAqXG4gICAgICogQGNvbnN0cnVjdG9yIExva2lFdmVudEVtaXR0ZXJcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBMb2tpRXZlbnRFbWl0dGVyKCkge31cblxuICAgIC8qKlxuICAgICAqIEBwcm9wIHtoYXNobWFwfSBldmVudHMgLSBhIGhhc2htYXAsIHdpdGggZWFjaCBwcm9wZXJ0eSBiZWluZyBhbiBhcnJheSBvZiBjYWxsYmFja3NcbiAgICAgKiBAbWVtYmVyb2YgTG9raUV2ZW50RW1pdHRlclxuICAgICAqL1xuICAgIExva2lFdmVudEVtaXR0ZXIucHJvdG90eXBlLmV2ZW50cyA9IHt9O1xuXG4gICAgLyoqXG4gICAgICogQHByb3Age2Jvb2xlYW59IGFzeW5jTGlzdGVuZXJzIC0gYm9vbGVhbiBkZXRlcm1pbmVzIHdoZXRoZXIgb3Igbm90IHRoZSBjYWxsYmFja3MgYXNzb2NpYXRlZCB3aXRoIGVhY2ggZXZlbnRcbiAgICAgKiBzaG91bGQgaGFwcGVuIGluIGFuIGFzeW5jIGZhc2hpb24gb3Igbm90XG4gICAgICogRGVmYXVsdCBpcyBmYWxzZSwgd2hpY2ggbWVhbnMgZXZlbnRzIGFyZSBzeW5jaHJvbm91c1xuICAgICAqIEBtZW1iZXJvZiBMb2tpRXZlbnRFbWl0dGVyXG4gICAgICovXG4gICAgTG9raUV2ZW50RW1pdHRlci5wcm90b3R5cGUuYXN5bmNMaXN0ZW5lcnMgPSBmYWxzZTtcblxuICAgIC8qKlxuICAgICAqIG9uKGV2ZW50TmFtZSwgbGlzdGVuZXIpIC0gYWRkcyBhIGxpc3RlbmVyIHRvIHRoZSBxdWV1ZSBvZiBjYWxsYmFja3MgYXNzb2NpYXRlZCB0byBhbiBldmVudFxuICAgICAqIEBwYXJhbSB7c3RyaW5nfHN0cmluZ1tdfSBldmVudE5hbWUgLSB0aGUgbmFtZShzKSBvZiB0aGUgZXZlbnQocykgdG8gbGlzdGVuIHRvXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbn0gbGlzdGVuZXIgLSBjYWxsYmFjayBmdW5jdGlvbiBvZiBsaXN0ZW5lciB0byBhdHRhY2hcbiAgICAgKiBAcmV0dXJucyB7aW50fSB0aGUgaW5kZXggb2YgdGhlIGNhbGxiYWNrIGluIHRoZSBhcnJheSBvZiBsaXN0ZW5lcnMgZm9yIGEgcGFydGljdWxhciBldmVudFxuICAgICAqIEBtZW1iZXJvZiBMb2tpRXZlbnRFbWl0dGVyXG4gICAgICovXG4gICAgTG9raUV2ZW50RW1pdHRlci5wcm90b3R5cGUub24gPSBmdW5jdGlvbiAoZXZlbnROYW1lLCBsaXN0ZW5lcikge1xuICAgICAgdmFyIGV2ZW50O1xuICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgICBpZiAoQXJyYXkuaXNBcnJheShldmVudE5hbWUpKSB7XG4gICAgICAgIGV2ZW50TmFtZS5mb3JFYWNoKGZ1bmN0aW9uKGN1cnJlbnRFdmVudE5hbWUpIHtcbiAgICAgICAgICBzZWxmLm9uKGN1cnJlbnRFdmVudE5hbWUsIGxpc3RlbmVyKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBsaXN0ZW5lcjtcbiAgICAgIH1cblxuICAgICAgZXZlbnQgPSB0aGlzLmV2ZW50c1tldmVudE5hbWVdO1xuICAgICAgaWYgKCFldmVudCkge1xuICAgICAgICBldmVudCA9IHRoaXMuZXZlbnRzW2V2ZW50TmFtZV0gPSBbXTtcbiAgICAgIH1cbiAgICAgIGV2ZW50LnB1c2gobGlzdGVuZXIpO1xuICAgICAgcmV0dXJuIGxpc3RlbmVyO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBlbWl0KGV2ZW50TmFtZSwgZGF0YSkgLSBlbWl0cyBhIHBhcnRpY3VsYXIgZXZlbnRcbiAgICAgKiB3aXRoIHRoZSBvcHRpb24gb2YgcGFzc2luZyBvcHRpb25hbCBwYXJhbWV0ZXJzIHdoaWNoIGFyZSBnb2luZyB0byBiZSBwcm9jZXNzZWQgYnkgdGhlIGNhbGxiYWNrXG4gICAgICogcHJvdmlkZWQgc2lnbmF0dXJlcyBtYXRjaCAoaS5lLiBpZiBwYXNzaW5nIGVtaXQoZXZlbnQsIGFyZzAsIGFyZzEpIHRoZSBsaXN0ZW5lciBzaG91bGQgdGFrZSB0d28gcGFyYW1ldGVycylcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZXZlbnROYW1lIC0gdGhlIG5hbWUgb2YgdGhlIGV2ZW50XG4gICAgICogQHBhcmFtIHtvYmplY3Q9fSBkYXRhIC0gb3B0aW9uYWwgb2JqZWN0IHBhc3NlZCB3aXRoIHRoZSBldmVudFxuICAgICAqIEBtZW1iZXJvZiBMb2tpRXZlbnRFbWl0dGVyXG4gICAgICovXG4gICAgTG9raUV2ZW50RW1pdHRlci5wcm90b3R5cGUuZW1pdCA9IGZ1bmN0aW9uIChldmVudE5hbWUpIHtcbiAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgIHZhciBzZWxmQXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7XG4gICAgICBpZiAoZXZlbnROYW1lICYmIHRoaXMuZXZlbnRzW2V2ZW50TmFtZV0pIHtcbiAgICAgICAgdGhpcy5ldmVudHNbZXZlbnROYW1lXS5mb3JFYWNoKGZ1bmN0aW9uIChsaXN0ZW5lcikge1xuICAgICAgICAgIGlmIChzZWxmLmFzeW5jTGlzdGVuZXJzKSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgbGlzdGVuZXIuYXBwbHkoc2VsZiwgc2VsZkFyZ3MpO1xuICAgICAgICAgICAgfSwgMSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxpc3RlbmVyLmFwcGx5KHNlbGYsIHNlbGZBcmdzKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIGV2ZW50ICcgKyBldmVudE5hbWUgKyAnIGRlZmluZWQnKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQWxpYXMgb2YgTG9raUV2ZW50RW1pdHRlci5wcm90b3R5cGUub25cbiAgICAgKiBhZGRMaXN0ZW5lcihldmVudE5hbWUsIGxpc3RlbmVyKSAtIGFkZHMgYSBsaXN0ZW5lciB0byB0aGUgcXVldWUgb2YgY2FsbGJhY2tzIGFzc29jaWF0ZWQgdG8gYW4gZXZlbnRcbiAgICAgKiBAcGFyYW0ge3N0cmluZ3xzdHJpbmdbXX0gZXZlbnROYW1lIC0gdGhlIG5hbWUocykgb2YgdGhlIGV2ZW50KHMpIHRvIGxpc3RlbiB0b1xuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IGxpc3RlbmVyIC0gY2FsbGJhY2sgZnVuY3Rpb24gb2YgbGlzdGVuZXIgdG8gYXR0YWNoXG4gICAgICogQHJldHVybnMge2ludH0gdGhlIGluZGV4IG9mIHRoZSBjYWxsYmFjayBpbiB0aGUgYXJyYXkgb2YgbGlzdGVuZXJzIGZvciBhIHBhcnRpY3VsYXIgZXZlbnRcbiAgICAgKiBAbWVtYmVyb2YgTG9raUV2ZW50RW1pdHRlclxuICAgICAqL1xuICAgIExva2lFdmVudEVtaXR0ZXIucHJvdG90eXBlLmFkZExpc3RlbmVyID0gTG9raUV2ZW50RW1pdHRlci5wcm90b3R5cGUub247XG5cbiAgICAvKipcbiAgICAgKiByZW1vdmVMaXN0ZW5lcigpIC0gcmVtb3ZlcyB0aGUgbGlzdGVuZXIgYXQgcG9zaXRpb24gJ2luZGV4JyBmcm9tIHRoZSBldmVudCAnZXZlbnROYW1lJ1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfHN0cmluZ1tdfSBldmVudE5hbWUgLSB0aGUgbmFtZShzKSBvZiB0aGUgZXZlbnQocykgd2hpY2ggdGhlIGxpc3RlbmVyIGlzIGF0dGFjaGVkIHRvXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbn0gbGlzdGVuZXIgLSB0aGUgbGlzdGVuZXIgY2FsbGJhY2sgZnVuY3Rpb24gdG8gcmVtb3ZlIGZyb20gZW1pdHRlclxuICAgICAqIEBtZW1iZXJvZiBMb2tpRXZlbnRFbWl0dGVyXG4gICAgICovXG4gICAgTG9raUV2ZW50RW1pdHRlci5wcm90b3R5cGUucmVtb3ZlTGlzdGVuZXIgPSBmdW5jdGlvbiAoZXZlbnROYW1lLCBsaXN0ZW5lcikge1xuICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgICBpZiAoQXJyYXkuaXNBcnJheShldmVudE5hbWUpKSB7XG4gICAgICAgIGV2ZW50TmFtZS5mb3JFYWNoKGZ1bmN0aW9uKGN1cnJlbnRFdmVudE5hbWUpIHtcbiAgICAgICAgICBzZWxmLnJlbW92ZUxpc3RlbmVyKGN1cnJlbnRFdmVudE5hbWUsIGxpc3RlbmVyKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5ldmVudHNbZXZlbnROYW1lXSkge1xuICAgICAgICB2YXIgbGlzdGVuZXJzID0gdGhpcy5ldmVudHNbZXZlbnROYW1lXTtcbiAgICAgICAgbGlzdGVuZXJzLnNwbGljZShsaXN0ZW5lcnMuaW5kZXhPZihsaXN0ZW5lciksIDEpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBMb2tpOiBUaGUgbWFpbiBkYXRhYmFzZSBjbGFzc1xuICAgICAqIEBjb25zdHJ1Y3RvciBMb2tpXG4gICAgICogQGltcGxlbWVudHMgTG9raUV2ZW50RW1pdHRlclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBmaWxlbmFtZSAtIG5hbWUgb2YgdGhlIGZpbGUgdG8gYmUgc2F2ZWQgdG9cbiAgICAgKiBAcGFyYW0ge29iamVjdD19IG9wdGlvbnMgLSAoT3B0aW9uYWwpIGNvbmZpZyBvcHRpb25zIG9iamVjdFxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBvcHRpb25zLmVudiAtIG92ZXJyaWRlIGVudmlyb25tZW50IGRldGVjdGlvbiBhcyAnTk9ERUpTJywgJ0JST1dTRVInLCAnQ09SRE9WQSdcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLnZlcmJvc2U9ZmFsc2VdIC0gZW5hYmxlIGNvbnNvbGUgb3V0cHV0XG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5hdXRvc2F2ZT1mYWxzZV0gLSBlbmFibGVzIGF1dG9zYXZlXG4gICAgICogQHBhcmFtIHtpbnR9IFtvcHRpb25zLmF1dG9zYXZlSW50ZXJ2YWw9NTAwMF0gLSB0aW1lIGludGVydmFsIChpbiBtaWxsaXNlY29uZHMpIGJldHdlZW4gc2F2ZXMgKGlmIGRpcnR5KVxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMuYXV0b2xvYWQ9ZmFsc2VdIC0gZW5hYmxlcyBhdXRvbG9hZCBvbiBsb2tpIGluc3RhbnRpYXRpb25cbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBvcHRpb25zLmF1dG9sb2FkQ2FsbGJhY2sgLSB1c2VyIGNhbGxiYWNrIGNhbGxlZCBhZnRlciBkYXRhYmFzZSBsb2FkXG4gICAgICogQHBhcmFtIHthZGFwdGVyfSBvcHRpb25zLmFkYXB0ZXIgLSBhbiBpbnN0YW5jZSBvZiBhIGxva2kgcGVyc2lzdGVuY2UgYWRhcHRlclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbb3B0aW9ucy5zZXJpYWxpemF0aW9uTWV0aG9kPSdub3JtYWwnXSAtIFsnbm9ybWFsJywgJ3ByZXR0eScsICdkZXN0cnVjdHVyZWQnXVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBvcHRpb25zLmRlc3RydWN0dXJlRGVsaW1pdGVyIC0gc3RyaW5nIGRlbGltaXRlciB1c2VkIGZvciBkZXN0cnVjdHVyZWQgc2VyaWFsaXphdGlvblxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMudGhyb3R0bGVkU2F2ZXM9dHJ1ZV0gLSBkZWJvdW5jZXMgbXVsdGlwbGUgY2FsbHMgdG8gdG8gc2F2ZURhdGFiYXNlIHJlZHVjaW5nIG51bWJlciBvZiBkaXNrIEkvTyBvcGVyYXRpb25zXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmQgZ3VhcmFudGVlaW5nIHByb3BlciBzZXJpYWxpemF0aW9uIG9mIHRoZSBjYWxscy5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBMb2tpKGZpbGVuYW1lLCBvcHRpb25zKSB7XG4gICAgICB0aGlzLmZpbGVuYW1lID0gZmlsZW5hbWUgfHwgJ2xva2kuZGInO1xuICAgICAgdGhpcy5jb2xsZWN0aW9ucyA9IFtdO1xuXG4gICAgICAvLyBwZXJzaXN0IHZlcnNpb24gb2YgY29kZSB3aGljaCBjcmVhdGVkIHRoZSBkYXRhYmFzZSB0byB0aGUgZGF0YWJhc2UuXG4gICAgICAvLyBjb3VsZCB1c2UgZm9yIHVwZ3JhZGUgc2NlbmFyaW9zXG4gICAgICB0aGlzLmRhdGFiYXNlVmVyc2lvbiA9IDEuNTtcbiAgICAgIHRoaXMuZW5naW5lVmVyc2lvbiA9IDEuNTtcblxuICAgICAgLy8gYXV0b3NhdmUgc3VwcG9ydCAoZGlzYWJsZWQgYnkgZGVmYXVsdClcbiAgICAgIC8vIHBhc3MgYXV0b3NhdmU6IHRydWUsIGF1dG9zYXZlSW50ZXJ2YWw6IDYwMDAgaW4gb3B0aW9ucyB0byBzZXQgNiBzZWNvbmQgYXV0b3NhdmVcbiAgICAgIHRoaXMuYXV0b3NhdmUgPSBmYWxzZTtcbiAgICAgIHRoaXMuYXV0b3NhdmVJbnRlcnZhbCA9IDUwMDA7XG4gICAgICB0aGlzLmF1dG9zYXZlSGFuZGxlID0gbnVsbDtcbiAgICAgIHRoaXMudGhyb3R0bGVkU2F2ZXMgPSB0cnVlO1xuXG4gICAgICB0aGlzLm9wdGlvbnMgPSB7fTtcblxuICAgICAgLy8gY3VycmVudGx5IGtlZXBpbmcgcGVyc2lzdGVuY2VNZXRob2QgYW5kIHBlcnNpc3RlbmNlQWRhcHRlciBhcyBsb2tpIGxldmVsIHByb3BlcnRpZXMgdGhhdFxuICAgICAgLy8gd2lsbCBub3Qgb3IgY2Fubm90IGJlIGRlc2VyaWFsaXplZC4gIFlvdSBhcmUgcmVxdWlyZWQgdG8gY29uZmlndXJlIHBlcnNpc3RlbmNlIGV2ZXJ5IHRpbWVcbiAgICAgIC8vIHlvdSBpbnN0YW50aWF0ZSBhIGxva2kgb2JqZWN0IChvciB1c2UgZGVmYXVsdCBlbnZpcm9ubWVudCBkZXRlY3Rpb24pIGluIG9yZGVyIHRvIGxvYWQgdGhlIGRhdGFiYXNlIGFueXdheXMuXG5cbiAgICAgIC8vIHBlcnNpc3RlbmNlTWV0aG9kIGNvdWxkIGJlICdmcycsICdsb2NhbFN0b3JhZ2UnLCBvciAnYWRhcHRlcidcbiAgICAgIC8vIHRoaXMgaXMgb3B0aW9uYWwgb3B0aW9uIHBhcmFtLCBvdGhlcndpc2UgZW52aXJvbm1lbnQgZGV0ZWN0aW9uIHdpbGwgYmUgdXNlZFxuICAgICAgLy8gaWYgdXNlciBwYXNzZXMgdGhlaXIgb3duIGFkYXB0ZXIgd2Ugd2lsbCBmb3JjZSB0aGlzIG1ldGhvZCB0byAnYWRhcHRlcicgbGF0ZXIsIHNvIG5vIG5lZWQgdG8gcGFzcyBtZXRob2Qgb3B0aW9uLlxuICAgICAgdGhpcy5wZXJzaXN0ZW5jZU1ldGhvZCA9IG51bGw7XG5cbiAgICAgIC8vIHJldGFpbiByZWZlcmVuY2UgdG8gb3B0aW9uYWwgKG5vbi1zZXJpYWxpemFibGUpIHBlcnNpc3RlbmNlQWRhcHRlciAnaW5zdGFuY2UnXG4gICAgICB0aGlzLnBlcnNpc3RlbmNlQWRhcHRlciA9IG51bGw7XG5cbiAgICAgIC8vIGZsYWdzIHVzZWQgdG8gdGhyb3R0bGUgc2F2ZXNcbiAgICAgIHRoaXMudGhyb3R0bGVkU2F2ZVBlbmRpbmcgPSBmYWxzZTtcbiAgICAgIHRoaXMudGhyb3R0bGVkQ2FsbGJhY2tzID0gW107XG5cbiAgICAgIC8vIGVuYWJsZSBjb25zb2xlIG91dHB1dCBpZiB2ZXJib3NlIGZsYWcgaXMgc2V0IChkaXNhYmxlZCBieSBkZWZhdWx0KVxuICAgICAgdGhpcy52ZXJib3NlID0gb3B0aW9ucyAmJiBvcHRpb25zLmhhc093blByb3BlcnR5KCd2ZXJib3NlJykgPyBvcHRpb25zLnZlcmJvc2UgOiBmYWxzZTtcblxuICAgICAgdGhpcy5ldmVudHMgPSB7XG4gICAgICAgICdpbml0JzogW10sXG4gICAgICAgICdsb2FkZWQnOiBbXSxcbiAgICAgICAgJ2ZsdXNoQ2hhbmdlcyc6IFtdLFxuICAgICAgICAnY2xvc2UnOiBbXSxcbiAgICAgICAgJ2NoYW5nZXMnOiBbXSxcbiAgICAgICAgJ3dhcm5pbmcnOiBbXVxuICAgICAgfTtcblxuICAgICAgdmFyIGdldEVOViA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnICYmIChnbG9iYWwuYW5kcm9pZCB8fCBnbG9iYWwuTlNPYmplY3QpKSB7XG4gICAgICAgICAgIC8vIElmIG5vIGFkYXB0ZXIgYXNzdW1lIG5hdGl2ZXNjcmlwdCB3aGljaCBuZWVkcyBhZGFwdGVyIHRvIGJlIHBhc3NlZCBtYW51YWxseVxuICAgICAgICAgICByZXR1cm4gJ05BVElWRVNDUklQVCc7IC8vbmF0aXZlc2NyaXB0XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICByZXR1cm4gJ05PREVKUyc7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodHlwZW9mIGdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcgJiYgZ2xvYmFsLndpbmRvdyAmJiB0eXBlb2YgcHJvY2VzcyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICByZXR1cm4gJ05PREVKUyc7IC8vbm9kZS13ZWJraXRcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0eXBlb2YgZG9jdW1lbnQgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgaWYgKGRvY3VtZW50LlVSTC5pbmRleE9mKCdodHRwOi8vJykgPT09IC0xICYmIGRvY3VtZW50LlVSTC5pbmRleE9mKCdodHRwczovLycpID09PSAtMSkge1xuICAgICAgICAgICAgcmV0dXJuICdDT1JET1ZBJztcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuICdCUk9XU0VSJztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gJ0NPUkRPVkEnO1xuICAgICAgfTtcblxuICAgICAgLy8gcmVmYWN0b3JlZCBlbnZpcm9ubWVudCBkZXRlY3Rpb24gZHVlIHRvIGludmFsaWQgZGV0ZWN0aW9uIGZvciBicm93c2VyIGVudmlyb25tZW50cy5cbiAgICAgIC8vIGlmIHRoZXkgZG8gbm90IHNwZWNpZnkgYW4gb3B0aW9ucy5lbnYgd2Ugd2FudCB0byBkZXRlY3QgZW52IHJhdGhlciB0aGFuIGRlZmF1bHQgdG8gbm9kZWpzLlxuICAgICAgLy8gY3VycmVudGx5IGtlZXBpbmcgdHdvIHByb3BlcnRpZXMgZm9yIHNpbWlsYXIgdGhpbmcgKG9wdGlvbnMuZW52IGFuZCBvcHRpb25zLnBlcnNpc3RlbmNlTWV0aG9kKVxuICAgICAgLy8gICBtaWdodCB3YW50IHRvIHJldmlldyB3aGV0aGVyIHdlIGNhbiBjb25zb2xpZGF0ZS5cbiAgICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnMuaGFzT3duUHJvcGVydHkoJ2VudicpKSB7XG4gICAgICAgIHRoaXMuRU5WID0gb3B0aW9ucy5lbnY7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLkVOViA9IGdldEVOVigpO1xuICAgICAgfVxuXG4gICAgICAvLyBub3Qgc3VyZSBpZiB0aGlzIGlzIG5lY2Vzc2FyeSBub3cgdGhhdCBpIGhhdmUgcmVmYWN0b3JlZCB0aGUgbGluZSBhYm92ZVxuICAgICAgaWYgKHRoaXMuRU5WID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICB0aGlzLkVOViA9ICdOT0RFSlMnO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmNvbmZpZ3VyZU9wdGlvbnMob3B0aW9ucywgdHJ1ZSk7XG5cbiAgICAgIHRoaXMub24oJ2luaXQnLCB0aGlzLmNsZWFyQ2hhbmdlcyk7XG5cbiAgICB9XG5cbiAgICAvLyBkYiBjbGFzcyBpcyBhbiBFdmVudEVtaXR0ZXJcbiAgICBMb2tpLnByb3RvdHlwZSA9IG5ldyBMb2tpRXZlbnRFbWl0dGVyKCk7XG4gICAgTG9raS5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBMb2tpO1xuXG4gICAgLy8gZXhwZXJpbWVudGFsIHN1cHBvcnQgZm9yIGJyb3dzZXJpZnkncyBhYnN0cmFjdCBzeW50YXggc2NhbiB0byBwaWNrIHVwIGRlcGVuZGVuY3kgb2YgaW5kZXhlZCBhZGFwdGVyLlxuICAgIC8vIEhvcGVmdWxseSwgb25jZSB0aGlzIGhpdHMgbnBtIGEgYnJvd3NlcmlmeSByZXF1aXJlIG9mIGxva2lqcyBzaG91bGQgc2NhbiB0aGUgbWFpbiBmaWxlIGFuZCBkZXRlY3QgdGhpcyBpbmRleGVkIGFkYXB0ZXIgcmVmZXJlbmNlLlxuICAgIExva2kucHJvdG90eXBlLmdldEluZGV4ZWRBZGFwdGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIGFkYXB0ZXI7XG5cbiAgICAgIGlmICh0eXBlb2YgcmVxdWlyZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBhZGFwdGVyID0gcmVxdWlyZShcIi4vbG9raS1pbmRleGVkLWFkYXB0ZXIuanNcIik7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBhZGFwdGVyO1xuICAgIH07XG5cblxuICAgIC8qKlxuICAgICAqIEFsbG93cyByZWNvbmZpZ3VyaW5nIGRhdGFiYXNlIG9wdGlvbnNcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBvcHRpb25zIC0gY29uZmlndXJhdGlvbiBvcHRpb25zIHRvIGFwcGx5IHRvIGxva2kgZGIgb2JqZWN0XG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG9wdGlvbnMuZW52IC0gb3ZlcnJpZGUgZW52aXJvbm1lbnQgZGV0ZWN0aW9uIGFzICdOT0RFSlMnLCAnQlJPV1NFUicsICdDT1JET1ZBJ1xuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gb3B0aW9ucy52ZXJib3NlIC0gZW5hYmxlIGNvbnNvbGUgb3V0cHV0IChkZWZhdWx0IGlzICdmYWxzZScpXG4gICAgICogQHBhcmFtIHtib29sZWFufSBvcHRpb25zLmF1dG9zYXZlIC0gZW5hYmxlcyBhdXRvc2F2ZVxuICAgICAqIEBwYXJhbSB7aW50fSBvcHRpb25zLmF1dG9zYXZlSW50ZXJ2YWwgLSB0aW1lIGludGVydmFsIChpbiBtaWxsaXNlY29uZHMpIGJldHdlZW4gc2F2ZXMgKGlmIGRpcnR5KVxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gb3B0aW9ucy5hdXRvbG9hZCAtIGVuYWJsZXMgYXV0b2xvYWQgb24gbG9raSBpbnN0YW50aWF0aW9uXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbn0gb3B0aW9ucy5hdXRvbG9hZENhbGxiYWNrIC0gdXNlciBjYWxsYmFjayBjYWxsZWQgYWZ0ZXIgZGF0YWJhc2UgbG9hZFxuICAgICAqIEBwYXJhbSB7YWRhcHRlcn0gb3B0aW9ucy5hZGFwdGVyIC0gYW4gaW5zdGFuY2Ugb2YgYSBsb2tpIHBlcnNpc3RlbmNlIGFkYXB0ZXJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gb3B0aW9ucy5zZXJpYWxpemF0aW9uTWV0aG9kIC0gWydub3JtYWwnLCAncHJldHR5JywgJ2Rlc3RydWN0dXJlZCddXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG9wdGlvbnMuZGVzdHJ1Y3R1cmVEZWxpbWl0ZXIgLSBzdHJpbmcgZGVsaW1pdGVyIHVzZWQgZm9yIGRlc3RydWN0dXJlZCBzZXJpYWxpemF0aW9uXG4gICAgICogQHBhcmFtIHtib29sZWFufSBpbml0aWFsQ29uZmlnIC0gKGludGVybmFsKSB0cnVlIGlzIHBhc3NlZCB3aGVuIGxva2kgY3RvciBpcyBpbnZva2luZ1xuICAgICAqIEBtZW1iZXJvZiBMb2tpXG4gICAgICovXG4gICAgTG9raS5wcm90b3R5cGUuY29uZmlndXJlT3B0aW9ucyA9IGZ1bmN0aW9uIChvcHRpb25zLCBpbml0aWFsQ29uZmlnKSB7XG4gICAgICB2YXIgZGVmYXVsdFBlcnNpc3RlbmNlID0ge1xuICAgICAgICAgICdOT0RFSlMnOiAnZnMnLFxuICAgICAgICAgICdCUk9XU0VSJzogJ2xvY2FsU3RvcmFnZScsXG4gICAgICAgICAgJ0NPUkRPVkEnOiAnbG9jYWxTdG9yYWdlJyxcbiAgICAgICAgICAnTUVNT1JZJzogJ21lbW9yeSdcbiAgICAgICAgfSxcbiAgICAgICAgcGVyc2lzdGVuY2VNZXRob2RzID0ge1xuICAgICAgICAgICdmcyc6IExva2lGc0FkYXB0ZXIsXG4gICAgICAgICAgJ2xvY2FsU3RvcmFnZSc6IExva2lMb2NhbFN0b3JhZ2VBZGFwdGVyLFxuICAgICAgICAgICdtZW1vcnknOiBMb2tpTWVtb3J5QWRhcHRlclxuICAgICAgICB9O1xuXG4gICAgICB0aGlzLm9wdGlvbnMgPSB7fTtcblxuICAgICAgdGhpcy5wZXJzaXN0ZW5jZU1ldGhvZCA9IG51bGw7XG4gICAgICAvLyByZXRhaW4gcmVmZXJlbmNlIHRvIG9wdGlvbmFsIHBlcnNpc3RlbmNlIGFkYXB0ZXIgJ2luc3RhbmNlJ1xuICAgICAgLy8gY3VycmVudGx5IGtlZXBpbmcgb3V0c2lkZSBvcHRpb25zIGJlY2F1c2UgaXQgY2FuJ3QgYmUgc2VyaWFsaXplZFxuICAgICAgdGhpcy5wZXJzaXN0ZW5jZUFkYXB0ZXIgPSBudWxsO1xuXG4gICAgICAvLyBwcm9jZXNzIHRoZSBvcHRpb25zXG4gICAgICBpZiAodHlwZW9mIChvcHRpb25zKSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcblxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLmhhc093blByb3BlcnR5KCdwZXJzaXN0ZW5jZU1ldGhvZCcpKSB7XG4gICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIHNwZWNpZmllZCBwZXJzaXN0ZW5jZSBtZXRob2QgaXMga25vd25cbiAgICAgICAgICBpZiAodHlwZW9mIChwZXJzaXN0ZW5jZU1ldGhvZHNbb3B0aW9ucy5wZXJzaXN0ZW5jZU1ldGhvZF0pID09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHRoaXMucGVyc2lzdGVuY2VNZXRob2QgPSBvcHRpb25zLnBlcnNpc3RlbmNlTWV0aG9kO1xuICAgICAgICAgICAgdGhpcy5wZXJzaXN0ZW5jZUFkYXB0ZXIgPSBuZXcgcGVyc2lzdGVuY2VNZXRob2RzW29wdGlvbnMucGVyc2lzdGVuY2VNZXRob2RdKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8vIHNob3VsZCBiZSB0aHJvdyBhbiBlcnJvciBoZXJlLCBvciBqdXN0IGZhbGwgYmFjayB0byBkZWZhdWx0cyA/P1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gaWYgdXNlciBwYXNzZXMgYWRhcHRlciwgc2V0IHBlcnNpc3RlbmNlIG1vZGUgdG8gYWRhcHRlciBhbmQgcmV0YWluIHBlcnNpc3RlbmNlIGFkYXB0ZXIgaW5zdGFuY2VcbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5oYXNPd25Qcm9wZXJ0eSgnYWRhcHRlcicpKSB7XG4gICAgICAgICAgdGhpcy5wZXJzaXN0ZW5jZU1ldGhvZCA9ICdhZGFwdGVyJztcbiAgICAgICAgICB0aGlzLnBlcnNpc3RlbmNlQWRhcHRlciA9IG9wdGlvbnMuYWRhcHRlcjtcbiAgICAgICAgICB0aGlzLm9wdGlvbnMuYWRhcHRlciA9IG51bGw7XG4gICAgICAgIH1cblxuXG4gICAgICAgIC8vIGlmIHRoZXkgd2FudCB0byBsb2FkIGRhdGFiYXNlIG9uIGxva2kgaW5zdGFudGlhdGlvbiwgbm93IGlzIGEgZ29vZCB0aW1lIHRvIGxvYWQuLi4gYWZ0ZXIgYWRhcHRlciBzZXQgYW5kIGJlZm9yZSBwb3NzaWJsZSBhdXRvc2F2ZSBpbml0aWF0aW9uXG4gICAgICAgIGlmIChvcHRpb25zLmF1dG9sb2FkICYmIGluaXRpYWxDb25maWcpIHtcbiAgICAgICAgICAvLyBmb3IgYXV0b2xvYWQsIGxldCB0aGUgY29uc3RydWN0b3IgY29tcGxldGUgYmVmb3JlIGZpcmluZyBjYWxsYmFja1xuICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHNlbGYubG9hZERhdGFiYXNlKG9wdGlvbnMsIG9wdGlvbnMuYXV0b2xvYWRDYWxsYmFjayk7XG4gICAgICAgICAgfSwgMSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLmhhc093blByb3BlcnR5KCdhdXRvc2F2ZUludGVydmFsJykpIHtcbiAgICAgICAgICB0aGlzLmF1dG9zYXZlRGlzYWJsZSgpO1xuICAgICAgICAgIHRoaXMuYXV0b3NhdmVJbnRlcnZhbCA9IHBhcnNlSW50KHRoaXMub3B0aW9ucy5hdXRvc2F2ZUludGVydmFsLCAxMCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLmhhc093blByb3BlcnR5KCdhdXRvc2F2ZScpICYmIHRoaXMub3B0aW9ucy5hdXRvc2F2ZSkge1xuICAgICAgICAgIHRoaXMuYXV0b3NhdmVEaXNhYmxlKCk7XG4gICAgICAgICAgdGhpcy5hdXRvc2F2ZSA9IHRydWU7XG5cbiAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmhhc093blByb3BlcnR5KCdhdXRvc2F2ZUNhbGxiYWNrJykpIHtcbiAgICAgICAgICAgIHRoaXMuYXV0b3NhdmVFbmFibGUob3B0aW9ucywgb3B0aW9ucy5hdXRvc2F2ZUNhbGxiYWNrKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5hdXRvc2F2ZUVuYWJsZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuaGFzT3duUHJvcGVydHkoJ3Rocm90dGxlZFNhdmVzJykpIHtcbiAgICAgICAgICB0aGlzLnRocm90dGxlZFNhdmVzID0gdGhpcy5vcHRpb25zLnRocm90dGxlZFNhdmVzO1xuICAgICAgICB9XG4gICAgICB9IC8vIGVuZCBvZiBvcHRpb25zIHByb2Nlc3NpbmdcblxuICAgICAgLy8gZW5zdXJlIGRlZmF1bHRzIGV4aXN0cyBmb3Igb3B0aW9ucyB3aGljaCB3ZXJlIG5vdCBzZXRcbiAgICAgIGlmICghdGhpcy5vcHRpb25zLmhhc093blByb3BlcnR5KCdzZXJpYWxpemF0aW9uTWV0aG9kJykpIHtcbiAgICAgICAgdGhpcy5vcHRpb25zLnNlcmlhbGl6YXRpb25NZXRob2QgPSAnbm9ybWFsJztcbiAgICAgIH1cblxuICAgICAgLy8gZW5zdXJlIHBhc3NlZCBvciBkZWZhdWx0IG9wdGlvbiBleGlzdHNcbiAgICAgIGlmICghdGhpcy5vcHRpb25zLmhhc093blByb3BlcnR5KCdkZXN0cnVjdHVyZURlbGltaXRlcicpKSB7XG4gICAgICAgIHRoaXMub3B0aW9ucy5kZXN0cnVjdHVyZURlbGltaXRlciA9ICckPFxcbic7XG4gICAgICB9XG5cbiAgICAgIC8vIGlmIGJ5IG5vdyB0aGVyZSBpcyBubyBhZGFwdGVyIHNwZWNpZmllZCBieSB1c2VyIG5vciBkZXJpdmVkIGZyb20gcGVyc2lzdGVuY2VNZXRob2Q6IHVzZSBzZW5zaWJsZSBkZWZhdWx0c1xuICAgICAgaWYgKHRoaXMucGVyc2lzdGVuY2VBZGFwdGVyID09PSBudWxsKSB7XG4gICAgICAgIHRoaXMucGVyc2lzdGVuY2VNZXRob2QgPSBkZWZhdWx0UGVyc2lzdGVuY2VbdGhpcy5FTlZdO1xuICAgICAgICBpZiAodGhpcy5wZXJzaXN0ZW5jZU1ldGhvZCkge1xuICAgICAgICAgIHRoaXMucGVyc2lzdGVuY2VBZGFwdGVyID0gbmV3IHBlcnNpc3RlbmNlTWV0aG9kc1t0aGlzLnBlcnNpc3RlbmNlTWV0aG9kXSgpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQ29waWVzICd0aGlzJyBkYXRhYmFzZSBpbnRvIGEgbmV3IExva2kgaW5zdGFuY2UuIE9iamVjdCByZWZlcmVuY2VzIGFyZSBzaGFyZWQgdG8gbWFrZSBsaWdodHdlaWdodC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBvcHRpb25zIC0gYXBwbHkgb3Igb3ZlcnJpZGUgY29sbGVjdGlvbiBsZXZlbCBzZXR0aW5nc1xuICAgICAqIEBwYXJhbSB7Ym9vbH0gb3B0aW9ucy5yZW1vdmVOb25TZXJpYWxpemFibGUgLSBudWxscyBwcm9wZXJ0aWVzIG5vdCBzYWZlIGZvciBzZXJpYWxpemF0aW9uLlxuICAgICAqIEBtZW1iZXJvZiBMb2tpXG4gICAgICovXG4gICAgTG9raS5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICAgIC8vIGluIGNhc2UgcnVubmluZyBpbiBhbiBlbnZpcm9ubWVudCB3aXRob3V0IGFjY3VyYXRlIGVudmlyb25tZW50IGRldGVjdGlvbiwgcGFzcyAnTkEnXG4gICAgICB2YXIgZGF0YWJhc2VDb3B5ID0gbmV3IExva2kodGhpcy5maWxlbmFtZSwgeyBlbnY6IFwiTkFcIiB9KTtcbiAgICAgIHZhciBjbGVuLCBpZHg7XG5cbiAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXG4gICAgICAvLyBjdXJyZW50bHkgaW52ZXJ0aW5nIGFuZCBsZXR0aW5nIGxvYWRKU09OT2JqZWN0IGRvIG1vc3Qgb2YgdGhlIHdvcmtcbiAgICAgIGRhdGFiYXNlQ29weS5sb2FkSlNPTk9iamVjdCh0aGlzLCB7IHJldGFpbkRpcnR5RmxhZ3M6IHRydWUgfSk7XG5cbiAgICAgIC8vIHNpbmNlIG91ciBKU09OIHNlcmlhbGl6ZVJlcGxhY2VyIGlzIG5vdCBpbnZva2VkIGZvciByZWZlcmVuY2UgZGF0YWJhc2UgYWRhcHRlcnMsIHRoaXMgd2lsbCBsZXQgdXMgbWltaWNcbiAgICAgIGlmKG9wdGlvbnMuaGFzT3duUHJvcGVydHkoXCJyZW1vdmVOb25TZXJpYWxpemFibGVcIikgJiYgb3B0aW9ucy5yZW1vdmVOb25TZXJpYWxpemFibGUgPT09IHRydWUpIHtcbiAgICAgICAgZGF0YWJhc2VDb3B5LmF1dG9zYXZlSGFuZGxlID0gbnVsbDtcbiAgICAgICAgZGF0YWJhc2VDb3B5LnBlcnNpc3RlbmNlQWRhcHRlciA9IG51bGw7XG5cbiAgICAgICAgY2xlbiA9IGRhdGFiYXNlQ29weS5jb2xsZWN0aW9ucy5sZW5ndGg7XG4gICAgICAgIGZvciAoaWR4PTA7IGlkeDxjbGVuOyBpZHgrKykge1xuICAgICAgICAgIGRhdGFiYXNlQ29weS5jb2xsZWN0aW9uc1tpZHhdLmNvbnN0cmFpbnRzID0gbnVsbDtcbiAgICAgICAgICBkYXRhYmFzZUNvcHkuY29sbGVjdGlvbnNbaWR4XS50dGwgPSBudWxsO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBkYXRhYmFzZUNvcHk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEFkZHMgYSBjb2xsZWN0aW9uIHRvIHRoZSBkYXRhYmFzZS5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZSAtIG5hbWUgb2YgY29sbGVjdGlvbiB0byBhZGRcbiAgICAgKiBAcGFyYW0ge29iamVjdD19IG9wdGlvbnMgLSAob3B0aW9uYWwpIG9wdGlvbnMgdG8gY29uZmlndXJlIGNvbGxlY3Rpb24gd2l0aC5cbiAgICAgKiBAcGFyYW0ge2FycmF5PX0gW29wdGlvbnMudW5pcXVlPVtdXSAtIGFycmF5IG9mIHByb3BlcnR5IG5hbWVzIHRvIGRlZmluZSB1bmlxdWUgY29uc3RyYWludHMgZm9yXG4gICAgICogQHBhcmFtIHthcnJheT19IFtvcHRpb25zLmV4YWN0PVtdXSAtIGFycmF5IG9mIHByb3BlcnR5IG5hbWVzIHRvIGRlZmluZSBleGFjdCBjb25zdHJhaW50cyBmb3JcbiAgICAgKiBAcGFyYW0ge2FycmF5PX0gW29wdGlvbnMuaW5kaWNlcz1bXV0gLSBhcnJheSBwcm9wZXJ0eSBuYW1lcyB0byBkZWZpbmUgYmluYXJ5IGluZGV4ZXMgZm9yXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5hc3luY0xpc3RlbmVycz1mYWxzZV0gLSB3aGV0aGVyIGxpc3RlbmVycyBhcmUgY2FsbGVkIGFzeW5jaHJvbm91c2x5XG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5kaXNhYmxlTWV0YT1mYWxzZV0gLSBzZXQgdG8gdHJ1ZSB0byBkaXNhYmxlIG1ldGEgcHJvcGVydHkgb24gZG9jdW1lbnRzXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5kaXNhYmxlQ2hhbmdlc0FwaT10cnVlXSAtIHNldCB0byBmYWxzZSB0byBlbmFibGUgQ2hhbmdlcyBBcGlcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLmRpc2FibGVEZWx0YUNoYW5nZXNBcGk9dHJ1ZV0gLSBzZXQgdG8gZmFsc2UgdG8gZW5hYmxlIERlbHRhIENoYW5nZXMgQVBJIChyZXF1aXJlcyBDaGFuZ2VzIEFQSSwgZm9yY2VzIGNsb25pbmcpXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5hdXRvdXBkYXRlPWZhbHNlXSAtIHVzZSBPYmplY3Qub2JzZXJ2ZSB0byB1cGRhdGUgb2JqZWN0cyBhdXRvbWF0aWNhbGx5XG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5jbG9uZT1mYWxzZV0gLSBzcGVjaWZ5IHdoZXRoZXIgaW5zZXJ0cyBhbmQgcXVlcmllcyBjbG9uZSB0by9mcm9tIHVzZXJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW29wdGlvbnMuY2xvbmVNZXRob2Q9J3BhcnNlLXN0cmluZ2lmeSddIC0gJ3BhcnNlLXN0cmluZ2lmeScsICdqcXVlcnktZXh0ZW5kLWRlZXAnLCAnc2hhbGxvdywgJ3NoYWxsb3ctYXNzaWduJ1xuICAgICAqIEBwYXJhbSB7aW50PX0gb3B0aW9ucy50dGwgLSBhZ2Ugb2YgZG9jdW1lbnQgKGluIG1zLikgYmVmb3JlIGRvY3VtZW50IGlzIGNvbnNpZGVyZWQgYWdlZC9zdGFsZS5cbiAgICAgKiBAcGFyYW0ge2ludD19IG9wdGlvbnMudHRsSW50ZXJ2YWwgLSB0aW1lIGludGVydmFsIGZvciBjbGVhcmluZyBvdXQgJ2FnZWQnIGRvY3VtZW50czsgbm90IHNldCBieSBkZWZhdWx0LlxuICAgICAqIEByZXR1cm5zIHtDb2xsZWN0aW9ufSBhIHJlZmVyZW5jZSB0byB0aGUgY29sbGVjdGlvbiB3aGljaCB3YXMganVzdCBhZGRlZFxuICAgICAqIEBtZW1iZXJvZiBMb2tpXG4gICAgICovXG4gICAgTG9raS5wcm90b3R5cGUuYWRkQ29sbGVjdGlvbiA9IGZ1bmN0aW9uIChuYW1lLCBvcHRpb25zKSB7XG4gICAgICB2YXIgaSxcbiAgICAgICAgbGVuID0gdGhpcy5jb2xsZWN0aW9ucy5sZW5ndGg7XG5cbiAgICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnMuZGlzYWJsZU1ldGEgPT09IHRydWUpIHtcbiAgICAgICAgaWYgKG9wdGlvbnMuZGlzYWJsZUNoYW5nZXNBcGkgPT09IGZhbHNlKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiZGlzYWJsZU1ldGEgb3B0aW9uIGNhbm5vdCBiZSBwYXNzZWQgYXMgdHJ1ZSB3aGVuIGRpc2FibGVDaGFuZ2VzQXBpIGlzIHBhc3NlZCBhcyBmYWxzZVwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAob3B0aW9ucy5kaXNhYmxlRGVsdGFDaGFuZ2VzQXBpID09PSBmYWxzZSkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImRpc2FibGVNZXRhIG9wdGlvbiBjYW5ub3QgYmUgcGFzc2VkIGFzIHRydWUgd2hlbiBkaXNhYmxlRGVsdGFDaGFuZ2VzQXBpIGlzIHBhc3NlZCBhcyBmYWxzZVwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIG9wdGlvbnMudHRsID09PSBcIm51bWJlclwiICYmIG9wdGlvbnMudHRsID4gMCkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImRpc2FibGVNZXRhIG9wdGlvbiBjYW5ub3QgYmUgcGFzc2VkIGFzIHRydWUgd2hlbiB0dGwgaXMgZW5hYmxlZFwiKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpICs9IDEpIHtcbiAgICAgICAgaWYgKHRoaXMuY29sbGVjdGlvbnNbaV0ubmFtZSA9PT0gbmFtZSkge1xuICAgICAgICAgIHJldHVybiB0aGlzLmNvbGxlY3Rpb25zW2ldO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHZhciBjb2xsZWN0aW9uID0gbmV3IENvbGxlY3Rpb24obmFtZSwgb3B0aW9ucyk7XG4gICAgICB0aGlzLmNvbGxlY3Rpb25zLnB1c2goY29sbGVjdGlvbik7XG5cbiAgICAgIGlmICh0aGlzLnZlcmJvc2UpXG4gICAgICAgIGNvbGxlY3Rpb24uY29uc29sZSA9IGNvbnNvbGU7XG5cbiAgICAgIHJldHVybiBjb2xsZWN0aW9uO1xuICAgIH07XG5cbiAgICBMb2tpLnByb3RvdHlwZS5sb2FkQ29sbGVjdGlvbiA9IGZ1bmN0aW9uIChjb2xsZWN0aW9uKSB7XG4gICAgICBpZiAoIWNvbGxlY3Rpb24ubmFtZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NvbGxlY3Rpb24gbXVzdCBoYXZlIGEgbmFtZSBwcm9wZXJ0eSB0byBiZSBsb2FkZWQnKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuY29sbGVjdGlvbnMucHVzaChjb2xsZWN0aW9uKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUmV0cmlldmVzIHJlZmVyZW5jZSB0byBhIGNvbGxlY3Rpb24gYnkgbmFtZS5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gY29sbGVjdGlvbk5hbWUgLSBuYW1lIG9mIGNvbGxlY3Rpb24gdG8gbG9vayB1cFxuICAgICAqIEByZXR1cm5zIHtDb2xsZWN0aW9ufSBSZWZlcmVuY2UgdG8gY29sbGVjdGlvbiBpbiBkYXRhYmFzZSBieSB0aGF0IG5hbWUsIG9yIG51bGwgaWYgbm90IGZvdW5kXG4gICAgICogQG1lbWJlcm9mIExva2lcbiAgICAgKi9cbiAgICBMb2tpLnByb3RvdHlwZS5nZXRDb2xsZWN0aW9uID0gZnVuY3Rpb24gKGNvbGxlY3Rpb25OYW1lKSB7XG4gICAgICB2YXIgaSxcbiAgICAgICAgbGVuID0gdGhpcy5jb2xsZWN0aW9ucy5sZW5ndGg7XG5cbiAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkgKz0gMSkge1xuICAgICAgICBpZiAodGhpcy5jb2xsZWN0aW9uc1tpXS5uYW1lID09PSBjb2xsZWN0aW9uTmFtZSkge1xuICAgICAgICAgIHJldHVybiB0aGlzLmNvbGxlY3Rpb25zW2ldO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIG5vIHN1Y2ggY29sbGVjdGlvblxuICAgICAgdGhpcy5lbWl0KCd3YXJuaW5nJywgJ2NvbGxlY3Rpb24gJyArIGNvbGxlY3Rpb25OYW1lICsgJyBub3QgZm91bmQnKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBSZW5hbWVzIGFuIGV4aXN0aW5nIGxva2kgY29sbGVjdGlvblxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBvbGROYW1lIC0gbmFtZSBvZiBjb2xsZWN0aW9uIHRvIHJlbmFtZVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuZXdOYW1lIC0gbmV3IG5hbWUgb2YgY29sbGVjdGlvblxuICAgICAqIEByZXR1cm5zIHtDb2xsZWN0aW9ufSByZWZlcmVuY2UgdG8gdGhlIG5ld2x5IHJlbmFtZWQgY29sbGVjdGlvblxuICAgICAqIEBtZW1iZXJvZiBMb2tpXG4gICAgICovXG4gICAgTG9raS5wcm90b3R5cGUucmVuYW1lQ29sbGVjdGlvbiA9IGZ1bmN0aW9uIChvbGROYW1lLCBuZXdOYW1lKSB7XG4gICAgICB2YXIgYyA9IHRoaXMuZ2V0Q29sbGVjdGlvbihvbGROYW1lKTtcblxuICAgICAgaWYgKGMpIHtcbiAgICAgICAgYy5uYW1lID0gbmV3TmFtZTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGM7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBsaXN0IG9mIGNvbGxlY3Rpb25zIGluIHRoZSBkYXRhYmFzZS5cbiAgICAgKiBAcmV0dXJucyB7b2JqZWN0W119IGFycmF5IG9mIG9iamVjdHMgY29udGFpbmluZyAnbmFtZScsICd0eXBlJywgYW5kICdjb3VudCcgcHJvcGVydGllcy5cbiAgICAgKiBAbWVtYmVyb2YgTG9raVxuICAgICAqL1xuICAgIExva2kucHJvdG90eXBlLmxpc3RDb2xsZWN0aW9ucyA9IGZ1bmN0aW9uICgpIHtcblxuICAgICAgdmFyIGkgPSB0aGlzLmNvbGxlY3Rpb25zLmxlbmd0aCxcbiAgICAgICAgY29sbHMgPSBbXTtcblxuICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICBjb2xscy5wdXNoKHtcbiAgICAgICAgICBuYW1lOiB0aGlzLmNvbGxlY3Rpb25zW2ldLm5hbWUsXG4gICAgICAgICAgdHlwZTogdGhpcy5jb2xsZWN0aW9uc1tpXS5vYmpUeXBlLFxuICAgICAgICAgIGNvdW50OiB0aGlzLmNvbGxlY3Rpb25zW2ldLmRhdGEubGVuZ3RoXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGNvbGxzO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIGEgY29sbGVjdGlvbiBmcm9tIHRoZSBkYXRhYmFzZS5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gY29sbGVjdGlvbk5hbWUgLSBuYW1lIG9mIGNvbGxlY3Rpb24gdG8gcmVtb3ZlXG4gICAgICogQG1lbWJlcm9mIExva2lcbiAgICAgKi9cbiAgICBMb2tpLnByb3RvdHlwZS5yZW1vdmVDb2xsZWN0aW9uID0gZnVuY3Rpb24gKGNvbGxlY3Rpb25OYW1lKSB7XG4gICAgICB2YXIgaSxcbiAgICAgICAgbGVuID0gdGhpcy5jb2xsZWN0aW9ucy5sZW5ndGg7XG5cbiAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkgKz0gMSkge1xuICAgICAgICBpZiAodGhpcy5jb2xsZWN0aW9uc1tpXS5uYW1lID09PSBjb2xsZWN0aW9uTmFtZSkge1xuICAgICAgICAgIHZhciB0bXBjb2wgPSBuZXcgQ29sbGVjdGlvbihjb2xsZWN0aW9uTmFtZSwge30pO1xuICAgICAgICAgIHZhciBjdXJjb2wgPSB0aGlzLmNvbGxlY3Rpb25zW2ldO1xuICAgICAgICAgIGZvciAodmFyIHByb3AgaW4gY3VyY29sKSB7XG4gICAgICAgICAgICBpZiAoY3VyY29sLmhhc093blByb3BlcnR5KHByb3ApICYmIHRtcGNvbC5oYXNPd25Qcm9wZXJ0eShwcm9wKSkge1xuICAgICAgICAgICAgICBjdXJjb2xbcHJvcF0gPSB0bXBjb2xbcHJvcF07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMuY29sbGVjdGlvbnMuc3BsaWNlKGksIDEpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG5cbiAgICBMb2tpLnByb3RvdHlwZS5nZXROYW1lID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMubmFtZTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogc2VyaWFsaXplUmVwbGFjZXIgLSB1c2VkIHRvIHByZXZlbnQgY2VydGFpbiBwcm9wZXJ0aWVzIGZyb20gYmVpbmcgc2VyaWFsaXplZFxuICAgICAqXG4gICAgICovXG4gICAgTG9raS5wcm90b3R5cGUuc2VyaWFsaXplUmVwbGFjZXIgPSBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xuICAgICAgc3dpdGNoIChrZXkpIHtcbiAgICAgIGNhc2UgJ2F1dG9zYXZlSGFuZGxlJzpcbiAgICAgIGNhc2UgJ3BlcnNpc3RlbmNlQWRhcHRlcic6XG4gICAgICBjYXNlICdjb25zdHJhaW50cyc6XG4gICAgICBjYXNlICd0dGwnOlxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIGNhc2UgJ3Rocm90dGxlZFNhdmVQZW5kaW5nJzpcbiAgICAgIGNhc2UgJ3Rocm90dGxlZENhbGxiYWNrcyc6XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFNlcmlhbGl6ZSBkYXRhYmFzZSB0byBhIHN0cmluZyB3aGljaCBjYW4gYmUgbG9hZGVkIHZpYSB7QGxpbmsgTG9raSNsb2FkSlNPTn1cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IFN0cmluZ2lmaWVkIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBsb2tpIGRhdGFiYXNlLlxuICAgICAqIEBtZW1iZXJvZiBMb2tpXG4gICAgICovXG4gICAgTG9raS5wcm90b3R5cGUuc2VyaWFsaXplID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXG4gICAgICBpZiAoIW9wdGlvbnMuaGFzT3duUHJvcGVydHkoXCJzZXJpYWxpemF0aW9uTWV0aG9kXCIpKSB7XG4gICAgICAgIG9wdGlvbnMuc2VyaWFsaXphdGlvbk1ldGhvZCA9IHRoaXMub3B0aW9ucy5zZXJpYWxpemF0aW9uTWV0aG9kO1xuICAgICAgfVxuXG4gICAgICBzd2l0Y2gob3B0aW9ucy5zZXJpYWxpemF0aW9uTWV0aG9kKSB7XG4gICAgICAgIGNhc2UgXCJub3JtYWxcIjogcmV0dXJuIEpTT04uc3RyaW5naWZ5KHRoaXMsIHRoaXMuc2VyaWFsaXplUmVwbGFjZXIpO1xuICAgICAgICBjYXNlIFwicHJldHR5XCI6IHJldHVybiBKU09OLnN0cmluZ2lmeSh0aGlzLCB0aGlzLnNlcmlhbGl6ZVJlcGxhY2VyLCAyKTtcbiAgICAgICAgY2FzZSBcImRlc3RydWN0dXJlZFwiOiByZXR1cm4gdGhpcy5zZXJpYWxpemVEZXN0cnVjdHVyZWQoKTsgLy8gdXNlIGRlZmF1bHQgb3B0aW9uc1xuICAgICAgICBkZWZhdWx0OiByZXR1cm4gSlNPTi5zdHJpbmdpZnkodGhpcywgdGhpcy5zZXJpYWxpemVSZXBsYWNlcik7XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8vIGFsaWFzIG9mIHNlcmlhbGl6ZVxuICAgIExva2kucHJvdG90eXBlLnRvSnNvbiA9IExva2kucHJvdG90eXBlLnNlcmlhbGl6ZTtcblxuICAgIC8qKlxuICAgICAqIERhdGFiYXNlIGxldmVsIGRlc3RydWN0dXJlZCBKU09OIHNlcmlhbGl6YXRpb24gcm91dGluZSB0byBhbGxvdyBhbHRlcm5hdGUgc2VyaWFsaXphdGlvbiBtZXRob2RzLlxuICAgICAqIEludGVybmFsbHksIExva2kgc3VwcG9ydHMgZGVzdHJ1Y3R1cmluZyB2aWEgbG9raSBcInNlcmlhbGl6YXRpb25NZXRob2QnIG9wdGlvbiBhbmRcbiAgICAgKiB0aGUgb3B0aW9uYWwgTG9raVBhcnRpdGlvbmluZ0FkYXB0ZXIgY2xhc3MuIEl0IGlzIGFsc28gYXZhaWxhYmxlIGlmIHlvdSB3aXNoIHRvIGRvXG4gICAgICogeW91ciBvd24gc3RydWN0dXJlZCBwZXJzaXN0ZW5jZSBvciBkYXRhIGV4Y2hhbmdlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtvYmplY3Q9fSBvcHRpb25zIC0gb3V0cHV0IGZvcm1hdCBvcHRpb25zIGZvciB1c2UgZXh0ZXJuYWxseSB0byBsb2tpXG4gICAgICogQHBhcmFtIHtib29sPX0gb3B0aW9ucy5wYXJ0aXRpb25lZCAtIChkZWZhdWx0OiBmYWxzZSkgd2hldGhlciBkYiBhbmQgZWFjaCBjb2xsZWN0aW9uIGFyZSBzZXBhcmF0ZVxuICAgICAqIEBwYXJhbSB7aW50PX0gb3B0aW9ucy5wYXJ0aXRpb24gLSBjYW4gYmUgdXNlZCB0byBvbmx5IG91dHB1dCBhbiBpbmRpdmlkdWFsIGNvbGxlY3Rpb24gb3IgZGIgKC0xKVxuICAgICAqIEBwYXJhbSB7Ym9vbD19IG9wdGlvbnMuZGVsaW1pdGVkIC0gKGRlZmF1bHQ6IHRydWUpIHdoZXRoZXIgc3ViaXRlbXMgYXJlIGRlbGltaXRlZCBvciBzdWJhcnJheXNcbiAgICAgKiBAcGFyYW0ge3N0cmluZz19IG9wdGlvbnMuZGVsaW1pdGVyIC0gb3ZlcnJpZGUgZGVmYXVsdCBkZWxpbWl0ZXJcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd8YXJyYXl9IEEgY3VzdG9tLCByZXN0cnVjdHVyZWQgYWdncmVnYXRpb24gb2YgaW5kZXBlbmRlbnQgc2VyaWFsaXphdGlvbnMuXG4gICAgICogQG1lbWJlcm9mIExva2lcbiAgICAgKi9cbiAgICBMb2tpLnByb3RvdHlwZS5zZXJpYWxpemVEZXN0cnVjdHVyZWQgPSBmdW5jdGlvbihvcHRpb25zKSB7XG4gICAgICB2YXIgaWR4LCBzaWR4LCByZXN1bHQsIHJlc3VsdGxlbjtcbiAgICAgIHZhciByZWNvbnN0cnVjdCA9IFtdO1xuICAgICAgdmFyIGRiY29weTtcblxuICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cbiAgICAgIGlmICghb3B0aW9ucy5oYXNPd25Qcm9wZXJ0eShcInBhcnRpdGlvbmVkXCIpKSB7XG4gICAgICAgIG9wdGlvbnMucGFydGl0aW9uZWQgPSBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFvcHRpb25zLmhhc093blByb3BlcnR5KFwiZGVsaW1pdGVkXCIpKSB7XG4gICAgICAgIG9wdGlvbnMuZGVsaW1pdGVkID0gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFvcHRpb25zLmhhc093blByb3BlcnR5KFwiZGVsaW1pdGVyXCIpKSB7XG4gICAgICAgIG9wdGlvbnMuZGVsaW1pdGVyID0gdGhpcy5vcHRpb25zLmRlc3RydWN0dXJlRGVsaW1pdGVyO1xuICAgICAgfVxuXG4gICAgICAvLyAncGFydGl0aW9uZWQnIGFsb25nIHdpdGggJ3BhcnRpdGlvbicgb2YgMCBvciBncmVhdGVyIGlzIGEgcmVxdWVzdCBmb3Igc2luZ2xlIGNvbGxlY3Rpb24gc2VyaWFsaXphdGlvblxuICAgICAgaWYgKG9wdGlvbnMucGFydGl0aW9uZWQgPT09IHRydWUgJiYgb3B0aW9ucy5oYXNPd25Qcm9wZXJ0eShcInBhcnRpdGlvblwiKSAmJiBvcHRpb25zLnBhcnRpdGlvbiA+PSAwKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNlcmlhbGl6ZUNvbGxlY3Rpb24oe1xuICAgICAgICAgIGRlbGltaXRlZDogb3B0aW9ucy5kZWxpbWl0ZWQsXG4gICAgICAgICAgZGVsaW1pdGVyOiBvcHRpb25zLmRlbGltaXRlcixcbiAgICAgICAgICBjb2xsZWN0aW9uSW5kZXg6IG9wdGlvbnMucGFydGl0aW9uXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBub3QganVzdCBhbiBpbmRpdmlkdWFsIGNvbGxlY3Rpb24sIHNvIHdlIHdpbGwgbmVlZCB0byBzZXJpYWxpemUgZGIgY29udGFpbmVyIHZpYSBzaGFsbG93IGNvcHlcbiAgICAgIGRiY29weSA9IG5ldyBMb2tpKHRoaXMuZmlsZW5hbWUpO1xuICAgICAgZGJjb3B5LmxvYWRKU09OT2JqZWN0KHRoaXMpO1xuXG4gICAgICBmb3IoaWR4PTA7IGlkeCA8IGRiY29weS5jb2xsZWN0aW9ucy5sZW5ndGg7IGlkeCsrKSB7XG4gICAgICAgIGRiY29weS5jb2xsZWN0aW9uc1tpZHhdLmRhdGEgPSBbXTtcbiAgICAgIH1cblxuICAgICAgLy8gaWYgd2UgLW9ubHktIHdhbnRlZCB0aGUgZGIgY29udGFpbmVyIHBvcnRpb24sIHJldHVybiBpdCBub3dcbiAgICAgIGlmIChvcHRpb25zLnBhcnRpdGlvbmVkID09PSB0cnVlICYmIG9wdGlvbnMucGFydGl0aW9uID09PSAtMSkge1xuICAgICAgICAvLyBzaW5jZSB3ZSBhcmUgZGVjb25zdHJ1Y3RpbmcsIG92ZXJyaWRlIHNlcmlhbGl6YXRpb25NZXRob2QgdG8gbm9ybWFsIGZvciBoZXJlXG4gICAgICAgIHJldHVybiBkYmNvcHkuc2VyaWFsaXplKHtcbiAgICAgICAgICBzZXJpYWxpemF0aW9uTWV0aG9kOiBcIm5vcm1hbFwiXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBhdCB0aGlzIHBvaW50IHdlIG11c3QgYmUgZGVjb25zdHJ1Y3RpbmcgdGhlIGVudGlyZSBkYXRhYmFzZVxuICAgICAgLy8gc3RhcnQgYnkgcHVzaGluZyBkYiBzZXJpYWxpemF0aW9uIGludG8gZmlyc3QgYXJyYXkgZWxlbWVudFxuICAgICAgcmVjb25zdHJ1Y3QucHVzaChkYmNvcHkuc2VyaWFsaXplKHtcbiAgICAgICAgICBzZXJpYWxpemF0aW9uTWV0aG9kOiBcIm5vcm1hbFwiXG4gICAgICB9KSk7XG5cbiAgICAgIGRiY29weSA9IG51bGw7XG5cbiAgICAgIC8vIHB1c2ggY29sbGVjdGlvbiBkYXRhIGludG8gc3Vic2VxdWVudCBlbGVtZW50c1xuICAgICAgZm9yKGlkeD0wOyBpZHggPCB0aGlzLmNvbGxlY3Rpb25zLmxlbmd0aDsgaWR4KyspIHtcbiAgICAgICAgcmVzdWx0ID0gdGhpcy5zZXJpYWxpemVDb2xsZWN0aW9uKHtcbiAgICAgICAgICBkZWxpbWl0ZWQ6IG9wdGlvbnMuZGVsaW1pdGVkLFxuICAgICAgICAgIGRlbGltaXRlcjogb3B0aW9ucy5kZWxpbWl0ZXIsXG4gICAgICAgICAgY29sbGVjdGlvbkluZGV4OiBpZHhcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gTkRBIDogTm9uLURlbGltaXRlZCBBcnJheSA6IG9uZSBpdGVyYWJsZSBjb25jYXRlbmF0ZWQgYXJyYXkgd2l0aCBlbXB0eSBzdHJpbmcgY29sbGVjdGlvbiBwYXJ0aXRpb25zXG4gICAgICAgIGlmIChvcHRpb25zLnBhcnRpdGlvbmVkID09PSBmYWxzZSAmJiBvcHRpb25zLmRlbGltaXRlZCA9PT0gZmFsc2UpIHtcbiAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkocmVzdWx0KSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiYSBub25kZWxpbWl0ZWQsIG5vbiBwYXJ0aXRpb25lZCBjb2xsZWN0aW9uIHNlcmlhbGl6YXRpb24gZGlkIG5vdCByZXR1cm4gYW4gZXhwZWN0ZWQgYXJyYXlcIik7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gQXJyYXkuY29uY2F0IHdvdWxkIHByb2JhYmx5IGR1cGxpY2F0ZSBtZW1vcnkgb3ZlcmhlYWQgZm9yIGNvcHlpbmcgc3RyaW5ncy5cbiAgICAgICAgICAvLyBJbnN0ZWFkIGNvcHkgZWFjaCBpbmRpdmlkdWFsbHksIGFuZCBjbGVhciBvbGQgdmFsdWUgYWZ0ZXIgZWFjaCBjb3B5LlxuICAgICAgICAgIC8vIEhvcGVmdWxseSB0aGlzIHdpbGwgYWxsb3cgZy5jLiB0byByZWR1Y2UgbWVtb3J5IHByZXNzdXJlLCBpZiBuZWVkZWQuXG4gICAgICAgICAgcmVzdWx0bGVuID0gcmVzdWx0Lmxlbmd0aDtcblxuICAgICAgICAgIGZvciAoc2lkeD0wOyBzaWR4IDwgcmVzdWx0bGVuOyBzaWR4KyspIHtcbiAgICAgICAgICAgIHJlY29uc3RydWN0LnB1c2gocmVzdWx0W3NpZHhdKTtcbiAgICAgICAgICAgIHJlc3VsdFtzaWR4XSA9IG51bGw7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmVjb25zdHJ1Y3QucHVzaChcIlwiKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICByZWNvbnN0cnVjdC5wdXNoKHJlc3VsdCk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gUmVjb25zdHJ1Y3QgLyBwcmVzZW50IHJlc3VsdHMgYWNjb3JkaW5nIHRvIGZvdXIgY29tYmluYXRpb25zIDogRCwgREEsIE5EQSwgTkRBQVxuICAgICAgaWYgKG9wdGlvbnMucGFydGl0aW9uZWQpIHtcbiAgICAgICAgLy8gREEgOiBEZWxpbWl0ZWQgQXJyYXkgb2Ygc3RyaW5ncyBbMF0gZGIgWzFdIGNvbGxlY3Rpb24gW25dIGNvbGxlY3Rpb24geyBwYXJ0aXRpb25lZDogdHJ1ZSwgZGVsaW1pdGVkOiB0cnVlIH1cbiAgICAgICAgLy8gdXNlZnVsIGZvciBzaW1wbGUgZnV0dXJlIGFkYXB0YXRpb25zIG9mIGV4aXN0aW5nIHBlcnNpc3RlbmNlIGFkYXB0ZXJzIHRvIHNhdmUgY29sbGVjdGlvbnMgc2VwYXJhdGVseVxuICAgICAgICBpZiAob3B0aW9ucy5kZWxpbWl0ZWQpIHtcbiAgICAgICAgICByZXR1cm4gcmVjb25zdHJ1Y3Q7XG4gICAgICAgIH1cbiAgICAgICAgLy8gTkRBQSA6IE5vbi1EZWxpbWl0ZWQgQXJyYXkgd2l0aCBzdWJBcnJheXMuIGRiIGF0IFswXSBhbmQgY29sbGVjdGlvbiBzdWJhcnJheXMgYXQgW25dIHsgcGFydGl0aW9uZWQ6IHRydWUsIGRlbGltaXRlZCA6IGZhbHNlIH1cbiAgICAgICAgLy8gVGhpcyBmb3JtYXQgbWlnaHQgYmUgdGhlIG1vc3QgdmVyc2F0aWxlIGZvciAncm9sbGluZyB5b3VyIG93bicgcGFydGl0aW9uZWQgc3luYyBvciBzYXZlLlxuICAgICAgICAvLyBNZW1vcnkgb3ZlcmhlYWQgY2FuIGJlIHJlZHVjZWQgYnkgc3BlY2lmeWluZyBhIHNwZWNpZmljIHBhcnRpdGlvbiwgYnV0IGF0IHRoaXMgY29kZSBwYXRoIHRoZXkgZGlkIG5vdCwgc28gaXRzIGFsbC5cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIHJlY29uc3RydWN0O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgLy8gRCA6IG9uZSBiaWcgRGVsaW1pdGVkIHN0cmluZyB7IHBhcnRpdGlvbmVkOiBmYWxzZSwgZGVsaW1pdGVkIDogdHJ1ZSB9XG4gICAgICAgIC8vIFRoaXMgaXMgdGhlIG1ldGhvZCBMb2tpIHdpbGwgdXNlIGludGVybmFsbHkgaWYgJ2Rlc3RydWN0dXJlZCcuXG4gICAgICAgIC8vIExpdHRsZSBtZW1vcnkgb3ZlcmhlYWQgaW1wcm92ZW1lbnRzIGJ1dCBkb2VzIG5vdCByZXF1aXJlIG11bHRpcGxlIGFzeW5jaHJvbm91cyBhZGFwdGVyIGNhbGwgc2NoZWR1bGluZ1xuICAgICAgICBpZiAob3B0aW9ucy5kZWxpbWl0ZWQpIHtcbiAgICAgICAgICAvLyBpbmRpY2F0ZSBubyBtb3JlIGNvbGxlY3Rpb25zXG4gICAgICAgICAgcmVjb25zdHJ1Y3QucHVzaChcIlwiKTtcblxuICAgICAgICAgIHJldHVybiByZWNvbnN0cnVjdC5qb2luKG9wdGlvbnMuZGVsaW1pdGVyKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBOREEgOiBOb24tRGVsaW1pdGVkIEFycmF5IDogb25lIGl0ZXJhYmxlIGFycmF5IHdpdGggZW1wdHkgc3RyaW5nIGNvbGxlY3Rpb24gcGFydGl0aW9ucyB7IHBhcnRpdGlvbmVkOiBmYWxzZSwgZGVsaW1pdGVkOiBmYWxzZSB9XG4gICAgICAgIC8vIFRoaXMgZm9ybWF0IG1pZ2h0IGJlIGJlc3QgY2FuZGlkYXRlIGZvciBjdXN0b20gc3luY2hyb25vdXMgc3luY3Mgb3Igc2F2ZXNcbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgLy8gaW5kaWNhdGUgbm8gbW9yZSBjb2xsZWN0aW9uc1xuICAgICAgICAgIHJlY29uc3RydWN0LnB1c2goXCJcIik7XG5cbiAgICAgICAgICByZXR1cm4gcmVjb25zdHJ1Y3Q7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmVjb25zdHJ1Y3QucHVzaChcIlwiKTtcblxuICAgICAgcmV0dXJuIHJlY29uc3RydWN0LmpvaW4oZGVsaW0pO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBDb2xsZWN0aW9uIGxldmVsIHV0aWxpdHkgbWV0aG9kIHRvIHNlcmlhbGl6ZSBhIGNvbGxlY3Rpb24gaW4gYSAnZGVzdHJ1Y3R1cmVkJyBmb3JtYXRcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7b2JqZWN0PX0gb3B0aW9ucyAtIHVzZWQgdG8gZGV0ZXJtaW5lIG91dHB1dCBvZiBtZXRob2RcbiAgICAgKiBAcGFyYW0ge2ludH0gb3B0aW9ucy5kZWxpbWl0ZWQgLSB3aGV0aGVyIHRvIHJldHVybiBzaW5nbGUgZGVsaW1pdGVkIHN0cmluZyBvciBhbiBhcnJheVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBvcHRpb25zLmRlbGltaXRlciAtIChvcHRpb25hbCkgaWYgZGVsaW1pdGVkLCB0aGlzIGlzIGRlbGltaXRlciB0byB1c2VcbiAgICAgKiBAcGFyYW0ge2ludH0gb3B0aW9ucy5jb2xsZWN0aW9uSW5kZXggLSAgc3BlY2lmeSB3aGljaCBjb2xsZWN0aW9uIHRvIHNlcmlhbGl6ZSBkYXRhIGZvclxuICAgICAqXG4gICAgICogQHJldHVybnMge3N0cmluZ3xhcnJheX0gQSBjdXN0b20sIHJlc3RydWN0dXJlZCBhZ2dyZWdhdGlvbiBvZiBpbmRlcGVuZGVudCBzZXJpYWxpemF0aW9ucyBmb3IgYSBzaW5nbGUgY29sbGVjdGlvbi5cbiAgICAgKiBAbWVtYmVyb2YgTG9raVxuICAgICAqL1xuICAgIExva2kucHJvdG90eXBlLnNlcmlhbGl6ZUNvbGxlY3Rpb24gPSBmdW5jdGlvbihvcHRpb25zKSB7XG4gICAgICB2YXIgZG9jY291bnQsXG4gICAgICAgIGRvY2lkeCxcbiAgICAgICAgcmVzdWx0bGluZXMgPSBbXTtcblxuICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cbiAgICAgIGlmICghb3B0aW9ucy5oYXNPd25Qcm9wZXJ0eShcImRlbGltaXRlZFwiKSkge1xuICAgICAgICBvcHRpb25zLmRlbGltaXRlZCA9IHRydWU7XG4gICAgICB9XG5cbiAgICAgIGlmICghb3B0aW9ucy5oYXNPd25Qcm9wZXJ0eShcImNvbGxlY3Rpb25JbmRleFwiKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJzZXJpYWxpemVDb2xsZWN0aW9uIGNhbGxlZCB3aXRob3V0ICdjb2xsZWN0aW9uSW5kZXgnIG9wdGlvblwiKTtcbiAgICAgIH1cblxuICAgICAgZG9jY291bnQgPSB0aGlzLmNvbGxlY3Rpb25zW29wdGlvbnMuY29sbGVjdGlvbkluZGV4XS5kYXRhLmxlbmd0aDtcblxuICAgICAgcmVzdWx0bGluZXMgPSBbXTtcblxuICAgICAgZm9yKGRvY2lkeD0wOyBkb2NpZHg8ZG9jY291bnQ7IGRvY2lkeCsrKSB7XG4gICAgICAgIHJlc3VsdGxpbmVzLnB1c2goSlNPTi5zdHJpbmdpZnkodGhpcy5jb2xsZWN0aW9uc1tvcHRpb25zLmNvbGxlY3Rpb25JbmRleF0uZGF0YVtkb2NpZHhdKSk7XG4gICAgICB9XG5cbiAgICAgIC8vIEQgYW5kIERBXG4gICAgICBpZiAob3B0aW9ucy5kZWxpbWl0ZWQpIHtcbiAgICAgICAgIC8vIGluZGljYXRlIG5vIG1vcmUgZG9jdW1lbnRzIGluIGNvbGxlY3Rpb24gKHZpYSBlbXB0eSBkZWxpbWl0ZWQgc3RyaW5nKVxuICAgICAgICByZXN1bHRsaW5lcy5wdXNoKFwiXCIpO1xuXG4gICAgICAgIHJldHVybiByZXN1bHRsaW5lcy5qb2luKG9wdGlvbnMuZGVsaW1pdGVyKTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICAvLyBOREFBIGFuZCBOREFcbiAgICAgICAgcmV0dXJuIHJlc3VsdGxpbmVzO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBEYXRhYmFzZSBsZXZlbCBkZXN0cnVjdHVyZWQgSlNPTiBkZXNlcmlhbGl6YXRpb24gcm91dGluZSB0byBtaW5pbWl6ZSBtZW1vcnkgb3ZlcmhlYWQuXG4gICAgICogSW50ZXJuYWxseSwgTG9raSBzdXBwb3J0cyBkZXN0cnVjdHVyaW5nIHZpYSBsb2tpIFwic2VyaWFsaXphdGlvbk1ldGhvZCcgb3B0aW9uIGFuZFxuICAgICAqIHRoZSBvcHRpb25hbCBMb2tpUGFydGl0aW9uaW5nQWRhcHRlciBjbGFzcy4gSXQgaXMgYWxzbyBhdmFpbGFibGUgaWYgeW91IHdpc2ggdG8gZG9cbiAgICAgKiB5b3VyIG93biBzdHJ1Y3R1cmVkIHBlcnNpc3RlbmNlIG9yIGRhdGEgZXhjaGFuZ2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ3xhcnJheX0gZGVzdHJ1Y3R1cmVkU291cmNlIC0gZGVzdHJ1Y3R1cmVkIGpzb24gb3IgYXJyYXkgdG8gZGVzZXJpYWxpemUgZnJvbVxuICAgICAqIEBwYXJhbSB7b2JqZWN0PX0gb3B0aW9ucyAtIHNvdXJjZSBmb3JtYXQgb3B0aW9uc1xuICAgICAqIEBwYXJhbSB7Ym9vbD19IFtvcHRpb25zLnBhcnRpdGlvbmVkPWZhbHNlXSAtIHdoZXRoZXIgZGIgYW5kIGVhY2ggY29sbGVjdGlvbiBhcmUgc2VwYXJhdGVcbiAgICAgKiBAcGFyYW0ge2ludD19IG9wdGlvbnMucGFydGl0aW9uIC0gY2FuIGJlIHVzZWQgdG8gZGVzZXJpYWxpemUgb25seSBhIHNpbmdsZSBwYXJ0aXRpb25cbiAgICAgKiBAcGFyYW0ge2Jvb2w9fSBbb3B0aW9ucy5kZWxpbWl0ZWQ9dHJ1ZV0gLSB3aGV0aGVyIHN1Yml0ZW1zIGFyZSBkZWxpbWl0ZWQgb3Igc3ViYXJyYXlzXG4gICAgICogQHBhcmFtIHtzdHJpbmc9fSBvcHRpb25zLmRlbGltaXRlciAtIG92ZXJyaWRlIGRlZmF1bHQgZGVsaW1pdGVyXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7b2JqZWN0fGFycmF5fSBBbiBvYmplY3QgcmVwcmVzZW50YXRpb24gb2YgdGhlIGRlc2VyaWFsaXplZCBkYXRhYmFzZSwgbm90IHlldCBhcHBsaWVkIHRvICd0aGlzJyBkYiBvciBkb2N1bWVudCBhcnJheVxuICAgICAqIEBtZW1iZXJvZiBMb2tpXG4gICAgICovXG4gICAgTG9raS5wcm90b3R5cGUuZGVzZXJpYWxpemVEZXN0cnVjdHVyZWQgPSBmdW5jdGlvbihkZXN0cnVjdHVyZWRTb3VyY2UsIG9wdGlvbnMpIHtcbiAgICAgIHZhciB3b3JrYXJyYXk9W107XG4gICAgICB2YXIgbGVuLCBjZGI7XG4gICAgICB2YXIgaWR4LCBjb2xsSW5kZXg9MCwgY29sbENvdW50LCBsaW5lSW5kZXg9MSwgZG9uZT1mYWxzZTtcbiAgICAgIHZhciBjdXJyTGluZSwgY3Vyck9iamVjdDtcblxuICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cbiAgICAgIGlmICghb3B0aW9ucy5oYXNPd25Qcm9wZXJ0eShcInBhcnRpdGlvbmVkXCIpKSB7XG4gICAgICAgIG9wdGlvbnMucGFydGl0aW9uZWQgPSBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFvcHRpb25zLmhhc093blByb3BlcnR5KFwiZGVsaW1pdGVkXCIpKSB7XG4gICAgICAgIG9wdGlvbnMuZGVsaW1pdGVkID0gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFvcHRpb25zLmhhc093blByb3BlcnR5KFwiZGVsaW1pdGVyXCIpKSB7XG4gICAgICAgIG9wdGlvbnMuZGVsaW1pdGVyID0gdGhpcy5vcHRpb25zLmRlc3RydWN0dXJlRGVsaW1pdGVyO1xuICAgICAgfVxuXG4gICAgICAvLyBQYXJ0aXRpb25lZFxuICAgICAgLy8gREEgOiBEZWxpbWl0ZWQgQXJyYXkgb2Ygc3RyaW5ncyBbMF0gZGIgWzFdIGNvbGxlY3Rpb24gW25dIGNvbGxlY3Rpb24geyBwYXJ0aXRpb25lZDogdHJ1ZSwgZGVsaW1pdGVkOiB0cnVlIH1cbiAgICAgIC8vIE5EQUEgOiBOb24tRGVsaW1pdGVkIEFycmF5IHdpdGggc3ViQXJyYXlzLiBkYiBhdCBbMF0gYW5kIGNvbGxlY3Rpb24gc3ViYXJyYXlzIGF0IFtuXSB7IHBhcnRpdGlvbmVkOiB0cnVlLCBkZWxpbWl0ZWQgOiBmYWxzZSB9XG4gICAgICAvLyAtb3ItIHNpbmdsZSBwYXJ0aXRpb25cbiAgICAgIGlmIChvcHRpb25zLnBhcnRpdGlvbmVkKSB7XG4gICAgICAgIC8vIGhhbmRsZSBzaW5nbGUgcGFydGl0aW9uXG4gICAgICAgIGlmIChvcHRpb25zLmhhc093blByb3BlcnR5KCdwYXJ0aXRpb24nKSkge1xuICAgICAgICAgIC8vIGRiIG9ubHlcbiAgICAgICAgICBpZiAob3B0aW9ucy5wYXJ0aXRpb24gPT09IC0xKSB7XG4gICAgICAgICAgICBjZGIgPSBKU09OLnBhcnNlKGRlc3RydWN0dXJlZFNvdXJjZVswXSk7XG5cbiAgICAgICAgICAgIHJldHVybiBjZGI7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gc2luZ2xlIGNvbGxlY3Rpb24sIHJldHVybiBkb2MgYXJyYXlcbiAgICAgICAgICByZXR1cm4gdGhpcy5kZXNlcmlhbGl6ZUNvbGxlY3Rpb24oZGVzdHJ1Y3R1cmVkU291cmNlW29wdGlvbnMucGFydGl0aW9uKzFdLCBvcHRpb25zKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIE90aGVyd2lzZSB3ZSBhcmUgcmVzdG9yaW5nIGFuIGVudGlyZSBwYXJ0aXRpb25lZCBkYlxuICAgICAgICBjZGIgPSBKU09OLnBhcnNlKGRlc3RydWN0dXJlZFNvdXJjZVswXSk7XG4gICAgICAgIGNvbGxDb3VudCA9IGNkYi5jb2xsZWN0aW9ucy5sZW5ndGg7XG4gICAgICAgIGZvcihjb2xsSW5kZXg9MDsgY29sbEluZGV4PGNvbGxDb3VudDsgY29sbEluZGV4KyspIHtcbiAgICAgICAgICAvLyBhdHRhY2ggZWFjaCBjb2xsZWN0aW9uIGRvY2FycmF5IHRvIGNvbnRhaW5lciBjb2xsZWN0aW9uIGRhdGEsIGFkZCAxIHRvIGNvbGxlY3Rpb24gYXJyYXkgaW5kZXggc2luY2UgZGIgaXMgYXQgMFxuICAgICAgICAgIGNkYi5jb2xsZWN0aW9uc1tjb2xsSW5kZXhdLmRhdGEgPSB0aGlzLmRlc2VyaWFsaXplQ29sbGVjdGlvbihkZXN0cnVjdHVyZWRTb3VyY2VbY29sbEluZGV4KzFdLCBvcHRpb25zKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBjZGI7XG4gICAgICB9XG5cbiAgICAgIC8vIE5vbi1QYXJ0aXRpb25lZFxuICAgICAgLy8gRCA6IG9uZSBiaWcgRGVsaW1pdGVkIHN0cmluZyB7IHBhcnRpdGlvbmVkOiBmYWxzZSwgZGVsaW1pdGVkIDogdHJ1ZSB9XG4gICAgICAvLyBOREEgOiBOb24tRGVsaW1pdGVkIEFycmF5IDogb25lIGl0ZXJhYmxlIGFycmF5IHdpdGggZW1wdHkgc3RyaW5nIGNvbGxlY3Rpb24gcGFydGl0aW9ucyB7IHBhcnRpdGlvbmVkOiBmYWxzZSwgZGVsaW1pdGVkOiBmYWxzZSB9XG5cbiAgICAgIC8vIERcbiAgICAgIGlmIChvcHRpb25zLmRlbGltaXRlZCkge1xuICAgICAgICB3b3JrYXJyYXkgPSBkZXN0cnVjdHVyZWRTb3VyY2Uuc3BsaXQob3B0aW9ucy5kZWxpbWl0ZXIpO1xuICAgICAgICBkZXN0cnVjdHVyZWRTb3VyY2UgPSBudWxsOyAvLyBsb3dlciBtZW1vcnkgcHJlc3N1cmVcbiAgICAgICAgbGVuID0gd29ya2FycmF5Lmxlbmd0aDtcblxuICAgICAgICBpZiAobGVuID09PSAwKSB7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIC8vIE5EQVxuICAgICAgZWxzZSB7XG4gICAgICAgIHdvcmthcnJheSA9IGRlc3RydWN0dXJlZFNvdXJjZTtcbiAgICAgIH1cblxuICAgICAgLy8gZmlyc3QgbGluZSBpcyBkYXRhYmFzZSBhbmQgY29sbGVjdGlvbiBzaGVsbHNcbiAgICAgIGNkYiA9IEpTT04ucGFyc2Uod29ya2FycmF5WzBdKTtcbiAgICAgIGNvbGxDb3VudCA9IGNkYi5jb2xsZWN0aW9ucy5sZW5ndGg7XG4gICAgICB3b3JrYXJyYXlbMF0gPSBudWxsO1xuXG4gICAgICB3aGlsZSAoIWRvbmUpIHtcbiAgICAgICAgY3VyckxpbmUgPSB3b3JrYXJyYXlbbGluZUluZGV4XTtcblxuICAgICAgICAvLyBlbXB0eSBzdHJpbmcgaW5kaWNhdGVzIGVpdGhlciBlbmQgb2YgY29sbGVjdGlvbiBvciBlbmQgb2YgZmlsZVxuICAgICAgICBpZiAod29ya2FycmF5W2xpbmVJbmRleF0gPT09IFwiXCIpIHtcbiAgICAgICAgICAvLyBpZiBubyBtb3JlIGNvbGxlY3Rpb25zIHRvIGxvYWQgaW50bywgd2UgYXJlIGRvbmVcbiAgICAgICAgICBpZiAoKytjb2xsSW5kZXggPiBjb2xsQ291bnQpIHtcbiAgICAgICAgICAgIGRvbmUgPSB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICBjdXJyT2JqZWN0ID0gSlNPTi5wYXJzZSh3b3JrYXJyYXlbbGluZUluZGV4XSk7XG4gICAgICAgICAgY2RiLmNvbGxlY3Rpb25zW2NvbGxJbmRleF0uZGF0YS5wdXNoKGN1cnJPYmplY3QpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gbG93ZXIgbWVtb3J5IHByZXNzdXJlIGFuZCBhZHZhbmNlIGl0ZXJhdG9yXG4gICAgICAgIHdvcmthcnJheVtsaW5lSW5kZXgrK10gPSBudWxsO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gY2RiO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBDb2xsZWN0aW9uIGxldmVsIHV0aWxpdHkgZnVuY3Rpb24gdG8gZGVzZXJpYWxpemVzIGEgZGVzdHJ1Y3R1cmVkIGNvbGxlY3Rpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ3xhcnJheX0gZGVzdHJ1Y3R1cmVkU291cmNlIC0gZGVzdHJ1Y3R1cmVkIHJlcHJlc2VudGF0aW9uIG9mIGNvbGxlY3Rpb24gdG8gaW5mbGF0ZVxuICAgICAqIEBwYXJhbSB7b2JqZWN0PX0gb3B0aW9ucyAtIHVzZWQgdG8gZGVzY3JpYmUgZm9ybWF0IG9mIGRlc3RydWN0dXJlZFNvdXJjZSBpbnB1dFxuICAgICAqIEBwYXJhbSB7aW50PX0gW29wdGlvbnMuZGVsaW1pdGVkPWZhbHNlXSAtIHdoZXRoZXIgc291cmNlIGlzIGRlbGltaXRlZCBzdHJpbmcgb3IgYW4gYXJyYXlcbiAgICAgKiBAcGFyYW0ge3N0cmluZz19IG9wdGlvbnMuZGVsaW1pdGVyIC0gaWYgZGVsaW1pdGVkLCB0aGlzIGlzIGRlbGltaXRlciB0byB1c2UgKGlmIG90aGVyIHRoYW4gZGVmYXVsdClcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHthcnJheX0gYW4gYXJyYXkgb2YgZG9jdW1lbnRzIHRvIGF0dGFjaCB0byBjb2xsZWN0aW9uLmRhdGEuXG4gICAgICogQG1lbWJlcm9mIExva2lcbiAgICAgKi9cbiAgICBMb2tpLnByb3RvdHlwZS5kZXNlcmlhbGl6ZUNvbGxlY3Rpb24gPSBmdW5jdGlvbihkZXN0cnVjdHVyZWRTb3VyY2UsIG9wdGlvbnMpIHtcbiAgICAgIHZhciB3b3JrYXJyYXk9W107XG4gICAgICB2YXIgaWR4LCBsZW47XG5cbiAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXG4gICAgICBpZiAoIW9wdGlvbnMuaGFzT3duUHJvcGVydHkoXCJwYXJ0aXRpb25lZFwiKSkge1xuICAgICAgICBvcHRpb25zLnBhcnRpdGlvbmVkID0gZmFsc2U7XG4gICAgICB9XG5cbiAgICAgIGlmICghb3B0aW9ucy5oYXNPd25Qcm9wZXJ0eShcImRlbGltaXRlZFwiKSkge1xuICAgICAgICBvcHRpb25zLmRlbGltaXRlZCA9IHRydWU7XG4gICAgICB9XG5cbiAgICAgIGlmICghb3B0aW9ucy5oYXNPd25Qcm9wZXJ0eShcImRlbGltaXRlclwiKSkge1xuICAgICAgICBvcHRpb25zLmRlbGltaXRlciA9IHRoaXMub3B0aW9ucy5kZXN0cnVjdHVyZURlbGltaXRlcjtcbiAgICAgIH1cblxuICAgICAgaWYgKG9wdGlvbnMuZGVsaW1pdGVkKSB7XG4gICAgICAgIHdvcmthcnJheSA9IGRlc3RydWN0dXJlZFNvdXJjZS5zcGxpdChvcHRpb25zLmRlbGltaXRlcik7XG4gICAgICAgIHdvcmthcnJheS5wb3AoKTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICB3b3JrYXJyYXkgPSBkZXN0cnVjdHVyZWRTb3VyY2U7XG4gICAgICB9XG5cbiAgICAgIGxlbiA9IHdvcmthcnJheS5sZW5ndGg7XG4gICAgICBmb3IgKGlkeD0wOyBpZHggPCBsZW47IGlkeCsrKSB7XG4gICAgICAgIHdvcmthcnJheVtpZHhdID0gSlNPTi5wYXJzZSh3b3JrYXJyYXlbaWR4XSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB3b3JrYXJyYXk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEluZmxhdGVzIGEgbG9raSBkYXRhYmFzZSBmcm9tIGEgc2VyaWFsaXplZCBKU09OIHN0cmluZ1xuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHNlcmlhbGl6ZWREYiAtIGEgc2VyaWFsaXplZCBsb2tpIGRhdGFiYXNlIHN0cmluZ1xuICAgICAqIEBwYXJhbSB7b2JqZWN0PX0gb3B0aW9ucyAtIGFwcGx5IG9yIG92ZXJyaWRlIGNvbGxlY3Rpb24gbGV2ZWwgc2V0dGluZ3NcbiAgICAgKiBAcGFyYW0ge2Jvb2x9IG9wdGlvbnMucmV0YWluRGlydHlGbGFncyAtIHdoZXRoZXIgY29sbGVjdGlvbiBkaXJ0eSBmbGFncyB3aWxsIGJlIHByZXNlcnZlZFxuICAgICAqIEBtZW1iZXJvZiBMb2tpXG4gICAgICovXG4gICAgTG9raS5wcm90b3R5cGUubG9hZEpTT04gPSBmdW5jdGlvbiAoc2VyaWFsaXplZERiLCBvcHRpb25zKSB7XG4gICAgICB2YXIgZGJPYmplY3Q7XG4gICAgICBpZiAoc2VyaWFsaXplZERiLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBkYk9iamVjdCA9IHt9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gdXNpbmcgb3B0aW9uIGRlZmluZWQgaW4gaW5zdGFudGlhdGVkIGRiIG5vdCB3aGF0IHdhcyBpbiBzZXJpYWxpemVkIGRiXG4gICAgICAgIHN3aXRjaCAodGhpcy5vcHRpb25zLnNlcmlhbGl6YXRpb25NZXRob2QpIHtcbiAgICAgICAgICBjYXNlIFwibm9ybWFsXCI6XG4gICAgICAgICAgY2FzZSBcInByZXR0eVwiOiBkYk9iamVjdCA9IEpTT04ucGFyc2Uoc2VyaWFsaXplZERiKTsgYnJlYWs7XG4gICAgICAgICAgY2FzZSBcImRlc3RydWN0dXJlZFwiOiBkYk9iamVjdCA9IHRoaXMuZGVzZXJpYWxpemVEZXN0cnVjdHVyZWQoc2VyaWFsaXplZERiKTsgYnJlYWs7XG4gICAgICAgICAgZGVmYXVsdDogIGRiT2JqZWN0ID0gSlNPTi5wYXJzZShzZXJpYWxpemVkRGIpOyBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB0aGlzLmxvYWRKU09OT2JqZWN0KGRiT2JqZWN0LCBvcHRpb25zKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogSW5mbGF0ZXMgYSBsb2tpIGRhdGFiYXNlIGZyb20gYSBKUyBvYmplY3RcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBkYk9iamVjdCAtIGEgc2VyaWFsaXplZCBsb2tpIGRhdGFiYXNlIHN0cmluZ1xuICAgICAqIEBwYXJhbSB7b2JqZWN0PX0gb3B0aW9ucyAtIGFwcGx5IG9yIG92ZXJyaWRlIGNvbGxlY3Rpb24gbGV2ZWwgc2V0dGluZ3NcbiAgICAgKiBAcGFyYW0ge2Jvb2x9IG9wdGlvbnMucmV0YWluRGlydHlGbGFncyAtIHdoZXRoZXIgY29sbGVjdGlvbiBkaXJ0eSBmbGFncyB3aWxsIGJlIHByZXNlcnZlZFxuICAgICAqIEBtZW1iZXJvZiBMb2tpXG4gICAgICovXG4gICAgTG9raS5wcm90b3R5cGUubG9hZEpTT05PYmplY3QgPSBmdW5jdGlvbiAoZGJPYmplY3QsIG9wdGlvbnMpIHtcbiAgICAgIHZhciBpID0gMCxcbiAgICAgICAgbGVuID0gZGJPYmplY3QuY29sbGVjdGlvbnMgPyBkYk9iamVjdC5jb2xsZWN0aW9ucy5sZW5ndGggOiAwLFxuICAgICAgICBjb2xsLFxuICAgICAgICBjb3B5Q29sbCxcbiAgICAgICAgY2xlbixcbiAgICAgICAgaixcbiAgICAgICAgbG9hZGVyLFxuICAgICAgICBjb2xsT2JqO1xuXG4gICAgICB0aGlzLm5hbWUgPSBkYk9iamVjdC5uYW1lO1xuXG4gICAgICAvLyByZXN0b3JlIHNhdmUgdGhyb3R0bGVkIGJvb2xlYW4gb25seSBpZiBub3QgZGVmaW5lZCBpbiBvcHRpb25zXG4gICAgICBpZiAoZGJPYmplY3QuaGFzT3duUHJvcGVydHkoJ3Rocm90dGxlZFNhdmVzJykgJiYgb3B0aW9ucyAmJiAhb3B0aW9ucy5oYXNPd25Qcm9wZXJ0eSgndGhyb3R0bGVkU2F2ZXMnKSkge1xuICAgICAgICB0aGlzLnRocm90dGxlZFNhdmVzID0gZGJPYmplY3QudGhyb3R0bGVkU2F2ZXM7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuY29sbGVjdGlvbnMgPSBbXTtcblxuICAgICAgZnVuY3Rpb24gbWFrZUxvYWRlcihjb2xsKSB7XG4gICAgICAgIHZhciBjb2xsT3B0aW9ucyA9IG9wdGlvbnNbY29sbC5uYW1lXTtcbiAgICAgICAgdmFyIGluZmxhdGVyO1xuXG4gICAgICAgIGlmKGNvbGxPcHRpb25zLnByb3RvKSB7XG4gICAgICAgICAgaW5mbGF0ZXIgPSBjb2xsT3B0aW9ucy5pbmZsYXRlIHx8IFV0aWxzLmNvcHlQcm9wZXJ0aWVzO1xuXG4gICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgIHZhciBjb2xsT2JqID0gbmV3KGNvbGxPcHRpb25zLnByb3RvKSgpO1xuICAgICAgICAgICAgaW5mbGF0ZXIoZGF0YSwgY29sbE9iaik7XG4gICAgICAgICAgICByZXR1cm4gY29sbE9iajtcbiAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGNvbGxPcHRpb25zLmluZmxhdGU7XG4gICAgICB9XG5cbiAgICAgIGZvciAoaTsgaSA8IGxlbjsgaSArPSAxKSB7XG4gICAgICAgIGNvbGwgPSBkYk9iamVjdC5jb2xsZWN0aW9uc1tpXTtcblxuICAgICAgICBjb3B5Q29sbCA9IHRoaXMuYWRkQ29sbGVjdGlvbihjb2xsLm5hbWUsIHsgZGlzYWJsZUNoYW5nZXNBcGk6IGNvbGwuZGlzYWJsZUNoYW5nZXNBcGksIGRpc2FibGVEZWx0YUNoYW5nZXNBcGk6IGNvbGwuZGlzYWJsZURlbHRhQ2hhbmdlc0FwaSwgZGlzYWJsZU1ldGE6IGNvbGwuZGlzYWJsZU1ldGEgfSk7XG5cbiAgICAgICAgY29weUNvbGwuYWRhcHRpdmVCaW5hcnlJbmRpY2VzID0gY29sbC5oYXNPd25Qcm9wZXJ0eSgnYWRhcHRpdmVCaW5hcnlJbmRpY2VzJyk/KGNvbGwuYWRhcHRpdmVCaW5hcnlJbmRpY2VzID09PSB0cnVlKTogZmFsc2U7XG4gICAgICAgIGNvcHlDb2xsLnRyYW5zYWN0aW9uYWwgPSBjb2xsLnRyYW5zYWN0aW9uYWw7XG4gICAgICAgIGNvcHlDb2xsLmFzeW5jTGlzdGVuZXJzID0gY29sbC5hc3luY0xpc3RlbmVycztcbiAgICAgICAgY29weUNvbGwuY2xvbmVPYmplY3RzID0gY29sbC5jbG9uZU9iamVjdHM7XG4gICAgICAgIGNvcHlDb2xsLmNsb25lTWV0aG9kID0gY29sbC5jbG9uZU1ldGhvZCB8fCBcInBhcnNlLXN0cmluZ2lmeVwiO1xuICAgICAgICBjb3B5Q29sbC5hdXRvdXBkYXRlID0gY29sbC5hdXRvdXBkYXRlO1xuICAgICAgICBjb3B5Q29sbC5jaGFuZ2VzID0gY29sbC5jaGFuZ2VzO1xuXG4gICAgICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnMucmV0YWluRGlydHlGbGFncyA9PT0gdHJ1ZSkge1xuICAgICAgICAgIGNvcHlDb2xsLmRpcnR5ID0gY29sbC5kaXJ0eTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICBjb3B5Q29sbC5kaXJ0eSA9IGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gbG9hZCBlYWNoIGVsZW1lbnQgaW5kaXZpZHVhbGx5XG4gICAgICAgIGNsZW4gPSBjb2xsLmRhdGEubGVuZ3RoO1xuICAgICAgICBqID0gMDtcbiAgICAgICAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5oYXNPd25Qcm9wZXJ0eShjb2xsLm5hbWUpKSB7XG4gICAgICAgICAgbG9hZGVyID0gbWFrZUxvYWRlcihjb2xsKTtcblxuICAgICAgICAgIGZvciAoajsgaiA8IGNsZW47IGorKykge1xuICAgICAgICAgICAgY29sbE9iaiA9IGxvYWRlcihjb2xsLmRhdGFbal0pO1xuICAgICAgICAgICAgY29weUNvbGwuZGF0YVtqXSA9IGNvbGxPYmo7XG4gICAgICAgICAgICBjb3B5Q29sbC5hZGRBdXRvVXBkYXRlT2JzZXJ2ZXIoY29sbE9iaik7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgZm9yIChqOyBqIDwgY2xlbjsgaisrKSB7XG4gICAgICAgICAgICBjb3B5Q29sbC5kYXRhW2pdID0gY29sbC5kYXRhW2pdO1xuICAgICAgICAgICAgY29weUNvbGwuYWRkQXV0b1VwZGF0ZU9ic2VydmVyKGNvcHlDb2xsLmRhdGFbal0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNvcHlDb2xsLm1heElkID0gKHR5cGVvZiBjb2xsLm1heElkID09PSAndW5kZWZpbmVkJykgPyAwIDogY29sbC5tYXhJZDtcbiAgICAgICAgY29weUNvbGwuaWRJbmRleCA9IGNvbGwuaWRJbmRleDtcbiAgICAgICAgaWYgKHR5cGVvZiAoY29sbC5iaW5hcnlJbmRpY2VzKSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICBjb3B5Q29sbC5iaW5hcnlJbmRpY2VzID0gY29sbC5iaW5hcnlJbmRpY2VzO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgY29sbC50cmFuc2Zvcm1zICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgIGNvcHlDb2xsLnRyYW5zZm9ybXMgPSBjb2xsLnRyYW5zZm9ybXM7XG4gICAgICAgIH1cblxuICAgICAgICBjb3B5Q29sbC5lbnN1cmVJZCgpO1xuXG4gICAgICAgIC8vIHJlZ2VuZXJhdGUgdW5pcXVlIGluZGV4ZXNcbiAgICAgICAgY29weUNvbGwudW5pcXVlTmFtZXMgPSBbXTtcbiAgICAgICAgaWYgKGNvbGwuaGFzT3duUHJvcGVydHkoXCJ1bmlxdWVOYW1lc1wiKSkge1xuICAgICAgICAgIGNvcHlDb2xsLnVuaXF1ZU5hbWVzID0gY29sbC51bmlxdWVOYW1lcztcbiAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgY29weUNvbGwudW5pcXVlTmFtZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgIGNvcHlDb2xsLmVuc3VyZVVuaXF1ZUluZGV4KGNvcHlDb2xsLnVuaXF1ZU5hbWVzW2pdKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBpbiBjYXNlIHRoZXkgYXJlIGxvYWRpbmcgYSBkYXRhYmFzZSBjcmVhdGVkIGJlZm9yZSB3ZSBhZGRlZCBkeW5hbWljIHZpZXdzLCBoYW5kbGUgdW5kZWZpbmVkXG4gICAgICAgIGlmICh0eXBlb2YgKGNvbGwuRHluYW1pY1ZpZXdzKSA9PT0gJ3VuZGVmaW5lZCcpIGNvbnRpbnVlO1xuXG4gICAgICAgIC8vIHJlaW5mbGF0ZSBEeW5hbWljVmlld3MgYW5kIGF0dGFjaGVkIFJlc3VsdHNldHNcbiAgICAgICAgZm9yICh2YXIgaWR4ID0gMDsgaWR4IDwgY29sbC5EeW5hbWljVmlld3MubGVuZ3RoOyBpZHgrKykge1xuICAgICAgICAgIHZhciBjb2xsZHYgPSBjb2xsLkR5bmFtaWNWaWV3c1tpZHhdO1xuXG4gICAgICAgICAgdmFyIGR2ID0gY29weUNvbGwuYWRkRHluYW1pY1ZpZXcoY29sbGR2Lm5hbWUsIGNvbGxkdi5vcHRpb25zKTtcbiAgICAgICAgICBkdi5yZXN1bHRkYXRhID0gY29sbGR2LnJlc3VsdGRhdGE7XG4gICAgICAgICAgZHYucmVzdWx0c2RpcnR5ID0gY29sbGR2LnJlc3VsdHNkaXJ0eTtcbiAgICAgICAgICBkdi5maWx0ZXJQaXBlbGluZSA9IGNvbGxkdi5maWx0ZXJQaXBlbGluZTtcblxuICAgICAgICAgIGR2LnNvcnRDcml0ZXJpYSA9IGNvbGxkdi5zb3J0Q3JpdGVyaWE7XG4gICAgICAgICAgZHYuc29ydEZ1bmN0aW9uID0gbnVsbDtcblxuICAgICAgICAgIGR2LnNvcnREaXJ0eSA9IGNvbGxkdi5zb3J0RGlydHk7XG4gICAgICAgICAgZHYucmVzdWx0c2V0LmZpbHRlcmVkcm93cyA9IGNvbGxkdi5yZXN1bHRzZXQuZmlsdGVyZWRyb3dzO1xuICAgICAgICAgIGR2LnJlc3VsdHNldC5maWx0ZXJJbml0aWFsaXplZCA9IGNvbGxkdi5yZXN1bHRzZXQuZmlsdGVySW5pdGlhbGl6ZWQ7XG5cbiAgICAgICAgICBkdi5yZW1hdGVyaWFsaXplKHtcbiAgICAgICAgICAgIHJlbW92ZVdoZXJlRmlsdGVyczogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVXBncmFkZSBMb2dpYyBmb3IgYmluYXJ5IGluZGV4IHJlZmFjdG9yaW5nIGF0IHZlcnNpb24gMS41XG4gICAgICAgIGlmIChkYk9iamVjdC5kYXRhYmFzZVZlcnNpb24gPCAxLjUpIHtcbiAgICAgICAgICAgIC8vIHJlYnVpbGQgYWxsIGluZGljZXNcbiAgICAgICAgICAgIGNvcHlDb2xsLmVuc3VyZUFsbEluZGV4ZXModHJ1ZSk7XG4gICAgICAgICAgICBjb3B5Q29sbC5kaXJ0eSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogRW1pdHMgdGhlIGNsb3NlIGV2ZW50LiBJbiBhdXRvc2F2ZSBzY2VuYXJpb3MsIGlmIHRoZSBkYXRhYmFzZSBpcyBkaXJ0eSwgdGhpcyB3aWxsIHNhdmUgYW5kIGRpc2FibGUgdGltZXIuXG4gICAgICogRG9lcyBub3QgYWN0dWFsbHkgZGVzdHJveSB0aGUgZGIuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uPX0gY2FsbGJhY2sgLSAoT3B0aW9uYWwpIGlmIHN1cHBsaWVkIHdpbGwgYmUgcmVnaXN0ZXJlZCB3aXRoIGNsb3NlIGV2ZW50IGJlZm9yZSBlbWl0dGluZy5cbiAgICAgKiBAbWVtYmVyb2YgTG9raVxuICAgICAqL1xuICAgIExva2kucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAvLyBmb3IgYXV0b3NhdmUgc2NlbmFyaW9zLCB3ZSB3aWxsIGxldCBjbG9zZSBwZXJmb3JtIGZpbmFsIHNhdmUgKGlmIGRpcnR5KVxuICAgICAgLy8gRm9yIHdlYiB1c2UsIHlvdSBtaWdodCBjYWxsIGZyb20gd2luZG93Lm9uYmVmb3JldW5sb2FkIHRvIHNodXRkb3duIGRhdGFiYXNlLCBzYXZpbmcgcGVuZGluZyBjaGFuZ2VzXG4gICAgICBpZiAodGhpcy5hdXRvc2F2ZSkge1xuICAgICAgICB0aGlzLmF1dG9zYXZlRGlzYWJsZSgpO1xuICAgICAgICBpZiAodGhpcy5hdXRvc2F2ZURpcnR5KCkpIHtcbiAgICAgICAgICB0aGlzLnNhdmVEYXRhYmFzZShjYWxsYmFjayk7XG4gICAgICAgICAgY2FsbGJhY2sgPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMub24oJ2Nsb3NlJywgY2FsbGJhY2spO1xuICAgICAgfVxuICAgICAgdGhpcy5lbWl0KCdjbG9zZScpO1xuICAgIH07XG5cbiAgICAvKiotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tK1xuICAgIHwgQ2hhbmdlcyBBUEkgICAgICAgICAgICAgICB8XG4gICAgKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuICAgIC8qKlxuICAgICAqIFRoZSBDaGFuZ2VzIEFQSSBlbmFibGVzIHRoZSB0cmFja2luZyB0aGUgY2hhbmdlcyBvY2N1cnJlZCBpbiB0aGUgY29sbGVjdGlvbnMgc2luY2UgdGhlIGJlZ2lubmluZyBvZiB0aGUgc2Vzc2lvbixcbiAgICAgKiBzbyBpdCdzIHBvc3NpYmxlIHRvIGNyZWF0ZSBhIGRpZmZlcmVudGlhbCBkYXRhc2V0IGZvciBzeW5jaHJvbml6YXRpb24gcHVycG9zZXMgKHBvc3NpYmx5IHRvIGEgcmVtb3RlIGRiKVxuICAgICAqL1xuXG4gICAgLyoqXG4gICAgICogKENoYW5nZXMgQVBJKSA6IHRha2VzIGFsbCB0aGUgY2hhbmdlcyBzdG9yZWQgaW4gZWFjaFxuICAgICAqIGNvbGxlY3Rpb24gYW5kIGNyZWF0ZXMgYSBzaW5nbGUgYXJyYXkgZm9yIHRoZSBlbnRpcmUgZGF0YWJhc2UuIElmIGFuIGFycmF5IG9mIG5hbWVzXG4gICAgICogb2YgY29sbGVjdGlvbnMgaXMgcGFzc2VkIHRoZW4gb25seSB0aGUgaW5jbHVkZWQgY29sbGVjdGlvbnMgd2lsbCBiZSB0cmFja2VkLlxuICAgICAqXG4gICAgICogQHBhcmFtIHthcnJheT19IG9wdGlvbmFsIGFycmF5IG9mIGNvbGxlY3Rpb24gbmFtZXMuIE5vIGFyZyBtZWFucyBhbGwgY29sbGVjdGlvbnMgYXJlIHByb2Nlc3NlZC5cbiAgICAgKiBAcmV0dXJucyB7YXJyYXl9IGFycmF5IG9mIGNoYW5nZXNcbiAgICAgKiBAc2VlIHByaXZhdGUgbWV0aG9kIGNyZWF0ZUNoYW5nZSgpIGluIENvbGxlY3Rpb25cbiAgICAgKiBAbWVtYmVyb2YgTG9raVxuICAgICAqL1xuICAgIExva2kucHJvdG90eXBlLmdlbmVyYXRlQ2hhbmdlc05vdGlmaWNhdGlvbiA9IGZ1bmN0aW9uIChhcnJheU9mQ29sbGVjdGlvbk5hbWVzKSB7XG4gICAgICBmdW5jdGlvbiBnZXRDb2xsTmFtZShjb2xsKSB7XG4gICAgICAgIHJldHVybiBjb2xsLm5hbWU7XG4gICAgICB9XG4gICAgICB2YXIgY2hhbmdlcyA9IFtdLFxuICAgICAgICBzZWxlY3RlZENvbGxlY3Rpb25zID0gYXJyYXlPZkNvbGxlY3Rpb25OYW1lcyB8fCB0aGlzLmNvbGxlY3Rpb25zLm1hcChnZXRDb2xsTmFtZSk7XG5cbiAgICAgIHRoaXMuY29sbGVjdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoY29sbCkge1xuICAgICAgICBpZiAoc2VsZWN0ZWRDb2xsZWN0aW9ucy5pbmRleE9mKGdldENvbGxOYW1lKGNvbGwpKSAhPT0gLTEpIHtcbiAgICAgICAgICBjaGFuZ2VzID0gY2hhbmdlcy5jb25jYXQoY29sbC5nZXRDaGFuZ2VzKCkpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBjaGFuZ2VzO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiAoQ2hhbmdlcyBBUEkpIC0gc3RyaW5naWZ5IGNoYW5nZXMgZm9yIG5ldHdvcmsgdHJhbnNtaXNzaW9uXG4gICAgICogQHJldHVybnMge3N0cmluZ30gc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBjaGFuZ2VzXG4gICAgICogQG1lbWJlcm9mIExva2lcbiAgICAgKi9cbiAgICBMb2tpLnByb3RvdHlwZS5zZXJpYWxpemVDaGFuZ2VzID0gZnVuY3Rpb24gKGNvbGxlY3Rpb25OYW1lc0FycmF5KSB7XG4gICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodGhpcy5nZW5lcmF0ZUNoYW5nZXNOb3RpZmljYXRpb24oY29sbGVjdGlvbk5hbWVzQXJyYXkpKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogKENoYW5nZXMgQVBJKSA6IGNsZWFycyBhbGwgdGhlIGNoYW5nZXMgaW4gYWxsIGNvbGxlY3Rpb25zLlxuICAgICAqIEBtZW1iZXJvZiBMb2tpXG4gICAgICovXG4gICAgTG9raS5wcm90b3R5cGUuY2xlYXJDaGFuZ2VzID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5jb2xsZWN0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChjb2xsKSB7XG4gICAgICAgIGlmIChjb2xsLmZsdXNoQ2hhbmdlcykge1xuICAgICAgICAgIGNvbGwuZmx1c2hDaGFuZ2VzKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICAvKi0tLS0tLS0tLS0tLS0tLS0tLStcbiAgICB8IFBFUlNJU1RFTkNFICAgICAgIHxcbiAgICAtLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuICAgIC8qKiB0aGVyZSBhcmUgdHdvIGJ1aWxkIGluIHBlcnNpc3RlbmNlIGFkYXB0ZXJzIGZvciBpbnRlcm5hbCB1c2VcbiAgICAgKiBmcyAgICAgICAgICAgICBmb3IgdXNlIGluIE5vZGVqcyB0eXBlIGVudmlyb25tZW50c1xuICAgICAqIGxvY2FsU3RvcmFnZSAgIGZvciB1c2UgaW4gYnJvd3NlciBlbnZpcm9ubWVudFxuICAgICAqIGRlZmluZWQgYXMgaGVscGVyIGNsYXNzZXMgaGVyZSBzbyBpdHMgZWFzeSBhbmQgY2xlYW4gdG8gdXNlXG4gICAgICovXG5cbiAgICAvKipcbiAgICAgKiBJbiBpbi1tZW1vcnkgcGVyc2lzdGVuY2UgYWRhcHRlciBmb3IgYW4gaW4tbWVtb3J5IGRhdGFiYXNlLlxuICAgICAqIFRoaXMgc2ltcGxlICdrZXkvdmFsdWUnIGFkYXB0ZXIgaXMgaW50ZW5kZWQgZm9yIHVuaXQgdGVzdGluZyBhbmQgZGlhZ25vc3RpY3MuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge29iamVjdD19IG9wdGlvbnMgLSBtZW1vcnkgYWRhcHRlciBvcHRpb25zXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5hc3luY1Jlc3BvbnNlcz1mYWxzZV0gLSB3aGV0aGVyIGNhbGxiYWNrcyBhcmUgaW52b2tlZCBhc3luY2hyb25vdXNseVxuICAgICAqIEBwYXJhbSB7aW50fSBbb3B0aW9ucy5hc3luY1RpbWVvdXQ9NTBdIC0gdGltZW91dCBpbiBtcyB0byBxdWV1ZSBjYWxsYmFja3NcbiAgICAgKiBAY29uc3RydWN0b3IgTG9raU1lbW9yeUFkYXB0ZXJcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBMb2tpTWVtb3J5QWRhcHRlcihvcHRpb25zKSB7XG4gICAgICB0aGlzLmhhc2hTdG9yZSA9IHt9O1xuICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblxuICAgICAgaWYgKCF0aGlzLm9wdGlvbnMuaGFzT3duUHJvcGVydHkoJ2FzeW5jUmVzcG9uc2VzJykpIHtcbiAgICAgICAgdGhpcy5vcHRpb25zLmFzeW5jUmVzcG9uc2VzID0gZmFsc2U7XG4gICAgICB9XG5cbiAgICAgIGlmICghdGhpcy5vcHRpb25zLmhhc093blByb3BlcnR5KCdhc3luY1RpbWVvdXQnKSkge1xuICAgICAgICB0aGlzLm9wdGlvbnMuYXN5bmNUaW1lb3V0ID0gNTA7IC8vIDUwIG1zIGRlZmF1bHRcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBMb2FkcyBhIHNlcmlhbGl6ZWQgZGF0YWJhc2UgZnJvbSBpdHMgaW4tbWVtb3J5IHN0b3JlLlxuICAgICAqIChMb2tpIHBlcnNpc3RlbmNlIGFkYXB0ZXIgaW50ZXJmYWNlIGZ1bmN0aW9uKVxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGRibmFtZSAtIG5hbWUgb2YgdGhlIGRhdGFiYXNlIChmaWxlbmFtZS9rZXluYW1lKVxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IGNhbGxiYWNrIC0gYWRhcHRlciBjYWxsYmFjayB0byByZXR1cm4gbG9hZCByZXN1bHQgdG8gY2FsbGVyXG4gICAgICogQG1lbWJlcm9mIExva2lNZW1vcnlBZGFwdGVyXG4gICAgICovXG4gICAgTG9raU1lbW9yeUFkYXB0ZXIucHJvdG90eXBlLmxvYWREYXRhYmFzZSA9IGZ1bmN0aW9uIChkYm5hbWUsIGNhbGxiYWNrKSB7XG4gICAgICB2YXIgc2VsZj10aGlzO1xuXG4gICAgICBpZiAodGhpcy5vcHRpb25zLmFzeW5jUmVzcG9uc2VzKSB7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaWYgKHNlbGYuaGFzaFN0b3JlLmhhc093blByb3BlcnR5KGRibmFtZSkpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKHNlbGYuaGFzaFN0b3JlW2RibmFtZV0udmFsdWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vIGRhdGFiYXNlIGRvZXNuJ3QgZXhpc3QsIHJldHVybiBmYWxzeVxuICAgICAgICAgICAgY2FsbGJhY2sgKG51bGwpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSwgdGhpcy5vcHRpb25zLmFzeW5jVGltZW91dCk7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgaWYgKHRoaXMuaGFzaFN0b3JlLmhhc093blByb3BlcnR5KGRibmFtZSkpIHtcbiAgICAgICAgICAvLyBkYXRhYmFzZSBkb2Vzbid0IGV4aXN0LCByZXR1cm4gZmFsc3lcbiAgICAgICAgICBjYWxsYmFjayh0aGlzLmhhc2hTdG9yZVtkYm5hbWVdLnZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICBjYWxsYmFjayAobnVsbCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogU2F2ZXMgYSBzZXJpYWxpemVkIGRhdGFiYXNlIHRvIGl0cyBpbi1tZW1vcnkgc3RvcmUuXG4gICAgICogKExva2kgcGVyc2lzdGVuY2UgYWRhcHRlciBpbnRlcmZhY2UgZnVuY3Rpb24pXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZGJuYW1lIC0gbmFtZSBvZiB0aGUgZGF0YWJhc2UgKGZpbGVuYW1lL2tleW5hbWUpXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbn0gY2FsbGJhY2sgLSBhZGFwdGVyIGNhbGxiYWNrIHRvIHJldHVybiBsb2FkIHJlc3VsdCB0byBjYWxsZXJcbiAgICAgKiBAbWVtYmVyb2YgTG9raU1lbW9yeUFkYXB0ZXJcbiAgICAgKi9cbiAgICBMb2tpTWVtb3J5QWRhcHRlci5wcm90b3R5cGUuc2F2ZURhdGFiYXNlID0gZnVuY3Rpb24gKGRibmFtZSwgZGJzdHJpbmcsIGNhbGxiYWNrKSB7XG4gICAgICB2YXIgc2VsZj10aGlzO1xuICAgICAgdmFyIHNhdmVDb3VudDtcblxuICAgICAgaWYgKHRoaXMub3B0aW9ucy5hc3luY1Jlc3BvbnNlcykge1xuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHNhdmVDb3VudCA9IChzZWxmLmhhc2hTdG9yZS5oYXNPd25Qcm9wZXJ0eShkYm5hbWUpP3NlbGYuaGFzaFN0b3JlW2RibmFtZV0uc2F2ZWNvdW50OjApO1xuXG4gICAgICAgICAgc2VsZi5oYXNoU3RvcmVbZGJuYW1lXSA9IHtcbiAgICAgICAgICAgIHNhdmVjb3VudDogc2F2ZUNvdW50KzEsXG4gICAgICAgICAgICBsYXN0c2F2ZTogbmV3IERhdGUoKSxcbiAgICAgICAgICAgIHZhbHVlOiBkYnN0cmluZ1xuICAgICAgICAgIH07XG5cbiAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICB9LCB0aGlzLm9wdGlvbnMuYXN5bmNUaW1lb3V0KTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICBzYXZlQ291bnQgPSAodGhpcy5oYXNoU3RvcmUuaGFzT3duUHJvcGVydHkoZGJuYW1lKT90aGlzLmhhc2hTdG9yZVtkYm5hbWVdLnNhdmVjb3VudDowKTtcblxuICAgICAgICB0aGlzLmhhc2hTdG9yZVtkYm5hbWVdID0ge1xuICAgICAgICAgIHNhdmVjb3VudDogc2F2ZUNvdW50KzEsXG4gICAgICAgICAgbGFzdHNhdmU6IG5ldyBEYXRlKCksXG4gICAgICAgICAgdmFsdWU6IGRic3RyaW5nXG4gICAgICAgIH07XG5cbiAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogRGVsZXRlcyBhIGRhdGFiYXNlIGZyb20gaXRzIGluLW1lbW9yeSBzdG9yZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBkYm5hbWUgLSBuYW1lIG9mIHRoZSBkYXRhYmFzZSAoZmlsZW5hbWUva2V5bmFtZSlcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBjYWxsYmFjayAtIGZ1bmN0aW9uIHRvIGNhbGwgd2hlbiBkb25lXG4gICAgICogQG1lbWJlcm9mIExva2lNZW1vcnlBZGFwdGVyXG4gICAgICovXG4gICAgTG9raU1lbW9yeUFkYXB0ZXIucHJvdG90eXBlLmRlbGV0ZURhdGFiYXNlID0gZnVuY3Rpb24oZGJuYW1lLCBjYWxsYmFjaykge1xuICAgICAgaWYgKHRoaXMuaGFzaFN0b3JlLmhhc093blByb3BlcnR5KGRibmFtZSkpIHtcbiAgICAgICAgZGVsZXRlIHRoaXMuaGFzaFN0b3JlW2RibmFtZV07XG4gICAgICB9XG5cbiAgICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBBbiBhZGFwdGVyIGZvciBhZGFwdGVycy4gIENvbnZlcnRzIGEgbm9uIHJlZmVyZW5jZSBtb2RlIGFkYXB0ZXIgaW50byBhIHJlZmVyZW5jZSBtb2RlIGFkYXB0ZXJcbiAgICAgKiB3aGljaCBjYW4gcGVyZm9ybSBkZXN0cnVjdHVyaW5nIGFuZCBwYXJ0aW9uaW5nLiAgRWFjaCBjb2xsZWN0aW9uIHdpbGwgYmUgc3RvcmVkIGluIGl0cyBvd24ga2V5L3NhdmUgYW5kXG4gICAgICogb25seSBkaXJ0eSBjb2xsZWN0aW9ucyB3aWxsIGJlIHNhdmVkLiAgSWYgeW91ICB0dXJuIG9uIHBhZ2luZyB3aXRoIGRlZmF1bHQgcGFnZSBzaXplIG9mIDI1bWVncyBhbmQgc2F2ZVxuICAgICAqIGEgNzUgbWVnIGNvbGxlY3Rpb24gaXQgc2hvdWxkIHVzZSB1cCByb3VnaGx5IDMgc2F2ZSBzbG90cyAoa2V5L3ZhbHVlIHBhaXJzIHNlbnQgdG8gaW5uZXIgYWRhcHRlcikuXG4gICAgICogQSBkaXJ0eSBjb2xsZWN0aW9uIHRoYXQgc3BhbnMgdGhyZWUgcGFnZXMgd2lsbCBzYXZlIGFsbCB0aHJlZSBwYWdlcyBhZ2FpblxuICAgICAqIFBhZ2luZyBtb2RlIHdhcyBhZGRlZCBtYWlubHkgYmVjYXVzZSBDaHJvbWUgaGFzIGlzc3VlcyBzYXZpbmcgJ3RvbyBsYXJnZScgb2YgYSBzdHJpbmcgd2l0aGluIGFcbiAgICAgKiBzaW5nbGUgaW5kZXhlZGRiIHJvdy4gIElmIGEgc2luZ2xlIGRvY3VtZW50IHVwZGF0ZSBjYXVzZXMgdGhlIGNvbGxlY3Rpb24gdG8gYmUgZmxhZ2dlZCBhcyBkaXJ0eSwgYWxsXG4gICAgICogb2YgdGhhdCBjb2xsZWN0aW9uJ3MgcGFnZXMgd2lsbCBiZSB3cml0dGVuIG9uIG5leHQgc2F2ZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBhZGFwdGVyIC0gcmVmZXJlbmNlIHRvIGEgJ25vbi1yZWZlcmVuY2UnIG1vZGUgbG9raSBhZGFwdGVyIGluc3RhbmNlLlxuICAgICAqIEBwYXJhbSB7b2JqZWN0PX0gb3B0aW9ucyAtIGNvbmZpZ3VyYXRpb24gb3B0aW9ucyBmb3IgcGFydGl0aW9uaW5nIGFuZCBwYWdpbmdcbiAgICAgKiBAcGFyYW0ge2Jvb2x9IG9wdGlvbnMucGFnaW5nIC0gKGRlZmF1bHQ6IGZhbHNlKSBzZXQgdG8gdHJ1ZSB0byBlbmFibGUgcGFnaW5nIGNvbGxlY3Rpb24gZGF0YS5cbiAgICAgKiBAcGFyYW0ge2ludH0gb3B0aW9ucy5wYWdlU2l6ZSAtIChkZWZhdWx0IDogMjVNQikgeW91IGNhbiB1c2UgdGhpcyB0byBsaW1pdCBzaXplIG9mIHN0cmluZ3MgcGFzc2VkIHRvIGlubmVyIGFkYXB0ZXIuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG9wdGlvbnMuZGVsaW1pdGVyIC0gYWxsb3dzIHlvdSB0byBvdmVycmlkZSB0aGUgZGVmYXVsdCBkZWxpbWV0ZXJcbiAgICAgKiBAY29uc3RydWN0b3IgTG9raVBhcnRpdGlvbmluZ0FkYXB0ZXJcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBMb2tpUGFydGl0aW9uaW5nQWRhcHRlcihhZGFwdGVyLCBvcHRpb25zKSB7XG4gICAgICB0aGlzLm1vZGUgPSBcInJlZmVyZW5jZVwiO1xuICAgICAgdGhpcy5hZGFwdGVyID0gbnVsbDtcbiAgICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gICAgICB0aGlzLmRicmVmID0gbnVsbDtcbiAgICAgIHRoaXMuZGJuYW1lID0gXCJcIjtcbiAgICAgIHRoaXMucGFnZUl0ZXJhdG9yID0ge307XG5cbiAgICAgIC8vIHZlcmlmeSB1c2VyIHBhc3NlZCBhbiBhcHByb3ByaWF0ZSBhZGFwdGVyXG4gICAgICBpZiAoYWRhcHRlcikge1xuICAgICAgICBpZiAoYWRhcHRlci5tb2RlID09PSBcInJlZmVyZW5jZVwiKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTG9raVBhcnRpdGlvbmluZ0FkYXB0ZXIgY2Fubm90IGJlIGluc3RhbnRpYXRlZCB3aXRoIGEgcmVmZXJlbmNlIG1vZGUgYWRhcHRlclwiKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICB0aGlzLmFkYXB0ZXIgPSBhZGFwdGVyO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTG9raVBhcnRpdGlvbmluZ0FkYXB0ZXIgcmVxdWlyZXMgYSAobm9uLXJlZmVyZW5jZSBtb2RlKSBhZGFwdGVyIG9uIGNvbnN0cnVjdGlvblwiKTtcbiAgICAgIH1cblxuICAgICAgLy8gc2V0IGNvbGxlY3Rpb24gcGFnaW5nIGRlZmF1bHRzXG4gICAgICBpZiAoIXRoaXMub3B0aW9ucy5oYXNPd25Qcm9wZXJ0eShcInBhZ2luZ1wiKSkge1xuICAgICAgICB0aGlzLm9wdGlvbnMucGFnaW5nID0gZmFsc2U7XG4gICAgICB9XG5cbiAgICAgIC8vIGRlZmF1bHQgdG8gcGFnZSBzaXplIG9mIDI1IG1lZ3MgKGNhbiBiZSB1cCB0byB5b3VyIGxhcmdlc3Qgc2VyaWFsaXplZCBvYmplY3Qgc2l6ZSBsYXJnZXIgdGhhbiB0aGlzKVxuICAgICAgaWYgKCF0aGlzLm9wdGlvbnMuaGFzT3duUHJvcGVydHkoXCJwYWdlU2l6ZVwiKSkge1xuICAgICAgICB0aGlzLm9wdGlvbnMucGFnZVNpemUgPSAyNSoxMDI0KjEwMjQ7XG4gICAgICB9XG5cbiAgICAgIGlmICghdGhpcy5vcHRpb25zLmhhc093blByb3BlcnR5KFwiZGVsaW1pdGVyXCIpKSB7XG4gICAgICAgIHRoaXMub3B0aW9ucy5kZWxpbWl0ZXIgPSAnJDxcXG4nO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIExvYWRzIGEgZGF0YWJhc2Ugd2hpY2ggd2FzIHBhcnRpdGlvbmVkIGludG8gc2V2ZXJhbCBrZXkvdmFsdWUgc2F2ZXMuXG4gICAgICogKExva2kgcGVyc2lzdGVuY2UgYWRhcHRlciBpbnRlcmZhY2UgZnVuY3Rpb24pXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZGJuYW1lIC0gbmFtZSBvZiB0aGUgZGF0YWJhc2UgKGZpbGVuYW1lL2tleW5hbWUpXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbn0gY2FsbGJhY2sgLSBhZGFwdGVyIGNhbGxiYWNrIHRvIHJldHVybiBsb2FkIHJlc3VsdCB0byBjYWxsZXJcbiAgICAgKiBAbWVtYmVyb2YgTG9raVBhcnRpdGlvbmluZ0FkYXB0ZXJcbiAgICAgKi9cbiAgICBMb2tpUGFydGl0aW9uaW5nQWRhcHRlci5wcm90b3R5cGUubG9hZERhdGFiYXNlID0gZnVuY3Rpb24gKGRibmFtZSwgY2FsbGJhY2spIHtcbiAgICAgIHZhciBzZWxmPXRoaXM7XG4gICAgICB0aGlzLmRibmFtZSA9IGRibmFtZTtcbiAgICAgIHRoaXMuZGJyZWYgPSBuZXcgTG9raShkYm5hbWUpO1xuXG4gICAgICAvLyBsb2FkIHRoZSBkYiBjb250YWluZXIgKHdpdGhvdXQgZGF0YSlcbiAgICAgIHRoaXMuYWRhcHRlci5sb2FkRGF0YWJhc2UoZGJuYW1lLCBmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgLy8gZW1wdHkgZGF0YWJhc2UgY29uZGl0aW9uIGlzIGZvciBpbm5lciBhZGFwdGVyIHJldHVybiBudWxsL3VuZGVmaW5lZC9mYWxzeVxuICAgICAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICAgIC8vIHBhcnRpdGlvbiAwIG5vdCBmb3VuZCBzbyBuZXcgZGF0YWJhc2UsIG5vIG5lZWQgdG8gdHJ5IHRvIGxvYWQgb3RoZXIgcGFydGl0aW9ucy5cbiAgICAgICAgICAvLyByZXR1cm4gc2FtZSBmYWxzeSByZXN1bHQgdG8gbG9hZERhdGFiYXNlIHRvIHNpZ25pZnkgbm8gZGF0YWJhc2UgZXhpc3RzICh5ZXQpXG4gICAgICAgICAgY2FsbGJhY2socmVzdWx0KTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodHlwZW9mIHJlc3VsdCAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcihcIkxva2lQYXJ0aXRpb25pbmdBZGFwdGVyIHJlY2VpdmVkIGFuIHVuZXhwZWN0ZWQgcmVzcG9uc2UgZnJvbSBpbm5lciBhZGFwdGVyIGxvYWREYXRhYmFzZSgpXCIpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEkgd2lsbCB3YW50IHRvIHVzZSBsb2tpIGRlc3RydWN0dXJpbmcgaGVscGVyIG1ldGhvZHMgc28gaSB3aWxsIGluZmxhdGUgaW50byB0eXBlZCBpbnN0YW5jZVxuICAgICAgICB2YXIgZGIgPSBKU09OLnBhcnNlKHJlc3VsdCk7XG4gICAgICAgIHNlbGYuZGJyZWYubG9hZEpTT05PYmplY3QoZGIpO1xuICAgICAgICBkYiA9IG51bGw7XG5cbiAgICAgICAgdmFyIGNsZW4gPSBzZWxmLmRicmVmLmNvbGxlY3Rpb25zLmxlbmd0aDtcblxuICAgICAgICBpZiAoc2VsZi5kYnJlZi5jb2xsZWN0aW9ucy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICBjYWxsYmFjayhzZWxmLmRicmVmKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBzZWxmLnBhZ2VJdGVyYXRvciA9IHtcbiAgICAgICAgICBjb2xsZWN0aW9uOiAwLFxuICAgICAgICAgIHBhZ2VJbmRleDogMFxuICAgICAgICB9O1xuXG4gICAgICAgIHNlbGYubG9hZE5leHRQYXJ0aXRpb24oMCwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgY2FsbGJhY2soc2VsZi5kYnJlZik7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFVzZWQgdG8gc2VxdWVudGlhbGx5IGxvYWQgZWFjaCBjb2xsZWN0aW9uIHBhcnRpdGlvbiwgb25lIGF0IGEgdGltZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7aW50fSBwYXJ0aXRpb24gLSBvcmRpbmFsIGNvbGxlY3Rpb24gcG9zaXRpb24gdG8gbG9hZCBuZXh0XG4gICAgICogQHBhcmFtIHtmdW5jdGlvbn0gY2FsbGJhY2sgLSBhZGFwdGVyIGNhbGxiYWNrIHRvIHJldHVybiBsb2FkIHJlc3VsdCB0byBjYWxsZXJcbiAgICAgKi9cbiAgICBMb2tpUGFydGl0aW9uaW5nQWRhcHRlci5wcm90b3R5cGUubG9hZE5leHRQYXJ0aXRpb24gPSBmdW5jdGlvbihwYXJ0aXRpb24sIGNhbGxiYWNrKSB7XG4gICAgICB2YXIga2V5bmFtZSA9IHRoaXMuZGJuYW1lICsgXCIuXCIgKyBwYXJ0aXRpb247XG4gICAgICB2YXIgc2VsZj10aGlzO1xuXG4gICAgICBpZiAodGhpcy5vcHRpb25zLnBhZ2luZyA9PT0gdHJ1ZSkge1xuICAgICAgICB0aGlzLnBhZ2VJdGVyYXRvci5wYWdlSW5kZXggPSAwO1xuICAgICAgICB0aGlzLmxvYWROZXh0UGFnZShjYWxsYmFjayk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdGhpcy5hZGFwdGVyLmxvYWREYXRhYmFzZShrZXluYW1lLCBmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgdmFyIGRhdGEgPSBzZWxmLmRicmVmLmRlc2VyaWFsaXplQ29sbGVjdGlvbihyZXN1bHQsIHsgZGVsaW1pdGVkOiB0cnVlLCBjb2xsZWN0aW9uSW5kZXg6IHBhcnRpdGlvbiB9KTtcbiAgICAgICAgc2VsZi5kYnJlZi5jb2xsZWN0aW9uc1twYXJ0aXRpb25dLmRhdGEgPSBkYXRhO1xuXG4gICAgICAgIGlmICgrK3BhcnRpdGlvbiA8IHNlbGYuZGJyZWYuY29sbGVjdGlvbnMubGVuZ3RoKSB7XG4gICAgICAgICAgc2VsZi5sb2FkTmV4dFBhcnRpdGlvbihwYXJ0aXRpb24sIGNhbGxiYWNrKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogVXNlZCB0byBzZXF1ZW50aWFsbHkgbG9hZCB0aGUgbmV4dCBwYWdlIG9mIGNvbGxlY3Rpb24gcGFydGl0aW9uLCBvbmUgYXQgYSB0aW1lLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbn0gY2FsbGJhY2sgLSBhZGFwdGVyIGNhbGxiYWNrIHRvIHJldHVybiBsb2FkIHJlc3VsdCB0byBjYWxsZXJcbiAgICAgKi9cbiAgICBMb2tpUGFydGl0aW9uaW5nQWRhcHRlci5wcm90b3R5cGUubG9hZE5leHRQYWdlID0gZnVuY3Rpb24oY2FsbGJhY2spIHtcbiAgICAgIC8vIGNhbGN1bGF0ZSBuYW1lIGZvciBuZXh0IHNhdmVkIHBhZ2UgaW4gc2VxdWVuY2VcbiAgICAgIHZhciBrZXluYW1lID0gdGhpcy5kYm5hbWUgKyBcIi5cIiArIHRoaXMucGFnZUl0ZXJhdG9yLmNvbGxlY3Rpb24gKyBcIi5cIiArIHRoaXMucGFnZUl0ZXJhdG9yLnBhZ2VJbmRleDtcbiAgICAgIHZhciBzZWxmPXRoaXM7XG5cbiAgICAgIC8vIGxvYWQgd2hhdGV2ZXIgcGFnZSBpcyBuZXh0IGluIHNlcXVlbmNlXG4gICAgICB0aGlzLmFkYXB0ZXIubG9hZERhdGFiYXNlKGtleW5hbWUsIGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICB2YXIgZGF0YSA9IHJlc3VsdC5zcGxpdChzZWxmLm9wdGlvbnMuZGVsaW1pdGVyKTtcbiAgICAgICAgcmVzdWx0ID0gXCJcIjsgLy8gZnJlZSB1cCBtZW1vcnkgbm93IHRoYXQgd2UgaGF2ZSBzcGxpdCBpdCBpbnRvIGFycmF5XG4gICAgICAgIHZhciBkbGVuID0gZGF0YS5sZW5ndGg7XG4gICAgICAgIHZhciBpZHg7XG5cbiAgICAgICAgLy8gZGV0ZWN0IGlmIGxhc3QgcGFnZSBieSBwcmVzZW5jZSBvZiBmaW5hbCBlbXB0eSBzdHJpbmcgZWxlbWVudCBhbmQgcmVtb3ZlIGl0IGlmIHNvXG4gICAgICAgIHZhciBpc0xhc3RQYWdlID0gKGRhdGFbZGxlbi0xXSA9PT0gXCJcIik7XG4gICAgICAgIGlmIChpc0xhc3RQYWdlKSB7XG4gICAgICAgICAgZGF0YS5wb3AoKTtcbiAgICAgICAgICBkbGVuID0gZGF0YS5sZW5ndGg7XG4gICAgICAgICAgLy8gZW1wdHkgY29sbGVjdGlvbnMgYXJlIGp1c3QgYSBkZWxpbWl0ZXIgbWVhbmluZyB0d28gYmxhbmsgaXRlbXNcbiAgICAgICAgICBpZiAoZGF0YVtkbGVuLTFdID09PSBcIlwiICYmIGRsZW4gPT09IDEpIHtcbiAgICAgICAgICAgIGRhdGEucG9wKCk7XG4gICAgICAgICAgICBkbGVuID0gZGF0YS5sZW5ndGg7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gY29udmVydCBzdHJpbmdpZmllZCBhcnJheSBlbGVtZW50cyB0byBvYmplY3QgaW5zdGFuY2VzIGFuZCBwdXNoIHRvIGNvbGxlY3Rpb24gZGF0YVxuICAgICAgICBmb3IoaWR4PTA7IGlkeCA8IGRsZW47IGlkeCsrKSB7XG4gICAgICAgICAgc2VsZi5kYnJlZi5jb2xsZWN0aW9uc1tzZWxmLnBhZ2VJdGVyYXRvci5jb2xsZWN0aW9uXS5kYXRhLnB1c2goSlNPTi5wYXJzZShkYXRhW2lkeF0pKTtcbiAgICAgICAgICBkYXRhW2lkeF0gPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGRhdGEgPSBbXTtcblxuICAgICAgICAvLyBpZiBsYXN0IHBhZ2UsIHdlIGFyZSBkb25lIHdpdGggdGhpcyBwYXJ0aXRpb25cbiAgICAgICAgaWYgKGlzTGFzdFBhZ2UpIHtcblxuICAgICAgICAgIC8vIGlmIHRoZXJlIGFyZSBtb3JlIHBhcnRpdGlvbnMsIGtpY2sgb2ZmIG5leHQgcGFydGl0aW9uIGxvYWRcbiAgICAgICAgICBpZiAoKytzZWxmLnBhZ2VJdGVyYXRvci5jb2xsZWN0aW9uIDwgc2VsZi5kYnJlZi5jb2xsZWN0aW9ucy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHNlbGYubG9hZE5leHRQYXJ0aXRpb24oc2VsZi5wYWdlSXRlcmF0b3IuY29sbGVjdGlvbiwgY2FsbGJhY2spO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIHNlbGYucGFnZUl0ZXJhdG9yLnBhZ2VJbmRleCsrO1xuICAgICAgICAgIHNlbGYubG9hZE5leHRQYWdlKGNhbGxiYWNrKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFNhdmVzIGEgZGF0YWJhc2UgYnkgcGFydGlvbmluZyBpbnRvIHNlcGFyYXRlIGtleS92YWx1ZSBzYXZlcy5cbiAgICAgKiAoTG9raSAncmVmZXJlbmNlIG1vZGUnIHBlcnNpc3RlbmNlIGFkYXB0ZXIgaW50ZXJmYWNlIGZ1bmN0aW9uKVxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGRibmFtZSAtIG5hbWUgb2YgdGhlIGRhdGFiYXNlIChmaWxlbmFtZS9rZXluYW1lKVxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBkYnJlZiAtIHJlZmVyZW5jZSB0byBkYXRhYmFzZSB3aGljaCB3ZSB3aWxsIHBhcnRpdGlvbiBhbmQgc2F2ZS5cbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBjYWxsYmFjayAtIGFkYXB0ZXIgY2FsbGJhY2sgdG8gcmV0dXJuIGxvYWQgcmVzdWx0IHRvIGNhbGxlclxuICAgICAqXG4gICAgICogQG1lbWJlcm9mIExva2lQYXJ0aXRpb25pbmdBZGFwdGVyXG4gICAgICovXG4gICAgTG9raVBhcnRpdGlvbmluZ0FkYXB0ZXIucHJvdG90eXBlLmV4cG9ydERhdGFiYXNlID0gZnVuY3Rpb24oZGJuYW1lLCBkYnJlZiwgY2FsbGJhY2spIHtcbiAgICAgIHZhciBzZWxmPXRoaXM7XG4gICAgICB2YXIgaWR4LCBjbGVuID0gZGJyZWYuY29sbGVjdGlvbnMubGVuZ3RoO1xuXG4gICAgICB0aGlzLmRicmVmID0gZGJyZWY7XG4gICAgICB0aGlzLmRibmFtZSA9IGRibmFtZTtcblxuICAgICAgLy8gcXVldWUgdXAgZGlydHkgcGFydGl0aW9ucyB0byBiZSBzYXZlZFxuICAgICAgdGhpcy5kaXJ0eVBhcnRpdGlvbnMgPSBbLTFdO1xuICAgICAgZm9yKGlkeD0wOyBpZHg8Y2xlbjsgaWR4KyspIHtcbiAgICAgICAgaWYgKGRicmVmLmNvbGxlY3Rpb25zW2lkeF0uZGlydHkpIHtcbiAgICAgICAgICB0aGlzLmRpcnR5UGFydGl0aW9ucy5wdXNoKGlkeCk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgdGhpcy5zYXZlTmV4dFBhcnRpdGlvbihmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgY2FsbGJhY2soZXJyKTtcbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBIZWxwZXIgbWV0aG9kIHVzZWQgaW50ZXJuYWxseSB0byBzYXZlIGVhY2ggZGlydHkgY29sbGVjdGlvbiwgb25lIGF0IGEgdGltZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IGNhbGxiYWNrIC0gYWRhcHRlciBjYWxsYmFjayB0byByZXR1cm4gbG9hZCByZXN1bHQgdG8gY2FsbGVyXG4gICAgICovXG4gICAgTG9raVBhcnRpdGlvbmluZ0FkYXB0ZXIucHJvdG90eXBlLnNhdmVOZXh0UGFydGl0aW9uID0gZnVuY3Rpb24oY2FsbGJhY2spIHtcbiAgICAgIHZhciBzZWxmPXRoaXM7XG4gICAgICB2YXIgcGFydGl0aW9uID0gdGhpcy5kaXJ0eVBhcnRpdGlvbnMuc2hpZnQoKTtcbiAgICAgIHZhciBrZXluYW1lID0gdGhpcy5kYm5hbWUgKyAoKHBhcnRpdGlvbj09PS0xKT9cIlwiOihcIi5cIiArIHBhcnRpdGlvbikpO1xuXG4gICAgICAvLyBpZiB3ZSBhcmUgZG9pbmcgcGFnaW5nIGFuZCB0aGlzIGlzIGNvbGxlY3Rpb24gcGFydGl0aW9uXG4gICAgICBpZiAodGhpcy5vcHRpb25zLnBhZ2luZyAmJiBwYXJ0aXRpb24gIT09IC0xKSB7XG4gICAgICAgIHRoaXMucGFnZUl0ZXJhdG9yID0ge1xuICAgICAgICAgIGNvbGxlY3Rpb246IHBhcnRpdGlvbixcbiAgICAgICAgICBkb2NJbmRleDogMCxcbiAgICAgICAgICBwYWdlSW5kZXg6IDBcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBzaW5jZSBzYXZlTmV4dFBhZ2UgcmVjdXJzaXZlbHkgY2FsbHMgaXRzZWxmIHVudGlsIGRvbmUsIG91ciBjYWxsYmFjayBtZWFucyB0aGlzIHdob2xlIHBhZ2VkIHBhcnRpdGlvbiBpcyBmaW5pc2hlZFxuICAgICAgICB0aGlzLnNhdmVOZXh0UGFnZShmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICBpZiAoc2VsZi5kaXJ0eVBhcnRpdGlvbnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBjYWxsYmFjayhlcnIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHNlbGYuc2F2ZU5leHRQYXJ0aXRpb24oY2FsbGJhY2spO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gb3RoZXJ3aXNlIHRoaXMgaXMgJ25vbi1wYWdlZCcgcGFydGlvbmluZy4uLlxuICAgICAgdmFyIHJlc3VsdCA9IHRoaXMuZGJyZWYuc2VyaWFsaXplRGVzdHJ1Y3R1cmVkKHtcbiAgICAgICAgcGFydGl0aW9uZWQgOiB0cnVlLFxuICAgICAgICBkZWxpbWl0ZWQ6IHRydWUsXG4gICAgICAgIHBhcnRpdGlvbjogcGFydGl0aW9uXG4gICAgICB9KTtcblxuICAgICAgdGhpcy5hZGFwdGVyLnNhdmVEYXRhYmFzZShrZXluYW1lLCByZXN1bHQsIGZ1bmN0aW9uKGVycikge1xuICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgY2FsbGJhY2soZXJyKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoc2VsZi5kaXJ0eVBhcnRpdGlvbnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgY2FsbGJhY2sobnVsbCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgc2VsZi5zYXZlTmV4dFBhcnRpdGlvbihjYWxsYmFjayk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBIZWxwZXIgbWV0aG9kIHVzZWQgaW50ZXJuYWxseSB0byBnZW5lcmF0ZSBhbmQgc2F2ZSB0aGUgbmV4dCBwYWdlIG9mIHRoZSBjdXJyZW50IChkaXJ0eSkgcGFydGl0aW9uLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbn0gY2FsbGJhY2sgLSBhZGFwdGVyIGNhbGxiYWNrIHRvIHJldHVybiBsb2FkIHJlc3VsdCB0byBjYWxsZXJcbiAgICAgKi9cbiAgICBMb2tpUGFydGl0aW9uaW5nQWRhcHRlci5wcm90b3R5cGUuc2F2ZU5leHRQYWdlID0gZnVuY3Rpb24oY2FsbGJhY2spIHtcbiAgICAgIHZhciBzZWxmPXRoaXM7XG4gICAgICB2YXIgY29sbCA9IHRoaXMuZGJyZWYuY29sbGVjdGlvbnNbdGhpcy5wYWdlSXRlcmF0b3IuY29sbGVjdGlvbl07XG4gICAgICB2YXIga2V5bmFtZSA9IHRoaXMuZGJuYW1lICsgXCIuXCIgKyB0aGlzLnBhZ2VJdGVyYXRvci5jb2xsZWN0aW9uICsgXCIuXCIgKyB0aGlzLnBhZ2VJdGVyYXRvci5wYWdlSW5kZXg7XG4gICAgICB2YXIgcGFnZUxlbj0wLFxuICAgICAgICBjZGxlbiA9IGNvbGwuZGF0YS5sZW5ndGgsXG4gICAgICAgIGRlbGltbGVuID0gdGhpcy5vcHRpb25zLmRlbGltaXRlci5sZW5ndGg7XG4gICAgICB2YXIgc2VyaWFsaXplZE9iamVjdCA9IFwiXCIsXG4gICAgICAgIHBhZ2VCdWlsZGVyID0gXCJcIjtcbiAgICAgIHZhciBkb25lV2l0aFBhcnRpdGlvbj1mYWxzZSxcbiAgICAgICAgZG9uZVdpdGhQYWdlPWZhbHNlO1xuXG4gICAgICB2YXIgcGFnZVNhdmVDYWxsYmFjayA9IGZ1bmN0aW9uKGVycikge1xuICAgICAgICBwYWdlQnVpbGRlciA9IFwiXCI7XG5cbiAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgIGNhbGxiYWNrKGVycik7XG4gICAgICAgIH1cblxuICAgICAgICAvLyB1cGRhdGUgbWV0YSBwcm9wZXJ0aWVzIHRoZW4gY29udGludWUgcHJvY2VzcyBieSBpbnZva2luZyBjYWxsYmFja1xuICAgICAgICBpZiAoZG9uZVdpdGhQYXJ0aXRpb24pIHtcbiAgICAgICAgICBjYWxsYmFjayhudWxsKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICBzZWxmLnBhZ2VJdGVyYXRvci5wYWdlSW5kZXgrKztcbiAgICAgICAgICBzZWxmLnNhdmVOZXh0UGFnZShjYWxsYmFjayk7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIGlmIChjb2xsLmRhdGEubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIGRvbmVXaXRoUGFydGl0aW9uID0gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgaWYgKCFkb25lV2l0aFBhcnRpdGlvbikge1xuICAgICAgICAgIC8vIHNlcmlhbGl6ZSBvYmplY3RcbiAgICAgICAgICBzZXJpYWxpemVkT2JqZWN0ID0gSlNPTi5zdHJpbmdpZnkoY29sbC5kYXRhW3RoaXMucGFnZUl0ZXJhdG9yLmRvY0luZGV4XSk7XG4gICAgICAgICAgcGFnZUJ1aWxkZXIgKz0gc2VyaWFsaXplZE9iamVjdDtcbiAgICAgICAgICBwYWdlTGVuICs9IHNlcmlhbGl6ZWRPYmplY3QubGVuZ3RoO1xuXG4gICAgICAgICAgLy8gaWYgbm8gbW9yZSBkb2N1bWVudHMgaW4gY29sbGVjdGlvbiB0byBhZGQsIHdlIGFyZSBkb25lIHdpdGggcGFydGl0aW9uXG4gICAgICAgICAgaWYgKCsrdGhpcy5wYWdlSXRlcmF0b3IuZG9jSW5kZXggPj0gY2RsZW4pIGRvbmVXaXRoUGFydGl0aW9uID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICAvLyBpZiBvdXIgY3VycmVudCBwYWdlIGlzIGJpZ2dlciB0aGFuIGRlZmluZWQgcGFnZVNpemUsIHdlIGFyZSBkb25lIHdpdGggcGFnZVxuICAgICAgICBpZiAocGFnZUxlbiA+PSB0aGlzLm9wdGlvbnMucGFnZVNpemUpIGRvbmVXaXRoUGFnZSA9IHRydWU7XG5cbiAgICAgICAgLy8gaWYgbm90IGRvbmUgd2l0aCBjdXJyZW50IHBhZ2UsIG5lZWQgZGVsaW1pdGVyIGJlZm9yZSBuZXh0IGl0ZW1cbiAgICAgICAgLy8gaWYgZG9uZSB3aXRoIHBhcnRpdGlvbiB3ZSBhbHNvIHdhbnQgYSBkZWxtaXRlciB0byBpbmRpY2F0ZSAnZW5kIG9mIHBhZ2VzJyBmaW5hbCBlbXB0eSByb3dcbiAgICAgICAgaWYgKCFkb25lV2l0aFBhZ2UgfHwgZG9uZVdpdGhQYXJ0aXRpb24pIHtcbiAgICAgICAgICBwYWdlQnVpbGRlciArPSB0aGlzLm9wdGlvbnMuZGVsaW1pdGVyO1xuICAgICAgICAgIHBhZ2VMZW4gKz0gZGVsaW1sZW47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBpZiB3ZSBhcmUgZG9uZSB3aXRoIHBhZ2Ugc2F2ZSBpdCBhbmQgcGFzcyBvZmYgdG8gbmV4dCByZWN1cnNpdmUgY2FsbCBvciBjYWxsYmFja1xuICAgICAgICBpZiAoZG9uZVdpdGhQYXJ0aXRpb24gfHwgZG9uZVdpdGhQYWdlKSB7XG4gICAgICAgICAgdGhpcy5hZGFwdGVyLnNhdmVEYXRhYmFzZShrZXluYW1lLCBwYWdlQnVpbGRlciwgcGFnZVNhdmVDYWxsYmFjayk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEEgbG9raSBwZXJzaXN0ZW5jZSBhZGFwdGVyIHdoaWNoIHBlcnNpc3RzIHVzaW5nIG5vZGUgZnMgbW9kdWxlXG4gICAgICogQGNvbnN0cnVjdG9yIExva2lGc0FkYXB0ZXJcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBMb2tpRnNBZGFwdGVyKCkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgdGhpcy5mcyA9IHJlcXVpcmUoJ2ZzJyk7XG4gICAgICB9Y2F0Y2goZSkge1xuICAgICAgICB0aGlzLmZzID0gbnVsbDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBsb2FkRGF0YWJhc2UoKSAtIExvYWQgZGF0YSBmcm9tIGZpbGUsIHdpbGwgdGhyb3cgYW4gZXJyb3IgaWYgdGhlIGZpbGUgZG9lcyBub3QgZXhpc3RcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZGJuYW1lIC0gdGhlIGZpbGVuYW1lIG9mIHRoZSBkYXRhYmFzZSB0byBsb2FkXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbn0gY2FsbGJhY2sgLSB0aGUgY2FsbGJhY2sgdG8gaGFuZGxlIHRoZSByZXN1bHRcbiAgICAgKiBAbWVtYmVyb2YgTG9raUZzQWRhcHRlclxuICAgICAqL1xuICAgIExva2lGc0FkYXB0ZXIucHJvdG90eXBlLmxvYWREYXRhYmFzZSA9IGZ1bmN0aW9uIGxvYWREYXRhYmFzZShkYm5hbWUsIGNhbGxiYWNrKSB7XG4gICAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICAgIHRoaXMuZnMuc3RhdChkYm5hbWUsIGZ1bmN0aW9uIChlcnIsIHN0YXRzKSB7XG4gICAgICAgIGlmICghZXJyICYmIHN0YXRzLmlzRmlsZSgpKSB7XG4gICAgICAgICAgc2VsZi5mcy5yZWFkRmlsZShkYm5hbWUsIHtcbiAgICAgICAgICAgIGVuY29kaW5nOiAndXRmOCdcbiAgICAgICAgICB9LCBmdW5jdGlvbiByZWFkRmlsZUNhbGxiYWNrKGVyciwgZGF0YSkge1xuICAgICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgICBjYWxsYmFjayhuZXcgRXJyb3IoZXJyKSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBjYWxsYmFjayhkYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICBjYWxsYmFjayhudWxsKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIHNhdmVEYXRhYmFzZSgpIC0gc2F2ZSBkYXRhIHRvIGZpbGUsIHdpbGwgdGhyb3cgYW4gZXJyb3IgaWYgdGhlIGZpbGUgY2FuJ3QgYmUgc2F2ZWRcbiAgICAgKiBtaWdodCB3YW50IHRvIGV4cGFuZCB0aGlzIHRvIGF2b2lkIGRhdGFsb3NzIG9uIHBhcnRpYWwgc2F2ZVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBkYm5hbWUgLSB0aGUgZmlsZW5hbWUgb2YgdGhlIGRhdGFiYXNlIHRvIGxvYWRcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBjYWxsYmFjayAtIHRoZSBjYWxsYmFjayB0byBoYW5kbGUgdGhlIHJlc3VsdFxuICAgICAqIEBtZW1iZXJvZiBMb2tpRnNBZGFwdGVyXG4gICAgICovXG4gICAgTG9raUZzQWRhcHRlci5wcm90b3R5cGUuc2F2ZURhdGFiYXNlID0gZnVuY3Rpb24gc2F2ZURhdGFiYXNlKGRibmFtZSwgZGJzdHJpbmcsIGNhbGxiYWNrKSB7XG4gICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICB2YXIgdG1wZGJuYW1lID0gZGJuYW1lICsgJ34nO1xuICAgICAgdGhpcy5mcy53cml0ZUZpbGUodG1wZGJuYW1lLCBkYnN0cmluZywgZnVuY3Rpb24gd3JpdGVGaWxlQ2FsbGJhY2soZXJyKSB7XG4gICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICBjYWxsYmFjayhuZXcgRXJyb3IoZXJyKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2VsZi5mcy5yZW5hbWUodG1wZGJuYW1lLGRibmFtZSxjYWxsYmFjayk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBkZWxldGVEYXRhYmFzZSgpIC0gZGVsZXRlIHRoZSBkYXRhYmFzZSBmaWxlLCB3aWxsIHRocm93IGFuIGVycm9yIGlmIHRoZVxuICAgICAqIGZpbGUgY2FuJ3QgYmUgZGVsZXRlZFxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBkYm5hbWUgLSB0aGUgZmlsZW5hbWUgb2YgdGhlIGRhdGFiYXNlIHRvIGRlbGV0ZVxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IGNhbGxiYWNrIC0gdGhlIGNhbGxiYWNrIHRvIGhhbmRsZSB0aGUgcmVzdWx0XG4gICAgICogQG1lbWJlcm9mIExva2lGc0FkYXB0ZXJcbiAgICAgKi9cbiAgICBMb2tpRnNBZGFwdGVyLnByb3RvdHlwZS5kZWxldGVEYXRhYmFzZSA9IGZ1bmN0aW9uIGRlbGV0ZURhdGFiYXNlKGRibmFtZSwgY2FsbGJhY2spIHtcbiAgICAgIHRoaXMuZnMudW5saW5rKGRibmFtZSwgZnVuY3Rpb24gZGVsZXRlRGF0YWJhc2VDYWxsYmFjayhlcnIpIHtcbiAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcihlcnIpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9O1xuXG5cbiAgICAvKipcbiAgICAgKiBBIGxva2kgcGVyc2lzdGVuY2UgYWRhcHRlciB3aGljaCBwZXJzaXN0cyB0byB3ZWIgYnJvd3NlcidzIGxvY2FsIHN0b3JhZ2Ugb2JqZWN0XG4gICAgICogQGNvbnN0cnVjdG9yIExva2lMb2NhbFN0b3JhZ2VBZGFwdGVyXG4gICAgICovXG4gICAgZnVuY3Rpb24gTG9raUxvY2FsU3RvcmFnZUFkYXB0ZXIoKSB7fVxuXG4gICAgLyoqXG4gICAgICogbG9hZERhdGFiYXNlKCkgLSBMb2FkIGRhdGEgZnJvbSBsb2NhbHN0b3JhZ2VcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZGJuYW1lIC0gdGhlIG5hbWUgb2YgdGhlIGRhdGFiYXNlIHRvIGxvYWRcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBjYWxsYmFjayAtIHRoZSBjYWxsYmFjayB0byBoYW5kbGUgdGhlIHJlc3VsdFxuICAgICAqIEBtZW1iZXJvZiBMb2tpTG9jYWxTdG9yYWdlQWRhcHRlclxuICAgICAqL1xuICAgIExva2lMb2NhbFN0b3JhZ2VBZGFwdGVyLnByb3RvdHlwZS5sb2FkRGF0YWJhc2UgPSBmdW5jdGlvbiBsb2FkRGF0YWJhc2UoZGJuYW1lLCBjYWxsYmFjaykge1xuICAgICAgaWYgKGxvY2FsU3RvcmFnZUF2YWlsYWJsZSgpKSB7XG4gICAgICAgIGNhbGxiYWNrKGxvY2FsU3RvcmFnZS5nZXRJdGVtKGRibmFtZSkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY2FsbGJhY2sobmV3IEVycm9yKCdsb2NhbFN0b3JhZ2UgaXMgbm90IGF2YWlsYWJsZScpKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogc2F2ZURhdGFiYXNlKCkgLSBzYXZlIGRhdGEgdG8gbG9jYWxzdG9yYWdlLCB3aWxsIHRocm93IGFuIGVycm9yIGlmIHRoZSBmaWxlIGNhbid0IGJlIHNhdmVkXG4gICAgICogbWlnaHQgd2FudCB0byBleHBhbmQgdGhpcyB0byBhdm9pZCBkYXRhbG9zcyBvbiBwYXJ0aWFsIHNhdmVcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZGJuYW1lIC0gdGhlIGZpbGVuYW1lIG9mIHRoZSBkYXRhYmFzZSB0byBsb2FkXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbn0gY2FsbGJhY2sgLSB0aGUgY2FsbGJhY2sgdG8gaGFuZGxlIHRoZSByZXN1bHRcbiAgICAgKiBAbWVtYmVyb2YgTG9raUxvY2FsU3RvcmFnZUFkYXB0ZXJcbiAgICAgKi9cbiAgICBMb2tpTG9jYWxTdG9yYWdlQWRhcHRlci5wcm90b3R5cGUuc2F2ZURhdGFiYXNlID0gZnVuY3Rpb24gc2F2ZURhdGFiYXNlKGRibmFtZSwgZGJzdHJpbmcsIGNhbGxiYWNrKSB7XG4gICAgICBpZiAobG9jYWxTdG9yYWdlQXZhaWxhYmxlKCkpIHtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oZGJuYW1lLCBkYnN0cmluZyk7XG4gICAgICAgIGNhbGxiYWNrKG51bGwpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY2FsbGJhY2sobmV3IEVycm9yKCdsb2NhbFN0b3JhZ2UgaXMgbm90IGF2YWlsYWJsZScpKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogZGVsZXRlRGF0YWJhc2UoKSAtIGRlbGV0ZSB0aGUgZGF0YWJhc2UgZnJvbSBsb2NhbHN0b3JhZ2UsIHdpbGwgdGhyb3cgYW4gZXJyb3IgaWYgaXRcbiAgICAgKiBjYW4ndCBiZSBkZWxldGVkXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGRibmFtZSAtIHRoZSBmaWxlbmFtZSBvZiB0aGUgZGF0YWJhc2UgdG8gZGVsZXRlXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbn0gY2FsbGJhY2sgLSB0aGUgY2FsbGJhY2sgdG8gaGFuZGxlIHRoZSByZXN1bHRcbiAgICAgKiBAbWVtYmVyb2YgTG9raUxvY2FsU3RvcmFnZUFkYXB0ZXJcbiAgICAgKi9cbiAgICBMb2tpTG9jYWxTdG9yYWdlQWRhcHRlci5wcm90b3R5cGUuZGVsZXRlRGF0YWJhc2UgPSBmdW5jdGlvbiBkZWxldGVEYXRhYmFzZShkYm5hbWUsIGNhbGxiYWNrKSB7XG4gICAgICBpZiAobG9jYWxTdG9yYWdlQXZhaWxhYmxlKCkpIHtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oZGJuYW1lKTtcbiAgICAgICAgY2FsbGJhY2sobnVsbCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjYWxsYmFjayhuZXcgRXJyb3IoJ2xvY2FsU3RvcmFnZSBpcyBub3QgYXZhaWxhYmxlJykpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBXYWl0IGZvciB0aHJvdHRsZWRTYXZlcyB0byBjb21wbGV0ZSBhbmQgaW52b2tlIHlvdXIgY2FsbGJhY2sgd2hlbiBkcmFpbmVkIG9yIGR1cmF0aW9uIGlzIG1ldC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IGNhbGxiYWNrIC0gY2FsbGJhY2sgdG8gZmlyZSB3aGVuIHNhdmUgcXVldWUgaXMgZHJhaW5lZCwgaXQgaXMgcGFzc2VkIGEgc3VjZXNzIHBhcmFtZXRlciB2YWx1ZVxuICAgICAqIEBwYXJhbSB7b2JqZWN0PX0gb3B0aW9ucyAtIGNvbmZpZ3VyYXRpb24gb3B0aW9uc1xuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gb3B0aW9ucy5yZWN1cnNpdmVXYWl0IC0gKGRlZmF1bHQ6IHRydWUpIGlmIGFmdGVyIHF1ZXVlIGlzIGRyYWluZWQsIGFub3RoZXIgc2F2ZSB3YXMga2lja2VkIG9mZiwgd2FpdCBmb3IgaXRcbiAgICAgKiBAcGFyYW0ge2Jvb2x9IG9wdGlvbnMucmVjdXJzaXZlV2FpdExpbWl0IC0gKGRlZmF1bHQ6IGZhbHNlKSBsaW1pdCBvdXIgcmVjdXJzaXZlIHdhaXRpbmcgdG8gYSBkdXJhdGlvblxuICAgICAqIEBwYXJhbSB7aW50fSBvcHRpb25zLnJlY3Vyc2l2ZVdhaXRMaW1pdERlbGF5IC0gKGRlZmF1bHQ6IDIwMDApIGN1dG9mZiBpbiBtcyB0byBzdG9wIHJlY3Vyc2l2ZWx5IHJlLWRyYWluaW5nXG4gICAgICogQG1lbWJlcm9mIExva2lcbiAgICAgKi9cbiAgICBMb2tpLnByb3RvdHlwZS50aHJvdHRsZWRTYXZlRHJhaW4gPSBmdW5jdGlvbihjYWxsYmFjaywgb3B0aW9ucykge1xuICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgdmFyIG5vdyA9IChuZXcgRGF0ZSgpKS5nZXRUaW1lKCk7XG5cbiAgICAgIGlmICghdGhpcy50aHJvdHRsZWRTYXZlcykge1xuICAgICAgICBjYWxsYmFjayh0cnVlKTtcbiAgICAgIH1cblxuICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gICAgICBpZiAoIW9wdGlvbnMuaGFzT3duUHJvcGVydHkoJ3JlY3Vyc2l2ZVdhaXQnKSkge1xuICAgICAgICBvcHRpb25zLnJlY3Vyc2l2ZVdhaXQgPSB0cnVlO1xuICAgICAgfVxuICAgICAgaWYgKCFvcHRpb25zLmhhc093blByb3BlcnR5KCdyZWN1cnNpdmVXYWl0TGltaXQnKSkge1xuICAgICAgICBvcHRpb25zLnJlY3Vyc2l2ZVdhaXRMaW1pdCA9IGZhbHNlO1xuICAgICAgfVxuICAgICAgaWYgKCFvcHRpb25zLmhhc093blByb3BlcnR5KCdyZWN1cnNpdmVXYWl0TGltaXREdXJhdGlvbicpKSB7XG4gICAgICAgIG9wdGlvbnMucmVjdXJzaXZlV2FpdExpbWl0RHVyYXRpb24gPSAyMDAwO1xuICAgICAgfVxuICAgICAgaWYgKCFvcHRpb25zLmhhc093blByb3BlcnR5KCdzdGFydGVkJykpIHtcbiAgICAgICAgb3B0aW9ucy5zdGFydGVkID0gKG5ldyBEYXRlKCkpLmdldFRpbWUoKTtcbiAgICAgIH1cblxuICAgICAgLy8gaWYgc2F2ZSBpcyBwZW5kaW5nXG4gICAgICBpZiAodGhpcy50aHJvdHRsZWRTYXZlcyAmJiB0aGlzLnRocm90dGxlZFNhdmVQZW5kaW5nKSB7XG4gICAgICAgIC8vIGlmIHdlIHdhbnQgdG8gd2FpdCB1bnRpbCB3ZSBhcmUgaW4gYSBzdGF0ZSB3aGVyZSB0aGVyZSBhcmUgbm8gcGVuZGluZyBzYXZlcyBhdCBhbGxcbiAgICAgICAgaWYgKG9wdGlvbnMucmVjdXJzaXZlV2FpdCkge1xuICAgICAgICAgIC8vIHF1ZXVlIHRoZSBmb2xsb3dpbmcgbWV0YSBjYWxsYmFjayBmb3Igd2hlbiBpdCBjb21wbGV0ZXNcbiAgICAgICAgICB0aGlzLnRocm90dGxlZENhbGxiYWNrcy5wdXNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgLy8gaWYgdGhlcmUgaXMgbm93IGFub3RoZXIgc2F2ZSBwZW5kaW5nLi4uXG4gICAgICAgICAgICBpZiAoc2VsZi50aHJvdHRsZWRTYXZlUGVuZGluZykge1xuICAgICAgICAgICAgICAvLyBpZiB3ZSB3aXNoIHRvIHdhaXQgb25seSBzbyBsb25nIGFuZCB3ZSBoYXZlIGV4Y2VlZGVkIGxpbWl0IG9mIG91ciB3YWl0aW5nLCBjYWxsYmFjayB3aXRoIGZhbHNlIHN1Y2Nlc3MgdmFsdWVcbiAgICAgICAgICAgICAgaWYgKG9wdGlvbnMucmVjdXJzaXZlV2FpdExpbWl0ICYmIChub3cgLSBvcHRpb25zLnN0YXJ0ZWQgPiBvcHRpb25zLnJlY3Vyc2l2ZVdhaXRMaW1pdER1cmF0aW9uKSkge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKGZhbHNlKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgLy8gaXQgbXVzdCBiZSBvayB0byB3YWl0IG9uIG5leHQgcXVldWUgZHJhaW5cbiAgICAgICAgICAgICAgc2VsZi50aHJvdHRsZWRTYXZlRHJhaW4oY2FsbGJhY2ssIG9wdGlvbnMpO1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBubyBwZW5kaW5nIHNhdmVzIHNvIGNhbGxiYWNrIHdpdGggdHJ1ZSBzdWNjZXNzXG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgY2FsbGJhY2sodHJ1ZSk7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvLyBqdXN0IG5vdGlmeSB3aGVuIGN1cnJlbnQgcXVldWUgaXMgZGVwbGV0ZWRcbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgdGhpcy50aHJvdHRsZWRDYWxsYmFja3MucHVzaChjYWxsYmFjayk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICAvLyBubyBzYXZlIHBlbmRpbmcsIGp1c3QgY2FsbGJhY2tcbiAgICAgIGVsc2Uge1xuICAgICAgICBjYWxsYmFjayh0cnVlKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogSW50ZXJuYWwgbG9hZCBsb2dpYywgZGVjb3VwbGVkIGZyb20gdGhyb3R0bGluZy9jb250ZW50aW9uIGxvZ2ljXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge29iamVjdH0gb3B0aW9ucyAtIG5vdCBjdXJyZW50bHkgdXNlZCAocmVtb3ZlIG9yIGFsbG93IG92ZXJyaWRlcz8pXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbj19IGNhbGxiYWNrIC0gKE9wdGlvbmFsKSB1c2VyIHN1cHBsaWVkIGFzeW5jIGNhbGxiYWNrIC8gZXJyb3IgaGFuZGxlclxuICAgICAqL1xuICAgIExva2kucHJvdG90eXBlLmxvYWREYXRhYmFzZUludGVybmFsID0gZnVuY3Rpb24gKG9wdGlvbnMsIGNhbGxiYWNrKSB7XG4gICAgICB2YXIgY0Z1biA9IGNhbGxiYWNrIHx8IGZ1bmN0aW9uIChlcnIsIGRhdGEpIHtcbiAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICB0aHJvdyBlcnI7XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBzZWxmID0gdGhpcztcblxuICAgICAgLy8gdGhlIHBlcnNpc3RlbmNlQWRhcHRlciBzaG91bGQgYmUgcHJlc2VudCBpZiBhbGwgaXMgb2ssIGJ1dCBjaGVjayB0byBiZSBzdXJlLlxuICAgICAgaWYgKHRoaXMucGVyc2lzdGVuY2VBZGFwdGVyICE9PSBudWxsKSB7XG5cbiAgICAgICAgdGhpcy5wZXJzaXN0ZW5jZUFkYXB0ZXIubG9hZERhdGFiYXNlKHRoaXMuZmlsZW5hbWUsIGZ1bmN0aW9uIGxvYWREYXRhYmFzZUNhbGxiYWNrKGRiU3RyaW5nKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiAoZGJTdHJpbmcpID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgdmFyIHBhcnNlU3VjY2VzcyA9IGZhbHNlO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgc2VsZi5sb2FkSlNPTihkYlN0cmluZywgb3B0aW9ucyB8fCB7fSk7XG4gICAgICAgICAgICAgIHBhcnNlU3VjY2VzcyA9IHRydWU7XG4gICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgY0Z1bihlcnIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHBhcnNlU3VjY2Vzcykge1xuICAgICAgICAgICAgICBjRnVuKG51bGwpO1xuICAgICAgICAgICAgICBzZWxmLmVtaXQoJ2xvYWRlZCcsICdkYXRhYmFzZSAnICsgc2VsZi5maWxlbmFtZSArICcgbG9hZGVkJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIGZhbHN5IHJlc3VsdCBtZWFucyBuZXcgZGF0YWJhc2VcbiAgICAgICAgICAgIGlmICghZGJTdHJpbmcpIHtcbiAgICAgICAgICAgICAgY0Z1bihudWxsKTtcbiAgICAgICAgICAgICAgc2VsZi5lbWl0KCdsb2FkZWQnLCAnZW1wdHkgZGF0YWJhc2UgJyArIHNlbGYuZmlsZW5hbWUgKyAnIGxvYWRlZCcpO1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGluc3RhbmNlb2YgZXJyb3IgbWVhbnMgbG9hZCBmYXVsdGVkXG4gICAgICAgICAgICBpZiAoZGJTdHJpbmcgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgICAgICAgICAgIGNGdW4oZGJTdHJpbmcpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gaWYgYWRhcHRlciBoYXMgcmV0dXJuZWQgYW4ganMgb2JqZWN0IChvdGhlciB0aGFuIG51bGwgb3IgZXJyb3IpIGF0dGVtcHQgdG8gbG9hZCBmcm9tIEpTT04gb2JqZWN0XG4gICAgICAgICAgICBpZiAodHlwZW9mIChkYlN0cmluZykgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICAgICAgc2VsZi5sb2FkSlNPTk9iamVjdChkYlN0cmluZywgb3B0aW9ucyB8fCB7fSk7XG4gICAgICAgICAgICAgIGNGdW4obnVsbCk7IC8vIHJldHVybiBudWxsIG9uIHN1Y2Nlc3NcbiAgICAgICAgICAgICAgc2VsZi5lbWl0KCdsb2FkZWQnLCAnZGF0YWJhc2UgJyArIHNlbGYuZmlsZW5hbWUgKyAnIGxvYWRlZCcpO1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNGdW4oXCJ1bmV4cGVjdGVkIGFkYXB0ZXIgcmVzcG9uc2UgOiBcIiArIGRiU3RyaW5nKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjRnVuKG5ldyBFcnJvcigncGVyc2lzdGVuY2VBZGFwdGVyIG5vdCBjb25maWd1cmVkJykpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBIYW5kbGVzIG1hbnVhbGx5IGxvYWRpbmcgZnJvbSBmaWxlIHN5c3RlbSwgbG9jYWwgc3RvcmFnZSwgb3IgYWRhcHRlciAoc3VjaCBhcyBpbmRleGVkZGIpXG4gICAgICogICAgVGhpcyBtZXRob2QgdXRpbGl6ZXMgbG9raSBjb25maWd1cmF0aW9uIG9wdGlvbnMgKGlmIHByb3ZpZGVkKSB0byBkZXRlcm1pbmUgd2hpY2hcbiAgICAgKiAgICBwZXJzaXN0ZW5jZSBtZXRob2QgdG8gdXNlLCBvciBlbnZpcm9ubWVudCBkZXRlY3Rpb24gKGlmIGNvbmZpZ3VyYXRpb24gd2FzIG5vdCBwcm92aWRlZCkuXG4gICAgICogICAgVG8gYXZvaWQgY29udGVudGlvbiB3aXRoIGFueSB0aHJvdHRsZWRTYXZlcywgd2Ugd2lsbCBkcmFpbiB0aGUgc2F2ZSBxdWV1ZSBmaXJzdC5cbiAgICAgKlxuICAgICAqIElmIHlvdSBhcmUgY29uZmlndXJlZCB3aXRoIGF1dG9zYXZlLCB5b3UgZG8gbm90IG5lZWQgdG8gY2FsbCB0aGlzIG1ldGhvZCB5b3Vyc2VsZi5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBvcHRpb25zIC0gaWYgdGhyb3R0bGluZyBzYXZlcyBhbmQgbG9hZHMsIHRoaXMgY29udHJvbHMgaG93IHdlIGRyYWluIHNhdmUgcXVldWUgYmVmb3JlIGxvYWRpbmdcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IG9wdGlvbnMucmVjdXJzaXZlV2FpdCAtIChkZWZhdWx0OiB0cnVlKSB3YWl0IHJlY3Vyc2l2ZWx5IHVudGlsIG5vIHNhdmVzIGFyZSBxdWV1ZWRcbiAgICAgKiBAcGFyYW0ge2Jvb2x9IG9wdGlvbnMucmVjdXJzaXZlV2FpdExpbWl0IC0gKGRlZmF1bHQ6IGZhbHNlKSBsaW1pdCBvdXIgcmVjdXJzaXZlIHdhaXRpbmcgdG8gYSBkdXJhdGlvblxuICAgICAqIEBwYXJhbSB7aW50fSBvcHRpb25zLnJlY3Vyc2l2ZVdhaXRMaW1pdERlbGF5IC0gKGRlZmF1bHQ6IDIwMDApIGN1dG9mZiBpbiBtcyB0byBzdG9wIHJlY3Vyc2l2ZWx5IHJlLWRyYWluaW5nXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbj19IGNhbGxiYWNrIC0gKE9wdGlvbmFsKSB1c2VyIHN1cHBsaWVkIGFzeW5jIGNhbGxiYWNrIC8gZXJyb3IgaGFuZGxlclxuICAgICAqIEBtZW1iZXJvZiBMb2tpXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBkYi5sb2FkRGF0YWJhc2Uoe30sIGZ1bmN0aW9uKGVycikge1xuICAgICAqICAgaWYgKGVycikge1xuICAgICAqICAgICBjb25zb2xlLmxvZyhcImVycm9yIDogXCIgKyBlcnIpO1xuICAgICAqICAgfVxuICAgICAqICAgZWxzZSB7XG4gICAgICogICAgIGNvbnNvbGUubG9nKFwiZGF0YWJhc2UgbG9hZGVkLlwiKTtcbiAgICAgKiAgIH1cbiAgICAgKiB9KTtcbiAgICAgKi9cbiAgICBMb2tpLnByb3RvdHlwZS5sb2FkRGF0YWJhc2UgPSBmdW5jdGlvbiAob3B0aW9ucywgY2FsbGJhY2spIHtcbiAgICAgIHZhciBzZWxmPXRoaXM7XG5cbiAgICAgIC8vIGlmIHRocm90dGxpbmcgZGlzYWJsZWQsIGp1c3QgY2FsbCBpbnRlcm5hbFxuICAgICAgaWYgKCF0aGlzLnRocm90dGxlZFNhdmVzKSB7XG4gICAgICAgIHRoaXMubG9hZERhdGFiYXNlSW50ZXJuYWwob3B0aW9ucywgY2FsbGJhY2spO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIHRyeSB0byBkcmFpbiBhbnkgcGVuZGluZyBzYXZlcyBpbiB0aGUgcXVldWUgdG8gbG9jayBpdCBmb3IgbG9hZGluZ1xuICAgICAgdGhpcy50aHJvdHRsZWRTYXZlRHJhaW4oZnVuY3Rpb24oc3VjY2Vzcykge1xuICAgICAgICBpZiAoc3VjY2Vzcykge1xuICAgICAgICAgIC8vIHBhdXNlL3Rocm90dGxlIHNhdmluZyB1bnRpbCBsb2FkaW5nIGlzIGRvbmVcbiAgICAgICAgICBzZWxmLnRocm90dGxlZFNhdmVQZW5kaW5nID0gdHJ1ZTtcblxuICAgICAgICAgIHNlbGYubG9hZERhdGFiYXNlSW50ZXJuYWwob3B0aW9ucywgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAvLyBub3cgdGhhdCB3ZSBhcmUgZmluaXNoZWQgbG9hZGluZywgaWYgbm8gc2F2ZXMgd2VyZSB0aHJvdHRsZWQsIGRpc2FibGUgZmxhZ1xuICAgICAgICAgICAgaWYgKHNlbGYudGhyb3R0bGVkQ2FsbGJhY2tzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICBzZWxmLnRocm90dGxlZFNhdmVQZW5kaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBpZiBzYXZlcyByZXF1ZXN0cyBjYW1lIGluIHdoaWxlIGxvYWRpbmcsIGtpY2sgb2ZmIG5ldyBzYXZlIHRvIGtpY2sgb2ZmIHJlc3VtZSBzYXZlc1xuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgIHNlbGYuc2F2ZURhdGFiYXNlKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgY2FsbGJhY2soZXJyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiBjYWxsYmFjayA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgY2FsbGJhY2sobmV3IEVycm9yKFwiVW5hYmxlIHRvIHBhdXNlIHNhdmUgdGhyb3R0bGluZyBsb25nIGVub3VnaCB0byByZWFkIGRhdGFiYXNlXCIpKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sIG9wdGlvbnMpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBJbnRlcm5hbCBzYXZlIGxvZ2ljLCBkZWNvdXBsZWQgZnJvbSBzYXZlIHRocm90dGxpbmcgbG9naWNcbiAgICAgKi9cbiAgICBMb2tpLnByb3RvdHlwZS5zYXZlRGF0YWJhc2VJbnRlcm5hbCA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgdmFyIGNGdW4gPSBjYWxsYmFjayB8fCBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0sXG4gICAgICAgIHNlbGYgPSB0aGlzO1xuXG4gICAgICAvLyB0aGUgcGVyc2lzdGVuY2VBZGFwdGVyIHNob3VsZCBiZSBwcmVzZW50IGlmIGFsbCBpcyBvaywgYnV0IGNoZWNrIHRvIGJlIHN1cmUuXG4gICAgICBpZiAodGhpcy5wZXJzaXN0ZW5jZUFkYXB0ZXIgIT09IG51bGwpIHtcbiAgICAgICAgLy8gY2hlY2sgaWYgdGhlIGFkYXB0ZXIgaXMgcmVxdWVzdGluZyAoYW5kIHN1cHBvcnRzKSBhICdyZWZlcmVuY2UnIG1vZGUgZXhwb3J0XG4gICAgICAgIGlmICh0aGlzLnBlcnNpc3RlbmNlQWRhcHRlci5tb2RlID09PSBcInJlZmVyZW5jZVwiICYmIHR5cGVvZiB0aGlzLnBlcnNpc3RlbmNlQWRhcHRlci5leHBvcnREYXRhYmFzZSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgLy8gZmlsZW5hbWUgbWF5IHNlZW0gcmVkdW5kYW50IGJ1dCBsb2FkRGF0YWJhc2Ugd2lsbCBuZWVkIHRvIGV4cGVjdCB0aGlzIHNhbWUgZmlsZW5hbWVcbiAgICAgICAgICB0aGlzLnBlcnNpc3RlbmNlQWRhcHRlci5leHBvcnREYXRhYmFzZSh0aGlzLmZpbGVuYW1lLCB0aGlzLmNvcHkoe3JlbW92ZU5vblNlcmlhbGl6YWJsZTp0cnVlfSksIGZ1bmN0aW9uIGV4cG9ydERhdGFiYXNlQ2FsbGJhY2soZXJyKSB7XG4gICAgICAgICAgICBzZWxmLmF1dG9zYXZlQ2xlYXJGbGFncygpO1xuICAgICAgICAgICAgY0Z1bihlcnIpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIC8vIG90aGVyd2lzZSBqdXN0IHBhc3MgdGhlIHNlcmlhbGl6ZWQgZGF0YWJhc2UgdG8gYWRhcHRlclxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAvLyBwZXJzaXN0ZW5jZUFkYXB0ZXIgbWlnaHQgYmUgYXN5bmNocm9ub3VzLCBzbyB3ZSBtdXN0IGNsZWFyIGBkaXJ0eWAgaW1tZWRpYXRlbHlcbiAgICAgICAgICAvLyBvciBhdXRvc2F2ZSB3b24ndCB3b3JrIGlmIGFuIHVwZGF0ZSBvY2N1cnMgYmV0d2VlbiBoZXJlIGFuZCB0aGUgY2FsbGJhY2tcbiAgICAgICAgICBzZWxmLmF1dG9zYXZlQ2xlYXJGbGFncygpO1xuICAgICAgICAgIHRoaXMucGVyc2lzdGVuY2VBZGFwdGVyLnNhdmVEYXRhYmFzZSh0aGlzLmZpbGVuYW1lLCBzZWxmLnNlcmlhbGl6ZSgpLCBmdW5jdGlvbiBzYXZlRGF0YWJhc2VjYWxsYmFjayhlcnIpIHtcbiAgICAgICAgICAgIGNGdW4oZXJyKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY0Z1bihuZXcgRXJyb3IoJ3BlcnNpc3RlbmNlQWRhcHRlciBub3QgY29uZmlndXJlZCcpKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogSGFuZGxlcyBtYW51YWxseSBzYXZpbmcgdG8gZmlsZSBzeXN0ZW0sIGxvY2FsIHN0b3JhZ2UsIG9yIGFkYXB0ZXIgKHN1Y2ggYXMgaW5kZXhlZGRiKVxuICAgICAqICAgIFRoaXMgbWV0aG9kIHV0aWxpemVzIGxva2kgY29uZmlndXJhdGlvbiBvcHRpb25zIChpZiBwcm92aWRlZCkgdG8gZGV0ZXJtaW5lIHdoaWNoXG4gICAgICogICAgcGVyc2lzdGVuY2UgbWV0aG9kIHRvIHVzZSwgb3IgZW52aXJvbm1lbnQgZGV0ZWN0aW9uIChpZiBjb25maWd1cmF0aW9uIHdhcyBub3QgcHJvdmlkZWQpLlxuICAgICAqXG4gICAgICogSWYgeW91IGFyZSBjb25maWd1cmVkIHdpdGggYXV0b3NhdmUsIHlvdSBkbyBub3QgbmVlZCB0byBjYWxsIHRoaXMgbWV0aG9kIHlvdXJzZWxmLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbj19IGNhbGxiYWNrIC0gKE9wdGlvbmFsKSB1c2VyIHN1cHBsaWVkIGFzeW5jIGNhbGxiYWNrIC8gZXJyb3IgaGFuZGxlclxuICAgICAqIEBtZW1iZXJvZiBMb2tpXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBkYi5zYXZlRGF0YWJhc2UoZnVuY3Rpb24oZXJyKSB7XG4gICAgICogICBpZiAoZXJyKSB7XG4gICAgICogICAgIGNvbnNvbGUubG9nKFwiZXJyb3IgOiBcIiArIGVycik7XG4gICAgICogICB9XG4gICAgICogICBlbHNlIHtcbiAgICAgKiAgICAgY29uc29sZS5sb2coXCJkYXRhYmFzZSBzYXZlZC5cIik7XG4gICAgICogICB9XG4gICAgICogfSk7XG4gICAgICovXG4gICAgTG9raS5wcm90b3R5cGUuc2F2ZURhdGFiYXNlID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICBpZiAoIXRoaXMudGhyb3R0bGVkU2F2ZXMpIHtcbiAgICAgICAgdGhpcy5zYXZlRGF0YWJhc2VJbnRlcm5hbChjYWxsYmFjayk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMudGhyb3R0bGVkU2F2ZVBlbmRpbmcpIHtcbiAgICAgICAgdGhpcy50aHJvdHRsZWRDYWxsYmFja3MucHVzaChjYWxsYmFjayk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdmFyIGxvY2FsQ2FsbGJhY2tzID0gdGhpcy50aHJvdHRsZWRDYWxsYmFja3M7XG4gICAgICB0aGlzLnRocm90dGxlZENhbGxiYWNrcyA9IFtdO1xuICAgICAgbG9jYWxDYWxsYmFja3MudW5zaGlmdChjYWxsYmFjayk7XG4gICAgICB0aGlzLnRocm90dGxlZFNhdmVQZW5kaW5nID0gdHJ1ZTtcblxuICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgdGhpcy5zYXZlRGF0YWJhc2VJbnRlcm5hbChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgc2VsZi50aHJvdHRsZWRTYXZlUGVuZGluZyA9IGZhbHNlO1xuICAgICAgICBsb2NhbENhbGxiYWNrcy5mb3JFYWNoKGZ1bmN0aW9uKHBjYikge1xuICAgICAgICAgIGlmICh0eXBlb2YgcGNiID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAvLyBRdWV1ZSB0aGUgY2FsbGJhY2tzIHNvIHdlIGZpcnN0IGZpbmlzaCB0aGlzIG1ldGhvZCBleGVjdXRpb25cbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIHBjYihlcnIpO1xuICAgICAgICAgICAgfSwgMSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBzaW5jZSB0aGlzIGlzIGNhbGxlZCBhc3luYywgZnV0dXJlIHJlcXVlc3RzIG1heSBoYXZlIGNvbWUgaW4sIGlmIHNvLi4ga2ljayBvZmYgbmV4dCBzYXZlXG4gICAgICAgIGlmIChzZWxmLnRocm90dGxlZENhbGxiYWNrcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgc2VsZi5zYXZlRGF0YWJhc2UoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfTtcblxuICAgIC8vIGFsaWFzXG4gICAgTG9raS5wcm90b3R5cGUuc2F2ZSA9IExva2kucHJvdG90eXBlLnNhdmVEYXRhYmFzZTtcblxuICAgIC8qKlxuICAgICAqIEhhbmRsZXMgZGVsZXRpbmcgYSBkYXRhYmFzZSBmcm9tIGZpbGUgc3lzdGVtLCBsb2NhbFxuICAgICAqICAgIHN0b3JhZ2UsIG9yIGFkYXB0ZXIgKGluZGV4ZWRkYilcbiAgICAgKiAgICBUaGlzIG1ldGhvZCB1dGlsaXplcyBsb2tpIGNvbmZpZ3VyYXRpb24gb3B0aW9ucyAoaWYgcHJvdmlkZWQpIHRvIGRldGVybWluZSB3aGljaFxuICAgICAqICAgIHBlcnNpc3RlbmNlIG1ldGhvZCB0byB1c2UsIG9yIGVudmlyb25tZW50IGRldGVjdGlvbiAoaWYgY29uZmlndXJhdGlvbiB3YXMgbm90IHByb3ZpZGVkKS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb249fSBjYWxsYmFjayAtIChPcHRpb25hbCkgdXNlciBzdXBwbGllZCBhc3luYyBjYWxsYmFjayAvIGVycm9yIGhhbmRsZXJcbiAgICAgKiBAbWVtYmVyb2YgTG9raVxuICAgICAqL1xuICAgIExva2kucHJvdG90eXBlLmRlbGV0ZURhdGFiYXNlID0gZnVuY3Rpb24gKG9wdGlvbnMsIGNhbGxiYWNrKSB7XG4gICAgICB2YXIgY0Z1biA9IGNhbGxiYWNrIHx8IGZ1bmN0aW9uIChlcnIsIGRhdGEpIHtcbiAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgIHRocm93IGVycjtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgLy8gd2UgYXJlbid0IGV2ZW4gdXNpbmcgb3B0aW9ucywgc28gd2Ugd2lsbCBzdXBwb3J0IHN5bnRheCB3aGVyZVxuICAgICAgLy8gY2FsbGJhY2sgaXMgcGFzc2VkIGFzIGZpcnN0IGFuZCBvbmx5IGFyZ3VtZW50XG4gICAgICBpZiAodHlwZW9mIG9wdGlvbnMgPT09ICdmdW5jdGlvbicgJiYgIWNhbGxiYWNrKSB7XG4gICAgICAgIGNGdW4gPSBvcHRpb25zO1xuICAgICAgfVxuXG4gICAgICAvLyB0aGUgcGVyc2lzdGVuY2VBZGFwdGVyIHNob3VsZCBiZSBwcmVzZW50IGlmIGFsbCBpcyBvaywgYnV0IGNoZWNrIHRvIGJlIHN1cmUuXG4gICAgICBpZiAodGhpcy5wZXJzaXN0ZW5jZUFkYXB0ZXIgIT09IG51bGwpIHtcbiAgICAgICAgdGhpcy5wZXJzaXN0ZW5jZUFkYXB0ZXIuZGVsZXRlRGF0YWJhc2UodGhpcy5maWxlbmFtZSwgZnVuY3Rpb24gZGVsZXRlRGF0YWJhc2VDYWxsYmFjayhlcnIpIHtcbiAgICAgICAgICBjRnVuKGVycik7XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY0Z1bihuZXcgRXJyb3IoJ3BlcnNpc3RlbmNlQWRhcHRlciBub3QgY29uZmlndXJlZCcpKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogYXV0b3NhdmVEaXJ0eSAtIGNoZWNrIHdoZXRoZXIgYW55IGNvbGxlY3Rpb25zIGFyZSAnZGlydHknIG1lYW5pbmcgd2UgbmVlZCB0byBzYXZlIChlbnRpcmUpIGRhdGFiYXNlXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gLSB0cnVlIGlmIGRhdGFiYXNlIGhhcyBjaGFuZ2VkIHNpbmNlIGxhc3QgYXV0b3NhdmUsIGZhbHNlIGlmIG5vdC5cbiAgICAgKi9cbiAgICBMb2tpLnByb3RvdHlwZS5hdXRvc2F2ZURpcnR5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgZm9yICh2YXIgaWR4ID0gMDsgaWR4IDwgdGhpcy5jb2xsZWN0aW9ucy5sZW5ndGg7IGlkeCsrKSB7XG4gICAgICAgIGlmICh0aGlzLmNvbGxlY3Rpb25zW2lkeF0uZGlydHkpIHtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIGF1dG9zYXZlQ2xlYXJGbGFncyAtIHJlc2V0cyBkaXJ0eSBmbGFncyBvbiBhbGwgY29sbGVjdGlvbnMuXG4gICAgICogICAgQ2FsbGVkIGZyb20gc2F2ZURhdGFiYXNlKCkgYWZ0ZXIgZGIgaXMgc2F2ZWQuXG4gICAgICpcbiAgICAgKi9cbiAgICBMb2tpLnByb3RvdHlwZS5hdXRvc2F2ZUNsZWFyRmxhZ3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBmb3IgKHZhciBpZHggPSAwOyBpZHggPCB0aGlzLmNvbGxlY3Rpb25zLmxlbmd0aDsgaWR4KyspIHtcbiAgICAgICAgdGhpcy5jb2xsZWN0aW9uc1tpZHhdLmRpcnR5ID0gZmFsc2U7XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIGF1dG9zYXZlRW5hYmxlIC0gYmVnaW4gYSBqYXZhc2NyaXB0IGludGVydmFsIHRvIHBlcmlvZGljYWxseSBzYXZlIHRoZSBkYXRhYmFzZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBvcHRpb25zIC0gbm90IGN1cnJlbnRseSB1c2VkIChyZW1vdmUgb3IgYWxsb3cgb3ZlcnJpZGVzPylcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uPX0gY2FsbGJhY2sgLSAoT3B0aW9uYWwpIHVzZXIgc3VwcGxpZWQgYXN5bmMgY2FsbGJhY2tcbiAgICAgKi9cbiAgICBMb2tpLnByb3RvdHlwZS5hdXRvc2F2ZUVuYWJsZSA9IGZ1bmN0aW9uIChvcHRpb25zLCBjYWxsYmFjaykge1xuICAgICAgdGhpcy5hdXRvc2F2ZSA9IHRydWU7XG5cbiAgICAgIHZhciBkZWxheSA9IDUwMDAsXG4gICAgICAgIHNlbGYgPSB0aGlzO1xuXG4gICAgICBpZiAodHlwZW9mICh0aGlzLmF1dG9zYXZlSW50ZXJ2YWwpICE9PSAndW5kZWZpbmVkJyAmJiB0aGlzLmF1dG9zYXZlSW50ZXJ2YWwgIT09IG51bGwpIHtcbiAgICAgICAgZGVsYXkgPSB0aGlzLmF1dG9zYXZlSW50ZXJ2YWw7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuYXV0b3NhdmVIYW5kbGUgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiBhdXRvc2F2ZUhhbmRsZUludGVydmFsKCkge1xuICAgICAgICAvLyB1c2Ugb2YgZGlydHkgZmxhZyB3aWxsIG5lZWQgdG8gYmUgaGllcmFyY2hpY2FsIHNpbmNlIG1vZHMgYXJlIGRvbmUgYXQgY29sbGVjdGlvbiBsZXZlbCB3aXRoIG5vIHZpc2liaWxpdHkgb2YgJ2RiJ1xuICAgICAgICAvLyBzbyBuZXh0IHN0ZXAgd2lsbCBiZSB0byBpbXBsZW1lbnQgY29sbGVjdGlvbiBsZXZlbCBkaXJ0eSBmbGFncyBzZXQgb24gaW5zZXJ0L3VwZGF0ZS9yZW1vdmVcbiAgICAgICAgLy8gYWxvbmcgd2l0aCBsb2tpIGxldmVsIGlzZGlydHkoKSBmdW5jdGlvbiB3aGljaCBpdGVyYXRlcyBhbGwgY29sbGVjdGlvbnMgdG8gc2VlIGlmIGFueSBhcmUgZGlydHlcblxuICAgICAgICBpZiAoc2VsZi5hdXRvc2F2ZURpcnR5KCkpIHtcbiAgICAgICAgICBzZWxmLnNhdmVEYXRhYmFzZShjYWxsYmFjayk7XG4gICAgICAgIH1cbiAgICAgIH0sIGRlbGF5KTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogYXV0b3NhdmVEaXNhYmxlIC0gc3RvcCB0aGUgYXV0b3NhdmUgaW50ZXJ2YWwgdGltZXIuXG4gICAgICpcbiAgICAgKi9cbiAgICBMb2tpLnByb3RvdHlwZS5hdXRvc2F2ZURpc2FibGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAodHlwZW9mICh0aGlzLmF1dG9zYXZlSGFuZGxlKSAhPT0gJ3VuZGVmaW5lZCcgJiYgdGhpcy5hdXRvc2F2ZUhhbmRsZSAhPT0gbnVsbCkge1xuICAgICAgICBjbGVhckludGVydmFsKHRoaXMuYXV0b3NhdmVIYW5kbGUpO1xuICAgICAgICB0aGlzLmF1dG9zYXZlSGFuZGxlID0gbnVsbDtcbiAgICAgIH1cbiAgICB9O1xuXG5cbiAgICAvKipcbiAgICAgKiBSZXN1bHRzZXQgY2xhc3MgYWxsb3dpbmcgY2hhaW5hYmxlIHF1ZXJpZXMuICBJbnRlbmRlZCB0byBiZSBpbnN0YW5jZWQgaW50ZXJuYWxseS5cbiAgICAgKiAgICBDb2xsZWN0aW9uLmZpbmQoKSwgQ29sbGVjdGlvbi53aGVyZSgpLCBhbmQgQ29sbGVjdGlvbi5jaGFpbigpIGluc3RhbnRpYXRlIHRoaXMuXG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqICAgIG15Y29sbGVjdGlvbi5jaGFpbigpXG4gICAgICogICAgICAuZmluZCh7ICdkb29ycycgOiA0IH0pXG4gICAgICogICAgICAud2hlcmUoZnVuY3Rpb24ob2JqKSB7IHJldHVybiBvYmoubmFtZSA9PT0gJ1RveW90YScgfSlcbiAgICAgKiAgICAgIC5kYXRhKCk7XG4gICAgICpcbiAgICAgKiBAY29uc3RydWN0b3IgUmVzdWx0c2V0XG4gICAgICogQHBhcmFtIHtDb2xsZWN0aW9ufSBjb2xsZWN0aW9uIC0gVGhlIGNvbGxlY3Rpb24gd2hpY2ggdGhpcyBSZXN1bHRzZXQgd2lsbCBxdWVyeSBhZ2FpbnN0LlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIFJlc3VsdHNldChjb2xsZWN0aW9uLCBvcHRpb25zKSB7XG4gICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblxuICAgICAgLy8gcmV0YWluIHJlZmVyZW5jZSB0byBjb2xsZWN0aW9uIHdlIGFyZSBxdWVyeWluZyBhZ2FpbnN0XG4gICAgICB0aGlzLmNvbGxlY3Rpb24gPSBjb2xsZWN0aW9uO1xuICAgICAgdGhpcy5maWx0ZXJlZHJvd3MgPSBbXTtcbiAgICAgIHRoaXMuZmlsdGVySW5pdGlhbGl6ZWQgPSBmYWxzZTtcblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogcmVzZXQoKSAtIFJlc2V0IHRoZSByZXN1bHRzZXQgdG8gaXRzIGluaXRpYWwgc3RhdGUuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7UmVzdWx0c2V0fSBSZWZlcmVuY2UgdG8gdGhpcyByZXN1bHRzZXQsIGZvciBmdXR1cmUgY2hhaW4gb3BlcmF0aW9ucy5cbiAgICAgKi9cbiAgICBSZXN1bHRzZXQucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKHRoaXMuZmlsdGVyZWRyb3dzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgdGhpcy5maWx0ZXJlZHJvd3MgPSBbXTtcbiAgICAgIH1cbiAgICAgIHRoaXMuZmlsdGVySW5pdGlhbGl6ZWQgPSBmYWxzZTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiB0b0pTT04oKSAtIE92ZXJyaWRlIG9mIHRvSlNPTiB0byBhdm9pZCBjaXJjdWxhciByZWZlcmVuY2VzXG4gICAgICpcbiAgICAgKi9cbiAgICBSZXN1bHRzZXQucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBjb3B5ID0gdGhpcy5jb3B5KCk7XG4gICAgICBjb3B5LmNvbGxlY3Rpb24gPSBudWxsO1xuICAgICAgcmV0dXJuIGNvcHk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEFsbG93cyB5b3UgdG8gbGltaXQgdGhlIG51bWJlciBvZiBkb2N1bWVudHMgcGFzc2VkIHRvIG5leHQgY2hhaW4gb3BlcmF0aW9uLlxuICAgICAqICAgIEEgcmVzdWx0c2V0IGNvcHkoKSBpcyBtYWRlIHRvIGF2b2lkIGFsdGVyaW5nIG9yaWdpbmFsIHJlc3VsdHNldC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7aW50fSBxdHkgLSBUaGUgbnVtYmVyIG9mIGRvY3VtZW50cyB0byByZXR1cm4uXG4gICAgICogQHJldHVybnMge1Jlc3VsdHNldH0gUmV0dXJucyBhIGNvcHkgb2YgdGhlIHJlc3VsdHNldCwgbGltaXRlZCBieSBxdHksIGZvciBzdWJzZXF1ZW50IGNoYWluIG9wcy5cbiAgICAgKiBAbWVtYmVyb2YgUmVzdWx0c2V0XG4gICAgICogLy8gZmluZCB0aGUgdHdvIG9sZGVzdCB1c2Vyc1xuICAgICAqIHZhciByZXN1bHQgPSB1c2Vycy5jaGFpbigpLnNpbXBsZXNvcnQoXCJhZ2VcIiwgdHJ1ZSkubGltaXQoMikuZGF0YSgpO1xuICAgICAqL1xuICAgIFJlc3VsdHNldC5wcm90b3R5cGUubGltaXQgPSBmdW5jdGlvbiAocXR5KSB7XG4gICAgICAvLyBpZiB0aGlzIGhhcyBubyBmaWx0ZXJzIGFwcGxpZWQsIHdlIG5lZWQgdG8gcG9wdWxhdGUgZmlsdGVyZWRyb3dzIGZpcnN0XG4gICAgICBpZiAoIXRoaXMuZmlsdGVySW5pdGlhbGl6ZWQgJiYgdGhpcy5maWx0ZXJlZHJvd3MubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHRoaXMuZmlsdGVyZWRyb3dzID0gdGhpcy5jb2xsZWN0aW9uLnByZXBhcmVGdWxsRG9jSW5kZXgoKTtcbiAgICAgIH1cblxuICAgICAgdmFyIHJzY29weSA9IG5ldyBSZXN1bHRzZXQodGhpcy5jb2xsZWN0aW9uKTtcbiAgICAgIHJzY29weS5maWx0ZXJlZHJvd3MgPSB0aGlzLmZpbHRlcmVkcm93cy5zbGljZSgwLCBxdHkpO1xuICAgICAgcnNjb3B5LmZpbHRlckluaXRpYWxpemVkID0gdHJ1ZTtcbiAgICAgIHJldHVybiByc2NvcHk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFVzZWQgZm9yIHNraXBwaW5nICdwb3MnIG51bWJlciBvZiBkb2N1bWVudHMgaW4gdGhlIHJlc3VsdHNldC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7aW50fSBwb3MgLSBOdW1iZXIgb2YgZG9jdW1lbnRzIHRvIHNraXA7IGFsbCBwcmVjZWRpbmcgZG9jdW1lbnRzIGFyZSBmaWx0ZXJlZCBvdXQuXG4gICAgICogQHJldHVybnMge1Jlc3VsdHNldH0gUmV0dXJucyBhIGNvcHkgb2YgdGhlIHJlc3VsdHNldCwgY29udGFpbmluZyBkb2NzIHN0YXJ0aW5nIGF0ICdwb3MnIGZvciBzdWJzZXF1ZW50IGNoYWluIG9wcy5cbiAgICAgKiBAbWVtYmVyb2YgUmVzdWx0c2V0XG4gICAgICogLy8gZmluZCBldmVyeW9uZSBidXQgdGhlIHR3byBvbGRlc3QgdXNlcnNcbiAgICAgKiB2YXIgcmVzdWx0ID0gdXNlcnMuY2hhaW4oKS5zaW1wbGVzb3J0KFwiYWdlXCIsIHRydWUpLm9mZnNldCgyKS5kYXRhKCk7XG4gICAgICovXG4gICAgUmVzdWx0c2V0LnByb3RvdHlwZS5vZmZzZXQgPSBmdW5jdGlvbiAocG9zKSB7XG4gICAgICAvLyBpZiB0aGlzIGhhcyBubyBmaWx0ZXJzIGFwcGxpZWQsIHdlIG5lZWQgdG8gcG9wdWxhdGUgZmlsdGVyZWRyb3dzIGZpcnN0XG4gICAgICBpZiAoIXRoaXMuZmlsdGVySW5pdGlhbGl6ZWQgJiYgdGhpcy5maWx0ZXJlZHJvd3MubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHRoaXMuZmlsdGVyZWRyb3dzID0gdGhpcy5jb2xsZWN0aW9uLnByZXBhcmVGdWxsRG9jSW5kZXgoKTtcbiAgICAgIH1cblxuICAgICAgdmFyIHJzY29weSA9IG5ldyBSZXN1bHRzZXQodGhpcy5jb2xsZWN0aW9uKTtcbiAgICAgIHJzY29weS5maWx0ZXJlZHJvd3MgPSB0aGlzLmZpbHRlcmVkcm93cy5zbGljZShwb3MpO1xuICAgICAgcnNjb3B5LmZpbHRlckluaXRpYWxpemVkID0gdHJ1ZTtcbiAgICAgIHJldHVybiByc2NvcHk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIGNvcHkoKSAtIFRvIHN1cHBvcnQgcmV1c2Ugb2YgcmVzdWx0c2V0IGluIGJyYW5jaGVkIHF1ZXJ5IHNpdHVhdGlvbnMuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7UmVzdWx0c2V0fSBSZXR1cm5zIGEgY29weSBvZiB0aGUgcmVzdWx0c2V0IChzZXQpIGJ1dCB0aGUgdW5kZXJseWluZyBkb2N1bWVudCByZWZlcmVuY2VzIHdpbGwgYmUgdGhlIHNhbWUuXG4gICAgICogQG1lbWJlcm9mIFJlc3VsdHNldFxuICAgICAqL1xuICAgIFJlc3VsdHNldC5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciByZXN1bHQgPSBuZXcgUmVzdWx0c2V0KHRoaXMuY29sbGVjdGlvbik7XG5cbiAgICAgIGlmICh0aGlzLmZpbHRlcmVkcm93cy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJlc3VsdC5maWx0ZXJlZHJvd3MgPSB0aGlzLmZpbHRlcmVkcm93cy5zbGljZSgpO1xuICAgICAgfVxuICAgICAgcmVzdWx0LmZpbHRlckluaXRpYWxpemVkID0gdGhpcy5maWx0ZXJJbml0aWFsaXplZDtcblxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQWxpYXMgb2YgY29weSgpXG4gICAgICogQG1lbWJlcm9mIFJlc3VsdHNldFxuICAgICAqL1xuICAgIFJlc3VsdHNldC5wcm90b3R5cGUuYnJhbmNoID0gUmVzdWx0c2V0LnByb3RvdHlwZS5jb3B5O1xuXG4gICAgLyoqXG4gICAgICogdHJhbnNmb3JtKCkgLSBleGVjdXRlcyBhIG5hbWVkIGNvbGxlY3Rpb24gdHJhbnNmb3JtIG9yIHJhdyBhcnJheSBvZiB0cmFuc2Zvcm0gc3RlcHMgYWdhaW5zdCB0aGUgcmVzdWx0c2V0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHRyYW5zZm9ybSB7KHN0cmluZ3xhcnJheSl9IC0gbmFtZSBvZiBjb2xsZWN0aW9uIHRyYW5zZm9ybSBvciByYXcgdHJhbnNmb3JtIGFycmF5XG4gICAgICogQHBhcmFtIHBhcmFtZXRlcnMge29iamVjdD19IC0gKE9wdGlvbmFsKSBvYmplY3QgcHJvcGVydHkgaGFzaCBvZiBwYXJhbWV0ZXJzLCBpZiB0aGUgdHJhbnNmb3JtIHJlcXVpcmVzIHRoZW0uXG4gICAgICogQHJldHVybnMge1Jlc3VsdHNldH0gZWl0aGVyICh0aGlzKSByZXN1bHRzZXQgb3IgYSBjbG9uZSBvZiBvZiB0aGlzIHJlc3VsdHNldCAoZGVwZW5kaW5nIG9uIHN0ZXBzKVxuICAgICAqIEBtZW1iZXJvZiBSZXN1bHRzZXRcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIHVzZXJzLmFkZFRyYW5zZm9ybSgnQ291bnRyeUZpbHRlcicsIFtcbiAgICAgKiAgIHtcbiAgICAgKiAgICAgdHlwZTogJ2ZpbmQnLFxuICAgICAqICAgICB2YWx1ZToge1xuICAgICAqICAgICAgICdjb3VudHJ5JzogeyAkZXE6ICdbJWxrdHhwXUNvdW50cnknIH1cbiAgICAgKiAgICAgfVxuICAgICAqICAgfSxcbiAgICAgKiAgIHtcbiAgICAgKiAgICAgdHlwZTogJ3NpbXBsZXNvcnQnLFxuICAgICAqICAgICBwcm9wZXJ0eTogJ2FnZScsXG4gICAgICogICAgIG9wdGlvbnM6IHsgZGVzYzogZmFsc2V9XG4gICAgICogICB9XG4gICAgICogXSk7XG4gICAgICogdmFyIHJlc3VsdHMgPSB1c2Vycy5jaGFpbigpLnRyYW5zZm9ybShcIkNvdW50cnlGaWx0ZXJcIiwgeyBDb3VudHJ5OiAnZnInIH0pLmRhdGEoKTtcbiAgICAgKi9cbiAgICBSZXN1bHRzZXQucHJvdG90eXBlLnRyYW5zZm9ybSA9IGZ1bmN0aW9uICh0cmFuc2Zvcm0sIHBhcmFtZXRlcnMpIHtcbiAgICAgIHZhciBpZHgsXG4gICAgICAgIHN0ZXAsXG4gICAgICAgIHJzID0gdGhpcztcblxuICAgICAgLy8gaWYgdHJhbnNmb3JtIGlzIG5hbWUsIHRoZW4gZG8gbG9va3VwIGZpcnN0XG4gICAgICBpZiAodHlwZW9mIHRyYW5zZm9ybSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgaWYgKHRoaXMuY29sbGVjdGlvbi50cmFuc2Zvcm1zLmhhc093blByb3BlcnR5KHRyYW5zZm9ybSkpIHtcbiAgICAgICAgICB0cmFuc2Zvcm0gPSB0aGlzLmNvbGxlY3Rpb24udHJhbnNmb3Jtc1t0cmFuc2Zvcm1dO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIGVpdGhlciB0aGV5IHBhc3NlZCBpbiByYXcgdHJhbnNmb3JtIGFycmF5IG9yIHdlIGxvb2tlZCBpdCB1cCwgc28gcHJvY2Vzc1xuICAgICAgaWYgKHR5cGVvZiB0cmFuc2Zvcm0gIT09ICdvYmplY3QnIHx8ICFBcnJheS5pc0FycmF5KHRyYW5zZm9ybSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCB0cmFuc2Zvcm1cIik7XG4gICAgICB9XG5cbiAgICAgIGlmICh0eXBlb2YgcGFyYW1ldGVycyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgdHJhbnNmb3JtID0gVXRpbHMucmVzb2x2ZVRyYW5zZm9ybVBhcmFtcyh0cmFuc2Zvcm0sIHBhcmFtZXRlcnMpO1xuICAgICAgfVxuXG4gICAgICBmb3IgKGlkeCA9IDA7IGlkeCA8IHRyYW5zZm9ybS5sZW5ndGg7IGlkeCsrKSB7XG4gICAgICAgIHN0ZXAgPSB0cmFuc2Zvcm1baWR4XTtcblxuICAgICAgICBzd2l0Y2ggKHN0ZXAudHlwZSkge1xuICAgICAgICBjYXNlIFwiZmluZFwiOlxuICAgICAgICAgIHJzLmZpbmQoc3RlcC52YWx1ZSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJ3aGVyZVwiOlxuICAgICAgICAgIHJzLndoZXJlKHN0ZXAudmFsdWUpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwic2ltcGxlc29ydFwiOlxuICAgICAgICAgIHJzLnNpbXBsZXNvcnQoc3RlcC5wcm9wZXJ0eSwgc3RlcC5kZXNjIHx8IHN0ZXAub3B0aW9ucyk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJjb21wb3VuZHNvcnRcIjpcbiAgICAgICAgICBycy5jb21wb3VuZHNvcnQoc3RlcC52YWx1ZSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJzb3J0XCI6XG4gICAgICAgICAgcnMuc29ydChzdGVwLnZhbHVlKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcImxpbWl0XCI6XG4gICAgICAgICAgcnMgPSBycy5saW1pdChzdGVwLnZhbHVlKTtcbiAgICAgICAgICBicmVhazsgLy8gbGltaXQgbWFrZXMgY29weSBzbyB1cGRhdGUgcmVmZXJlbmNlXG4gICAgICAgIGNhc2UgXCJvZmZzZXRcIjpcbiAgICAgICAgICBycyA9IHJzLm9mZnNldChzdGVwLnZhbHVlKTtcbiAgICAgICAgICBicmVhazsgLy8gb2Zmc2V0IG1ha2VzIGNvcHkgc28gdXBkYXRlIHJlZmVyZW5jZVxuICAgICAgICBjYXNlIFwibWFwXCI6XG4gICAgICAgICAgcnMgPSBycy5tYXAoc3RlcC52YWx1ZSwgc3RlcC5kYXRhT3B0aW9ucyk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJlcUpvaW5cIjpcbiAgICAgICAgICBycyA9IHJzLmVxSm9pbihzdGVwLmpvaW5EYXRhLCBzdGVwLmxlZnRKb2luS2V5LCBzdGVwLnJpZ2h0Sm9pbktleSwgc3RlcC5tYXBGdW4sIHN0ZXAuZGF0YU9wdGlvbnMpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIC8vIGZvbGxvd2luZyBjYXNlcyBicmVhayBjaGFpbiBieSByZXR1cm5pbmcgYXJyYXkgZGF0YSBzbyBtYWtlIGFueSBvZiB0aGVzZSBsYXN0IGluIHRyYW5zZm9ybSBzdGVwc1xuICAgICAgICBjYXNlIFwibWFwUmVkdWNlXCI6XG4gICAgICAgICAgcnMgPSBycy5tYXBSZWR1Y2Uoc3RlcC5tYXBGdW5jdGlvbiwgc3RlcC5yZWR1Y2VGdW5jdGlvbik7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgLy8gZm9sbG93aW5nIGNhc2VzIHVwZGF0ZSBkb2N1bWVudHMgaW4gY3VycmVudCBmaWx0ZXJlZCByZXN1bHRzZXQgKHVzZSBjYXJlZnVsbHkpXG4gICAgICAgIGNhc2UgXCJ1cGRhdGVcIjpcbiAgICAgICAgICBycy51cGRhdGUoc3RlcC52YWx1ZSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJyZW1vdmVcIjpcbiAgICAgICAgICBycy5yZW1vdmUoKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gcnM7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFVzZXIgc3VwcGxpZWQgY29tcGFyZSBmdW5jdGlvbiBpcyBwcm92aWRlZCB0d28gZG9jdW1lbnRzIHRvIGNvbXBhcmUuIChjaGFpbmFibGUpXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAgICByc2x0LnNvcnQoZnVuY3Rpb24ob2JqMSwgb2JqMikge1xuICAgICAqICAgICAgaWYgKG9iajEubmFtZSA9PT0gb2JqMi5uYW1lKSByZXR1cm4gMDtcbiAgICAgKiAgICAgIGlmIChvYmoxLm5hbWUgPiBvYmoyLm5hbWUpIHJldHVybiAxO1xuICAgICAqICAgICAgaWYgKG9iajEubmFtZSA8IG9iajIubmFtZSkgcmV0dXJuIC0xO1xuICAgICAqICAgIH0pO1xuICAgICAqXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbn0gY29tcGFyZWZ1biAtIEEgamF2YXNjcmlwdCBjb21wYXJlIGZ1bmN0aW9uIHVzZWQgZm9yIHNvcnRpbmcuXG4gICAgICogQHJldHVybnMge1Jlc3VsdHNldH0gUmVmZXJlbmNlIHRvIHRoaXMgcmVzdWx0c2V0LCBzb3J0ZWQsIGZvciBmdXR1cmUgY2hhaW4gb3BlcmF0aW9ucy5cbiAgICAgKiBAbWVtYmVyb2YgUmVzdWx0c2V0XG4gICAgICovXG4gICAgUmVzdWx0c2V0LnByb3RvdHlwZS5zb3J0ID0gZnVuY3Rpb24gKGNvbXBhcmVmdW4pIHtcbiAgICAgIC8vIGlmIHRoaXMgaGFzIG5vIGZpbHRlcnMgYXBwbGllZCwganVzdCB3ZSBuZWVkIHRvIHBvcHVsYXRlIGZpbHRlcmVkcm93cyBmaXJzdFxuICAgICAgaWYgKCF0aGlzLmZpbHRlckluaXRpYWxpemVkICYmIHRoaXMuZmlsdGVyZWRyb3dzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICB0aGlzLmZpbHRlcmVkcm93cyA9IHRoaXMuY29sbGVjdGlvbi5wcmVwYXJlRnVsbERvY0luZGV4KCk7XG4gICAgICB9XG5cbiAgICAgIHZhciB3cmFwcGVkQ29tcGFyZXIgPVxuICAgICAgICAoZnVuY3Rpb24gKHVzZXJDb21wYXJlciwgZGF0YSkge1xuICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICAgICAgcmV0dXJuIHVzZXJDb21wYXJlcihkYXRhW2FdLCBkYXRhW2JdKTtcbiAgICAgICAgICB9O1xuICAgICAgICB9KShjb21wYXJlZnVuLCB0aGlzLmNvbGxlY3Rpb24uZGF0YSk7XG5cbiAgICAgIHRoaXMuZmlsdGVyZWRyb3dzLnNvcnQod3JhcHBlZENvbXBhcmVyKTtcblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFNpbXBsZXIsIGxvb3NlIGV2YWx1YXRpb24gZm9yIHVzZXIgdG8gc29ydCBiYXNlZCBvbiBhIHByb3BlcnR5IG5hbWUuIChjaGFpbmFibGUpLlxuICAgICAqICAgIFNvcnRpbmcgYmFzZWQgb24gdGhlIHNhbWUgbHQvZ3QgaGVscGVyIGZ1bmN0aW9ucyB1c2VkIGZvciBiaW5hcnkgaW5kaWNlcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBwcm9wbmFtZSAtIG5hbWUgb2YgcHJvcGVydHkgdG8gc29ydCBieS5cbiAgICAgKiBAcGFyYW0ge29iamVjdHxib29sPX0gb3B0aW9ucyAtIGJvb2xlYW4gdG8gc3BlY2lmeSBpZiBpc2Rlc2NlbmRpbmcsIG9yIG9wdGlvbnMgb2JqZWN0XG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5kZXNjPWZhbHNlXSAtIHdoZXRoZXIgdG8gc29ydCBkZXNjZW5kaW5nXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5kaXNhYmxlSW5kZXhJbnRlcnNlY3Q9ZmFsc2VdIC0gd2hldGhlciB3ZSBzaG91bGQgZXhwbGljaXR5IG5vdCB1c2UgYXJyYXkgaW50ZXJzZWN0aW9uLlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMuZm9yY2VJbmRleEludGVyc2VjdD1mYWxzZV0gLSBmb3JjZSBhcnJheSBpbnRlcnNlY3Rpb24gKGlmIGJpbmFyeSBpbmRleCBleGlzdHMpLlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMudXNlSmF2YXNjcmlwdFNvcnRpbmc9ZmFsc2VdIC0gd2hldGhlciByZXN1bHRzIGFyZSBzb3J0ZWQgdmlhIGJhc2ljIGphdmFzY3JpcHQgc29ydC5cbiAgICAgKiBAcmV0dXJucyB7UmVzdWx0c2V0fSBSZWZlcmVuY2UgdG8gdGhpcyByZXN1bHRzZXQsIHNvcnRlZCwgZm9yIGZ1dHVyZSBjaGFpbiBvcGVyYXRpb25zLlxuICAgICAqIEBtZW1iZXJvZiBSZXN1bHRzZXRcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIHZhciByZXN1bHRzID0gdXNlcnMuY2hhaW4oKS5zaW1wbGVzb3J0KCdhZ2UnKS5kYXRhKCk7XG4gICAgICovXG4gICAgUmVzdWx0c2V0LnByb3RvdHlwZS5zaW1wbGVzb3J0ID0gZnVuY3Rpb24gKHByb3BuYW1lLCBvcHRpb25zKSB7XG4gICAgICB2YXIgZWZmLCBcbiAgICAgICAgdGFyZ2V0RWZmID0gMTAsXG4gICAgICAgIGRjID0gdGhpcy5jb2xsZWN0aW9uLmRhdGEubGVuZ3RoLCBcbiAgICAgICAgZnJsID0gdGhpcy5maWx0ZXJlZHJvd3MubGVuZ3RoLFxuICAgICAgICBoYXNCaW5hcnlJbmRleCA9IHRoaXMuY29sbGVjdGlvbi5iaW5hcnlJbmRpY2VzLmhhc093blByb3BlcnR5KHByb3BuYW1lKTtcblxuICAgICAgaWYgKHR5cGVvZiAob3B0aW9ucykgPT09ICd1bmRlZmluZWQnIHx8IG9wdGlvbnMgPT09IGZhbHNlKSB7XG4gICAgICAgIG9wdGlvbnMgPSB7IGRlc2M6IGZhbHNlIH07XG4gICAgICB9XG4gICAgICBpZiAob3B0aW9ucyA9PT0gdHJ1ZSkge1xuICAgICAgICBvcHRpb25zID0geyBkZXNjOiB0cnVlIH07XG4gICAgICB9XG5cbiAgICAgIC8vIGlmIG5vdGhpbmcgaW4gZmlsdGVyZWQgcm93cyBhcnJheS4uLlxuICAgICAgaWYgKGZybCA9PT0gMCkge1xuICAgICAgICAvLyBpZiB0aGUgZmlsdGVyIGlzIGluaXRpYWxpemVkIHRvIGJlIGVtcHR5IHJlc3VsdHNldCwgZG8gbm90aGluZ1xuICAgICAgICBpZiAodGhpcy5maWx0ZXJJbml0aWFsaXplZCkge1xuICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBvdGhlcndpc2Ugbm8gZmlsdGVycyBhcHBsaWVkIGltcGxpZXMgYWxsIGRvY3VtZW50cywgc28gd2UgbmVlZCB0byBwb3B1bGF0ZSBmaWx0ZXJlZHJvd3MgZmlyc3RcbiAgICAgICAgXG4gICAgICAgIC8vIGlmIHdlIGhhdmUgYSBiaW5hcnkgaW5kZXgsIHdlIGNhbiBqdXN0IHVzZSB0aGF0IGluc3RlYWQgb2Ygc29ydGluZyAoYWdhaW4pXG4gICAgICAgIGlmICh0aGlzLmNvbGxlY3Rpb24uYmluYXJ5SW5kaWNlcy5oYXNPd25Qcm9wZXJ0eShwcm9wbmFtZSkpIHtcbiAgICAgICAgICAvLyBtYWtlIHN1cmUgaW5kZXggaXMgdXAtdG8tZGF0ZVxuICAgICAgICAgIHRoaXMuY29sbGVjdGlvbi5lbnN1cmVJbmRleChwcm9wbmFtZSk7XG4gICAgICAgICAgLy8gY29weSBpbmRleCB2YWx1ZXMgaW50byBmaWx0ZXJlZHJvd3NcbiAgICAgICAgICB0aGlzLmZpbHRlcmVkcm93cyA9IHRoaXMuY29sbGVjdGlvbi5iaW5hcnlJbmRpY2VzW3Byb3BuYW1lXS52YWx1ZXMuc2xpY2UoMCk7XG5cbiAgICAgICAgICBpZiAob3B0aW9ucy5kZXNjKSB7XG4gICAgICAgICAgICB0aGlzLmZpbHRlcmVkcm93cy5yZXZlcnNlKCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gd2UgYXJlIGRvbmUsIHJldHVybiB0aGlzIChyZXN1bHRzZXQpIGZvciBmdXJ0aGVyIGNoYWluIG9wc1xuICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIC8vIG90aGVyd2lzZSBpbml0aWFsaXplIGFycmF5IGZvciBzb3J0IGJlbG93XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIC8vIGJ1aWxkIGZ1bGwgZG9jdW1lbnQgaW5kZXggKHRvIGJlIHNvcnRlZCBzdWJzZXF1ZW50bHkpXG4gICAgICAgICAgdGhpcy5maWx0ZXJlZHJvd3MgPSB0aGlzLmNvbGxlY3Rpb24ucHJlcGFyZUZ1bGxEb2NJbmRleCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICAvLyBvdGhlcndpc2Ugd2UgaGFkIHJlc3VsdHMgdG8gYmVnaW4gd2l0aCwgc2VlIGlmIHdlIHF1YWxpZnkgZm9yIGluZGV4IGludGVyY2VwdCBvcHRpbWl6YXRpb25cbiAgICAgIGVsc2Uge1xuXG4gICAgICAgIC8vIElmIGFscmVhZHkgZmlsdGVyZWQsIGJ1dCB3ZSB3YW50IHRvIGxldmVyYWdlIGJpbmFyeSBpbmRleCBvbiBzb3J0LlxuICAgICAgICAvLyBUaGlzIHdpbGwgdXNlIGN1c3RvbSBhcnJheSBpbnRlY3Rpb24gYWxnb3JpdGhtLlxuICAgICAgICBpZiAoIW9wdGlvbnMuZGlzYWJsZUluZGV4SW50ZXJzZWN0ICYmIGhhc0JpbmFyeUluZGV4KSB7XG5cbiAgICAgICAgICAvLyBjYWxjdWxhdGUgZmlsdGVyIGVmZmljaWVuY3lcbiAgICAgICAgICBlZmYgPSBkYy9mcmw7XG5cbiAgICAgICAgICAvLyB3aGVuIGphdmFzY3JpcHQgc29ydCBmYWxsYmFjayBpcyBlbmFibGVkLCB5b3UgZ2VuZXJhbGx5IG5lZWQgbW9yZSB0aGFuIH4xNyUgb2YgdG90YWwgZG9jcyBpbiByZXN1bHRzZXRcbiAgICAgICAgICAvLyBiZWZvcmUgYXJyYXkgaW50ZXJzZWN0IGlzIGRldGVybWluZWQgdG8gYmUgdGhlIGZhc3RlciBhbGdvcml0aG0sIG90aGVyd2lzZSBsZWF2ZSBhdCAxMCUgZm9yIGxva2kgc29ydC5cbiAgICAgICAgICBpZiAob3B0aW9ucy51c2VKYXZhc2NyaXB0U29ydGluZykge1xuICAgICAgICAgICAgdGFyZ2V0RWZmID0gNjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBhbnl0aGluZyBtb3JlIHRoYW4gcmF0aW8gb2YgMTA6MSAodG90YWwgZG9jdW1lbnRzL2N1cnJlbnQgcmVzdWx0cykgc2hvdWxkIHVzZSBvbGQgc29ydCBjb2RlIHBhdGhcbiAgICAgICAgICAvLyBTbyB3ZSB3aWxsIG9ubHkgdXNlIGFycmF5IGludGVyc2VjdGlvbiBpZiB5b3UgaGF2ZSBtb3JlIHRoYW4gMTAlIG9mIHRvdGFsIGRvY3MgaW4geW91ciBjdXJyZW50IHJlc3VsdHNldC5cbiAgICAgICAgICBpZiAoZWZmIDw9IHRhcmdldEVmZiB8fCBvcHRpb25zLmZvcmNlSW5kZXhJbnRlcnNlY3QpIHtcbiAgICAgICAgICAgIHZhciBpZHgsIGZyPXRoaXMuZmlsdGVyZWRyb3dzO1xuICAgICAgICAgICAgdmFyIGlvID0ge307XG4gICAgICAgICAgICAvLyBzZXQgdXAgaGFzaG9iamVjdCBmb3Igc2ltcGxlICdpbmNsdXNpb24gdGVzdCcgd2l0aCBleGlzdGluZyAoZmlsdGVyZWQpIHJlc3VsdHNcbiAgICAgICAgICAgIGZvcihpZHg9MDsgaWR4PGZybDsgaWR4KyspIHtcbiAgICAgICAgICAgICAgaW9bZnJbaWR4XV0gPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gZ3JhYiBmdWxsIHNvcnRlZCBiaW5hcnkgaW5kZXggYXJyYXlcbiAgICAgICAgICAgIHZhciBwdiA9IHRoaXMuY29sbGVjdGlvbi5iaW5hcnlJbmRpY2VzW3Byb3BuYW1lXS52YWx1ZXM7XG5cbiAgICAgICAgICAgIC8vIGZpbHRlciBieSBleGlzdGluZyByZXN1bHRzXG4gICAgICAgICAgICB0aGlzLmZpbHRlcmVkcm93cyA9IHB2LmZpbHRlcihmdW5jdGlvbihuKSB7IHJldHVybiBpb1tuXTsgfSk7XG5cbiAgICAgICAgICAgIGlmIChvcHRpb25zLmRlc2MpIHtcbiAgICAgICAgICAgICAgdGhpcy5maWx0ZXJlZHJvd3MucmV2ZXJzZSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gYXQgdGhpcyBwb2ludCwgd2Ugd2lsbCBub3QgYmUgYWJsZSB0byBsZXZlcmFnZSBiaW5hcnkgaW5kZXggc28gd2Ugd2lsbCBoYXZlIHRvIGRvIGFuIGFycmF5IHNvcnRcbiAgICAgIFxuICAgICAgLy8gaWYgd2UgaGF2ZSBvcHRlZCB0byB1c2Ugc2ltcGxpZmllZCBqYXZhc2NyaXB0IGNvbXBhcmlzb24gZnVuY3Rpb24uLi5cbiAgICAgIGlmIChvcHRpb25zLnVzZUphdmFzY3JpcHRTb3J0aW5nKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNvcnQoZnVuY3Rpb24ob2JqMSwgb2JqMikge1xuICAgICAgICAgIGlmIChvYmoxW3Byb3BuYW1lXSA9PT0gb2JqMltwcm9wbmFtZV0pIHJldHVybiAwO1xuICAgICAgICAgIGlmIChvYmoxW3Byb3BuYW1lXSA+IG9iajJbcHJvcG5hbWVdKSByZXR1cm4gMTtcbiAgICAgICAgICBpZiAob2JqMVtwcm9wbmFtZV0gPCBvYmoyW3Byb3BuYW1lXSkgcmV0dXJuIC0xO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgLy8gb3RoZXJ3aXNlIHVzZSBsb2tpIHNvcnQgd2hpY2ggd2lsbCByZXR1cm4gc2FtZSByZXN1bHRzIGlmIGNvbHVtbiBpcyBpbmRleGVkIG9yIG5vdFxuICAgICAgdmFyIHdyYXBwZWRDb21wYXJlciA9XG4gICAgICAgIChmdW5jdGlvbiAocHJvcCwgZGVzYywgZGF0YSkge1xuICAgICAgICAgIHZhciB2YWwxLCB2YWwyLCBhcnI7XG4gICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICBpZiAofnByb3AuaW5kZXhPZignLicpKSB7XG4gICAgICAgICAgICAgIGFyciA9IHByb3Auc3BsaXQoJy4nKTtcbiAgICAgICAgICAgICAgdmFsMSA9IFV0aWxzLmdldEluKGRhdGFbYV0sIGFyciwgdHJ1ZSk7XG4gICAgICAgICAgICAgIHZhbDIgPSBVdGlscy5nZXRJbihkYXRhW2JdLCBhcnIsIHRydWUpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdmFsMSA9IGRhdGFbYV1bcHJvcF07XG4gICAgICAgICAgICAgIHZhbDIgPSBkYXRhW2JdW3Byb3BdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHNvcnRIZWxwZXIodmFsMSwgdmFsMiwgZGVzYyk7XG4gICAgICAgICAgfTtcbiAgICAgICAgfSkocHJvcG5hbWUsIG9wdGlvbnMuZGVzYywgdGhpcy5jb2xsZWN0aW9uLmRhdGEpO1xuXG4gICAgICB0aGlzLmZpbHRlcmVkcm93cy5zb3J0KHdyYXBwZWRDb21wYXJlcik7XG5cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBBbGxvd3Mgc29ydGluZyBhIHJlc3VsdHNldCBiYXNlZCBvbiBtdWx0aXBsZSBjb2x1bW5zLlxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gdG8gc29ydCBieSBhZ2UgYW5kIHRoZW4gbmFtZSAoYm90aCBhc2NlbmRpbmcpXG4gICAgICogcnMuY29tcG91bmRzb3J0KFsnYWdlJywgJ25hbWUnXSk7XG4gICAgICogLy8gdG8gc29ydCBieSBhZ2UgKGFzY2VuZGluZykgYW5kIHRoZW4gYnkgbmFtZSAoZGVzY2VuZGluZylcbiAgICAgKiBycy5jb21wb3VuZHNvcnQoWydhZ2UnLCBbJ25hbWUnLCB0cnVlXV0pO1xuICAgICAqXG4gICAgICogQHBhcmFtIHthcnJheX0gcHJvcGVydGllcyAtIGFycmF5IG9mIHByb3BlcnR5IG5hbWVzIG9yIHN1YmFycmF5IG9mIFtwcm9wZXJ0eW5hbWUsIGlzZGVzY10gdXNlZCBldmFsdWF0ZSBzb3J0IG9yZGVyXG4gICAgICogQHJldHVybnMge1Jlc3VsdHNldH0gUmVmZXJlbmNlIHRvIHRoaXMgcmVzdWx0c2V0LCBzb3J0ZWQsIGZvciBmdXR1cmUgY2hhaW4gb3BlcmF0aW9ucy5cbiAgICAgKiBAbWVtYmVyb2YgUmVzdWx0c2V0XG4gICAgICovXG4gICAgUmVzdWx0c2V0LnByb3RvdHlwZS5jb21wb3VuZHNvcnQgPSBmdW5jdGlvbiAocHJvcGVydGllcykge1xuICAgICAgaWYgKHByb3BlcnRpZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgY2FsbCB0byBjb21wb3VuZHNvcnQsIG5lZWQgYXQgbGVhc3Qgb25lIHByb3BlcnR5XCIpO1xuICAgICAgfVxuXG4gICAgICB2YXIgcHJvcDtcbiAgICAgIGlmIChwcm9wZXJ0aWVzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICBwcm9wID0gcHJvcGVydGllc1swXTtcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkocHJvcCkpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5zaW1wbGVzb3J0KHByb3BbMF0sIHByb3BbMV0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnNpbXBsZXNvcnQocHJvcCwgZmFsc2UpO1xuICAgICAgfVxuXG4gICAgICAvLyB1bmlmeSB0aGUgc3RydWN0dXJlIG9mICdwcm9wZXJ0aWVzJyB0byBhdm9pZCBjaGVja2luZyBpdCByZXBlYXRlZGx5IHdoaWxlIHNvcnRpbmdcbiAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBwcm9wZXJ0aWVzLmxlbmd0aDsgaSA8IGxlbjsgaSArPSAxKSB7XG4gICAgICAgIHByb3AgPSBwcm9wZXJ0aWVzW2ldO1xuICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkocHJvcCkpIHtcbiAgICAgICAgICBwcm9wZXJ0aWVzW2ldID0gW3Byb3AsIGZhbHNlXTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBpZiB0aGlzIGhhcyBubyBmaWx0ZXJzIGFwcGxpZWQsIGp1c3Qgd2UgbmVlZCB0byBwb3B1bGF0ZSBmaWx0ZXJlZHJvd3MgZmlyc3RcbiAgICAgIGlmICghdGhpcy5maWx0ZXJJbml0aWFsaXplZCAmJiB0aGlzLmZpbHRlcmVkcm93cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgdGhpcy5maWx0ZXJlZHJvd3MgPSB0aGlzLmNvbGxlY3Rpb24ucHJlcGFyZUZ1bGxEb2NJbmRleCgpO1xuICAgICAgfVxuXG4gICAgICB2YXIgd3JhcHBlZENvbXBhcmVyID1cbiAgICAgICAgKGZ1bmN0aW9uIChwcm9wcywgZGF0YSkge1xuICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICAgICAgcmV0dXJuIGNvbXBvdW5kZXZhbChwcm9wcywgZGF0YVthXSwgZGF0YVtiXSk7XG4gICAgICAgICAgfTtcbiAgICAgICAgfSkocHJvcGVydGllcywgdGhpcy5jb2xsZWN0aW9uLmRhdGEpO1xuXG4gICAgICB0aGlzLmZpbHRlcmVkcm93cy5zb3J0KHdyYXBwZWRDb21wYXJlcik7XG5cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBmaW5kT3IoKSAtIG92ZXJzZWUgdGhlIG9wZXJhdGlvbiBvZiBPUidlZCBxdWVyeSBleHByZXNzaW9ucy5cbiAgICAgKiAgICBPUidlZCBleHByZXNzaW9uIGV2YWx1YXRpb24gcnVucyBlYWNoIGV4cHJlc3Npb24gaW5kaXZpZHVhbGx5IGFnYWluc3QgdGhlIGZ1bGwgY29sbGVjdGlvbixcbiAgICAgKiAgICBhbmQgZmluYWxseSBkb2VzIGEgc2V0IE9SIG9uIGVhY2ggZXhwcmVzc2lvbidzIHJlc3VsdHMuXG4gICAgICogICAgRWFjaCBldmFsdWF0aW9uIGNhbiB1dGlsaXplIGEgYmluYXJ5IGluZGV4IHRvIHByZXZlbnQgbXVsdGlwbGUgbGluZWFyIGFycmF5IHNjYW5zLlxuICAgICAqXG4gICAgICogQHBhcmFtIHthcnJheX0gZXhwcmVzc2lvbkFycmF5IC0gYXJyYXkgb2YgZXhwcmVzc2lvbnNcbiAgICAgKiBAcmV0dXJucyB7UmVzdWx0c2V0fSB0aGlzIHJlc3VsdHNldCBmb3IgZnVydGhlciBjaGFpbiBvcHMuXG4gICAgICovXG4gICAgUmVzdWx0c2V0LnByb3RvdHlwZS5maW5kT3IgPSBmdW5jdGlvbiAoZXhwcmVzc2lvbkFycmF5KSB7XG4gICAgICB2YXIgZnIgPSBudWxsLFxuICAgICAgICBmcmkgPSAwLFxuICAgICAgICBmcmxlbiA9IDAsXG4gICAgICAgIGRvY3NldCA9IFtdLFxuICAgICAgICBpZHhzZXQgPSBbXSxcbiAgICAgICAgaWR4ID0gMCxcbiAgICAgICAgb3JpZ0NvdW50ID0gdGhpcy5jb3VudCgpO1xuXG4gICAgICAvLyBJZiBmaWx0ZXIgaXMgYWxyZWFkeSBpbml0aWFsaXplZCwgdGhlbiB3ZSBxdWVyeSBhZ2FpbnN0IG9ubHkgdGhvc2UgaXRlbXMgYWxyZWFkeSBpbiBmaWx0ZXIuXG4gICAgICAvLyBUaGlzIG1lYW5zIG5vIGluZGV4IHV0aWxpemF0aW9uIGZvciBmaWVsZHMsIHNvIGhvcGVmdWxseSBpdHMgZmlsdGVyZWQgdG8gYSBzbWFsbGlzaCBmaWx0ZXJlZHJvd3MuXG4gICAgICBmb3IgKHZhciBlaSA9IDAsIGVsZW4gPSBleHByZXNzaW9uQXJyYXkubGVuZ3RoOyBlaSA8IGVsZW47IGVpKyspIHtcbiAgICAgICAgLy8gd2UgbmVlZCB0byBicmFuY2ggZXhpc3RpbmcgcXVlcnkgdG8gcnVuIGVhY2ggZmlsdGVyIHNlcGFyYXRlbHkgYW5kIGNvbWJpbmUgcmVzdWx0c1xuICAgICAgICBmciA9IHRoaXMuYnJhbmNoKCkuZmluZChleHByZXNzaW9uQXJyYXlbZWldKS5maWx0ZXJlZHJvd3M7XG4gICAgICAgIGZybGVuID0gZnIubGVuZ3RoO1xuICAgICAgICAvLyBpZiB0aGUgZmluZCBvcGVyYXRpb24gZGlkIG5vdCByZWR1Y2UgdGhlIGluaXRpYWwgc2V0LCB0aGVuIHRoZSBpbml0aWFsIHNldCBpcyB0aGUgYWN0dWFsIHJlc3VsdFxuICAgICAgICBpZiAoZnJsZW4gPT09IG9yaWdDb3VudCkge1xuICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gYWRkIGFueSBkb2N1bWVudCAnaGl0cydcbiAgICAgICAgZm9yIChmcmkgPSAwOyBmcmkgPCBmcmxlbjsgZnJpKyspIHtcbiAgICAgICAgICBpZHggPSBmcltmcmldO1xuICAgICAgICAgIGlmIChpZHhzZXRbaWR4XSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBpZHhzZXRbaWR4XSA9IHRydWU7XG4gICAgICAgICAgICBkb2NzZXQucHVzaChpZHgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB0aGlzLmZpbHRlcmVkcm93cyA9IGRvY3NldDtcbiAgICAgIHRoaXMuZmlsdGVySW5pdGlhbGl6ZWQgPSB0cnVlO1xuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIFJlc3VsdHNldC5wcm90b3R5cGUuJG9yID0gUmVzdWx0c2V0LnByb3RvdHlwZS5maW5kT3I7XG5cbiAgICAvLyBwcmVjb21waWxlIHJlY3Vyc2l2ZWx5XG4gICAgZnVuY3Rpb24gcHJlY29tcGlsZVF1ZXJ5IChvcGVyYXRvciwgdmFsdWUpIHtcbiAgICAgIC8vIGZvciByZWdleCBvcHMsIHByZWNvbXBpbGVcbiAgICAgIGlmIChvcGVyYXRvciA9PT0gJyRyZWdleCcpIHtcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG4gICAgICAgICAgdmFsdWUgPSBuZXcgUmVnRXhwKHZhbHVlWzBdLCB2YWx1ZVsxXSk7XG4gICAgICAgIH0gZWxzZSBpZiAoISh2YWx1ZSBpbnN0YW5jZW9mIFJlZ0V4cCkpIHtcbiAgICAgICAgICB2YWx1ZSA9IG5ldyBSZWdFeHAodmFsdWUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnKSB7XG4gICAgICAgIGZvciAodmFyIGtleSBpbiB2YWx1ZSkge1xuICAgICAgICAgIGlmIChrZXkgPT09ICckcmVnZXgnIHx8IHR5cGVvZiB2YWx1ZVtrZXldID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgdmFsdWVba2V5XSA9IHByZWNvbXBpbGVRdWVyeShrZXksIHZhbHVlW2tleV0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogZmluZEFuZCgpIC0gb3ZlcnNlZSB0aGUgb3BlcmF0aW9uIG9mIEFORCdlZCBxdWVyeSBleHByZXNzaW9ucy5cbiAgICAgKiAgICBBTkQnZWQgZXhwcmVzc2lvbiBldmFsdWF0aW9uIHJ1bnMgZWFjaCBleHByZXNzaW9uIHByb2dyZXNzaXZlbHkgYWdhaW5zdCB0aGUgZnVsbCBjb2xsZWN0aW9uLFxuICAgICAqICAgIGludGVybmFsbHkgdXRpbGl6aW5nIGV4aXN0aW5nIGNoYWluZWQgcmVzdWx0c2V0IGZ1bmN0aW9uYWxpdHkuXG4gICAgICogICAgT25seSB0aGUgZmlyc3QgZmlsdGVyIGNhbiB1dGlsaXplIGEgYmluYXJ5IGluZGV4LlxuICAgICAqXG4gICAgICogQHBhcmFtIHthcnJheX0gZXhwcmVzc2lvbkFycmF5IC0gYXJyYXkgb2YgZXhwcmVzc2lvbnNcbiAgICAgKiBAcmV0dXJucyB7UmVzdWx0c2V0fSB0aGlzIHJlc3VsdHNldCBmb3IgZnVydGhlciBjaGFpbiBvcHMuXG4gICAgICovXG4gICAgUmVzdWx0c2V0LnByb3RvdHlwZS5maW5kQW5kID0gZnVuY3Rpb24gKGV4cHJlc3Npb25BcnJheSkge1xuICAgICAgLy8gd2UgaGF2ZSBhbHJlYWR5IGltcGxlbWVudGluZyBtZXRob2QgY2hhaW5pbmcgaW4gdGhpcyAob3VyIFJlc3VsdHNldCBjbGFzcylcbiAgICAgIC8vIHNvIGxldHMganVzdCBwcm9ncmVzc2l2ZWx5IGFwcGx5IHVzZXIgc3VwcGxpZWQgYW5kIGZpbHRlcnNcbiAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBleHByZXNzaW9uQXJyYXkubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgaWYgKHRoaXMuY291bnQoKSA9PT0gMCkge1xuICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZmluZChleHByZXNzaW9uQXJyYXlbaV0pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBSZXN1bHRzZXQucHJvdG90eXBlLiRhbmQgPSBSZXN1bHRzZXQucHJvdG90eXBlLmZpbmRBbmQ7XG5cbiAgICAvKipcbiAgICAgKiBVc2VkIGZvciBxdWVyeWluZyB2aWEgYSBtb25nby1zdHlsZSBxdWVyeSBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge29iamVjdH0gcXVlcnkgLSBBIG1vbmdvLXN0eWxlIHF1ZXJ5IG9iamVjdCB1c2VkIGZvciBmaWx0ZXJpbmcgY3VycmVudCByZXN1bHRzLlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbj19IGZpcnN0T25seSAtIChPcHRpb25hbCkgVXNlZCBieSBjb2xsZWN0aW9uLmZpbmRPbmUoKVxuICAgICAqIEByZXR1cm5zIHtSZXN1bHRzZXR9IHRoaXMgcmVzdWx0c2V0IGZvciBmdXJ0aGVyIGNoYWluIG9wcy5cbiAgICAgKiBAbWVtYmVyb2YgUmVzdWx0c2V0XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiB2YXIgb3ZlcjMwID0gdXNlcnMuY2hhaW4oKS5maW5kKHsgYWdlOiB7ICRndGU6IDMwIH0gfSkuZGF0YSgpO1xuICAgICAqL1xuICAgIFJlc3VsdHNldC5wcm90b3R5cGUuZmluZCA9IGZ1bmN0aW9uIChxdWVyeSwgZmlyc3RPbmx5KSB7XG4gICAgICBpZiAodGhpcy5jb2xsZWN0aW9uLmRhdGEubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHRoaXMuZmlsdGVyZWRyb3dzID0gW107XG4gICAgICAgIHRoaXMuZmlsdGVySW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH1cblxuICAgICAgdmFyIHF1ZXJ5T2JqZWN0ID0gcXVlcnkgfHwgJ2dldEFsbCcsXG4gICAgICAgIHAsXG4gICAgICAgIHByb3BlcnR5LFxuICAgICAgICBxdWVyeU9iamVjdE9wLFxuICAgICAgICBvYmosXG4gICAgICAgIG9wZXJhdG9yLFxuICAgICAgICB2YWx1ZSxcbiAgICAgICAga2V5LFxuICAgICAgICBzZWFyY2hCeUluZGV4ID0gZmFsc2UsXG4gICAgICAgIHJlc3VsdCA9IFtdLFxuICAgICAgICBmaWx0ZXJzID0gW10sXG4gICAgICAgIGluZGV4ID0gbnVsbDtcblxuICAgICAgLy8gZmxhZyBpZiB0aGlzIHdhcyBpbnZva2VkIHZpYSBmaW5kT25lKClcbiAgICAgIGZpcnN0T25seSA9IGZpcnN0T25seSB8fCBmYWxzZTtcblxuICAgICAgaWYgKHR5cGVvZiBxdWVyeU9iamVjdCA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgZm9yIChwIGluIHF1ZXJ5T2JqZWN0KSB7XG4gICAgICAgICAgb2JqID0ge307XG4gICAgICAgICAgb2JqW3BdID0gcXVlcnlPYmplY3RbcF07XG4gICAgICAgICAgZmlsdGVycy5wdXNoKG9iaik7XG5cbiAgICAgICAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbChxdWVyeU9iamVjdCwgcCkpIHtcbiAgICAgICAgICAgIHByb3BlcnR5ID0gcDtcbiAgICAgICAgICAgIHF1ZXJ5T2JqZWN0T3AgPSBxdWVyeU9iamVjdFtwXTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gaWYgbW9yZSB0aGFuIG9uZSBleHByZXNzaW9uIGluIHNpbmdsZSBxdWVyeSBvYmplY3QsXG4gICAgICAgIC8vIGNvbnZlcnQgaW1wbGljaXQgJGFuZCB0byBleHBsaWNpdCAkYW5kXG4gICAgICAgIGlmIChmaWx0ZXJzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5maW5kKHsgJyRhbmQnOiBmaWx0ZXJzIH0sIGZpcnN0T25seSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gYXBwbHkgbm8gZmlsdGVycyBpZiB0aGV5IHdhbnQgYWxsXG4gICAgICBpZiAoIXByb3BlcnR5IHx8IHF1ZXJ5T2JqZWN0ID09PSAnZ2V0QWxsJykge1xuICAgICAgICBpZiAoZmlyc3RPbmx5KSB7XG4gICAgICAgICAgdGhpcy5maWx0ZXJlZHJvd3MgPSAodGhpcy5jb2xsZWN0aW9uLmRhdGEubGVuZ3RoID4gMCk/WzBdOiBbXTtcbiAgICAgICAgICB0aGlzLmZpbHRlckluaXRpYWxpemVkID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfVxuXG4gICAgICAvLyBpbmplY3RpbmcgJGFuZCBhbmQgJG9yIGV4cHJlc3Npb24gdHJlZSBldmFsdWF0aW9uIGhlcmUuXG4gICAgICBpZiAocHJvcGVydHkgPT09ICckYW5kJyB8fCBwcm9wZXJ0eSA9PT0gJyRvcicpIHtcbiAgICAgICAgdGhpc1twcm9wZXJ0eV0ocXVlcnlPYmplY3RPcCk7XG5cbiAgICAgICAgLy8gZm9yIGNoYWluZWQgZmluZCB3aXRoIGZpcnN0b25seSxcbiAgICAgICAgaWYgKGZpcnN0T25seSAmJiB0aGlzLmZpbHRlcmVkcm93cy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgdGhpcy5maWx0ZXJlZHJvd3MgPSB0aGlzLmZpbHRlcmVkcm93cy5zbGljZSgwLCAxKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfVxuXG4gICAgICAvLyBzZWUgaWYgcXVlcnkgb2JqZWN0IGlzIGluIHNob3J0aGFuZCBtb2RlIChhc3N1bWluZyBlcSBvcGVyYXRvcilcbiAgICAgIGlmIChxdWVyeU9iamVjdE9wID09PSBudWxsIHx8ICh0eXBlb2YgcXVlcnlPYmplY3RPcCAhPT0gJ29iamVjdCcgfHwgcXVlcnlPYmplY3RPcCBpbnN0YW5jZW9mIERhdGUpKSB7XG4gICAgICAgIG9wZXJhdG9yID0gJyRlcSc7XG4gICAgICAgIHZhbHVlID0gcXVlcnlPYmplY3RPcDtcbiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHF1ZXJ5T2JqZWN0T3AgPT09ICdvYmplY3QnKSB7XG4gICAgICAgIGZvciAoa2V5IGluIHF1ZXJ5T2JqZWN0T3ApIHtcbiAgICAgICAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbChxdWVyeU9iamVjdE9wLCBrZXkpKSB7XG4gICAgICAgICAgICBvcGVyYXRvciA9IGtleTtcbiAgICAgICAgICAgIHZhbHVlID0gcXVlcnlPYmplY3RPcFtrZXldO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0RvIG5vdCBrbm93IHdoYXQgeW91IHdhbnQgdG8gZG8uJyk7XG4gICAgICB9XG5cbiAgICAgIGlmIChvcGVyYXRvciA9PT0gJyRyZWdleCcgfHwgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0Jykge1xuICAgICAgICB2YWx1ZSA9IHByZWNvbXBpbGVRdWVyeShvcGVyYXRvciwgdmFsdWUpO1xuICAgICAgfVxuXG4gICAgICAvLyBpZiB1c2VyIGlzIGRlZXAgcXVlcnlpbmcgdGhlIG9iamVjdCBzdWNoIGFzIGZpbmQoJ25hbWUuZmlyc3QnOiAnb2RpbicpXG4gICAgICB2YXIgdXNpbmdEb3ROb3RhdGlvbiA9IChwcm9wZXJ0eS5pbmRleE9mKCcuJykgIT09IC0xKTtcblxuICAgICAgLy8gaWYgYW4gaW5kZXggZXhpc3RzIGZvciB0aGUgcHJvcGVydHkgYmVpbmcgcXVlcmllZCBhZ2FpbnN0LCB1c2UgaXRcbiAgICAgIC8vIGZvciBub3cgb25seSBlbmFibGluZyB3aGVyZSBpdCBpcyB0aGUgZmlyc3QgZmlsdGVyIGFwcGxpZWQgYW5kIHByb3AgaXMgaW5kZXhlZFxuICAgICAgdmFyIGRvSW5kZXhDaGVjayA9ICF0aGlzLmZpbHRlckluaXRpYWxpemVkO1xuXG4gICAgICBpZiAoZG9JbmRleENoZWNrICYmIHRoaXMuY29sbGVjdGlvbi5iaW5hcnlJbmRpY2VzW3Byb3BlcnR5XSAmJiBpbmRleGVkT3BzW29wZXJhdG9yXSkge1xuICAgICAgICAvLyB0aGlzIGlzIHdoZXJlIG91ciBsYXp5IGluZGV4IHJlYnVpbGRpbmcgd2lsbCB0YWtlIHBsYWNlXG4gICAgICAgIC8vIGJhc2ljYWxseSB3ZSB3aWxsIGxlYXZlIGFsbCBpbmRleGVzIGRpcnR5IHVudGlsIHdlIG5lZWQgdGhlbVxuICAgICAgICAvLyBzbyBoZXJlIHdlIHdpbGwgcmVidWlsZCBvbmx5IHRoZSBpbmRleCB0aWVkIHRvIHRoaXMgcHJvcGVydHlcbiAgICAgICAgLy8gZW5zdXJlSW5kZXgoKSB3aWxsIG9ubHkgcmVidWlsZCBpZiBmbGFnZ2VkIGFzIGRpcnR5IHNpbmNlIHdlIGFyZSBub3QgcGFzc2luZyBmb3JjZT10cnVlIHBhcmFtXG4gICAgICAgIGlmICh0aGlzLmNvbGxlY3Rpb24uYWRhcHRpdmVCaW5hcnlJbmRpY2VzICE9PSB0cnVlKSB7XG4gICAgICAgICAgdGhpcy5jb2xsZWN0aW9uLmVuc3VyZUluZGV4KHByb3BlcnR5KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHNlYXJjaEJ5SW5kZXggPSB0cnVlO1xuICAgICAgICBpbmRleCA9IHRoaXMuY29sbGVjdGlvbi5iaW5hcnlJbmRpY2VzW3Byb3BlcnR5XTtcbiAgICAgIH1cblxuICAgICAgLy8gdGhlIGNvbXBhcmlzb24gZnVuY3Rpb25cbiAgICAgIHZhciBmdW4gPSBMb2tpT3BzW29wZXJhdG9yXTtcblxuICAgICAgLy8gXCJzaG9ydGN1dFwiIGZvciBjb2xsZWN0aW9uIGRhdGFcbiAgICAgIHZhciB0ID0gdGhpcy5jb2xsZWN0aW9uLmRhdGE7XG4gICAgICAvLyBmaWx0ZXIgZGF0YSBsZW5ndGhcbiAgICAgIHZhciBpID0gMCxcbiAgICAgICAgbGVuID0gMDtcblxuICAgICAgLy8gUXVlcnkgZXhlY3V0ZWQgZGlmZmVyZW50bHkgZGVwZW5kaW5nIG9uIDpcbiAgICAgIC8vICAgIC0gd2hldGhlciB0aGUgcHJvcGVydHkgYmVpbmcgcXVlcmllZCBoYXMgYW4gaW5kZXggZGVmaW5lZFxuICAgICAgLy8gICAgLSBpZiBjaGFpbmVkLCB3ZSBoYW5kbGUgZmlyc3QgcGFzcyBkaWZmZXJlbnRseSBmb3IgaW5pdGlhbCBmaWx0ZXJlZHJvd3NbXSBwb3B1bGF0aW9uXG4gICAgICAvL1xuICAgICAgLy8gRm9yIHBlcmZvcm1hbmNlIHJlYXNvbnMsIGVhY2ggY2FzZSBoYXMgaXRzIG93biBpZiBibG9jayB0byBtaW5pbWl6ZSBpbi1sb29wIGNhbGN1bGF0aW9uc1xuXG4gICAgICB2YXIgZmlsdGVyLCByb3dJZHggPSAwO1xuXG4gICAgICAvLyBJZiB0aGUgZmlsdGVyZWRyb3dzW10gaXMgYWxyZWFkeSBpbml0aWFsaXplZCwgdXNlIGl0XG4gICAgICBpZiAodGhpcy5maWx0ZXJJbml0aWFsaXplZCkge1xuICAgICAgICBmaWx0ZXIgPSB0aGlzLmZpbHRlcmVkcm93cztcbiAgICAgICAgbGVuID0gZmlsdGVyLmxlbmd0aDtcblxuICAgICAgICAvLyBjdXJyZW50bHkgc3VwcG9ydGluZyBkb3Qgbm90YXRpb24gZm9yIG5vbi1pbmRleGVkIGNvbmRpdGlvbnMgb25seVxuICAgICAgICBpZiAodXNpbmdEb3ROb3RhdGlvbikge1xuICAgICAgICAgIHByb3BlcnR5ID0gcHJvcGVydHkuc3BsaXQoJy4nKTtcbiAgICAgICAgICBmb3IoaT0wOyBpPGxlbjsgaSsrKSB7XG4gICAgICAgICAgICByb3dJZHggPSBmaWx0ZXJbaV07XG4gICAgICAgICAgICBpZiAoZG90U3ViU2Nhbih0W3Jvd0lkeF0sIHByb3BlcnR5LCBmdW4sIHZhbHVlKSkge1xuICAgICAgICAgICAgICByZXN1bHQucHVzaChyb3dJZHgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBmb3IoaT0wOyBpPGxlbjsgaSsrKSB7XG4gICAgICAgICAgICByb3dJZHggPSBmaWx0ZXJbaV07XG4gICAgICAgICAgICBpZiAoZnVuKHRbcm93SWR4XVtwcm9wZXJ0eV0sIHZhbHVlKSkge1xuICAgICAgICAgICAgICByZXN1bHQucHVzaChyb3dJZHgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgLy8gZmlyc3QgY2hhaW5lZCBxdWVyeSBzbyB3b3JrIGFnYWluc3QgZGF0YVtdIGJ1dCBwdXQgcmVzdWx0cyBpbiBmaWx0ZXJlZHJvd3NcbiAgICAgIGVsc2Uge1xuICAgICAgICAvLyBpZiBub3Qgc2VhcmNoaW5nIGJ5IGluZGV4XG4gICAgICAgIGlmICghc2VhcmNoQnlJbmRleCkge1xuICAgICAgICAgIGxlbiA9IHQubGVuZ3RoO1xuXG4gICAgICAgICAgaWYgKHVzaW5nRG90Tm90YXRpb24pIHtcbiAgICAgICAgICAgIHByb3BlcnR5ID0gcHJvcGVydHkuc3BsaXQoJy4nKTtcbiAgICAgICAgICAgIGZvcihpPTA7IGk8bGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgaWYgKGRvdFN1YlNjYW4odFtpXSwgcHJvcGVydHksIGZ1biwgdmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goaSk7XG4gICAgICAgICAgICAgICAgaWYgKGZpcnN0T25seSkge1xuICAgICAgICAgICAgICAgICAgdGhpcy5maWx0ZXJlZHJvd3MgPSByZXN1bHQ7XG4gICAgICAgICAgICAgICAgICB0aGlzLmZpbHRlckluaXRpYWxpemVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBmb3IoaT0wOyBpPGxlbjsgaSsrKSB7XG4gICAgICAgICAgICAgIGlmIChmdW4odFtpXVtwcm9wZXJ0eV0sIHZhbHVlKSkge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKGkpO1xuICAgICAgICAgICAgICAgIGlmIChmaXJzdE9ubHkpIHtcbiAgICAgICAgICAgICAgICAgIHRoaXMuZmlsdGVyZWRyb3dzID0gcmVzdWx0O1xuICAgICAgICAgICAgICAgICAgdGhpcy5maWx0ZXJJbml0aWFsaXplZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gc2VhcmNoIGJ5IGluZGV4XG4gICAgICAgICAgdmFyIHNlZ20gPSB0aGlzLmNvbGxlY3Rpb24uY2FsY3VsYXRlUmFuZ2Uob3BlcmF0b3IsIHByb3BlcnR5LCB2YWx1ZSk7XG5cbiAgICAgICAgICBpZiAob3BlcmF0b3IgIT09ICckaW4nKSB7XG4gICAgICAgICAgICBmb3IgKGkgPSBzZWdtWzBdOyBpIDw9IHNlZ21bMV07IGkrKykge1xuICAgICAgICAgICAgICBpZiAoaW5kZXhlZE9wc1tvcGVyYXRvcl0gIT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAvLyBtdXN0IGJlIGEgZnVuY3Rpb24sIGltcGx5aW5nIDJuZCBwaGFzZSBmaWx0ZXJpbmcgb2YgcmVzdWx0cyBmcm9tIGNhbGN1bGF0ZVJhbmdlXG4gICAgICAgICAgICAgICAgaWYgKGluZGV4ZWRPcHNbb3BlcmF0b3JdKFV0aWxzLmdldEluKHRbaW5kZXgudmFsdWVzW2ldXSwgcHJvcGVydHksIHVzaW5nRG90Tm90YXRpb24pLCB2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKGluZGV4LnZhbHVlc1tpXSk7XG4gICAgICAgICAgICAgICAgICBpZiAoZmlyc3RPbmx5KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsdGVyZWRyb3dzID0gcmVzdWx0O1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbHRlckluaXRpYWxpemVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goaW5kZXgudmFsdWVzW2ldKTtcbiAgICAgICAgICAgICAgICAgIGlmIChmaXJzdE9ubHkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maWx0ZXJlZHJvd3MgPSByZXN1bHQ7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsdGVySW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBmb3IgKGkgPSAwLCBsZW4gPSBzZWdtLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICAgIHJlc3VsdC5wdXNoKGluZGV4LnZhbHVlc1tzZWdtW2ldXSk7XG4gICAgICAgICAgICAgIGlmIChmaXJzdE9ubHkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZpbHRlcmVkcm93cyA9IHJlc3VsdDtcbiAgICAgICAgICAgICAgICB0aGlzLmZpbHRlckluaXRpYWxpemVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICB9XG5cbiAgICAgIHRoaXMuZmlsdGVyZWRyb3dzID0gcmVzdWx0O1xuICAgICAgdGhpcy5maWx0ZXJJbml0aWFsaXplZCA9IHRydWU7IC8vIG5leHQgdGltZSB3b3JrIGFnYWluc3QgZmlsdGVyZWRyb3dzW11cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG5cblxuICAgIC8qKlxuICAgICAqIHdoZXJlKCkgLSBVc2VkIGZvciBmaWx0ZXJpbmcgdmlhIGEgamF2YXNjcmlwdCBmaWx0ZXIgZnVuY3Rpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBmdW4gLSBBIGphdmFzY3JpcHQgZnVuY3Rpb24gdXNlZCBmb3IgZmlsdGVyaW5nIGN1cnJlbnQgcmVzdWx0cyBieS5cbiAgICAgKiBAcmV0dXJucyB7UmVzdWx0c2V0fSB0aGlzIHJlc3VsdHNldCBmb3IgZnVydGhlciBjaGFpbiBvcHMuXG4gICAgICogQG1lbWJlcm9mIFJlc3VsdHNldFxuICAgICAqIEBleGFtcGxlXG4gICAgICogdmFyIG92ZXIzMCA9IHVzZXJzLmNoYWluKCkud2hlcmUoZnVuY3Rpb24ob2JqKSB7IHJldHVybiBvYmouYWdlID49IDMwOyB9LmRhdGEoKTtcbiAgICAgKi9cbiAgICBSZXN1bHRzZXQucHJvdG90eXBlLndoZXJlID0gZnVuY3Rpb24gKGZ1bikge1xuICAgICAgdmFyIHZpZXdGdW5jdGlvbixcbiAgICAgICAgcmVzdWx0ID0gW107XG5cbiAgICAgIGlmICgnZnVuY3Rpb24nID09PSB0eXBlb2YgZnVuKSB7XG4gICAgICAgIHZpZXdGdW5jdGlvbiA9IGZ1bjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0FyZ3VtZW50IGlzIG5vdCBhIHN0b3JlZCB2aWV3IG9yIGEgZnVuY3Rpb24nKTtcbiAgICAgIH1cbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIElmIHRoZSBmaWx0ZXJlZHJvd3NbXSBpcyBhbHJlYWR5IGluaXRpYWxpemVkLCB1c2UgaXRcbiAgICAgICAgaWYgKHRoaXMuZmlsdGVySW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICB2YXIgaiA9IHRoaXMuZmlsdGVyZWRyb3dzLmxlbmd0aDtcblxuICAgICAgICAgIHdoaWxlIChqLS0pIHtcbiAgICAgICAgICAgIGlmICh2aWV3RnVuY3Rpb24odGhpcy5jb2xsZWN0aW9uLmRhdGFbdGhpcy5maWx0ZXJlZHJvd3Nbal1dKSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICByZXN1bHQucHVzaCh0aGlzLmZpbHRlcmVkcm93c1tqXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdGhpcy5maWx0ZXJlZHJvd3MgPSByZXN1bHQ7XG5cbiAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgICAgICAvLyBvdGhlcndpc2UgdGhpcyBpcyBpbml0aWFsIGNoYWluZWQgb3AsIHdvcmsgYWdhaW5zdCBkYXRhLCBwdXNoIGludG8gZmlsdGVyZWRyb3dzW11cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgdmFyIGsgPSB0aGlzLmNvbGxlY3Rpb24uZGF0YS5sZW5ndGg7XG5cbiAgICAgICAgICB3aGlsZSAoay0tKSB7XG4gICAgICAgICAgICBpZiAodmlld0Z1bmN0aW9uKHRoaXMuY29sbGVjdGlvbi5kYXRhW2tdKSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICByZXN1bHQucHVzaChrKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICB0aGlzLmZpbHRlcmVkcm93cyA9IHJlc3VsdDtcbiAgICAgICAgICB0aGlzLmZpbHRlckluaXRpYWxpemVkID0gdHJ1ZTtcblxuICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBjb3VudCgpIC0gcmV0dXJucyB0aGUgbnVtYmVyIG9mIGRvY3VtZW50cyBpbiB0aGUgcmVzdWx0c2V0LlxuICAgICAqXG4gICAgICogQHJldHVybnMge251bWJlcn0gVGhlIG51bWJlciBvZiBkb2N1bWVudHMgaW4gdGhlIHJlc3VsdHNldC5cbiAgICAgKiBAbWVtYmVyb2YgUmVzdWx0c2V0XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiB2YXIgb3ZlcjMwQ291bnQgPSB1c2Vycy5jaGFpbigpLmZpbmQoeyBhZ2U6IHsgJGd0ZTogMzAgfSB9KS5jb3VudCgpO1xuICAgICAqL1xuICAgIFJlc3VsdHNldC5wcm90b3R5cGUuY291bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAodGhpcy5maWx0ZXJJbml0aWFsaXplZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5maWx0ZXJlZHJvd3MubGVuZ3RoO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMuY29sbGVjdGlvbi5jb3VudCgpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBUZXJtaW5hdGVzIHRoZSBjaGFpbiBhbmQgcmV0dXJucyBhcnJheSBvZiBmaWx0ZXJlZCBkb2N1bWVudHNcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7b2JqZWN0PX0gb3B0aW9ucyAtIGFsbG93cyBzcGVjaWZ5aW5nICdmb3JjZUNsb25lcycgYW5kICdmb3JjZUNsb25lTWV0aG9kJyBvcHRpb25zLlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gb3B0aW9ucy5mb3JjZUNsb25lcyAtIEFsbG93cyBmb3JjaW5nIHRoZSByZXR1cm4gb2YgY2xvbmVkIG9iamVjdHMgZXZlbiB3aGVuXG4gICAgICogICAgICAgIHRoZSBjb2xsZWN0aW9uIGlzIG5vdCBjb25maWd1cmVkIGZvciBjbG9uZSBvYmplY3QuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG9wdGlvbnMuZm9yY2VDbG9uZU1ldGhvZCAtIEFsbG93cyBvdmVycmlkaW5nIHRoZSBkZWZhdWx0IG9yIGNvbGxlY3Rpb24gc3BlY2lmaWVkIGNsb25pbmcgbWV0aG9kLlxuICAgICAqICAgICAgICBQb3NzaWJsZSB2YWx1ZXMgaW5jbHVkZSAncGFyc2Utc3RyaW5naWZ5JywgJ2pxdWVyeS1leHRlbmQtZGVlcCcsICdzaGFsbG93JywgJ3NoYWxsb3ctYXNzaWduJ1xuICAgICAqIEBwYXJhbSB7Ym9vbH0gb3B0aW9ucy5yZW1vdmVNZXRhIC0gV2lsbCBmb3JjZSBjbG9uZXMgYW5kIHN0cmlwICRsb2tpIGFuZCBtZXRhIHByb3BlcnRpZXMgZnJvbSBkb2N1bWVudHNcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHthcnJheX0gQXJyYXkgb2YgZG9jdW1lbnRzIGluIHRoZSByZXN1bHRzZXRcbiAgICAgKiBAbWVtYmVyb2YgUmVzdWx0c2V0XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiB2YXIgcmVzdXRscyA9IHVzZXJzLmNoYWluKCkuZmluZCh7IGFnZTogMzQgfSkuZGF0YSgpO1xuICAgICAqL1xuICAgIFJlc3VsdHNldC5wcm90b3R5cGUuZGF0YSA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gICAgICB2YXIgcmVzdWx0ID0gW10sXG4gICAgICAgIGRhdGEgPSB0aGlzLmNvbGxlY3Rpb24uZGF0YSxcbiAgICAgICAgb2JqLFxuICAgICAgICBsZW4sXG4gICAgICAgIGksXG4gICAgICAgIG1ldGhvZDtcblxuICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cbiAgICAgIC8vIGlmIHVzZXIgb3B0cyB0byBzdHJpcCBtZXRhLCB0aGVuIGZvcmNlIGNsb25lcyBhbmQgdXNlICdzaGFsbG93JyBpZiAnZm9yY2UnIG9wdGlvbnMgYXJlIG5vdCBwcmVzZW50XG4gICAgICBpZiAob3B0aW9ucy5yZW1vdmVNZXRhICYmICFvcHRpb25zLmZvcmNlQ2xvbmVzKSB7XG4gICAgICAgIG9wdGlvbnMuZm9yY2VDbG9uZXMgPSB0cnVlO1xuICAgICAgICBvcHRpb25zLmZvcmNlQ2xvbmVNZXRob2QgPSBvcHRpb25zLmZvcmNlQ2xvbmVNZXRob2QgfHwgJ3NoYWxsb3cnO1xuICAgICAgfVxuXG4gICAgICAvLyBpZiBjb2xsZWN0aW9uIGhhcyBkZWx0YSBjaGFuZ2VzIGFjdGl2ZSwgdGhlbiBmb3JjZSBjbG9uZXMgYW5kIHVzZSAncGFyc2Utc3RyaW5naWZ5JyBmb3IgZWZmZWN0aXZlIGNoYW5nZSB0cmFja2luZyBvZiBuZXN0ZWQgb2JqZWN0c1xuICAgICAgaWYgKCF0aGlzLmNvbGxlY3Rpb24uZGlzYWJsZURlbHRhQ2hhbmdlc0FwaSkge1xuICAgICAgICBvcHRpb25zLmZvcmNlQ2xvbmVzID0gdHJ1ZTtcbiAgICAgICAgb3B0aW9ucy5mb3JjZUNsb25lTWV0aG9kID0gJ3BhcnNlLXN0cmluZ2lmeSc7XG4gICAgICB9XG5cbiAgICAgIC8vIGlmIHRoaXMgaGFzIG5vIGZpbHRlcnMgYXBwbGllZCwganVzdCByZXR1cm4gY29sbGVjdGlvbi5kYXRhXG4gICAgICBpZiAoIXRoaXMuZmlsdGVySW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgaWYgKHRoaXMuZmlsdGVyZWRyb3dzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgIC8vIGRldGVybWluZSB3aGV0aGVyIHdlIG5lZWQgdG8gY2xvbmUgb2JqZWN0cyBvciBub3RcbiAgICAgICAgICBpZiAodGhpcy5jb2xsZWN0aW9uLmNsb25lT2JqZWN0cyB8fCBvcHRpb25zLmZvcmNlQ2xvbmVzKSB7XG4gICAgICAgICAgICBsZW4gPSBkYXRhLmxlbmd0aDtcbiAgICAgICAgICAgIG1ldGhvZCA9IG9wdGlvbnMuZm9yY2VDbG9uZU1ldGhvZCB8fCB0aGlzLmNvbGxlY3Rpb24uY2xvbmVNZXRob2Q7XG5cbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgICBvYmogPSBjbG9uZShkYXRhW2ldLCBtZXRob2QpO1xuICAgICAgICAgICAgICBpZiAob3B0aW9ucy5yZW1vdmVNZXRhKSB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIG9iai4kbG9raTtcbiAgICAgICAgICAgICAgICBkZWxldGUgb2JqLm1ldGE7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcmVzdWx0LnB1c2gob2JqKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8vIG90aGVyd2lzZSB3ZSBhcmUgbm90IGNsb25pbmcgc28gcmV0dXJuIHNsaWNlZCBhcnJheSB3aXRoIHNhbWUgb2JqZWN0IHJlZmVyZW5jZXNcbiAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBkYXRhLnNsaWNlKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIGZpbHRlcmVkcm93cyBtdXN0IGhhdmUgYmVlbiBzZXQgbWFudWFsbHksIHNvIHVzZSBpdFxuICAgICAgICAgIHRoaXMuZmlsdGVySW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHZhciBmciA9IHRoaXMuZmlsdGVyZWRyb3dzO1xuICAgICAgbGVuID0gZnIubGVuZ3RoO1xuXG4gICAgICBpZiAodGhpcy5jb2xsZWN0aW9uLmNsb25lT2JqZWN0cyB8fCBvcHRpb25zLmZvcmNlQ2xvbmVzKSB7XG4gICAgICAgIG1ldGhvZCA9IG9wdGlvbnMuZm9yY2VDbG9uZU1ldGhvZCB8fCB0aGlzLmNvbGxlY3Rpb24uY2xvbmVNZXRob2Q7XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgIG9iaiA9IGNsb25lKGRhdGFbZnJbaV1dLCBtZXRob2QpO1xuICAgICAgICAgIGlmIChvcHRpb25zLnJlbW92ZU1ldGEpIHtcbiAgICAgICAgICAgIGRlbGV0ZSBvYmouJGxva2k7XG4gICAgICAgICAgICBkZWxldGUgb2JqLm1ldGE7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJlc3VsdC5wdXNoKG9iaik7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgIHJlc3VsdC5wdXNoKGRhdGFbZnJbaV1dKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogVXNlZCB0byBydW4gYW4gdXBkYXRlIG9wZXJhdGlvbiBvbiBhbGwgZG9jdW1lbnRzIGN1cnJlbnRseSBpbiB0aGUgcmVzdWx0c2V0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbn0gdXBkYXRlRnVuY3Rpb24gLSBVc2VyIHN1cHBsaWVkIHVwZGF0ZUZ1bmN0aW9uKG9iaikgd2lsbCBiZSBleGVjdXRlZCBmb3IgZWFjaCBkb2N1bWVudCBvYmplY3QuXG4gICAgICogQHJldHVybnMge1Jlc3VsdHNldH0gdGhpcyByZXN1bHRzZXQgZm9yIGZ1cnRoZXIgY2hhaW4gb3BzLlxuICAgICAqIEBtZW1iZXJvZiBSZXN1bHRzZXRcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIHVzZXJzLmNoYWluKCkuZmluZCh7IGNvdW50cnk6ICdkZScgfSkudXBkYXRlKGZ1bmN0aW9uKHVzZXIpIHtcbiAgICAgKiAgIHVzZXIucGhvbmVGb3JtYXQgPSBcIis0OSBBQUFBIEJCQkJCQlwiO1xuICAgICAqIH0pO1xuICAgICAqL1xuICAgIFJlc3VsdHNldC5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKHVwZGF0ZUZ1bmN0aW9uKSB7XG5cbiAgICAgIGlmICh0eXBlb2YgKHVwZGF0ZUZ1bmN0aW9uKSAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0FyZ3VtZW50IGlzIG5vdCBhIGZ1bmN0aW9uJyk7XG4gICAgICB9XG5cbiAgICAgIC8vIGlmIHRoaXMgaGFzIG5vIGZpbHRlcnMgYXBwbGllZCwgd2UgbmVlZCB0byBwb3B1bGF0ZSBmaWx0ZXJlZHJvd3MgZmlyc3RcbiAgICAgIGlmICghdGhpcy5maWx0ZXJJbml0aWFsaXplZCAmJiB0aGlzLmZpbHRlcmVkcm93cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgdGhpcy5maWx0ZXJlZHJvd3MgPSB0aGlzLmNvbGxlY3Rpb24ucHJlcGFyZUZ1bGxEb2NJbmRleCgpO1xuICAgICAgfVxuXG4gICAgICB2YXIgb2JqLCBsZW4gPSB0aGlzLmZpbHRlcmVkcm93cy5sZW5ndGgsXG4gICAgICAgIHJjZCA9IHRoaXMuY29sbGVjdGlvbi5kYXRhO1xuXG4gICAgICAvLyBwYXNzIGluIGVhY2ggZG9jdW1lbnQgb2JqZWN0IGN1cnJlbnRseSBpbiByZXN1bHRzZXQgdG8gdXNlciBzdXBwbGllZCB1cGRhdGVGdW5jdGlvblxuICAgICAgZm9yICh2YXIgaWR4ID0gMDsgaWR4IDwgbGVuOyBpZHgrKykge1xuICAgICAgICAvLyBpZiB3ZSBoYXZlIGNsb25pbmcgb3B0aW9uIHNwZWNpZmllZCBvciBhcmUgZG9pbmcgZGlmZmVyZW50aWFsIGRlbHRhIGNoYW5nZXMsIGNsb25lIG9iamVjdCBmaXJzdFxuICAgICAgICBpZiAodGhpcy5jb2xsZWN0aW9uLmNsb25lT2JqZWN0cyB8fCAhdGhpcy5jb2xsZWN0aW9uLmRpc2FibGVEZWx0YUNoYW5nZXNBcGkpIHtcbiAgICAgICAgICBvYmogPSBjbG9uZShyY2RbdGhpcy5maWx0ZXJlZHJvd3NbaWR4XV0sIHRoaXMuY29sbGVjdGlvbi5jbG9uZU1ldGhvZCk7XG4gICAgICAgICAgdXBkYXRlRnVuY3Rpb24ob2JqKTtcbiAgICAgICAgICB0aGlzLmNvbGxlY3Rpb24udXBkYXRlKG9iaik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgLy8gbm8gbmVlZCB0byBjbG9uZSwgc28ganVzdCBwZXJmb3JtIHVwZGF0ZSBvbiBjb2xsZWN0aW9uIGRhdGEgb2JqZWN0IGluc3RhbmNlXG4gICAgICAgICAgdXBkYXRlRnVuY3Rpb24ocmNkW3RoaXMuZmlsdGVyZWRyb3dzW2lkeF1dKTtcbiAgICAgICAgICB0aGlzLmNvbGxlY3Rpb24udXBkYXRlKHJjZFt0aGlzLmZpbHRlcmVkcm93c1tpZHhdXSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgYWxsIGRvY3VtZW50IG9iamVjdHMgd2hpY2ggYXJlIGN1cnJlbnRseSBpbiByZXN1bHRzZXQgZnJvbSBjb2xsZWN0aW9uIChhcyB3ZWxsIGFzIHJlc3VsdHNldClcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtSZXN1bHRzZXR9IHRoaXMgKGVtcHR5KSByZXN1bHRzZXQgZm9yIGZ1cnRoZXIgY2hhaW4gb3BzLlxuICAgICAqIEBtZW1iZXJvZiBSZXN1bHRzZXRcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIHJlbW92ZSB1c2VycyBpbmFjdGl2ZSBzaW5jZSAxLzEvMjAwMVxuICAgICAqIHVzZXJzLmNoYWluKCkuZmluZCh7IGxhc3RBY3RpdmU6IHsgJGx0ZTogbmV3IERhdGUoXCIxLzEvMjAwMVwiKS5nZXRUaW1lKCkgfSB9KS5yZW1vdmUoKTtcbiAgICAgKi9cbiAgICBSZXN1bHRzZXQucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uICgpIHtcblxuICAgICAgLy8gaWYgdGhpcyBoYXMgbm8gZmlsdGVycyBhcHBsaWVkLCB3ZSBuZWVkIHRvIHBvcHVsYXRlIGZpbHRlcmVkcm93cyBmaXJzdFxuICAgICAgaWYgKCF0aGlzLmZpbHRlckluaXRpYWxpemVkICYmIHRoaXMuZmlsdGVyZWRyb3dzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICB0aGlzLmZpbHRlcmVkcm93cyA9IHRoaXMuY29sbGVjdGlvbi5wcmVwYXJlRnVsbERvY0luZGV4KCk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuY29sbGVjdGlvbi5yZW1vdmVCYXRjaEJ5UG9zaXRpb25zKHRoaXMuZmlsdGVyZWRyb3dzKTtcblxuICAgICAgdGhpcy5maWx0ZXJlZHJvd3MgPSBbXTtcblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIGRhdGEgdHJhbnNmb3JtYXRpb24gdmlhIHVzZXIgc3VwcGxpZWQgZnVuY3Rpb25zXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBtYXBGdW5jdGlvbiAtIHRoaXMgZnVuY3Rpb24gYWNjZXB0cyBhIHNpbmdsZSBkb2N1bWVudCBmb3IgeW91IHRvIHRyYW5zZm9ybSBhbmQgcmV0dXJuXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbn0gcmVkdWNlRnVuY3Rpb24gLSB0aGlzIGZ1bmN0aW9uIGFjY2VwdHMgbWFueSAoYXJyYXkgb2YgbWFwIG91dHB1dHMpIGFuZCByZXR1cm5zIHNpbmdsZSB2YWx1ZVxuICAgICAqIEByZXR1cm5zIHt2YWx1ZX0gVGhlIG91dHB1dCBvZiB5b3VyIHJlZHVjZUZ1bmN0aW9uXG4gICAgICogQG1lbWJlcm9mIFJlc3VsdHNldFxuICAgICAqIEBleGFtcGxlXG4gICAgICogdmFyIGRiID0gbmV3IGxva2koXCJvcmRlci5kYlwiKTtcbiAgICAgKiB2YXIgb3JkZXJzID0gZGIuYWRkQ29sbGVjdGlvbihcIm9yZGVyc1wiKTtcbiAgICAgKiBvcmRlcnMuaW5zZXJ0KFt7IHF0eTogNCwgdW5pdENvc3Q6IDEwMC4wMCB9LCB7IHF0eTogMTAsIHVuaXRDb3N0OiA5OTkuOTkgfSwgeyBxdHk6IDIsIHVuaXRDb3N0OiA0OS45OSB9XSk7XG4gICAgICpcbiAgICAgKiBmdW5jdGlvbiBtYXBmdW4gKG9iaikgeyByZXR1cm4gb2JqLnF0eSpvYmoudW5pdENvc3QgfTtcbiAgICAgKiBmdW5jdGlvbiByZWR1Y2VmdW4oYXJyYXkpIHtcbiAgICAgKiAgIHZhciBncmFuZFRvdGFsPTA7XG4gICAgICogICBhcnJheS5mb3JFYWNoKGZ1bmN0aW9uKG9yZGVyVG90YWwpIHsgZ3JhbmRUb3RhbCArPSBvcmRlclRvdGFsOyB9KTtcbiAgICAgKiAgIHJldHVybiBncmFuZFRvdGFsO1xuICAgICAqIH1cbiAgICAgKiB2YXIgZ3JhbmRPcmRlclRvdGFsID0gb3JkZXJzLmNoYWluKCkubWFwUmVkdWNlKG1hcGZ1biwgcmVkdWNlZnVuKTtcbiAgICAgKiBjb25zb2xlLmxvZyhncmFuZE9yZGVyVG90YWwpO1xuICAgICAqL1xuICAgIFJlc3VsdHNldC5wcm90b3R5cGUubWFwUmVkdWNlID0gZnVuY3Rpb24gKG1hcEZ1bmN0aW9uLCByZWR1Y2VGdW5jdGlvbikge1xuICAgICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIHJlZHVjZUZ1bmN0aW9uKHRoaXMuZGF0YSgpLm1hcChtYXBGdW5jdGlvbikpO1xuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHRocm93IGVycjtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogZXFKb2luKCkgLSBMZWZ0IGpvaW5pbmcgdHdvIHNldHMgb2YgZGF0YS4gSm9pbiBrZXlzIGNhbiBiZSBkZWZpbmVkIG9yIGNhbGN1bGF0ZWQgcHJvcGVydGllc1xuICAgICAqIGVxSm9pbiBleHBlY3RzIHRoZSByaWdodCBqb2luIGtleSB2YWx1ZXMgdG8gYmUgdW5pcXVlLiAgT3RoZXJ3aXNlIGxlZnQgZGF0YSB3aWxsIGJlIGpvaW5lZCBvbiB0aGUgbGFzdCBqb2luRGF0YSBvYmplY3Qgd2l0aCB0aGF0IGtleVxuICAgICAqIEBwYXJhbSB7QXJyYXl8UmVzdWx0c2V0fENvbGxlY3Rpb259IGpvaW5EYXRhIC0gRGF0YSBhcnJheSB0byBqb2luIHRvLlxuICAgICAqIEBwYXJhbSB7KHN0cmluZ3xmdW5jdGlvbil9IGxlZnRKb2luS2V5IC0gUHJvcGVydHkgbmFtZSBpbiB0aGlzIHJlc3VsdCBzZXQgdG8gam9pbiBvbiBvciBhIGZ1bmN0aW9uIHRvIHByb2R1Y2UgYSB2YWx1ZSB0byBqb2luIG9uXG4gICAgICogQHBhcmFtIHsoc3RyaW5nfGZ1bmN0aW9uKX0gcmlnaHRKb2luS2V5IC0gUHJvcGVydHkgbmFtZSBpbiB0aGUgam9pbkRhdGEgdG8gam9pbiBvbiBvciBhIGZ1bmN0aW9uIHRvIHByb2R1Y2UgYSB2YWx1ZSB0byBqb2luIG9uXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbj19IG1hcEZ1biAtIChPcHRpb25hbCkgQSBmdW5jdGlvbiB0aGF0IHJlY2VpdmVzIGVhY2ggbWF0Y2hpbmcgcGFpciBhbmQgbWFwcyB0aGVtIGludG8gb3V0cHV0IG9iamVjdHMgLSBmdW5jdGlvbihsZWZ0LHJpZ2h0KXtyZXR1cm4gam9pbmVkT2JqZWN0fVxuICAgICAqIEBwYXJhbSB7b2JqZWN0PX0gZGF0YU9wdGlvbnMgLSBvcHRpb25zIHRvIGRhdGEoKSBiZWZvcmUgaW5wdXQgdG8geW91ciBtYXAgZnVuY3Rpb25cbiAgICAgKiBAcGFyYW0ge2Jvb2x9IGRhdGFPcHRpb25zLnJlbW92ZU1ldGEgLSBhbGxvd3MgcmVtb3ZpbmcgbWV0YSBiZWZvcmUgY2FsbGluZyBtYXBGdW5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IGRhdGFPcHRpb25zLmZvcmNlQ2xvbmVzIC0gZm9yY2luZyB0aGUgcmV0dXJuIG9mIGNsb25lZCBvYmplY3RzIHRvIHlvdXIgbWFwIG9iamVjdFxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBkYXRhT3B0aW9ucy5mb3JjZUNsb25lTWV0aG9kIC0gQWxsb3dzIG92ZXJyaWRpbmcgdGhlIGRlZmF1bHQgb3IgY29sbGVjdGlvbiBzcGVjaWZpZWQgY2xvbmluZyBtZXRob2QuXG4gICAgICogQHJldHVybnMge1Jlc3VsdHNldH0gQSByZXN1bHRzZXQgd2l0aCBkYXRhIGluIHRoZSBmb3JtYXQgW3tsZWZ0OiBsZWZ0T2JqLCByaWdodDogcmlnaHRPYmp9XVxuICAgICAqIEBtZW1iZXJvZiBSZXN1bHRzZXRcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIHZhciBkYiA9IG5ldyBsb2tpKCdzYW5kYm94LmRiJyk7XG4gICAgICpcbiAgICAgKiB2YXIgcHJvZHVjdHMgPSBkYi5hZGRDb2xsZWN0aW9uKCdwcm9kdWN0cycpO1xuICAgICAqIHZhciBvcmRlcnMgPSBkYi5hZGRDb2xsZWN0aW9uKCdvcmRlcnMnKTtcbiAgICAgKlxuICAgICAqIHByb2R1Y3RzLmluc2VydCh7IHByb2R1Y3RJZDogXCIxMDAyMzRcIiwgbmFtZTogXCJmbHl3aGVlbCBlbmVyZ3kgc3RvcmFnZVwiLCB1bml0Q29zdDogMTk5OTkuOTkgfSk7XG4gICAgICogcHJvZHVjdHMuaW5zZXJ0KHsgcHJvZHVjdElkOiBcIjE0MDQ5MVwiLCBuYW1lOiBcIjMwMEYgc3VwZXIgY2FwYWNpdG9yXCIsIHVuaXRDb3N0OiAxMjkuOTkgfSk7XG4gICAgICogcHJvZHVjdHMuaW5zZXJ0KHsgcHJvZHVjdElkOiBcIjI3MTk0MVwiLCBuYW1lOiBcImZ1ZWwgY2VsbFwiLCB1bml0Q29zdDogMzk5OS45OSB9KTtcbiAgICAgKiBwcm9kdWN0cy5pbnNlcnQoeyBwcm9kdWN0SWQ6IFwiMTc0NTkyXCIsIG5hbWU6IFwiMzkwViAzQUggbGl0aGl1bSBiYW5rXCIsIHVuaXRDb3N0OiA0OTk5Ljk5IH0pO1xuICAgICAqXG4gICAgICogb3JkZXJzLmluc2VydCh7IG9yZGVyRGF0ZSA6IG5ldyBEYXRlKFwiMTIvMS8yMDE3XCIpLmdldFRpbWUoKSwgcHJvZElkOiBcIjE3NDU5MlwiLCBxdHk6IDIsIGN1c3RvbWVySWQ6IDIgfSk7XG4gICAgICogb3JkZXJzLmluc2VydCh7IG9yZGVyRGF0ZSA6IG5ldyBEYXRlKFwiNC8xNS8yMDE2XCIpLmdldFRpbWUoKSwgcHJvZElkOiBcIjI3MTk0MVwiLCBxdHk6IDEsIGN1c3RvbWVySWQ6IDEgfSk7XG4gICAgICogb3JkZXJzLmluc2VydCh7IG9yZGVyRGF0ZSA6IG5ldyBEYXRlKFwiMy8xMi8yMDE3XCIpLmdldFRpbWUoKSwgcHJvZElkOiBcIjE0MDQ5MVwiLCBxdHk6IDQsIGN1c3RvbWVySWQ6IDQgfSk7XG4gICAgICogb3JkZXJzLmluc2VydCh7IG9yZGVyRGF0ZSA6IG5ldyBEYXRlKFwiNy8zMS8yMDE3XCIpLmdldFRpbWUoKSwgcHJvZElkOiBcIjEwMDIzNFwiLCBxdHk6IDcsIGN1c3RvbWVySWQ6IDMgfSk7XG4gICAgICogb3JkZXJzLmluc2VydCh7IG9yZGVyRGF0ZSA6IG5ldyBEYXRlKFwiOC8zLzIwMTZcIikuZ2V0VGltZSgpLCBwcm9kSWQ6IFwiMTc0NTkyXCIsIHF0eTogMywgY3VzdG9tZXJJZDogNSB9KTtcbiAgICAgKlxuICAgICAqIHZhciBtYXBmdW4gPSBmdW5jdGlvbihsZWZ0LCByaWdodCkge1xuICAgICAqICAgcmV0dXJuIHtcbiAgICAgKiAgICAgb3JkZXJJZDogbGVmdC4kbG9raSxcbiAgICAgKiAgICAgb3JkZXJEYXRlOiBuZXcgRGF0ZShsZWZ0Lm9yZGVyRGF0ZSkgKyAnJyxcbiAgICAgKiAgICAgY3VzdG9tZXJJZDogbGVmdC5jdXN0b21lcklkLFxuICAgICAqICAgICBxdHk6IGxlZnQucXR5LFxuICAgICAqICAgICBwcm9kdWN0SWQ6IGxlZnQucHJvZElkLFxuICAgICAqICAgICBwcm9kTmFtZTogcmlnaHQubmFtZSxcbiAgICAgKiAgICAgcHJvZENvc3Q6IHJpZ2h0LnVuaXRDb3N0LFxuICAgICAqICAgICBvcmRlclRvdGFsOiArKChyaWdodC51bml0Q29zdCAqIGxlZnQucXR5KS50b0ZpeGVkKDIpKVxuICAgICAqICAgfTtcbiAgICAgKiB9O1xuICAgICAqXG4gICAgICogLy8gam9pbiBvcmRlcnMgd2l0aCByZWxldmFudCBwcm9kdWN0IGluZm8gdmlhIGVxSm9pblxuICAgICAqIHZhciBvcmRlclN1bW1hcnkgPSBvcmRlcnMuY2hhaW4oKS5lcUpvaW4ocHJvZHVjdHMsIFwicHJvZElkXCIsIFwicHJvZHVjdElkXCIsIG1hcGZ1bikuZGF0YSgpO1xuICAgICAqIFxuICAgICAqIGNvbnNvbGUubG9nKG9yZGVyU3VtbWFyeSk7ICAgICBcbiAgICAgKi9cbiAgICBSZXN1bHRzZXQucHJvdG90eXBlLmVxSm9pbiA9IGZ1bmN0aW9uIChqb2luRGF0YSwgbGVmdEpvaW5LZXksIHJpZ2h0Sm9pbktleSwgbWFwRnVuLCBkYXRhT3B0aW9ucykge1xuXG4gICAgICB2YXIgbGVmdERhdGEgPSBbXSxcbiAgICAgICAgbGVmdERhdGFMZW5ndGgsXG4gICAgICAgIHJpZ2h0RGF0YSA9IFtdLFxuICAgICAgICByaWdodERhdGFMZW5ndGgsXG4gICAgICAgIGtleSxcbiAgICAgICAgcmVzdWx0ID0gW10sXG4gICAgICAgIGxlZnRLZXlpc0Z1bmN0aW9uID0gdHlwZW9mIGxlZnRKb2luS2V5ID09PSAnZnVuY3Rpb24nLFxuICAgICAgICByaWdodEtleWlzRnVuY3Rpb24gPSB0eXBlb2YgcmlnaHRKb2luS2V5ID09PSAnZnVuY3Rpb24nLFxuICAgICAgICBqb2luTWFwID0ge307XG5cbiAgICAgIC8vZ2V0IHRoZSBsZWZ0IGRhdGFcbiAgICAgIGxlZnREYXRhID0gdGhpcy5kYXRhKGRhdGFPcHRpb25zKTtcbiAgICAgIGxlZnREYXRhTGVuZ3RoID0gbGVmdERhdGEubGVuZ3RoO1xuXG4gICAgICAvL2dldCB0aGUgcmlnaHQgZGF0YVxuICAgICAgaWYgKGpvaW5EYXRhIGluc3RhbmNlb2YgQ29sbGVjdGlvbikge1xuICAgICAgICByaWdodERhdGEgPSBqb2luRGF0YS5jaGFpbigpLmRhdGEoZGF0YU9wdGlvbnMpO1xuICAgICAgfSBlbHNlIGlmIChqb2luRGF0YSBpbnN0YW5jZW9mIFJlc3VsdHNldCkge1xuICAgICAgICByaWdodERhdGEgPSBqb2luRGF0YS5kYXRhKGRhdGFPcHRpb25zKTtcbiAgICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShqb2luRGF0YSkpIHtcbiAgICAgICAgcmlnaHREYXRhID0gam9pbkRhdGE7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdqb2luRGF0YSBuZWVkcyB0byBiZSBhbiBhcnJheSBvciByZXN1bHQgc2V0Jyk7XG4gICAgICB9XG4gICAgICByaWdodERhdGFMZW5ndGggPSByaWdodERhdGEubGVuZ3RoO1xuXG4gICAgICAvL2NvbnN0cnVjdCBhIGxvb2t1cCB0YWJsZVxuXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJpZ2h0RGF0YUxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGtleSA9IHJpZ2h0S2V5aXNGdW5jdGlvbiA/IHJpZ2h0Sm9pbktleShyaWdodERhdGFbaV0pIDogcmlnaHREYXRhW2ldW3JpZ2h0Sm9pbktleV07XG4gICAgICAgIGpvaW5NYXBba2V5XSA9IHJpZ2h0RGF0YVtpXTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFtYXBGdW4pIHtcbiAgICAgICAgbWFwRnVuID0gZnVuY3Rpb24gKGxlZnQsIHJpZ2h0KSB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGxlZnQ6IGxlZnQsXG4gICAgICAgICAgICByaWdodDogcmlnaHRcbiAgICAgICAgICB9O1xuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICAvL1J1biBtYXAgZnVuY3Rpb24gb3ZlciBlYWNoIG9iamVjdCBpbiB0aGUgcmVzdWx0c2V0XG4gICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGxlZnREYXRhTGVuZ3RoOyBqKyspIHtcbiAgICAgICAga2V5ID0gbGVmdEtleWlzRnVuY3Rpb24gPyBsZWZ0Sm9pbktleShsZWZ0RGF0YVtqXSkgOiBsZWZ0RGF0YVtqXVtsZWZ0Sm9pbktleV07XG4gICAgICAgIHJlc3VsdC5wdXNoKG1hcEZ1bihsZWZ0RGF0YVtqXSwgam9pbk1hcFtrZXldIHx8IHt9KSk7XG4gICAgICB9XG5cbiAgICAgIC8vcmV0dXJuIHJldHVybiBhIG5ldyByZXN1bHRzZXQgd2l0aCBubyBmaWx0ZXJzXG4gICAgICB0aGlzLmNvbGxlY3Rpb24gPSBuZXcgQ29sbGVjdGlvbignam9pbkRhdGEnKTtcbiAgICAgIHRoaXMuY29sbGVjdGlvbi5pbnNlcnQocmVzdWx0KTtcbiAgICAgIHRoaXMuZmlsdGVyZWRyb3dzID0gW107XG4gICAgICB0aGlzLmZpbHRlckluaXRpYWxpemVkID0gZmFsc2U7XG5cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBBcHBsaWVzIGEgbWFwIGZ1bmN0aW9uIGludG8gYSBuZXcgY29sbGVjdGlvbiBmb3IgZnVydGhlciBjaGFpbmluZy5cbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBtYXBGdW4gLSBqYXZhc2NyaXB0IG1hcCBmdW5jdGlvblxuICAgICAqIEBwYXJhbSB7b2JqZWN0PX0gZGF0YU9wdGlvbnMgLSBvcHRpb25zIHRvIGRhdGEoKSBiZWZvcmUgaW5wdXQgdG8geW91ciBtYXAgZnVuY3Rpb25cbiAgICAgKiBAcGFyYW0ge2Jvb2x9IGRhdGFPcHRpb25zLnJlbW92ZU1ldGEgLSBhbGxvd3MgcmVtb3ZpbmcgbWV0YSBiZWZvcmUgY2FsbGluZyBtYXBGdW5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IGRhdGFPcHRpb25zLmZvcmNlQ2xvbmVzIC0gZm9yY2luZyB0aGUgcmV0dXJuIG9mIGNsb25lZCBvYmplY3RzIHRvIHlvdXIgbWFwIG9iamVjdFxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBkYXRhT3B0aW9ucy5mb3JjZUNsb25lTWV0aG9kIC0gQWxsb3dzIG92ZXJyaWRpbmcgdGhlIGRlZmF1bHQgb3IgY29sbGVjdGlvbiBzcGVjaWZpZWQgY2xvbmluZyBtZXRob2QuXG4gICAgICogQG1lbWJlcm9mIFJlc3VsdHNldFxuICAgICAqIEBleGFtcGxlXG4gICAgICogdmFyIG9yZGVycy5jaGFpbigpLmZpbmQoeyBwcm9kdWN0SWQ6IDMyIH0pLm1hcChmdW5jdGlvbihvYmopIHtcbiAgICAgKiAgIHJldHVybiB7XG4gICAgICogICAgIG9yZGVySWQ6ICRsb2tpLFxuICAgICAqICAgICBwcm9kdWN0SWQ6IHByb2R1Y3RJZCxcbiAgICAgKiAgICAgcXVhbnRpdHk6IHF0eVxuICAgICAqICAgfTtcbiAgICAgKiB9KTtcbiAgICAgKi9cbiAgICBSZXN1bHRzZXQucHJvdG90eXBlLm1hcCA9IGZ1bmN0aW9uIChtYXBGdW4sIGRhdGFPcHRpb25zKSB7XG4gICAgICB2YXIgZGF0YSA9IHRoaXMuZGF0YShkYXRhT3B0aW9ucykubWFwKG1hcEZ1bik7XG4gICAgICAvL3JldHVybiByZXR1cm4gYSBuZXcgcmVzdWx0c2V0IHdpdGggbm8gZmlsdGVyc1xuICAgICAgdGhpcy5jb2xsZWN0aW9uID0gbmV3IENvbGxlY3Rpb24oJ21hcHBlZERhdGEnKTtcbiAgICAgIHRoaXMuY29sbGVjdGlvbi5pbnNlcnQoZGF0YSk7XG4gICAgICB0aGlzLmZpbHRlcmVkcm93cyA9IFtdO1xuICAgICAgdGhpcy5maWx0ZXJJbml0aWFsaXplZCA9IGZhbHNlO1xuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogRHluYW1pY1ZpZXcgY2xhc3MgaXMgYSB2ZXJzYXRpbGUgJ2xpdmUnIHZpZXcgY2xhc3Mgd2hpY2ggY2FuIGhhdmUgZmlsdGVycyBhbmQgc29ydHMgYXBwbGllZC5cbiAgICAgKiAgICBDb2xsZWN0aW9uLmFkZER5bmFtaWNWaWV3KG5hbWUpIGluc3RhbnRpYXRlcyB0aGlzIER5bmFtaWNWaWV3IG9iamVjdCBhbmQgbm90aWZpZXMgaXRcbiAgICAgKiAgICB3aGVuZXZlciBkb2N1bWVudHMgYXJlIGFkZC91cGRhdGVkL3JlbW92ZWQgc28gaXQgY2FuIHJlbWFpbiB1cC10by1kYXRlLiAoY2hhaW5hYmxlKVxuICAgICAqXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiB2YXIgbXlkdiA9IG15Y29sbGVjdGlvbi5hZGREeW5hbWljVmlldygndGVzdCcpOyAgLy8gZGVmYXVsdCBpcyBub24tcGVyc2lzdGVudFxuICAgICAqIG15ZHYuYXBwbHlGaW5kKHsgJ2Rvb3JzJyA6IDQgfSk7XG4gICAgICogbXlkdi5hcHBseVdoZXJlKGZ1bmN0aW9uKG9iaikgeyByZXR1cm4gb2JqLm5hbWUgPT09ICdUb3lvdGEnOyB9KTtcbiAgICAgKiB2YXIgcmVzdWx0cyA9IG15ZHYuZGF0YSgpO1xuICAgICAqXG4gICAgICogQGNvbnN0cnVjdG9yIER5bmFtaWNWaWV3XG4gICAgICogQGltcGxlbWVudHMgTG9raUV2ZW50RW1pdHRlclxuICAgICAqIEBwYXJhbSB7Q29sbGVjdGlvbn0gY29sbGVjdGlvbiAtIEEgcmVmZXJlbmNlIHRvIHRoZSBjb2xsZWN0aW9uIHRvIHdvcmsgYWdhaW5zdFxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIC0gVGhlIG5hbWUgb2YgdGhpcyBkeW5hbWljIHZpZXdcbiAgICAgKiBAcGFyYW0ge29iamVjdD19IG9wdGlvbnMgLSAoT3B0aW9uYWwpIFBhc3MgaW4gb2JqZWN0IHdpdGggJ3BlcnNpc3RlbnQnIGFuZC9vciAnc29ydFByaW9yaXR5JyBvcHRpb25zLlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMucGVyc2lzdGVudD1mYWxzZV0gLSBpbmRpY2F0ZXMgaWYgdmlldyBpcyB0byBtYWluIGludGVybmFsIHJlc3VsdHMgYXJyYXkgaW4gJ3Jlc3VsdGRhdGEnXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFtvcHRpb25zLnNvcnRQcmlvcml0eT0ncGFzc2l2ZSddIC0gJ3Bhc3NpdmUnIChzb3J0cyBwZXJmb3JtZWQgb24gY2FsbCB0byBkYXRhKSBvciAnYWN0aXZlJyAoYWZ0ZXIgdXBkYXRlcylcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gb3B0aW9ucy5taW5SZWJ1aWxkSW50ZXJ2YWwgLSBtaW5pbXVtIHJlYnVpbGQgaW50ZXJ2YWwgKG5lZWQgY2xhcmlmaWNhdGlvbiB0byBkb2NzIGhlcmUpXG4gICAgICogQHNlZSB7QGxpbmsgQ29sbGVjdGlvbiNhZGREeW5hbWljVmlld30gdG8gY29uc3RydWN0IGluc3RhbmNlcyBvZiBEeW5hbWljVmlld1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIER5bmFtaWNWaWV3KGNvbGxlY3Rpb24sIG5hbWUsIG9wdGlvbnMpIHtcbiAgICAgIHRoaXMuY29sbGVjdGlvbiA9IGNvbGxlY3Rpb247XG4gICAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgICAgdGhpcy5yZWJ1aWxkUGVuZGluZyA9IGZhbHNlO1xuICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblxuICAgICAgaWYgKCF0aGlzLm9wdGlvbnMuaGFzT3duUHJvcGVydHkoJ3BlcnNpc3RlbnQnKSkge1xuICAgICAgICB0aGlzLm9wdGlvbnMucGVyc2lzdGVudCA9IGZhbHNlO1xuICAgICAgfVxuXG4gICAgICAvLyAncGVyc2lzdGVudFNvcnRQcmlvcml0eSc6XG4gICAgICAvLyAncGFzc2l2ZScgd2lsbCBkZWZlciB0aGUgc29ydCBwaGFzZSB1bnRpbCB0aGV5IGNhbGwgZGF0YSgpLiAobW9zdCBlZmZpY2llbnQgb3ZlcmFsbClcbiAgICAgIC8vICdhY3RpdmUnIHdpbGwgc29ydCBhc3luYyB3aGVuZXZlciBuZXh0IGlkbGUuIChwcmlvcml0aXplcyByZWFkIHNwZWVkcylcbiAgICAgIGlmICghdGhpcy5vcHRpb25zLmhhc093blByb3BlcnR5KCdzb3J0UHJpb3JpdHknKSkge1xuICAgICAgICB0aGlzLm9wdGlvbnMuc29ydFByaW9yaXR5ID0gJ3Bhc3NpdmUnO1xuICAgICAgfVxuXG4gICAgICBpZiAoIXRoaXMub3B0aW9ucy5oYXNPd25Qcm9wZXJ0eSgnbWluUmVidWlsZEludGVydmFsJykpIHtcbiAgICAgICAgdGhpcy5vcHRpb25zLm1pblJlYnVpbGRJbnRlcnZhbCA9IDE7XG4gICAgICB9XG5cbiAgICAgIHRoaXMucmVzdWx0c2V0ID0gbmV3IFJlc3VsdHNldChjb2xsZWN0aW9uKTtcbiAgICAgIHRoaXMucmVzdWx0ZGF0YSA9IFtdO1xuICAgICAgdGhpcy5yZXN1bHRzZGlydHkgPSBmYWxzZTtcblxuICAgICAgdGhpcy5jYWNoZWRyZXN1bHRzZXQgPSBudWxsO1xuXG4gICAgICAvLyBrZWVwIG9yZGVyZWQgZmlsdGVyIHBpcGVsaW5lXG4gICAgICB0aGlzLmZpbHRlclBpcGVsaW5lID0gW107XG5cbiAgICAgIC8vIHNvcnRpbmcgbWVtYmVyIHZhcmlhYmxlc1xuICAgICAgLy8gd2Ugb25seSBzdXBwb3J0IG9uZSBhY3RpdmUgc2VhcmNoLCBhcHBsaWVkIHVzaW5nIGFwcGx5U29ydCgpIG9yIGFwcGx5U2ltcGxlU29ydCgpXG4gICAgICB0aGlzLnNvcnRGdW5jdGlvbiA9IG51bGw7XG4gICAgICB0aGlzLnNvcnRDcml0ZXJpYSA9IG51bGw7XG4gICAgICB0aGlzLnNvcnRDcml0ZXJpYVNpbXBsZSA9IG51bGw7XG4gICAgICB0aGlzLnNvcnREaXJ0eSA9IGZhbHNlO1xuXG4gICAgICAvLyBmb3Igbm93IGp1c3QgaGF2ZSAxIGV2ZW50IGZvciB3aGVuIHdlIGZpbmFsbHkgcmVidWlsdCBsYXp5IHZpZXdcbiAgICAgIC8vIG9uY2Ugd2UgcmVmYWN0b3IgdHJhbnNhY3Rpb25zLCBpIHdpbGwgdGllIGluIGNlcnRhaW4gdHJhbnNhY3Rpb25hbCBldmVudHNcblxuICAgICAgdGhpcy5ldmVudHMgPSB7XG4gICAgICAgICdyZWJ1aWxkJzogW11cbiAgICAgIH07XG4gICAgfVxuXG4gICAgRHluYW1pY1ZpZXcucHJvdG90eXBlID0gbmV3IExva2lFdmVudEVtaXR0ZXIoKTtcblxuXG4gICAgLyoqXG4gICAgICogcmVtYXRlcmlhbGl6ZSgpIC0gaW50ZXJuYWxseSB1c2VkIGltbWVkaWF0ZWx5IGFmdGVyIGRlc2VyaWFsaXphdGlvbiAobG9hZGluZylcbiAgICAgKiAgICBUaGlzIHdpbGwgY2xlYXIgb3V0IGFuZCByZWFwcGx5IGZpbHRlclBpcGVsaW5lIG9wcywgcmVjcmVhdGluZyB0aGUgdmlldy5cbiAgICAgKiAgICBTaW5jZSB3aGVyZSBmaWx0ZXJzIGRvIG5vdCBwZXJzaXN0IGNvcnJlY3RseSwgdGhpcyBtZXRob2QgYWxsb3dzXG4gICAgICogICAgcmVzdG9yaW5nIHRoZSB2aWV3IHRvIHN0YXRlIHdoZXJlIHVzZXIgY2FuIHJlLWFwcGx5IHRob3NlIHdoZXJlIGZpbHRlcnMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge09iamVjdD19IG9wdGlvbnMgLSAoT3B0aW9uYWwpIGFsbG93cyBzcGVjaWZpY2F0aW9uIG9mICdyZW1vdmVXaGVyZUZpbHRlcnMnIG9wdGlvblxuICAgICAqIEByZXR1cm5zIHtEeW5hbWljVmlld30gVGhpcyBkeW5hbWljIHZpZXcgZm9yIGZ1cnRoZXIgY2hhaW5lZCBvcHMuXG4gICAgICogQG1lbWJlcm9mIER5bmFtaWNWaWV3XG4gICAgICogQGZpcmVzIER5bmFtaWNWaWV3LnJlYnVpbGRcbiAgICAgKi9cbiAgICBEeW5hbWljVmlldy5wcm90b3R5cGUucmVtYXRlcmlhbGl6ZSA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gICAgICB2YXIgZnBsLFxuICAgICAgICBmcGksXG4gICAgICAgIGlkeDtcblxuICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cbiAgICAgIHRoaXMucmVzdWx0ZGF0YSA9IFtdO1xuICAgICAgdGhpcy5yZXN1bHRzZGlydHkgPSB0cnVlO1xuICAgICAgdGhpcy5yZXN1bHRzZXQgPSBuZXcgUmVzdWx0c2V0KHRoaXMuY29sbGVjdGlvbik7XG5cbiAgICAgIGlmICh0aGlzLnNvcnRGdW5jdGlvbiB8fCB0aGlzLnNvcnRDcml0ZXJpYSB8fCB0aGlzLnNvcnRDcml0ZXJpYVNpbXBsZSkge1xuICAgICAgICB0aGlzLnNvcnREaXJ0eSA9IHRydWU7XG4gICAgICB9XG5cbiAgICAgIGlmIChvcHRpb25zLmhhc093blByb3BlcnR5KCdyZW1vdmVXaGVyZUZpbHRlcnMnKSkge1xuICAgICAgICAvLyBmb3IgZWFjaCB2aWV3IHNlZSBpZiBpdCBoYWQgYW55IHdoZXJlIGZpbHRlcnMgYXBwbGllZC4uLiBzaW5jZSB0aGV5IGRvbid0XG4gICAgICAgIC8vIHNlcmlhbGl6ZSB0aG9zZSBmdW5jdGlvbnMgbGV0cyByZW1vdmUgdGhvc2UgaW52YWxpZCBmaWx0ZXJzXG4gICAgICAgIGZwbCA9IHRoaXMuZmlsdGVyUGlwZWxpbmUubGVuZ3RoO1xuICAgICAgICBmcGkgPSBmcGw7XG4gICAgICAgIHdoaWxlIChmcGktLSkge1xuICAgICAgICAgIGlmICh0aGlzLmZpbHRlclBpcGVsaW5lW2ZwaV0udHlwZSA9PT0gJ3doZXJlJykge1xuICAgICAgICAgICAgaWYgKGZwaSAhPT0gdGhpcy5maWx0ZXJQaXBlbGluZS5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgIHRoaXMuZmlsdGVyUGlwZWxpbmVbZnBpXSA9IHRoaXMuZmlsdGVyUGlwZWxpbmVbdGhpcy5maWx0ZXJQaXBlbGluZS5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5maWx0ZXJQaXBlbGluZS5sZW5ndGgtLTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gYmFjayB1cCBvbGQgZmlsdGVyIHBpcGVsaW5lLCBjbGVhciBmaWx0ZXIgcGlwZWxpbmUsIGFuZCByZWFwcGx5IHBpcGVsaW5lIG9wc1xuICAgICAgdmFyIG9mcCA9IHRoaXMuZmlsdGVyUGlwZWxpbmU7XG4gICAgICB0aGlzLmZpbHRlclBpcGVsaW5lID0gW107XG5cbiAgICAgIC8vIG5vdyByZS1hcHBseSAnZmluZCcgZmlsdGVyUGlwZWxpbmUgb3BzXG4gICAgICBmcGwgPSBvZnAubGVuZ3RoO1xuICAgICAgZm9yIChpZHggPSAwOyBpZHggPCBmcGw7IGlkeCsrKSB7XG4gICAgICAgIHRoaXMuYXBwbHlGaW5kKG9mcFtpZHhdLnZhbCk7XG4gICAgICB9XG5cbiAgICAgIC8vIGR1cmluZyBjcmVhdGlvbiBvZiB1bml0IHRlc3RzLCBpIHdpbGwgcmVtb3ZlIHRoaXMgZm9yY2VkIHJlZnJlc2ggYW5kIGxlYXZlIGxhenlcbiAgICAgIHRoaXMuZGF0YSgpO1xuXG4gICAgICAvLyBlbWl0IHJlYnVpbGQgZXZlbnQgaW4gY2FzZSB1c2VyIHdhbnRzIHRvIGJlIG5vdGlmaWVkXG4gICAgICB0aGlzLmVtaXQoJ3JlYnVpbGQnLCB0aGlzKTtcblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIGJyYW5jaFJlc3VsdHNldCgpIC0gTWFrZXMgYSBjb3B5IG9mIHRoZSBpbnRlcm5hbCByZXN1bHRzZXQgZm9yIGJyYW5jaGVkIHF1ZXJpZXMuXG4gICAgICogICAgVW5saWtlIHRoaXMgZHluYW1pYyB2aWV3LCB0aGUgYnJhbmNoZWQgcmVzdWx0c2V0IHdpbGwgbm90IGJlICdsaXZlJyB1cGRhdGVkLFxuICAgICAqICAgIHNvIHlvdXIgYnJhbmNoZWQgcXVlcnkgc2hvdWxkIGJlIGltbWVkaWF0ZWx5IHJlc29sdmVkIGFuZCBub3QgaGVsZCBmb3IgZnV0dXJlIGV2YWx1YXRpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0geyhzdHJpbmd8YXJyYXk9KX0gdHJhbnNmb3JtIC0gT3B0aW9uYWwgbmFtZSBvZiBjb2xsZWN0aW9uIHRyYW5zZm9ybSwgb3IgYW4gYXJyYXkgb2YgdHJhbnNmb3JtIHN0ZXBzXG4gICAgICogQHBhcmFtIHtvYmplY3Q9fSBwYXJhbWV0ZXJzIC0gb3B0aW9uYWwgcGFyYW1ldGVycyAoaWYgb3B0aW9uYWwgdHJhbnNmb3JtIHJlcXVpcmVzIHRoZW0pXG4gICAgICogQHJldHVybnMge1Jlc3VsdHNldH0gQSBjb3B5IG9mIHRoZSBpbnRlcm5hbCByZXN1bHRzZXQgZm9yIGJyYW5jaGVkIHF1ZXJpZXMuXG4gICAgICogQG1lbWJlcm9mIER5bmFtaWNWaWV3XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiB2YXIgZGIgPSBuZXcgbG9raSgndGVzdCcpO1xuICAgICAqIHZhciBjb2xsID0gZGIuYWRkQ29sbGVjdGlvbignbXlkb2NzJyk7XG4gICAgICogdmFyIGR2ID0gY29sbC5hZGREeW5hbWljVmlldygnbXl2aWV3Jyk7XG4gICAgICogdmFyIHR4ID0gW1xuICAgICAqICAge1xuICAgICAqICAgICB0eXBlOiAnb2Zmc2V0JyxcbiAgICAgKiAgICAgdmFsdWU6ICdbJWxrdHhwXXBhZ2VTdGFydCdcbiAgICAgKiAgIH0sXG4gICAgICogICB7XG4gICAgICogICAgIHR5cGU6ICdsaW1pdCcsXG4gICAgICogICAgIHZhbHVlOiAnWyVsa3R4cF1wYWdlU2l6ZSdcbiAgICAgKiAgIH1cbiAgICAgKiBdO1xuICAgICAqIGNvbGwuYWRkVHJhbnNmb3JtKCd2aWV3UGFnaW5nJywgdHgpO1xuICAgICAqIFxuICAgICAqIC8vIGFkZCBzb21lIHJlY29yZHNcbiAgICAgKiBcbiAgICAgKiB2YXIgcmVzdWx0cyA9IGR2LmJyYW5jaFJlc3VsdHNldCgndmlld1BhZ2luZycsIHsgcGFnZVN0YXJ0OiAxMCwgcGFnZVNpemU6IDEwIH0pLmRhdGEoKTsgICAgIFxuICAgICAqL1xuICAgIER5bmFtaWNWaWV3LnByb3RvdHlwZS5icmFuY2hSZXN1bHRzZXQgPSBmdW5jdGlvbiAodHJhbnNmb3JtLCBwYXJhbWV0ZXJzKSB7XG4gICAgICB2YXIgcnMgPSB0aGlzLnJlc3VsdHNldC5icmFuY2goKTtcblxuICAgICAgaWYgKHR5cGVvZiB0cmFuc2Zvcm0gPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHJldHVybiBycztcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHJzLnRyYW5zZm9ybSh0cmFuc2Zvcm0sIHBhcmFtZXRlcnMpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiB0b0pTT04oKSAtIE92ZXJyaWRlIG9mIHRvSlNPTiB0byBhdm9pZCBjaXJjdWxhciByZWZlcmVuY2VzXG4gICAgICpcbiAgICAgKi9cbiAgICBEeW5hbWljVmlldy5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIGNvcHkgPSBuZXcgRHluYW1pY1ZpZXcodGhpcy5jb2xsZWN0aW9uLCB0aGlzLm5hbWUsIHRoaXMub3B0aW9ucyk7XG5cbiAgICAgIGNvcHkucmVzdWx0c2V0ID0gdGhpcy5yZXN1bHRzZXQ7XG4gICAgICBjb3B5LnJlc3VsdGRhdGEgPSBbXTsgLy8gbGV0J3Mgbm90IHNhdmUgZGF0YSAoY29weSkgdG8gbWluaW1pemUgc2l6ZVxuICAgICAgY29weS5yZXN1bHRzZGlydHkgPSB0cnVlO1xuICAgICAgY29weS5maWx0ZXJQaXBlbGluZSA9IHRoaXMuZmlsdGVyUGlwZWxpbmU7XG4gICAgICBjb3B5LnNvcnRGdW5jdGlvbiA9IHRoaXMuc29ydEZ1bmN0aW9uO1xuICAgICAgY29weS5zb3J0Q3JpdGVyaWEgPSB0aGlzLnNvcnRDcml0ZXJpYTtcbiAgICAgIGNvcHkuc29ydENyaXRlcmlhU2ltcGxlID0gdGhpcy5zb3J0Q3JpdGVyaWFTaW1wbGUgfHwgbnVsbDtcbiAgICAgIGNvcHkuc29ydERpcnR5ID0gdGhpcy5zb3J0RGlydHk7XG5cbiAgICAgIC8vIGF2b2lkIGNpcmN1bGFyIHJlZmVyZW5jZSwgcmVhcHBseSBpbiBkYi5sb2FkSlNPTigpXG4gICAgICBjb3B5LmNvbGxlY3Rpb24gPSBudWxsO1xuXG4gICAgICByZXR1cm4gY29weTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogcmVtb3ZlRmlsdGVycygpIC0gVXNlZCB0byBjbGVhciBwaXBlbGluZSBhbmQgcmVzZXQgZHluYW1pYyB2aWV3IHRvIGluaXRpYWwgc3RhdGUuXG4gICAgICogICAgIEV4aXN0aW5nIG9wdGlvbnMgc2hvdWxkIGJlIHJldGFpbmVkLlxuICAgICAqIEBwYXJhbSB7b2JqZWN0PX0gb3B0aW9ucyAtIGNvbmZpZ3VyZSByZW1vdmVGaWx0ZXIgYmVoYXZpb3JcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW49fSBvcHRpb25zLnF1ZXVlU29ydFBoYXNlIC0gKGRlZmF1bHQ6IGZhbHNlKSBpZiB0cnVlIHdlIHdpbGwgYXN5bmMgcmVidWlsZCB2aWV3IChtYXliZSBzZXQgZGVmYXVsdCB0byB0cnVlIGluIGZ1dHVyZT8pXG4gICAgICogQG1lbWJlcm9mIER5bmFtaWNWaWV3XG4gICAgICovXG4gICAgRHluYW1pY1ZpZXcucHJvdG90eXBlLnJlbW92ZUZpbHRlcnMgPSBmdW5jdGlvbiAob3B0aW9ucykge1xuICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cbiAgICAgIHRoaXMucmVidWlsZFBlbmRpbmcgPSBmYWxzZTtcbiAgICAgIHRoaXMucmVzdWx0c2V0LnJlc2V0KCk7XG4gICAgICB0aGlzLnJlc3VsdGRhdGEgPSBbXTtcbiAgICAgIHRoaXMucmVzdWx0c2RpcnR5ID0gdHJ1ZTtcblxuICAgICAgdGhpcy5jYWNoZWRyZXN1bHRzZXQgPSBudWxsO1xuXG4gICAgICAvLyBrZWVwIG9yZGVyZWQgZmlsdGVyIHBpcGVsaW5lXG4gICAgICB0aGlzLmZpbHRlclBpcGVsaW5lID0gW107XG5cbiAgICAgIC8vIHNvcnRpbmcgbWVtYmVyIHZhcmlhYmxlc1xuICAgICAgLy8gd2Ugb25seSBzdXBwb3J0IG9uZSBhY3RpdmUgc2VhcmNoLCBhcHBsaWVkIHVzaW5nIGFwcGx5U29ydCgpIG9yIGFwcGx5U2ltcGxlU29ydCgpXG4gICAgICB0aGlzLnNvcnRGdW5jdGlvbiA9IG51bGw7XG4gICAgICB0aGlzLnNvcnRDcml0ZXJpYSA9IG51bGw7XG4gICAgICB0aGlzLnNvcnRDcml0ZXJpYVNpbXBsZSA9IG51bGw7XG4gICAgICB0aGlzLnNvcnREaXJ0eSA9IGZhbHNlO1xuXG4gICAgICBpZiAob3B0aW9ucy5xdWV1ZVNvcnRQaGFzZSA9PT0gdHJ1ZSkge1xuICAgICAgICB0aGlzLnF1ZXVlU29ydFBoYXNlKCk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIGFwcGx5U29ydCgpIC0gVXNlZCB0byBhcHBseSBhIHNvcnQgdG8gdGhlIGR5bmFtaWMgdmlld1xuICAgICAqIEBleGFtcGxlXG4gICAgICogZHYuYXBwbHlTb3J0KGZ1bmN0aW9uKG9iajEsIG9iajIpIHtcbiAgICAgKiAgIGlmIChvYmoxLm5hbWUgPT09IG9iajIubmFtZSkgcmV0dXJuIDA7XG4gICAgICogICBpZiAob2JqMS5uYW1lID4gb2JqMi5uYW1lKSByZXR1cm4gMTtcbiAgICAgKiAgIGlmIChvYmoxLm5hbWUgPCBvYmoyLm5hbWUpIHJldHVybiAtMTtcbiAgICAgKiB9KTtcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IGNvbXBhcmVmdW4gLSBhIGphdmFzY3JpcHQgY29tcGFyZSBmdW5jdGlvbiB1c2VkIGZvciBzb3J0aW5nXG4gICAgICogQHJldHVybnMge0R5bmFtaWNWaWV3fSB0aGlzIER5bmFtaWNWaWV3IG9iamVjdCwgZm9yIGZ1cnRoZXIgY2hhaW4gb3BzLlxuICAgICAqIEBtZW1iZXJvZiBEeW5hbWljVmlld1xuICAgICAqL1xuICAgIER5bmFtaWNWaWV3LnByb3RvdHlwZS5hcHBseVNvcnQgPSBmdW5jdGlvbiAoY29tcGFyZWZ1bikge1xuICAgICAgdGhpcy5zb3J0RnVuY3Rpb24gPSBjb21wYXJlZnVuO1xuICAgICAgdGhpcy5zb3J0Q3JpdGVyaWEgPSBudWxsO1xuICAgICAgdGhpcy5zb3J0Q3JpdGVyaWFTaW1wbGUgPSBudWxsO1xuXG4gICAgICB0aGlzLnF1ZXVlU29ydFBoYXNlKCk7XG5cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBhcHBseVNpbXBsZVNvcnQoKSAtIFVzZWQgdG8gc3BlY2lmeSBhIHByb3BlcnR5IHVzZWQgZm9yIHZpZXcgdHJhbnNsYXRpb24uXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBkdi5hcHBseVNpbXBsZVNvcnQoXCJuYW1lXCIpO1xuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHByb3BuYW1lIC0gTmFtZSBvZiBwcm9wZXJ0eSBieSB3aGljaCB0byBzb3J0LlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fGJvb2xlYW49fSBvcHRpb25zIC0gYm9vbGVhbiBmb3Igc29ydCBkZXNjZW5kaW5nIG9yIG9wdGlvbnMgb2JqZWN0XG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5kZXNjPWZhbHNlXSAtIHdoZXRoZXIgd2Ugc2hvdWxkIHNvcnQgZGVzY2VuZGluZy5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLmRpc2FibGVJbmRleEludGVyc2VjdD1mYWxzZV0gLSB3aGV0aGVyIHdlIHNob3VsZCBleHBsaWNpdHkgbm90IHVzZSBhcnJheSBpbnRlcnNlY3Rpb24uXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5mb3JjZUluZGV4SW50ZXJzZWN0PWZhbHNlXSAtIGZvcmNlIGFycmF5IGludGVyc2VjdGlvbiAoaWYgYmluYXJ5IGluZGV4IGV4aXN0cykuXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy51c2VKYXZhc2NyaXB0U29ydGluZz1mYWxzZV0gLSB3aGV0aGVyIHJlc3VsdHMgYXJlIHNvcnRlZCB2aWEgYmFzaWMgamF2YXNjcmlwdCBzb3J0LlxuICAgICAqIEByZXR1cm5zIHtEeW5hbWljVmlld30gdGhpcyBEeW5hbWljVmlldyBvYmplY3QsIGZvciBmdXJ0aGVyIGNoYWluIG9wcy5cbiAgICAgKiBAbWVtYmVyb2YgRHluYW1pY1ZpZXdcbiAgICAgKi9cbiAgICBEeW5hbWljVmlldy5wcm90b3R5cGUuYXBwbHlTaW1wbGVTb3J0ID0gZnVuY3Rpb24gKHByb3BuYW1lLCBvcHRpb25zKSB7XG4gICAgICB0aGlzLnNvcnRDcml0ZXJpYVNpbXBsZSA9IHsgcHJvcG5hbWU6IHByb3BuYW1lLCBvcHRpb25zOiBvcHRpb25zIHx8IGZhbHNlIH07XG4gICAgICB0aGlzLnNvcnRDcml0ZXJpYSA9IG51bGw7XG4gICAgICB0aGlzLnNvcnRGdW5jdGlvbiA9IG51bGw7XG5cbiAgICAgIHRoaXMucXVldWVTb3J0UGhhc2UoKTtcblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIGFwcGx5U29ydENyaXRlcmlhKCkgLSBBbGxvd3Mgc29ydGluZyBhIHJlc3VsdHNldCBiYXNlZCBvbiBtdWx0aXBsZSBjb2x1bW5zLlxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gdG8gc29ydCBieSBhZ2UgYW5kIHRoZW4gbmFtZSAoYm90aCBhc2NlbmRpbmcpXG4gICAgICogZHYuYXBwbHlTb3J0Q3JpdGVyaWEoWydhZ2UnLCAnbmFtZSddKTtcbiAgICAgKiAvLyB0byBzb3J0IGJ5IGFnZSAoYXNjZW5kaW5nKSBhbmQgdGhlbiBieSBuYW1lIChkZXNjZW5kaW5nKVxuICAgICAqIGR2LmFwcGx5U29ydENyaXRlcmlhKFsnYWdlJywgWyduYW1lJywgdHJ1ZV0pO1xuICAgICAqIC8vIHRvIHNvcnQgYnkgYWdlIChkZXNjZW5kaW5nKSBhbmQgdGhlbiBieSBuYW1lIChkZXNjZW5kaW5nKVxuICAgICAqIGR2LmFwcGx5U29ydENyaXRlcmlhKFsnYWdlJywgdHJ1ZV0sIFsnbmFtZScsIHRydWVdKTtcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7YXJyYXl9IHByb3BlcnRpZXMgLSBhcnJheSBvZiBwcm9wZXJ0eSBuYW1lcyBvciBzdWJhcnJheSBvZiBbcHJvcGVydHluYW1lLCBpc2Rlc2NdIHVzZWQgZXZhbHVhdGUgc29ydCBvcmRlclxuICAgICAqIEByZXR1cm5zIHtEeW5hbWljVmlld30gUmVmZXJlbmNlIHRvIHRoaXMgRHluYW1pY1ZpZXcsIHNvcnRlZCwgZm9yIGZ1dHVyZSBjaGFpbiBvcGVyYXRpb25zLlxuICAgICAqIEBtZW1iZXJvZiBEeW5hbWljVmlld1xuICAgICAqL1xuICAgIER5bmFtaWNWaWV3LnByb3RvdHlwZS5hcHBseVNvcnRDcml0ZXJpYSA9IGZ1bmN0aW9uIChjcml0ZXJpYSkge1xuICAgICAgdGhpcy5zb3J0Q3JpdGVyaWEgPSBjcml0ZXJpYTtcbiAgICAgIHRoaXMuc29ydENyaXRlcmlhU2ltcGxlID0gbnVsbDtcbiAgICAgIHRoaXMuc29ydEZ1bmN0aW9uID0gbnVsbDtcblxuICAgICAgdGhpcy5xdWV1ZVNvcnRQaGFzZSgpO1xuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogc3RhcnRUcmFuc2FjdGlvbigpIC0gbWFya3MgdGhlIGJlZ2lubmluZyBvZiBhIHRyYW5zYWN0aW9uLlxuICAgICAqXG4gICAgICogQHJldHVybnMge0R5bmFtaWNWaWV3fSB0aGlzIER5bmFtaWNWaWV3IG9iamVjdCwgZm9yIGZ1cnRoZXIgY2hhaW4gb3BzLlxuICAgICAqL1xuICAgIER5bmFtaWNWaWV3LnByb3RvdHlwZS5zdGFydFRyYW5zYWN0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5jYWNoZWRyZXN1bHRzZXQgPSB0aGlzLnJlc3VsdHNldC5jb3B5KCk7XG5cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBjb21taXQoKSAtIGNvbW1pdHMgYSB0cmFuc2FjdGlvbi5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtEeW5hbWljVmlld30gdGhpcyBEeW5hbWljVmlldyBvYmplY3QsIGZvciBmdXJ0aGVyIGNoYWluIG9wcy5cbiAgICAgKi9cbiAgICBEeW5hbWljVmlldy5wcm90b3R5cGUuY29tbWl0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5jYWNoZWRyZXN1bHRzZXQgPSBudWxsO1xuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogcm9sbGJhY2soKSAtIHJvbGxzIGJhY2sgYSB0cmFuc2FjdGlvbi5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtEeW5hbWljVmlld30gdGhpcyBEeW5hbWljVmlldyBvYmplY3QsIGZvciBmdXJ0aGVyIGNoYWluIG9wcy5cbiAgICAgKi9cbiAgICBEeW5hbWljVmlldy5wcm90b3R5cGUucm9sbGJhY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLnJlc3VsdHNldCA9IHRoaXMuY2FjaGVkcmVzdWx0c2V0O1xuXG4gICAgICBpZiAodGhpcy5vcHRpb25zLnBlcnNpc3RlbnQpIHtcbiAgICAgICAgLy8gZm9yIG5vdyBqdXN0IHJlYnVpbGQgdGhlIHBlcnNpc3RlbnQgZHluYW1pYyB2aWV3IGRhdGEgaW4gdGhpcyB3b3JzdCBjYXNlIHNjZW5hcmlvXG4gICAgICAgIC8vIChhIHBlcnNpc3RlbnQgdmlldyB1dGlsaXppbmcgdHJhbnNhY3Rpb25zIHdoaWNoIGdldCByb2xsZWQgYmFjayksIHdlIGFscmVhZHkga25vdyB0aGUgZmlsdGVyIHNvIG5vdCB0b28gYmFkLlxuICAgICAgICB0aGlzLnJlc3VsdGRhdGEgPSB0aGlzLnJlc3VsdHNldC5kYXRhKCk7XG5cbiAgICAgICAgdGhpcy5lbWl0KCdyZWJ1aWxkJywgdGhpcyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG5cblxuICAgIC8qKlxuICAgICAqIEltcGxlbWVudGF0aW9uIGRldGFpbC5cbiAgICAgKiBfaW5kZXhPZkZpbHRlcldpdGhJZCgpIC0gRmluZCB0aGUgaW5kZXggb2YgYSBmaWx0ZXIgaW4gdGhlIHBpcGVsaW5lLCBieSB0aGF0IGZpbHRlcidzIElELlxuICAgICAqXG4gICAgICogQHBhcmFtIHsoc3RyaW5nfG51bWJlcil9IHVpZCAtIFRoZSB1bmlxdWUgSUQgb2YgdGhlIGZpbHRlci5cbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfTogaW5kZXggb2YgdGhlIHJlZmVyZW5jZWQgZmlsdGVyIGluIHRoZSBwaXBlbGluZTsgLTEgaWYgbm90IGZvdW5kLlxuICAgICAqL1xuICAgIER5bmFtaWNWaWV3LnByb3RvdHlwZS5faW5kZXhPZkZpbHRlcldpdGhJZCA9IGZ1bmN0aW9uICh1aWQpIHtcbiAgICAgIGlmICh0eXBlb2YgdWlkID09PSAnc3RyaW5nJyB8fCB0eXBlb2YgdWlkID09PSAnbnVtYmVyJykge1xuICAgICAgICBmb3IgKHZhciBpZHggPSAwLCBsZW4gPSB0aGlzLmZpbHRlclBpcGVsaW5lLmxlbmd0aDsgaWR4IDwgbGVuOyBpZHggKz0gMSkge1xuICAgICAgICAgIGlmICh1aWQgPT09IHRoaXMuZmlsdGVyUGlwZWxpbmVbaWR4XS51aWQpIHtcbiAgICAgICAgICAgIHJldHVybiBpZHg7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gLTE7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEltcGxlbWVudGF0aW9uIGRldGFpbC5cbiAgICAgKiBfYWRkRmlsdGVyKCkgLSBBZGQgdGhlIGZpbHRlciBvYmplY3QgdG8gdGhlIGVuZCBvZiB2aWV3J3MgZmlsdGVyIHBpcGVsaW5lIGFuZCBhcHBseSB0aGUgZmlsdGVyIHRvIHRoZSByZXN1bHRzZXQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge29iamVjdH0gZmlsdGVyIC0gVGhlIGZpbHRlciBvYmplY3QuIFJlZmVyIHRvIGFwcGx5RmlsdGVyKCkgZm9yIGV4dHJhIGRldGFpbHMuXG4gICAgICovXG4gICAgRHluYW1pY1ZpZXcucHJvdG90eXBlLl9hZGRGaWx0ZXIgPSBmdW5jdGlvbiAoZmlsdGVyKSB7XG4gICAgICB0aGlzLmZpbHRlclBpcGVsaW5lLnB1c2goZmlsdGVyKTtcbiAgICAgIHRoaXMucmVzdWx0c2V0W2ZpbHRlci50eXBlXShmaWx0ZXIudmFsKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogcmVhcHBseUZpbHRlcnMoKSAtIFJlYXBwbHkgYWxsIHRoZSBmaWx0ZXJzIGluIHRoZSBjdXJyZW50IHBpcGVsaW5lLlxuICAgICAqXG4gICAgICogQHJldHVybnMge0R5bmFtaWNWaWV3fSB0aGlzIER5bmFtaWNWaWV3IG9iamVjdCwgZm9yIGZ1cnRoZXIgY2hhaW4gb3BzLlxuICAgICAqL1xuICAgIER5bmFtaWNWaWV3LnByb3RvdHlwZS5yZWFwcGx5RmlsdGVycyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMucmVzdWx0c2V0LnJlc2V0KCk7XG5cbiAgICAgIHRoaXMuY2FjaGVkcmVzdWx0c2V0ID0gbnVsbDtcbiAgICAgIGlmICh0aGlzLm9wdGlvbnMucGVyc2lzdGVudCkge1xuICAgICAgICB0aGlzLnJlc3VsdGRhdGEgPSBbXTtcbiAgICAgICAgdGhpcy5yZXN1bHRzZGlydHkgPSB0cnVlO1xuICAgICAgfVxuXG4gICAgICB2YXIgZmlsdGVycyA9IHRoaXMuZmlsdGVyUGlwZWxpbmU7XG4gICAgICB0aGlzLmZpbHRlclBpcGVsaW5lID0gW107XG5cbiAgICAgIGZvciAodmFyIGlkeCA9IDAsIGxlbiA9IGZpbHRlcnMubGVuZ3RoOyBpZHggPCBsZW47IGlkeCArPSAxKSB7XG4gICAgICAgIHRoaXMuX2FkZEZpbHRlcihmaWx0ZXJzW2lkeF0pO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5zb3J0RnVuY3Rpb24gfHwgdGhpcy5zb3J0Q3JpdGVyaWEgfHwgdGhpcy5zb3J0Q3JpdGVyaWFTaW1wbGUpIHtcbiAgICAgICAgdGhpcy5xdWV1ZVNvcnRQaGFzZSgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5xdWV1ZVJlYnVpbGRFdmVudCgpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogYXBwbHlGaWx0ZXIoKSAtIEFkZHMgb3IgdXBkYXRlcyBhIGZpbHRlciBpbiB0aGUgRHluYW1pY1ZpZXcgZmlsdGVyIHBpcGVsaW5lXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge29iamVjdH0gZmlsdGVyIC0gQSBmaWx0ZXIgb2JqZWN0IHRvIGFkZCB0byB0aGUgcGlwZWxpbmUuXG4gICAgICogICAgVGhlIG9iamVjdCBpcyBpbiB0aGUgZm9ybWF0IHsgJ3R5cGUnOiBmaWx0ZXJfdHlwZSwgJ3ZhbCcsIGZpbHRlcl9wYXJhbSwgJ3VpZCcsIG9wdGlvbmFsX2ZpbHRlcl9pZCB9XG4gICAgICogQHJldHVybnMge0R5bmFtaWNWaWV3fSB0aGlzIER5bmFtaWNWaWV3IG9iamVjdCwgZm9yIGZ1cnRoZXIgY2hhaW4gb3BzLlxuICAgICAqIEBtZW1iZXJvZiBEeW5hbWljVmlld1xuICAgICAqL1xuICAgIER5bmFtaWNWaWV3LnByb3RvdHlwZS5hcHBseUZpbHRlciA9IGZ1bmN0aW9uIChmaWx0ZXIpIHtcbiAgICAgIHZhciBpZHggPSB0aGlzLl9pbmRleE9mRmlsdGVyV2l0aElkKGZpbHRlci51aWQpO1xuICAgICAgaWYgKGlkeCA+PSAwKSB7XG4gICAgICAgIHRoaXMuZmlsdGVyUGlwZWxpbmVbaWR4XSA9IGZpbHRlcjtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVhcHBseUZpbHRlcnMoKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5jYWNoZWRyZXN1bHRzZXQgPSBudWxsO1xuICAgICAgaWYgKHRoaXMub3B0aW9ucy5wZXJzaXN0ZW50KSB7XG4gICAgICAgIHRoaXMucmVzdWx0ZGF0YSA9IFtdO1xuICAgICAgICB0aGlzLnJlc3VsdHNkaXJ0eSA9IHRydWU7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuX2FkZEZpbHRlcihmaWx0ZXIpO1xuXG4gICAgICBpZiAodGhpcy5zb3J0RnVuY3Rpb24gfHwgdGhpcy5zb3J0Q3JpdGVyaWEgfHwgdGhpcy5zb3J0Q3JpdGVyaWFTaW1wbGUpIHtcbiAgICAgICAgdGhpcy5xdWV1ZVNvcnRQaGFzZSgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5xdWV1ZVJlYnVpbGRFdmVudCgpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogYXBwbHlGaW5kKCkgLSBBZGRzIG9yIHVwZGF0ZXMgYSBtb25nby1zdHlsZSBxdWVyeSBvcHRpb24gaW4gdGhlIER5bmFtaWNWaWV3IGZpbHRlciBwaXBlbGluZVxuICAgICAqXG4gICAgICogQHBhcmFtIHtvYmplY3R9IHF1ZXJ5IC0gQSBtb25nby1zdHlsZSBxdWVyeSBvYmplY3QgdG8gYXBwbHkgdG8gcGlwZWxpbmVcbiAgICAgKiBAcGFyYW0geyhzdHJpbmd8bnVtYmVyKT19IHVpZCAtIE9wdGlvbmFsOiBUaGUgdW5pcXVlIElEIG9mIHRoaXMgZmlsdGVyLCB0byByZWZlcmVuY2UgaXQgaW4gdGhlIGZ1dHVyZS5cbiAgICAgKiBAcmV0dXJucyB7RHluYW1pY1ZpZXd9IHRoaXMgRHluYW1pY1ZpZXcgb2JqZWN0LCBmb3IgZnVydGhlciBjaGFpbiBvcHMuXG4gICAgICogQG1lbWJlcm9mIER5bmFtaWNWaWV3XG4gICAgICovXG4gICAgRHluYW1pY1ZpZXcucHJvdG90eXBlLmFwcGx5RmluZCA9IGZ1bmN0aW9uIChxdWVyeSwgdWlkKSB7XG4gICAgICB0aGlzLmFwcGx5RmlsdGVyKHtcbiAgICAgICAgdHlwZTogJ2ZpbmQnLFxuICAgICAgICB2YWw6IHF1ZXJ5LFxuICAgICAgICB1aWQ6IHVpZFxuICAgICAgfSk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogYXBwbHlXaGVyZSgpIC0gQWRkcyBvciB1cGRhdGVzIGEgamF2YXNjcmlwdCBmaWx0ZXIgZnVuY3Rpb24gaW4gdGhlIER5bmFtaWNWaWV3IGZpbHRlciBwaXBlbGluZVxuICAgICAqXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbn0gZnVuIC0gQSBqYXZhc2NyaXB0IGZpbHRlciBmdW5jdGlvbiB0byBhcHBseSB0byBwaXBlbGluZVxuICAgICAqIEBwYXJhbSB7KHN0cmluZ3xudW1iZXIpPX0gdWlkIC0gT3B0aW9uYWw6IFRoZSB1bmlxdWUgSUQgb2YgdGhpcyBmaWx0ZXIsIHRvIHJlZmVyZW5jZSBpdCBpbiB0aGUgZnV0dXJlLlxuICAgICAqIEByZXR1cm5zIHtEeW5hbWljVmlld30gdGhpcyBEeW5hbWljVmlldyBvYmplY3QsIGZvciBmdXJ0aGVyIGNoYWluIG9wcy5cbiAgICAgKiBAbWVtYmVyb2YgRHluYW1pY1ZpZXdcbiAgICAgKi9cbiAgICBEeW5hbWljVmlldy5wcm90b3R5cGUuYXBwbHlXaGVyZSA9IGZ1bmN0aW9uIChmdW4sIHVpZCkge1xuICAgICAgdGhpcy5hcHBseUZpbHRlcih7XG4gICAgICAgIHR5cGU6ICd3aGVyZScsXG4gICAgICAgIHZhbDogZnVuLFxuICAgICAgICB1aWQ6IHVpZFxuICAgICAgfSk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogcmVtb3ZlRmlsdGVyKCkgLSBSZW1vdmUgdGhlIHNwZWNpZmllZCBmaWx0ZXIgZnJvbSB0aGUgRHluYW1pY1ZpZXcgZmlsdGVyIHBpcGVsaW5lXG4gICAgICpcbiAgICAgKiBAcGFyYW0geyhzdHJpbmd8bnVtYmVyKX0gdWlkIC0gVGhlIHVuaXF1ZSBJRCBvZiB0aGUgZmlsdGVyIHRvIGJlIHJlbW92ZWQuXG4gICAgICogQHJldHVybnMge0R5bmFtaWNWaWV3fSB0aGlzIER5bmFtaWNWaWV3IG9iamVjdCwgZm9yIGZ1cnRoZXIgY2hhaW4gb3BzLlxuICAgICAqIEBtZW1iZXJvZiBEeW5hbWljVmlld1xuICAgICAqL1xuICAgIER5bmFtaWNWaWV3LnByb3RvdHlwZS5yZW1vdmVGaWx0ZXIgPSBmdW5jdGlvbiAodWlkKSB7XG4gICAgICB2YXIgaWR4ID0gdGhpcy5faW5kZXhPZkZpbHRlcldpdGhJZCh1aWQpO1xuICAgICAgaWYgKGlkeCA8IDApIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRHluYW1pYyB2aWV3IGRvZXMgbm90IGNvbnRhaW4gYSBmaWx0ZXIgd2l0aCBJRDogXCIgKyB1aWQpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmZpbHRlclBpcGVsaW5lLnNwbGljZShpZHgsIDEpO1xuICAgICAgdGhpcy5yZWFwcGx5RmlsdGVycygpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIGNvdW50KCkgLSByZXR1cm5zIHRoZSBudW1iZXIgb2YgZG9jdW1lbnRzIHJlcHJlc2VudGluZyB0aGUgY3VycmVudCBEeW5hbWljVmlldyBjb250ZW50cy5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IFRoZSBudW1iZXIgb2YgZG9jdW1lbnRzIHJlcHJlc2VudGluZyB0aGUgY3VycmVudCBEeW5hbWljVmlldyBjb250ZW50cy5cbiAgICAgKiBAbWVtYmVyb2YgRHluYW1pY1ZpZXdcbiAgICAgKi9cbiAgICBEeW5hbWljVmlldy5wcm90b3R5cGUuY291bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAvLyBpbiBvcmRlciB0byBiZSBhY2N1cmF0ZSB3ZSB3aWxsIHBheSB0aGUgbWluaW11bSBjb3N0IChhbmQgbm90IGFsdGVyIGR2IHN0YXRlIG1hbmFnZW1lbnQpXG4gICAgICAvLyByZWN1cnJpbmcgcmVzdWx0c2V0IGRhdGEgcmVzb2x1dGlvbnMgc2hvdWxkIGtub3cgaW50ZXJuYWxseSBpdHMgYWxyZWFkeSB1cCB0byBkYXRlLlxuICAgICAgLy8gZm9yIHBlcnNpc3RlbnQgZGF0YSB0aGlzIHdpbGwgbm90IHVwZGF0ZSByZXN1bHRkYXRhIG5vciBmaXJlIHJlYnVpbGQgZXZlbnQuXG4gICAgICBpZiAodGhpcy5yZXN1bHRzZGlydHkpIHtcbiAgICAgICAgdGhpcy5yZXN1bHRkYXRhID0gdGhpcy5yZXN1bHRzZXQuZGF0YSgpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcy5yZXN1bHRzZXQuY291bnQoKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogZGF0YSgpIC0gcmVzb2x2ZXMgYW5kIHBlbmRpbmcgZmlsdGVyaW5nIGFuZCBzb3J0aW5nLCB0aGVuIHJldHVybnMgZG9jdW1lbnQgYXJyYXkgYXMgcmVzdWx0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtvYmplY3Q9fSBvcHRpb25zIC0gb3B0aW9uYWwgcGFyYW1ldGVycyB0byBwYXNzIHRvIHJlc3VsdHNldC5kYXRhKCkgaWYgbm9uLXBlcnNpc3RlbnRcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IG9wdGlvbnMuZm9yY2VDbG9uZXMgLSBBbGxvd3MgZm9yY2luZyB0aGUgcmV0dXJuIG9mIGNsb25lZCBvYmplY3RzIGV2ZW4gd2hlblxuICAgICAqICAgICAgICB0aGUgY29sbGVjdGlvbiBpcyBub3QgY29uZmlndXJlZCBmb3IgY2xvbmUgb2JqZWN0LlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBvcHRpb25zLmZvcmNlQ2xvbmVNZXRob2QgLSBBbGxvd3Mgb3ZlcnJpZGluZyB0aGUgZGVmYXVsdCBvciBjb2xsZWN0aW9uIHNwZWNpZmllZCBjbG9uaW5nIG1ldGhvZC5cbiAgICAgKiAgICAgICAgUG9zc2libGUgdmFsdWVzIGluY2x1ZGUgJ3BhcnNlLXN0cmluZ2lmeScsICdqcXVlcnktZXh0ZW5kLWRlZXAnLCAnc2hhbGxvdycsICdzaGFsbG93LWFzc2lnbidcbiAgICAgKiBAcGFyYW0ge2Jvb2x9IG9wdGlvbnMucmVtb3ZlTWV0YSAtIFdpbGwgZm9yY2UgY2xvbmVzIGFuZCBzdHJpcCAkbG9raSBhbmQgbWV0YSBwcm9wZXJ0aWVzIGZyb20gZG9jdW1lbnRzXG4gICAgICogQHJldHVybnMge2FycmF5fSBBbiBhcnJheSBvZiBkb2N1bWVudHMgcmVwcmVzZW50aW5nIHRoZSBjdXJyZW50IER5bmFtaWNWaWV3IGNvbnRlbnRzLlxuICAgICAqIEBtZW1iZXJvZiBEeW5hbWljVmlld1xuICAgICAqL1xuICAgIER5bmFtaWNWaWV3LnByb3RvdHlwZS5kYXRhID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICAgIC8vIHVzaW5nIGZpbmFsIHNvcnQgcGhhc2UgYXMgJ2NhdGNoIGFsbCcgZm9yIGEgZmV3IHVzZSBjYXNlcyB3aGljaCByZXF1aXJlIGZ1bGwgcmVidWlsZFxuICAgICAgaWYgKHRoaXMuc29ydERpcnR5IHx8IHRoaXMucmVzdWx0c2RpcnR5KSB7XG4gICAgICAgIHRoaXMucGVyZm9ybVNvcnRQaGFzZSh7XG4gICAgICAgICAgc3VwcHJlc3NSZWJ1aWxkRXZlbnQ6IHRydWVcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gKHRoaXMub3B0aW9ucy5wZXJzaXN0ZW50KSA/ICh0aGlzLnJlc3VsdGRhdGEpIDogKHRoaXMucmVzdWx0c2V0LmRhdGEob3B0aW9ucykpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBxdWV1ZVJlYnVpbGRFdmVudCgpIC0gV2hlbiB0aGUgdmlldyBpcyBub3Qgc29ydGVkIHdlIG1heSBzdGlsbCB3aXNoIHRvIGJlIG5vdGlmaWVkIG9mIHJlYnVpbGQgZXZlbnRzLlxuICAgICAqICAgICBUaGlzIGV2ZW50IHdpbGwgdGhyb3R0bGUgYW5kIHF1ZXVlIGEgc2luZ2xlIHJlYnVpbGQgZXZlbnQgd2hlbiBiYXRjaGVzIG9mIHVwZGF0ZXMgYWZmZWN0IHRoZSB2aWV3LlxuICAgICAqL1xuICAgIER5bmFtaWNWaWV3LnByb3RvdHlwZS5xdWV1ZVJlYnVpbGRFdmVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICh0aGlzLnJlYnVpbGRQZW5kaW5nKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHRoaXMucmVidWlsZFBlbmRpbmcgPSB0cnVlO1xuXG4gICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHNlbGYucmVidWlsZFBlbmRpbmcpIHtcbiAgICAgICAgICBzZWxmLnJlYnVpbGRQZW5kaW5nID0gZmFsc2U7XG4gICAgICAgICAgc2VsZi5lbWl0KCdyZWJ1aWxkJywgc2VsZik7XG4gICAgICAgIH1cbiAgICAgIH0sIHRoaXMub3B0aW9ucy5taW5SZWJ1aWxkSW50ZXJ2YWwpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBxdWV1ZVNvcnRQaGFzZSA6IElmIHRoZSB2aWV3IGlzIHNvcnRlZCB3ZSB3aWxsIHRocm90dGxlIHNvcnRpbmcgdG8gZWl0aGVyIDpcbiAgICAgKiAgICAoMSkgcGFzc2l2ZSAtIHdoZW4gdGhlIHVzZXIgY2FsbHMgZGF0YSgpLCBvclxuICAgICAqICAgICgyKSBhY3RpdmUgLSBvbmNlIHRoZXkgc3RvcCB1cGRhdGluZyBhbmQgeWllbGQganMgdGhyZWFkIGNvbnRyb2xcbiAgICAgKi9cbiAgICBEeW5hbWljVmlldy5wcm90b3R5cGUucXVldWVTb3J0UGhhc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAvLyBhbHJlYWR5IHF1ZXVlZD8gZXhpdCB3aXRob3V0IHF1ZXVpbmcgYWdhaW5cbiAgICAgIGlmICh0aGlzLnNvcnREaXJ0eSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0aGlzLnNvcnREaXJ0eSA9IHRydWU7XG5cbiAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgIGlmICh0aGlzLm9wdGlvbnMuc29ydFByaW9yaXR5ID09PSBcImFjdGl2ZVwiKSB7XG4gICAgICAgIC8vIGFjdGl2ZSBzb3J0aW5nLi4uIG9uY2UgdGhleSBhcmUgZG9uZSBhbmQgeWllbGQganMgdGhyZWFkLCBydW4gYXN5bmMgcGVyZm9ybVNvcnRQaGFzZSgpXG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHNlbGYucGVyZm9ybVNvcnRQaGFzZSgpO1xuICAgICAgICB9LCB0aGlzLm9wdGlvbnMubWluUmVidWlsZEludGVydmFsKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIG11c3QgYmUgcGFzc2l2ZSBzb3J0aW5nLi4uIHNpbmNlIG5vdCBjYWxsaW5nIHBlcmZvcm1Tb3J0UGhhc2UgKHVudGlsIGRhdGEgY2FsbCksIGxldHMgdXNlIHF1ZXVlUmVidWlsZEV2ZW50IHRvXG4gICAgICAgIC8vIHBvdGVudGlhbGx5IG5vdGlmeSB1c2VyIHRoYXQgZGF0YSBoYXMgY2hhbmdlZC5cbiAgICAgICAgdGhpcy5xdWV1ZVJlYnVpbGRFdmVudCgpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBwZXJmb3JtU29ydFBoYXNlKCkgLSBpbnZva2VkIHN5bmNocm9ub3VzbHkgb3IgYXN5bmNocm9ub3VzbHkgdG8gcGVyZm9ybSBmaW5hbCBzb3J0IHBoYXNlIChpZiBuZWVkZWQpXG4gICAgICpcbiAgICAgKi9cbiAgICBEeW5hbWljVmlldy5wcm90b3R5cGUucGVyZm9ybVNvcnRQaGFzZSA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gICAgICAvLyBhc3luYyBjYWxsIHRvIHRoaXMgbWF5IGhhdmUgYmVlbiBwcmUtZW1wdGVkIGJ5IHN5bmNocm9ub3VzIGNhbGwgdG8gZGF0YSBiZWZvcmUgYXN5bmMgY291bGQgZmlyZVxuICAgICAgaWYgKCF0aGlzLnNvcnREaXJ0eSAmJiAhdGhpcy5yZXN1bHRzZGlydHkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblxuICAgICAgaWYgKHRoaXMuc29ydERpcnR5KSB7XG4gICAgICAgIGlmICh0aGlzLnNvcnRGdW5jdGlvbikge1xuICAgICAgICAgIHRoaXMucmVzdWx0c2V0LnNvcnQodGhpcy5zb3J0RnVuY3Rpb24pO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuc29ydENyaXRlcmlhKSB7XG4gICAgICAgICAgdGhpcy5yZXN1bHRzZXQuY29tcG91bmRzb3J0KHRoaXMuc29ydENyaXRlcmlhKTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnNvcnRDcml0ZXJpYVNpbXBsZSkge1xuICAgICAgICAgIHRoaXMucmVzdWx0c2V0LnNpbXBsZXNvcnQodGhpcy5zb3J0Q3JpdGVyaWFTaW1wbGUucHJvcG5hbWUsIHRoaXMuc29ydENyaXRlcmlhU2ltcGxlLm9wdGlvbnMpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5zb3J0RGlydHkgPSBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMub3B0aW9ucy5wZXJzaXN0ZW50KSB7XG4gICAgICAgIC8vIHBlcnNpc3RlbnQgdmlldywgcmVidWlsZCBsb2NhbCByZXN1bHRkYXRhIGFycmF5XG4gICAgICAgIHRoaXMucmVzdWx0ZGF0YSA9IHRoaXMucmVzdWx0c2V0LmRhdGEoKTtcbiAgICAgICAgdGhpcy5yZXN1bHRzZGlydHkgPSBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFvcHRpb25zLnN1cHByZXNzUmVidWlsZEV2ZW50KSB7XG4gICAgICAgIHRoaXMuZW1pdCgncmVidWlsZCcsIHRoaXMpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBldmFsdWF0ZURvY3VtZW50KCkgLSBpbnRlcm5hbCBtZXRob2QgZm9yIChyZSlldmFsdWF0aW5nIGRvY3VtZW50IGluY2x1c2lvbi5cbiAgICAgKiAgICBDYWxsZWQgYnkgOiBjb2xsZWN0aW9uLmluc2VydCgpIGFuZCBjb2xsZWN0aW9uLnVwZGF0ZSgpLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtpbnR9IG9iakluZGV4IC0gaW5kZXggb2YgZG9jdW1lbnQgdG8gKHJlKXJ1biB0aHJvdWdoIGZpbHRlciBwaXBlbGluZS5cbiAgICAgKiBAcGFyYW0ge2Jvb2x9IGlzTmV3IC0gdHJ1ZSBpZiB0aGUgZG9jdW1lbnQgd2FzIGp1c3QgYWRkZWQgdG8gdGhlIGNvbGxlY3Rpb24uXG4gICAgICovXG4gICAgRHluYW1pY1ZpZXcucHJvdG90eXBlLmV2YWx1YXRlRG9jdW1lbnQgPSBmdW5jdGlvbiAob2JqSW5kZXgsIGlzTmV3KSB7XG4gICAgICAvLyBpZiBubyBmaWx0ZXIgYXBwbGllZCB5ZXQsIHRoZSByZXN1bHQgJ3NldCcgc2hvdWxkIHJlbWFpbiAnZXZlcnl0aGluZydcbiAgICAgIGlmICghdGhpcy5yZXN1bHRzZXQuZmlsdGVySW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5wZXJzaXN0ZW50KSB7XG4gICAgICAgICAgdGhpcy5yZXN1bHRkYXRhID0gdGhpcy5yZXN1bHRzZXQuZGF0YSgpO1xuICAgICAgICB9XG4gICAgICAgIC8vIG5lZWQgdG8gcmUtc29ydCB0byBzb3J0IG5ldyBkb2N1bWVudFxuICAgICAgICBpZiAodGhpcy5zb3J0RnVuY3Rpb24gfHwgdGhpcy5zb3J0Q3JpdGVyaWEgfHwgdGhpcy5zb3J0Q3JpdGVyaWFTaW1wbGUpIHtcbiAgICAgICAgICB0aGlzLnF1ZXVlU29ydFBoYXNlKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5xdWV1ZVJlYnVpbGRFdmVudCgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdmFyIG9mciA9IHRoaXMucmVzdWx0c2V0LmZpbHRlcmVkcm93cztcbiAgICAgIHZhciBvbGRQb3MgPSAoaXNOZXcpID8gKC0xKSA6IChvZnIuaW5kZXhPZigrb2JqSW5kZXgpKTtcbiAgICAgIHZhciBvbGRsZW4gPSBvZnIubGVuZ3RoO1xuXG4gICAgICAvLyBjcmVhdGluZyBhIDEtZWxlbWVudCByZXN1bHRzZXQgdG8gcnVuIGZpbHRlciBjaGFpbiBvcHMgb24gdG8gc2VlIGlmIHRoYXQgZG9jIHBhc3NlcyBmaWx0ZXJzO1xuICAgICAgLy8gbW9zdGx5IGVmZmljaWVudCBhbGdvcml0aG0sIHNsaWdodCBzdGFjayBvdmVyaGVhZCBwcmljZSAodGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgb24gaW5zZXJ0cyBhbmQgdXBkYXRlcylcbiAgICAgIHZhciBldmFsUmVzdWx0c2V0ID0gbmV3IFJlc3VsdHNldCh0aGlzLmNvbGxlY3Rpb24pO1xuICAgICAgZXZhbFJlc3VsdHNldC5maWx0ZXJlZHJvd3MgPSBbb2JqSW5kZXhdO1xuICAgICAgZXZhbFJlc3VsdHNldC5maWx0ZXJJbml0aWFsaXplZCA9IHRydWU7XG4gICAgICB2YXIgZmlsdGVyO1xuICAgICAgZm9yICh2YXIgaWR4ID0gMCwgbGVuID0gdGhpcy5maWx0ZXJQaXBlbGluZS5sZW5ndGg7IGlkeCA8IGxlbjsgaWR4KyspIHtcbiAgICAgICAgZmlsdGVyID0gdGhpcy5maWx0ZXJQaXBlbGluZVtpZHhdO1xuICAgICAgICBldmFsUmVzdWx0c2V0W2ZpbHRlci50eXBlXShmaWx0ZXIudmFsKTtcbiAgICAgIH1cblxuICAgICAgLy8gbm90IGEgdHJ1ZSBwb3NpdGlvbiwgYnV0IC0xIGlmIG5vdCBwYXNzIG91ciBmaWx0ZXIocyksIDAgaWYgcGFzc2VkIGZpbHRlcihzKVxuICAgICAgdmFyIG5ld1BvcyA9IChldmFsUmVzdWx0c2V0LmZpbHRlcmVkcm93cy5sZW5ndGggPT09IDApID8gLTEgOiAwO1xuXG4gICAgICAvLyB3YXNuJ3QgaW4gb2xkLCBzaG91bGRuJ3QgYmUgbm93Li4uIGRvIG5vdGhpbmdcbiAgICAgIGlmIChvbGRQb3MgPT09IC0xICYmIG5ld1BvcyA9PT0gLTEpIHJldHVybjtcblxuICAgICAgLy8gd2Fzbid0IGluIHJlc3VsdHNldCwgc2hvdWxkIGJlIG5vdy4uLiBhZGRcbiAgICAgIGlmIChvbGRQb3MgPT09IC0xICYmIG5ld1BvcyAhPT0gLTEpIHtcbiAgICAgICAgb2ZyLnB1c2gob2JqSW5kZXgpO1xuXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMucGVyc2lzdGVudCkge1xuICAgICAgICAgIHRoaXMucmVzdWx0ZGF0YS5wdXNoKHRoaXMuY29sbGVjdGlvbi5kYXRhW29iakluZGV4XSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBuZWVkIHRvIHJlLXNvcnQgdG8gc29ydCBuZXcgZG9jdW1lbnRcbiAgICAgICAgaWYgKHRoaXMuc29ydEZ1bmN0aW9uIHx8IHRoaXMuc29ydENyaXRlcmlhIHx8IHRoaXMuc29ydENyaXRlcmlhU2ltcGxlKSB7XG4gICAgICAgICAgdGhpcy5xdWV1ZVNvcnRQaGFzZSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMucXVldWVSZWJ1aWxkRXZlbnQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gd2FzIGluIHJlc3VsdHNldCwgc2hvdWxkbid0IGJlIG5vdy4uLiBkZWxldGVcbiAgICAgIGlmIChvbGRQb3MgIT09IC0xICYmIG5ld1BvcyA9PT0gLTEpIHtcbiAgICAgICAgaWYgKG9sZFBvcyA8IG9sZGxlbiAtIDEpIHtcbiAgICAgICAgICBvZnIuc3BsaWNlKG9sZFBvcywgMSk7XG5cbiAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLnBlcnNpc3RlbnQpIHtcbiAgICAgICAgICAgIHRoaXMucmVzdWx0ZGF0YS5zcGxpY2Uob2xkUG9zLCAxKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgb2ZyLmxlbmd0aCA9IG9sZGxlbiAtIDE7XG5cbiAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLnBlcnNpc3RlbnQpIHtcbiAgICAgICAgICAgIHRoaXMucmVzdWx0ZGF0YS5sZW5ndGggPSBvbGRsZW4gLSAxO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGluIGNhc2UgY2hhbmdlcyB0byBkYXRhIGFsdGVyZWQgYSBzb3J0IGNvbHVtblxuICAgICAgICBpZiAodGhpcy5zb3J0RnVuY3Rpb24gfHwgdGhpcy5zb3J0Q3JpdGVyaWEgfHwgdGhpcy5zb3J0Q3JpdGVyaWFTaW1wbGUpIHtcbiAgICAgICAgICB0aGlzLnF1ZXVlU29ydFBoYXNlKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5xdWV1ZVJlYnVpbGRFdmVudCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyB3YXMgaW4gcmVzdWx0c2V0LCBzaG91bGQgc3RpbGwgYmUgbm93Li4uICh1cGRhdGUgcGVyc2lzdGVudCBvbmx5PylcbiAgICAgIGlmIChvbGRQb3MgIT09IC0xICYmIG5ld1BvcyAhPT0gLTEpIHtcbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5wZXJzaXN0ZW50KSB7XG4gICAgICAgICAgLy8gaW4gY2FzZSBkb2N1bWVudCBjaGFuZ2VkLCByZXBsYWNlIHBlcnNpc3RlbnQgdmlldyBkYXRhIHdpdGggdGhlIGxhdGVzdCBjb2xsZWN0aW9uLmRhdGEgZG9jdW1lbnRcbiAgICAgICAgICB0aGlzLnJlc3VsdGRhdGFbb2xkUG9zXSA9IHRoaXMuY29sbGVjdGlvbi5kYXRhW29iakluZGV4XTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGluIGNhc2UgY2hhbmdlcyB0byBkYXRhIGFsdGVyZWQgYSBzb3J0IGNvbHVtblxuICAgICAgICBpZiAodGhpcy5zb3J0RnVuY3Rpb24gfHwgdGhpcy5zb3J0Q3JpdGVyaWEgfHwgdGhpcy5zb3J0Q3JpdGVyaWFTaW1wbGUpIHtcbiAgICAgICAgICB0aGlzLnF1ZXVlU29ydFBoYXNlKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5xdWV1ZVJlYnVpbGRFdmVudCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiByZW1vdmVEb2N1bWVudCgpIC0gaW50ZXJuYWwgZnVuY3Rpb24gY2FsbGVkIG9uIGNvbGxlY3Rpb24uZGVsZXRlKClcbiAgICAgKiBAcGFyYW0ge251bWJlcnxudW1iZXJbXX0gb2JqSW5kZXggLSBpbmRleCBvZiBkb2N1bWVudCB0byAocmUpcnVuIHRocm91Z2ggZmlsdGVyIHBpcGVsaW5lLlxuICAgICAqL1xuICAgIER5bmFtaWNWaWV3LnByb3RvdHlwZS5yZW1vdmVEb2N1bWVudCA9IGZ1bmN0aW9uIChvYmpJbmRleCkge1xuICAgICAgdmFyIGlkeCwgcm1pZHgsIHJtbGVuLCByeG8gPSB7fSwgZnhvID0ge307XG4gICAgICB2YXIgYWRqZWxzID0gW107XG4gICAgICB2YXIgZHJzID0gdGhpcy5yZXN1bHRzZXQ7XG4gICAgICB2YXIgZnIgPSB0aGlzLnJlc3VsdHNldC5maWx0ZXJlZHJvd3M7XG4gICAgICB2YXIgZnJsZW4gPSBmci5sZW5ndGg7XG5cbiAgICAgIC8vIGlmIG5vIGZpbHRlciBhcHBsaWVkIHlldCwgdGhlIHJlc3VsdCAnc2V0JyBzaG91bGQgcmVtYWluICdldmVyeXRoaW5nJ1xuICAgICAgaWYgKCF0aGlzLnJlc3VsdHNldC5maWx0ZXJJbml0aWFsaXplZCkge1xuICAgICAgICBpZiAodGhpcy5vcHRpb25zLnBlcnNpc3RlbnQpIHtcbiAgICAgICAgICB0aGlzLnJlc3VsdGRhdGEgPSB0aGlzLnJlc3VsdHNldC5kYXRhKCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gaW4gY2FzZSBjaGFuZ2VzIHRvIGRhdGEgYWx0ZXJlZCBhIHNvcnQgY29sdW1uXG4gICAgICAgIGlmICh0aGlzLnNvcnRGdW5jdGlvbiB8fCB0aGlzLnNvcnRDcml0ZXJpYSB8fCB0aGlzLnNvcnRDcml0ZXJpYVNpbXBsZSkge1xuICAgICAgICAgIHRoaXMucXVldWVTb3J0UGhhc2UoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLnF1ZXVlUmVidWlsZEV2ZW50KCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBpZiBwYXNzZWQgc2luZ2xlIGluZGV4LCB3cmFwIGluIGFycmF5XG4gICAgICBpZiAoIUFycmF5LmlzQXJyYXkob2JqSW5kZXgpKSB7XG4gICAgICAgIG9iakluZGV4ID0gW29iakluZGV4XTtcbiAgICAgIH1cblxuICAgICAgcm1sZW4gPSBvYmpJbmRleC5sZW5ndGg7XG4gICAgICAvLyBjcmVhdGUgaW50ZXJzZWN0aW9uIG9iamVjdCBvZiBkYXRhIGluZGljZXMgdG8gcmVtb3ZlXG4gICAgICBmb3Iocm1pZHg9MDtybWlkeDxybWxlbjsgcm1pZHgrKykge1xuICAgICAgICByeG9bb2JqSW5kZXhbcm1pZHhdXSA9IHRydWU7XG4gICAgICB9XG5cbiAgICAgIC8vIHBpdm90IHJlbW92ZSBkYXRhIGluZGljZXMgaW50byByZW1vdmUgZmlsdGVyZWRyb3dzIGluZGljZXMgYW5kIGR1bXAgaW4gaGFzaG9iamVjdFxuICAgICAgZm9yIChpZHg9MDsgaWR4PGZybGVuOyBpZHgrKykge1xuICAgICAgICBpZiAocnhvW2ZyW2lkeF1dKSBmeG9baWR4XSA9IHRydWU7XG4gICAgICB9XG5cbiAgICAgIC8vIGlmIGFueSBvZiB0aGUgcmVtb3ZlZCBpdGVtcyB3ZXJlIGluIG91ciBmaWx0ZXJlZHJvd3MuLi5cbiAgICAgIGlmIChPYmplY3Qua2V5cyhmeG8pLmxlbmd0aCA+IDApIHtcbiAgICAgICAgLy8gcmVtb3ZlIHRoZW0gZnJvbSBmaWx0ZXJlZCByb3dzXG4gICAgICAgIHRoaXMucmVzdWx0c2V0LmZpbHRlcmVkcm93cyA9IHRoaXMucmVzdWx0c2V0LmZpbHRlcmVkcm93cy5maWx0ZXIoZnVuY3Rpb24oZGksIGlkeCkgeyByZXR1cm4gIWZ4b1tpZHhdOyB9KTtcbiAgICAgICAgLy8gaWYgcGVyc2lzdGVudC4uLlxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLnBlcnNpc3RlbnQpIHtcbiAgICAgICAgICAvLyByZW1vdmUgZnJvbSByZXN1bHRkYXRhXG4gICAgICAgICAgdGhpcy5yZXN1bHRkYXRhID0gdGhpcy5yZXN1bHRkYXRhLmZpbHRlcihmdW5jdGlvbihvYmosIGlkeCkgeyByZXR1cm4gIWZ4b1tpZHhdOyB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGFuZCBxdWV1ZSBzb3J0cyBcbiAgICAgICAgaWYgKHRoaXMuc29ydEZ1bmN0aW9uIHx8IHRoaXMuc29ydENyaXRlcmlhIHx8IHRoaXMuc29ydENyaXRlcmlhU2ltcGxlKSB7XG4gICAgICAgICAgdGhpcy5xdWV1ZVNvcnRQaGFzZSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMucXVldWVSZWJ1aWxkRXZlbnQoKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyB0byByZW1vdmUgaG9sZXMsIHdlIG5lZWQgdG8gJ3NoaWZ0IGRvd24nIGluZGljZXMsIHRoaXMgZmlsdGVyIGZ1bmN0aW9uIGZpbmRzIG51bWJlciBvZiBwb3NpdGlvbnMgdG8gc2hpZnRcbiAgICAgIHZhciBmaWx0ID0gZnVuY3Rpb24oaWR4KSB7IHJldHVybiBmdW5jdGlvbihkaSkgeyByZXR1cm4gZGkgPCBkcnMuZmlsdGVyZWRyb3dzW2lkeF07IH07IH07XG5cbiAgICAgIGZybGVuID0gZHJzLmZpbHRlcmVkcm93cy5sZW5ndGg7XG4gICAgICBmb3IgKGlkeCA9IDA7IGlkeCA8IGZybGVuOyBpZHgrKykge1xuICAgICAgICAvLyBncmFiIHN1YnNldCBvZiByZW1vdmVkIGVsZW1lbnRzIHdoZXJlIGRhdGEgaW5kZXggaXMgbGVzcyB0aGFuIGN1cnJlbnQgZmlsdGVyZWQgcm93IGRhdGEgaW5kZXg7XG4gICAgICAgIC8vIHVzZSB0aGlzIHRvIGRldGVybWluZSBob3cgbWFueSBwb3NpdGlvbnMgaXRlcmF0ZWQgcmVtYWluaW5nIGRhdGEgaW5kZXggbmVlZHMgdG8gYmUgJ3NoaWZ0ZWQgZG93bidcbiAgICAgICAgYWRqZWxzID0gb2JqSW5kZXguZmlsdGVyKGZpbHQoaWR4KSk7XG4gICAgICAgIGRycy5maWx0ZXJlZHJvd3NbaWR4XSAtPSBhZGplbHMubGVuZ3RoO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBtYXBSZWR1Y2UoKSAtIGRhdGEgdHJhbnNmb3JtYXRpb24gdmlhIHVzZXIgc3VwcGxpZWQgZnVuY3Rpb25zXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBtYXBGdW5jdGlvbiAtIHRoaXMgZnVuY3Rpb24gYWNjZXB0cyBhIHNpbmdsZSBkb2N1bWVudCBmb3IgeW91IHRvIHRyYW5zZm9ybSBhbmQgcmV0dXJuXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbn0gcmVkdWNlRnVuY3Rpb24gLSB0aGlzIGZ1bmN0aW9uIGFjY2VwdHMgbWFueSAoYXJyYXkgb2YgbWFwIG91dHB1dHMpIGFuZCByZXR1cm5zIHNpbmdsZSB2YWx1ZVxuICAgICAqIEByZXR1cm5zIFRoZSBvdXRwdXQgb2YgeW91ciByZWR1Y2VGdW5jdGlvblxuICAgICAqIEBtZW1iZXJvZiBEeW5hbWljVmlld1xuICAgICAqL1xuICAgIER5bmFtaWNWaWV3LnByb3RvdHlwZS5tYXBSZWR1Y2UgPSBmdW5jdGlvbiAobWFwRnVuY3Rpb24sIHJlZHVjZUZ1bmN0aW9uKSB7XG4gICAgICB0cnkge1xuICAgICAgICByZXR1cm4gcmVkdWNlRnVuY3Rpb24odGhpcy5kYXRhKCkubWFwKG1hcEZ1bmN0aW9uKSk7XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgfVxuICAgIH07XG5cblxuICAgIC8qKlxuICAgICAqIENvbGxlY3Rpb24gY2xhc3MgdGhhdCBoYW5kbGVzIGRvY3VtZW50cyBvZiBzYW1lIHR5cGVcbiAgICAgKiBAY29uc3RydWN0b3IgQ29sbGVjdGlvblxuICAgICAqIEBpbXBsZW1lbnRzIExva2lFdmVudEVtaXR0ZXJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZSAtIGNvbGxlY3Rpb24gbmFtZVxuICAgICAqIEBwYXJhbSB7KGFycmF5fG9iamVjdCk9fSBvcHRpb25zIC0gKG9wdGlvbmFsKSBhcnJheSBvZiBwcm9wZXJ0eSBuYW1lcyB0byBiZSBpbmRpY2l6ZWQgT1IgYSBjb25maWd1cmF0aW9uIG9iamVjdFxuICAgICAqIEBwYXJhbSB7YXJyYXk9fSBbb3B0aW9ucy51bmlxdWU9W11dIC0gYXJyYXkgb2YgcHJvcGVydHkgbmFtZXMgdG8gZGVmaW5lIHVuaXF1ZSBjb25zdHJhaW50cyBmb3JcbiAgICAgKiBAcGFyYW0ge2FycmF5PX0gW29wdGlvbnMuZXhhY3Q9W11dIC0gYXJyYXkgb2YgcHJvcGVydHkgbmFtZXMgdG8gZGVmaW5lIGV4YWN0IGNvbnN0cmFpbnRzIGZvclxuICAgICAqIEBwYXJhbSB7YXJyYXk9fSBbb3B0aW9ucy5pbmRpY2VzPVtdXSAtIGFycmF5IHByb3BlcnR5IG5hbWVzIHRvIGRlZmluZSBiaW5hcnkgaW5kZXhlcyBmb3JcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLmFkYXB0aXZlQmluYXJ5SW5kaWNlcz10cnVlXSAtIGNvbGxlY3Rpb24gaW5kaWNlcyB3aWxsIGJlIGFjdGl2ZWx5IHJlYnVpbHQgcmF0aGVyIHRoYW4gbGF6aWx5XG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5hc3luY0xpc3RlbmVycz1mYWxzZV0gLSB3aGV0aGVyIGxpc3RlbmVycyBhcmUgaW52b2tlZCBhc3luY2hyb25vdXNseVxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMuZGlzYWJsZU1ldGE9ZmFsc2VdIC0gc2V0IHRvIHRydWUgdG8gZGlzYWJsZSBtZXRhIHByb3BlcnR5IG9uIGRvY3VtZW50c1xuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMuZGlzYWJsZUNoYW5nZXNBcGk9dHJ1ZV0gLSBzZXQgdG8gZmFsc2UgdG8gZW5hYmxlIENoYW5nZXMgQVBJXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5kaXNhYmxlRGVsdGFDaGFuZ2VzQXBpPXRydWVdIC0gc2V0IHRvIGZhbHNlIHRvIGVuYWJsZSBEZWx0YSBDaGFuZ2VzIEFQSSAocmVxdWlyZXMgQ2hhbmdlcyBBUEksIGZvcmNlcyBjbG9uaW5nKVxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMuYXV0b3VwZGF0ZT1mYWxzZV0gLSB1c2UgT2JqZWN0Lm9ic2VydmUgdG8gdXBkYXRlIG9iamVjdHMgYXV0b21hdGljYWxseVxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMuY2xvbmU9ZmFsc2VdIC0gc3BlY2lmeSB3aGV0aGVyIGluc2VydHMgYW5kIHF1ZXJpZXMgY2xvbmUgdG8vZnJvbSB1c2VyXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5zZXJpYWxpemFibGVJbmRpY2VzPXRydWVbXV0gLSBjb252ZXJ0cyBkYXRlIHZhbHVlcyBvbiBiaW5hcnkgaW5kZXhlZCBwcm9wZXJ0aWVzIHRvIGVwb2NoIHRpbWVcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW29wdGlvbnMuY2xvbmVNZXRob2Q9J3BhcnNlLXN0cmluZ2lmeSddIC0gJ3BhcnNlLXN0cmluZ2lmeScsICdqcXVlcnktZXh0ZW5kLWRlZXAnLCAnc2hhbGxvdycsICdzaGFsbG93LWFzc2lnbidcbiAgICAgKiBAcGFyYW0ge2ludD19IG9wdGlvbnMudHRsIC0gYWdlIG9mIGRvY3VtZW50IChpbiBtcy4pIGJlZm9yZSBkb2N1bWVudCBpcyBjb25zaWRlcmVkIGFnZWQvc3RhbGUuXG4gICAgICogQHBhcmFtIHtpbnQ9fSBvcHRpb25zLnR0bEludGVydmFsIC0gdGltZSBpbnRlcnZhbCBmb3IgY2xlYXJpbmcgb3V0ICdhZ2VkJyBkb2N1bWVudHM7IG5vdCBzZXQgYnkgZGVmYXVsdC5cbiAgICAgKiBAc2VlIHtAbGluayBMb2tpI2FkZENvbGxlY3Rpb259IGZvciBub3JtYWwgY3JlYXRpb24gb2YgY29sbGVjdGlvbnNcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBDb2xsZWN0aW9uKG5hbWUsIG9wdGlvbnMpIHtcbiAgICAgIC8vIHRoZSBuYW1lIG9mIHRoZSBjb2xsZWN0aW9uXG5cbiAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICAvLyB0aGUgZGF0YSBoZWxkIGJ5IHRoZSBjb2xsZWN0aW9uXG4gICAgICB0aGlzLmRhdGEgPSBbXTtcbiAgICAgIHRoaXMuaWRJbmRleCA9IFtdOyAvLyBpbmRleCBvZiBpZFxuICAgICAgdGhpcy5iaW5hcnlJbmRpY2VzID0ge307IC8vIHVzZXIgZGVmaW5lZCBpbmRleGVzXG4gICAgICB0aGlzLmNvbnN0cmFpbnRzID0ge1xuICAgICAgICB1bmlxdWU6IHt9LFxuICAgICAgICBleGFjdDoge31cbiAgICAgIH07XG5cbiAgICAgIC8vIHVuaXF1ZSBjb250cmFpbnRzIGNvbnRhaW4gZHVwbGljYXRlIG9iamVjdCByZWZlcmVuY2VzLCBzbyB0aGV5IGFyZSBub3QgcGVyc2lzdGVkLlxuICAgICAgLy8gd2Ugd2lsbCBrZWVwIHRyYWNrIG9mIHByb3BlcnRpZXMgd2hpY2ggaGF2ZSB1bmlxdWUgY29udHJhaW50IGFwcGxpZWQgaGVyZSwgYW5kIHJlZ2VuZXJhdGUgb24gbG9hZFxuICAgICAgdGhpcy51bmlxdWVOYW1lcyA9IFtdO1xuXG4gICAgICAvLyB0cmFuc2Zvcm1zIHdpbGwgYmUgdXNlZCB0byBzdG9yZSBmcmVxdWVudGx5IHVzZWQgcXVlcnkgY2hhaW5zIGFzIGEgc2VyaWVzIG9mIHN0ZXBzXG4gICAgICAvLyB3aGljaCBpdHNlbGYgY2FuIGJlIHN0b3JlZCBhbG9uZyB3aXRoIHRoZSBkYXRhYmFzZS5cbiAgICAgIHRoaXMudHJhbnNmb3JtcyA9IHt9O1xuXG4gICAgICAvLyB0aGUgb2JqZWN0IHR5cGUgb2YgdGhlIGNvbGxlY3Rpb25cbiAgICAgIHRoaXMub2JqVHlwZSA9IG5hbWU7XG5cbiAgICAgIC8vIGluIGF1dG9zYXZlIHNjZW5hcmlvcyB3ZSB3aWxsIHVzZSBjb2xsZWN0aW9uIGxldmVsIGRpcnR5IGZsYWdzIHRvIGRldGVybWluZSB3aGV0aGVyIHNhdmUgaXMgbmVlZGVkLlxuICAgICAgLy8gY3VycmVudGx5LCBpZiBhbnkgY29sbGVjdGlvbiBpcyBkaXJ0eSB3ZSB3aWxsIGF1dG9zYXZlIHRoZSB3aG9sZSBkYXRhYmFzZSBpZiBhdXRvc2F2ZSBpcyBjb25maWd1cmVkLlxuICAgICAgLy8gZGVmYXVsdGluZyB0byB0cnVlIHNpbmNlIHRoaXMgaXMgY2FsbGVkIGZyb20gYWRkQ29sbGVjdGlvbiBhbmQgYWRkaW5nIGEgY29sbGVjdGlvbiBzaG91bGQgdHJpZ2dlciBzYXZlXG4gICAgICB0aGlzLmRpcnR5ID0gdHJ1ZTtcblxuICAgICAgLy8gcHJpdmF0ZSBob2xkZXJzIGZvciBjYWNoZWQgZGF0YVxuICAgICAgdGhpcy5jYWNoZWRJbmRleCA9IG51bGw7XG4gICAgICB0aGlzLmNhY2hlZEJpbmFyeUluZGV4ID0gbnVsbDtcbiAgICAgIHRoaXMuY2FjaGVkRGF0YSA9IG51bGw7XG4gICAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICAgIC8qIE9QVElPTlMgKi9cbiAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXG4gICAgICAvLyBleGFjdCBtYXRjaCBhbmQgdW5pcXVlIGNvbnN0cmFpbnRzXG4gICAgICBpZiAob3B0aW9ucy5oYXNPd25Qcm9wZXJ0eSgndW5pcXVlJykpIHtcbiAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KG9wdGlvbnMudW5pcXVlKSkge1xuICAgICAgICAgIG9wdGlvbnMudW5pcXVlID0gW29wdGlvbnMudW5pcXVlXTtcbiAgICAgICAgfVxuICAgICAgICBvcHRpb25zLnVuaXF1ZS5mb3JFYWNoKGZ1bmN0aW9uIChwcm9wKSB7XG4gICAgICAgICAgc2VsZi51bmlxdWVOYW1lcy5wdXNoKHByb3ApOyAvLyB1c2VkIHRvIHJlZ2VuZXJhdGUgb24gc3Vic2VxdWVudCBkYXRhYmFzZSBsb2Fkc1xuICAgICAgICAgIHNlbGYuY29uc3RyYWludHMudW5pcXVlW3Byb3BdID0gbmV3IFVuaXF1ZUluZGV4KHByb3ApO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgaWYgKG9wdGlvbnMuaGFzT3duUHJvcGVydHkoJ2V4YWN0JykpIHtcbiAgICAgICAgb3B0aW9ucy5leGFjdC5mb3JFYWNoKGZ1bmN0aW9uIChwcm9wKSB7XG4gICAgICAgICAgc2VsZi5jb25zdHJhaW50cy5leGFjdFtwcm9wXSA9IG5ldyBFeGFjdEluZGV4KHByb3ApO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgLy8gaWYgc2V0IHRvIHRydWUgd2Ugd2lsbCBvcHRpbWFsbHkga2VlcCBpbmRpY2VzICdmcmVzaCcgZHVyaW5nIGluc2VydC91cGRhdGUvcmVtb3ZlIG9wcyAobmV2ZXIgZGlydHkvbmV2ZXIgbmVlZHMgcmVidWlsZClcbiAgICAgIC8vIGlmIHlvdSBmcmVxdWVudGx5IGludGVyc3BlcnNlIGluc2VydC91cGRhdGUvcmVtb3ZlIG9wcyBiZXR3ZWVuIGZpbmQgb3BzIHRoaXMgd2lsbCBsaWtlbHkgYmUgc2lnbmlmaWNhbnRseSBmYXN0ZXIgb3B0aW9uLlxuICAgICAgdGhpcy5hZGFwdGl2ZUJpbmFyeUluZGljZXMgPSBvcHRpb25zLmhhc093blByb3BlcnR5KCdhZGFwdGl2ZUJpbmFyeUluZGljZXMnKSA/IG9wdGlvbnMuYWRhcHRpdmVCaW5hcnlJbmRpY2VzIDogdHJ1ZTtcblxuICAgICAgLy8gaXMgY29sbGVjdGlvbiB0cmFuc2FjdGlvbmFsXG4gICAgICB0aGlzLnRyYW5zYWN0aW9uYWwgPSBvcHRpb25zLmhhc093blByb3BlcnR5KCd0cmFuc2FjdGlvbmFsJykgPyBvcHRpb25zLnRyYW5zYWN0aW9uYWwgOiBmYWxzZTtcblxuICAgICAgLy8gb3B0aW9ucyB0byBjbG9uZSBvYmplY3RzIHdoZW4gaW5zZXJ0aW5nIHRoZW1cbiAgICAgIHRoaXMuY2xvbmVPYmplY3RzID0gb3B0aW9ucy5oYXNPd25Qcm9wZXJ0eSgnY2xvbmUnKSA/IG9wdGlvbnMuY2xvbmUgOiBmYWxzZTtcblxuICAgICAgLy8gZGVmYXVsdCBjbG9uZSBtZXRob2QgKGlmIGVuYWJsZWQpIGlzIHBhcnNlLXN0cmluZ2lmeVxuICAgICAgdGhpcy5jbG9uZU1ldGhvZCA9IG9wdGlvbnMuaGFzT3duUHJvcGVydHkoJ2Nsb25lTWV0aG9kJykgPyBvcHRpb25zLmNsb25lTWV0aG9kIDogXCJwYXJzZS1zdHJpbmdpZnlcIjtcblxuICAgICAgLy8gb3B0aW9uIHRvIG1ha2UgZXZlbnQgbGlzdGVuZXJzIGFzeW5jLCBkZWZhdWx0IGlzIHN5bmNcbiAgICAgIHRoaXMuYXN5bmNMaXN0ZW5lcnMgPSBvcHRpb25zLmhhc093blByb3BlcnR5KCdhc3luY0xpc3RlbmVycycpID8gb3B0aW9ucy5hc3luY0xpc3RlbmVycyA6IGZhbHNlO1xuXG4gICAgICAvLyBpZiBzZXQgdG8gdHJ1ZSB3ZSB3aWxsIG5vdCBtYWludGFpbiBhIG1ldGEgcHJvcGVydHkgZm9yIGEgZG9jdW1lbnRcbiAgICAgIHRoaXMuZGlzYWJsZU1ldGEgPSBvcHRpb25zLmhhc093blByb3BlcnR5KCdkaXNhYmxlTWV0YScpID8gb3B0aW9ucy5kaXNhYmxlTWV0YSA6IGZhbHNlO1xuXG4gICAgICAvLyBkaXNhYmxlIHRyYWNrIGNoYW5nZXNcbiAgICAgIHRoaXMuZGlzYWJsZUNoYW5nZXNBcGkgPSBvcHRpb25zLmhhc093blByb3BlcnR5KCdkaXNhYmxlQ2hhbmdlc0FwaScpID8gb3B0aW9ucy5kaXNhYmxlQ2hhbmdlc0FwaSA6IHRydWU7XG5cbiAgICAgIC8vIGRpc2FibGUgZGVsdGEgdXBkYXRlIG9iamVjdCBzdHlsZSBvbiBjaGFuZ2VzXG4gICAgICB0aGlzLmRpc2FibGVEZWx0YUNoYW5nZXNBcGkgPSBvcHRpb25zLmhhc093blByb3BlcnR5KCdkaXNhYmxlRGVsdGFDaGFuZ2VzQXBpJykgPyBvcHRpb25zLmRpc2FibGVEZWx0YUNoYW5nZXNBcGkgOiB0cnVlO1xuICAgICAgaWYgKHRoaXMuZGlzYWJsZUNoYW5nZXNBcGkpIHsgdGhpcy5kaXNhYmxlRGVsdGFDaGFuZ2VzQXBpID0gdHJ1ZTsgfVxuXG4gICAgICAvLyBvcHRpb24gdG8gb2JzZXJ2ZSBvYmplY3RzIGFuZCB1cGRhdGUgdGhlbSBhdXRvbWF0aWNhbGx5LCBpZ25vcmVkIGlmIE9iamVjdC5vYnNlcnZlIGlzIG5vdCBzdXBwb3J0ZWRcbiAgICAgIHRoaXMuYXV0b3VwZGF0ZSA9IG9wdGlvbnMuaGFzT3duUHJvcGVydHkoJ2F1dG91cGRhdGUnKSA/IG9wdGlvbnMuYXV0b3VwZGF0ZSA6IGZhbHNlO1xuXG4gICAgICAvLyBieSBkZWZhdWx0LCBpZiB5b3UgaW5zZXJ0IGEgZG9jdW1lbnQgaW50byBhIGNvbGxlY3Rpb24gd2l0aCBiaW5hcnkgaW5kaWNlcywgaWYgdGhvc2UgaW5kZXhlZCBwcm9wZXJ0aWVzIGNvbnRhaW5cbiAgICAgIC8vIGEgRGF0ZVRpbWUgd2Ugd2lsbCBjb252ZXJ0IHRvIGVwb2NoIHRpbWUgZm9ybWF0IHNvIHRoYXQgKGFjcm9zcyBzZXJpYWxpemF0aW9ucykgaXRzIHZhbHVlIHBvc2l0aW9uIHdpbGwgYmUgdGhlXG4gICAgICAvLyBzYW1lICdhZnRlcicgc2VyaWFsaXphdGlvbiBhcyBpdCB3YXMgJ2JlZm9yZScuXG4gICAgICB0aGlzLnNlcmlhbGl6YWJsZUluZGljZXMgPSBvcHRpb25zLmhhc093blByb3BlcnR5KCdzZXJpYWxpemFibGVJbmRpY2VzJykgPyBvcHRpb25zLnNlcmlhbGl6YWJsZUluZGljZXMgOiB0cnVlO1xuXG4gICAgICAvL29wdGlvbiB0byBhY3RpdmF0ZSBhIGNsZWFuZXIgZGFlbW9uIC0gY2xlYXJzIFwiYWdlZFwiIGRvY3VtZW50cyBhdCBzZXQgaW50ZXJ2YWxzLlxuICAgICAgdGhpcy50dGwgPSB7XG4gICAgICAgIGFnZTogbnVsbCxcbiAgICAgICAgdHRsSW50ZXJ2YWw6IG51bGwsXG4gICAgICAgIGRhZW1vbjogbnVsbFxuICAgICAgfTtcbiAgICAgIHRoaXMuc2V0VFRMKG9wdGlvbnMudHRsIHx8IC0xLCBvcHRpb25zLnR0bEludGVydmFsKTtcblxuICAgICAgLy8gY3VycmVudE1heElkIC0gY2hhbmdlIG1hbnVhbGx5IGF0IHlvdXIgb3duIHBlcmlsIVxuICAgICAgdGhpcy5tYXhJZCA9IDA7XG5cbiAgICAgIHRoaXMuRHluYW1pY1ZpZXdzID0gW107XG5cbiAgICAgIC8vIGV2ZW50c1xuICAgICAgdGhpcy5ldmVudHMgPSB7XG4gICAgICAgICdpbnNlcnQnOiBbXSxcbiAgICAgICAgJ3VwZGF0ZSc6IFtdLFxuICAgICAgICAncHJlLWluc2VydCc6IFtdLFxuICAgICAgICAncHJlLXVwZGF0ZSc6IFtdLFxuICAgICAgICAnY2xvc2UnOiBbXSxcbiAgICAgICAgJ2ZsdXNoYnVmZmVyJzogW10sXG4gICAgICAgICdlcnJvcic6IFtdLFxuICAgICAgICAnZGVsZXRlJzogW10sXG4gICAgICAgICd3YXJuaW5nJzogW11cbiAgICAgIH07XG5cbiAgICAgIC8vIGNoYW5nZXMgYXJlIHRyYWNrZWQgYnkgY29sbGVjdGlvbiBhbmQgYWdncmVnYXRlZCBieSB0aGUgZGJcbiAgICAgIHRoaXMuY2hhbmdlcyA9IFtdO1xuXG4gICAgICAvLyBpbml0aWFsaXplIHRoZSBpZCBpbmRleFxuICAgICAgdGhpcy5lbnN1cmVJZCgpO1xuICAgICAgdmFyIGluZGljZXMgPSBbXTtcbiAgICAgIC8vIGluaXRpYWxpemUgb3B0aW9uYWwgdXNlci1zdXBwbGllZCBpbmRpY2VzIGFycmF5IFsnYWdlJywgJ2xuYW1lJywgJ3ppcCddXG4gICAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLmluZGljZXMpIHtcbiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChvcHRpb25zLmluZGljZXMpID09PSAnW29iamVjdCBBcnJheV0nKSB7XG4gICAgICAgICAgaW5kaWNlcyA9IG9wdGlvbnMuaW5kaWNlcztcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2Ygb3B0aW9ucy5pbmRpY2VzID09PSAnc3RyaW5nJykge1xuICAgICAgICAgIGluZGljZXMgPSBbb3B0aW9ucy5pbmRpY2VzXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbmRpY2VzIG5lZWRzIHRvIGJlIGEgc3RyaW5nIG9yIGFuIGFycmF5IG9mIHN0cmluZ3MnKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBmb3IgKHZhciBpZHggPSAwOyBpZHggPCBpbmRpY2VzLmxlbmd0aDsgaWR4KyspIHtcbiAgICAgICAgdGhpcy5lbnN1cmVJbmRleChpbmRpY2VzW2lkeF0pO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBvYnNlcnZlckNhbGxiYWNrKGNoYW5nZXMpIHtcblxuICAgICAgICB2YXIgY2hhbmdlZE9iamVjdHMgPSB0eXBlb2YgU2V0ID09PSAnZnVuY3Rpb24nID8gbmV3IFNldCgpIDogW107XG5cbiAgICAgICAgaWYgKCFjaGFuZ2VkT2JqZWN0cy5hZGQpXG4gICAgICAgICAgY2hhbmdlZE9iamVjdHMuYWRkID0gZnVuY3Rpb24gKG9iamVjdCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuaW5kZXhPZihvYmplY3QpID09PSAtMSlcbiAgICAgICAgICAgICAgdGhpcy5wdXNoKG9iamVjdCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICB9O1xuXG4gICAgICAgIGNoYW5nZXMuZm9yRWFjaChmdW5jdGlvbiAoY2hhbmdlKSB7XG4gICAgICAgICAgY2hhbmdlZE9iamVjdHMuYWRkKGNoYW5nZS5vYmplY3QpO1xuICAgICAgICB9KTtcblxuICAgICAgICBjaGFuZ2VkT2JqZWN0cy5mb3JFYWNoKGZ1bmN0aW9uIChvYmplY3QpIHtcbiAgICAgICAgICBpZiAoIWhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCAnJGxva2knKSlcbiAgICAgICAgICAgIHJldHVybiBzZWxmLnJlbW92ZUF1dG9VcGRhdGVPYnNlcnZlcihvYmplY3QpO1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBzZWxmLnVwZGF0ZShvYmplY3QpO1xuICAgICAgICAgIH0gY2F0Y2ggKGVycikge31cbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMub2JzZXJ2ZXJDYWxsYmFjayA9IG9ic2VydmVyQ2FsbGJhY2s7XG5cbiAgICAgIC8vQ29tcGFyZSBjaGFuZ2VkIG9iamVjdCAod2hpY2ggaXMgYSBmb3JjZWQgY2xvbmUpIHdpdGggZXhpc3Rpbmcgb2JqZWN0IGFuZCByZXR1cm4gdGhlIGRlbHRhXG4gICAgICBmdW5jdGlvbiBnZXRDaGFuZ2VEZWx0YShvYmosIG9sZCkge1xuICAgICAgICBpZiAob2xkKSB7XG4gICAgICAgICAgcmV0dXJuIGdldE9iamVjdERlbHRhKG9sZCwgb2JqKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShvYmopKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB0aGlzLmdldENoYW5nZURlbHRhID0gZ2V0Q2hhbmdlRGVsdGE7XG5cbiAgICAgIGZ1bmN0aW9uIGdldE9iamVjdERlbHRhKG9sZE9iamVjdCwgbmV3T2JqZWN0KSB7XG4gICAgICAgIHZhciBwcm9wZXJ0eU5hbWVzID0gbmV3T2JqZWN0ICE9PSBudWxsICYmIHR5cGVvZiBuZXdPYmplY3QgPT09ICdvYmplY3QnID8gT2JqZWN0LmtleXMobmV3T2JqZWN0KSA6IG51bGw7XG4gICAgICAgIGlmIChwcm9wZXJ0eU5hbWVzICYmIHByb3BlcnR5TmFtZXMubGVuZ3RoICYmIFsnc3RyaW5nJywgJ2Jvb2xlYW4nLCAnbnVtYmVyJ10uaW5kZXhPZih0eXBlb2YobmV3T2JqZWN0KSkgPCAwKSB7XG4gICAgICAgICAgdmFyIGRlbHRhID0ge307XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wZXJ0eU5hbWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgcHJvcGVydHlOYW1lID0gcHJvcGVydHlOYW1lc1tpXTtcbiAgICAgICAgICAgIGlmIChuZXdPYmplY3QuaGFzT3duUHJvcGVydHkocHJvcGVydHlOYW1lKSkge1xuICAgICAgICAgICAgICBpZiAoIW9sZE9iamVjdC5oYXNPd25Qcm9wZXJ0eShwcm9wZXJ0eU5hbWUpIHx8IHNlbGYudW5pcXVlTmFtZXMuaW5kZXhPZihwcm9wZXJ0eU5hbWUpID49IDAgfHwgcHJvcGVydHlOYW1lID09ICckbG9raScgfHwgcHJvcGVydHlOYW1lID09ICdtZXRhJykge1xuICAgICAgICAgICAgICAgIGRlbHRhW3Byb3BlcnR5TmFtZV0gPSBuZXdPYmplY3RbcHJvcGVydHlOYW1lXTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgcHJvcGVydHlEZWx0YSA9IGdldE9iamVjdERlbHRhKG9sZE9iamVjdFtwcm9wZXJ0eU5hbWVdLCBuZXdPYmplY3RbcHJvcGVydHlOYW1lXSk7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBwcm9wZXJ0eURlbHRhICE9PSBcInVuZGVmaW5lZFwiICYmIHByb3BlcnR5RGVsdGEgIT0ge30pIHtcbiAgICAgICAgICAgICAgICAgIGRlbHRhW3Byb3BlcnR5TmFtZV0gPSBwcm9wZXJ0eURlbHRhO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gT2JqZWN0LmtleXMoZGVsdGEpLmxlbmd0aCA9PT0gMCA/IHVuZGVmaW5lZCA6IGRlbHRhO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIHJldHVybiBvbGRPYmplY3QgPT09IG5ld09iamVjdCA/IHVuZGVmaW5lZCA6IG5ld09iamVjdDtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB0aGlzLmdldE9iamVjdERlbHRhID0gZ2V0T2JqZWN0RGVsdGE7XG5cbiAgICAgIC8vIGNsZWFyIGFsbCB0aGUgY2hhbmdlc1xuICAgICAgZnVuY3Rpb24gZmx1c2hDaGFuZ2VzKCkge1xuICAgICAgICBzZWxmLmNoYW5nZXMgPSBbXTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5nZXRDaGFuZ2VzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gc2VsZi5jaGFuZ2VzO1xuICAgICAgfTtcblxuICAgICAgdGhpcy5mbHVzaENoYW5nZXMgPSBmbHVzaENoYW5nZXM7XG5cbiAgICAgIHRoaXMuc2V0Q2hhbmdlc0FwaSA9IGZ1bmN0aW9uIChlbmFibGVkKSB7XG4gICAgICAgIHNlbGYuZGlzYWJsZUNoYW5nZXNBcGkgPSAhZW5hYmxlZDtcbiAgICAgICAgaWYgKCFlbmFibGVkKSB7IHNlbGYuZGlzYWJsZURlbHRhQ2hhbmdlc0FwaSA9IGZhbHNlOyB9XG4gICAgICB9O1xuXG4gICAgICB0aGlzLm9uKCdkZWxldGUnLCBmdW5jdGlvbiBkZWxldGVDYWxsYmFjayhvYmopIHtcbiAgICAgICAgaWYgKCFzZWxmLmRpc2FibGVDaGFuZ2VzQXBpKSB7XG4gICAgICAgICAgc2VsZi5jcmVhdGVDaGFuZ2Uoc2VsZi5uYW1lLCAnUicsIG9iaik7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLm9uKCd3YXJuaW5nJywgZnVuY3Rpb24gKHdhcm5pbmcpIHtcbiAgICAgICAgc2VsZi5jb25zb2xlLndhcm4od2FybmluZyk7XG4gICAgICB9KTtcbiAgICAgIC8vIGZvciBkZS1zZXJpYWxpemF0aW9uIHB1cnBvc2VzXG4gICAgICBmbHVzaENoYW5nZXMoKTtcbiAgICB9XG5cbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZSA9IG5ldyBMb2tpRXZlbnRFbWl0dGVyKCk7XG5cbiAgICAvKlxuICAgICAgKiBGb3IgQ2hhbmdlQVBJIGRlZmF1bHQgdG8gY2xvbmUgZW50aXJlIG9iamVjdCwgZm9yIGRlbHRhIGNoYW5nZXMgY3JlYXRlIG9iamVjdCB3aXRoIG9ubHkgZGlmZmVyZW5jZXMgKCsgJGxva2kgYW5kIG1ldGEpXG4gICAgICAqL1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmNyZWF0ZUNoYW5nZSA9IGZ1bmN0aW9uKG5hbWUsIG9wLCBvYmosIG9sZCkge1xuICAgICAgdGhpcy5jaGFuZ2VzLnB1c2goe1xuICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICBvcGVyYXRpb246IG9wLFxuICAgICAgICBvYmo6IG9wID09ICdVJyAmJiAhdGhpcy5kaXNhYmxlRGVsdGFDaGFuZ2VzQXBpID8gdGhpcy5nZXRDaGFuZ2VEZWx0YShvYmosIG9sZCkgOiBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG9iaikpXG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUuaW5zZXJ0TWV0YSA9IGZ1bmN0aW9uKG9iaikge1xuICAgICAgdmFyIGxlbiwgaWR4O1xuXG4gICAgICBpZiAodGhpcy5kaXNhYmxlTWV0YSB8fCAhb2JqKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gaWYgYmF0Y2ggaW5zZXJ0XG4gICAgICBpZiAoQXJyYXkuaXNBcnJheShvYmopKSB7XG4gICAgICAgIGxlbiA9IG9iai5sZW5ndGg7XG5cbiAgICAgICAgZm9yKGlkeD0wOyBpZHg8bGVuOyBpZHgrKykge1xuICAgICAgICAgIGlmICghb2JqW2lkeF0uaGFzT3duUHJvcGVydHkoJ21ldGEnKSkge1xuICAgICAgICAgICAgb2JqW2lkeF0ubWV0YSA9IHt9O1xuICAgICAgICAgIH1cblxuICAgICAgICAgIG9ialtpZHhdLm1ldGEuY3JlYXRlZCA9IChuZXcgRGF0ZSgpKS5nZXRUaW1lKCk7XG4gICAgICAgICAgb2JqW2lkeF0ubWV0YS5yZXZpc2lvbiA9IDA7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIHNpbmdsZSBvYmplY3RcbiAgICAgIGlmICghb2JqLm1ldGEpIHtcbiAgICAgICAgb2JqLm1ldGEgPSB7fTtcbiAgICAgIH1cblxuICAgICAgb2JqLm1ldGEuY3JlYXRlZCA9IChuZXcgRGF0ZSgpKS5nZXRUaW1lKCk7XG4gICAgICBvYmoubWV0YS5yZXZpc2lvbiA9IDA7XG4gICAgfTtcblxuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLnVwZGF0ZU1ldGEgPSBmdW5jdGlvbihvYmopIHtcbiAgICAgIGlmICh0aGlzLmRpc2FibGVNZXRhIHx8ICFvYmopIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgb2JqLm1ldGEudXBkYXRlZCA9IChuZXcgRGF0ZSgpKS5nZXRUaW1lKCk7XG4gICAgICBvYmoubWV0YS5yZXZpc2lvbiArPSAxO1xuICAgIH07XG5cbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5jcmVhdGVJbnNlcnRDaGFuZ2UgPSBmdW5jdGlvbihvYmopIHtcbiAgICAgIHRoaXMuY3JlYXRlQ2hhbmdlKHRoaXMubmFtZSwgJ0knLCBvYmopO1xuICAgIH07XG5cbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5jcmVhdGVVcGRhdGVDaGFuZ2UgPSBmdW5jdGlvbihvYmosIG9sZCkge1xuICAgICAgdGhpcy5jcmVhdGVDaGFuZ2UodGhpcy5uYW1lLCAnVScsIG9iaiwgb2xkKTtcbiAgICB9O1xuXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUuaW5zZXJ0TWV0YVdpdGhDaGFuZ2UgPSBmdW5jdGlvbihvYmopIHtcbiAgICAgIHRoaXMuaW5zZXJ0TWV0YShvYmopO1xuICAgICAgdGhpcy5jcmVhdGVJbnNlcnRDaGFuZ2Uob2JqKTtcbiAgICB9O1xuXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUudXBkYXRlTWV0YVdpdGhDaGFuZ2UgPSBmdW5jdGlvbihvYmosIG9sZCkge1xuICAgICAgdGhpcy51cGRhdGVNZXRhKG9iaik7XG4gICAgICB0aGlzLmNyZWF0ZVVwZGF0ZUNoYW5nZShvYmosIG9sZCk7XG4gICAgfTtcblxuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmNvbnNvbGUgPSB7XG4gICAgICBsb2c6IGZ1bmN0aW9uICgpIHt9LFxuICAgICAgd2FybjogZnVuY3Rpb24gKCkge30sXG4gICAgICBlcnJvcjogZnVuY3Rpb24gKCkge30sXG4gICAgfTtcblxuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmFkZEF1dG9VcGRhdGVPYnNlcnZlciA9IGZ1bmN0aW9uIChvYmplY3QpIHtcbiAgICAgIGlmICghdGhpcy5hdXRvdXBkYXRlIHx8IHR5cGVvZiBPYmplY3Qub2JzZXJ2ZSAhPT0gJ2Z1bmN0aW9uJylcbiAgICAgICAgcmV0dXJuO1xuXG4gICAgICBPYmplY3Qub2JzZXJ2ZShvYmplY3QsIHRoaXMub2JzZXJ2ZXJDYWxsYmFjaywgWydhZGQnLCAndXBkYXRlJywgJ2RlbGV0ZScsICdyZWNvbmZpZ3VyZScsICdzZXRQcm90b3R5cGUnXSk7XG4gICAgfTtcblxuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLnJlbW92ZUF1dG9VcGRhdGVPYnNlcnZlciA9IGZ1bmN0aW9uIChvYmplY3QpIHtcbiAgICAgIGlmICghdGhpcy5hdXRvdXBkYXRlIHx8IHR5cGVvZiBPYmplY3Qub2JzZXJ2ZSAhPT0gJ2Z1bmN0aW9uJylcbiAgICAgICAgcmV0dXJuO1xuXG4gICAgICBPYmplY3QudW5vYnNlcnZlKG9iamVjdCwgdGhpcy5vYnNlcnZlckNhbGxiYWNrKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQWRkcyBhIG5hbWVkIGNvbGxlY3Rpb24gdHJhbnNmb3JtIHRvIHRoZSBjb2xsZWN0aW9uXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgLSBuYW1lIHRvIGFzc29jaWF0ZSB3aXRoIHRyYW5zZm9ybVxuICAgICAqIEBwYXJhbSB7YXJyYXl9IHRyYW5zZm9ybSAtIGFuIGFycmF5IG9mIHRyYW5zZm9ybWF0aW9uICdzdGVwJyBvYmplY3RzIHRvIHNhdmUgaW50byB0aGUgY29sbGVjdGlvblxuICAgICAqIEBtZW1iZXJvZiBDb2xsZWN0aW9uXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiB1c2Vycy5hZGRUcmFuc2Zvcm0oJ3Byb2dlbnknLCBbXG4gICAgICogICB7XG4gICAgICogICAgIHR5cGU6ICdmaW5kJyxcbiAgICAgKiAgICAgdmFsdWU6IHtcbiAgICAgKiAgICAgICAnYWdlJzogeyckbHRlJzogNDB9XG4gICAgICogICAgIH1cbiAgICAgKiAgIH1cbiAgICAgKiBdKTtcbiAgICAgKlxuICAgICAqIHZhciByZXN1bHRzID0gdXNlcnMuY2hhaW4oJ3Byb2dlbnknKS5kYXRhKCk7XG4gICAgICovXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUuYWRkVHJhbnNmb3JtID0gZnVuY3Rpb24gKG5hbWUsIHRyYW5zZm9ybSkge1xuICAgICAgaWYgKHRoaXMudHJhbnNmb3Jtcy5oYXNPd25Qcm9wZXJ0eShuYW1lKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJhIHRyYW5zZm9ybSBieSB0aGF0IG5hbWUgYWxyZWFkeSBleGlzdHNcIik7XG4gICAgICB9XG5cbiAgICAgIHRoaXMudHJhbnNmb3Jtc1tuYW1lXSA9IHRyYW5zZm9ybTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUmV0cmlldmVzIGEgbmFtZWQgdHJhbnNmb3JtIGZyb20gdGhlIGNvbGxlY3Rpb24uXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgLSBuYW1lIG9mIHRoZSB0cmFuc2Zvcm0gdG8gbG9va3VwLlxuICAgICAqIEBtZW1iZXJvZiBDb2xsZWN0aW9uXG4gICAgICovXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUuZ2V0VHJhbnNmb3JtID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgIHJldHVybiB0aGlzLnRyYW5zZm9ybXNbbmFtZV07XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZXMgYSBuYW1lZCBjb2xsZWN0aW9uIHRyYW5zZm9ybSB0byB0aGUgY29sbGVjdGlvblxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIC0gbmFtZSB0byBhc3NvY2lhdGUgd2l0aCB0cmFuc2Zvcm1cbiAgICAgKiBAcGFyYW0ge29iamVjdH0gdHJhbnNmb3JtIC0gYSB0cmFuc2Zvcm1hdGlvbiBvYmplY3QgdG8gc2F2ZSBpbnRvIGNvbGxlY3Rpb25cbiAgICAgKiBAbWVtYmVyb2YgQ29sbGVjdGlvblxuICAgICAqL1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLnNldFRyYW5zZm9ybSA9IGZ1bmN0aW9uIChuYW1lLCB0cmFuc2Zvcm0pIHtcbiAgICAgIHRoaXMudHJhbnNmb3Jtc1tuYW1lXSA9IHRyYW5zZm9ybTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyBhIG5hbWVkIGNvbGxlY3Rpb24gdHJhbnNmb3JtIGZyb20gdGhlIGNvbGxlY3Rpb25cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZSAtIG5hbWUgb2YgY29sbGVjdGlvbiB0cmFuc2Zvcm0gdG8gcmVtb3ZlXG4gICAgICogQG1lbWJlcm9mIENvbGxlY3Rpb25cbiAgICAgKi9cbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5yZW1vdmVUcmFuc2Zvcm0gPSBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgZGVsZXRlIHRoaXMudHJhbnNmb3Jtc1tuYW1lXTtcbiAgICB9O1xuXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUuYnlFeGFtcGxlID0gZnVuY3Rpb24gKHRlbXBsYXRlKSB7XG4gICAgICB2YXIgaywgb2JqLCBxdWVyeTtcbiAgICAgIHF1ZXJ5ID0gW107XG4gICAgICBmb3IgKGsgaW4gdGVtcGxhdGUpIHtcbiAgICAgICAgaWYgKCF0ZW1wbGF0ZS5oYXNPd25Qcm9wZXJ0eShrKSkgY29udGludWU7XG4gICAgICAgIHF1ZXJ5LnB1c2goKFxuICAgICAgICAgIG9iaiA9IHt9LFxuICAgICAgICAgIG9ialtrXSA9IHRlbXBsYXRlW2tdLFxuICAgICAgICAgIG9ialxuICAgICAgICApKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB7XG4gICAgICAgICckYW5kJzogcXVlcnlcbiAgICAgIH07XG4gICAgfTtcblxuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmZpbmRPYmplY3QgPSBmdW5jdGlvbiAodGVtcGxhdGUpIHtcbiAgICAgIHJldHVybiB0aGlzLmZpbmRPbmUodGhpcy5ieUV4YW1wbGUodGVtcGxhdGUpKTtcbiAgICB9O1xuXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUuZmluZE9iamVjdHMgPSBmdW5jdGlvbiAodGVtcGxhdGUpIHtcbiAgICAgIHJldHVybiB0aGlzLmZpbmQodGhpcy5ieUV4YW1wbGUodGVtcGxhdGUpKTtcbiAgICB9O1xuXG4gICAgLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tK1xuICAgIHwgVFRMIGRhZW1vbiAgICAgICAgICAgICAgICAgIHxcbiAgICArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUudHRsRGFlbW9uRnVuY0dlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBjb2xsZWN0aW9uID0gdGhpcztcbiAgICAgIHZhciBhZ2UgPSB0aGlzLnR0bC5hZ2U7XG4gICAgICByZXR1cm4gZnVuY3Rpb24gdHRsRGFlbW9uKCkge1xuICAgICAgICB2YXIgbm93ID0gRGF0ZS5ub3coKTtcbiAgICAgICAgdmFyIHRvUmVtb3ZlID0gY29sbGVjdGlvbi5jaGFpbigpLndoZXJlKGZ1bmN0aW9uIGRhZW1vbkZpbHRlcihtZW1iZXIpIHtcbiAgICAgICAgICB2YXIgdGltZXN0YW1wID0gbWVtYmVyLm1ldGEudXBkYXRlZCB8fCBtZW1iZXIubWV0YS5jcmVhdGVkO1xuICAgICAgICAgIHZhciBkaWZmID0gbm93IC0gdGltZXN0YW1wO1xuICAgICAgICAgIHJldHVybiBhZ2UgPCBkaWZmO1xuICAgICAgICB9KTtcbiAgICAgICAgdG9SZW1vdmUucmVtb3ZlKCk7XG4gICAgICB9O1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGVzIG9yIGFwcGxpZXMgY29sbGVjdGlvbiBUVEwgc2V0dGluZ3MuXG4gICAgICogQHBhcmFtIHtpbnR9IGFnZSAtIGFnZSAoaW4gbXMpIHRvIGV4cGlyZSBkb2N1bWVudCBmcm9tIGNvbGxlY3Rpb25cbiAgICAgKiBAcGFyYW0ge2ludH0gaW50ZXJ2YWwgLSB0aW1lIChpbiBtcykgdG8gY2xlYXIgY29sbGVjdGlvbiBvZiBhZ2VkIGRvY3VtZW50cy5cbiAgICAgKiBAbWVtYmVyb2YgQ29sbGVjdGlvblxuICAgICAqL1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLnNldFRUTCA9IGZ1bmN0aW9uIChhZ2UsIGludGVydmFsKSB7XG4gICAgICBpZiAoYWdlIDwgMCkge1xuICAgICAgICBjbGVhckludGVydmFsKHRoaXMudHRsLmRhZW1vbik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnR0bC5hZ2UgPSBhZ2U7XG4gICAgICAgIHRoaXMudHRsLnR0bEludGVydmFsID0gaW50ZXJ2YWw7XG4gICAgICAgIHRoaXMudHRsLmRhZW1vbiA9IHNldEludGVydmFsKHRoaXMudHRsRGFlbW9uRnVuY0dlbigpLCBpbnRlcnZhbCk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLStcbiAgICB8IElOREVYSU5HICAgICAgICAgICAgICAgICAgICB8XG4gICAgKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4gICAgLyoqXG4gICAgICogY3JlYXRlIGEgcm93IGZpbHRlciB0aGF0IGNvdmVycyBhbGwgZG9jdW1lbnRzIGluIHRoZSBjb2xsZWN0aW9uXG4gICAgICovXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUucHJlcGFyZUZ1bGxEb2NJbmRleCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBsZW4gPSB0aGlzLmRhdGEubGVuZ3RoO1xuICAgICAgdmFyIGluZGV4ZXMgPSBuZXcgQXJyYXkobGVuKTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpICs9IDEpIHtcbiAgICAgICAgaW5kZXhlc1tpXSA9IGk7XG4gICAgICB9XG4gICAgICByZXR1cm4gaW5kZXhlcztcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogV2lsbCBhbGxvdyByZWNvbmZpZ3VyaW5nIGNlcnRhaW4gY29sbGVjdGlvbiBvcHRpb25zLlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gb3B0aW9ucy5hZGFwdGl2ZUJpbmFyeUluZGljZXMgLSBjb2xsZWN0aW9uIGluZGljZXMgd2lsbCBiZSBhY3RpdmVseSByZWJ1aWx0IHJhdGhlciB0aGFuIGxhemlseVxuICAgICAqIEBtZW1iZXJvZiBDb2xsZWN0aW9uXG4gICAgICovXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUuY29uZmlndXJlT3B0aW9ucyA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblxuICAgICAgaWYgKG9wdGlvbnMuaGFzT3duUHJvcGVydHkoJ2FkYXB0aXZlQmluYXJ5SW5kaWNlcycpKSB7XG4gICAgICAgIHRoaXMuYWRhcHRpdmVCaW5hcnlJbmRpY2VzID0gb3B0aW9ucy5hZGFwdGl2ZUJpbmFyeUluZGljZXM7XG5cbiAgICAgICAgLy8gaWYgc3dpdGNoaW5nIHRvIGFkYXB0aXZlIGJpbmFyeSBpbmRpY2VzLCBtYWtlIHN1cmUgbm9uZSBhcmUgJ2RpcnR5J1xuICAgICAgICBpZiAodGhpcy5hZGFwdGl2ZUJpbmFyeUluZGljZXMpIHtcbiAgICAgICAgICB0aGlzLmVuc3VyZUFsbEluZGV4ZXMoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBFbnN1cmUgYmluYXJ5IGluZGV4IG9uIGEgY2VydGFpbiBmaWVsZFxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBwcm9wZXJ0eSAtIG5hbWUgb2YgcHJvcGVydHkgdG8gY3JlYXRlIGJpbmFyeSBpbmRleCBvblxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbj19IGZvcmNlIC0gKE9wdGlvbmFsKSBmbGFnIGluZGljYXRpbmcgd2hldGhlciB0byBjb25zdHJ1Y3QgaW5kZXggaW1tZWRpYXRlbHlcbiAgICAgKiBAbWVtYmVyb2YgQ29sbGVjdGlvblxuICAgICAqL1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmVuc3VyZUluZGV4ID0gZnVuY3Rpb24gKHByb3BlcnR5LCBmb3JjZSkge1xuICAgICAgLy8gb3B0aW9uYWwgcGFyYW1ldGVyIHRvIGZvcmNlIHJlYnVpbGQgd2hldGhlciBmbGFnZ2VkIGFzIGRpcnR5IG9yIG5vdFxuICAgICAgaWYgKHR5cGVvZiAoZm9yY2UpID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICBmb3JjZSA9IGZhbHNlO1xuICAgICAgfVxuXG4gICAgICBpZiAocHJvcGVydHkgPT09IG51bGwgfHwgcHJvcGVydHkgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0F0dGVtcHRpbmcgdG8gc2V0IGluZGV4IHdpdGhvdXQgYW4gYXNzb2NpYXRlZCBwcm9wZXJ0eScpO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5iaW5hcnlJbmRpY2VzW3Byb3BlcnR5XSAmJiAhZm9yY2UpIHtcbiAgICAgICAgaWYgKCF0aGlzLmJpbmFyeUluZGljZXNbcHJvcGVydHldLmRpcnR5KSByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIGlmIHRoZSBpbmRleCBpcyBhbHJlYWR5IGRlZmluZWQgYW5kIHdlIGFyZSB1c2luZyBhZGFwdGl2ZUJpbmFyeUluZGljZXMgYW5kIHdlIGFyZSBub3QgZm9yY2luZyBhIHJlYnVpbGQsIHJldHVybi5cbiAgICAgIGlmICh0aGlzLmFkYXB0aXZlQmluYXJ5SW5kaWNlcyA9PT0gdHJ1ZSAmJiB0aGlzLmJpbmFyeUluZGljZXMuaGFzT3duUHJvcGVydHkocHJvcGVydHkpICYmICFmb3JjZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHZhciBpbmRleCA9IHtcbiAgICAgICAgJ25hbWUnOiBwcm9wZXJ0eSxcbiAgICAgICAgJ2RpcnR5JzogdHJ1ZSxcbiAgICAgICAgJ3ZhbHVlcyc6IHRoaXMucHJlcGFyZUZ1bGxEb2NJbmRleCgpXG4gICAgICB9O1xuICAgICAgdGhpcy5iaW5hcnlJbmRpY2VzW3Byb3BlcnR5XSA9IGluZGV4O1xuXG4gICAgICB2YXIgd3JhcHBlZENvbXBhcmVyID1cbiAgICAgICAgKGZ1bmN0aW9uIChwcm9wLCBkYXRhKSB7XG4gICAgICAgICAgdmFyIHZhbDEsIHZhbDIsIGFycjtcbiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgICAgIGlmICh+cHJvcC5pbmRleE9mKCcuJykpIHtcbiAgICAgICAgICAgICAgYXJyID0gcHJvcC5zcGxpdCgnLicpO1xuICAgICAgICAgICAgICB2YWwxID0gVXRpbHMuZ2V0SW4oZGF0YVthXSwgYXJyLCB0cnVlKTtcbiAgICAgICAgICAgICAgdmFsMiA9IFV0aWxzLmdldEluKGRhdGFbYl0sIGFyciwgdHJ1ZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICB2YWwxID0gZGF0YVthXVtwcm9wXTtcbiAgICAgICAgICAgICAgdmFsMiA9IGRhdGFbYl1bcHJvcF07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh2YWwxICE9PSB2YWwyKSB7XG4gICAgICAgICAgICAgIGlmIChDb21wYXJhdG9ycy5sdCh2YWwxLCB2YWwyLCBmYWxzZSkpIHJldHVybiAtMTtcbiAgICAgICAgICAgICAgaWYgKENvbXBhcmF0b3JzLmd0KHZhbDEsIHZhbDIsIGZhbHNlKSkgcmV0dXJuIDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICB9O1xuICAgICAgICB9KShwcm9wZXJ0eSwgdGhpcy5kYXRhKTtcblxuICAgICAgaW5kZXgudmFsdWVzLnNvcnQod3JhcHBlZENvbXBhcmVyKTtcbiAgICAgIGluZGV4LmRpcnR5ID0gZmFsc2U7XG5cbiAgICAgIHRoaXMuZGlydHkgPSB0cnVlOyAvLyBmb3IgYXV0b3NhdmUgc2NlbmFyaW9zXG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFBlcmZvcm0gY2hlY2tzIHRvIGRldGVybWluZSB2YWxpZGl0eS9jb25zaXN0ZW5jeSBvZiBhbGwgYmluYXJ5IGluZGljZXNcbiAgICAgKiBAcGFyYW0ge29iamVjdD19IG9wdGlvbnMgLSBvcHRpb25hbCBjb25maWd1cmF0aW9uIG9iamVjdFxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMucmFuZG9tU2FtcGxpbmc9ZmFsc2VdIC0gd2hldGhlciAoZmFzdGVyKSByYW5kb20gc2FtcGxpbmcgc2hvdWxkIGJlIHVzZWRcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW29wdGlvbnMucmFuZG9tU2FtcGxpbmdGYWN0b3I9MC4xMF0gLSBwZXJjZW50YWdlIG9mIHRvdGFsIHJvd3MgdG8gcmFuZG9tbHkgc2FtcGxlXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5yZXBhaXI9ZmFsc2VdIC0gd2hldGhlciB0byBmaXggcHJvYmxlbXMgaWYgdGhleSBhcmUgZW5jb3VudGVyZWRcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nW119IGFycmF5IG9mIGluZGV4IG5hbWVzIHdoZXJlIHByb2JsZW1zIHdlcmUgZm91bmQuXG4gICAgICogQG1lbWJlcm9mIENvbGxlY3Rpb25cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGNoZWNrIGFsbCBpbmRpY2VzIG9uIGEgY29sbGVjdGlvbiwgcmV0dXJucyBhcnJheSBvZiBpbnZhbGlkIGluZGV4IG5hbWVzXG4gICAgICogdmFyIHJlc3VsdCA9IGNvbGwuY2hlY2tBbGxJbmRleGVzKHsgcmVwYWlyOiB0cnVlLCByYW5kb21TYW1wbGluZzogdHJ1ZSwgcmFuZG9tU2FtcGxpbmdGYWN0b3I6IDAuMTUgfSk7XG4gICAgICogaWYgKHJlc3VsdC5sZW5ndGggPiAwKSB7XG4gICAgICogICByZXN1bHRzLmZvckVhY2goZnVuY3Rpb24obmFtZSkgeyBcbiAgICAgKiAgICAgY29uc29sZS5sb2coJ3Byb2JsZW0gZW5jb3VudGVyZWQgd2l0aCBpbmRleCA6ICcgKyBuYW1lKTsgXG4gICAgICogICB9KTtcbiAgICAgKiB9ICAgICBcbiAgICAgKi9cbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5jaGVja0FsbEluZGV4ZXMgPSBmdW5jdGlvbiAob3B0aW9ucykge1xuICAgICAgdmFyIGtleSwgYkluZGljZXMgPSB0aGlzLmJpbmFyeUluZGljZXM7XG4gICAgICB2YXIgcmVzdWx0cyA9IFtdLCByZXN1bHQ7XG5cbiAgICAgIGZvciAoa2V5IGluIGJJbmRpY2VzKSB7XG4gICAgICAgIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKGJJbmRpY2VzLCBrZXkpKSB7XG4gICAgICAgICAgcmVzdWx0ID0gdGhpcy5jaGVja0luZGV4KGtleSwgb3B0aW9ucyk7XG4gICAgICAgICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgICAgICAgIHJlc3VsdHMucHVzaChrZXkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gcmVzdWx0cztcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUGVyZm9ybSBjaGVja3MgdG8gZGV0ZXJtaW5lIHZhbGlkaXR5L2NvbnNpc3RlbmN5IG9mIGEgYmluYXJ5IGluZGV4XG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHByb3BlcnR5IC0gbmFtZSBvZiB0aGUgYmluYXJ5LWluZGV4ZWQgcHJvcGVydHkgdG8gY2hlY2tcbiAgICAgKiBAcGFyYW0ge29iamVjdD19IG9wdGlvbnMgLSBvcHRpb25hbCBjb25maWd1cmF0aW9uIG9iamVjdFxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMucmFuZG9tU2FtcGxpbmc9ZmFsc2VdIC0gd2hldGhlciAoZmFzdGVyKSByYW5kb20gc2FtcGxpbmcgc2hvdWxkIGJlIHVzZWRcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW29wdGlvbnMucmFuZG9tU2FtcGxpbmdGYWN0b3I9MC4xMF0gLSBwZXJjZW50YWdlIG9mIHRvdGFsIHJvd3MgdG8gcmFuZG9tbHkgc2FtcGxlXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5yZXBhaXI9ZmFsc2VdIC0gd2hldGhlciB0byBmaXggcHJvYmxlbXMgaWYgdGhleSBhcmUgZW5jb3VudGVyZWRcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gd2hldGhlciB0aGUgaW5kZXggd2FzIGZvdW5kIHRvIGJlIHZhbGlkIChiZWZvcmUgb3B0aW9uYWwgY29ycmVjdGluZykuXG4gICAgICogQG1lbWJlcm9mIENvbGxlY3Rpb25cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIGZ1bGwgdGVzdFxuICAgICAqIHZhciB2YWxpZCA9IGNvbGwuY2hlY2tJbmRleCgnbmFtZScpO1xuICAgICAqIC8vIGZ1bGwgdGVzdCB3aXRoIHJlcGFpciAoaWYgaXNzdWVzIGZvdW5kKVxuICAgICAqIHZhbGlkID0gY29sbC5jaGVja0luZGV4KCduYW1lJywgeyByZXBhaXI6IHRydWUgfSk7XG4gICAgICogLy8gcmFuZG9tIHNhbXBsaW5nIChkZWZhdWx0IGlzIDEwJSBvZiB0b3RhbCBkb2N1bWVudCBjb3VudClcbiAgICAgKiB2YWxpZCA9IGNvbGwuY2hlY2tJbmRleCgnbmFtZScsIHsgcmFuZG9tU2FtcGxpbmc6IHRydWUgfSk7XG4gICAgICogLy8gcmFuZG9tIHNhbXBsaW5nIChzYW1wbGUgMjAlIG9mIHRvdGFsIGRvY3VtZW50IGNvdW50KVxuICAgICAqIHZhbGlkID0gY29sbC5jaGVja0luZGV4KCduYW1lJywgeyByYW5kb21TYW1wbGluZzogdHJ1ZSwgcmFuZG9tU2FtcGxpbmdGYWN0b3I6IDAuMjAgfSk7XG4gICAgICogLy8gcmFuZG9tIHNhbXBsaW5nIChpbXBsaWVkIGJvb2xlYW4pXG4gICAgICogdmFsaWQgPSBjb2xsLmNoZWNrSW5kZXgoJ25hbWUnLCB7IHJhbmRvbVNhbXBsaW5nRmFjdG9yOiAwLjIwIH0pO1xuICAgICAqIC8vIHJhbmRvbSBzYW1wbGluZyB3aXRoIHJlcGFpciAoaWYgaXNzdWVzIGZvdW5kKVxuICAgICAqIHZhbGlkID0gY29sbC5jaGVja0luZGV4KCduYW1lJywgeyByZXBhaXI6IHRydWUsIHJhbmRvbVNhbXBsaW5nOiB0cnVlIH0pO1xuICAgICAqL1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmNoZWNrSW5kZXggPSBmdW5jdGlvbiAocHJvcGVydHksIG9wdGlvbnMpIHtcbiAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICAgICAgLy8gaWYgJ3JhbmRvbVNhbXBsaW5nRmFjdG9yJyBzcGVjaWZpZWQgYnV0IG5vdCAncmFuZG9tU2FtcGxpbmcnLCBhc3N1bWUgdHJ1ZVxuICAgICAgaWYgKG9wdGlvbnMucmFuZG9tU2FtcGxpbmdGYWN0b3IgJiYgb3B0aW9ucy5yYW5kb21TYW1wbGluZyAhPT0gZmFsc2UpIHtcbiAgICAgICAgb3B0aW9ucy5yYW5kb21TYW1wbGluZyA9IHRydWU7XG4gICAgICB9XG4gICAgICBvcHRpb25zLnJhbmRvbVNhbXBsaW5nRmFjdG9yID0gb3B0aW9ucy5yYW5kb21TYW1wbGluZ0ZhY3RvciB8fCAwLjE7XG4gICAgICBpZiAob3B0aW9ucy5yYW5kb21TYW1wbGluZ0ZhY3RvciA8IDAgfHwgb3B0aW9ucy5yYW5kb21TYW1wbGluZ0ZhY3RvciA+IDEpIHtcbiAgICAgICAgb3B0aW9ucy5yYW5kb21TYW1wbGluZ0ZhY3RvciA9IDAuMTtcbiAgICAgIH1cblxuICAgICAgdmFyIHZhbGlkPXRydWUsIGlkeCwgaXRlciwgcG9zLCBsZW4sIGJpdjtcblxuICAgICAgLy8gbWFrZSBzdXJlIHdlIGFyZSBwYXNzZWQgYSB2YWxpZCBiaW5hcnkgaW5kZXggbmFtZVxuICAgICAgaWYgKCF0aGlzLmJpbmFyeUluZGljZXMuaGFzT3duUHJvcGVydHkocHJvcGVydHkpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcImNhbGxlZCBjaGVja0luZGV4IG9uIHByb3BlcnR5IHdpdGhvdXQgYW4gaW5kZXg6IFwiICsgcHJvcGVydHkpO1xuICAgICAgfVxuXG4gICAgICAvLyBpZiBsYXp5IGluZGV4aW5nLCByZWJ1aWxkIG9ubHkgaWYgZmxhZ2dlZCBhcyBkaXJ0eVxuICAgICAgaWYgKCF0aGlzLmFkYXB0aXZlQmluYXJ5SW5kaWNlcykge1xuICAgICAgICB0aGlzLmVuc3VyZUluZGV4KHByb3BlcnR5KTtcbiAgICAgIH1cblxuICAgICAgYml2ID0gdGhpcy5iaW5hcnlJbmRpY2VzW3Byb3BlcnR5XS52YWx1ZXM7XG4gICAgICBsZW4gPSBiaXYubGVuZ3RoO1xuXG4gICAgICAvLyBpZiB0aGUgaW5kZXggaGFzIGFuIGluY29ycmVjdCBudW1iZXIgb2YgdmFsdWVzXG4gICAgICBpZiAobGVuICE9PSB0aGlzLmRhdGEubGVuZ3RoKSB7XG4gICAgICAgIGlmIChvcHRpb25zLnJlcGFpcikge1xuICAgICAgICAgIHRoaXMuZW5zdXJlSW5kZXgocHJvcGVydHksIHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgaWYgKGxlbiA9PT0gMCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgdmFyIHVzaW5nRG90Tm90YXRpb24gPSAocHJvcGVydHkuaW5kZXhPZignLicpICE9PSAtMSk7XG5cbiAgICAgIGlmIChsZW4gPT09IDEpIHtcbiAgICAgICAgdmFsaWQgPSAoYml2WzBdID09PSAwKTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICBpZiAob3B0aW9ucy5yYW5kb21TYW1wbGluZykge1xuICAgICAgICAgIC8vIHZhbGlkYXRlIGZpcnN0IGFuZCBsYXN0XG4gICAgICAgICAgaWYgKCFMb2tpT3BzLiRsdGUoVXRpbHMuZ2V0SW4odGhpcy5kYXRhW2JpdlswXV0sIHByb3BlcnR5LCB1c2luZ0RvdE5vdGF0aW9uKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBVdGlscy5nZXRJbih0aGlzLmRhdGFbYml2WzFdXSwgcHJvcGVydHksIHVzaW5nRG90Tm90YXRpb24pKSkge1xuICAgICAgICAgICAgdmFsaWQ9ZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICghTG9raU9wcy4kbHRlKFV0aWxzLmdldEluKHRoaXMuZGF0YVtiaXZbbGVuLTJdXSwgcHJvcGVydHksIHVzaW5nRG90Tm90YXRpb24pLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFV0aWxzLmdldEluKHRoaXMuZGF0YVtiaXZbbGVuLTFdXSwgcHJvcGVydHksIHVzaW5nRG90Tm90YXRpb24pKSkge1xuICAgICAgICAgICAgdmFsaWQ9ZmFsc2U7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gaWYgZmlyc3QgYW5kIGxhc3QgcG9zaXRpb25zIGFyZSBzb3J0ZWQgY29ycmVjdGx5IHdpdGggdGhlaXIgbmVhcmVzdCBuZWlnaGJvcixcbiAgICAgICAgICAvLyBjb250aW51ZSBvbnRvIHJhbmRvbSBzYW1wbGluZyBwaGFzZS4uLlxuICAgICAgICAgIGlmICh2YWxpZCkge1xuICAgICAgICAgICAgLy8gIyByYW5kb20gc2FtcGxpbmdzID0gdG90YWwgY291bnQgKiBzYW1wbGluZyBmYWN0b3JcbiAgICAgICAgICAgIGl0ZXIgPSBNYXRoLmZsb29yKChsZW4tMSkgKiBvcHRpb25zLnJhbmRvbVNhbXBsaW5nRmFjdG9yKTtcblxuICAgICAgICAgICAgLy8gZm9yIGVhY2ggcmFuZG9tIHNhbXBsaW5nLCB2YWxpZGF0ZSB0aGF0IHRoZSBiaW5hcnkgaW5kZXggaXMgc2VxdWVuY2VkIHByb3Blcmx5XG4gICAgICAgICAgICAvLyB3aXRoIG5leHQgaGlnaGVyIHZhbHVlLlxuICAgICAgICAgICAgZm9yKGlkeD0wOyBpZHg8aXRlci0xOyBpZHgrKykge1xuICAgICAgICAgICAgICAvLyBjYWxjdWxhdGUgcmFuZG9tIHBvc2l0aW9uXG4gICAgICAgICAgICAgIHBvcyA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChsZW4tMSkpO1xuICAgICAgICAgICAgICBpZiAoIUxva2lPcHMuJGx0ZShVdGlscy5nZXRJbih0aGlzLmRhdGFbYml2W3Bvc11dLCBwcm9wZXJ0eSwgdXNpbmdEb3ROb3RhdGlvbiksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFV0aWxzLmdldEluKHRoaXMuZGF0YVtiaXZbcG9zKzFdXSwgcHJvcGVydHksIHVzaW5nRG90Tm90YXRpb24pKSkge1xuICAgICAgICAgICAgICAgIHZhbGlkPWZhbHNlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIC8vIHZhbGlkYXRlIHRoYXQgdGhlIGJpbmFyeSBpbmRleCBpcyBzZXF1ZW5jZWQgcHJvcGVybHlcbiAgICAgICAgICBmb3IoaWR4PTA7IGlkeDxsZW4tMTsgaWR4KyspIHtcbiAgICAgICAgICAgIGlmICghTG9raU9wcy4kbHRlKFV0aWxzLmdldEluKHRoaXMuZGF0YVtiaXZbaWR4XV0sIHByb3BlcnR5LCB1c2luZ0RvdE5vdGF0aW9uKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFV0aWxzLmdldEluKHRoaXMuZGF0YVtiaXZbaWR4KzFdXSwgcHJvcGVydHksIHVzaW5nRG90Tm90YXRpb24pKSkge1xuICAgICAgICAgICAgICB2YWxpZD1mYWxzZTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIGlmIGluY29ycmVjdGx5IHNlcXVlbmNlZCBhbmQgd2UgYXJlIHRvIGZpeCBwcm9ibGVtcywgcmVidWlsZCBpbmRleFxuICAgICAgaWYgKCF2YWxpZCAmJiBvcHRpb25zLnJlcGFpcikge1xuICAgICAgICB0aGlzLmVuc3VyZUluZGV4KHByb3BlcnR5LCB0cnVlKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHZhbGlkO1xuICAgIH07XG5cbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5nZXRCaW5hcnlJbmRleFZhbHVlcyA9IGZ1bmN0aW9uIChwcm9wZXJ0eSkge1xuICAgICAgdmFyIGlkeCwgaWR4dmFscyA9IHRoaXMuYmluYXJ5SW5kaWNlc1twcm9wZXJ0eV0udmFsdWVzO1xuICAgICAgdmFyIHJlc3VsdCA9IFtdO1xuXG4gICAgICBmb3IgKGlkeCA9IDA7IGlkeCA8IGlkeHZhbHMubGVuZ3RoOyBpZHgrKykge1xuICAgICAgICByZXN1bHQucHVzaChVdGlscy5nZXRJbih0aGlzLmRhdGFbaWR4dmFsc1tpZHhdXSwgcHJvcGVydHksIHRydWUpKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUuZW5zdXJlVW5pcXVlSW5kZXggPSBmdW5jdGlvbiAoZmllbGQpIHtcbiAgICAgIHZhciBpbmRleCA9IHRoaXMuY29uc3RyYWludHMudW5pcXVlW2ZpZWxkXTtcbiAgICAgIGlmICghaW5kZXgpIHtcbiAgICAgICAgLy8ga2VlcCB0cmFjayBvZiBuZXcgdW5pcXVlIGluZGV4IGZvciByZWdlbmVyYXRlIGFmdGVyIGRhdGFiYXNlIChyZSlsb2FkLlxuICAgICAgICBpZiAodGhpcy51bmlxdWVOYW1lcy5pbmRleE9mKGZpZWxkKSA9PSAtMSkge1xuICAgICAgICAgIHRoaXMudW5pcXVlTmFtZXMucHVzaChmaWVsZCk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gaWYgaW5kZXggYWxyZWFkeSBleGlzdGVkLCAocmUpbG9hZGluZyBpdCB3aWxsIGxpa2VseSBjYXVzZSBjb2xsaXNpb25zLCByZWJ1aWxkIGFsd2F5c1xuICAgICAgdGhpcy5jb25zdHJhaW50cy51bmlxdWVbZmllbGRdID0gaW5kZXggPSBuZXcgVW5pcXVlSW5kZXgoZmllbGQpO1xuICAgICAgdGhpcy5kYXRhLmZvckVhY2goZnVuY3Rpb24gKG9iaikge1xuICAgICAgICBpbmRleC5zZXQob2JqKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGluZGV4O1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBFbnN1cmUgYWxsIGJpbmFyeSBpbmRpY2VzXG4gICAgICogQHBhcmFtIHtib29sZWFufSBmb3JjZSAtIHdoZXRoZXIgdG8gZm9yY2UgcmVidWlsZCBvZiBleGlzdGluZyBsYXp5IGJpbmFyeSBpbmRpY2VzXG4gICAgICogQG1lbWJlcm9mIENvbGxlY3Rpb25cbiAgICAgKi9cbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5lbnN1cmVBbGxJbmRleGVzID0gZnVuY3Rpb24gKGZvcmNlKSB7XG4gICAgICB2YXIga2V5LCBiSW5kaWNlcyA9IHRoaXMuYmluYXJ5SW5kaWNlcztcbiAgICAgIGZvciAoa2V5IGluIGJJbmRpY2VzKSB7XG4gICAgICAgIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKGJJbmRpY2VzLCBrZXkpKSB7XG4gICAgICAgICAgdGhpcy5lbnN1cmVJbmRleChrZXksIGZvcmNlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBJbnRlcm5hbCBtZXRob2QgdXNlZCB0byBmbGFnIGFsbCBsYXp5IGluZGV4IGFzIGRpcnR5XG4gICAgICovXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUuZmxhZ0JpbmFyeUluZGV4ZXNEaXJ0eSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBrZXksIGJJbmRpY2VzID0gdGhpcy5iaW5hcnlJbmRpY2VzO1xuICAgICAgZm9yIChrZXkgaW4gYkluZGljZXMpIHtcbiAgICAgICAgaWYgKGhhc093blByb3BlcnR5LmNhbGwoYkluZGljZXMsIGtleSkpIHtcbiAgICAgICAgICBiSW5kaWNlc1trZXldLmRpcnR5ID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBJbnRlcm5hbCBtZXRob2QgdXNlZCB0byBmbGFnIGEgbGF6eSBpbmRleCBhcyBkaXJ0eVxuICAgICAqL1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmZsYWdCaW5hcnlJbmRleERpcnR5ID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICBpZiAodGhpcy5iaW5hcnlJbmRpY2VzW2luZGV4XSlcbiAgICAgICAgdGhpcy5iaW5hcnlJbmRpY2VzW2luZGV4XS5kaXJ0eSA9IHRydWU7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFF1aWNrbHkgZGV0ZXJtaW5lIG51bWJlciBvZiBkb2N1bWVudHMgaW4gY29sbGVjdGlvbiAob3IgcXVlcnkpXG4gICAgICogQHBhcmFtIHtvYmplY3Q9fSBxdWVyeSAtIChvcHRpb25hbCkgcXVlcnkgb2JqZWN0IHRvIGNvdW50IHJlc3VsdHMgb2ZcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBudW1iZXIgb2YgZG9jdW1lbnRzIGluIHRoZSBjb2xsZWN0aW9uXG4gICAgICogQG1lbWJlcm9mIENvbGxlY3Rpb25cbiAgICAgKi9cbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5jb3VudCA9IGZ1bmN0aW9uIChxdWVyeSkge1xuICAgICAgaWYgKCFxdWVyeSkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYXRhLmxlbmd0aDtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMuY2hhaW4oKS5maW5kKHF1ZXJ5KS5maWx0ZXJlZHJvd3MubGVuZ3RoO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBSZWJ1aWxkIGlkSW5kZXhcbiAgICAgKi9cbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5lbnN1cmVJZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBsZW4gPSB0aGlzLmRhdGEubGVuZ3RoLFxuICAgICAgICBpID0gMDtcblxuICAgICAgdGhpcy5pZEluZGV4ID0gW107XG4gICAgICBmb3IgKGk7IGkgPCBsZW47IGkgKz0gMSkge1xuICAgICAgICB0aGlzLmlkSW5kZXgucHVzaCh0aGlzLmRhdGFbaV0uJGxva2kpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBSZWJ1aWxkIGlkSW5kZXggYXN5bmMgd2l0aCBjYWxsYmFjayAtIHVzZWZ1bCBmb3IgYmFja2dyb3VuZCBzeW5jaW5nIHdpdGggYSByZW1vdGUgc2VydmVyXG4gICAgICovXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUuZW5zdXJlSWRBc3luYyA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgdGhpcy5hc3luYyhmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuZW5zdXJlSWQoKTtcbiAgICAgIH0sIGNhbGxiYWNrKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQWRkIGEgZHluYW1pYyB2aWV3IHRvIHRoZSBjb2xsZWN0aW9uXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgLSBuYW1lIG9mIGR5bmFtaWMgdmlldyB0byBhZGRcbiAgICAgKiBAcGFyYW0ge29iamVjdD19IG9wdGlvbnMgLSBvcHRpb25zIHRvIGNvbmZpZ3VyZSBkeW5hbWljIHZpZXcgd2l0aFxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMucGVyc2lzdGVudD1mYWxzZV0gLSBpbmRpY2F0ZXMgaWYgdmlldyBpcyB0byBtYWluIGludGVybmFsIHJlc3VsdHMgYXJyYXkgaW4gJ3Jlc3VsdGRhdGEnXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFtvcHRpb25zLnNvcnRQcmlvcml0eT0ncGFzc2l2ZSddIC0gJ3Bhc3NpdmUnIChzb3J0cyBwZXJmb3JtZWQgb24gY2FsbCB0byBkYXRhKSBvciAnYWN0aXZlJyAoYWZ0ZXIgdXBkYXRlcylcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gb3B0aW9ucy5taW5SZWJ1aWxkSW50ZXJ2YWwgLSBtaW5pbXVtIHJlYnVpbGQgaW50ZXJ2YWwgKG5lZWQgY2xhcmlmaWNhdGlvbiB0byBkb2NzIGhlcmUpXG4gICAgICogQHJldHVybnMge0R5bmFtaWNWaWV3fSByZWZlcmVuY2UgdG8gdGhlIGR5bmFtaWMgdmlldyBhZGRlZFxuICAgICAqIEBtZW1iZXJvZiBDb2xsZWN0aW9uXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiB2YXIgcHZpZXcgPSB1c2Vycy5hZGREeW5hbWljVmlldygncHJvZ2VueScpO1xuICAgICAqIHB2aWV3LmFwcGx5RmluZCh7J2FnZSc6IHsnJGx0ZSc6IDQwfX0pO1xuICAgICAqIHB2aWV3LmFwcGx5U2ltcGxlU29ydCgnbmFtZScpO1xuICAgICAqXG4gICAgICogdmFyIHJlc3VsdHMgPSBwdmlldy5kYXRhKCk7XG4gICAgICoqL1xuXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUuYWRkRHluYW1pY1ZpZXcgPSBmdW5jdGlvbiAobmFtZSwgb3B0aW9ucykge1xuICAgICAgdmFyIGR2ID0gbmV3IER5bmFtaWNWaWV3KHRoaXMsIG5hbWUsIG9wdGlvbnMpO1xuICAgICAgdGhpcy5EeW5hbWljVmlld3MucHVzaChkdik7XG5cbiAgICAgIHJldHVybiBkdjtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlIGEgZHluYW1pYyB2aWV3IGZyb20gdGhlIGNvbGxlY3Rpb25cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZSAtIG5hbWUgb2YgZHluYW1pYyB2aWV3IHRvIHJlbW92ZVxuICAgICAqIEBtZW1iZXJvZiBDb2xsZWN0aW9uXG4gICAgICoqL1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLnJlbW92ZUR5bmFtaWNWaWV3ID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgIHRoaXMuRHluYW1pY1ZpZXdzID0gXG4gICAgICAgIHRoaXMuRHluYW1pY1ZpZXdzLmZpbHRlcihmdW5jdGlvbihkdikgeyByZXR1cm4gZHYubmFtZSAhPT0gbmFtZTsgfSk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIExvb2sgdXAgZHluYW1pYyB2aWV3IHJlZmVyZW5jZSBmcm9tIHdpdGhpbiB0aGUgY29sbGVjdGlvblxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIC0gbmFtZSBvZiBkeW5hbWljIHZpZXcgdG8gcmV0cmlldmUgcmVmZXJlbmNlIG9mXG4gICAgICogQHJldHVybnMge0R5bmFtaWNWaWV3fSBBIHJlZmVyZW5jZSB0byB0aGUgZHluYW1pYyB2aWV3IHdpdGggdGhhdCBuYW1lXG4gICAgICogQG1lbWJlcm9mIENvbGxlY3Rpb25cbiAgICAgKiovXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUuZ2V0RHluYW1pY1ZpZXcgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgZm9yICh2YXIgaWR4ID0gMDsgaWR4IDwgdGhpcy5EeW5hbWljVmlld3MubGVuZ3RoOyBpZHgrKykge1xuICAgICAgICBpZiAodGhpcy5EeW5hbWljVmlld3NbaWR4XS5uYW1lID09PSBuYW1lKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuRHluYW1pY1ZpZXdzW2lkeF07XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEFwcGxpZXMgYSAnbW9uZ28tbGlrZScgZmluZCBxdWVyeSBvYmplY3QgYW5kIHBhc3NlcyBhbGwgcmVzdWx0cyB0byBhbiB1cGRhdGUgZnVuY3Rpb24uXG4gICAgICogRm9yIGZpbHRlciBmdW5jdGlvbiBxdWVyeWluZyB5b3Ugc2hvdWxkIG1pZ3JhdGUgdG8gW3VwZGF0ZVdoZXJlKClde0BsaW5rIENvbGxlY3Rpb24jdXBkYXRlV2hlcmV9LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtvYmplY3R8ZnVuY3Rpb259IGZpbHRlck9iamVjdCAtICdtb25nby1saWtlJyBxdWVyeSBvYmplY3QgKG9yIGRlcHJlY2F0ZWQgZmlsdGVyRnVuY3Rpb24gbW9kZSlcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSB1cGRhdGVGdW5jdGlvbiAtIHVwZGF0ZSBmdW5jdGlvbiB0byBydW4gYWdhaW5zdCBmaWx0ZXJlZCBkb2N1bWVudHNcbiAgICAgKiBAbWVtYmVyb2YgQ29sbGVjdGlvblxuICAgICAqL1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmZpbmRBbmRVcGRhdGUgPSBmdW5jdGlvbiAoZmlsdGVyT2JqZWN0LCB1cGRhdGVGdW5jdGlvbikge1xuICAgICAgaWYgKHR5cGVvZiAoZmlsdGVyT2JqZWN0KSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHRoaXMudXBkYXRlV2hlcmUoZmlsdGVyT2JqZWN0LCB1cGRhdGVGdW5jdGlvbik7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgdGhpcy5jaGFpbigpLmZpbmQoZmlsdGVyT2JqZWN0KS51cGRhdGUodXBkYXRlRnVuY3Rpb24pO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBBcHBsaWVzIGEgJ21vbmdvLWxpa2UnIGZpbmQgcXVlcnkgb2JqZWN0IHJlbW92ZXMgYWxsIGRvY3VtZW50cyB3aGljaCBtYXRjaCB0aGF0IGZpbHRlci5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBmaWx0ZXJPYmplY3QgLSAnbW9uZ28tbGlrZScgcXVlcnkgb2JqZWN0XG4gICAgICogQG1lbWJlcm9mIENvbGxlY3Rpb25cbiAgICAgKi9cbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5maW5kQW5kUmVtb3ZlID0gZnVuY3Rpb24oZmlsdGVyT2JqZWN0KSB7XG4gICAgICB0aGlzLmNoYWluKCkuZmluZChmaWx0ZXJPYmplY3QpLnJlbW92ZSgpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBBZGRzIG9iamVjdChzKSB0byBjb2xsZWN0aW9uLCBlbnN1cmUgb2JqZWN0KHMpIGhhdmUgbWV0YSBwcm9wZXJ0aWVzLCBjbG9uZSBpdCBpZiBuZWNlc3NhcnksIGV0Yy5cbiAgICAgKiBAcGFyYW0geyhvYmplY3R8YXJyYXkpfSBkb2MgLSB0aGUgZG9jdW1lbnQgKG9yIGFycmF5IG9mIGRvY3VtZW50cykgdG8gYmUgaW5zZXJ0ZWRcbiAgICAgKiBAcmV0dXJucyB7KG9iamVjdHxhcnJheSl9IGRvY3VtZW50IG9yIGRvY3VtZW50cyBpbnNlcnRlZFxuICAgICAqIEBtZW1iZXJvZiBDb2xsZWN0aW9uXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiB1c2Vycy5pbnNlcnQoe1xuICAgICAqICAgICBuYW1lOiAnT2RpbicsXG4gICAgICogICAgIGFnZTogNTAsXG4gICAgICogICAgIGFkZHJlc3M6ICdBc2dhcmQnXG4gICAgICogfSk7XG4gICAgICpcbiAgICAgKiAvLyBhbHRlcm5hdGl2ZWx5LCBpbnNlcnQgYXJyYXkgb2YgZG9jdW1lbnRzXG4gICAgICogdXNlcnMuaW5zZXJ0KFt7IG5hbWU6ICdUaG9yJywgYWdlOiAzNX0sIHsgbmFtZTogJ0xva2knLCBhZ2U6IDMwfV0pO1xuICAgICAqL1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmluc2VydCA9IGZ1bmN0aW9uIChkb2MpIHtcbiAgICAgIGlmICghQXJyYXkuaXNBcnJheShkb2MpKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmluc2VydE9uZShkb2MpO1xuICAgICAgfVxuXG4gICAgICAvLyBob2xkZXIgdG8gdGhlIGNsb25lIG9mIHRoZSBvYmplY3QgaW5zZXJ0ZWQgaWYgY29sbGVjdGlvbnMgaXMgc2V0IHRvIGNsb25lIG9iamVjdHNcbiAgICAgIHZhciBvYmo7XG4gICAgICB2YXIgcmVzdWx0cyA9IFtdO1xuXG4gICAgICB0aGlzLmVtaXQoJ3ByZS1pbnNlcnQnLCBkb2MpO1xuICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGRvYy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBvYmogPSB0aGlzLmluc2VydE9uZShkb2NbaV0sIHRydWUpO1xuICAgICAgICBpZiAoIW9iaikge1xuICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgcmVzdWx0cy5wdXNoKG9iaik7XG4gICAgICB9XG5cbiAgICAgIC8vIGF0IHRoZSAnYmF0Y2gnIGxldmVsLCBpZiBjbG9uZSBvcHRpb24gaXMgdHJ1ZSB0aGVuIGVtaXR0ZWQgZG9jcyBhcmUgY2xvbmVzXG4gICAgICB0aGlzLmVtaXQoJ2luc2VydCcsIHJlc3VsdHMpO1xuXG4gICAgICAvLyBpZiBjbG9uZSBvcHRpb24gaXMgc2V0LCBjbG9uZSByZXR1cm4gdmFsdWVzXG4gICAgICByZXN1bHRzID0gdGhpcy5jbG9uZU9iamVjdHMgPyBjbG9uZShyZXN1bHRzLCB0aGlzLmNsb25lTWV0aG9kKSA6IHJlc3VsdHM7XG5cbiAgICAgIHJldHVybiByZXN1bHRzLmxlbmd0aCA9PT0gMSA/IHJlc3VsdHNbMF0gOiByZXN1bHRzO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBBZGRzIGEgc2luZ2xlIG9iamVjdCwgZW5zdXJlcyBpdCBoYXMgbWV0YSBwcm9wZXJ0aWVzLCBjbG9uZSBpdCBpZiBuZWNlc3NhcnksIGV0Yy5cbiAgICAgKiBAcGFyYW0ge29iamVjdH0gZG9jIC0gdGhlIGRvY3VtZW50IHRvIGJlIGluc2VydGVkXG4gICAgICogQHBhcmFtIHtib29sZWFufSBidWxrSW5zZXJ0IC0gcXVpZXQgcHJlLWluc2VydCBhbmQgaW5zZXJ0IGV2ZW50IGVtaXRzXG4gICAgICogQHJldHVybnMge29iamVjdH0gZG9jdW1lbnQgb3IgJ3VuZGVmaW5lZCcgaWYgdGhlcmUgd2FzIGEgcHJvYmxlbSBpbnNlcnRpbmcgaXRcbiAgICAgKi9cbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5pbnNlcnRPbmUgPSBmdW5jdGlvbiAoZG9jLCBidWxrSW5zZXJ0KSB7XG4gICAgICB2YXIgZXJyID0gbnVsbDtcbiAgICAgIHZhciByZXR1cm5PYmo7XG5cbiAgICAgIGlmICh0eXBlb2YgZG9jICE9PSAnb2JqZWN0Jykge1xuICAgICAgICBlcnIgPSBuZXcgVHlwZUVycm9yKCdEb2N1bWVudCBuZWVkcyB0byBiZSBhbiBvYmplY3QnKTtcbiAgICAgIH0gZWxzZSBpZiAoZG9jID09PSBudWxsKSB7XG4gICAgICAgIGVyciA9IG5ldyBUeXBlRXJyb3IoJ09iamVjdCBjYW5ub3QgYmUgbnVsbCcpO1xuICAgICAgfVxuXG4gICAgICBpZiAoZXJyICE9PSBudWxsKSB7XG4gICAgICAgIHRoaXMuZW1pdCgnZXJyb3InLCBlcnIpO1xuICAgICAgICB0aHJvdyBlcnI7XG4gICAgICB9XG5cbiAgICAgIC8vIGlmIGNvbmZpZ3VyZWQgdG8gY2xvbmUsIGRvIHNvIG5vdy4uLiBvdGhlcndpc2UganVzdCB1c2Ugc2FtZSBvYmogcmVmZXJlbmNlXG4gICAgICB2YXIgb2JqID0gdGhpcy5jbG9uZU9iamVjdHMgPyBjbG9uZShkb2MsIHRoaXMuY2xvbmVNZXRob2QpIDogZG9jO1xuXG4gICAgICBpZiAoIXRoaXMuZGlzYWJsZU1ldGEgJiYgdHlwZW9mIG9iai5tZXRhID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICBvYmoubWV0YSA9IHtcbiAgICAgICAgICByZXZpc2lvbjogMCxcbiAgICAgICAgICBjcmVhdGVkOiAwXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIC8vIGJvdGggJ3ByZS1pbnNlcnQnIGFuZCAnaW5zZXJ0JyBldmVudHMgYXJlIHBhc3NlZCBpbnRlcm5hbCBkYXRhIHJlZmVyZW5jZSBldmVuIHdoZW4gY2xvbmluZ1xuICAgICAgLy8gaW5zZXJ0IG5lZWRzIGludGVybmFsIHJlZmVyZW5jZSBiZWNhdXNlIHRoYXQgaXMgd2hlcmUgbG9raSBpdHNlbGYgbGlzdGVucyB0byBhZGQgbWV0YVxuICAgICAgaWYgKCFidWxrSW5zZXJ0KSB7XG4gICAgICAgIHRoaXMuZW1pdCgncHJlLWluc2VydCcsIG9iaik7XG4gICAgICB9XG4gICAgICBpZiAoIXRoaXMuYWRkKG9iaikpIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgIH1cblxuICAgICAgLy8gdXBkYXRlIG1ldGEgYW5kIHN0b3JlIGNoYW5nZXMgaWYgQ2hhbmdlc0FQSSBpcyBlbmFibGVkXG4gICAgICAvLyAobW92ZWQgZnJvbSBcImluc2VydFwiIGV2ZW50IGxpc3RlbmVyIHRvIGFsbG93IGludGVybmFsIHJlZmVyZW5jZSB0byBiZSB1c2VkKVxuICAgICAgaWYgKHRoaXMuZGlzYWJsZUNoYW5nZXNBcGkpIHtcbiAgICAgICAgdGhpcy5pbnNlcnRNZXRhKG9iaik7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgdGhpcy5pbnNlcnRNZXRhV2l0aENoYW5nZShvYmopO1xuICAgICAgfVxuXG4gICAgICAvLyBpZiBjbG9uaW5nIGlzIGVuYWJsZWQsIGVtaXQgaW5zZXJ0IGV2ZW50IHdpdGggY2xvbmUgb2YgbmV3IG9iamVjdFxuICAgICAgcmV0dXJuT2JqID0gdGhpcy5jbG9uZU9iamVjdHMgPyBjbG9uZShvYmosIHRoaXMuY2xvbmVNZXRob2QpIDogb2JqO1xuICAgICAgaWYgKCFidWxrSW5zZXJ0KSB7XG4gICAgICAgIHRoaXMuZW1pdCgnaW5zZXJ0JywgcmV0dXJuT2JqKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5hZGRBdXRvVXBkYXRlT2JzZXJ2ZXIocmV0dXJuT2JqKTtcbiAgICAgIHJldHVybiByZXR1cm5PYmo7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEVtcHRpZXMgdGhlIGNvbGxlY3Rpb24uXG4gICAgICogQHBhcmFtIHtvYmplY3Q9fSBvcHRpb25zIC0gY29uZmlndXJlIGNsZWFyIGJlaGF2aW9yXG4gICAgICogQHBhcmFtIHtib29sPX0gW29wdGlvbnMucmVtb3ZlSW5kaWNlcz1mYWxzZV0gLSB3aGV0aGVyIHRvIHJlbW92ZSBpbmRpY2VzIGluIGFkZGl0aW9uIHRvIGRhdGFcbiAgICAgKiBAbWVtYmVyb2YgQ29sbGVjdGlvblxuICAgICAqL1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cbiAgICAgIHRoaXMuZGF0YSA9IFtdO1xuICAgICAgdGhpcy5pZEluZGV4ID0gW107XG4gICAgICB0aGlzLmNhY2hlZEluZGV4ID0gbnVsbDtcbiAgICAgIHRoaXMuY2FjaGVkQmluYXJ5SW5kZXggPSBudWxsO1xuICAgICAgdGhpcy5jYWNoZWREYXRhID0gbnVsbDtcbiAgICAgIHRoaXMubWF4SWQgPSAwO1xuICAgICAgdGhpcy5EeW5hbWljVmlld3MgPSBbXTtcbiAgICAgIHRoaXMuZGlydHkgPSB0cnVlO1xuXG4gICAgICAvLyBpZiByZW1vdmluZyBpbmRpY2VzIGVudGlyZWx5XG4gICAgICBpZiAob3B0aW9ucy5yZW1vdmVJbmRpY2VzID09PSB0cnVlKSB7XG4gICAgICAgIHRoaXMuYmluYXJ5SW5kaWNlcyA9IHt9O1xuXG4gICAgICAgIHRoaXMuY29uc3RyYWludHMgPSB7XG4gICAgICAgICAgdW5pcXVlOiB7fSxcbiAgICAgICAgICBleGFjdDoge31cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy51bmlxdWVOYW1lcyA9IFtdO1xuICAgICAgfVxuICAgICAgLy8gY2xlYXIgaW5kaWNlcyBidXQgbGVhdmUgZGVmaW5pdGlvbnMgaW4gcGxhY2VcbiAgICAgIGVsc2Uge1xuICAgICAgICAvLyBjbGVhciBiaW5hcnkgaW5kaWNlc1xuICAgICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKHRoaXMuYmluYXJ5SW5kaWNlcyk7XG4gICAgICAgIGtleXMuZm9yRWFjaChmdW5jdGlvbihiaW5hbWUpIHtcbiAgICAgICAgICBzZWxmLmJpbmFyeUluZGljZXNbYmluYW1lXS5kaXJ0eSA9IGZhbHNlO1xuICAgICAgICAgIHNlbGYuYmluYXJ5SW5kaWNlc1tiaW5hbWVdLnZhbHVlcyA9IFtdO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBjbGVhciBlbnRpcmUgdW5pcXVlIGluZGljZXMgZGVmaW5pdGlvblxuICAgICAgICB0aGlzLmNvbnN0cmFpbnRzID0ge1xuICAgICAgICAgIHVuaXF1ZToge30sXG4gICAgICAgICAgZXhhY3Q6IHt9XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gYWRkIGRlZmluaXRpb25zIGJhY2tcbiAgICAgICAgdGhpcy51bmlxdWVOYW1lcy5mb3JFYWNoKGZ1bmN0aW9uKHVpbmFtZSkge1xuICAgICAgICAgIHNlbGYuZW5zdXJlVW5pcXVlSW5kZXgodWluYW1lKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZXMgYW4gb2JqZWN0IGFuZCBub3RpZmllcyBjb2xsZWN0aW9uIHRoYXQgdGhlIGRvY3VtZW50IGhhcyBjaGFuZ2VkLlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBkb2MgLSBkb2N1bWVudCB0byB1cGRhdGUgd2l0aGluIHRoZSBjb2xsZWN0aW9uXG4gICAgICogQG1lbWJlcm9mIENvbGxlY3Rpb25cbiAgICAgKi9cbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoZG9jKSB7XG4gICAgICB2YXIgYWRhcHRpdmVCYXRjaE92ZXJyaWRlLCBrLCBsZW47XG5cbiAgICAgIGlmIChBcnJheS5pc0FycmF5KGRvYykpIHtcbiAgICAgICAgbGVuID0gZG9jLmxlbmd0aDtcblxuICAgICAgICAvLyBpZiBub3QgY2xvbmluZywgZGlzYWJsZSBhZGFwdGl2ZSBiaW5hcnkgaW5kaWNlcyBmb3IgdGhlIGR1cmF0aW9uIG9mIHRoZSBiYXRjaCB1cGRhdGUsXG4gICAgICAgIC8vIGZvbGxvd2VkIGJ5IGxhenkgcmVidWlsZCBhbmQgcmUtZW5hYmxpbmcgYWRhcHRpdmUgaW5kaWNlcyBhZnRlciBiYXRjaCB1cGRhdGUuXG4gICAgICAgIGFkYXB0aXZlQmF0Y2hPdmVycmlkZSA9ICF0aGlzLmNsb25lT2JqZWN0cyAmJlxuICAgICAgICAgIHRoaXMuYWRhcHRpdmVCaW5hcnlJbmRpY2VzICYmIE9iamVjdC5rZXlzKHRoaXMuYmluYXJ5SW5kaWNlcykubGVuZ3RoID4gMDtcblxuICAgICAgICBpZiAoYWRhcHRpdmVCYXRjaE92ZXJyaWRlKSB7XG4gICAgICAgICAgdGhpcy5hZGFwdGl2ZUJpbmFyeUluZGljZXMgPSBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgZm9yIChrPTA7IGsgPCBsZW47IGsgKz0gMSkge1xuICAgICAgICAgICAgdGhpcy51cGRhdGUoZG9jW2tdKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgaWYgKGFkYXB0aXZlQmF0Y2hPdmVycmlkZSkge1xuICAgICAgICAgICAgdGhpcy5lbnN1cmVBbGxJbmRleGVzKCk7XG4gICAgICAgICAgICB0aGlzLmFkYXB0aXZlQmluYXJ5SW5kaWNlcyA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyB2ZXJpZnkgb2JqZWN0IGlzIGEgcHJvcGVybHkgZm9ybWVkIGRvY3VtZW50XG4gICAgICBpZiAoIWhhc093blByb3BlcnR5LmNhbGwoZG9jLCAnJGxva2knKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RyeWluZyB0byB1cGRhdGUgdW5zeW5jZWQgZG9jdW1lbnQuIFBsZWFzZSBzYXZlIHRoZSBkb2N1bWVudCBmaXJzdCBieSB1c2luZyBpbnNlcnQoKSBvciBhZGRNYW55KCknKTtcbiAgICAgIH1cbiAgICAgIHRyeSB7XG4gICAgICAgIHRoaXMuc3RhcnRUcmFuc2FjdGlvbigpO1xuICAgICAgICB2YXIgYXJyID0gdGhpcy5nZXQoZG9jLiRsb2tpLCB0cnVlKSxcbiAgICAgICAgICBvbGRJbnRlcm5hbCwgICAvLyByZWYgdG8gZXhpc3Rpbmcgb2JqXG4gICAgICAgICAgbmV3SW50ZXJuYWwsIC8vIHJlZiB0byBuZXcgaW50ZXJuYWwgb2JqXG4gICAgICAgICAgcG9zaXRpb24sXG4gICAgICAgICAgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgaWYgKCFhcnIpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RyeWluZyB0byB1cGRhdGUgYSBkb2N1bWVudCBub3QgaW4gY29sbGVjdGlvbi4nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIG9sZEludGVybmFsID0gYXJyWzBdOyAvLyAtaW50ZXJuYWwtIG9iaiByZWZcbiAgICAgICAgcG9zaXRpb24gPSBhcnJbMV07IC8vIHBvc2l0aW9uIGluIGRhdGEgYXJyYXlcblxuICAgICAgICAvLyBpZiBjb25maWd1cmVkIHRvIGNsb25lLCBkbyBzbyBub3cuLi4gb3RoZXJ3aXNlIGp1c3QgdXNlIHNhbWUgb2JqIHJlZmVyZW5jZVxuICAgICAgICBuZXdJbnRlcm5hbCA9IHRoaXMuY2xvbmVPYmplY3RzIHx8ICF0aGlzLmRpc2FibGVEZWx0YUNoYW5nZXNBcGkgPyBjbG9uZShkb2MsIHRoaXMuY2xvbmVNZXRob2QpIDogZG9jO1xuXG4gICAgICAgIHRoaXMuZW1pdCgncHJlLXVwZGF0ZScsIGRvYyk7XG5cbiAgICAgICAgT2JqZWN0LmtleXModGhpcy5jb25zdHJhaW50cy51bmlxdWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgIHNlbGYuY29uc3RyYWludHMudW5pcXVlW2tleV0udXBkYXRlKG9sZEludGVybmFsLCBuZXdJbnRlcm5hbCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIG9wZXJhdGUgdGhlIHVwZGF0ZVxuICAgICAgICB0aGlzLmRhdGFbcG9zaXRpb25dID0gbmV3SW50ZXJuYWw7XG5cbiAgICAgICAgaWYgKG5ld0ludGVybmFsICE9PSBkb2MpIHtcbiAgICAgICAgICB0aGlzLmFkZEF1dG9VcGRhdGVPYnNlcnZlcihkb2MpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gbm93IHRoYXQgd2UgY2FuIGVmZmljaWVudGx5IGRldGVybWluZSB0aGUgZGF0YVtdIHBvc2l0aW9uIG9mIG5ld2x5IGFkZGVkIGRvY3VtZW50LFxuICAgICAgICAvLyBzdWJtaXQgaXQgZm9yIGFsbCByZWdpc3RlcmVkIER5bmFtaWNWaWV3cyB0byBldmFsdWF0ZSBmb3IgaW5jbHVzaW9uL2V4Y2x1c2lvblxuICAgICAgICBmb3IgKHZhciBpZHggPSAwOyBpZHggPCB0aGlzLkR5bmFtaWNWaWV3cy5sZW5ndGg7IGlkeCsrKSB7XG4gICAgICAgICAgdGhpcy5EeW5hbWljVmlld3NbaWR4XS5ldmFsdWF0ZURvY3VtZW50KHBvc2l0aW9uLCBmYWxzZSk7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIga2V5O1xuICAgICAgICBpZiAodGhpcy5hZGFwdGl2ZUJpbmFyeUluZGljZXMpIHtcbiAgICAgICAgICAvLyBmb3IgZWFjaCBiaW5hcnkgaW5kZXggZGVmaW5lZCBpbiBjb2xsZWN0aW9uLCBpbW1lZGlhdGVseSB1cGRhdGUgcmF0aGVyIHRoYW4gZmxhZyBmb3IgbGF6eSByZWJ1aWxkXG4gICAgICAgICAgdmFyIGJJbmRpY2VzID0gdGhpcy5iaW5hcnlJbmRpY2VzO1xuICAgICAgICAgIGZvciAoa2V5IGluIGJJbmRpY2VzKSB7XG4gICAgICAgICAgICB0aGlzLmFkYXB0aXZlQmluYXJ5SW5kZXhVcGRhdGUocG9zaXRpb24sIGtleSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIHRoaXMuZmxhZ0JpbmFyeUluZGV4ZXNEaXJ0eSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5pZEluZGV4W3Bvc2l0aW9uXSA9IG5ld0ludGVybmFsLiRsb2tpO1xuICAgICAgICAvL3RoaXMuZmxhZ0JpbmFyeUluZGV4ZXNEaXJ0eSgpO1xuXG4gICAgICAgIHRoaXMuY29tbWl0KCk7XG4gICAgICAgIHRoaXMuZGlydHkgPSB0cnVlOyAvLyBmb3IgYXV0b3NhdmUgc2NlbmFyaW9zXG5cbiAgICAgICAgLy8gdXBkYXRlIG1ldGEgYW5kIHN0b3JlIGNoYW5nZXMgaWYgQ2hhbmdlc0FQSSBpcyBlbmFibGVkXG4gICAgICAgIGlmICh0aGlzLmRpc2FibGVDaGFuZ2VzQXBpKSB7XG4gICAgICAgICAgdGhpcy51cGRhdGVNZXRhKG5ld0ludGVybmFsLCBudWxsKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICB0aGlzLnVwZGF0ZU1ldGFXaXRoQ2hhbmdlKG5ld0ludGVybmFsLCBvbGRJbnRlcm5hbCk7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgcmV0dXJuT2JqO1xuXG4gICAgICAgIC8vIGlmIGNsb25pbmcgaXMgZW5hYmxlZCwgZW1pdCAndXBkYXRlJyBldmVudCBhbmQgcmV0dXJuIHdpdGggY2xvbmUgb2YgbmV3IG9iamVjdFxuICAgICAgICBpZiAodGhpcy5jbG9uZU9iamVjdHMpIHtcbiAgICAgICAgICByZXR1cm5PYmogPSBjbG9uZShuZXdJbnRlcm5hbCwgdGhpcy5jbG9uZU1ldGhvZCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgcmV0dXJuT2JqID0gbmV3SW50ZXJuYWw7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmVtaXQoJ3VwZGF0ZScsIHJldHVybk9iaiwgb2xkSW50ZXJuYWwpO1xuICAgICAgICByZXR1cm4gcmV0dXJuT2JqO1xuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHRoaXMucm9sbGJhY2soKTtcbiAgICAgICAgdGhpcy5jb25zb2xlLmVycm9yKGVyci5tZXNzYWdlKTtcbiAgICAgICAgdGhpcy5lbWl0KCdlcnJvcicsIGVycik7XG4gICAgICAgIHRocm93IChlcnIpOyAvLyByZS10aHJvdyBlcnJvciBzbyB1c2VyIGRvZXMgbm90IHRoaW5rIGl0IHN1Y2NlZWRlZFxuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBBZGQgb2JqZWN0IHRvIGNvbGxlY3Rpb25cbiAgICAgKi9cbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAob2JqKSB7XG4gICAgICAvLyBpZiBwYXJhbWV0ZXIgaXNuJ3Qgb2JqZWN0IGV4aXQgd2l0aCB0aHJvd1xuICAgICAgaWYgKCdvYmplY3QnICE9PSB0eXBlb2Ygb2JqKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ09iamVjdCBiZWluZyBhZGRlZCBuZWVkcyB0byBiZSBhbiBvYmplY3QnKTtcbiAgICAgIH1cbiAgICAgIC8vIGlmIG9iamVjdCB5b3UgYXJlIGFkZGluZyBhbHJlYWR5IGhhcyBpZCBjb2x1bW4gaXQgaXMgZWl0aGVyIGFscmVhZHkgaW4gdGhlIGNvbGxlY3Rpb25cbiAgICAgIC8vIG9yIHRoZSBvYmplY3QgaXMgY2FycnlpbmcgaXRzIG93biAnaWQnIHByb3BlcnR5LiAgSWYgaXQgYWxzbyBoYXMgYSBtZXRhIHByb3BlcnR5LFxuICAgICAgLy8gdGhlbiB0aGlzIGlzIGFscmVhZHkgaW4gY29sbGVjdGlvbiBzbyB0aHJvdyBlcnJvciwgb3RoZXJ3aXNlIHJlbmFtZSB0byBvcmlnaW5hbElkIGFuZCBjb250aW51ZSBhZGRpbmcuXG4gICAgICBpZiAodHlwZW9mIChvYmouJGxva2kpICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0RvY3VtZW50IGlzIGFscmVhZHkgaW4gY29sbGVjdGlvbiwgcGxlYXNlIHVzZSB1cGRhdGUoKScpO1xuICAgICAgfVxuXG4gICAgICAvKlxuICAgICAgICogdHJ5IGFkZGluZyBvYmplY3QgdG8gY29sbGVjdGlvblxuICAgICAgICovXG4gICAgICB0cnkge1xuICAgICAgICB0aGlzLnN0YXJ0VHJhbnNhY3Rpb24oKTtcbiAgICAgICAgdGhpcy5tYXhJZCsrO1xuXG4gICAgICAgIGlmIChpc05hTih0aGlzLm1heElkKSkge1xuICAgICAgICAgIHRoaXMubWF4SWQgPSAodGhpcy5kYXRhW3RoaXMuZGF0YS5sZW5ndGggLSAxXS4kbG9raSArIDEpO1xuICAgICAgICB9XG5cbiAgICAgICAgb2JqLiRsb2tpID0gdGhpcy5tYXhJZDtcblxuICAgICAgICBpZiAoIXRoaXMuZGlzYWJsZU1ldGEpIHtcbiAgICAgICAgICBvYmoubWV0YS52ZXJzaW9uID0gMDtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBrZXksIGNvbnN0clVuaXF1ZSA9IHRoaXMuY29uc3RyYWludHMudW5pcXVlO1xuICAgICAgICBmb3IgKGtleSBpbiBjb25zdHJVbmlxdWUpIHtcbiAgICAgICAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbChjb25zdHJVbmlxdWUsIGtleSkpIHtcbiAgICAgICAgICAgIGNvbnN0clVuaXF1ZVtrZXldLnNldChvYmopO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGFkZCBuZXcgb2JqIGlkIHRvIGlkSW5kZXhcbiAgICAgICAgdGhpcy5pZEluZGV4LnB1c2gob2JqLiRsb2tpKTtcblxuICAgICAgICAvLyBhZGQgdGhlIG9iamVjdFxuICAgICAgICB0aGlzLmRhdGEucHVzaChvYmopO1xuXG4gICAgICAgIHZhciBhZGRlZFBvcyA9IHRoaXMuZGF0YS5sZW5ndGggLSAxO1xuXG4gICAgICAgIC8vIG5vdyB0aGF0IHdlIGNhbiBlZmZpY2llbnRseSBkZXRlcm1pbmUgdGhlIGRhdGFbXSBwb3NpdGlvbiBvZiBuZXdseSBhZGRlZCBkb2N1bWVudCxcbiAgICAgICAgLy8gc3VibWl0IGl0IGZvciBhbGwgcmVnaXN0ZXJlZCBEeW5hbWljVmlld3MgdG8gZXZhbHVhdGUgZm9yIGluY2x1c2lvbi9leGNsdXNpb25cbiAgICAgICAgdmFyIGR2bGVuID0gdGhpcy5EeW5hbWljVmlld3MubGVuZ3RoO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGR2bGVuOyBpKyspIHtcbiAgICAgICAgICB0aGlzLkR5bmFtaWNWaWV3c1tpXS5ldmFsdWF0ZURvY3VtZW50KGFkZGVkUG9zLCB0cnVlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmFkYXB0aXZlQmluYXJ5SW5kaWNlcykge1xuICAgICAgICAgIC8vIGZvciBlYWNoIGJpbmFyeSBpbmRleCBkZWZpbmVkIGluIGNvbGxlY3Rpb24sIGltbWVkaWF0ZWx5IHVwZGF0ZSByYXRoZXIgdGhhbiBmbGFnIGZvciBsYXp5IHJlYnVpbGRcbiAgICAgICAgICB2YXIgYkluZGljZXMgPSB0aGlzLmJpbmFyeUluZGljZXM7XG4gICAgICAgICAgZm9yIChrZXkgaW4gYkluZGljZXMpIHtcbiAgICAgICAgICAgIHRoaXMuYWRhcHRpdmVCaW5hcnlJbmRleEluc2VydChhZGRlZFBvcywga2V5KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgdGhpcy5mbGFnQmluYXJ5SW5kZXhlc0RpcnR5KCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmNvbW1pdCgpO1xuICAgICAgICB0aGlzLmRpcnR5ID0gdHJ1ZTsgLy8gZm9yIGF1dG9zYXZlIHNjZW5hcmlvc1xuXG4gICAgICAgIHJldHVybiAodGhpcy5jbG9uZU9iamVjdHMpID8gKGNsb25lKG9iaiwgdGhpcy5jbG9uZU1ldGhvZCkpIDogKG9iaik7XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgdGhpcy5yb2xsYmFjaygpO1xuICAgICAgICB0aGlzLmNvbnNvbGUuZXJyb3IoZXJyLm1lc3NhZ2UpO1xuICAgICAgICB0aGlzLmVtaXQoJ2Vycm9yJywgZXJyKTtcbiAgICAgICAgdGhyb3cgKGVycik7IC8vIHJlLXRocm93IGVycm9yIHNvIHVzZXIgZG9lcyBub3QgdGhpbmsgaXQgc3VjY2VlZGVkXG4gICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEFwcGxpZXMgYSBmaWx0ZXIgZnVuY3Rpb24gYW5kIHBhc3NlcyBhbGwgcmVzdWx0cyB0byBhbiB1cGRhdGUgZnVuY3Rpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBmaWx0ZXJGdW5jdGlvbiAtIGZpbHRlciBmdW5jdGlvbiB3aG9zZSByZXN1bHRzIHdpbGwgZXhlY3V0ZSB1cGRhdGVcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSB1cGRhdGVGdW5jdGlvbiAtIHVwZGF0ZSBmdW5jdGlvbiB0byBydW4gYWdhaW5zdCBmaWx0ZXJlZCBkb2N1bWVudHNcbiAgICAgKiBAbWVtYmVyb2YgQ29sbGVjdGlvblxuICAgICAqL1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLnVwZGF0ZVdoZXJlID0gZnVuY3Rpb24oZmlsdGVyRnVuY3Rpb24sIHVwZGF0ZUZ1bmN0aW9uKSB7XG4gICAgICB2YXIgcmVzdWx0cyA9IHRoaXMud2hlcmUoZmlsdGVyRnVuY3Rpb24pLFxuICAgICAgICBpID0gMCxcbiAgICAgICAgb2JqO1xuICAgICAgdHJ5IHtcbiAgICAgICAgZm9yIChpOyBpIDwgcmVzdWx0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIG9iaiA9IHVwZGF0ZUZ1bmN0aW9uKHJlc3VsdHNbaV0pO1xuICAgICAgICAgIHRoaXMudXBkYXRlKG9iaik7XG4gICAgICAgIH1cblxuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHRoaXMucm9sbGJhY2soKTtcbiAgICAgICAgdGhpcy5jb25zb2xlLmVycm9yKGVyci5tZXNzYWdlKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlIGFsbCBkb2N1bWVudHMgbWF0Y2hpbmcgc3VwcGxpZWQgZmlsdGVyIGZ1bmN0aW9uLlxuICAgICAqIEZvciAnbW9uZ28tbGlrZScgcXVlcnlpbmcgeW91IHNob3VsZCBtaWdyYXRlIHRvIFtmaW5kQW5kUmVtb3ZlKClde0BsaW5rIENvbGxlY3Rpb24jZmluZEFuZFJlbW92ZX0uXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbnxvYmplY3R9IHF1ZXJ5IC0gcXVlcnkgb2JqZWN0IHRvIGZpbHRlciBvblxuICAgICAqIEBtZW1iZXJvZiBDb2xsZWN0aW9uXG4gICAgICovXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUucmVtb3ZlV2hlcmUgPSBmdW5jdGlvbiAocXVlcnkpIHtcbiAgICAgIHZhciBsaXN0O1xuICAgICAgaWYgKHR5cGVvZiBxdWVyeSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBsaXN0ID0gdGhpcy5kYXRhLmZpbHRlcihxdWVyeSk7XG4gICAgICAgIHRoaXMucmVtb3ZlKGxpc3QpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5jaGFpbigpLmZpbmQocXVlcnkpLnJlbW92ZSgpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5yZW1vdmVEYXRhT25seSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMucmVtb3ZlKHRoaXMuZGF0YS5zbGljZSgpKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogSW50ZXJuYWwgbWV0aG9kIHRvIHJlbW92ZSBhIGJhdGNoIG9mIGRvY3VtZW50cyBmcm9tIHRoZSBjb2xsZWN0aW9uLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyW119IHBvc2l0aW9ucyAtIGRhdGEvaWRJbmRleCBwb3NpdGlvbnMgdG8gcmVtb3ZlXG4gICAgICovXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUucmVtb3ZlQmF0Y2hCeVBvc2l0aW9ucyA9IGZ1bmN0aW9uKHBvc2l0aW9ucykge1xuICAgICAgdmFyIGxlbiA9IHBvc2l0aW9ucy5sZW5ndGg7XG4gICAgICB2YXIgeG8gPSB7fTtcbiAgICAgIHZhciBkbGVuLCBkaWR4LCBpZHg7XG4gICAgICB2YXIgYmljPU9iamVjdC5rZXlzKHRoaXMuYmluYXJ5SW5kaWNlcykubGVuZ3RoO1xuICAgICAgdmFyIHVpYz1PYmplY3Qua2V5cyh0aGlzLmNvbnN0cmFpbnRzLnVuaXF1ZSkubGVuZ3RoO1xuICAgICAgdmFyIGFkYXB0aXZlT3ZlcnJpZGUgPSB0aGlzLmFkYXB0aXZlQmluYXJ5SW5kaWNlcyAmJiBPYmplY3Qua2V5cyh0aGlzLmJpbmFyeUluZGljZXMpLmxlbmd0aCA+IDA7XG4gICAgICB2YXIgZG9jLCBzZWxmPXRoaXM7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIHRoaXMuc3RhcnRUcmFuc2FjdGlvbigpO1xuXG4gICAgICAgIC8vIGNyZWF0ZSBoYXNob2JqZWN0IGZvciBwb3NpdGlvbmFsIHJlbW92YWwgaW5jbHVzaW9uIHRlc3RzLi4uXG4gICAgICAgIC8vIGFsbCBrZXlzIGRlZmluZWQgaW4gdGhpcyBoYXNob2JqZWN0IHJlcHJlc2VudCAkbG9raSBpZHMgb2YgdGhlIGRvY3VtZW50cyB0byByZW1vdmUuXG4gICAgICAgIGZvcihpZHg9MDsgaWR4IDwgbGVuOyBpZHgrKykge1xuICAgICAgICAgIHhvW3RoaXMuaWRJbmRleFtwb3NpdGlvbnNbaWR4XV1dID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGlmIHdlIHdpbGwgbmVlZCB0byBub3RpZnkgZHluYW1pYyB2aWV3cyBhbmQvb3IgYmluYXJ5IGluZGljZXMgdG8gdXBkYXRlIHRoZW1zZWx2ZXMuLi5cbiAgICAgICAgZGxlbiA9IHRoaXMuRHluYW1pY1ZpZXdzLmxlbmd0aDtcbiAgICAgICAgaWYgKChkbGVuID4gMCkgfHwgKGJpYyA+IDApIHx8ICh1aWMgPiAwKSkge1xuICAgICAgICAgIGlmIChkbGVuID4gMCkge1xuICAgICAgICAgICAgLy8gbm90aWZ5IGR5bmFtaWMgdmlld3MgdG8gcmVtb3ZlIHJlbGV2YW50IGRvY3VtZW50cyBhdCBkYXRhIHBvc2l0aW9uc1xuICAgICAgICAgICAgZm9yIChkaWR4ID0gMDsgZGlkeCA8IGRsZW47IGRpZHgrKykge1xuICAgICAgICAgICAgICAvLyBub3RpZnkgZHYgb2YgcmVtb3ZlIChwYXNzaW5nIGJhdGNoL2FycmF5IG9mIHBvc2l0aW9ucylcbiAgICAgICAgICAgICAgdGhpcy5EeW5hbWljVmlld3NbZGlkeF0ucmVtb3ZlRG9jdW1lbnQocG9zaXRpb25zKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBub3RpZnkgYmluYXJ5IGluZGljZXMgdG8gdXBkYXRlXG4gICAgICAgICAgaWYgKHRoaXMuYWRhcHRpdmVCaW5hcnlJbmRpY2VzICYmICFhZGFwdGl2ZU92ZXJyaWRlKSB7XG4gICAgICAgICAgICAvLyBmb3IgZWFjaCBiaW5hcnkgaW5kZXggZGVmaW5lZCBpbiBjb2xsZWN0aW9uLCBpbW1lZGlhdGVseSB1cGRhdGUgcmF0aGVyIHRoYW4gZmxhZyBmb3IgbGF6eSByZWJ1aWxkXG4gICAgICAgICAgICB2YXIga2V5LCBiSW5kaWNlcyA9IHRoaXMuYmluYXJ5SW5kaWNlcztcblxuICAgICAgICAgICAgZm9yIChrZXkgaW4gYkluZGljZXMpIHtcbiAgICAgICAgICAgICAgdGhpcy5hZGFwdGl2ZUJpbmFyeUluZGV4UmVtb3ZlKHBvc2l0aW9ucywga2V5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmZsYWdCaW5hcnlJbmRleGVzRGlydHkoKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAodWljKSB7XG4gICAgICAgICAgICBPYmplY3Qua2V5cyh0aGlzLmNvbnN0cmFpbnRzLnVuaXF1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgICAgIGZvcihpZHg9MDsgaWR4IDwgbGVuOyBpZHgrKykge1xuICAgICAgICAgICAgICAgIGRvYyA9IHNlbGYuZGF0YVtwb3NpdGlvbnNbaWR4XV07XG4gICAgICAgICAgICAgICAgaWYgKGRvY1trZXldICE9PSBudWxsICYmIGRvY1trZXldICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgIHNlbGYuY29uc3RyYWludHMudW5pcXVlW2tleV0ucmVtb3ZlKGRvY1trZXldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGVtaXQgJ2RlbGV0ZScgZXZlbnRzIG9ubHkgb2YgbGlzdGVuZXJzIGFyZSBhdHRhY2hlZC5cbiAgICAgICAgLy8gc2luY2UgZGF0YSBub3QgcmVtb3ZlZCB5ZXQsIGluIGZ1dHVyZSB3ZSBjYW4gZW1pdCBzaW5nbGUgZGVsZXRlIGV2ZW50IHdpdGggYXJyYXkuLi5cbiAgICAgICAgLy8gZm9yIG5vdyB0aGF0IG1pZ2h0IGJlIGJyZWFraW5nIGNoYW5nZSB0byBwdXQgaW4gcG90ZW50aWFsIDEuNiBvciBMb2tpREIgKGxva2lqczIpIHZlcnNpb25cbiAgICAgICAgaWYgKCF0aGlzLmRpc2FibGVDaGFuZ2VzQXBpIHx8IHRoaXMuZXZlbnRzLmRlbGV0ZS5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgZm9yKGlkeD0wOyBpZHggPCBsZW47IGlkeCsrKSB7XG4gICAgICAgICAgICB0aGlzLmVtaXQoJ2RlbGV0ZScsIHRoaXMuZGF0YVtwb3NpdGlvbnNbaWR4XV0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHJlbW92ZSBmcm9tIGRhdGFbXSA6XG4gICAgICAgIC8vIGZpbHRlciBjb2xsZWN0aW9uIGRhdGEgZm9yIGl0ZW1zIG5vdCBpbiBpbmNsdXNpb24gaGFzaG9iamVjdFxuICAgICAgICB0aGlzLmRhdGEgPSB0aGlzLmRhdGEuZmlsdGVyKGZ1bmN0aW9uKG9iaikge1xuICAgICAgICAgIHJldHVybiAheG9bb2JqLiRsb2tpXTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gcmVtb3ZlIGZyb20gaWRJbmRleFtdIDpcbiAgICAgICAgLy8gZmlsdGVyIGlkSW5kZXggZm9yIGl0ZW1zIG5vdCBpbiBpbmNsdXNpb24gaGFzaG9iamVjdFxuICAgICAgICB0aGlzLmlkSW5kZXggPSB0aGlzLmlkSW5kZXguZmlsdGVyKGZ1bmN0aW9uKGlkKSB7XG4gICAgICAgICAgICByZXR1cm4gIXhvW2lkXTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKHRoaXMuYWRhcHRpdmVCaW5hcnlJbmRpY2VzICYmIGFkYXB0aXZlT3ZlcnJpZGUpIHtcbiAgICAgICAgICB0aGlzLmFkYXB0aXZlQmluYXJ5SW5kaWNlcyA9IGZhbHNlO1xuICAgICAgICAgIHRoaXMuZW5zdXJlQWxsSW5kZXhlcyh0cnVlKTtcbiAgICAgICAgICB0aGlzLmFkYXB0aXZlQmluYXJ5SW5kaWNlcyA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmNvbW1pdCgpO1xuXG4gICAgICAgIC8vIGZsYWcgY29sbGVjdGlvbiBhcyBkaXJ0eSBmb3IgYXV0b3NhdmVcbiAgICAgICAgdGhpcy5kaXJ0eSA9IHRydWU7XG4gICAgICB9IFxuICAgICAgY2F0Y2ggKGVycikge1xuICAgICAgICB0aGlzLnJvbGxiYWNrKCk7XG4gICAgICAgIGlmIChhZGFwdGl2ZU92ZXJyaWRlKSB7XG4gICAgICAgICAgdGhpcy5hZGFwdGl2ZUJpbmFyeUluZGljZXMgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY29uc29sZS5lcnJvcihlcnIubWVzc2FnZSk7XG4gICAgICAgIHRoaXMuZW1pdCgnZXJyb3InLCBlcnIpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH0gICAgICBcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogIEludGVybmFsIG1ldGhvZCBjYWxsZWQgYnkgcmVtb3ZlKClcbiAgICAgKiBAcGFyYW0ge29iamVjdFtdfG51bWJlcltdfSBiYXRjaCAtIGFycmF5IG9mIGRvY3VtZW50cyBvciAkbG9raSBpZHMgdG8gcmVtb3ZlXG4gICAgICovXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUucmVtb3ZlQmF0Y2ggPSBmdW5jdGlvbihiYXRjaCkge1xuICAgICAgdmFyIGxlbiA9IGJhdGNoLmxlbmd0aCwgXG4gICAgICAgIGRsZW49dGhpcy5kYXRhLmxlbmd0aCwgXG4gICAgICAgIGlkeDtcbiAgICAgIHZhciB4bHQgPSB7fTtcbiAgICAgIHZhciBwb3N4ID0gW107XG4gICAgICBcbiAgICAgIC8vIGNyZWF0ZSBsb29rdXAgaGFzaG9iamVjdCB0byB0cmFuc2xhdGUgJGxva2kgaWQgdG8gcG9zaXRpb25cbiAgICAgIGZvciAoaWR4PTA7IGlkeCA8IGRsZW47IGlkeCsrKSB7XG4gICAgICAgIHhsdFt0aGlzLmRhdGFbaWR4XS4kbG9raV0gPSBpZHg7XG4gICAgICB9XG5cbiAgICAgIC8vIGl0ZXJhdGUgdGhlIGJhdGNoXG4gICAgICBmb3IgKGlkeD0wOyBpZHggPCBsZW47IGlkeCsrKSB7XG4gICAgICAgIGlmICh0eXBlb2YoYmF0Y2hbaWR4XSkgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgcG9zeC5wdXNoKHhsdFtiYXRjaFtpZHhdLiRsb2tpXSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgcG9zeC5wdXNoKHhsdFtiYXRjaFtpZHhdXSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgdGhpcy5yZW1vdmVCYXRjaEJ5UG9zaXRpb25zKHBvc3gpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgYSBkb2N1bWVudCBmcm9tIHRoZSBjb2xsZWN0aW9uXG4gICAgICogQHBhcmFtIHtvYmplY3R9IGRvYyAtIGRvY3VtZW50IHRvIHJlbW92ZSBmcm9tIGNvbGxlY3Rpb25cbiAgICAgKiBAbWVtYmVyb2YgQ29sbGVjdGlvblxuICAgICAqL1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uIChkb2MpIHtcbiAgICAgIGlmICh0eXBlb2YgZG9jID09PSAnbnVtYmVyJykge1xuICAgICAgICBkb2MgPSB0aGlzLmdldChkb2MpO1xuICAgICAgfVxuXG4gICAgICBpZiAoJ29iamVjdCcgIT09IHR5cGVvZiBkb2MpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdQYXJhbWV0ZXIgaXMgbm90IGFuIG9iamVjdCcpO1xuICAgICAgfVxuICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZG9jKSkge1xuICAgICAgICB0aGlzLnJlbW92ZUJhdGNoKGRvYyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgaWYgKCFoYXNPd25Qcm9wZXJ0eS5jYWxsKGRvYywgJyRsb2tpJykpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdPYmplY3QgaXMgbm90IGEgZG9jdW1lbnQgc3RvcmVkIGluIHRoZSBjb2xsZWN0aW9uJyk7XG4gICAgICB9XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIHRoaXMuc3RhcnRUcmFuc2FjdGlvbigpO1xuICAgICAgICB2YXIgYXJyID0gdGhpcy5nZXQoZG9jLiRsb2tpLCB0cnVlKSxcbiAgICAgICAgICAvLyBvYmogPSBhcnJbMF0sXG4gICAgICAgICAgcG9zaXRpb24gPSBhcnJbMV07XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgT2JqZWN0LmtleXModGhpcy5jb25zdHJhaW50cy51bmlxdWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgIGlmIChkb2Nba2V5XSAhPT0gbnVsbCAmJiB0eXBlb2YgZG9jW2tleV0gIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICBzZWxmLmNvbnN0cmFpbnRzLnVuaXF1ZVtrZXldLnJlbW92ZShkb2Nba2V5XSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgLy8gbm93IHRoYXQgd2UgY2FuIGVmZmljaWVudGx5IGRldGVybWluZSB0aGUgZGF0YVtdIHBvc2l0aW9uIG9mIG5ld2x5IGFkZGVkIGRvY3VtZW50LFxuICAgICAgICAvLyBzdWJtaXQgaXQgZm9yIGFsbCByZWdpc3RlcmVkIER5bmFtaWNWaWV3cyB0byByZW1vdmVcbiAgICAgICAgZm9yICh2YXIgaWR4ID0gMDsgaWR4IDwgdGhpcy5EeW5hbWljVmlld3MubGVuZ3RoOyBpZHgrKykge1xuICAgICAgICAgIHRoaXMuRHluYW1pY1ZpZXdzW2lkeF0ucmVtb3ZlRG9jdW1lbnQocG9zaXRpb24pO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuYWRhcHRpdmVCaW5hcnlJbmRpY2VzKSB7XG4gICAgICAgICAgLy8gZm9yIGVhY2ggYmluYXJ5IGluZGV4IGRlZmluZWQgaW4gY29sbGVjdGlvbiwgaW1tZWRpYXRlbHkgdXBkYXRlIHJhdGhlciB0aGFuIGZsYWcgZm9yIGxhenkgcmVidWlsZFxuICAgICAgICAgIHZhciBrZXksIGJJbmRpY2VzID0gdGhpcy5iaW5hcnlJbmRpY2VzO1xuICAgICAgICAgIGZvciAoa2V5IGluIGJJbmRpY2VzKSB7XG4gICAgICAgICAgICB0aGlzLmFkYXB0aXZlQmluYXJ5SW5kZXhSZW1vdmUocG9zaXRpb24sIGtleSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIHRoaXMuZmxhZ0JpbmFyeUluZGV4ZXNEaXJ0eSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5kYXRhLnNwbGljZShwb3NpdGlvbiwgMSk7XG4gICAgICAgIHRoaXMucmVtb3ZlQXV0b1VwZGF0ZU9ic2VydmVyKGRvYyk7XG5cbiAgICAgICAgLy8gcmVtb3ZlIGlkIGZyb20gaWRJbmRleFxuICAgICAgICB0aGlzLmlkSW5kZXguc3BsaWNlKHBvc2l0aW9uLCAxKTtcblxuICAgICAgICB0aGlzLmNvbW1pdCgpO1xuICAgICAgICB0aGlzLmRpcnR5ID0gdHJ1ZTsgLy8gZm9yIGF1dG9zYXZlIHNjZW5hcmlvc1xuICAgICAgICB0aGlzLmVtaXQoJ2RlbGV0ZScsIGFyclswXSk7XG4gICAgICAgIGRlbGV0ZSBkb2MuJGxva2k7XG4gICAgICAgIGRlbGV0ZSBkb2MubWV0YTtcbiAgICAgICAgcmV0dXJuIGRvYztcblxuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHRoaXMucm9sbGJhY2soKTtcbiAgICAgICAgdGhpcy5jb25zb2xlLmVycm9yKGVyci5tZXNzYWdlKTtcbiAgICAgICAgdGhpcy5lbWl0KCdlcnJvcicsIGVycik7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLStcbiAgICB8IEZpbmRpbmcgbWV0aG9kcyAgICAgfFxuICAgICstLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuICAgIC8qKlxuICAgICAqIEdldCBieSBJZCAtIGZhc3RlciB0aGFuIG90aGVyIG1ldGhvZHMgYmVjYXVzZSBvZiB0aGUgc2VhcmNoaW5nIGFsZ29yaXRobVxuICAgICAqIEBwYXJhbSB7aW50fSBpZCAtICRsb2tpIGlkIG9mIGRvY3VtZW50IHlvdSB3YW50IHRvIHJldHJpZXZlXG4gICAgICogQHBhcmFtIHtib29sZWFufSByZXR1cm5Qb3NpdGlvbiAtIGlmICd0cnVlJyB3ZSB3aWxsIHJldHVybiBbb2JqZWN0LCBwb3NpdGlvbl1cbiAgICAgKiBAcmV0dXJucyB7KG9iamVjdHxhcnJheXxudWxsKX0gT2JqZWN0IHJlZmVyZW5jZSBpZiBkb2N1bWVudCB3YXMgZm91bmQsIG51bGwgaWYgbm90LFxuICAgICAqICAgICBvciBhbiBhcnJheSBpZiAncmV0dXJuUG9zaXRpb24nIHdhcyBwYXNzZWQuXG4gICAgICogQG1lbWJlcm9mIENvbGxlY3Rpb25cbiAgICAgKi9cbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAoaWQsIHJldHVyblBvc2l0aW9uKSB7XG4gICAgICB2YXIgcmV0cG9zID0gcmV0dXJuUG9zaXRpb24gfHwgZmFsc2UsXG4gICAgICAgIGRhdGEgPSB0aGlzLmlkSW5kZXgsXG4gICAgICAgIG1heCA9IGRhdGEubGVuZ3RoIC0gMSxcbiAgICAgICAgbWluID0gMCxcbiAgICAgICAgbWlkID0gKG1pbiArIG1heCkgPj4gMTtcblxuICAgICAgaWQgPSB0eXBlb2YgaWQgPT09ICdudW1iZXInID8gaWQgOiBwYXJzZUludChpZCwgMTApO1xuXG4gICAgICBpZiAoaXNOYU4oaWQpKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1Bhc3NlZCBpZCBpcyBub3QgYW4gaW50ZWdlcicpO1xuICAgICAgfVxuXG4gICAgICB3aGlsZSAoZGF0YVttaW5dIDwgZGF0YVttYXhdKSB7XG4gICAgICAgIG1pZCA9IChtaW4gKyBtYXgpID4+IDE7XG5cbiAgICAgICAgaWYgKGRhdGFbbWlkXSA8IGlkKSB7XG4gICAgICAgICAgbWluID0gbWlkICsgMTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBtYXggPSBtaWQ7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKG1heCA9PT0gbWluICYmIGRhdGFbbWluXSA9PT0gaWQpIHtcbiAgICAgICAgaWYgKHJldHBvcykge1xuICAgICAgICAgIHJldHVybiBbdGhpcy5kYXRhW21pbl0sIG1pbl07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YVttaW5dO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG51bGw7XG5cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUGVyZm9ybSBiaW5hcnkgcmFuZ2UgbG9va3VwIGZvciB0aGUgZGF0YVtkYXRhUG9zaXRpb25dW2JpbmFyeUluZGV4TmFtZV0gcHJvcGVydHkgdmFsdWVcbiAgICAgKiAgICBTaW5jZSBtdWx0aXBsZSBkb2N1bWVudHMgbWF5IGNvbnRhaW4gdGhlIHNhbWUgdmFsdWUgKHdoaWNoIHRoZSBpbmRleCBpcyBzb3J0ZWQgb24pLFxuICAgICAqICAgIHdlIGhvbmUgaW4gb24gcmFuZ2UgYW5kIHRoZW4gbGluZWFyIHNjYW4gcmFuZ2UgdG8gZmluZCBleGFjdCBpbmRleCBhcnJheSBwb3NpdGlvbi5cbiAgICAgKiBAcGFyYW0ge2ludH0gZGF0YVBvc2l0aW9uIDogY29sbC5kYXRhIGFycmF5IGluZGV4L3Bvc2l0aW9uXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGJpbmFyeUluZGV4TmFtZSA6IGluZGV4IHRvIHNlYXJjaCBmb3IgZGF0YVBvc2l0aW9uIGluXG4gICAgICovXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUuZ2V0QmluYXJ5SW5kZXhQb3NpdGlvbiA9IGZ1bmN0aW9uKGRhdGFQb3NpdGlvbiwgYmluYXJ5SW5kZXhOYW1lKSB7XG4gICAgICB2YXIgdmFsID0gVXRpbHMuZ2V0SW4odGhpcy5kYXRhW2RhdGFQb3NpdGlvbl0sIGJpbmFyeUluZGV4TmFtZSwgdHJ1ZSk7XG4gICAgICB2YXIgaW5kZXggPSB0aGlzLmJpbmFyeUluZGljZXNbYmluYXJ5SW5kZXhOYW1lXS52YWx1ZXM7XG5cbiAgICAgIC8vIGkgdGhpbmsgY2FsY3VsYXRlUmFuZ2UgY2FuIHByb2JhYmx5IGJlIG1vdmVkIHRvIGNvbGxlY3Rpb25cbiAgICAgIC8vIGFzIGl0IGRvZXNuJ3Qgc2VlbSB0byBuZWVkIHJlc3VsdHNldC4gIG5lZWQgdG8gdmVyaWZ5XG4gICAgICB2YXIgcmFuZ2UgPSB0aGlzLmNhbGN1bGF0ZVJhbmdlKFwiJGVxXCIsIGJpbmFyeUluZGV4TmFtZSwgdmFsKTtcblxuICAgICAgaWYgKHJhbmdlWzBdID09PSAwICYmIHJhbmdlWzFdID09PSAtMSkge1xuICAgICAgICAvLyB1aG9oIGRpZG4ndCBmaW5kIHJhbmdlXG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuXG4gICAgICB2YXIgbWluID0gcmFuZ2VbMF07XG4gICAgICB2YXIgbWF4ID0gcmFuZ2VbMV07XG5cbiAgICAgIC8vIG5hcnJvdyBkb3duIHRoZSBzdWItc2VnbWVudCBvZiBpbmRleCB2YWx1ZXNcbiAgICAgIC8vIHdoZXJlIHRoZSBpbmRleGVkIHByb3BlcnR5IHZhbHVlIGV4YWN0bHkgbWF0Y2hlcyBvdXJcbiAgICAgIC8vIHZhbHVlIGFuZCB0aGVuIGxpbmVhciBzY2FuIHRvIGZpbmQgZXhhY3QgLWluZGV4LSBwb3NpdGlvblxuICAgICAgZm9yKHZhciBpZHggPSBtaW47IGlkeCA8PSBtYXg7IGlkeCsrKSB7XG4gICAgICAgIGlmIChpbmRleFtpZHhdID09PSBkYXRhUG9zaXRpb24pIHJldHVybiBpZHg7XG4gICAgICB9XG5cbiAgICAgIC8vIHVob2hcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBBZGFwdGl2ZWx5IGluc2VydCBhIHNlbGVjdGVkIGl0ZW0gdG8gdGhlIGluZGV4LlxuICAgICAqIEBwYXJhbSB7aW50fSBkYXRhUG9zaXRpb24gOiBjb2xsLmRhdGEgYXJyYXkgaW5kZXgvcG9zaXRpb25cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gYmluYXJ5SW5kZXhOYW1lIDogaW5kZXggdG8gc2VhcmNoIGZvciBkYXRhUG9zaXRpb24gaW5cbiAgICAgKi9cbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5hZGFwdGl2ZUJpbmFyeUluZGV4SW5zZXJ0ID0gZnVuY3Rpb24oZGF0YVBvc2l0aW9uLCBiaW5hcnlJbmRleE5hbWUpIHtcbiAgICAgIHZhciB1c2luZ0RvdE5vdGF0aW9uID0gKGJpbmFyeUluZGV4TmFtZS5pbmRleE9mKCcuJykgIT09IC0xKTtcbiAgICAgIHZhciBpbmRleCA9IHRoaXMuYmluYXJ5SW5kaWNlc1tiaW5hcnlJbmRleE5hbWVdLnZhbHVlcztcbiAgICAgIHZhciB2YWwgPSBVdGlscy5nZXRJbih0aGlzLmRhdGFbZGF0YVBvc2l0aW9uXSwgYmluYXJ5SW5kZXhOYW1lLCB1c2luZ0RvdE5vdGF0aW9uKTtcblxuICAgICAgLy8gSWYgeW91IGFyZSBpbnNlcnRpbmcgYSBqYXZhc2NyaXB0IERhdGUgdmFsdWUgaW50byBhIGJpbmFyeSBpbmRleCwgY29udmVydCB0byBlcG9jaCB0aW1lXG4gICAgICBpZiAodGhpcy5zZXJpYWxpemFibGVJbmRpY2VzID09PSB0cnVlICYmIHZhbCBpbnN0YW5jZW9mIERhdGUpIHtcbiAgICAgICAgdGhpcy5kYXRhW2RhdGFQb3NpdGlvbl1bYmluYXJ5SW5kZXhOYW1lXSA9IHZhbC5nZXRUaW1lKCk7XG4gICAgICAgIHZhbCA9IFV0aWxzLmdldEluKHRoaXMuZGF0YVtkYXRhUG9zaXRpb25dLCBiaW5hcnlJbmRleE5hbWUpO1xuICAgICAgfVxuXG4gICAgICB2YXIgaWR4UG9zID0gKGluZGV4Lmxlbmd0aCA9PT0gMCk/MDp0aGlzLmNhbGN1bGF0ZVJhbmdlU3RhcnQoYmluYXJ5SW5kZXhOYW1lLCB2YWwsIHRydWUsIHVzaW5nRG90Tm90YXRpb24pO1xuXG4gICAgICAvLyBpbnNlcnQgbmV3IGRhdGEgaW5kZXggaW50byBvdXIgYmluYXJ5IGluZGV4IGF0IHRoZSBwcm9wZXIgc29ydGVkIGxvY2F0aW9uIGZvciByZWxldmFudCBwcm9wZXJ0eSBjYWxjdWxhdGVkIGJ5IGlkeFBvcy5cbiAgICAgIC8vIGRvaW5nIHRoaXMgYWZ0ZXIgYWRqdXN0aW5nIGRhdGFQb3NpdGlvbnMgc28gbm8gY2xhc2ggd2l0aCBwcmV2aW91cyBpdGVtIGF0IHRoYXQgcG9zaXRpb24uXG4gICAgICB0aGlzLmJpbmFyeUluZGljZXNbYmluYXJ5SW5kZXhOYW1lXS52YWx1ZXMuc3BsaWNlKGlkeFBvcywgMCwgZGF0YVBvc2l0aW9uKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQWRhcHRpdmVseSB1cGRhdGUgYSBzZWxlY3RlZCBpdGVtIHdpdGhpbiBhbiBpbmRleC5cbiAgICAgKiBAcGFyYW0ge2ludH0gZGF0YVBvc2l0aW9uIDogY29sbC5kYXRhIGFycmF5IGluZGV4L3Bvc2l0aW9uXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGJpbmFyeUluZGV4TmFtZSA6IGluZGV4IHRvIHNlYXJjaCBmb3IgZGF0YVBvc2l0aW9uIGluXG4gICAgICovXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUuYWRhcHRpdmVCaW5hcnlJbmRleFVwZGF0ZSA9IGZ1bmN0aW9uKGRhdGFQb3NpdGlvbiwgYmluYXJ5SW5kZXhOYW1lKSB7XG4gICAgICAvLyBsaW5lYXIgc2NhbiBuZWVkZWQgdG8gZmluZCBvbGQgcG9zaXRpb24gd2l0aGluIGluZGV4IHVubGVzcyB3ZSBvcHRpbWl6ZSBmb3IgY2xvbmUgc2NlbmFyaW9zIGxhdGVyXG4gICAgICAvLyB3aXRoaW4gKG15KSBub2RlIDUuNi4wLCB0aGUgZm9sbG93aW5nIGZvcigpIGxvb3Agd2l0aCBzdHJpY3QgY29tcGFyZSBpcyAtbXVjaC0gZmFzdGVyIHRoYW4gaW5kZXhPZigpXG4gICAgICB2YXIgaWR4UG9zLFxuICAgICAgICBpbmRleCA9IHRoaXMuYmluYXJ5SW5kaWNlc1tiaW5hcnlJbmRleE5hbWVdLnZhbHVlcyxcbiAgICAgICAgbGVuPWluZGV4Lmxlbmd0aDtcblxuICAgICAgZm9yKGlkeFBvcz0wOyBpZHhQb3MgPCBsZW47IGlkeFBvcysrKSB7XG4gICAgICAgIGlmIChpbmRleFtpZHhQb3NdID09PSBkYXRhUG9zaXRpb24pIGJyZWFrO1xuICAgICAgfVxuXG4gICAgICAvL3ZhciBpZHhQb3MgPSB0aGlzLmJpbmFyeUluZGljZXNbYmluYXJ5SW5kZXhOYW1lXS52YWx1ZXMuaW5kZXhPZihkYXRhUG9zaXRpb24pO1xuICAgICAgdGhpcy5iaW5hcnlJbmRpY2VzW2JpbmFyeUluZGV4TmFtZV0udmFsdWVzLnNwbGljZShpZHhQb3MsIDEpO1xuXG4gICAgICAvL3RoaXMuYWRhcHRpdmVCaW5hcnlJbmRleFJlbW92ZShkYXRhUG9zaXRpb24sIGJpbmFyeUluZGV4TmFtZSwgdHJ1ZSk7XG4gICAgICB0aGlzLmFkYXB0aXZlQmluYXJ5SW5kZXhJbnNlcnQoZGF0YVBvc2l0aW9uLCBiaW5hcnlJbmRleE5hbWUpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBBZGFwdGl2ZWx5IHJlbW92ZSBhIHNlbGVjdGVkIGl0ZW0gZnJvbSB0aGUgaW5kZXguXG4gICAgICogQHBhcmFtIHtudW1iZXJ8bnVtYmVyW119IGRhdGFQb3NpdGlvbiA6IGNvbGwuZGF0YSBhcnJheSBpbmRleC9wb3NpdGlvblxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBiaW5hcnlJbmRleE5hbWUgOiBpbmRleCB0byBzZWFyY2ggZm9yIGRhdGFQb3NpdGlvbiBpblxuICAgICAqL1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmFkYXB0aXZlQmluYXJ5SW5kZXhSZW1vdmUgPSBmdW5jdGlvbihkYXRhUG9zaXRpb24sIGJpbmFyeUluZGV4TmFtZSwgcmVtb3ZlZEZyb21JbmRleE9ubHkpIHtcbiAgICAgIHZhciBiaSA9IHRoaXMuYmluYXJ5SW5kaWNlc1tiaW5hcnlJbmRleE5hbWVdO1xuICAgICAgdmFyIGxlbiwgaWR4LCBybWlkeCwgcm1sZW4sIHJ4byA9IHt9O1xuICAgICAgdmFyIGN1cnIsIHNoaWZ0LCBpZHhQb3M7XG5cbiAgICAgIGlmIChBcnJheS5pc0FycmF5KGRhdGFQb3NpdGlvbikpIHtcbiAgICAgICAgLy8gd2hlbiBjYWxsZWQgZnJvbSBjaGFpbmVkIHJlbW92ZSwgYW5kIG9ubHkgb25lIGRvY3VtZW50IGluIGFycmF5LFxuICAgICAgICAvLyBpdCB3aWxsIGJlIGZhc3RlciB0byB1c2Ugb2xkIGFsZ29yaXRobVxuICAgICAgICBybWxlbiA9IGRhdGFQb3NpdGlvbi5sZW5ndGg7XG4gICAgICAgIGlmIChybWxlbiA9PT0gMSkge1xuICAgICAgICAgIGRhdGFQb3NpdGlvbiA9IGRhdGFQb3NpdGlvblswXTtcbiAgICAgICAgfVxuICAgICAgICAvLyB3ZSB3ZXJlIHBhc3NlZCBhbiBhcnJheSAoYmF0Y2gpIG9mIGRvY3VtZW50cyBzbyB1c2UgdGhpcyAnYmF0Y2ggb3B0aW1pemVkJyBhbGdvcml0aG1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgZm9yKHJtaWR4PTA7cm1pZHg8cm1sZW47IHJtaWR4KyspIHtcbiAgICAgICAgICAgIHJ4b1tkYXRhUG9zaXRpb25bcm1pZHhdXSA9IHRydWU7XG4gICAgICAgICAgfVxuICAgIFxuICAgICAgICAgIC8vIHJlbW92ZSBkb2N1bWVudCBmcm9tIGluZGV4ICh3aXRoIGZpbHRlciBmdW5jdGlvbilcbiAgICAgICAgICBiaS52YWx1ZXMgPSBiaS52YWx1ZXMuZmlsdGVyKGZ1bmN0aW9uKGRpKSB7IHJldHVybiAhcnhvW2RpXTsgfSk7XG4gICAgXG4gICAgICAgICAgLy8gaWYgd2UgcGFzc2VkIHRoaXMgb3B0aW9uYWwgZmxhZyBwYXJhbWV0ZXIsIHdlIGFyZSBjYWxsaW5nIGZyb20gYWRhcHRpdmVCaW5hcnlJbmRleFVwZGF0ZSxcbiAgICAgICAgICAvLyBpbiB3aGljaCBjYXNlIGRhdGEgcG9zaXRpb25zIHN0YXkgdGhlIHNhbWUuXG4gICAgICAgICAgaWYgKHJlbW92ZWRGcm9tSW5kZXhPbmx5ID09PSB0cnVlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgIFxuICAgICAgICAgIHZhciBzb3J0ZWRQb3NpdGlvbnMgPSBkYXRhUG9zaXRpb24uc2xpY2UoKTtcbiAgICAgICAgICBzb3J0ZWRQb3NpdGlvbnMuc29ydChmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gYS1iOyB9KTtcbiAgICBcbiAgICAgICAgICAvLyB0byByZW1vdmUgaG9sZXMsIHdlIG5lZWQgdG8gJ3NoaWZ0IGRvd24nIHRoZSBpbmRleCdzIGRhdGEgYXJyYXkgcG9zaXRpb25zXG4gICAgICAgICAgLy8gd2UgbmVlZCB0byBhZGp1c3QgYXJyYXkgcG9zaXRpb25zIC0xIGZvciBlYWNoIGluZGV4IGRhdGEgcG9zaXRpb25zIGdyZWF0ZXIgdGhhbiByZW1vdmVkIHBvc2l0aW9uc1xuICAgICAgICAgIGxlbiA9IGJpLnZhbHVlcy5sZW5ndGg7XG4gICAgICAgICAgZm9yIChpZHg9MDsgaWR4PGxlbjsgaWR4KyspIHtcbiAgICAgICAgICAgIGN1cnI9YmkudmFsdWVzW2lkeF07XG4gICAgICAgICAgICBzaGlmdD0wO1xuICAgICAgICAgICAgZm9yKHJtaWR4PTA7IHJtaWR4PHJtbGVuICYmIGN1cnIgPiBzb3J0ZWRQb3NpdGlvbnNbcm1pZHhdOyBybWlkeCsrKSB7XG4gICAgICAgICAgICAgICAgc2hpZnQrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJpLnZhbHVlc1tpZHhdLT1zaGlmdDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBiYXRjaCBwcm9jZXNzZWQsIGJhaWwgb3V0XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gbm90IGEgYmF0Y2ggc28gY29udGludWUuLi5cbiAgICAgIH1cblxuICAgICAgaWR4UG9zID0gdGhpcy5nZXRCaW5hcnlJbmRleFBvc2l0aW9uKGRhdGFQb3NpdGlvbiwgYmluYXJ5SW5kZXhOYW1lKTtcblxuICAgICAgaWYgKGlkeFBvcyA9PT0gbnVsbCkge1xuICAgICAgICAvLyB0aHJvdyBuZXcgRXJyb3IoJ3VuYWJsZSB0byBkZXRlcm1pbmUgYmluYXJ5IGluZGV4IHBvc2l0aW9uJyk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuXG4gICAgICAvLyByZW1vdmUgZG9jdW1lbnQgZnJvbSBpbmRleCAod2l0aCBzcGxpY2UpXG4gICAgICBiaS52YWx1ZXMuc3BsaWNlKGlkeFBvcywgMSk7XG5cbiAgICAgIC8vIGlmIHdlIHBhc3NlZCB0aGlzIG9wdGlvbmFsIGZsYWcgcGFyYW1ldGVyLCB3ZSBhcmUgY2FsbGluZyBmcm9tIGFkYXB0aXZlQmluYXJ5SW5kZXhVcGRhdGUsXG4gICAgICAvLyBpbiB3aGljaCBjYXNlIGRhdGEgcG9zaXRpb25zIHN0YXkgdGhlIHNhbWUuXG4gICAgICBpZiAocmVtb3ZlZEZyb21JbmRleE9ubHkgPT09IHRydWUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBzaW5jZSBpbmRleCBzdG9yZXMgZGF0YSBhcnJheSBwb3NpdGlvbnMsIGlmIHdlIHJlbW92ZSBhIGRvY3VtZW50XG4gICAgICAvLyB3ZSBuZWVkIHRvIGFkanVzdCBhcnJheSBwb3NpdGlvbnMgLTEgZm9yIGFsbCBkb2N1bWVudCBwb3NpdGlvbnMgZ3JlYXRlciB0aGFuIHJlbW92ZWQgcG9zaXRpb25cbiAgICAgIGxlbiA9IGJpLnZhbHVlcy5sZW5ndGg7XG4gICAgICBmb3IgKGlkeCA9IDA7IGlkeCA8IGxlbjsgaWR4KyspIHtcbiAgICAgICAgaWYgKGJpLnZhbHVlc1tpZHhdID4gZGF0YVBvc2l0aW9uKSB7XG4gICAgICAgICAgYmkudmFsdWVzW2lkeF0tLTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBJbnRlcm5hbCBtZXRob2QgdXNlZCBmb3IgaW5kZXggbWFpbnRlbmFuY2UgYW5kIGluZGV4ZWQgc2VhcmNoaW5nLlxuICAgICAqIENhbGN1bGF0ZXMgdGhlIGJlZ2lubmluZyBvZiBhbiBpbmRleCByYW5nZSBmb3IgYSBnaXZlbiB2YWx1ZS5cbiAgICAgKiBGb3IgaW5kZXggbWFpbnRhaW5hbmNlIChhZGFwdGl2ZTp0cnVlKSwgd2Ugd2lsbCByZXR1cm4gYSB2YWxpZCBpbmRleCBwb3NpdGlvbiB0byBpbnNlcnQgdG8uXG4gICAgICogRm9yIHF1ZXJ5aW5nIChhZGFwdGl2ZTpmYWxzZS91bmRlZmluZWQpLCB3ZSB3aWxsIDpcbiAgICAgKiAgICByZXR1cm4gbG93ZXIgYm91bmQvaW5kZXggb2YgcmFuZ2Ugb2YgdGhhdCB2YWx1ZSAoaWYgZm91bmQpXG4gICAgICogICAgcmV0dXJuIG5leHQgbG93ZXIgaW5kZXggcG9zaXRpb24gaWYgbm90IGZvdW5kIChob2xlKVxuICAgICAqIElmIGluZGV4IGlzIGVtcHR5IGl0IGlzIGFzc3VtZWQgdG8gYmUgaGFuZGxlZCBhdCBoaWdoZXIgbGV2ZWwsIHNvXG4gICAgICogdGhpcyBtZXRob2QgYXNzdW1lcyB0aGVyZSBpcyBhdCBsZWFzdCAxIGRvY3VtZW50IGluIGluZGV4LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHByb3AgLSBuYW1lIG9mIHByb3BlcnR5IHdoaWNoIGhhcyBiaW5hcnkgaW5kZXhcbiAgICAgKiBAcGFyYW0ge2FueX0gdmFsIC0gdmFsdWUgdG8gZmluZCB3aXRoaW4gaW5kZXhcbiAgICAgKiBAcGFyYW0ge2Jvb2w/fSBhZGFwdGl2ZSAtIGlmIHRydWUsIHdlIHdpbGwgcmV0dXJuIGluc2VydCBwb3NpdGlvblxuICAgICAqL1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmNhbGN1bGF0ZVJhbmdlU3RhcnQgPSBmdW5jdGlvbiAocHJvcCwgdmFsLCBhZGFwdGl2ZSwgdXNpbmdEb3ROb3RhdGlvbikge1xuICAgICAgdmFyIHJjZCA9IHRoaXMuZGF0YTtcbiAgICAgIHZhciBpbmRleCA9IHRoaXMuYmluYXJ5SW5kaWNlc1twcm9wXS52YWx1ZXM7XG4gICAgICB2YXIgbWluID0gMDtcbiAgICAgIHZhciBtYXggPSBpbmRleC5sZW5ndGggLSAxO1xuICAgICAgdmFyIG1pZCA9IDA7XG5cbiAgICAgIGlmIChpbmRleC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgfVxuXG4gICAgICB2YXIgbWluVmFsID0gVXRpbHMuZ2V0SW4ocmNkW2luZGV4W21pbl1dLCBwcm9wLCB1c2luZ0RvdE5vdGF0aW9uKTtcbiAgICAgIHZhciBtYXhWYWwgPSBVdGlscy5nZXRJbihyY2RbaW5kZXhbbWF4XV0sIHByb3AsIHVzaW5nRG90Tm90YXRpb24pO1xuXG4gICAgICAvLyBob25lIGluIG9uIHN0YXJ0IHBvc2l0aW9uIG9mIHZhbHVlXG4gICAgICB3aGlsZSAobWluIDwgbWF4KSB7XG4gICAgICAgIG1pZCA9IChtaW4gKyBtYXgpID4+IDE7XG5cbiAgICAgICAgaWYgKENvbXBhcmF0b3JzLmx0KFV0aWxzLmdldEluKHJjZFtpbmRleFttaWRdXSwgcHJvcCwgdXNpbmdEb3ROb3RhdGlvbiksIHZhbCwgZmFsc2UpKSB7XG4gICAgICAgICAgbWluID0gbWlkICsgMTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBtYXggPSBtaWQ7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgdmFyIGxib3VuZCA9IG1pbjtcblxuICAgICAgLy8gZm91bmQgaXQuLi4gcmV0dXJuIGl0XG4gICAgICBpZiAoQ29tcGFyYXRvcnMuYWVxKHZhbCwgVXRpbHMuZ2V0SW4ocmNkW2luZGV4W2xib3VuZF1dLCBwcm9wLCB1c2luZ0RvdE5vdGF0aW9uKSkpIHtcbiAgICAgICAgcmV0dXJuIGxib3VuZDtcbiAgICAgIH1cblxuICAgICAgLy8gaWYgbm90IGluIGluZGV4IGFuZCBvdXIgdmFsdWUgaXMgbGVzcyB0aGFuIHRoZSBmb3VuZCBvbmVcbiAgICAgIGlmIChDb21wYXJhdG9ycy5sdCh2YWwsIFV0aWxzLmdldEluKHJjZFtpbmRleFtsYm91bmRdXSwgcHJvcCwgdXNpbmdEb3ROb3RhdGlvbiksIGZhbHNlKSkge1xuICAgICAgICByZXR1cm4gYWRhcHRpdmU/bGJvdW5kOmxib3VuZC0xO1xuICAgICAgfVxuXG4gICAgICAvLyBub3QgaW4gaW5kZXggYW5kIG91ciB2YWx1ZSBpcyBncmVhdGVyIHRoYW4gdGhlIGZvdW5kIG9uZVxuICAgICAgcmV0dXJuIGFkYXB0aXZlP2xib3VuZCsxOmxib3VuZDtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogSW50ZXJuYWwgbWV0aG9kIHVzZWQgZm9yIGluZGV4ZWQgJGJldHdlZW4uICBHaXZlbiBhIHByb3AgKGluZGV4IG5hbWUpLCBhbmQgYSB2YWx1ZVxuICAgICAqICh3aGljaCBtYXkgb3IgbWF5IG5vdCB5ZXQgZXhpc3QpIHRoaXMgd2lsbCBmaW5kIHRoZSBmaW5hbCBwb3NpdGlvbiBvZiB0aGF0IHVwcGVyIHJhbmdlIHZhbHVlLlxuICAgICAqL1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmNhbGN1bGF0ZVJhbmdlRW5kID0gZnVuY3Rpb24gKHByb3AsIHZhbCwgdXNpbmdEb3ROb3RhdGlvbikge1xuICAgICAgdmFyIHJjZCA9IHRoaXMuZGF0YTtcbiAgICAgIHZhciBpbmRleCA9IHRoaXMuYmluYXJ5SW5kaWNlc1twcm9wXS52YWx1ZXM7XG4gICAgICB2YXIgbWluID0gMDtcbiAgICAgIHZhciBtYXggPSBpbmRleC5sZW5ndGggLSAxO1xuICAgICAgdmFyIG1pZCA9IDA7XG5cbiAgICAgIGlmIChpbmRleC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgfVxuXG4gICAgICB2YXIgbWluVmFsID0gVXRpbHMuZ2V0SW4ocmNkW2luZGV4W21pbl1dLCBwcm9wLCB1c2luZ0RvdE5vdGF0aW9uKTtcbiAgICAgIHZhciBtYXhWYWwgPSBVdGlscy5nZXRJbihyY2RbaW5kZXhbbWF4XV0sIHByb3AsIHVzaW5nRG90Tm90YXRpb24pO1xuXG4gICAgICAvLyBob25lIGluIG9uIHN0YXJ0IHBvc2l0aW9uIG9mIHZhbHVlXG4gICAgICB3aGlsZSAobWluIDwgbWF4KSB7XG4gICAgICAgIG1pZCA9IChtaW4gKyBtYXgpID4+IDE7XG5cbiAgICAgICAgaWYgKENvbXBhcmF0b3JzLmx0KHZhbCwgVXRpbHMuZ2V0SW4ocmNkW2luZGV4W21pZF1dLCBwcm9wLCB1c2luZ0RvdE5vdGF0aW9uKSwgZmFsc2UpKSB7XG4gICAgICAgICAgbWF4ID0gbWlkO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG1pbiA9IG1pZCArIDE7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgdmFyIHVib3VuZCA9IG1heDtcblxuICAgICAgLy8gb25seSBlcSBpZiBsYXN0IGVsZW1lbnQgaW4gYXJyYXkgaXMgb3VyIHZhbFxuICAgICAgaWYgKENvbXBhcmF0b3JzLmFlcSh2YWwsIFV0aWxzLmdldEluKHJjZFtpbmRleFt1Ym91bmRdXSwgcHJvcCwgdXNpbmdEb3ROb3RhdGlvbikpKSB7XG4gICAgICAgIHJldHVybiB1Ym91bmQ7XG4gICAgICB9XG5cbiAgICAgICAvLyBpZiBub3QgaW4gaW5kZXggYW5kIG91ciB2YWx1ZSBpcyBsZXNzIHRoYW4gdGhlIGZvdW5kIG9uZVxuICAgICAgaWYgKENvbXBhcmF0b3JzLmd0KHZhbCwgVXRpbHMuZ2V0SW4ocmNkW2luZGV4W3Vib3VuZF1dLCBwcm9wLCB1c2luZ0RvdE5vdGF0aW9uKSwgZmFsc2UpKSB7XG4gICAgICAgIHJldHVybiB1Ym91bmQrMTtcbiAgICAgIH1cblxuICAgICAgLy8gZWl0aGVyIGhvbGUgb3IgZmlyc3Qgbm9ubWF0Y2hcbiAgICAgIGlmIChDb21wYXJhdG9ycy5hZXEodmFsLCBVdGlscy5nZXRJbihyY2RbaW5kZXhbdWJvdW5kLTFdXSwgcHJvcCwgdXNpbmdEb3ROb3RhdGlvbikpKSB7XG4gICAgICAgIHJldHVybiB1Ym91bmQtMTtcbiAgICAgIH1cblxuICAgICAgLy8gaG9sZSwgc28gdWJvdW5kIGlmIG5lYXJlc3QgZ3QgdGhhbiB0aGUgdmFsIHdlIHdlcmUgbG9va2luZyBmb3JcbiAgICAgIHJldHVybiB1Ym91bmQ7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIGNhbGN1bGF0ZVJhbmdlKCkgLSBCaW5hcnkgU2VhcmNoIHV0aWxpdHkgbWV0aG9kIHRvIGZpbmQgcmFuZ2Uvc2VnbWVudCBvZiB2YWx1ZXMgbWF0Y2hpbmcgY3JpdGVyaWEuXG4gICAgICogICAgdGhpcyBpcyB1c2VkIGZvciBjb2xsZWN0aW9uLmZpbmQoKSBhbmQgZmlyc3QgZmluZCBmaWx0ZXIgb2YgcmVzdWx0c2V0L2R5bnZpZXdcbiAgICAgKiAgICBzbGlnaHRseSBkaWZmZXJlbnQgdGhhbiBnZXQoKSBiaW5hcnkgc2VhcmNoIGluIHRoYXQgZ2V0KCkgaG9uZXMgaW4gb24gMSB2YWx1ZSxcbiAgICAgKiAgICBidXQgd2UgaGF2ZSB0byBob25lIGluIG9uIG1hbnkgKHJhbmdlKVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBvcCAtIG9wZXJhdGlvbiwgc3VjaCBhcyAkZXFcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gcHJvcCAtIG5hbWUgb2YgcHJvcGVydHkgdG8gY2FsY3VsYXRlIHJhbmdlIGZvclxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSB2YWwgLSB2YWx1ZSB0byB1c2UgZm9yIHJhbmdlIGNhbGN1bGF0aW9uLlxuICAgICAqIEByZXR1cm5zIHthcnJheX0gW3N0YXJ0LCBlbmRdIGluZGV4IGFycmF5IHBvc2l0aW9uc1xuICAgICAqL1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmNhbGN1bGF0ZVJhbmdlID0gZnVuY3Rpb24gKG9wLCBwcm9wLCB2YWwpIHtcbiAgICAgIHZhciByY2QgPSB0aGlzLmRhdGE7XG4gICAgICB2YXIgaW5kZXggPSB0aGlzLmJpbmFyeUluZGljZXNbcHJvcF0udmFsdWVzO1xuICAgICAgdmFyIG1pbiA9IDA7XG4gICAgICB2YXIgbWF4ID0gaW5kZXgubGVuZ3RoIC0gMTtcbiAgICAgIHZhciBtaWQgPSAwO1xuICAgICAgdmFyIGxib3VuZCwgbHZhbDtcbiAgICAgIHZhciB1Ym91bmQsIHV2YWw7XG5cbiAgICAgIC8vIHdoZW4gbm8gZG9jdW1lbnRzIGFyZSBpbiBjb2xsZWN0aW9uLCByZXR1cm4gZW1wdHkgcmFuZ2UgY29uZGl0aW9uXG4gICAgICBpZiAocmNkLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICByZXR1cm4gWzAsIC0xXTtcbiAgICAgIH1cblxuICAgICAgdmFyIHVzaW5nRG90Tm90YXRpb24gPSAocHJvcC5pbmRleE9mKCcuJykgIT09IC0xKTtcblxuICAgICAgdmFyIG1pblZhbCA9IFV0aWxzLmdldEluKHJjZFtpbmRleFttaW5dXSwgcHJvcCwgdXNpbmdEb3ROb3RhdGlvbik7XG4gICAgICB2YXIgbWF4VmFsID0gVXRpbHMuZ2V0SW4ocmNkW2luZGV4W21heF1dLCBwcm9wLCB1c2luZ0RvdE5vdGF0aW9uKTtcblxuICAgICAgLy8gaWYgdmFsdWUgZmFsbHMgb3V0c2lkZSBvZiBvdXIgcmFuZ2UgcmV0dXJuIFswLCAtMV0gdG8gZGVzaWduYXRlIG5vIHJlc3VsdHNcbiAgICAgIHN3aXRjaCAob3ApIHtcbiAgICAgIGNhc2UgJyRlcSc6XG4gICAgICBjYXNlICckYWVxJzpcbiAgICAgICAgaWYgKENvbXBhcmF0b3JzLmx0KHZhbCwgbWluVmFsLCBmYWxzZSkgfHwgQ29tcGFyYXRvcnMuZ3QodmFsLCBtYXhWYWwsIGZhbHNlKSkge1xuICAgICAgICAgIHJldHVybiBbMCwgLTFdO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnJGR0ZXEnOlxuICAgICAgICBpZiAoQ29tcGFyYXRvcnMubHQodmFsLCBtaW5WYWwsIGZhbHNlKSB8fCBDb21wYXJhdG9ycy5ndCh2YWwsIG1heFZhbCwgZmFsc2UpKSB7XG4gICAgICAgICAgcmV0dXJuIFswLCAtMV07XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICckZ3QnOlxuICAgICAgICAvLyBub25lIGFyZSB3aXRoaW4gcmFuZ2VcbiAgICAgICAgaWYgKENvbXBhcmF0b3JzLmd0KHZhbCwgbWF4VmFsLCB0cnVlKSkge1xuICAgICAgICAgIHJldHVybiBbMCwgLTFdO1xuICAgICAgICB9XG4gICAgICAgIC8vIGFsbCBhcmUgd2l0aGluIHJhbmdlXG4gICAgICAgIGlmIChDb21wYXJhdG9ycy5ndChtaW5WYWwsIHZhbCwgZmFsc2UpKSB7XG4gICAgICAgICAgcmV0dXJuIFttaW4sIG1heF07XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICckZ3RlJzpcbiAgICAgICAgLy8gbm9uZSBhcmUgd2l0aGluIHJhbmdlXG4gICAgICAgIGlmIChDb21wYXJhdG9ycy5ndCh2YWwsIG1heFZhbCwgZmFsc2UpKSB7XG4gICAgICAgICAgcmV0dXJuIFswLCAtMV07XG4gICAgICAgIH1cbiAgICAgICAgLy8gYWxsIGFyZSB3aXRoaW4gcmFuZ2VcbiAgICAgICAgaWYgKENvbXBhcmF0b3JzLmd0KG1pblZhbCwgdmFsLCB0cnVlKSkge1xuICAgICAgICAgICAgcmV0dXJuIFttaW4sIG1heF07XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICckbHQnOlxuICAgICAgICAvLyBub25lIGFyZSB3aXRoaW4gcmFuZ2VcbiAgICAgICAgaWYgKENvbXBhcmF0b3JzLmx0KHZhbCwgbWluVmFsLCB0cnVlKSkge1xuICAgICAgICAgIHJldHVybiBbMCwgLTFdO1xuICAgICAgICB9XG4gICAgICAgIC8vIGFsbCBhcmUgd2l0aGluIHJhbmdlXG4gICAgICAgIGlmIChDb21wYXJhdG9ycy5sdChtYXhWYWwsIHZhbCwgZmFsc2UpKSB7XG4gICAgICAgICAgcmV0dXJuIFttaW4sIG1heF07XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICckbHRlJzpcbiAgICAgICAgLy8gbm9uZSBhcmUgd2l0aGluIHJhbmdlXG4gICAgICAgIGlmIChDb21wYXJhdG9ycy5sdCh2YWwsIG1pblZhbCwgZmFsc2UpKSB7XG4gICAgICAgICAgcmV0dXJuIFswLCAtMV07XG4gICAgICAgIH1cbiAgICAgICAgLy8gYWxsIGFyZSB3aXRoaW4gcmFuZ2VcbiAgICAgICAgaWYgKENvbXBhcmF0b3JzLmx0KG1heFZhbCwgdmFsLCB0cnVlKSkge1xuICAgICAgICAgIHJldHVybiBbbWluLCBtYXhdO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnJGJldHdlZW4nOlxuICAgICAgICAvLyBub25lIGFyZSB3aXRoaW4gcmFuZ2UgKGxvdyByYW5nZSBpcyBncmVhdGVyKVxuICAgICAgICBpZiAoQ29tcGFyYXRvcnMuZ3QodmFsWzBdLCBtYXhWYWwsIGZhbHNlKSkge1xuICAgICAgICAgIHJldHVybiBbMCwgLTFdO1xuICAgICAgICB9XG4gICAgICAgIC8vIG5vbmUgYXJlIHdpdGhpbiByYW5nZSAoaGlnaCByYW5nZSBsb3dlcilcbiAgICAgICAgaWYgKENvbXBhcmF0b3JzLmx0KHZhbFsxXSwgbWluVmFsLCBmYWxzZSkpIHtcbiAgICAgICAgICByZXR1cm4gWzAsIC0xXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxib3VuZCA9IHRoaXMuY2FsY3VsYXRlUmFuZ2VTdGFydChwcm9wLCB2YWxbMF0sIGZhbHNlLCB1c2luZ0RvdE5vdGF0aW9uKTtcbiAgICAgICAgdWJvdW5kID0gdGhpcy5jYWxjdWxhdGVSYW5nZUVuZChwcm9wLCB2YWxbMV0sIHVzaW5nRG90Tm90YXRpb24pO1xuXG4gICAgICAgIGlmIChsYm91bmQgPCAwKSBsYm91bmQrKztcbiAgICAgICAgaWYgKHVib3VuZCA+IG1heCkgdWJvdW5kLS07XG5cbiAgICAgICAgaWYgKCFDb21wYXJhdG9ycy5ndChVdGlscy5nZXRJbihyY2RbaW5kZXhbbGJvdW5kXV0sIHByb3AsIHVzaW5nRG90Tm90YXRpb24pLCB2YWxbMF0sIHRydWUpKSBsYm91bmQrKztcbiAgICAgICAgaWYgKCFDb21wYXJhdG9ycy5sdChVdGlscy5nZXRJbihyY2RbaW5kZXhbdWJvdW5kXV0sIHByb3AsIHVzaW5nRG90Tm90YXRpb24pLCB2YWxbMV0sIHRydWUpKSB1Ym91bmQtLTtcblxuICAgICAgICBpZiAodWJvdW5kIDwgbGJvdW5kKSByZXR1cm4gWzAsIC0xXTtcblxuICAgICAgICByZXR1cm4gKFtsYm91bmQsIHVib3VuZF0pO1xuICAgICAgY2FzZSAnJGluJzpcbiAgICAgICAgdmFyIGlkeHNldCA9IFtdLFxuICAgICAgICAgIHNlZ1Jlc3VsdCA9IFtdO1xuICAgICAgICAvLyBxdWVyeSBlYWNoIHZhbHVlICckZXEnIG9wZXJhdG9yIGFuZCBtZXJnZSB0aGUgc2VxbWVudCByZXN1bHRzLlxuICAgICAgICBmb3IgKHZhciBqID0gMCwgbGVuID0gdmFsLmxlbmd0aDsgaiA8IGxlbjsgaisrKSB7XG4gICAgICAgICAgICB2YXIgc2VnID0gdGhpcy5jYWxjdWxhdGVSYW5nZSgnJGVxJywgcHJvcCwgdmFsW2pdKTtcblxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IHNlZ1swXTsgaSA8PSBzZWdbMV07IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChpZHhzZXRbaV0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBpZHhzZXRbaV0gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBzZWdSZXN1bHQucHVzaChpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNlZ1Jlc3VsdDtcbiAgICAgIH1cblxuICAgICAgLy8gZGV0ZXJtaW5lIGxib3VuZCB3aGVyZSBuZWVkZWRcbiAgICAgIHN3aXRjaCAob3ApIHtcbiAgICAgICAgY2FzZSAnJGVxJzpcbiAgICAgICAgY2FzZSAnJGFlcSc6XG4gICAgICAgIGNhc2UgJyRkdGVxJzpcbiAgICAgICAgY2FzZSAnJGd0ZSc6XG4gICAgICAgIGNhc2UgJyRsdCc6XG4gICAgICAgIGxib3VuZCA9IHRoaXMuY2FsY3VsYXRlUmFuZ2VTdGFydChwcm9wLCB2YWwsIGZhbHNlLCB1c2luZ0RvdE5vdGF0aW9uKTtcbiAgICAgICAgbHZhbCA9IFV0aWxzLmdldEluKHJjZFtpbmRleFtsYm91bmRdXSwgcHJvcCwgdXNpbmdEb3ROb3RhdGlvbik7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6IGJyZWFrO1xuICAgICAgfVxuXG4gICAgICAvLyBkZXRlcm1pbmUgdWJvdW5kIHdoZXJlIG5lZWRlZFxuICAgICAgc3dpdGNoIChvcCkge1xuICAgICAgICBjYXNlICckZXEnOlxuICAgICAgICBjYXNlICckYWVxJzpcbiAgICAgICAgY2FzZSAnJGR0ZXEnOlxuICAgICAgICBjYXNlICckbHRlJzpcbiAgICAgICAgY2FzZSAnJGd0JzpcbiAgICAgICAgICB1Ym91bmQgPSB0aGlzLmNhbGN1bGF0ZVJhbmdlRW5kKHByb3AsIHZhbCwgdXNpbmdEb3ROb3RhdGlvbik7XG4gICAgICAgICAgdXZhbCA9IFV0aWxzLmdldEluKHJjZFtpbmRleFt1Ym91bmRdXSwgcHJvcCwgdXNpbmdEb3ROb3RhdGlvbik7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6IGJyZWFrO1xuICAgICAgfVxuXG5cbiAgICAgIHN3aXRjaCAob3ApIHtcbiAgICAgIGNhc2UgJyRlcSc6XG4gICAgICBjYXNlICckYWVxJzpcbiAgICAgIGNhc2UgJyRkdGVxJzpcbiAgICAgICAgLy8gaWYgaG9sZSAobm90IGZvdW5kKVxuICAgICAgICBpZiAoIUNvbXBhcmF0b3JzLmFlcShsdmFsLCB2YWwpKSB7XG4gICAgICAgICAgcmV0dXJuIFswLCAtMV07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gW2xib3VuZCwgdWJvdW5kXTtcblxuICAgICAgY2FzZSAnJGd0JzpcbiAgICAgICAgLy8gaWYgaG9sZSAobm90IGZvdW5kKSB1YiBwb3NpdGlvbiBpcyBhbHJlYWR5IGdyZWF0ZXJcbiAgICAgICAgaWYgKCFDb21wYXJhdG9ycy5hZXEoVXRpbHMuZ2V0SW4ocmNkW2luZGV4W3Vib3VuZF1dLCBwcm9wLCB1c2luZ0RvdE5vdGF0aW9uKSwgdmFsKSkge1xuICAgICAgICAgIHJldHVybiBbdWJvdW5kLCBtYXhdO1xuICAgICAgICB9XG4gICAgICAgIC8vIG90aGVyd2lzZSAoZm91bmQpIHNvIHVib3VuZCBpcyBzdGlsbCBlcXVhbCwgZ2V0IG5leHRcbiAgICAgICAgcmV0dXJuIFt1Ym91bmQrMSwgbWF4XTtcblxuICAgICAgY2FzZSAnJGd0ZSc6XG4gICAgICAgIC8vIGlmIGhvbGUgKG5vdCBmb3VuZCkgbGIgcG9zaXRpb24gbWFya3MgbGVmdCBvdXRzaWRlIG9mIHJhbmdlXG4gICAgICAgIGlmICghQ29tcGFyYXRvcnMuYWVxKFV0aWxzLmdldEluKHJjZFtpbmRleFtsYm91bmRdXSwgcHJvcCwgdXNpbmdEb3ROb3RhdGlvbiksIHZhbCkpIHtcbiAgICAgICAgICByZXR1cm4gW2xib3VuZCsxLCBtYXhdO1xuICAgICAgICB9XG4gICAgICAgIC8vIG90aGVyd2lzZSAoZm91bmQpIHNvIGxiIGlzIGZpcnN0IHBvc2l0aW9uIHdoZXJlIGl0cyBlcXVhbFxuICAgICAgICByZXR1cm4gW2xib3VuZCwgbWF4XTtcblxuICAgICAgY2FzZSAnJGx0JzpcbiAgICAgICAgLy8gaWYgaG9sZSAobm90IGZvdW5kKSBwb3NpdGlvbiBhbHJlYWR5IGlzIGxlc3MgdGhhblxuICAgICAgICBpZiAoIUNvbXBhcmF0b3JzLmFlcShVdGlscy5nZXRJbihyY2RbaW5kZXhbbGJvdW5kXV0sIHByb3AsIHVzaW5nRG90Tm90YXRpb24pLCB2YWwpKSB7XG4gICAgICAgICAgcmV0dXJuIFttaW4sIGxib3VuZF07XG4gICAgICAgIH1cbiAgICAgICAgLy8gb3RoZXJ3aXNlIChmb3VuZCkgc28gbGIgbWFya3MgbGVmdCBpbnNpZGUgb2YgZXEgcmFuZ2UsIGdldCBwcmV2aW91c1xuICAgICAgICByZXR1cm4gW21pbiwgbGJvdW5kLTFdO1xuXG4gICAgICBjYXNlICckbHRlJzpcbiAgICAgICAgLy8gaWYgaG9sZSAobm90IGZvdW5kKSB1YiBwb3NpdGlvbiBtYXJrcyByaWdodCBvdXRzaWRlIHNvIGdldCBwcmV2aW91c1xuICAgICAgICBpZiAoIUNvbXBhcmF0b3JzLmFlcShVdGlscy5nZXRJbihyY2RbaW5kZXhbdWJvdW5kXV0sIHByb3AsIHVzaW5nRG90Tm90YXRpb24pLCB2YWwpKSB7XG4gICAgICAgICAgcmV0dXJuIFttaW4sIHVib3VuZC0xXTtcbiAgICAgICAgfVxuICAgICAgICAvLyBvdGhlcndpc2UgKGZvdW5kKSBzbyB1YiBpcyBsYXN0IHBvc2l0aW9uIHdoZXJlIGl0cyBzdGlsbCBlcXVhbFxuICAgICAgICByZXR1cm4gW21pbiwgdWJvdW5kXTtcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIFswLCByY2QubGVuZ3RoIC0gMV07XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFJldHJpZXZlIGRvYyBieSBVbmlxdWUgaW5kZXhcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZmllbGQgLSBuYW1lIG9mIHVuaXF1ZWx5IGluZGV4ZWQgcHJvcGVydHkgdG8gdXNlIHdoZW4gZG9pbmcgbG9va3VwXG4gICAgICogQHBhcmFtIHt2YWx1ZX0gdmFsdWUgLSB1bmlxdWUgdmFsdWUgdG8gc2VhcmNoIGZvclxuICAgICAqIEByZXR1cm5zIHtvYmplY3R9IGRvY3VtZW50IG1hdGNoaW5nIHRoZSB2YWx1ZSBwYXNzZWRcbiAgICAgKiBAbWVtYmVyb2YgQ29sbGVjdGlvblxuICAgICAqL1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmJ5ID0gZnVuY3Rpb24gKGZpZWxkLCB2YWx1ZSkge1xuICAgICAgdmFyIHNlbGY7XG4gICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBzZWxmID0gdGhpcztcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgIHJldHVybiBzZWxmLmJ5KGZpZWxkLCB2YWx1ZSk7XG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIHZhciByZXN1bHQgPSB0aGlzLmNvbnN0cmFpbnRzLnVuaXF1ZVtmaWVsZF0uZ2V0KHZhbHVlKTtcbiAgICAgIGlmICghdGhpcy5jbG9uZU9iamVjdHMpIHtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBjbG9uZShyZXN1bHQsIHRoaXMuY2xvbmVNZXRob2QpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBGaW5kIG9uZSBvYmplY3QgYnkgaW5kZXggcHJvcGVydHksIGJ5IHByb3BlcnR5IGVxdWFsIHRvIHZhbHVlXG4gICAgICogQHBhcmFtIHtvYmplY3R9IHF1ZXJ5IC0gcXVlcnkgb2JqZWN0IHVzZWQgdG8gcGVyZm9ybSBzZWFyY2ggd2l0aFxuICAgICAqIEByZXR1cm5zIHsob2JqZWN0fG51bGwpfSBGaXJzdCBtYXRjaGluZyBkb2N1bWVudCwgb3IgbnVsbCBpZiBub25lXG4gICAgICogQG1lbWJlcm9mIENvbGxlY3Rpb25cbiAgICAgKi9cbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5maW5kT25lID0gZnVuY3Rpb24gKHF1ZXJ5KSB7XG4gICAgICBxdWVyeSA9IHF1ZXJ5IHx8IHt9O1xuXG4gICAgICAvLyBJbnN0YW50aWF0ZSBSZXN1bHRzZXQgYW5kIGV4ZWMgZmluZCBvcCBwYXNzaW5nIGZpcnN0T25seSA9IHRydWUgcGFyYW1cbiAgICAgIHZhciByZXN1bHQgPSB0aGlzLmNoYWluKCkuZmluZChxdWVyeSx0cnVlKS5kYXRhKCk7XG5cbiAgICAgIGlmIChBcnJheS5pc0FycmF5KHJlc3VsdCkgJiYgcmVzdWx0Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICghdGhpcy5jbG9uZU9iamVjdHMpIHtcbiAgICAgICAgICByZXR1cm4gcmVzdWx0WzBdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiBjbG9uZShyZXN1bHRbMF0sIHRoaXMuY2xvbmVNZXRob2QpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIENoYWluIG1ldGhvZCwgdXNlZCBmb3IgYmVnaW5uaW5nIGEgc2VyaWVzIG9mIGNoYWluZWQgZmluZCgpIGFuZC9vciB2aWV3KCkgb3BlcmF0aW9uc1xuICAgICAqIG9uIGEgY29sbGVjdGlvbi5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfGFycmF5PX0gdHJhbnNmb3JtIC0gbmFtZWQgdHJhbnNmb3JtIG9yIGFycmF5IG9mIHRyYW5zZm9ybSBzdGVwc1xuICAgICAqIEBwYXJhbSB7b2JqZWN0PX0gcGFyYW1ldGVycyAtIE9iamVjdCBjb250YWluaW5nIHByb3BlcnRpZXMgcmVwcmVzZW50aW5nIHBhcmFtZXRlcnMgdG8gc3Vic3RpdHV0ZVxuICAgICAqIEByZXR1cm5zIHtSZXN1bHRzZXR9ICh0aGlzKSByZXN1bHRzZXQsIG9yIGRhdGEgYXJyYXkgaWYgYW55IG1hcCBvciBqb2luIGZ1bmN0aW9ucyB3aGVyZSBjYWxsZWRcbiAgICAgKiBAbWVtYmVyb2YgQ29sbGVjdGlvblxuICAgICAqL1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmNoYWluID0gZnVuY3Rpb24gKHRyYW5zZm9ybSwgcGFyYW1ldGVycykge1xuICAgICAgdmFyIHJzID0gbmV3IFJlc3VsdHNldCh0aGlzKTtcblxuICAgICAgaWYgKHR5cGVvZiB0cmFuc2Zvcm0gPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHJldHVybiBycztcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHJzLnRyYW5zZm9ybSh0cmFuc2Zvcm0sIHBhcmFtZXRlcnMpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBGaW5kIG1ldGhvZCwgYXBpIGlzIHNpbWlsYXIgdG8gbW9uZ29kYi5cbiAgICAgKiBmb3IgbW9yZSBjb21wbGV4IHF1ZXJpZXMgdXNlIFtjaGFpbigpXXtAbGluayBDb2xsZWN0aW9uI2NoYWlufSBvciBbd2hlcmUoKV17QGxpbmsgQ29sbGVjdGlvbiN3aGVyZX0uXG4gICAgICogQGV4YW1wbGUge0B0dXRvcmlhbCBRdWVyeSBFeGFtcGxlc31cbiAgICAgKiBAcGFyYW0ge29iamVjdH0gcXVlcnkgLSAnbW9uZ28tbGlrZScgcXVlcnkgb2JqZWN0XG4gICAgICogQHJldHVybnMge2FycmF5fSBBcnJheSBvZiBtYXRjaGluZyBkb2N1bWVudHNcbiAgICAgKiBAbWVtYmVyb2YgQ29sbGVjdGlvblxuICAgICAqL1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmZpbmQgPSBmdW5jdGlvbiAocXVlcnkpIHtcbiAgICAgIHJldHVybiB0aGlzLmNoYWluKCkuZmluZChxdWVyeSkuZGF0YSgpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBGaW5kIG9iamVjdCBieSB1bmluZGV4ZWQgZmllbGQgYnkgcHJvcGVydHkgZXF1YWwgdG8gdmFsdWUsXG4gICAgICogc2ltcGx5IGl0ZXJhdGVzIGFuZCByZXR1cm5zIHRoZSBmaXJzdCBlbGVtZW50IG1hdGNoaW5nIHRoZSBxdWVyeVxuICAgICAqL1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmZpbmRPbmVVbmluZGV4ZWQgPSBmdW5jdGlvbiAocHJvcCwgdmFsdWUpIHtcbiAgICAgIHZhciBpID0gdGhpcy5kYXRhLmxlbmd0aCxcbiAgICAgICAgZG9jO1xuICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICBpZiAoVXRpbHMuZ2V0SW4odGhpcy5kYXRhW2ldLCBwcm9wLCB0cnVlKSA9PT0gdmFsdWUpIHtcbiAgICAgICAgICBkb2MgPSB0aGlzLmRhdGFbaV07XG4gICAgICAgICAgcmV0dXJuIGRvYztcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFRyYW5zYWN0aW9uIG1ldGhvZHNcbiAgICAgKi9cblxuICAgIC8qKiBzdGFydCB0aGUgdHJhbnNhdGlvbiAqL1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLnN0YXJ0VHJhbnNhY3Rpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAodGhpcy50cmFuc2FjdGlvbmFsKSB7XG4gICAgICAgIHRoaXMuY2FjaGVkRGF0YSA9IGNsb25lKHRoaXMuZGF0YSwgdGhpcy5jbG9uZU1ldGhvZCk7XG4gICAgICAgIHRoaXMuY2FjaGVkSW5kZXggPSB0aGlzLmlkSW5kZXg7XG4gICAgICAgIHRoaXMuY2FjaGVkQmluYXJ5SW5kZXggPSB0aGlzLmJpbmFyeUluZGljZXM7XG5cbiAgICAgICAgLy8gcHJvcGFnYXRlIHN0YXJ0VHJhbnNhY3Rpb24gdG8gZHluYW1pYyB2aWV3c1xuICAgICAgICBmb3IgKHZhciBpZHggPSAwOyBpZHggPCB0aGlzLkR5bmFtaWNWaWV3cy5sZW5ndGg7IGlkeCsrKSB7XG4gICAgICAgICAgdGhpcy5EeW5hbWljVmlld3NbaWR4XS5zdGFydFRyYW5zYWN0aW9uKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqIGNvbW1pdCB0aGUgdHJhbnNhdGlvbiAqL1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmNvbW1pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICh0aGlzLnRyYW5zYWN0aW9uYWwpIHtcbiAgICAgICAgdGhpcy5jYWNoZWREYXRhID0gbnVsbDtcbiAgICAgICAgdGhpcy5jYWNoZWRJbmRleCA9IG51bGw7XG4gICAgICAgIHRoaXMuY2FjaGVkQmluYXJ5SW5kZXggPSBudWxsO1xuXG4gICAgICAgIC8vIHByb3BhZ2F0ZSBjb21taXQgdG8gZHluYW1pYyB2aWV3c1xuICAgICAgICBmb3IgKHZhciBpZHggPSAwOyBpZHggPCB0aGlzLkR5bmFtaWNWaWV3cy5sZW5ndGg7IGlkeCsrKSB7XG4gICAgICAgICAgdGhpcy5EeW5hbWljVmlld3NbaWR4XS5jb21taXQoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG5cbiAgICAvKiogcm9sbCBiYWNrIHRoZSB0cmFuc2F0aW9uICovXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUucm9sbGJhY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAodGhpcy50cmFuc2FjdGlvbmFsKSB7XG4gICAgICAgIGlmICh0aGlzLmNhY2hlZERhdGEgIT09IG51bGwgJiYgdGhpcy5jYWNoZWRJbmRleCAhPT0gbnVsbCkge1xuICAgICAgICAgIHRoaXMuZGF0YSA9IHRoaXMuY2FjaGVkRGF0YTtcbiAgICAgICAgICB0aGlzLmlkSW5kZXggPSB0aGlzLmNhY2hlZEluZGV4O1xuICAgICAgICAgIHRoaXMuYmluYXJ5SW5kaWNlcyA9IHRoaXMuY2FjaGVkQmluYXJ5SW5kZXg7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBwcm9wYWdhdGUgcm9sbGJhY2sgdG8gZHluYW1pYyB2aWV3c1xuICAgICAgICBmb3IgKHZhciBpZHggPSAwOyBpZHggPCB0aGlzLkR5bmFtaWNWaWV3cy5sZW5ndGg7IGlkeCsrKSB7XG4gICAgICAgICAgdGhpcy5EeW5hbWljVmlld3NbaWR4XS5yb2xsYmFjaygpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8vIGFzeW5jIGV4ZWN1dG9yLiBUaGlzIGlzIG9ubHkgdG8gZW5hYmxlIGNhbGxiYWNrcyBhdCB0aGUgZW5kIG9mIHRoZSBleGVjdXRpb24uXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUuYXN5bmMgPSBmdW5jdGlvbiAoZnVuLCBjYWxsYmFjaykge1xuICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0eXBlb2YgZnVuID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgZnVuKCk7XG4gICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBcmd1bWVudCBwYXNzZWQgZm9yIGFzeW5jIGV4ZWN1dGlvbiBpcyBub3QgYSBmdW5jdGlvbicpO1xuICAgICAgICB9XG4gICAgICB9LCAwKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUXVlcnkgdGhlIGNvbGxlY3Rpb24gYnkgc3VwcGx5aW5nIGEgamF2YXNjcmlwdCBmaWx0ZXIgZnVuY3Rpb24uXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiB2YXIgcmVzdWx0cyA9IGNvbGwud2hlcmUoZnVuY3Rpb24ob2JqKSB7XG4gICAgICogICByZXR1cm4gb2JqLmxlZ3MgPT09IDg7XG4gICAgICogfSk7XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBmdW4gLSBmaWx0ZXIgZnVuY3Rpb24gdG8gcnVuIGFnYWluc3QgYWxsIGNvbGxlY3Rpb24gZG9jc1xuICAgICAqIEByZXR1cm5zIHthcnJheX0gYWxsIGRvY3VtZW50cyB3aGljaCBwYXNzIHlvdXIgZmlsdGVyIGZ1bmN0aW9uXG4gICAgICogQG1lbWJlcm9mIENvbGxlY3Rpb25cbiAgICAgKi9cbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS53aGVyZSA9IGZ1bmN0aW9uIChmdW4pIHtcbiAgICAgIHJldHVybiB0aGlzLmNoYWluKCkud2hlcmUoZnVuKS5kYXRhKCk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIE1hcCBSZWR1Y2Ugb3BlcmF0aW9uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBtYXBGdW5jdGlvbiAtIGZ1bmN0aW9uIHRvIHVzZSBhcyBtYXAgZnVuY3Rpb25cbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSByZWR1Y2VGdW5jdGlvbiAtIGZ1bmN0aW9uIHRvIHVzZSBhcyByZWR1Y2UgZnVuY3Rpb25cbiAgICAgKiBAcmV0dXJucyB7ZGF0YX0gVGhlIHJlc3VsdCBvZiB5b3VyIG1hcFJlZHVjZSBvcGVyYXRpb25cbiAgICAgKiBAbWVtYmVyb2YgQ29sbGVjdGlvblxuICAgICAqL1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLm1hcFJlZHVjZSA9IGZ1bmN0aW9uIChtYXBGdW5jdGlvbiwgcmVkdWNlRnVuY3Rpb24pIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHJldHVybiByZWR1Y2VGdW5jdGlvbih0aGlzLmRhdGEubWFwKG1hcEZ1bmN0aW9uKSk7XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBKb2luIHR3byBjb2xsZWN0aW9ucyBvbiBzcGVjaWZpZWQgcHJvcGVydGllc1xuICAgICAqXG4gICAgICogQHBhcmFtIHthcnJheXxSZXN1bHRzZXR8Q29sbGVjdGlvbn0gam9pbkRhdGEgLSBhcnJheSBvZiBkb2N1bWVudHMgdG8gJ2pvaW4nIHRvIHRoaXMgY29sbGVjdGlvblxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBsZWZ0Sm9pblByb3AgLSBwcm9wZXJ0eSBuYW1lIGluIGNvbGxlY3Rpb25cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gcmlnaHRKb2luUHJvcCAtIHByb3BlcnR5IG5hbWUgaW4gam9pbkRhdGFcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9uPX0gbWFwRnVuIC0gKE9wdGlvbmFsKSBtYXAgZnVuY3Rpb24gdG8gdXNlXG4gICAgICogQHBhcmFtIHtvYmplY3Q9fSBkYXRhT3B0aW9ucyAtIG9wdGlvbnMgdG8gZGF0YSgpIGJlZm9yZSBpbnB1dCB0byB5b3VyIG1hcCBmdW5jdGlvblxuICAgICAqIEBwYXJhbSB7Ym9vbH0gZGF0YU9wdGlvbnMucmVtb3ZlTWV0YSAtIGFsbG93cyByZW1vdmluZyBtZXRhIGJlZm9yZSBjYWxsaW5nIG1hcEZ1blxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gZGF0YU9wdGlvbnMuZm9yY2VDbG9uZXMgLSBmb3JjaW5nIHRoZSByZXR1cm4gb2YgY2xvbmVkIG9iamVjdHMgdG8geW91ciBtYXAgb2JqZWN0XG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGRhdGFPcHRpb25zLmZvcmNlQ2xvbmVNZXRob2QgLSBBbGxvd3Mgb3ZlcnJpZGluZyB0aGUgZGVmYXVsdCBvciBjb2xsZWN0aW9uIHNwZWNpZmllZCBjbG9uaW5nIG1ldGhvZC5cbiAgICAgKiBAcmV0dXJucyB7UmVzdWx0c2V0fSBSZXN1bHQgb2YgdGhlIG1hcHBpbmcgb3BlcmF0aW9uXG4gICAgICogQG1lbWJlcm9mIENvbGxlY3Rpb25cbiAgICAgKi9cbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5lcUpvaW4gPSBmdW5jdGlvbiAoam9pbkRhdGEsIGxlZnRKb2luUHJvcCwgcmlnaHRKb2luUHJvcCwgbWFwRnVuLCBkYXRhT3B0aW9ucykge1xuICAgICAgLy8gbG9naWMgaW4gUmVzdWx0c2V0IGNsYXNzXG4gICAgICByZXR1cm4gbmV3IFJlc3VsdHNldCh0aGlzKS5lcUpvaW4oam9pbkRhdGEsIGxlZnRKb2luUHJvcCwgcmlnaHRKb2luUHJvcCwgbWFwRnVuLCBkYXRhT3B0aW9ucyk7XG4gICAgfTtcblxuICAgIC8qIC0tLS0tLSBTVEFHSU5HIEFQSSAtLS0tLS0tLSAqL1xuICAgIC8qKlxuICAgICAqIHN0YWdlczogYSBtYXAgb2YgdW5pcXVlbHkgaWRlbnRpZmllZCAnc3RhZ2VzJywgd2hpY2ggaG9sZCBjb3BpZXMgb2Ygb2JqZWN0cyB0byBiZVxuICAgICAqIG1hbmlwdWxhdGVkIHdpdGhvdXQgYWZmZWN0aW5nIHRoZSBkYXRhIGluIHRoZSBvcmlnaW5hbCBjb2xsZWN0aW9uXG4gICAgICovXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUuc3RhZ2VzID0ge307XG5cbiAgICAvKipcbiAgICAgKiAoU3RhZ2luZyBBUEkpIGNyZWF0ZSBhIHN0YWdlIGFuZC9vciByZXRyaWV2ZSBpdFxuICAgICAqIEBtZW1iZXJvZiBDb2xsZWN0aW9uXG4gICAgICovXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUuZ2V0U3RhZ2UgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgaWYgKCF0aGlzLnN0YWdlc1tuYW1lXSkge1xuICAgICAgICB0aGlzLnN0YWdlc1tuYW1lXSA9IHt9O1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMuc3RhZ2VzW25hbWVdO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogYSBjb2xsZWN0aW9uIG9mIG9iamVjdHMgcmVjb3JkaW5nIHRoZSBjaGFuZ2VzIGFwcGxpZWQgdGhyb3VnaCBhIGNvbW1taXRTdGFnZVxuICAgICAqL1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmNvbW1pdExvZyA9IFtdO1xuXG4gICAgLyoqXG4gICAgICogKFN0YWdpbmcgQVBJKSBjcmVhdGUgYSBjb3B5IG9mIGFuIG9iamVjdCBhbmQgaW5zZXJ0IGl0IGludG8gYSBzdGFnZVxuICAgICAqIEBtZW1iZXJvZiBDb2xsZWN0aW9uXG4gICAgICovXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUuc3RhZ2UgPSBmdW5jdGlvbiAoc3RhZ2VOYW1lLCBvYmopIHtcbiAgICAgIHZhciBjb3B5ID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShvYmopKTtcbiAgICAgIHRoaXMuZ2V0U3RhZ2Uoc3RhZ2VOYW1lKVtvYmouJGxva2ldID0gY29weTtcbiAgICAgIHJldHVybiBjb3B5O1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiAoU3RhZ2luZyBBUEkpIHJlLWF0dGFjaCBhbGwgb2JqZWN0cyB0byB0aGUgb3JpZ2luYWwgY29sbGVjdGlvbiwgc28gaW5kZXhlcyBhbmQgdmlld3MgY2FuIGJlIHJlYnVpbHRcbiAgICAgKiB0aGVuIGNyZWF0ZSBhIG1lc3NhZ2UgdG8gYmUgaW5zZXJ0ZWQgaW4gdGhlIGNvbW1pdGxvZ1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBzdGFnZU5hbWUgLSBuYW1lIG9mIHN0YWdlXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG1lc3NhZ2VcbiAgICAgKiBAbWVtYmVyb2YgQ29sbGVjdGlvblxuICAgICAqL1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmNvbW1pdFN0YWdlID0gZnVuY3Rpb24gKHN0YWdlTmFtZSwgbWVzc2FnZSkge1xuICAgICAgdmFyIHN0YWdlID0gdGhpcy5nZXRTdGFnZShzdGFnZU5hbWUpLFxuICAgICAgICBwcm9wLFxuICAgICAgICB0aW1lc3RhbXAgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcblxuICAgICAgZm9yIChwcm9wIGluIHN0YWdlKSB7XG5cbiAgICAgICAgdGhpcy51cGRhdGUoc3RhZ2VbcHJvcF0pO1xuICAgICAgICB0aGlzLmNvbW1pdExvZy5wdXNoKHtcbiAgICAgICAgICB0aW1lc3RhbXA6IHRpbWVzdGFtcCxcbiAgICAgICAgICBtZXNzYWdlOiBtZXNzYWdlLFxuICAgICAgICAgIGRhdGE6IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc3RhZ2VbcHJvcF0pKVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHRoaXMuc3RhZ2VzW3N0YWdlTmFtZV0gPSB7fTtcbiAgICB9O1xuXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUubm9fb3AgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm47XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEBtZW1iZXJvZiBDb2xsZWN0aW9uXG4gICAgICovXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUuZXh0cmFjdCA9IGZ1bmN0aW9uIChmaWVsZCkge1xuICAgICAgdmFyIGkgPSAwLFxuICAgICAgICBsZW4gPSB0aGlzLmRhdGEubGVuZ3RoLFxuICAgICAgICBpc0RvdE5vdGF0aW9uID0gaXNEZWVwUHJvcGVydHkoZmllbGQpLFxuICAgICAgICByZXN1bHQgPSBbXTtcbiAgICAgIGZvciAoaTsgaSA8IGxlbjsgaSArPSAxKSB7XG4gICAgICAgIHJlc3VsdC5wdXNoKGRlZXBQcm9wZXJ0eSh0aGlzLmRhdGFbaV0sIGZpZWxkLCBpc0RvdE5vdGF0aW9uKSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBAbWVtYmVyb2YgQ29sbGVjdGlvblxuICAgICAqL1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLm1heCA9IGZ1bmN0aW9uIChmaWVsZCkge1xuICAgICAgcmV0dXJuIE1hdGgubWF4LmFwcGx5KG51bGwsIHRoaXMuZXh0cmFjdChmaWVsZCkpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBAbWVtYmVyb2YgQ29sbGVjdGlvblxuICAgICAqL1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLm1pbiA9IGZ1bmN0aW9uIChmaWVsZCkge1xuICAgICAgcmV0dXJuIE1hdGgubWluLmFwcGx5KG51bGwsIHRoaXMuZXh0cmFjdChmaWVsZCkpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBAbWVtYmVyb2YgQ29sbGVjdGlvblxuICAgICAqL1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLm1heFJlY29yZCA9IGZ1bmN0aW9uIChmaWVsZCkge1xuICAgICAgdmFyIGkgPSAwLFxuICAgICAgICBsZW4gPSB0aGlzLmRhdGEubGVuZ3RoLFxuICAgICAgICBkZWVwID0gaXNEZWVwUHJvcGVydHkoZmllbGQpLFxuICAgICAgICByZXN1bHQgPSB7XG4gICAgICAgICAgaW5kZXg6IDAsXG4gICAgICAgICAgdmFsdWU6IHVuZGVmaW5lZFxuICAgICAgICB9LFxuICAgICAgICBtYXg7XG5cbiAgICAgIGZvciAoaTsgaSA8IGxlbjsgaSArPSAxKSB7XG4gICAgICAgIGlmIChtYXggIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIGlmIChtYXggPCBkZWVwUHJvcGVydHkodGhpcy5kYXRhW2ldLCBmaWVsZCwgZGVlcCkpIHtcbiAgICAgICAgICAgIG1heCA9IGRlZXBQcm9wZXJ0eSh0aGlzLmRhdGFbaV0sIGZpZWxkLCBkZWVwKTtcbiAgICAgICAgICAgIHJlc3VsdC5pbmRleCA9IHRoaXMuZGF0YVtpXS4kbG9raTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbWF4ID0gZGVlcFByb3BlcnR5KHRoaXMuZGF0YVtpXSwgZmllbGQsIGRlZXApO1xuICAgICAgICAgIHJlc3VsdC5pbmRleCA9IHRoaXMuZGF0YVtpXS4kbG9raTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmVzdWx0LnZhbHVlID0gbWF4O1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQG1lbWJlcm9mIENvbGxlY3Rpb25cbiAgICAgKi9cbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5taW5SZWNvcmQgPSBmdW5jdGlvbiAoZmllbGQpIHtcbiAgICAgIHZhciBpID0gMCxcbiAgICAgICAgbGVuID0gdGhpcy5kYXRhLmxlbmd0aCxcbiAgICAgICAgZGVlcCA9IGlzRGVlcFByb3BlcnR5KGZpZWxkKSxcbiAgICAgICAgcmVzdWx0ID0ge1xuICAgICAgICAgIGluZGV4OiAwLFxuICAgICAgICAgIHZhbHVlOiB1bmRlZmluZWRcbiAgICAgICAgfSxcbiAgICAgICAgbWluO1xuXG4gICAgICBmb3IgKGk7IGkgPCBsZW47IGkgKz0gMSkge1xuICAgICAgICBpZiAobWluICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBpZiAobWluID4gZGVlcFByb3BlcnR5KHRoaXMuZGF0YVtpXSwgZmllbGQsIGRlZXApKSB7XG4gICAgICAgICAgICBtaW4gPSBkZWVwUHJvcGVydHkodGhpcy5kYXRhW2ldLCBmaWVsZCwgZGVlcCk7XG4gICAgICAgICAgICByZXN1bHQuaW5kZXggPSB0aGlzLmRhdGFbaV0uJGxva2k7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG1pbiA9IGRlZXBQcm9wZXJ0eSh0aGlzLmRhdGFbaV0sIGZpZWxkLCBkZWVwKTtcbiAgICAgICAgICByZXN1bHQuaW5kZXggPSB0aGlzLmRhdGFbaV0uJGxva2k7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJlc3VsdC52YWx1ZSA9IG1pbjtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEBtZW1iZXJvZiBDb2xsZWN0aW9uXG4gICAgICovXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUuZXh0cmFjdE51bWVyaWNhbCA9IGZ1bmN0aW9uIChmaWVsZCkge1xuICAgICAgcmV0dXJuIHRoaXMuZXh0cmFjdChmaWVsZCkubWFwKHBhcnNlQmFzZTEwKS5maWx0ZXIoTnVtYmVyKS5maWx0ZXIoZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgcmV0dXJuICEoaXNOYU4obikpO1xuICAgICAgfSk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIENhbGN1bGF0ZXMgdGhlIGF2ZXJhZ2UgbnVtZXJpY2FsIHZhbHVlIG9mIGEgcHJvcGVydHlcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBmaWVsZCAtIG5hbWUgb2YgcHJvcGVydHkgaW4gZG9jcyB0byBhdmVyYWdlXG4gICAgICogQHJldHVybnMge251bWJlcn0gYXZlcmFnZSBvZiBwcm9wZXJ0eSBpbiBhbGwgZG9jcyBpbiB0aGUgY29sbGVjdGlvblxuICAgICAqIEBtZW1iZXJvZiBDb2xsZWN0aW9uXG4gICAgICovXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUuYXZnID0gZnVuY3Rpb24gKGZpZWxkKSB7XG4gICAgICByZXR1cm4gYXZlcmFnZSh0aGlzLmV4dHJhY3ROdW1lcmljYWwoZmllbGQpKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQ2FsY3VsYXRlIHN0YW5kYXJkIGRldmlhdGlvbiBvZiBhIGZpZWxkXG4gICAgICogQG1lbWJlcm9mIENvbGxlY3Rpb25cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZmllbGRcbiAgICAgKi9cbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5zdGREZXYgPSBmdW5jdGlvbiAoZmllbGQpIHtcbiAgICAgIHJldHVybiBzdGFuZGFyZERldmlhdGlvbih0aGlzLmV4dHJhY3ROdW1lcmljYWwoZmllbGQpKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQG1lbWJlcm9mIENvbGxlY3Rpb25cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZmllbGRcbiAgICAgKi9cbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5tb2RlID0gZnVuY3Rpb24gKGZpZWxkKSB7XG4gICAgICB2YXIgZGljdCA9IHt9LFxuICAgICAgICBkYXRhID0gdGhpcy5leHRyYWN0KGZpZWxkKTtcbiAgICAgIGRhdGEuZm9yRWFjaChmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgIGlmIChkaWN0W29ial0pIHtcbiAgICAgICAgICBkaWN0W29ial0gKz0gMTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBkaWN0W29ial0gPSAxO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHZhciBtYXgsXG4gICAgICAgIHByb3AsIG1vZGU7XG4gICAgICBmb3IgKHByb3AgaW4gZGljdCkge1xuICAgICAgICBpZiAobWF4KSB7XG4gICAgICAgICAgaWYgKG1heCA8IGRpY3RbcHJvcF0pIHtcbiAgICAgICAgICAgIG1vZGUgPSBwcm9wO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBtb2RlID0gcHJvcDtcbiAgICAgICAgICBtYXggPSBkaWN0W3Byb3BdO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gbW9kZTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQG1lbWJlcm9mIENvbGxlY3Rpb25cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZmllbGQgLSBwcm9wZXJ0eSBuYW1lXG4gICAgICovXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUubWVkaWFuID0gZnVuY3Rpb24gKGZpZWxkKSB7XG4gICAgICB2YXIgdmFsdWVzID0gdGhpcy5leHRyYWN0TnVtZXJpY2FsKGZpZWxkKTtcbiAgICAgIHZhbHVlcy5zb3J0KHN1Yik7XG5cbiAgICAgIHZhciBoYWxmID0gTWF0aC5mbG9vcih2YWx1ZXMubGVuZ3RoIC8gMik7XG5cbiAgICAgIGlmICh2YWx1ZXMubGVuZ3RoICUgMikge1xuICAgICAgICByZXR1cm4gdmFsdWVzW2hhbGZdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuICh2YWx1ZXNbaGFsZiAtIDFdICsgdmFsdWVzW2hhbGZdKSAvIDIuMDtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogR2VuZXJhbCB1dGlscywgaW5jbHVkaW5nIHN0YXRpc3RpY2FsIGZ1bmN0aW9uc1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIGlzRGVlcFByb3BlcnR5KGZpZWxkKSB7XG4gICAgICByZXR1cm4gZmllbGQuaW5kZXhPZignLicpICE9PSAtMTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwYXJzZUJhc2UxMChudW0pIHtcbiAgICAgIHJldHVybiBwYXJzZUZsb2F0KG51bSwgMTApO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGlzTm90VW5kZWZpbmVkKG9iaikge1xuICAgICAgcmV0dXJuIG9iaiAhPT0gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFkZChhLCBiKSB7XG4gICAgICByZXR1cm4gYSArIGI7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc3ViKGEsIGIpIHtcbiAgICAgIHJldHVybiBhIC0gYjtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBtZWRpYW4odmFsdWVzKSB7XG4gICAgICB2YWx1ZXMuc29ydChzdWIpO1xuICAgICAgdmFyIGhhbGYgPSBNYXRoLmZsb29yKHZhbHVlcy5sZW5ndGggLyAyKTtcbiAgICAgIHJldHVybiAodmFsdWVzLmxlbmd0aCAlIDIpID8gdmFsdWVzW2hhbGZdIDogKCh2YWx1ZXNbaGFsZiAtIDFdICsgdmFsdWVzW2hhbGZdKSAvIDIuMCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYXZlcmFnZShhcnJheSkge1xuICAgICAgcmV0dXJuIChhcnJheS5yZWR1Y2UoYWRkLCAwKSkgLyBhcnJheS5sZW5ndGg7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc3RhbmRhcmREZXZpYXRpb24odmFsdWVzKSB7XG4gICAgICB2YXIgYXZnID0gYXZlcmFnZSh2YWx1ZXMpO1xuICAgICAgdmFyIHNxdWFyZURpZmZzID0gdmFsdWVzLm1hcChmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGRpZmYgPSB2YWx1ZSAtIGF2ZztcbiAgICAgICAgdmFyIHNxckRpZmYgPSBkaWZmICogZGlmZjtcbiAgICAgICAgcmV0dXJuIHNxckRpZmY7XG4gICAgICB9KTtcblxuICAgICAgdmFyIGF2Z1NxdWFyZURpZmYgPSBhdmVyYWdlKHNxdWFyZURpZmZzKTtcblxuICAgICAgdmFyIHN0ZERldiA9IE1hdGguc3FydChhdmdTcXVhcmVEaWZmKTtcbiAgICAgIHJldHVybiBzdGREZXY7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZGVlcFByb3BlcnR5KG9iaiwgcHJvcGVydHksIGlzRGVlcCkge1xuICAgICAgaWYgKGlzRGVlcCA9PT0gZmFsc2UpIHtcbiAgICAgICAgLy8gcGFzcyB3aXRob3V0IHByb2Nlc3NpbmdcbiAgICAgICAgcmV0dXJuIG9ialtwcm9wZXJ0eV07XG4gICAgICB9XG4gICAgICB2YXIgcGllY2VzID0gcHJvcGVydHkuc3BsaXQoJy4nKSxcbiAgICAgICAgcm9vdCA9IG9iajtcbiAgICAgIHdoaWxlIChwaWVjZXMubGVuZ3RoID4gMCkge1xuICAgICAgICByb290ID0gcm9vdFtwaWVjZXMuc2hpZnQoKV07XG4gICAgICB9XG4gICAgICByZXR1cm4gcm9vdDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBiaW5hcnlTZWFyY2goYXJyYXksIGl0ZW0sIGZ1bikge1xuICAgICAgdmFyIGxvID0gMCxcbiAgICAgICAgaGkgPSBhcnJheS5sZW5ndGgsXG4gICAgICAgIGNvbXBhcmVkLFxuICAgICAgICBtaWQ7XG4gICAgICB3aGlsZSAobG8gPCBoaSkge1xuICAgICAgICBtaWQgPSAobG8gKyBoaSkgPj4gMTtcbiAgICAgICAgY29tcGFyZWQgPSBmdW4uYXBwbHkobnVsbCwgW2l0ZW0sIGFycmF5W21pZF1dKTtcbiAgICAgICAgaWYgKGNvbXBhcmVkID09PSAwKSB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGZvdW5kOiB0cnVlLFxuICAgICAgICAgICAgaW5kZXg6IG1pZFxuICAgICAgICAgIH07XG4gICAgICAgIH0gZWxzZSBpZiAoY29tcGFyZWQgPCAwKSB7XG4gICAgICAgICAgaGkgPSBtaWQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbG8gPSBtaWQgKyAxO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4ge1xuICAgICAgICBmb3VuZDogZmFsc2UsXG4gICAgICAgIGluZGV4OiBoaVxuICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBCU29uU29ydChmdW4pIHtcbiAgICAgIHJldHVybiBmdW5jdGlvbiAoYXJyYXksIGl0ZW0pIHtcbiAgICAgICAgcmV0dXJuIGJpbmFyeVNlYXJjaChhcnJheSwgaXRlbSwgZnVuKTtcbiAgICAgIH07XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gS2V5VmFsdWVTdG9yZSgpIHt9XG5cbiAgICBLZXlWYWx1ZVN0b3JlLnByb3RvdHlwZSA9IHtcbiAgICAgIGtleXM6IFtdLFxuICAgICAgdmFsdWVzOiBbXSxcbiAgICAgIHNvcnQ6IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgIHJldHVybiAoYSA8IGIpID8gLTEgOiAoKGEgPiBiKSA/IDEgOiAwKTtcbiAgICAgIH0sXG4gICAgICBzZXRTb3J0OiBmdW5jdGlvbiAoZnVuKSB7XG4gICAgICAgIHRoaXMuYnMgPSBuZXcgQlNvblNvcnQoZnVuKTtcbiAgICAgIH0sXG4gICAgICBiczogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbmV3IEJTb25Tb3J0KHRoaXMuc29ydCk7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xuICAgICAgICB2YXIgcG9zID0gdGhpcy5icyh0aGlzLmtleXMsIGtleSk7XG4gICAgICAgIGlmIChwb3MuZm91bmQpIHtcbiAgICAgICAgICB0aGlzLnZhbHVlc1twb3MuaW5kZXhdID0gdmFsdWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5rZXlzLnNwbGljZShwb3MuaW5kZXgsIDAsIGtleSk7XG4gICAgICAgICAgdGhpcy52YWx1ZXMuc3BsaWNlKHBvcy5pbmRleCwgMCwgdmFsdWUpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZ2V0OiBmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnZhbHVlc1tiaW5hcnlTZWFyY2godGhpcy5rZXlzLCBrZXksIHRoaXMuc29ydCkuaW5kZXhdO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBmdW5jdGlvbiBVbmlxdWVJbmRleCh1bmlxdWVGaWVsZCkge1xuICAgICAgdGhpcy5maWVsZCA9IHVuaXF1ZUZpZWxkO1xuICAgICAgdGhpcy5rZXlNYXAgPSB7fTtcbiAgICAgIHRoaXMubG9raU1hcCA9IHt9O1xuICAgIH1cbiAgICBVbmlxdWVJbmRleC5wcm90b3R5cGUua2V5TWFwID0ge307XG4gICAgVW5pcXVlSW5kZXgucHJvdG90eXBlLmxva2lNYXAgPSB7fTtcbiAgICBVbmlxdWVJbmRleC5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gKG9iaikge1xuICAgICAgdmFyIGZpZWxkVmFsdWUgPSBvYmpbdGhpcy5maWVsZF07XG4gICAgICBpZiAoZmllbGRWYWx1ZSAhPT0gbnVsbCAmJiB0eXBlb2YgKGZpZWxkVmFsdWUpICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICBpZiAodGhpcy5rZXlNYXBbZmllbGRWYWx1ZV0pIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0R1cGxpY2F0ZSBrZXkgZm9yIHByb3BlcnR5ICcgKyB0aGlzLmZpZWxkICsgJzogJyArIGZpZWxkVmFsdWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMua2V5TWFwW2ZpZWxkVmFsdWVdID0gb2JqO1xuICAgICAgICAgIHRoaXMubG9raU1hcFtvYmouJGxva2ldID0gZmllbGRWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG4gICAgVW5pcXVlSW5kZXgucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgIHJldHVybiB0aGlzLmtleU1hcFtrZXldO1xuICAgIH07XG5cbiAgICBVbmlxdWVJbmRleC5wcm90b3R5cGUuYnlJZCA9IGZ1bmN0aW9uIChpZCkge1xuICAgICAgcmV0dXJuIHRoaXMua2V5TWFwW3RoaXMubG9raU1hcFtpZF1dO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogVXBkYXRlcyBhIGRvY3VtZW50J3MgdW5pcXVlIGluZGV4IGdpdmVuIGFuIHVwZGF0ZWQgb2JqZWN0LlxuICAgICAqIEBwYXJhbSAge09iamVjdH0gb2JqIE9yaWdpbmFsIGRvY3VtZW50IG9iamVjdFxuICAgICAqIEBwYXJhbSAge09iamVjdH0gZG9jIE5ldyBkb2N1bWVudCBvYmplY3QgKGxpa2VseSB0aGUgc2FtZSBhcyBvYmopXG4gICAgICovXG4gICAgVW5pcXVlSW5kZXgucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uIChvYmosIGRvYykge1xuICAgICAgaWYgKHRoaXMubG9raU1hcFtvYmouJGxva2ldICE9PSBkb2NbdGhpcy5maWVsZF0pIHtcbiAgICAgICAgdmFyIG9sZCA9IHRoaXMubG9raU1hcFtvYmouJGxva2ldO1xuICAgICAgICB0aGlzLnNldChkb2MpO1xuICAgICAgICAvLyBtYWtlIHRoZSBvbGQga2V5IGZhaWwgYm9vbCB0ZXN0LCB3aGlsZSBhdm9pZGluZyB0aGUgdXNlIG9mIGRlbGV0ZSAobWVtLWxlYWsgcHJvbmUpXG4gICAgICAgIHRoaXMua2V5TWFwW29sZF0gPSB1bmRlZmluZWQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmtleU1hcFtvYmpbdGhpcy5maWVsZF1dID0gZG9jO1xuICAgICAgfVxuICAgIH07XG4gICAgVW5pcXVlSW5kZXgucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgIHZhciBvYmogPSB0aGlzLmtleU1hcFtrZXldO1xuICAgICAgaWYgKG9iaiAhPT0gbnVsbCAmJiB0eXBlb2Ygb2JqICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICB0aGlzLmtleU1hcFtrZXldID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmxva2lNYXBbb2JqLiRsb2tpXSA9IHVuZGVmaW5lZDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignS2V5IGlzIG5vdCBpbiB1bmlxdWUgaW5kZXg6ICcgKyB0aGlzLmZpZWxkKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIFVuaXF1ZUluZGV4LnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMua2V5TWFwID0ge307XG4gICAgICB0aGlzLmxva2lNYXAgPSB7fTtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gRXhhY3RJbmRleChleGFjdEZpZWxkKSB7XG4gICAgICB0aGlzLmluZGV4ID0ge307XG4gICAgICB0aGlzLmZpZWxkID0gZXhhY3RGaWVsZDtcbiAgICB9XG5cbiAgICAvLyBhZGQgdGhlIHZhbHVlIHlvdSB3YW50IHJldHVybmVkIHRvIHRoZSBrZXkgaW4gdGhlIGluZGV4XG4gICAgRXhhY3RJbmRleC5wcm90b3R5cGUgPSB7XG4gICAgICBzZXQ6IGZ1bmN0aW9uIGFkZChrZXksIHZhbCkge1xuICAgICAgICBpZiAodGhpcy5pbmRleFtrZXldKSB7XG4gICAgICAgICAgdGhpcy5pbmRleFtrZXldLnB1c2godmFsKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLmluZGV4W2tleV0gPSBbdmFsXTtcbiAgICAgICAgfVxuICAgICAgfSxcblxuICAgICAgLy8gcmVtb3ZlIHRoZSB2YWx1ZSBmcm9tIHRoZSBpbmRleCwgaWYgdGhlIHZhbHVlIHdhcyB0aGUgbGFzdCBvbmUsIHJlbW92ZSB0aGUga2V5XG4gICAgICByZW1vdmU6IGZ1bmN0aW9uIHJlbW92ZShrZXksIHZhbCkge1xuICAgICAgICB2YXIgaWR4U2V0ID0gdGhpcy5pbmRleFtrZXldO1xuICAgICAgICBmb3IgKHZhciBpIGluIGlkeFNldCkge1xuICAgICAgICAgIGlmIChpZHhTZXRbaV0gPT0gdmFsKSB7XG4gICAgICAgICAgICBpZHhTZXQuc3BsaWNlKGksIDEpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoaWR4U2V0Lmxlbmd0aCA8IDEpIHtcbiAgICAgICAgICB0aGlzLmluZGV4W2tleV0gPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgIH0sXG5cbiAgICAgIC8vIGdldCB0aGUgdmFsdWVzIHJlbGF0ZWQgdG8gdGhlIGtleSwgY291bGQgYmUgbW9yZSB0aGFuIG9uZVxuICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoa2V5KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmluZGV4W2tleV07XG4gICAgICB9LFxuXG4gICAgICAvLyBjbGVhciB3aWxsIHphcCB0aGUgaW5kZXhcbiAgICAgIGNsZWFyOiBmdW5jdGlvbiBjbGVhcihrZXkpIHtcbiAgICAgICAgdGhpcy5pbmRleCA9IHt9O1xuICAgICAgfVxuICAgIH07XG5cbiAgICBmdW5jdGlvbiBTb3J0ZWRJbmRleChzb3J0ZWRGaWVsZCkge1xuICAgICAgdGhpcy5maWVsZCA9IHNvcnRlZEZpZWxkO1xuICAgIH1cblxuICAgIFNvcnRlZEluZGV4LnByb3RvdHlwZSA9IHtcbiAgICAgIGtleXM6IFtdLFxuICAgICAgdmFsdWVzOiBbXSxcbiAgICAgIC8vIHNldCB0aGUgZGVmYXVsdCBzb3J0XG4gICAgICBzb3J0OiBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICByZXR1cm4gKGEgPCBiKSA/IC0xIDogKChhID4gYikgPyAxIDogMCk7XG4gICAgICB9LFxuICAgICAgYnM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBCU29uU29ydCh0aGlzLnNvcnQpO1xuICAgICAgfSxcbiAgICAgIC8vIGFuZCBhbGxvdyBvdmVycmlkZSBvZiB0aGUgZGVmYXVsdCBzb3J0XG4gICAgICBzZXRTb3J0OiBmdW5jdGlvbiAoZnVuKSB7XG4gICAgICAgIHRoaXMuYnMgPSBuZXcgQlNvblNvcnQoZnVuKTtcbiAgICAgIH0sXG4gICAgICAvLyBhZGQgdGhlIHZhbHVlIHlvdSB3YW50IHJldHVybmVkICB0byB0aGUga2V5IGluIHRoZSBpbmRleFxuICAgICAgc2V0OiBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xuICAgICAgICB2YXIgcG9zID0gYmluYXJ5U2VhcmNoKHRoaXMua2V5cywga2V5LCB0aGlzLnNvcnQpO1xuICAgICAgICBpZiAocG9zLmZvdW5kKSB7XG4gICAgICAgICAgdGhpcy52YWx1ZXNbcG9zLmluZGV4XS5wdXNoKHZhbHVlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLmtleXMuc3BsaWNlKHBvcy5pbmRleCwgMCwga2V5KTtcbiAgICAgICAgICB0aGlzLnZhbHVlcy5zcGxpY2UocG9zLmluZGV4LCAwLCBbdmFsdWVdKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIC8vIGdldCBhbGwgdmFsdWVzIHdoaWNoIGhhdmUgYSBrZXkgPT0gdGhlIGdpdmVuIGtleVxuICAgICAgZ2V0OiBmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgIHZhciBic3IgPSBiaW5hcnlTZWFyY2godGhpcy5rZXlzLCBrZXksIHRoaXMuc29ydCk7XG4gICAgICAgIGlmIChic3IuZm91bmQpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy52YWx1ZXNbYnNyLmluZGV4XTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICAvLyBnZXQgYWxsIHZhbHVlcyB3aGljaCBoYXZlIGEga2V5IDwgdGhlIGdpdmVuIGtleVxuICAgICAgZ2V0THQ6IGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgdmFyIGJzciA9IGJpbmFyeVNlYXJjaCh0aGlzLmtleXMsIGtleSwgdGhpcy5zb3J0KTtcbiAgICAgICAgdmFyIHBvcyA9IGJzci5pbmRleDtcbiAgICAgICAgaWYgKGJzci5mb3VuZCkgcG9zLS07XG4gICAgICAgIHJldHVybiB0aGlzLmdldEFsbChrZXksIDAsIHBvcyk7XG4gICAgICB9LFxuICAgICAgLy8gZ2V0IGFsbCB2YWx1ZXMgd2hpY2ggaGF2ZSBhIGtleSA+IHRoZSBnaXZlbiBrZXlcbiAgICAgIGdldEd0OiBmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgIHZhciBic3IgPSBiaW5hcnlTZWFyY2godGhpcy5rZXlzLCBrZXksIHRoaXMuc29ydCk7XG4gICAgICAgIHZhciBwb3MgPSBic3IuaW5kZXg7XG4gICAgICAgIGlmIChic3IuZm91bmQpIHBvcysrO1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRBbGwoa2V5LCBwb3MsIHRoaXMua2V5cy5sZW5ndGgpO1xuICAgICAgfSxcblxuICAgICAgLy8gZ2V0IGFsbCB2YWxzIGZyb20gc3RhcnQgdG8gZW5kXG4gICAgICBnZXRBbGw6IGZ1bmN0aW9uIChrZXksIHN0YXJ0LCBlbmQpIHtcbiAgICAgICAgdmFyIHJlc3VsdHMgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IHN0YXJ0OyBpIDwgZW5kOyBpKyspIHtcbiAgICAgICAgICByZXN1bHRzID0gcmVzdWx0cy5jb25jYXQodGhpcy52YWx1ZXNbaV0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHRzO1xuICAgICAgfSxcbiAgICAgIC8vIGp1c3QgaW4gY2FzZSBzb21lb25lIHdhbnRzIHRvIGRvIHNvbWV0aGluZyBzbWFydCB3aXRoIHJhbmdlc1xuICAgICAgZ2V0UG9zOiBmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgIHJldHVybiBiaW5hcnlTZWFyY2godGhpcy5rZXlzLCBrZXksIHRoaXMuc29ydCk7XG4gICAgICB9LFxuICAgICAgLy8gcmVtb3ZlIHRoZSB2YWx1ZSBmcm9tIHRoZSBpbmRleCwgaWYgdGhlIHZhbHVlIHdhcyB0aGUgbGFzdCBvbmUsIHJlbW92ZSB0aGUga2V5XG4gICAgICByZW1vdmU6IGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XG4gICAgICAgIHZhciBwb3MgPSBiaW5hcnlTZWFyY2godGhpcy5rZXlzLCBrZXksIHRoaXMuc29ydCkuaW5kZXg7XG4gICAgICAgIHZhciBpZHhTZXQgPSB0aGlzLnZhbHVlc1twb3NdO1xuICAgICAgICBmb3IgKHZhciBpIGluIGlkeFNldCkge1xuICAgICAgICAgIGlmIChpZHhTZXRbaV0gPT0gdmFsdWUpIGlkeFNldC5zcGxpY2UoaSwgMSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlkeFNldC5sZW5ndGggPCAxKSB7XG4gICAgICAgICAgdGhpcy5rZXlzLnNwbGljZShwb3MsIDEpO1xuICAgICAgICAgIHRoaXMudmFsdWVzLnNwbGljZShwb3MsIDEpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgLy8gY2xlYXIgd2lsbCB6YXAgdGhlIGluZGV4XG4gICAgICBjbGVhcjogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmtleXMgPSBbXTtcbiAgICAgICAgdGhpcy52YWx1ZXMgPSBbXTtcbiAgICAgIH1cbiAgICB9O1xuXG5cbiAgICBMb2tpLkxva2lPcHMgPSBMb2tpT3BzO1xuICAgIExva2kuQ29sbGVjdGlvbiA9IENvbGxlY3Rpb247XG4gICAgTG9raS5LZXlWYWx1ZVN0b3JlID0gS2V5VmFsdWVTdG9yZTtcbiAgICBMb2tpLkxva2lNZW1vcnlBZGFwdGVyID0gTG9raU1lbW9yeUFkYXB0ZXI7XG4gICAgTG9raS5Mb2tpUGFydGl0aW9uaW5nQWRhcHRlciA9IExva2lQYXJ0aXRpb25pbmdBZGFwdGVyO1xuICAgIExva2kuTG9raUxvY2FsU3RvcmFnZUFkYXB0ZXIgPSBMb2tpTG9jYWxTdG9yYWdlQWRhcHRlcjtcbiAgICBMb2tpLkxva2lGc0FkYXB0ZXIgPSBMb2tpRnNBZGFwdGVyO1xuICAgIExva2kucGVyc2lzdGVuY2VBZGFwdGVycyA9IHtcbiAgICAgIGZzOiBMb2tpRnNBZGFwdGVyLFxuICAgICAgbG9jYWxTdG9yYWdlOiBMb2tpTG9jYWxTdG9yYWdlQWRhcHRlclxuICAgIH07XG4gICAgTG9raS5hZXEgPSBhZXFIZWxwZXI7XG4gICAgTG9raS5sdCA9IGx0SGVscGVyO1xuICAgIExva2kuZ3QgPSBndEhlbHBlcjtcbiAgICBMb2tpLkNvbXBhcmF0b3JzID0gQ29tcGFyYXRvcnM7XG4gICAgcmV0dXJuIExva2k7XG4gIH0oKSk7XG5cbn0pKTtcbiIsIi8qISBodHRwczovL210aHMuYmUvcHVueWNvZGUgdjEuNC4xIGJ5IEBtYXRoaWFzICovXG47KGZ1bmN0aW9uKHJvb3QpIHtcblxuXHQvKiogRGV0ZWN0IGZyZWUgdmFyaWFibGVzICovXG5cdHZhciBmcmVlRXhwb3J0cyA9IHR5cGVvZiBleHBvcnRzID09ICdvYmplY3QnICYmIGV4cG9ydHMgJiZcblx0XHQhZXhwb3J0cy5ub2RlVHlwZSAmJiBleHBvcnRzO1xuXHR2YXIgZnJlZU1vZHVsZSA9IHR5cGVvZiBtb2R1bGUgPT0gJ29iamVjdCcgJiYgbW9kdWxlICYmXG5cdFx0IW1vZHVsZS5ub2RlVHlwZSAmJiBtb2R1bGU7XG5cdHZhciBmcmVlR2xvYmFsID0gdHlwZW9mIGdsb2JhbCA9PSAnb2JqZWN0JyAmJiBnbG9iYWw7XG5cdGlmIChcblx0XHRmcmVlR2xvYmFsLmdsb2JhbCA9PT0gZnJlZUdsb2JhbCB8fFxuXHRcdGZyZWVHbG9iYWwud2luZG93ID09PSBmcmVlR2xvYmFsIHx8XG5cdFx0ZnJlZUdsb2JhbC5zZWxmID09PSBmcmVlR2xvYmFsXG5cdCkge1xuXHRcdHJvb3QgPSBmcmVlR2xvYmFsO1xuXHR9XG5cblx0LyoqXG5cdCAqIFRoZSBgcHVueWNvZGVgIG9iamVjdC5cblx0ICogQG5hbWUgcHVueWNvZGVcblx0ICogQHR5cGUgT2JqZWN0XG5cdCAqL1xuXHR2YXIgcHVueWNvZGUsXG5cblx0LyoqIEhpZ2hlc3QgcG9zaXRpdmUgc2lnbmVkIDMyLWJpdCBmbG9hdCB2YWx1ZSAqL1xuXHRtYXhJbnQgPSAyMTQ3NDgzNjQ3LCAvLyBha2EuIDB4N0ZGRkZGRkYgb3IgMl4zMS0xXG5cblx0LyoqIEJvb3RzdHJpbmcgcGFyYW1ldGVycyAqL1xuXHRiYXNlID0gMzYsXG5cdHRNaW4gPSAxLFxuXHR0TWF4ID0gMjYsXG5cdHNrZXcgPSAzOCxcblx0ZGFtcCA9IDcwMCxcblx0aW5pdGlhbEJpYXMgPSA3Mixcblx0aW5pdGlhbE4gPSAxMjgsIC8vIDB4ODBcblx0ZGVsaW1pdGVyID0gJy0nLCAvLyAnXFx4MkQnXG5cblx0LyoqIFJlZ3VsYXIgZXhwcmVzc2lvbnMgKi9cblx0cmVnZXhQdW55Y29kZSA9IC9eeG4tLS8sXG5cdHJlZ2V4Tm9uQVNDSUkgPSAvW15cXHgyMC1cXHg3RV0vLCAvLyB1bnByaW50YWJsZSBBU0NJSSBjaGFycyArIG5vbi1BU0NJSSBjaGFyc1xuXHRyZWdleFNlcGFyYXRvcnMgPSAvW1xceDJFXFx1MzAwMlxcdUZGMEVcXHVGRjYxXS9nLCAvLyBSRkMgMzQ5MCBzZXBhcmF0b3JzXG5cblx0LyoqIEVycm9yIG1lc3NhZ2VzICovXG5cdGVycm9ycyA9IHtcblx0XHQnb3ZlcmZsb3cnOiAnT3ZlcmZsb3c6IGlucHV0IG5lZWRzIHdpZGVyIGludGVnZXJzIHRvIHByb2Nlc3MnLFxuXHRcdCdub3QtYmFzaWMnOiAnSWxsZWdhbCBpbnB1dCA+PSAweDgwIChub3QgYSBiYXNpYyBjb2RlIHBvaW50KScsXG5cdFx0J2ludmFsaWQtaW5wdXQnOiAnSW52YWxpZCBpbnB1dCdcblx0fSxcblxuXHQvKiogQ29udmVuaWVuY2Ugc2hvcnRjdXRzICovXG5cdGJhc2VNaW51c1RNaW4gPSBiYXNlIC0gdE1pbixcblx0Zmxvb3IgPSBNYXRoLmZsb29yLFxuXHRzdHJpbmdGcm9tQ2hhckNvZGUgPSBTdHJpbmcuZnJvbUNoYXJDb2RlLFxuXG5cdC8qKiBUZW1wb3JhcnkgdmFyaWFibGUgKi9cblx0a2V5O1xuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdC8qKlxuXHQgKiBBIGdlbmVyaWMgZXJyb3IgdXRpbGl0eSBmdW5jdGlvbi5cblx0ICogQHByaXZhdGVcblx0ICogQHBhcmFtIHtTdHJpbmd9IHR5cGUgVGhlIGVycm9yIHR5cGUuXG5cdCAqIEByZXR1cm5zIHtFcnJvcn0gVGhyb3dzIGEgYFJhbmdlRXJyb3JgIHdpdGggdGhlIGFwcGxpY2FibGUgZXJyb3IgbWVzc2FnZS5cblx0ICovXG5cdGZ1bmN0aW9uIGVycm9yKHR5cGUpIHtcblx0XHR0aHJvdyBuZXcgUmFuZ2VFcnJvcihlcnJvcnNbdHlwZV0pO1xuXHR9XG5cblx0LyoqXG5cdCAqIEEgZ2VuZXJpYyBgQXJyYXkjbWFwYCB1dGlsaXR5IGZ1bmN0aW9uLlxuXHQgKiBAcHJpdmF0ZVxuXHQgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gaXRlcmF0ZSBvdmVyLlxuXHQgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayBUaGUgZnVuY3Rpb24gdGhhdCBnZXRzIGNhbGxlZCBmb3IgZXZlcnkgYXJyYXlcblx0ICogaXRlbS5cblx0ICogQHJldHVybnMge0FycmF5fSBBIG5ldyBhcnJheSBvZiB2YWx1ZXMgcmV0dXJuZWQgYnkgdGhlIGNhbGxiYWNrIGZ1bmN0aW9uLlxuXHQgKi9cblx0ZnVuY3Rpb24gbWFwKGFycmF5LCBmbikge1xuXHRcdHZhciBsZW5ndGggPSBhcnJheS5sZW5ndGg7XG5cdFx0dmFyIHJlc3VsdCA9IFtdO1xuXHRcdHdoaWxlIChsZW5ndGgtLSkge1xuXHRcdFx0cmVzdWx0W2xlbmd0aF0gPSBmbihhcnJheVtsZW5ndGhdKTtcblx0XHR9XG5cdFx0cmV0dXJuIHJlc3VsdDtcblx0fVxuXG5cdC8qKlxuXHQgKiBBIHNpbXBsZSBgQXJyYXkjbWFwYC1saWtlIHdyYXBwZXIgdG8gd29yayB3aXRoIGRvbWFpbiBuYW1lIHN0cmluZ3Mgb3IgZW1haWxcblx0ICogYWRkcmVzc2VzLlxuXHQgKiBAcHJpdmF0ZVxuXHQgKiBAcGFyYW0ge1N0cmluZ30gZG9tYWluIFRoZSBkb21haW4gbmFtZSBvciBlbWFpbCBhZGRyZXNzLlxuXHQgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayBUaGUgZnVuY3Rpb24gdGhhdCBnZXRzIGNhbGxlZCBmb3IgZXZlcnlcblx0ICogY2hhcmFjdGVyLlxuXHQgKiBAcmV0dXJucyB7QXJyYXl9IEEgbmV3IHN0cmluZyBvZiBjaGFyYWN0ZXJzIHJldHVybmVkIGJ5IHRoZSBjYWxsYmFja1xuXHQgKiBmdW5jdGlvbi5cblx0ICovXG5cdGZ1bmN0aW9uIG1hcERvbWFpbihzdHJpbmcsIGZuKSB7XG5cdFx0dmFyIHBhcnRzID0gc3RyaW5nLnNwbGl0KCdAJyk7XG5cdFx0dmFyIHJlc3VsdCA9ICcnO1xuXHRcdGlmIChwYXJ0cy5sZW5ndGggPiAxKSB7XG5cdFx0XHQvLyBJbiBlbWFpbCBhZGRyZXNzZXMsIG9ubHkgdGhlIGRvbWFpbiBuYW1lIHNob3VsZCBiZSBwdW55Y29kZWQuIExlYXZlXG5cdFx0XHQvLyB0aGUgbG9jYWwgcGFydCAoaS5lLiBldmVyeXRoaW5nIHVwIHRvIGBAYCkgaW50YWN0LlxuXHRcdFx0cmVzdWx0ID0gcGFydHNbMF0gKyAnQCc7XG5cdFx0XHRzdHJpbmcgPSBwYXJ0c1sxXTtcblx0XHR9XG5cdFx0Ly8gQXZvaWQgYHNwbGl0KHJlZ2V4KWAgZm9yIElFOCBjb21wYXRpYmlsaXR5LiBTZWUgIzE3LlxuXHRcdHN0cmluZyA9IHN0cmluZy5yZXBsYWNlKHJlZ2V4U2VwYXJhdG9ycywgJ1xceDJFJyk7XG5cdFx0dmFyIGxhYmVscyA9IHN0cmluZy5zcGxpdCgnLicpO1xuXHRcdHZhciBlbmNvZGVkID0gbWFwKGxhYmVscywgZm4pLmpvaW4oJy4nKTtcblx0XHRyZXR1cm4gcmVzdWx0ICsgZW5jb2RlZDtcblx0fVxuXG5cdC8qKlxuXHQgKiBDcmVhdGVzIGFuIGFycmF5IGNvbnRhaW5pbmcgdGhlIG51bWVyaWMgY29kZSBwb2ludHMgb2YgZWFjaCBVbmljb2RlXG5cdCAqIGNoYXJhY3RlciBpbiB0aGUgc3RyaW5nLiBXaGlsZSBKYXZhU2NyaXB0IHVzZXMgVUNTLTIgaW50ZXJuYWxseSxcblx0ICogdGhpcyBmdW5jdGlvbiB3aWxsIGNvbnZlcnQgYSBwYWlyIG9mIHN1cnJvZ2F0ZSBoYWx2ZXMgKGVhY2ggb2Ygd2hpY2hcblx0ICogVUNTLTIgZXhwb3NlcyBhcyBzZXBhcmF0ZSBjaGFyYWN0ZXJzKSBpbnRvIGEgc2luZ2xlIGNvZGUgcG9pbnQsXG5cdCAqIG1hdGNoaW5nIFVURi0xNi5cblx0ICogQHNlZSBgcHVueWNvZGUudWNzMi5lbmNvZGVgXG5cdCAqIEBzZWUgPGh0dHBzOi8vbWF0aGlhc2J5bmVucy5iZS9ub3Rlcy9qYXZhc2NyaXB0LWVuY29kaW5nPlxuXHQgKiBAbWVtYmVyT2YgcHVueWNvZGUudWNzMlxuXHQgKiBAbmFtZSBkZWNvZGVcblx0ICogQHBhcmFtIHtTdHJpbmd9IHN0cmluZyBUaGUgVW5pY29kZSBpbnB1dCBzdHJpbmcgKFVDUy0yKS5cblx0ICogQHJldHVybnMge0FycmF5fSBUaGUgbmV3IGFycmF5IG9mIGNvZGUgcG9pbnRzLlxuXHQgKi9cblx0ZnVuY3Rpb24gdWNzMmRlY29kZShzdHJpbmcpIHtcblx0XHR2YXIgb3V0cHV0ID0gW10sXG5cdFx0ICAgIGNvdW50ZXIgPSAwLFxuXHRcdCAgICBsZW5ndGggPSBzdHJpbmcubGVuZ3RoLFxuXHRcdCAgICB2YWx1ZSxcblx0XHQgICAgZXh0cmE7XG5cdFx0d2hpbGUgKGNvdW50ZXIgPCBsZW5ndGgpIHtcblx0XHRcdHZhbHVlID0gc3RyaW5nLmNoYXJDb2RlQXQoY291bnRlcisrKTtcblx0XHRcdGlmICh2YWx1ZSA+PSAweEQ4MDAgJiYgdmFsdWUgPD0gMHhEQkZGICYmIGNvdW50ZXIgPCBsZW5ndGgpIHtcblx0XHRcdFx0Ly8gaGlnaCBzdXJyb2dhdGUsIGFuZCB0aGVyZSBpcyBhIG5leHQgY2hhcmFjdGVyXG5cdFx0XHRcdGV4dHJhID0gc3RyaW5nLmNoYXJDb2RlQXQoY291bnRlcisrKTtcblx0XHRcdFx0aWYgKChleHRyYSAmIDB4RkMwMCkgPT0gMHhEQzAwKSB7IC8vIGxvdyBzdXJyb2dhdGVcblx0XHRcdFx0XHRvdXRwdXQucHVzaCgoKHZhbHVlICYgMHgzRkYpIDw8IDEwKSArIChleHRyYSAmIDB4M0ZGKSArIDB4MTAwMDApO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdC8vIHVubWF0Y2hlZCBzdXJyb2dhdGU7IG9ubHkgYXBwZW5kIHRoaXMgY29kZSB1bml0LCBpbiBjYXNlIHRoZSBuZXh0XG5cdFx0XHRcdFx0Ly8gY29kZSB1bml0IGlzIHRoZSBoaWdoIHN1cnJvZ2F0ZSBvZiBhIHN1cnJvZ2F0ZSBwYWlyXG5cdFx0XHRcdFx0b3V0cHV0LnB1c2godmFsdWUpO1xuXHRcdFx0XHRcdGNvdW50ZXItLTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0b3V0cHV0LnB1c2godmFsdWUpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gb3V0cHV0O1xuXHR9XG5cblx0LyoqXG5cdCAqIENyZWF0ZXMgYSBzdHJpbmcgYmFzZWQgb24gYW4gYXJyYXkgb2YgbnVtZXJpYyBjb2RlIHBvaW50cy5cblx0ICogQHNlZSBgcHVueWNvZGUudWNzMi5kZWNvZGVgXG5cdCAqIEBtZW1iZXJPZiBwdW55Y29kZS51Y3MyXG5cdCAqIEBuYW1lIGVuY29kZVxuXHQgKiBAcGFyYW0ge0FycmF5fSBjb2RlUG9pbnRzIFRoZSBhcnJheSBvZiBudW1lcmljIGNvZGUgcG9pbnRzLlxuXHQgKiBAcmV0dXJucyB7U3RyaW5nfSBUaGUgbmV3IFVuaWNvZGUgc3RyaW5nIChVQ1MtMikuXG5cdCAqL1xuXHRmdW5jdGlvbiB1Y3MyZW5jb2RlKGFycmF5KSB7XG5cdFx0cmV0dXJuIG1hcChhcnJheSwgZnVuY3Rpb24odmFsdWUpIHtcblx0XHRcdHZhciBvdXRwdXQgPSAnJztcblx0XHRcdGlmICh2YWx1ZSA+IDB4RkZGRikge1xuXHRcdFx0XHR2YWx1ZSAtPSAweDEwMDAwO1xuXHRcdFx0XHRvdXRwdXQgKz0gc3RyaW5nRnJvbUNoYXJDb2RlKHZhbHVlID4+PiAxMCAmIDB4M0ZGIHwgMHhEODAwKTtcblx0XHRcdFx0dmFsdWUgPSAweERDMDAgfCB2YWx1ZSAmIDB4M0ZGO1xuXHRcdFx0fVxuXHRcdFx0b3V0cHV0ICs9IHN0cmluZ0Zyb21DaGFyQ29kZSh2YWx1ZSk7XG5cdFx0XHRyZXR1cm4gb3V0cHV0O1xuXHRcdH0pLmpvaW4oJycpO1xuXHR9XG5cblx0LyoqXG5cdCAqIENvbnZlcnRzIGEgYmFzaWMgY29kZSBwb2ludCBpbnRvIGEgZGlnaXQvaW50ZWdlci5cblx0ICogQHNlZSBgZGlnaXRUb0Jhc2ljKClgXG5cdCAqIEBwcml2YXRlXG5cdCAqIEBwYXJhbSB7TnVtYmVyfSBjb2RlUG9pbnQgVGhlIGJhc2ljIG51bWVyaWMgY29kZSBwb2ludCB2YWx1ZS5cblx0ICogQHJldHVybnMge051bWJlcn0gVGhlIG51bWVyaWMgdmFsdWUgb2YgYSBiYXNpYyBjb2RlIHBvaW50IChmb3IgdXNlIGluXG5cdCAqIHJlcHJlc2VudGluZyBpbnRlZ2VycykgaW4gdGhlIHJhbmdlIGAwYCB0byBgYmFzZSAtIDFgLCBvciBgYmFzZWAgaWZcblx0ICogdGhlIGNvZGUgcG9pbnQgZG9lcyBub3QgcmVwcmVzZW50IGEgdmFsdWUuXG5cdCAqL1xuXHRmdW5jdGlvbiBiYXNpY1RvRGlnaXQoY29kZVBvaW50KSB7XG5cdFx0aWYgKGNvZGVQb2ludCAtIDQ4IDwgMTApIHtcblx0XHRcdHJldHVybiBjb2RlUG9pbnQgLSAyMjtcblx0XHR9XG5cdFx0aWYgKGNvZGVQb2ludCAtIDY1IDwgMjYpIHtcblx0XHRcdHJldHVybiBjb2RlUG9pbnQgLSA2NTtcblx0XHR9XG5cdFx0aWYgKGNvZGVQb2ludCAtIDk3IDwgMjYpIHtcblx0XHRcdHJldHVybiBjb2RlUG9pbnQgLSA5Nztcblx0XHR9XG5cdFx0cmV0dXJuIGJhc2U7XG5cdH1cblxuXHQvKipcblx0ICogQ29udmVydHMgYSBkaWdpdC9pbnRlZ2VyIGludG8gYSBiYXNpYyBjb2RlIHBvaW50LlxuXHQgKiBAc2VlIGBiYXNpY1RvRGlnaXQoKWBcblx0ICogQHByaXZhdGVcblx0ICogQHBhcmFtIHtOdW1iZXJ9IGRpZ2l0IFRoZSBudW1lcmljIHZhbHVlIG9mIGEgYmFzaWMgY29kZSBwb2ludC5cblx0ICogQHJldHVybnMge051bWJlcn0gVGhlIGJhc2ljIGNvZGUgcG9pbnQgd2hvc2UgdmFsdWUgKHdoZW4gdXNlZCBmb3Jcblx0ICogcmVwcmVzZW50aW5nIGludGVnZXJzKSBpcyBgZGlnaXRgLCB3aGljaCBuZWVkcyB0byBiZSBpbiB0aGUgcmFuZ2Vcblx0ICogYDBgIHRvIGBiYXNlIC0gMWAuIElmIGBmbGFnYCBpcyBub24temVybywgdGhlIHVwcGVyY2FzZSBmb3JtIGlzXG5cdCAqIHVzZWQ7IGVsc2UsIHRoZSBsb3dlcmNhc2UgZm9ybSBpcyB1c2VkLiBUaGUgYmVoYXZpb3IgaXMgdW5kZWZpbmVkXG5cdCAqIGlmIGBmbGFnYCBpcyBub24temVybyBhbmQgYGRpZ2l0YCBoYXMgbm8gdXBwZXJjYXNlIGZvcm0uXG5cdCAqL1xuXHRmdW5jdGlvbiBkaWdpdFRvQmFzaWMoZGlnaXQsIGZsYWcpIHtcblx0XHQvLyAgMC4uMjUgbWFwIHRvIEFTQ0lJIGEuLnogb3IgQS4uWlxuXHRcdC8vIDI2Li4zNSBtYXAgdG8gQVNDSUkgMC4uOVxuXHRcdHJldHVybiBkaWdpdCArIDIyICsgNzUgKiAoZGlnaXQgPCAyNikgLSAoKGZsYWcgIT0gMCkgPDwgNSk7XG5cdH1cblxuXHQvKipcblx0ICogQmlhcyBhZGFwdGF0aW9uIGZ1bmN0aW9uIGFzIHBlciBzZWN0aW9uIDMuNCBvZiBSRkMgMzQ5Mi5cblx0ICogaHR0cHM6Ly90b29scy5pZXRmLm9yZy9odG1sL3JmYzM0OTIjc2VjdGlvbi0zLjRcblx0ICogQHByaXZhdGVcblx0ICovXG5cdGZ1bmN0aW9uIGFkYXB0KGRlbHRhLCBudW1Qb2ludHMsIGZpcnN0VGltZSkge1xuXHRcdHZhciBrID0gMDtcblx0XHRkZWx0YSA9IGZpcnN0VGltZSA/IGZsb29yKGRlbHRhIC8gZGFtcCkgOiBkZWx0YSA+PiAxO1xuXHRcdGRlbHRhICs9IGZsb29yKGRlbHRhIC8gbnVtUG9pbnRzKTtcblx0XHRmb3IgKC8qIG5vIGluaXRpYWxpemF0aW9uICovOyBkZWx0YSA+IGJhc2VNaW51c1RNaW4gKiB0TWF4ID4+IDE7IGsgKz0gYmFzZSkge1xuXHRcdFx0ZGVsdGEgPSBmbG9vcihkZWx0YSAvIGJhc2VNaW51c1RNaW4pO1xuXHRcdH1cblx0XHRyZXR1cm4gZmxvb3IoayArIChiYXNlTWludXNUTWluICsgMSkgKiBkZWx0YSAvIChkZWx0YSArIHNrZXcpKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDb252ZXJ0cyBhIFB1bnljb2RlIHN0cmluZyBvZiBBU0NJSS1vbmx5IHN5bWJvbHMgdG8gYSBzdHJpbmcgb2YgVW5pY29kZVxuXHQgKiBzeW1ib2xzLlxuXHQgKiBAbWVtYmVyT2YgcHVueWNvZGVcblx0ICogQHBhcmFtIHtTdHJpbmd9IGlucHV0IFRoZSBQdW55Y29kZSBzdHJpbmcgb2YgQVNDSUktb25seSBzeW1ib2xzLlxuXHQgKiBAcmV0dXJucyB7U3RyaW5nfSBUaGUgcmVzdWx0aW5nIHN0cmluZyBvZiBVbmljb2RlIHN5bWJvbHMuXG5cdCAqL1xuXHRmdW5jdGlvbiBkZWNvZGUoaW5wdXQpIHtcblx0XHQvLyBEb24ndCB1c2UgVUNTLTJcblx0XHR2YXIgb3V0cHV0ID0gW10sXG5cdFx0ICAgIGlucHV0TGVuZ3RoID0gaW5wdXQubGVuZ3RoLFxuXHRcdCAgICBvdXQsXG5cdFx0ICAgIGkgPSAwLFxuXHRcdCAgICBuID0gaW5pdGlhbE4sXG5cdFx0ICAgIGJpYXMgPSBpbml0aWFsQmlhcyxcblx0XHQgICAgYmFzaWMsXG5cdFx0ICAgIGosXG5cdFx0ICAgIGluZGV4LFxuXHRcdCAgICBvbGRpLFxuXHRcdCAgICB3LFxuXHRcdCAgICBrLFxuXHRcdCAgICBkaWdpdCxcblx0XHQgICAgdCxcblx0XHQgICAgLyoqIENhY2hlZCBjYWxjdWxhdGlvbiByZXN1bHRzICovXG5cdFx0ICAgIGJhc2VNaW51c1Q7XG5cblx0XHQvLyBIYW5kbGUgdGhlIGJhc2ljIGNvZGUgcG9pbnRzOiBsZXQgYGJhc2ljYCBiZSB0aGUgbnVtYmVyIG9mIGlucHV0IGNvZGVcblx0XHQvLyBwb2ludHMgYmVmb3JlIHRoZSBsYXN0IGRlbGltaXRlciwgb3IgYDBgIGlmIHRoZXJlIGlzIG5vbmUsIHRoZW4gY29weVxuXHRcdC8vIHRoZSBmaXJzdCBiYXNpYyBjb2RlIHBvaW50cyB0byB0aGUgb3V0cHV0LlxuXG5cdFx0YmFzaWMgPSBpbnB1dC5sYXN0SW5kZXhPZihkZWxpbWl0ZXIpO1xuXHRcdGlmIChiYXNpYyA8IDApIHtcblx0XHRcdGJhc2ljID0gMDtcblx0XHR9XG5cblx0XHRmb3IgKGogPSAwOyBqIDwgYmFzaWM7ICsraikge1xuXHRcdFx0Ly8gaWYgaXQncyBub3QgYSBiYXNpYyBjb2RlIHBvaW50XG5cdFx0XHRpZiAoaW5wdXQuY2hhckNvZGVBdChqKSA+PSAweDgwKSB7XG5cdFx0XHRcdGVycm9yKCdub3QtYmFzaWMnKTtcblx0XHRcdH1cblx0XHRcdG91dHB1dC5wdXNoKGlucHV0LmNoYXJDb2RlQXQoaikpO1xuXHRcdH1cblxuXHRcdC8vIE1haW4gZGVjb2RpbmcgbG9vcDogc3RhcnQganVzdCBhZnRlciB0aGUgbGFzdCBkZWxpbWl0ZXIgaWYgYW55IGJhc2ljIGNvZGVcblx0XHQvLyBwb2ludHMgd2VyZSBjb3BpZWQ7IHN0YXJ0IGF0IHRoZSBiZWdpbm5pbmcgb3RoZXJ3aXNlLlxuXG5cdFx0Zm9yIChpbmRleCA9IGJhc2ljID4gMCA/IGJhc2ljICsgMSA6IDA7IGluZGV4IDwgaW5wdXRMZW5ndGg7IC8qIG5vIGZpbmFsIGV4cHJlc3Npb24gKi8pIHtcblxuXHRcdFx0Ly8gYGluZGV4YCBpcyB0aGUgaW5kZXggb2YgdGhlIG5leHQgY2hhcmFjdGVyIHRvIGJlIGNvbnN1bWVkLlxuXHRcdFx0Ly8gRGVjb2RlIGEgZ2VuZXJhbGl6ZWQgdmFyaWFibGUtbGVuZ3RoIGludGVnZXIgaW50byBgZGVsdGFgLFxuXHRcdFx0Ly8gd2hpY2ggZ2V0cyBhZGRlZCB0byBgaWAuIFRoZSBvdmVyZmxvdyBjaGVja2luZyBpcyBlYXNpZXJcblx0XHRcdC8vIGlmIHdlIGluY3JlYXNlIGBpYCBhcyB3ZSBnbywgdGhlbiBzdWJ0cmFjdCBvZmYgaXRzIHN0YXJ0aW5nXG5cdFx0XHQvLyB2YWx1ZSBhdCB0aGUgZW5kIHRvIG9idGFpbiBgZGVsdGFgLlxuXHRcdFx0Zm9yIChvbGRpID0gaSwgdyA9IDEsIGsgPSBiYXNlOyAvKiBubyBjb25kaXRpb24gKi87IGsgKz0gYmFzZSkge1xuXG5cdFx0XHRcdGlmIChpbmRleCA+PSBpbnB1dExlbmd0aCkge1xuXHRcdFx0XHRcdGVycm9yKCdpbnZhbGlkLWlucHV0Jyk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRkaWdpdCA9IGJhc2ljVG9EaWdpdChpbnB1dC5jaGFyQ29kZUF0KGluZGV4KyspKTtcblxuXHRcdFx0XHRpZiAoZGlnaXQgPj0gYmFzZSB8fCBkaWdpdCA+IGZsb29yKChtYXhJbnQgLSBpKSAvIHcpKSB7XG5cdFx0XHRcdFx0ZXJyb3IoJ292ZXJmbG93Jyk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpICs9IGRpZ2l0ICogdztcblx0XHRcdFx0dCA9IGsgPD0gYmlhcyA/IHRNaW4gOiAoayA+PSBiaWFzICsgdE1heCA/IHRNYXggOiBrIC0gYmlhcyk7XG5cblx0XHRcdFx0aWYgKGRpZ2l0IDwgdCkge1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0YmFzZU1pbnVzVCA9IGJhc2UgLSB0O1xuXHRcdFx0XHRpZiAodyA+IGZsb29yKG1heEludCAvIGJhc2VNaW51c1QpKSB7XG5cdFx0XHRcdFx0ZXJyb3IoJ292ZXJmbG93Jyk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR3ICo9IGJhc2VNaW51c1Q7XG5cblx0XHRcdH1cblxuXHRcdFx0b3V0ID0gb3V0cHV0Lmxlbmd0aCArIDE7XG5cdFx0XHRiaWFzID0gYWRhcHQoaSAtIG9sZGksIG91dCwgb2xkaSA9PSAwKTtcblxuXHRcdFx0Ly8gYGlgIHdhcyBzdXBwb3NlZCB0byB3cmFwIGFyb3VuZCBmcm9tIGBvdXRgIHRvIGAwYCxcblx0XHRcdC8vIGluY3JlbWVudGluZyBgbmAgZWFjaCB0aW1lLCBzbyB3ZSdsbCBmaXggdGhhdCBub3c6XG5cdFx0XHRpZiAoZmxvb3IoaSAvIG91dCkgPiBtYXhJbnQgLSBuKSB7XG5cdFx0XHRcdGVycm9yKCdvdmVyZmxvdycpO1xuXHRcdFx0fVxuXG5cdFx0XHRuICs9IGZsb29yKGkgLyBvdXQpO1xuXHRcdFx0aSAlPSBvdXQ7XG5cblx0XHRcdC8vIEluc2VydCBgbmAgYXQgcG9zaXRpb24gYGlgIG9mIHRoZSBvdXRwdXRcblx0XHRcdG91dHB1dC5zcGxpY2UoaSsrLCAwLCBuKTtcblxuXHRcdH1cblxuXHRcdHJldHVybiB1Y3MyZW5jb2RlKG91dHB1dCk7XG5cdH1cblxuXHQvKipcblx0ICogQ29udmVydHMgYSBzdHJpbmcgb2YgVW5pY29kZSBzeW1ib2xzIChlLmcuIGEgZG9tYWluIG5hbWUgbGFiZWwpIHRvIGFcblx0ICogUHVueWNvZGUgc3RyaW5nIG9mIEFTQ0lJLW9ubHkgc3ltYm9scy5cblx0ICogQG1lbWJlck9mIHB1bnljb2RlXG5cdCAqIEBwYXJhbSB7U3RyaW5nfSBpbnB1dCBUaGUgc3RyaW5nIG9mIFVuaWNvZGUgc3ltYm9scy5cblx0ICogQHJldHVybnMge1N0cmluZ30gVGhlIHJlc3VsdGluZyBQdW55Y29kZSBzdHJpbmcgb2YgQVNDSUktb25seSBzeW1ib2xzLlxuXHQgKi9cblx0ZnVuY3Rpb24gZW5jb2RlKGlucHV0KSB7XG5cdFx0dmFyIG4sXG5cdFx0ICAgIGRlbHRhLFxuXHRcdCAgICBoYW5kbGVkQ1BDb3VudCxcblx0XHQgICAgYmFzaWNMZW5ndGgsXG5cdFx0ICAgIGJpYXMsXG5cdFx0ICAgIGosXG5cdFx0ICAgIG0sXG5cdFx0ICAgIHEsXG5cdFx0ICAgIGssXG5cdFx0ICAgIHQsXG5cdFx0ICAgIGN1cnJlbnRWYWx1ZSxcblx0XHQgICAgb3V0cHV0ID0gW10sXG5cdFx0ICAgIC8qKiBgaW5wdXRMZW5ndGhgIHdpbGwgaG9sZCB0aGUgbnVtYmVyIG9mIGNvZGUgcG9pbnRzIGluIGBpbnB1dGAuICovXG5cdFx0ICAgIGlucHV0TGVuZ3RoLFxuXHRcdCAgICAvKiogQ2FjaGVkIGNhbGN1bGF0aW9uIHJlc3VsdHMgKi9cblx0XHQgICAgaGFuZGxlZENQQ291bnRQbHVzT25lLFxuXHRcdCAgICBiYXNlTWludXNULFxuXHRcdCAgICBxTWludXNUO1xuXG5cdFx0Ly8gQ29udmVydCB0aGUgaW5wdXQgaW4gVUNTLTIgdG8gVW5pY29kZVxuXHRcdGlucHV0ID0gdWNzMmRlY29kZShpbnB1dCk7XG5cblx0XHQvLyBDYWNoZSB0aGUgbGVuZ3RoXG5cdFx0aW5wdXRMZW5ndGggPSBpbnB1dC5sZW5ndGg7XG5cblx0XHQvLyBJbml0aWFsaXplIHRoZSBzdGF0ZVxuXHRcdG4gPSBpbml0aWFsTjtcblx0XHRkZWx0YSA9IDA7XG5cdFx0YmlhcyA9IGluaXRpYWxCaWFzO1xuXG5cdFx0Ly8gSGFuZGxlIHRoZSBiYXNpYyBjb2RlIHBvaW50c1xuXHRcdGZvciAoaiA9IDA7IGogPCBpbnB1dExlbmd0aDsgKytqKSB7XG5cdFx0XHRjdXJyZW50VmFsdWUgPSBpbnB1dFtqXTtcblx0XHRcdGlmIChjdXJyZW50VmFsdWUgPCAweDgwKSB7XG5cdFx0XHRcdG91dHB1dC5wdXNoKHN0cmluZ0Zyb21DaGFyQ29kZShjdXJyZW50VmFsdWUpKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRoYW5kbGVkQ1BDb3VudCA9IGJhc2ljTGVuZ3RoID0gb3V0cHV0Lmxlbmd0aDtcblxuXHRcdC8vIGBoYW5kbGVkQ1BDb3VudGAgaXMgdGhlIG51bWJlciBvZiBjb2RlIHBvaW50cyB0aGF0IGhhdmUgYmVlbiBoYW5kbGVkO1xuXHRcdC8vIGBiYXNpY0xlbmd0aGAgaXMgdGhlIG51bWJlciBvZiBiYXNpYyBjb2RlIHBvaW50cy5cblxuXHRcdC8vIEZpbmlzaCB0aGUgYmFzaWMgc3RyaW5nIC0gaWYgaXQgaXMgbm90IGVtcHR5IC0gd2l0aCBhIGRlbGltaXRlclxuXHRcdGlmIChiYXNpY0xlbmd0aCkge1xuXHRcdFx0b3V0cHV0LnB1c2goZGVsaW1pdGVyKTtcblx0XHR9XG5cblx0XHQvLyBNYWluIGVuY29kaW5nIGxvb3A6XG5cdFx0d2hpbGUgKGhhbmRsZWRDUENvdW50IDwgaW5wdXRMZW5ndGgpIHtcblxuXHRcdFx0Ly8gQWxsIG5vbi1iYXNpYyBjb2RlIHBvaW50cyA8IG4gaGF2ZSBiZWVuIGhhbmRsZWQgYWxyZWFkeS4gRmluZCB0aGUgbmV4dFxuXHRcdFx0Ly8gbGFyZ2VyIG9uZTpcblx0XHRcdGZvciAobSA9IG1heEludCwgaiA9IDA7IGogPCBpbnB1dExlbmd0aDsgKytqKSB7XG5cdFx0XHRcdGN1cnJlbnRWYWx1ZSA9IGlucHV0W2pdO1xuXHRcdFx0XHRpZiAoY3VycmVudFZhbHVlID49IG4gJiYgY3VycmVudFZhbHVlIDwgbSkge1xuXHRcdFx0XHRcdG0gPSBjdXJyZW50VmFsdWU7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0Ly8gSW5jcmVhc2UgYGRlbHRhYCBlbm91Z2ggdG8gYWR2YW5jZSB0aGUgZGVjb2RlcidzIDxuLGk+IHN0YXRlIHRvIDxtLDA+LFxuXHRcdFx0Ly8gYnV0IGd1YXJkIGFnYWluc3Qgb3ZlcmZsb3dcblx0XHRcdGhhbmRsZWRDUENvdW50UGx1c09uZSA9IGhhbmRsZWRDUENvdW50ICsgMTtcblx0XHRcdGlmIChtIC0gbiA+IGZsb29yKChtYXhJbnQgLSBkZWx0YSkgLyBoYW5kbGVkQ1BDb3VudFBsdXNPbmUpKSB7XG5cdFx0XHRcdGVycm9yKCdvdmVyZmxvdycpO1xuXHRcdFx0fVxuXG5cdFx0XHRkZWx0YSArPSAobSAtIG4pICogaGFuZGxlZENQQ291bnRQbHVzT25lO1xuXHRcdFx0biA9IG07XG5cblx0XHRcdGZvciAoaiA9IDA7IGogPCBpbnB1dExlbmd0aDsgKytqKSB7XG5cdFx0XHRcdGN1cnJlbnRWYWx1ZSA9IGlucHV0W2pdO1xuXG5cdFx0XHRcdGlmIChjdXJyZW50VmFsdWUgPCBuICYmICsrZGVsdGEgPiBtYXhJbnQpIHtcblx0XHRcdFx0XHRlcnJvcignb3ZlcmZsb3cnKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmIChjdXJyZW50VmFsdWUgPT0gbikge1xuXHRcdFx0XHRcdC8vIFJlcHJlc2VudCBkZWx0YSBhcyBhIGdlbmVyYWxpemVkIHZhcmlhYmxlLWxlbmd0aCBpbnRlZ2VyXG5cdFx0XHRcdFx0Zm9yIChxID0gZGVsdGEsIGsgPSBiYXNlOyAvKiBubyBjb25kaXRpb24gKi87IGsgKz0gYmFzZSkge1xuXHRcdFx0XHRcdFx0dCA9IGsgPD0gYmlhcyA/IHRNaW4gOiAoayA+PSBiaWFzICsgdE1heCA/IHRNYXggOiBrIC0gYmlhcyk7XG5cdFx0XHRcdFx0XHRpZiAocSA8IHQpIHtcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRxTWludXNUID0gcSAtIHQ7XG5cdFx0XHRcdFx0XHRiYXNlTWludXNUID0gYmFzZSAtIHQ7XG5cdFx0XHRcdFx0XHRvdXRwdXQucHVzaChcblx0XHRcdFx0XHRcdFx0c3RyaW5nRnJvbUNoYXJDb2RlKGRpZ2l0VG9CYXNpYyh0ICsgcU1pbnVzVCAlIGJhc2VNaW51c1QsIDApKVxuXHRcdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRcdHEgPSBmbG9vcihxTWludXNUIC8gYmFzZU1pbnVzVCk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0b3V0cHV0LnB1c2goc3RyaW5nRnJvbUNoYXJDb2RlKGRpZ2l0VG9CYXNpYyhxLCAwKSkpO1xuXHRcdFx0XHRcdGJpYXMgPSBhZGFwdChkZWx0YSwgaGFuZGxlZENQQ291bnRQbHVzT25lLCBoYW5kbGVkQ1BDb3VudCA9PSBiYXNpY0xlbmd0aCk7XG5cdFx0XHRcdFx0ZGVsdGEgPSAwO1xuXHRcdFx0XHRcdCsraGFuZGxlZENQQ291bnQ7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0KytkZWx0YTtcblx0XHRcdCsrbjtcblxuXHRcdH1cblx0XHRyZXR1cm4gb3V0cHV0LmpvaW4oJycpO1xuXHR9XG5cblx0LyoqXG5cdCAqIENvbnZlcnRzIGEgUHVueWNvZGUgc3RyaW5nIHJlcHJlc2VudGluZyBhIGRvbWFpbiBuYW1lIG9yIGFuIGVtYWlsIGFkZHJlc3Ncblx0ICogdG8gVW5pY29kZS4gT25seSB0aGUgUHVueWNvZGVkIHBhcnRzIG9mIHRoZSBpbnB1dCB3aWxsIGJlIGNvbnZlcnRlZCwgaS5lLlxuXHQgKiBpdCBkb2Vzbid0IG1hdHRlciBpZiB5b3UgY2FsbCBpdCBvbiBhIHN0cmluZyB0aGF0IGhhcyBhbHJlYWR5IGJlZW5cblx0ICogY29udmVydGVkIHRvIFVuaWNvZGUuXG5cdCAqIEBtZW1iZXJPZiBwdW55Y29kZVxuXHQgKiBAcGFyYW0ge1N0cmluZ30gaW5wdXQgVGhlIFB1bnljb2RlZCBkb21haW4gbmFtZSBvciBlbWFpbCBhZGRyZXNzIHRvXG5cdCAqIGNvbnZlcnQgdG8gVW5pY29kZS5cblx0ICogQHJldHVybnMge1N0cmluZ30gVGhlIFVuaWNvZGUgcmVwcmVzZW50YXRpb24gb2YgdGhlIGdpdmVuIFB1bnljb2RlXG5cdCAqIHN0cmluZy5cblx0ICovXG5cdGZ1bmN0aW9uIHRvVW5pY29kZShpbnB1dCkge1xuXHRcdHJldHVybiBtYXBEb21haW4oaW5wdXQsIGZ1bmN0aW9uKHN0cmluZykge1xuXHRcdFx0cmV0dXJuIHJlZ2V4UHVueWNvZGUudGVzdChzdHJpbmcpXG5cdFx0XHRcdD8gZGVjb2RlKHN0cmluZy5zbGljZSg0KS50b0xvd2VyQ2FzZSgpKVxuXHRcdFx0XHQ6IHN0cmluZztcblx0XHR9KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBDb252ZXJ0cyBhIFVuaWNvZGUgc3RyaW5nIHJlcHJlc2VudGluZyBhIGRvbWFpbiBuYW1lIG9yIGFuIGVtYWlsIGFkZHJlc3MgdG9cblx0ICogUHVueWNvZGUuIE9ubHkgdGhlIG5vbi1BU0NJSSBwYXJ0cyBvZiB0aGUgZG9tYWluIG5hbWUgd2lsbCBiZSBjb252ZXJ0ZWQsXG5cdCAqIGkuZS4gaXQgZG9lc24ndCBtYXR0ZXIgaWYgeW91IGNhbGwgaXQgd2l0aCBhIGRvbWFpbiB0aGF0J3MgYWxyZWFkeSBpblxuXHQgKiBBU0NJSS5cblx0ICogQG1lbWJlck9mIHB1bnljb2RlXG5cdCAqIEBwYXJhbSB7U3RyaW5nfSBpbnB1dCBUaGUgZG9tYWluIG5hbWUgb3IgZW1haWwgYWRkcmVzcyB0byBjb252ZXJ0LCBhcyBhXG5cdCAqIFVuaWNvZGUgc3RyaW5nLlxuXHQgKiBAcmV0dXJucyB7U3RyaW5nfSBUaGUgUHVueWNvZGUgcmVwcmVzZW50YXRpb24gb2YgdGhlIGdpdmVuIGRvbWFpbiBuYW1lIG9yXG5cdCAqIGVtYWlsIGFkZHJlc3MuXG5cdCAqL1xuXHRmdW5jdGlvbiB0b0FTQ0lJKGlucHV0KSB7XG5cdFx0cmV0dXJuIG1hcERvbWFpbihpbnB1dCwgZnVuY3Rpb24oc3RyaW5nKSB7XG5cdFx0XHRyZXR1cm4gcmVnZXhOb25BU0NJSS50ZXN0KHN0cmluZylcblx0XHRcdFx0PyAneG4tLScgKyBlbmNvZGUoc3RyaW5nKVxuXHRcdFx0XHQ6IHN0cmluZztcblx0XHR9KTtcblx0fVxuXG5cdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdC8qKiBEZWZpbmUgdGhlIHB1YmxpYyBBUEkgKi9cblx0cHVueWNvZGUgPSB7XG5cdFx0LyoqXG5cdFx0ICogQSBzdHJpbmcgcmVwcmVzZW50aW5nIHRoZSBjdXJyZW50IFB1bnljb2RlLmpzIHZlcnNpb24gbnVtYmVyLlxuXHRcdCAqIEBtZW1iZXJPZiBwdW55Y29kZVxuXHRcdCAqIEB0eXBlIFN0cmluZ1xuXHRcdCAqL1xuXHRcdCd2ZXJzaW9uJzogJzEuNC4xJyxcblx0XHQvKipcblx0XHQgKiBBbiBvYmplY3Qgb2YgbWV0aG9kcyB0byBjb252ZXJ0IGZyb20gSmF2YVNjcmlwdCdzIGludGVybmFsIGNoYXJhY3RlclxuXHRcdCAqIHJlcHJlc2VudGF0aW9uIChVQ1MtMikgdG8gVW5pY29kZSBjb2RlIHBvaW50cywgYW5kIGJhY2suXG5cdFx0ICogQHNlZSA8aHR0cHM6Ly9tYXRoaWFzYnluZW5zLmJlL25vdGVzL2phdmFzY3JpcHQtZW5jb2Rpbmc+XG5cdFx0ICogQG1lbWJlck9mIHB1bnljb2RlXG5cdFx0ICogQHR5cGUgT2JqZWN0XG5cdFx0ICovXG5cdFx0J3VjczInOiB7XG5cdFx0XHQnZGVjb2RlJzogdWNzMmRlY29kZSxcblx0XHRcdCdlbmNvZGUnOiB1Y3MyZW5jb2RlXG5cdFx0fSxcblx0XHQnZGVjb2RlJzogZGVjb2RlLFxuXHRcdCdlbmNvZGUnOiBlbmNvZGUsXG5cdFx0J3RvQVNDSUknOiB0b0FTQ0lJLFxuXHRcdCd0b1VuaWNvZGUnOiB0b1VuaWNvZGVcblx0fTtcblxuXHQvKiogRXhwb3NlIGBwdW55Y29kZWAgKi9cblx0Ly8gU29tZSBBTUQgYnVpbGQgb3B0aW1pemVycywgbGlrZSByLmpzLCBjaGVjayBmb3Igc3BlY2lmaWMgY29uZGl0aW9uIHBhdHRlcm5zXG5cdC8vIGxpa2UgdGhlIGZvbGxvd2luZzpcblx0aWYgKFxuXHRcdHR5cGVvZiBkZWZpbmUgPT0gJ2Z1bmN0aW9uJyAmJlxuXHRcdHR5cGVvZiBkZWZpbmUuYW1kID09ICdvYmplY3QnICYmXG5cdFx0ZGVmaW5lLmFtZFxuXHQpIHtcblx0XHRkZWZpbmUoJ3B1bnljb2RlJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gcHVueWNvZGU7XG5cdFx0fSk7XG5cdH0gZWxzZSBpZiAoZnJlZUV4cG9ydHMgJiYgZnJlZU1vZHVsZSkge1xuXHRcdGlmIChtb2R1bGUuZXhwb3J0cyA9PSBmcmVlRXhwb3J0cykge1xuXHRcdFx0Ly8gaW4gTm9kZS5qcywgaW8uanMsIG9yIFJpbmdvSlMgdjAuOC4wK1xuXHRcdFx0ZnJlZU1vZHVsZS5leHBvcnRzID0gcHVueWNvZGU7XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIGluIE5hcndoYWwgb3IgUmluZ29KUyB2MC43LjAtXG5cdFx0XHRmb3IgKGtleSBpbiBwdW55Y29kZSkge1xuXHRcdFx0XHRwdW55Y29kZS5oYXNPd25Qcm9wZXJ0eShrZXkpICYmIChmcmVlRXhwb3J0c1trZXldID0gcHVueWNvZGVba2V5XSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9IGVsc2Uge1xuXHRcdC8vIGluIFJoaW5vIG9yIGEgd2ViIGJyb3dzZXJcblx0XHRyb290LnB1bnljb2RlID0gcHVueWNvZGU7XG5cdH1cblxufSh0aGlzKSk7XG4iLCIndXNlIHN0cmljdCc7XG5cbi8vIFBvcnQgb2YgbG93ZXJfYm91bmQgZnJvbSBodHRwOi8vZW4uY3BwcmVmZXJlbmNlLmNvbS93L2NwcC9hbGdvcml0aG0vbG93ZXJfYm91bmRcbi8vIFVzZWQgdG8gY29tcHV0ZSBpbnNlcnRpb24gaW5kZXggdG8ga2VlcCBxdWV1ZSBzb3J0ZWQgYWZ0ZXIgaW5zZXJ0aW9uXG5mdW5jdGlvbiBsb3dlckJvdW5kKGFycmF5LCB2YWx1ZSwgY29tcCkge1xuXHRsZXQgZmlyc3QgPSAwO1xuXHRsZXQgY291bnQgPSBhcnJheS5sZW5ndGg7XG5cblx0d2hpbGUgKGNvdW50ID4gMCkge1xuXHRcdGNvbnN0IHN0ZXAgPSAoY291bnQgLyAyKSB8IDA7XG5cdFx0bGV0IGl0ID0gZmlyc3QgKyBzdGVwO1xuXG5cdFx0aWYgKGNvbXAoYXJyYXlbaXRdLCB2YWx1ZSkgPD0gMCkge1xuXHRcdFx0Zmlyc3QgPSArK2l0O1xuXHRcdFx0Y291bnQgLT0gc3RlcCArIDE7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvdW50ID0gc3RlcDtcblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gZmlyc3Q7XG59XG5cbmNsYXNzIFByaW9yaXR5UXVldWUge1xuXHRjb25zdHJ1Y3RvcigpIHtcblx0XHR0aGlzLl9xdWV1ZSA9IFtdO1xuXHR9XG5cblx0ZW5xdWV1ZShydW4sIG9wdGlvbnMpIHtcblx0XHRvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7XG5cdFx0XHRwcmlvcml0eTogMFxuXHRcdH0sIG9wdGlvbnMpO1xuXG5cdFx0Y29uc3QgZWxlbWVudCA9IHtwcmlvcml0eTogb3B0aW9ucy5wcmlvcml0eSwgcnVufTtcblxuXHRcdGlmICh0aGlzLnNpemUgJiYgdGhpcy5fcXVldWVbdGhpcy5zaXplIC0gMV0ucHJpb3JpdHkgPj0gb3B0aW9ucy5wcmlvcml0eSkge1xuXHRcdFx0dGhpcy5fcXVldWUucHVzaChlbGVtZW50KTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRjb25zdCBpbmRleCA9IGxvd2VyQm91bmQodGhpcy5fcXVldWUsIGVsZW1lbnQsIChhLCBiKSA9PiBiLnByaW9yaXR5IC0gYS5wcmlvcml0eSk7XG5cdFx0dGhpcy5fcXVldWUuc3BsaWNlKGluZGV4LCAwLCBlbGVtZW50KTtcblx0fVxuXG5cdGRlcXVldWUoKSB7XG5cdFx0cmV0dXJuIHRoaXMuX3F1ZXVlLnNoaWZ0KCkucnVuO1xuXHR9XG5cblx0Z2V0IHNpemUoKSB7XG5cdFx0cmV0dXJuIHRoaXMuX3F1ZXVlLmxlbmd0aDtcblx0fVxufVxuXG5jbGFzcyBQUXVldWUge1xuXHRjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG5cdFx0b3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe1xuXHRcdFx0Y2FycnlvdmVyQ29uY3VycmVuY3lDb3VudDogZmFsc2UsXG5cdFx0XHRpbnRlcnZhbENhcDogSW5maW5pdHksXG5cdFx0XHRpbnRlcnZhbDogMCxcblx0XHRcdGNvbmN1cnJlbmN5OiBJbmZpbml0eSxcblx0XHRcdGF1dG9TdGFydDogdHJ1ZSxcblx0XHRcdHF1ZXVlQ2xhc3M6IFByaW9yaXR5UXVldWVcblx0XHR9LCBvcHRpb25zKTtcblxuXHRcdGlmICghKHR5cGVvZiBvcHRpb25zLmNvbmN1cnJlbmN5ID09PSAnbnVtYmVyJyAmJiBvcHRpb25zLmNvbmN1cnJlbmN5ID49IDEpKSB7XG5cdFx0XHR0aHJvdyBuZXcgVHlwZUVycm9yKGBFeHBlY3RlZCBcXGBjb25jdXJyZW5jeVxcYCB0byBiZSBhIG51bWJlciBmcm9tIDEgYW5kIHVwLCBnb3QgXFxgJHtvcHRpb25zLmNvbmN1cnJlbmN5fVxcYCAoJHt0eXBlb2Ygb3B0aW9ucy5jb25jdXJyZW5jeX0pYCk7XG5cdFx0fVxuXG5cdFx0aWYgKCEodHlwZW9mIG9wdGlvbnMuaW50ZXJ2YWxDYXAgPT09ICdudW1iZXInICYmIG9wdGlvbnMuaW50ZXJ2YWxDYXAgPj0gMSkpIHtcblx0XHRcdHRocm93IG5ldyBUeXBlRXJyb3IoYEV4cGVjdGVkIFxcYGludGVydmFsQ2FwXFxgIHRvIGJlIGEgbnVtYmVyIGZyb20gMSBhbmQgdXAsIGdvdCBcXGAke29wdGlvbnMuaW50ZXJ2YWxDYXB9XFxgICgke3R5cGVvZiBvcHRpb25zLmludGVydmFsQ2FwfSlgKTtcblx0XHR9XG5cblx0XHRpZiAoISh0eXBlb2Ygb3B0aW9ucy5pbnRlcnZhbCA9PT0gJ251bWJlcicgJiYgTnVtYmVyLmlzRmluaXRlKG9wdGlvbnMuaW50ZXJ2YWwpICYmIG9wdGlvbnMuaW50ZXJ2YWwgPj0gMCkpIHtcblx0XHRcdHRocm93IG5ldyBUeXBlRXJyb3IoYEV4cGVjdGVkIFxcYGludGVydmFsXFxgIHRvIGJlIGEgZmluaXRlIG51bWJlciA+PSAwLCBnb3QgXFxgJHtvcHRpb25zLmludGVydmFsfVxcYCAoJHt0eXBlb2Ygb3B0aW9ucy5pbnRlcnZhbH0pYCk7XG5cdFx0fVxuXG5cdFx0dGhpcy5fY2FycnlvdmVyQ29uY3VycmVuY3lDb3VudCA9IG9wdGlvbnMuY2FycnlvdmVyQ29uY3VycmVuY3lDb3VudDtcblx0XHR0aGlzLl9pc0ludGVydmFsSWdub3JlZCA9IG9wdGlvbnMuaW50ZXJ2YWxDYXAgPT09IEluZmluaXR5IHx8IG9wdGlvbnMuaW50ZXJ2YWwgPT09IDA7XG5cdFx0dGhpcy5faW50ZXJ2YWxDb3VudCA9IDA7XG5cdFx0dGhpcy5faW50ZXJ2YWxDYXAgPSBvcHRpb25zLmludGVydmFsQ2FwO1xuXHRcdHRoaXMuX2ludGVydmFsID0gb3B0aW9ucy5pbnRlcnZhbDtcblx0XHR0aGlzLl9pbnRlcnZhbElkID0gbnVsbDtcblx0XHR0aGlzLl9pbnRlcnZhbEVuZCA9IDA7XG5cdFx0dGhpcy5fdGltZW91dElkID0gbnVsbDtcblxuXHRcdHRoaXMucXVldWUgPSBuZXcgb3B0aW9ucy5xdWV1ZUNsYXNzKCk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbmV3LWNhcFxuXHRcdHRoaXMuX3F1ZXVlQ2xhc3MgPSBvcHRpb25zLnF1ZXVlQ2xhc3M7XG5cdFx0dGhpcy5fcGVuZGluZ0NvdW50ID0gMDtcblx0XHR0aGlzLl9jb25jdXJyZW5jeSA9IG9wdGlvbnMuY29uY3VycmVuY3k7XG5cdFx0dGhpcy5faXNQYXVzZWQgPSBvcHRpb25zLmF1dG9TdGFydCA9PT0gZmFsc2U7XG5cdFx0dGhpcy5fcmVzb2x2ZUVtcHR5ID0gKCkgPT4ge307XG5cdFx0dGhpcy5fcmVzb2x2ZUlkbGUgPSAoKSA9PiB7fTtcblx0fVxuXG5cdGdldCBfZG9lc0ludGVydmFsQWxsb3dBbm90aGVyKCkge1xuXHRcdHJldHVybiB0aGlzLl9pc0ludGVydmFsSWdub3JlZCB8fCB0aGlzLl9pbnRlcnZhbENvdW50IDwgdGhpcy5faW50ZXJ2YWxDYXA7XG5cdH1cblxuXHRnZXQgX2RvZXNDb25jdXJyZW50QWxsb3dBbm90aGVyKCkge1xuXHRcdHJldHVybiB0aGlzLl9wZW5kaW5nQ291bnQgPCB0aGlzLl9jb25jdXJyZW5jeTtcblx0fVxuXG5cdF9uZXh0KCkge1xuXHRcdHRoaXMuX3BlbmRpbmdDb3VudC0tO1xuXHRcdHRoaXMuX3RyeVRvU3RhcnRBbm90aGVyKCk7XG5cdH1cblxuXHRfcmVzb2x2ZVByb21pc2VzKCkge1xuXHRcdHRoaXMuX3Jlc29sdmVFbXB0eSgpO1xuXHRcdHRoaXMuX3Jlc29sdmVFbXB0eSA9ICgpID0+IHt9O1xuXG5cdFx0aWYgKHRoaXMuX3BlbmRpbmdDb3VudCA9PT0gMCkge1xuXHRcdFx0dGhpcy5fcmVzb2x2ZUlkbGUoKTtcblx0XHRcdHRoaXMuX3Jlc29sdmVJZGxlID0gKCkgPT4ge307XG5cdFx0fVxuXHR9XG5cblx0X29uUmVzdW1lSW50ZXJ2YWwoKSB7XG5cdFx0dGhpcy5fb25JbnRlcnZhbCgpO1xuXHRcdHRoaXMuX2luaXRpYWxpemVJbnRlcnZhbElmTmVlZGVkKCk7XG5cdFx0dGhpcy5fdGltZW91dElkID0gbnVsbDtcblx0fVxuXG5cdF9pbnRlcnZhbFBhdXNlZCgpIHtcblx0XHRjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuXG5cdFx0aWYgKHRoaXMuX2ludGVydmFsSWQgPT09IG51bGwpIHtcblx0XHRcdGNvbnN0IGRlbGF5ID0gdGhpcy5faW50ZXJ2YWxFbmQgLSBub3c7XG5cdFx0XHRpZiAoZGVsYXkgPCAwKSB7XG5cdFx0XHRcdC8vIEFjdCBhcyB0aGUgaW50ZXJ2YWwgd2FzIGRvbmVcblx0XHRcdFx0Ly8gV2UgZG9uJ3QgbmVlZCB0byByZXN1bWUgaXQgaGVyZSxcblx0XHRcdFx0Ly8gYmVjYXVzZSBpdCdsbCBiZSByZXN1bWVkIG9uIGxpbmUgMTYwXG5cdFx0XHRcdHRoaXMuX2ludGVydmFsQ291bnQgPSAodGhpcy5fY2FycnlvdmVyQ29uY3VycmVuY3lDb3VudCkgPyB0aGlzLl9wZW5kaW5nQ291bnQgOiAwO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gQWN0IGFzIHRoZSBpbnRlcnZhbCBpcyBwZW5kaW5nXG5cdFx0XHRcdGlmICh0aGlzLl90aW1lb3V0SWQgPT09IG51bGwpIHtcblx0XHRcdFx0XHR0aGlzLl90aW1lb3V0SWQgPSBzZXRUaW1lb3V0KCgpID0+IHRoaXMuX29uUmVzdW1lSW50ZXJ2YWwoKSwgZGVsYXkpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG5cblx0X3RyeVRvU3RhcnRBbm90aGVyKCkge1xuXHRcdGlmICh0aGlzLnF1ZXVlLnNpemUgPT09IDApIHtcblx0XHRcdC8vIFdlIGNhbiBjbGVhciB0aGUgaW50ZXJ2YWwgKFwicGF1c2VcIilcblx0XHRcdC8vIGJlY2F1c2Ugd2UgY2FuIHJlZG8gaXQgbGF0ZXIgKFwicmVzdW1lXCIpXG5cdFx0XHRjbGVhckludGVydmFsKHRoaXMuX2ludGVydmFsSWQpO1xuXHRcdFx0dGhpcy5faW50ZXJ2YWxJZCA9IG51bGw7XG5cblx0XHRcdHRoaXMuX3Jlc29sdmVQcm9taXNlcygpO1xuXG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0aWYgKCF0aGlzLl9pc1BhdXNlZCkge1xuXHRcdFx0Y29uc3QgY2FuSW5pdGlhbGl6ZUludGVydmFsID0gIXRoaXMuX2ludGVydmFsUGF1c2VkKCk7XG5cdFx0XHRpZiAodGhpcy5fZG9lc0ludGVydmFsQWxsb3dBbm90aGVyICYmIHRoaXMuX2RvZXNDb25jdXJyZW50QWxsb3dBbm90aGVyKSB7XG5cdFx0XHRcdHRoaXMucXVldWUuZGVxdWV1ZSgpKCk7XG5cdFx0XHRcdGlmIChjYW5Jbml0aWFsaXplSW50ZXJ2YWwpIHtcblx0XHRcdFx0XHR0aGlzLl9pbml0aWFsaXplSW50ZXJ2YWxJZk5lZWRlZCgpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG5cblx0X2luaXRpYWxpemVJbnRlcnZhbElmTmVlZGVkKCkge1xuXHRcdGlmICh0aGlzLl9pc0ludGVydmFsSWdub3JlZCB8fCB0aGlzLl9pbnRlcnZhbElkICE9PSBudWxsKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0dGhpcy5faW50ZXJ2YWxJZCA9IHNldEludGVydmFsKCgpID0+IHRoaXMuX29uSW50ZXJ2YWwoKSwgdGhpcy5faW50ZXJ2YWwpO1xuXHRcdHRoaXMuX2ludGVydmFsRW5kID0gRGF0ZS5ub3coKSArIHRoaXMuX2ludGVydmFsO1xuXHR9XG5cblx0X29uSW50ZXJ2YWwoKSB7XG5cdFx0aWYgKHRoaXMuX2ludGVydmFsQ291bnQgPT09IDAgJiYgdGhpcy5fcGVuZGluZ0NvdW50ID09PSAwKSB7XG5cdFx0XHRjbGVhckludGVydmFsKHRoaXMuX2ludGVydmFsSWQpO1xuXHRcdFx0dGhpcy5faW50ZXJ2YWxJZCA9IG51bGw7XG5cdFx0fVxuXG5cdFx0dGhpcy5faW50ZXJ2YWxDb3VudCA9ICh0aGlzLl9jYXJyeW92ZXJDb25jdXJyZW5jeUNvdW50KSA/IHRoaXMuX3BlbmRpbmdDb3VudCA6IDA7XG5cdFx0d2hpbGUgKHRoaXMuX3RyeVRvU3RhcnRBbm90aGVyKCkpIHt9IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tZW1wdHlcblx0fVxuXG5cdGFkZChmbiwgb3B0aW9ucykge1xuXHRcdHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cdFx0XHRjb25zdCBydW4gPSAoKSA9PiB7XG5cdFx0XHRcdHRoaXMuX3BlbmRpbmdDb3VudCsrO1xuXHRcdFx0XHR0aGlzLl9pbnRlcnZhbENvdW50Kys7XG5cblx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRQcm9taXNlLnJlc29sdmUoZm4oKSkudGhlbihcblx0XHRcdFx0XHRcdHZhbCA9PiB7XG5cdFx0XHRcdFx0XHRcdHJlc29sdmUodmFsKTtcblx0XHRcdFx0XHRcdFx0dGhpcy5fbmV4dCgpO1xuXHRcdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRcdGVyciA9PiB7XG5cdFx0XHRcdFx0XHRcdHJlamVjdChlcnIpO1xuXHRcdFx0XHRcdFx0XHR0aGlzLl9uZXh0KCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0KTtcblx0XHRcdFx0fSBjYXRjaCAoZXJyKSB7XG5cdFx0XHRcdFx0cmVqZWN0KGVycik7XG5cdFx0XHRcdFx0dGhpcy5fbmV4dCgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9O1xuXG5cdFx0XHR0aGlzLnF1ZXVlLmVucXVldWUocnVuLCBvcHRpb25zKTtcblx0XHRcdHRoaXMuX3RyeVRvU3RhcnRBbm90aGVyKCk7XG5cdFx0fSk7XG5cdH1cblxuXHRhZGRBbGwoZm5zLCBvcHRpb25zKSB7XG5cdFx0cmV0dXJuIFByb21pc2UuYWxsKGZucy5tYXAoZm4gPT4gdGhpcy5hZGQoZm4sIG9wdGlvbnMpKSk7XG5cdH1cblxuXHRzdGFydCgpIHtcblx0XHRpZiAoIXRoaXMuX2lzUGF1c2VkKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0dGhpcy5faXNQYXVzZWQgPSBmYWxzZTtcblx0XHR3aGlsZSAodGhpcy5fdHJ5VG9TdGFydEFub3RoZXIoKSkge30gLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1lbXB0eVxuXHR9XG5cblx0cGF1c2UoKSB7XG5cdFx0dGhpcy5faXNQYXVzZWQgPSB0cnVlO1xuXHR9XG5cblx0Y2xlYXIoKSB7XG5cdFx0dGhpcy5xdWV1ZSA9IG5ldyB0aGlzLl9xdWV1ZUNsYXNzKCk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbmV3LWNhcFxuXHR9XG5cblx0b25FbXB0eSgpIHtcblx0XHQvLyBJbnN0YW50bHkgcmVzb2x2ZSBpZiB0aGUgcXVldWUgaXMgZW1wdHlcblx0XHRpZiAodGhpcy5xdWV1ZS5zaXplID09PSAwKSB7XG5cdFx0XHRyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuXHRcdFx0Y29uc3QgZXhpc3RpbmdSZXNvbHZlID0gdGhpcy5fcmVzb2x2ZUVtcHR5O1xuXHRcdFx0dGhpcy5fcmVzb2x2ZUVtcHR5ID0gKCkgPT4ge1xuXHRcdFx0XHRleGlzdGluZ1Jlc29sdmUoKTtcblx0XHRcdFx0cmVzb2x2ZSgpO1xuXHRcdFx0fTtcblx0XHR9KTtcblx0fVxuXG5cdG9uSWRsZSgpIHtcblx0XHQvLyBJbnN0YW50bHkgcmVzb2x2ZSBpZiBub25lIHBlbmRpbmcgYW5kIGlmIG5vdGhpbmcgZWxzZSBpcyBxdWV1ZWRcblx0XHRpZiAodGhpcy5fcGVuZGluZ0NvdW50ID09PSAwICYmIHRoaXMucXVldWUuc2l6ZSA9PT0gMCkge1xuXHRcdFx0cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuXHRcdH1cblxuXHRcdHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcblx0XHRcdGNvbnN0IGV4aXN0aW5nUmVzb2x2ZSA9IHRoaXMuX3Jlc29sdmVJZGxlO1xuXHRcdFx0dGhpcy5fcmVzb2x2ZUlkbGUgPSAoKSA9PiB7XG5cdFx0XHRcdGV4aXN0aW5nUmVzb2x2ZSgpO1xuXHRcdFx0XHRyZXNvbHZlKCk7XG5cdFx0XHR9O1xuXHRcdH0pO1xuXHR9XG5cblx0Z2V0IHNpemUoKSB7XG5cdFx0cmV0dXJuIHRoaXMucXVldWUuc2l6ZTtcblx0fVxuXG5cdGdldCBwZW5kaW5nKCkge1xuXHRcdHJldHVybiB0aGlzLl9wZW5kaW5nQ291bnQ7XG5cdH1cblxuXHRnZXQgaXNQYXVzZWQoKSB7XG5cdFx0cmV0dXJuIHRoaXMuX2lzUGF1c2VkO1xuXHR9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gUFF1ZXVlO1xuIiwiLy8gc2hpbSBmb3IgdXNpbmcgcHJvY2VzcyBpbiBicm93c2VyXG52YXIgcHJvY2VzcyA9IG1vZHVsZS5leHBvcnRzID0ge307XG5cbi8vIGNhY2hlZCBmcm9tIHdoYXRldmVyIGdsb2JhbCBpcyBwcmVzZW50IHNvIHRoYXQgdGVzdCBydW5uZXJzIHRoYXQgc3R1YiBpdFxuLy8gZG9uJ3QgYnJlYWsgdGhpbmdzLiAgQnV0IHdlIG5lZWQgdG8gd3JhcCBpdCBpbiBhIHRyeSBjYXRjaCBpbiBjYXNlIGl0IGlzXG4vLyB3cmFwcGVkIGluIHN0cmljdCBtb2RlIGNvZGUgd2hpY2ggZG9lc24ndCBkZWZpbmUgYW55IGdsb2JhbHMuICBJdCdzIGluc2lkZSBhXG4vLyBmdW5jdGlvbiBiZWNhdXNlIHRyeS9jYXRjaGVzIGRlb3B0aW1pemUgaW4gY2VydGFpbiBlbmdpbmVzLlxuXG52YXIgY2FjaGVkU2V0VGltZW91dDtcbnZhciBjYWNoZWRDbGVhclRpbWVvdXQ7XG5cbmZ1bmN0aW9uIGRlZmF1bHRTZXRUaW1vdXQoKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdzZXRUaW1lb3V0IGhhcyBub3QgYmVlbiBkZWZpbmVkJyk7XG59XG5mdW5jdGlvbiBkZWZhdWx0Q2xlYXJUaW1lb3V0ICgpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ2NsZWFyVGltZW91dCBoYXMgbm90IGJlZW4gZGVmaW5lZCcpO1xufVxuKGZ1bmN0aW9uICgpIHtcbiAgICB0cnkge1xuICAgICAgICBpZiAodHlwZW9mIHNldFRpbWVvdXQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBzZXRUaW1lb3V0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IGRlZmF1bHRTZXRUaW1vdXQ7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBkZWZhdWx0U2V0VGltb3V0O1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgICBpZiAodHlwZW9mIGNsZWFyVGltZW91dCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gY2xlYXJUaW1lb3V0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gZGVmYXVsdENsZWFyVGltZW91dDtcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gZGVmYXVsdENsZWFyVGltZW91dDtcbiAgICB9XG59ICgpKVxuZnVuY3Rpb24gcnVuVGltZW91dChmdW4pIHtcbiAgICBpZiAoY2FjaGVkU2V0VGltZW91dCA9PT0gc2V0VGltZW91dCkge1xuICAgICAgICAvL25vcm1hbCBlbnZpcm9tZW50cyBpbiBzYW5lIHNpdHVhdGlvbnNcbiAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuLCAwKTtcbiAgICB9XG4gICAgLy8gaWYgc2V0VGltZW91dCB3YXNuJ3QgYXZhaWxhYmxlIGJ1dCB3YXMgbGF0dGVyIGRlZmluZWRcbiAgICBpZiAoKGNhY2hlZFNldFRpbWVvdXQgPT09IGRlZmF1bHRTZXRUaW1vdXQgfHwgIWNhY2hlZFNldFRpbWVvdXQpICYmIHNldFRpbWVvdXQpIHtcbiAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IHNldFRpbWVvdXQ7XG4gICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1biwgMCk7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIC8vIHdoZW4gd2hlbiBzb21lYm9keSBoYXMgc2NyZXdlZCB3aXRoIHNldFRpbWVvdXQgYnV0IG5vIEkuRS4gbWFkZG5lc3NcbiAgICAgICAgcmV0dXJuIGNhY2hlZFNldFRpbWVvdXQoZnVuLCAwKTtcbiAgICB9IGNhdGNoKGUpe1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gV2hlbiB3ZSBhcmUgaW4gSS5FLiBidXQgdGhlIHNjcmlwdCBoYXMgYmVlbiBldmFsZWQgc28gSS5FLiBkb2Vzbid0IHRydXN0IHRoZSBnbG9iYWwgb2JqZWN0IHdoZW4gY2FsbGVkIG5vcm1hbGx5XG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dC5jYWxsKG51bGwsIGZ1biwgMCk7XG4gICAgICAgIH0gY2F0Y2goZSl7XG4gICAgICAgICAgICAvLyBzYW1lIGFzIGFib3ZlIGJ1dCB3aGVuIGl0J3MgYSB2ZXJzaW9uIG9mIEkuRS4gdGhhdCBtdXN0IGhhdmUgdGhlIGdsb2JhbCBvYmplY3QgZm9yICd0aGlzJywgaG9wZnVsbHkgb3VyIGNvbnRleHQgY29ycmVjdCBvdGhlcndpc2UgaXQgd2lsbCB0aHJvdyBhIGdsb2JhbCBlcnJvclxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZFNldFRpbWVvdXQuY2FsbCh0aGlzLCBmdW4sIDApO1xuICAgICAgICB9XG4gICAgfVxuXG5cbn1cbmZ1bmN0aW9uIHJ1bkNsZWFyVGltZW91dChtYXJrZXIpIHtcbiAgICBpZiAoY2FjaGVkQ2xlYXJUaW1lb3V0ID09PSBjbGVhclRpbWVvdXQpIHtcbiAgICAgICAgLy9ub3JtYWwgZW52aXJvbWVudHMgaW4gc2FuZSBzaXR1YXRpb25zXG4gICAgICAgIHJldHVybiBjbGVhclRpbWVvdXQobWFya2VyKTtcbiAgICB9XG4gICAgLy8gaWYgY2xlYXJUaW1lb3V0IHdhc24ndCBhdmFpbGFibGUgYnV0IHdhcyBsYXR0ZXIgZGVmaW5lZFxuICAgIGlmICgoY2FjaGVkQ2xlYXJUaW1lb3V0ID09PSBkZWZhdWx0Q2xlYXJUaW1lb3V0IHx8ICFjYWNoZWRDbGVhclRpbWVvdXQpICYmIGNsZWFyVGltZW91dCkge1xuICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBjbGVhclRpbWVvdXQ7XG4gICAgICAgIHJldHVybiBjbGVhclRpbWVvdXQobWFya2VyKTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgLy8gd2hlbiB3aGVuIHNvbWVib2R5IGhhcyBzY3Jld2VkIHdpdGggc2V0VGltZW91dCBidXQgbm8gSS5FLiBtYWRkbmVzc1xuICAgICAgICByZXR1cm4gY2FjaGVkQ2xlYXJUaW1lb3V0KG1hcmtlcik7XG4gICAgfSBjYXRjaCAoZSl7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBXaGVuIHdlIGFyZSBpbiBJLkUuIGJ1dCB0aGUgc2NyaXB0IGhhcyBiZWVuIGV2YWxlZCBzbyBJLkUuIGRvZXNuJ3QgIHRydXN0IHRoZSBnbG9iYWwgb2JqZWN0IHdoZW4gY2FsbGVkIG5vcm1hbGx5XG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkQ2xlYXJUaW1lb3V0LmNhbGwobnVsbCwgbWFya2VyKTtcbiAgICAgICAgfSBjYXRjaCAoZSl7XG4gICAgICAgICAgICAvLyBzYW1lIGFzIGFib3ZlIGJ1dCB3aGVuIGl0J3MgYSB2ZXJzaW9uIG9mIEkuRS4gdGhhdCBtdXN0IGhhdmUgdGhlIGdsb2JhbCBvYmplY3QgZm9yICd0aGlzJywgaG9wZnVsbHkgb3VyIGNvbnRleHQgY29ycmVjdCBvdGhlcndpc2UgaXQgd2lsbCB0aHJvdyBhIGdsb2JhbCBlcnJvci5cbiAgICAgICAgICAgIC8vIFNvbWUgdmVyc2lvbnMgb2YgSS5FLiBoYXZlIGRpZmZlcmVudCBydWxlcyBmb3IgY2xlYXJUaW1lb3V0IHZzIHNldFRpbWVvdXRcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRDbGVhclRpbWVvdXQuY2FsbCh0aGlzLCBtYXJrZXIpO1xuICAgICAgICB9XG4gICAgfVxuXG5cblxufVxudmFyIHF1ZXVlID0gW107XG52YXIgZHJhaW5pbmcgPSBmYWxzZTtcbnZhciBjdXJyZW50UXVldWU7XG52YXIgcXVldWVJbmRleCA9IC0xO1xuXG5mdW5jdGlvbiBjbGVhblVwTmV4dFRpY2soKSB7XG4gICAgaWYgKCFkcmFpbmluZyB8fCAhY3VycmVudFF1ZXVlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZHJhaW5pbmcgPSBmYWxzZTtcbiAgICBpZiAoY3VycmVudFF1ZXVlLmxlbmd0aCkge1xuICAgICAgICBxdWV1ZSA9IGN1cnJlbnRRdWV1ZS5jb25jYXQocXVldWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHF1ZXVlSW5kZXggPSAtMTtcbiAgICB9XG4gICAgaWYgKHF1ZXVlLmxlbmd0aCkge1xuICAgICAgICBkcmFpblF1ZXVlKCk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBkcmFpblF1ZXVlKCkge1xuICAgIGlmIChkcmFpbmluZykge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciB0aW1lb3V0ID0gcnVuVGltZW91dChjbGVhblVwTmV4dFRpY2spO1xuICAgIGRyYWluaW5nID0gdHJ1ZTtcblxuICAgIHZhciBsZW4gPSBxdWV1ZS5sZW5ndGg7XG4gICAgd2hpbGUobGVuKSB7XG4gICAgICAgIGN1cnJlbnRRdWV1ZSA9IHF1ZXVlO1xuICAgICAgICBxdWV1ZSA9IFtdO1xuICAgICAgICB3aGlsZSAoKytxdWV1ZUluZGV4IDwgbGVuKSB7XG4gICAgICAgICAgICBpZiAoY3VycmVudFF1ZXVlKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudFF1ZXVlW3F1ZXVlSW5kZXhdLnJ1bigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHF1ZXVlSW5kZXggPSAtMTtcbiAgICAgICAgbGVuID0gcXVldWUubGVuZ3RoO1xuICAgIH1cbiAgICBjdXJyZW50UXVldWUgPSBudWxsO1xuICAgIGRyYWluaW5nID0gZmFsc2U7XG4gICAgcnVuQ2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xufVxuXG5wcm9jZXNzLm5leHRUaWNrID0gZnVuY3Rpb24gKGZ1bikge1xuICAgIHZhciBhcmdzID0gbmV3IEFycmF5KGFyZ3VtZW50cy5sZW5ndGggLSAxKTtcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGFyZ3NbaSAtIDFdID0gYXJndW1lbnRzW2ldO1xuICAgICAgICB9XG4gICAgfVxuICAgIHF1ZXVlLnB1c2gobmV3IEl0ZW0oZnVuLCBhcmdzKSk7XG4gICAgaWYgKHF1ZXVlLmxlbmd0aCA9PT0gMSAmJiAhZHJhaW5pbmcpIHtcbiAgICAgICAgcnVuVGltZW91dChkcmFpblF1ZXVlKTtcbiAgICB9XG59O1xuXG4vLyB2OCBsaWtlcyBwcmVkaWN0aWJsZSBvYmplY3RzXG5mdW5jdGlvbiBJdGVtKGZ1biwgYXJyYXkpIHtcbiAgICB0aGlzLmZ1biA9IGZ1bjtcbiAgICB0aGlzLmFycmF5ID0gYXJyYXk7XG59XG5JdGVtLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5mdW4uYXBwbHkobnVsbCwgdGhpcy5hcnJheSk7XG59O1xucHJvY2Vzcy50aXRsZSA9ICdicm93c2VyJztcbnByb2Nlc3MuYnJvd3NlciA9IHRydWU7XG5wcm9jZXNzLmVudiA9IHt9O1xucHJvY2Vzcy5hcmd2ID0gW107XG5wcm9jZXNzLnZlcnNpb24gPSAnJzsgLy8gZW1wdHkgc3RyaW5nIHRvIGF2b2lkIHJlZ2V4cCBpc3N1ZXNcbnByb2Nlc3MudmVyc2lvbnMgPSB7fTtcblxuZnVuY3Rpb24gbm9vcCgpIHt9XG5cbnByb2Nlc3Mub24gPSBub29wO1xucHJvY2Vzcy5hZGRMaXN0ZW5lciA9IG5vb3A7XG5wcm9jZXNzLm9uY2UgPSBub29wO1xucHJvY2Vzcy5vZmYgPSBub29wO1xucHJvY2Vzcy5yZW1vdmVMaXN0ZW5lciA9IG5vb3A7XG5wcm9jZXNzLnJlbW92ZUFsbExpc3RlbmVycyA9IG5vb3A7XG5wcm9jZXNzLmVtaXQgPSBub29wO1xucHJvY2Vzcy5wcmVwZW5kTGlzdGVuZXIgPSBub29wO1xucHJvY2Vzcy5wcmVwZW5kT25jZUxpc3RlbmVyID0gbm9vcDtcblxucHJvY2Vzcy5saXN0ZW5lcnMgPSBmdW5jdGlvbiAobmFtZSkgeyByZXR1cm4gW10gfVxuXG5wcm9jZXNzLmJpbmRpbmcgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgIHRocm93IG5ldyBFcnJvcigncHJvY2Vzcy5iaW5kaW5nIGlzIG5vdCBzdXBwb3J0ZWQnKTtcbn07XG5cbnByb2Nlc3MuY3dkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gJy8nIH07XG5wcm9jZXNzLmNoZGlyID0gZnVuY3Rpb24gKGRpcikge1xuICAgIHRocm93IG5ldyBFcnJvcigncHJvY2Vzcy5jaGRpciBpcyBub3Qgc3VwcG9ydGVkJyk7XG59O1xucHJvY2Vzcy51bWFzayA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gMDsgfTtcbiIsIiFmdW5jdGlvbihlLHQpe1wib2JqZWN0XCI9PXR5cGVvZiBleHBvcnRzJiZcIm9iamVjdFwiPT10eXBlb2YgbW9kdWxlP21vZHVsZS5leHBvcnRzPXQoKTpcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFtdLHQpOlwib2JqZWN0XCI9PXR5cGVvZiBleHBvcnRzP2V4cG9ydHMuUHViTnViPXQoKTplLlB1Yk51Yj10KCl9KHRoaXMsZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdChyKXtpZihuW3JdKXJldHVybiBuW3JdLmV4cG9ydHM7dmFyIGk9bltyXT17ZXhwb3J0czp7fSxpZDpyLGxvYWRlZDohMX07cmV0dXJuIGVbcl0uY2FsbChpLmV4cG9ydHMsaSxpLmV4cG9ydHMsdCksaS5sb2FkZWQ9ITAsaS5leHBvcnRzfXZhciBuPXt9O3JldHVybiB0Lm09ZSx0LmM9bix0LnA9XCJcIix0KDApfShbZnVuY3Rpb24oZSx0LG4pe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIHIoZSl7cmV0dXJuIGUmJmUuX19lc01vZHVsZT9lOntkZWZhdWx0OmV9fWZ1bmN0aW9uIGkoZSx0KXtpZighKGUgaW5zdGFuY2VvZiB0KSl0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpfWZ1bmN0aW9uIHMoZSx0KXtpZighZSl0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7cmV0dXJuIXR8fFwib2JqZWN0XCIhPXR5cGVvZiB0JiZcImZ1bmN0aW9uXCIhPXR5cGVvZiB0P2U6dH1mdW5jdGlvbiBvKGUsdCl7aWYoXCJmdW5jdGlvblwiIT10eXBlb2YgdCYmbnVsbCE9PXQpdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIrdHlwZW9mIHQpO2UucHJvdG90eXBlPU9iamVjdC5jcmVhdGUodCYmdC5wcm90b3R5cGUse2NvbnN0cnVjdG9yOnt2YWx1ZTplLGVudW1lcmFibGU6ITEsd3JpdGFibGU6ITAsY29uZmlndXJhYmxlOiEwfX0pLHQmJihPYmplY3Quc2V0UHJvdG90eXBlT2Y/T2JqZWN0LnNldFByb3RvdHlwZU9mKGUsdCk6ZS5fX3Byb3RvX189dCl9ZnVuY3Rpb24gYShlKXtpZighbmF2aWdhdG9yfHwhbmF2aWdhdG9yLnNlbmRCZWFjb24pcmV0dXJuITE7bmF2aWdhdG9yLnNlbmRCZWFjb24oZSl9T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSk7dmFyIHU9bigxKSxjPXIodSksbD1uKDM5KSxoPXIobCksZj1uKDQwKSxwPXIoZiksZD1uKDQxKSx5PShuKDUpLGZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQoZSl7aSh0aGlzLHQpO3ZhciBuPWUubGlzdGVuVG9Ccm93c2VyTmV0d29ya0V2ZW50cyxyPXZvaWQgMD09PW58fG47ZS5kYj1wLmRlZmF1bHQsZS5zZGtGYW1pbHk9XCJXZWJcIixlLm5ldHdvcmtpbmc9bmV3IGguZGVmYXVsdCh7ZGVsOmQuZGVsLGdldDpkLmdldCxwb3N0OmQucG9zdCxzZW5kQmVhY29uOmF9KTt2YXIgbz1zKHRoaXMsKHQuX19wcm90b19ffHxPYmplY3QuZ2V0UHJvdG90eXBlT2YodCkpLmNhbGwodGhpcyxlKSk7cmV0dXJuIHImJih3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm9mZmxpbmVcIixmdW5jdGlvbigpe28ubmV0d29ya0Rvd25EZXRlY3RlZCgpfSksd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJvbmxpbmVcIixmdW5jdGlvbigpe28ubmV0d29ya1VwRGV0ZWN0ZWQoKX0pKSxvfXJldHVybiBvKHQsZSksdH0oYy5kZWZhdWx0KSk7dC5kZWZhdWx0PXksZS5leHBvcnRzPXQuZGVmYXVsdH0sZnVuY3Rpb24oZSx0LG4pe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIHIoZSl7aWYoZSYmZS5fX2VzTW9kdWxlKXJldHVybiBlO3ZhciB0PXt9O2lmKG51bGwhPWUpZm9yKHZhciBuIGluIGUpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsbikmJih0W25dPWVbbl0pO3JldHVybiB0LmRlZmF1bHQ9ZSx0fWZ1bmN0aW9uIGkoZSl7cmV0dXJuIGUmJmUuX19lc01vZHVsZT9lOntkZWZhdWx0OmV9fWZ1bmN0aW9uIHMoZSx0KXtpZighKGUgaW5zdGFuY2VvZiB0KSl0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpfU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pO3ZhciBvPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlLHQpe2Zvcih2YXIgbj0wO248dC5sZW5ndGg7bisrKXt2YXIgcj10W25dO3IuZW51bWVyYWJsZT1yLmVudW1lcmFibGV8fCExLHIuY29uZmlndXJhYmxlPSEwLFwidmFsdWVcImluIHImJihyLndyaXRhYmxlPSEwKSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxyLmtleSxyKX19cmV0dXJuIGZ1bmN0aW9uKHQsbixyKXtyZXR1cm4gbiYmZSh0LnByb3RvdHlwZSxuKSxyJiZlKHQsciksdH19KCksYT1uKDIpLHU9aShhKSxjPW4oNiksbD1pKGMpLGg9big4KSxmPWkoaCkscD1uKDkpLGQ9aShwKSx5PW4oMTYpLGc9aSh5KSxiPW4oMTcpLF89cihiKSx2PW4oMTgpLG09cih2KSxrPW4oMTkpLFA9cihrKSxPPW4oMjApLHc9cihPKSxUPW4oMjEpLFM9cihUKSxDPW4oMjIpLE09cihDKSxFPW4oMjMpLHg9cihFKSxOPW4oMjQpLFI9cihOKSxBPW4oMjUpLEQ9cihBKSxLPW4oMjYpLGo9cihLKSxHPW4oMjcpLFU9cihHKSxJPW4oMjgpLEg9cihJKSxCPW4oMjkpLEw9cihCKSxxPW4oMzApLEY9cihxKSx6PW4oMzEpLFg9cih6KSxXPW4oMzIpLEo9cihXKSxWPW4oMzMpLCQ9cihWKSxRPW4oMzQpLFk9cihRKSxaPW4oMzUpLGVlPXIoWiksdGU9bigzNiksbmU9cih0ZSkscmU9bigzNyksaWU9cihyZSksc2U9bigxMiksb2U9cihzZSksYWU9bigzOCksdWU9cihhZSksY2U9bigxMyksbGU9aShjZSksaGU9bigxMCksZmU9aShoZSkscGU9KG4oNSksbigzKSksZGU9aShwZSkseWU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQpe3ZhciBuPXRoaXM7cyh0aGlzLGUpO3ZhciByPXQuZGIsaT10Lm5ldHdvcmtpbmcsbz10aGlzLl9jb25maWc9bmV3IHUuZGVmYXVsdCh7c2V0dXA6dCxkYjpyfSksYT1uZXcgbC5kZWZhdWx0KHtjb25maWc6b30pO2kuaW5pdChvKTt2YXIgYz17Y29uZmlnOm8sbmV0d29ya2luZzppLGNyeXB0bzphfSxoPWcuZGVmYXVsdC5iaW5kKHRoaXMsYyxvZSkscD1nLmRlZmF1bHQuYmluZCh0aGlzLGMsaikseT1nLmRlZmF1bHQuYmluZCh0aGlzLGMsSCksYj1nLmRlZmF1bHQuYmluZCh0aGlzLGMsRiksdj1nLmRlZmF1bHQuYmluZCh0aGlzLGMsdWUpLGs9dGhpcy5fbGlzdGVuZXJNYW5hZ2VyPW5ldyBkLmRlZmF1bHQsTz1uZXcgZi5kZWZhdWx0KHt0aW1lRW5kcG9pbnQ6aCxsZWF2ZUVuZHBvaW50OnAsaGVhcnRiZWF0RW5kcG9pbnQ6eSxzZXRTdGF0ZUVuZHBvaW50OmIsc3Vic2NyaWJlRW5kcG9pbnQ6dixjcnlwdG86Yy5jcnlwdG8sY29uZmlnOmMuY29uZmlnLGxpc3RlbmVyTWFuYWdlcjprfSk7dGhpcy5hZGRMaXN0ZW5lcj1rLmFkZExpc3RlbmVyLmJpbmQoayksdGhpcy5yZW1vdmVMaXN0ZW5lcj1rLnJlbW92ZUxpc3RlbmVyLmJpbmQoayksdGhpcy5yZW1vdmVBbGxMaXN0ZW5lcnM9ay5yZW1vdmVBbGxMaXN0ZW5lcnMuYmluZChrKSx0aGlzLmNoYW5uZWxHcm91cHM9e2xpc3RHcm91cHM6Zy5kZWZhdWx0LmJpbmQodGhpcyxjLHcpLGxpc3RDaGFubmVsczpnLmRlZmF1bHQuYmluZCh0aGlzLGMsUyksYWRkQ2hhbm5lbHM6Zy5kZWZhdWx0LmJpbmQodGhpcyxjLF8pLHJlbW92ZUNoYW5uZWxzOmcuZGVmYXVsdC5iaW5kKHRoaXMsYyxtKSxkZWxldGVHcm91cDpnLmRlZmF1bHQuYmluZCh0aGlzLGMsUCl9LHRoaXMucHVzaD17YWRkQ2hhbm5lbHM6Zy5kZWZhdWx0LmJpbmQodGhpcyxjLE0pLHJlbW92ZUNoYW5uZWxzOmcuZGVmYXVsdC5iaW5kKHRoaXMsYyx4KSxkZWxldGVEZXZpY2U6Zy5kZWZhdWx0LmJpbmQodGhpcyxjLEQpLGxpc3RDaGFubmVsczpnLmRlZmF1bHQuYmluZCh0aGlzLGMsUil9LHRoaXMuaGVyZU5vdz1nLmRlZmF1bHQuYmluZCh0aGlzLGMsWCksdGhpcy53aGVyZU5vdz1nLmRlZmF1bHQuYmluZCh0aGlzLGMsVSksdGhpcy5nZXRTdGF0ZT1nLmRlZmF1bHQuYmluZCh0aGlzLGMsTCksdGhpcy5zZXRTdGF0ZT1PLmFkYXB0U3RhdGVDaGFuZ2UuYmluZChPKSx0aGlzLmdyYW50PWcuZGVmYXVsdC5iaW5kKHRoaXMsYywkKSx0aGlzLmF1ZGl0PWcuZGVmYXVsdC5iaW5kKHRoaXMsYyxKKSx0aGlzLnB1Ymxpc2g9Zy5kZWZhdWx0LmJpbmQodGhpcyxjLFkpLHRoaXMuZmlyZT1mdW5jdGlvbihlLHQpe3JldHVybiBlLnJlcGxpY2F0ZT0hMSxlLnN0b3JlSW5IaXN0b3J5PSExLG4ucHVibGlzaChlLHQpfSx0aGlzLmhpc3Rvcnk9Zy5kZWZhdWx0LmJpbmQodGhpcyxjLGVlKSx0aGlzLmRlbGV0ZU1lc3NhZ2VzPWcuZGVmYXVsdC5iaW5kKHRoaXMsYyxuZSksdGhpcy5mZXRjaE1lc3NhZ2VzPWcuZGVmYXVsdC5iaW5kKHRoaXMsYyxpZSksdGhpcy50aW1lPWgsdGhpcy5zdWJzY3JpYmU9Ty5hZGFwdFN1YnNjcmliZUNoYW5nZS5iaW5kKE8pLHRoaXMucHJlc2VuY2U9Ty5hZGFwdFByZXNlbmNlQ2hhbmdlLmJpbmQoTyksdGhpcy51bnN1YnNjcmliZT1PLmFkYXB0VW5zdWJzY3JpYmVDaGFuZ2UuYmluZChPKSx0aGlzLmRpc2Nvbm5lY3Q9Ty5kaXNjb25uZWN0LmJpbmQoTyksdGhpcy5yZWNvbm5lY3Q9Ty5yZWNvbm5lY3QuYmluZChPKSx0aGlzLmRlc3Ryb3k9ZnVuY3Rpb24oZSl7Ty51bnN1YnNjcmliZUFsbChlKSxPLmRpc2Nvbm5lY3QoKX0sdGhpcy5zdG9wPXRoaXMuZGVzdHJveSx0aGlzLnVuc3Vic2NyaWJlQWxsPU8udW5zdWJzY3JpYmVBbGwuYmluZChPKSx0aGlzLmdldFN1YnNjcmliZWRDaGFubmVscz1PLmdldFN1YnNjcmliZWRDaGFubmVscy5iaW5kKE8pLHRoaXMuZ2V0U3Vic2NyaWJlZENoYW5uZWxHcm91cHM9Ty5nZXRTdWJzY3JpYmVkQ2hhbm5lbEdyb3Vwcy5iaW5kKE8pLHRoaXMuZW5jcnlwdD1hLmVuY3J5cHQuYmluZChhKSx0aGlzLmRlY3J5cHQ9YS5kZWNyeXB0LmJpbmQoYSksdGhpcy5nZXRBdXRoS2V5PWMuY29uZmlnLmdldEF1dGhLZXkuYmluZChjLmNvbmZpZyksdGhpcy5zZXRBdXRoS2V5PWMuY29uZmlnLnNldEF1dGhLZXkuYmluZChjLmNvbmZpZyksdGhpcy5zZXRDaXBoZXJLZXk9Yy5jb25maWcuc2V0Q2lwaGVyS2V5LmJpbmQoYy5jb25maWcpLHRoaXMuZ2V0VVVJRD1jLmNvbmZpZy5nZXRVVUlELmJpbmQoYy5jb25maWcpLHRoaXMuc2V0VVVJRD1jLmNvbmZpZy5zZXRVVUlELmJpbmQoYy5jb25maWcpLHRoaXMuZ2V0RmlsdGVyRXhwcmVzc2lvbj1jLmNvbmZpZy5nZXRGaWx0ZXJFeHByZXNzaW9uLmJpbmQoYy5jb25maWcpLHRoaXMuc2V0RmlsdGVyRXhwcmVzc2lvbj1jLmNvbmZpZy5zZXRGaWx0ZXJFeHByZXNzaW9uLmJpbmQoYy5jb25maWcpLHRoaXMuc2V0SGVhcnRiZWF0SW50ZXJ2YWw9Yy5jb25maWcuc2V0SGVhcnRiZWF0SW50ZXJ2YWwuYmluZChjLmNvbmZpZyksaS5oYXNNb2R1bGUoXCJwcm94eVwiKSYmKHRoaXMuc2V0UHJveHk9ZnVuY3Rpb24oZSl7Yy5jb25maWcuc2V0UHJveHkoZSksbi5yZWNvbm5lY3QoKX0pfXJldHVybiBvKGUsW3trZXk6XCJnZXRWZXJzaW9uXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fY29uZmlnLmdldFZlcnNpb24oKX19LHtrZXk6XCJuZXR3b3JrRG93bkRldGVjdGVkXCIsdmFsdWU6ZnVuY3Rpb24oKXt0aGlzLl9saXN0ZW5lck1hbmFnZXIuYW5ub3VuY2VOZXR3b3JrRG93bigpLHRoaXMuX2NvbmZpZy5yZXN0b3JlP3RoaXMuZGlzY29ubmVjdCgpOnRoaXMuZGVzdHJveSghMCl9fSx7a2V5OlwibmV0d29ya1VwRGV0ZWN0ZWRcIix2YWx1ZTpmdW5jdGlvbigpe3RoaXMuX2xpc3RlbmVyTWFuYWdlci5hbm5vdW5jZU5ldHdvcmtVcCgpLHRoaXMucmVjb25uZWN0KCl9fV0sW3trZXk6XCJnZW5lcmF0ZVVVSURcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiBkZS5kZWZhdWx0LmNyZWF0ZVVVSUQoKX19XSksZX0oKTt5ZS5PUEVSQVRJT05TPWxlLmRlZmF1bHQseWUuQ0FURUdPUklFUz1mZS5kZWZhdWx0LHQuZGVmYXVsdD15ZSxlLmV4cG9ydHM9dC5kZWZhdWx0fSxmdW5jdGlvbihlLHQsbil7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gcihlLHQpe2lmKCEoZSBpbnN0YW5jZW9mIHQpKXRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIil9T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSk7dmFyIGk9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUsdCl7Zm9yKHZhciBuPTA7bjx0Lmxlbmd0aDtuKyspe3ZhciByPXRbbl07ci5lbnVtZXJhYmxlPXIuZW51bWVyYWJsZXx8ITEsci5jb25maWd1cmFibGU9ITAsXCJ2YWx1ZVwiaW4gciYmKHIud3JpdGFibGU9ITApLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHIua2V5LHIpfX1yZXR1cm4gZnVuY3Rpb24odCxuLHIpe3JldHVybiBuJiZlKHQucHJvdG90eXBlLG4pLHImJmUodCxyKSx0fX0oKSxzPW4oMyksbz1mdW5jdGlvbihlKXtyZXR1cm4gZSYmZS5fX2VzTW9kdWxlP2U6e2RlZmF1bHQ6ZX19KHMpLGE9KG4oNSksZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQpe3ZhciBuPXQuc2V0dXAsaT10LmRiO3IodGhpcyxlKSx0aGlzLl9kYj1pLHRoaXMuaW5zdGFuY2VJZD1cInBuLVwiK28uZGVmYXVsdC5jcmVhdGVVVUlEKCksdGhpcy5zZWNyZXRLZXk9bi5zZWNyZXRLZXl8fG4uc2VjcmV0X2tleSx0aGlzLnN1YnNjcmliZUtleT1uLnN1YnNjcmliZUtleXx8bi5zdWJzY3JpYmVfa2V5LHRoaXMucHVibGlzaEtleT1uLnB1Ymxpc2hLZXl8fG4ucHVibGlzaF9rZXksdGhpcy5zZGtOYW1lPW4uc2RrTmFtZSx0aGlzLnNka0ZhbWlseT1uLnNka0ZhbWlseSx0aGlzLnBhcnRuZXJJZD1uLnBhcnRuZXJJZCx0aGlzLnNldEF1dGhLZXkobi5hdXRoS2V5KSx0aGlzLnNldENpcGhlcktleShuLmNpcGhlcktleSksdGhpcy5zZXRGaWx0ZXJFeHByZXNzaW9uKG4uZmlsdGVyRXhwcmVzc2lvbiksdGhpcy5vcmlnaW49bi5vcmlnaW58fFwicHVic3ViLnBuZHNuLmNvbVwiLHRoaXMuc2VjdXJlPW4uc3NsfHwhMSx0aGlzLnJlc3RvcmU9bi5yZXN0b3JlfHwhMSx0aGlzLnByb3h5PW4ucHJveHksdGhpcy5rZWVwQWxpdmU9bi5rZWVwQWxpdmUsdGhpcy5rZWVwQWxpdmVTZXR0aW5ncz1uLmtlZXBBbGl2ZVNldHRpbmdzLHRoaXMuYXV0b05ldHdvcmtEZXRlY3Rpb249bi5hdXRvTmV0d29ya0RldGVjdGlvbnx8ITEsdGhpcy5kZWR1cGVPblN1YnNjcmliZT1uLmRlZHVwZU9uU3Vic2NyaWJlfHwhMSx0aGlzLm1heGltdW1DYWNoZVNpemU9bi5tYXhpbXVtQ2FjaGVTaXplfHwxMDAsdGhpcy5jdXN0b21FbmNyeXB0PW4uY3VzdG9tRW5jcnlwdCx0aGlzLmN1c3RvbURlY3J5cHQ9bi5jdXN0b21EZWNyeXB0LFwidW5kZWZpbmVkXCIhPXR5cGVvZiBsb2NhdGlvbiYmXCJodHRwczpcIj09PWxvY2F0aW9uLnByb3RvY29sJiYodGhpcy5zZWN1cmU9ITApLHRoaXMubG9nVmVyYm9zaXR5PW4ubG9nVmVyYm9zaXR5fHwhMSx0aGlzLnN1cHByZXNzTGVhdmVFdmVudHM9bi5zdXBwcmVzc0xlYXZlRXZlbnRzfHwhMSx0aGlzLmFubm91bmNlRmFpbGVkSGVhcnRiZWF0cz1uLmFubm91bmNlRmFpbGVkSGVhcnRiZWF0c3x8ITAsdGhpcy5hbm5vdW5jZVN1Y2Nlc3NmdWxIZWFydGJlYXRzPW4uYW5ub3VuY2VTdWNjZXNzZnVsSGVhcnRiZWF0c3x8ITEsdGhpcy51c2VJbnN0YW5jZUlkPW4udXNlSW5zdGFuY2VJZHx8ITEsdGhpcy51c2VSZXF1ZXN0SWQ9bi51c2VSZXF1ZXN0SWR8fCExLHRoaXMucmVxdWVzdE1lc3NhZ2VDb3VudFRocmVzaG9sZD1uLnJlcXVlc3RNZXNzYWdlQ291bnRUaHJlc2hvbGQsdGhpcy5zZXRUcmFuc2FjdGlvblRpbWVvdXQobi50cmFuc2FjdGlvbmFsUmVxdWVzdFRpbWVvdXR8fDE1ZTMpLHRoaXMuc2V0U3Vic2NyaWJlVGltZW91dChuLnN1YnNjcmliZVJlcXVlc3RUaW1lb3V0fHwzMWU0KSx0aGlzLnNldFNlbmRCZWFjb25Db25maWcobi51c2VTZW5kQmVhY29ufHwhMCksdGhpcy5zZXRQcmVzZW5jZVRpbWVvdXQobi5wcmVzZW5jZVRpbWVvdXR8fDMwMCksbnVsbCE9bi5oZWFydGJlYXRJbnRlcnZhbCYmdGhpcy5zZXRIZWFydGJlYXRJbnRlcnZhbChuLmhlYXJ0YmVhdEludGVydmFsKSx0aGlzLnNldFVVSUQodGhpcy5fZGVjaWRlVVVJRChuLnV1aWQpKX1yZXR1cm4gaShlLFt7a2V5OlwiZ2V0QXV0aEtleVwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYXV0aEtleX19LHtrZXk6XCJzZXRBdXRoS2V5XCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuYXV0aEtleT1lLHRoaXN9fSx7a2V5Olwic2V0Q2lwaGVyS2V5XCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuY2lwaGVyS2V5PWUsdGhpc319LHtrZXk6XCJnZXRVVUlEXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5VVUlEfX0se2tleTpcInNldFVVSURcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fZGImJnRoaXMuX2RiLnNldCYmdGhpcy5fZGIuc2V0KHRoaXMuc3Vic2NyaWJlS2V5K1widXVpZFwiLGUpLHRoaXMuVVVJRD1lLHRoaXN9fSx7a2V5OlwiZ2V0RmlsdGVyRXhwcmVzc2lvblwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZmlsdGVyRXhwcmVzc2lvbn19LHtrZXk6XCJzZXRGaWx0ZXJFeHByZXNzaW9uXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuZmlsdGVyRXhwcmVzc2lvbj1lLHRoaXN9fSx7a2V5OlwiZ2V0UHJlc2VuY2VUaW1lb3V0XCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcHJlc2VuY2VUaW1lb3V0fX0se2tleTpcInNldFByZXNlbmNlVGltZW91dFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9wcmVzZW5jZVRpbWVvdXQ9ZSx0aGlzLnNldEhlYXJ0YmVhdEludGVydmFsKHRoaXMuX3ByZXNlbmNlVGltZW91dC8yLTEpLHRoaXN9fSx7a2V5Olwic2V0UHJveHlcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLnByb3h5PWV9fSx7a2V5OlwiZ2V0SGVhcnRiZWF0SW50ZXJ2YWxcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9oZWFydGJlYXRJbnRlcnZhbH19LHtrZXk6XCJzZXRIZWFydGJlYXRJbnRlcnZhbFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9oZWFydGJlYXRJbnRlcnZhbD1lLHRoaXN9fSx7a2V5OlwiZ2V0U3Vic2NyaWJlVGltZW91dFwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3N1YnNjcmliZVJlcXVlc3RUaW1lb3V0fX0se2tleTpcInNldFN1YnNjcmliZVRpbWVvdXRcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fc3Vic2NyaWJlUmVxdWVzdFRpbWVvdXQ9ZSx0aGlzfX0se2tleTpcImdldFRyYW5zYWN0aW9uVGltZW91dFwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3RyYW5zYWN0aW9uYWxSZXF1ZXN0VGltZW91dH19LHtrZXk6XCJzZXRUcmFuc2FjdGlvblRpbWVvdXRcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fdHJhbnNhY3Rpb25hbFJlcXVlc3RUaW1lb3V0PWUsdGhpc319LHtrZXk6XCJpc1NlbmRCZWFjb25FbmFibGVkXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fdXNlU2VuZEJlYWNvbn19LHtrZXk6XCJzZXRTZW5kQmVhY29uQ29uZmlnXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX3VzZVNlbmRCZWFjb249ZSx0aGlzfX0se2tleTpcImdldFZlcnNpb25cIix2YWx1ZTpmdW5jdGlvbigpe3JldHVyblwiNC4yMS42XCJ9fSx7a2V5OlwiX2RlY2lkZVVVSURcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gZXx8KHRoaXMuX2RiJiZ0aGlzLl9kYi5nZXQmJnRoaXMuX2RiLmdldCh0aGlzLnN1YnNjcmliZUtleStcInV1aWRcIik/dGhpcy5fZGIuZ2V0KHRoaXMuc3Vic2NyaWJlS2V5K1widXVpZFwiKTpcInBuLVwiK28uZGVmYXVsdC5jcmVhdGVVVUlEKCkpfX1dKSxlfSgpKTt0LmRlZmF1bHQ9YSxlLmV4cG9ydHM9dC5kZWZhdWx0fSxmdW5jdGlvbihlLHQsbil7XCJ1c2Ugc3RyaWN0XCI7T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSk7dmFyIHI9big0KSxpPWZ1bmN0aW9uKGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7ZGVmYXVsdDplfX0ocik7dC5kZWZhdWx0PXtjcmVhdGVVVUlEOmZ1bmN0aW9uKCl7cmV0dXJuIGkuZGVmYXVsdC51dWlkP2kuZGVmYXVsdC51dWlkKCk6KDAsaS5kZWZhdWx0KSgpfX0sZS5leHBvcnRzPXQuZGVmYXVsdH0sZnVuY3Rpb24oZSx0LG4pe3ZhciByLGksczshZnVuY3Rpb24obixvKXtpPVt0XSxyPW8sdm9pZCAwIT09KHM9XCJmdW5jdGlvblwiPT10eXBlb2Ygcj9yLmFwcGx5KHQsaSk6cikmJihlLmV4cG9ydHM9cyl9KDAsZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdCgpe3ZhciBlLHQsbj1cIlwiO2ZvcihlPTA7ZTwzMjtlKyspdD0xNipNYXRoLnJhbmRvbSgpfDAsOCE9PWUmJjEyIT09ZSYmMTYhPT1lJiYyMCE9PWV8fChuKz1cIi1cIiksbis9KDEyPT09ZT80OjE2PT09ZT8zJnR8ODp0KS50b1N0cmluZygxNik7cmV0dXJuIG59ZnVuY3Rpb24gbihlLHQpe3ZhciBuPXJbdHx8XCJhbGxcIl07cmV0dXJuIG4mJm4udGVzdChlKXx8ITF9dmFyIHI9ezM6L15bMC05QS1GXXs4fS1bMC05QS1GXXs0fS0zWzAtOUEtRl17M30tWzAtOUEtRl17NH0tWzAtOUEtRl17MTJ9JC9pLDQ6L15bMC05QS1GXXs4fS1bMC05QS1GXXs0fS00WzAtOUEtRl17M30tWzg5QUJdWzAtOUEtRl17M30tWzAtOUEtRl17MTJ9JC9pLDU6L15bMC05QS1GXXs4fS1bMC05QS1GXXs0fS01WzAtOUEtRl17M30tWzg5QUJdWzAtOUEtRl17M30tWzAtOUEtRl17MTJ9JC9pLGFsbDovXlswLTlBLUZdezh9LVswLTlBLUZdezR9LVswLTlBLUZdezR9LVswLTlBLUZdezR9LVswLTlBLUZdezEyfSQvaX07dC5pc1VVSUQ9bix0LlZFUlNJT049XCIwLjEuMFwiLGUudXVpZD10LGUuaXNVVUlEPW59KX0sZnVuY3Rpb24oZSx0KXtcInVzZSBzdHJpY3RcIjtlLmV4cG9ydHM9e319LGZ1bmN0aW9uKGUsdCxuKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiByKGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7ZGVmYXVsdDplfX1mdW5jdGlvbiBpKGUsdCl7aWYoIShlIGluc3RhbmNlb2YgdCkpdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKX1PYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KTt2YXIgcz1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSx0KXtmb3IodmFyIG49MDtuPHQubGVuZ3RoO24rKyl7dmFyIHI9dFtuXTtyLmVudW1lcmFibGU9ci5lbnVtZXJhYmxlfHwhMSxyLmNvbmZpZ3VyYWJsZT0hMCxcInZhbHVlXCJpbiByJiYoci53cml0YWJsZT0hMCksT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsci5rZXkscil9fXJldHVybiBmdW5jdGlvbih0LG4scil7cmV0dXJuIG4mJmUodC5wcm90b3R5cGUsbiksciYmZSh0LHIpLHR9fSgpLG89bigyKSxhPShyKG8pLG4oNykpLHU9cihhKSxjPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0KXt2YXIgbj10LmNvbmZpZztpKHRoaXMsZSksdGhpcy5fY29uZmlnPW4sdGhpcy5faXY9XCIwMTIzNDU2Nzg5MDEyMzQ1XCIsdGhpcy5fYWxsb3dlZEtleUVuY29kaW5ncz1bXCJoZXhcIixcInV0ZjhcIixcImJhc2U2NFwiLFwiYmluYXJ5XCJdLHRoaXMuX2FsbG93ZWRLZXlMZW5ndGhzPVsxMjgsMjU2XSx0aGlzLl9hbGxvd2VkTW9kZXM9W1wiZWNiXCIsXCJjYmNcIl0sdGhpcy5fZGVmYXVsdE9wdGlvbnM9e2VuY3J5cHRLZXk6ITAsa2V5RW5jb2Rpbmc6XCJ1dGY4XCIsa2V5TGVuZ3RoOjI1Nixtb2RlOlwiY2JjXCJ9fXJldHVybiBzKGUsW3trZXk6XCJITUFDU0hBMjU2XCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHUuZGVmYXVsdC5IbWFjU0hBMjU2KGUsdGhpcy5fY29uZmlnLnNlY3JldEtleSkudG9TdHJpbmcodS5kZWZhdWx0LmVuYy5CYXNlNjQpfX0se2tleTpcIlNIQTI1NlwiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiB1LmRlZmF1bHQuU0hBMjU2KGUpLnRvU3RyaW5nKHUuZGVmYXVsdC5lbmMuSGV4KX19LHtrZXk6XCJfcGFyc2VPcHRpb25zXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZXx8e307cmV0dXJuIHQuaGFzT3duUHJvcGVydHkoXCJlbmNyeXB0S2V5XCIpfHwodC5lbmNyeXB0S2V5PXRoaXMuX2RlZmF1bHRPcHRpb25zLmVuY3J5cHRLZXkpLHQuaGFzT3duUHJvcGVydHkoXCJrZXlFbmNvZGluZ1wiKXx8KHQua2V5RW5jb2Rpbmc9dGhpcy5fZGVmYXVsdE9wdGlvbnMua2V5RW5jb2RpbmcpLHQuaGFzT3duUHJvcGVydHkoXCJrZXlMZW5ndGhcIil8fCh0LmtleUxlbmd0aD10aGlzLl9kZWZhdWx0T3B0aW9ucy5rZXlMZW5ndGgpLHQuaGFzT3duUHJvcGVydHkoXCJtb2RlXCIpfHwodC5tb2RlPXRoaXMuX2RlZmF1bHRPcHRpb25zLm1vZGUpLC0xPT09dGhpcy5fYWxsb3dlZEtleUVuY29kaW5ncy5pbmRleE9mKHQua2V5RW5jb2RpbmcudG9Mb3dlckNhc2UoKSkmJih0LmtleUVuY29kaW5nPXRoaXMuX2RlZmF1bHRPcHRpb25zLmtleUVuY29kaW5nKSwtMT09PXRoaXMuX2FsbG93ZWRLZXlMZW5ndGhzLmluZGV4T2YocGFyc2VJbnQodC5rZXlMZW5ndGgsMTApKSYmKHQua2V5TGVuZ3RoPXRoaXMuX2RlZmF1bHRPcHRpb25zLmtleUxlbmd0aCksLTE9PT10aGlzLl9hbGxvd2VkTW9kZXMuaW5kZXhPZih0Lm1vZGUudG9Mb3dlckNhc2UoKSkmJih0Lm1vZGU9dGhpcy5fZGVmYXVsdE9wdGlvbnMubW9kZSksdH19LHtrZXk6XCJfZGVjb2RlS2V5XCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXtyZXR1cm5cImJhc2U2NFwiPT09dC5rZXlFbmNvZGluZz91LmRlZmF1bHQuZW5jLkJhc2U2NC5wYXJzZShlKTpcImhleFwiPT09dC5rZXlFbmNvZGluZz91LmRlZmF1bHQuZW5jLkhleC5wYXJzZShlKTplfX0se2tleTpcIl9nZXRQYWRkZWRLZXlcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3JldHVybiBlPXRoaXMuX2RlY29kZUtleShlLHQpLHQuZW5jcnlwdEtleT91LmRlZmF1bHQuZW5jLlV0ZjgucGFyc2UodGhpcy5TSEEyNTYoZSkuc2xpY2UoMCwzMikpOmV9fSx7a2V5OlwiX2dldE1vZGVcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm5cImVjYlwiPT09ZS5tb2RlP3UuZGVmYXVsdC5tb2RlLkVDQjp1LmRlZmF1bHQubW9kZS5DQkN9fSx7a2V5OlwiX2dldElWXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuXCJjYmNcIj09PWUubW9kZT91LmRlZmF1bHQuZW5jLlV0ZjgucGFyc2UodGhpcy5faXYpOm51bGx9fSx7a2V5OlwiZW5jcnlwdFwiLHZhbHVlOmZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gdGhpcy5fY29uZmlnLmN1c3RvbUVuY3J5cHQ/dGhpcy5fY29uZmlnLmN1c3RvbUVuY3J5cHQoZSk6dGhpcy5wbkVuY3J5cHQoZSx0LG4pfX0se2tleTpcImRlY3J5cHRcIix2YWx1ZTpmdW5jdGlvbihlLHQsbil7cmV0dXJuIHRoaXMuX2NvbmZpZy5jdXN0b21EZWNyeXB0P3RoaXMuX2NvbmZpZy5jdXN0b21EZWNyeXB0KGUpOnRoaXMucG5EZWNyeXB0KGUsdCxuKX19LHtrZXk6XCJwbkVuY3J5cHRcIix2YWx1ZTpmdW5jdGlvbihlLHQsbil7aWYoIXQmJiF0aGlzLl9jb25maWcuY2lwaGVyS2V5KXJldHVybiBlO249dGhpcy5fcGFyc2VPcHRpb25zKG4pO3ZhciByPXRoaXMuX2dldElWKG4pLGk9dGhpcy5fZ2V0TW9kZShuKSxzPXRoaXMuX2dldFBhZGRlZEtleSh0fHx0aGlzLl9jb25maWcuY2lwaGVyS2V5LG4pO3JldHVybiB1LmRlZmF1bHQuQUVTLmVuY3J5cHQoZSxzLHtpdjpyLG1vZGU6aX0pLmNpcGhlcnRleHQudG9TdHJpbmcodS5kZWZhdWx0LmVuYy5CYXNlNjQpfHxlfX0se2tleTpcInBuRGVjcnlwdFwiLHZhbHVlOmZ1bmN0aW9uKGUsdCxuKXtpZighdCYmIXRoaXMuX2NvbmZpZy5jaXBoZXJLZXkpcmV0dXJuIGU7bj10aGlzLl9wYXJzZU9wdGlvbnMobik7dmFyIHI9dGhpcy5fZ2V0SVYobiksaT10aGlzLl9nZXRNb2RlKG4pLHM9dGhpcy5fZ2V0UGFkZGVkS2V5KHR8fHRoaXMuX2NvbmZpZy5jaXBoZXJLZXksbik7dHJ5e3ZhciBvPXUuZGVmYXVsdC5lbmMuQmFzZTY0LnBhcnNlKGUpLGE9dS5kZWZhdWx0LkFFUy5kZWNyeXB0KHtjaXBoZXJ0ZXh0Om99LHMse2l2OnIsbW9kZTppfSkudG9TdHJpbmcodS5kZWZhdWx0LmVuYy5VdGY4KTtyZXR1cm4gSlNPTi5wYXJzZShhKX1jYXRjaChlKXtyZXR1cm4gbnVsbH19fV0pLGV9KCk7dC5kZWZhdWx0PWMsZS5leHBvcnRzPXQuZGVmYXVsdH0sZnVuY3Rpb24oZSx0KXtcInVzZSBzdHJpY3RcIjt2YXIgbj1ufHxmdW5jdGlvbihlLHQpe3ZhciBuPXt9LHI9bi5saWI9e30saT1mdW5jdGlvbigpe30scz1yLkJhc2U9e2V4dGVuZDpmdW5jdGlvbihlKXtpLnByb3RvdHlwZT10aGlzO3ZhciB0PW5ldyBpO3JldHVybiBlJiZ0Lm1peEluKGUpLHQuaGFzT3duUHJvcGVydHkoXCJpbml0XCIpfHwodC5pbml0PWZ1bmN0aW9uKCl7dC4kc3VwZXIuaW5pdC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9KSx0LmluaXQucHJvdG90eXBlPXQsdC4kc3VwZXI9dGhpcyx0fSxjcmVhdGU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLmV4dGVuZCgpO3JldHVybiBlLmluaXQuYXBwbHkoZSxhcmd1bWVudHMpLGV9LGluaXQ6ZnVuY3Rpb24oKXt9LG1peEluOmZ1bmN0aW9uKGUpe2Zvcih2YXIgdCBpbiBlKWUuaGFzT3duUHJvcGVydHkodCkmJih0aGlzW3RdPWVbdF0pO2UuaGFzT3duUHJvcGVydHkoXCJ0b1N0cmluZ1wiKSYmKHRoaXMudG9TdHJpbmc9ZS50b1N0cmluZyl9LGNsb25lOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW5pdC5wcm90b3R5cGUuZXh0ZW5kKHRoaXMpfX0sbz1yLldvcmRBcnJheT1zLmV4dGVuZCh7aW5pdDpmdW5jdGlvbihlLHQpe2U9dGhpcy53b3Jkcz1lfHxbXSx0aGlzLnNpZ0J5dGVzPXZvaWQgMCE9dD90OjQqZS5sZW5ndGh9LHRvU3RyaW5nOmZ1bmN0aW9uKGUpe3JldHVybihlfHx1KS5zdHJpbmdpZnkodGhpcyl9LGNvbmNhdDpmdW5jdGlvbihlKXt2YXIgdD10aGlzLndvcmRzLG49ZS53b3JkcyxyPXRoaXMuc2lnQnl0ZXM7aWYoZT1lLnNpZ0J5dGVzLHRoaXMuY2xhbXAoKSxyJTQpZm9yKHZhciBpPTA7aTxlO2krKyl0W3IraT4+PjJdfD0obltpPj4+Ml0+Pj4yNC1pJTQqOCYyNTUpPDwyNC0ocitpKSU0Kjg7ZWxzZSBpZig2NTUzNTxuLmxlbmd0aClmb3IoaT0wO2k8ZTtpKz00KXRbcitpPj4+Ml09bltpPj4+Ml07ZWxzZSB0LnB1c2guYXBwbHkodCxuKTtyZXR1cm4gdGhpcy5zaWdCeXRlcys9ZSx0aGlzfSxjbGFtcDpmdW5jdGlvbigpe3ZhciB0PXRoaXMud29yZHMsbj10aGlzLnNpZ0J5dGVzO3Rbbj4+PjJdJj00Mjk0OTY3Mjk1PDwzMi1uJTQqOCx0Lmxlbmd0aD1lLmNlaWwobi80KX0sY2xvbmU6ZnVuY3Rpb24oKXt2YXIgZT1zLmNsb25lLmNhbGwodGhpcyk7cmV0dXJuIGUud29yZHM9dGhpcy53b3Jkcy5zbGljZSgwKSxlfSxyYW5kb206ZnVuY3Rpb24odCl7Zm9yKHZhciBuPVtdLHI9MDtyPHQ7cis9NCluLnB1c2goNDI5NDk2NzI5NiplLnJhbmRvbSgpfDApO3JldHVybiBuZXcgby5pbml0KG4sdCl9fSksYT1uLmVuYz17fSx1PWEuSGV4PXtzdHJpbmdpZnk6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS53b3JkcztlPWUuc2lnQnl0ZXM7Zm9yKHZhciBuPVtdLHI9MDtyPGU7cisrKXt2YXIgaT10W3I+Pj4yXT4+PjI0LXIlNCo4JjI1NTtuLnB1c2goKGk+Pj40KS50b1N0cmluZygxNikpLG4ucHVzaCgoMTUmaSkudG9TdHJpbmcoMTYpKX1yZXR1cm4gbi5qb2luKFwiXCIpfSxwYXJzZTpmdW5jdGlvbihlKXtmb3IodmFyIHQ9ZS5sZW5ndGgsbj1bXSxyPTA7cjx0O3IrPTIpbltyPj4+M118PXBhcnNlSW50KGUuc3Vic3RyKHIsMiksMTYpPDwyNC1yJTgqNDtyZXR1cm4gbmV3IG8uaW5pdChuLHQvMil9fSxjPWEuTGF0aW4xPXtzdHJpbmdpZnk6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS53b3JkcztlPWUuc2lnQnl0ZXM7Zm9yKHZhciBuPVtdLHI9MDtyPGU7cisrKW4ucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKHRbcj4+PjJdPj4+MjQtciU0KjgmMjU1KSk7cmV0dXJuIG4uam9pbihcIlwiKX0scGFyc2U6ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PWUubGVuZ3RoLG49W10scj0wO3I8dDtyKyspbltyPj4+Ml18PSgyNTUmZS5jaGFyQ29kZUF0KHIpKTw8MjQtciU0Kjg7cmV0dXJuIG5ldyBvLmluaXQobix0KX19LGw9YS5VdGY4PXtzdHJpbmdpZnk6ZnVuY3Rpb24oZSl7dHJ5e3JldHVybiBkZWNvZGVVUklDb21wb25lbnQoZXNjYXBlKGMuc3RyaW5naWZ5KGUpKSl9Y2F0Y2goZSl7dGhyb3cgRXJyb3IoXCJNYWxmb3JtZWQgVVRGLTggZGF0YVwiKX19LHBhcnNlOmZ1bmN0aW9uKGUpe3JldHVybiBjLnBhcnNlKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChlKSkpfX0saD1yLkJ1ZmZlcmVkQmxvY2tBbGdvcml0aG09cy5leHRlbmQoe3Jlc2V0OmZ1bmN0aW9uKCl7dGhpcy5fZGF0YT1uZXcgby5pbml0LHRoaXMuX25EYXRhQnl0ZXM9MH0sX2FwcGVuZDpmdW5jdGlvbihlKXtcInN0cmluZ1wiPT10eXBlb2YgZSYmKGU9bC5wYXJzZShlKSksdGhpcy5fZGF0YS5jb25jYXQoZSksdGhpcy5fbkRhdGFCeXRlcys9ZS5zaWdCeXRlc30sX3Byb2Nlc3M6ZnVuY3Rpb24odCl7dmFyIG49dGhpcy5fZGF0YSxyPW4ud29yZHMsaT1uLnNpZ0J5dGVzLHM9dGhpcy5ibG9ja1NpemUsYT1pLyg0KnMpLGE9dD9lLmNlaWwoYSk6ZS5tYXgoKDB8YSktdGhpcy5fbWluQnVmZmVyU2l6ZSwwKTtpZih0PWEqcyxpPWUubWluKDQqdCxpKSx0KXtmb3IodmFyIHU9MDt1PHQ7dSs9cyl0aGlzLl9kb1Byb2Nlc3NCbG9jayhyLHUpO3U9ci5zcGxpY2UoMCx0KSxuLnNpZ0J5dGVzLT1pfXJldHVybiBuZXcgby5pbml0KHUsaSl9LGNsb25lOmZ1bmN0aW9uKCl7dmFyIGU9cy5jbG9uZS5jYWxsKHRoaXMpO3JldHVybiBlLl9kYXRhPXRoaXMuX2RhdGEuY2xvbmUoKSxlfSxfbWluQnVmZmVyU2l6ZTowfSk7ci5IYXNoZXI9aC5leHRlbmQoe2NmZzpzLmV4dGVuZCgpLGluaXQ6ZnVuY3Rpb24oZSl7dGhpcy5jZmc9dGhpcy5jZmcuZXh0ZW5kKGUpLHRoaXMucmVzZXQoKX0scmVzZXQ6ZnVuY3Rpb24oKXtoLnJlc2V0LmNhbGwodGhpcyksdGhpcy5fZG9SZXNldCgpfSx1cGRhdGU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2FwcGVuZChlKSx0aGlzLl9wcm9jZXNzKCksdGhpc30sZmluYWxpemU6ZnVuY3Rpb24oZSl7cmV0dXJuIGUmJnRoaXMuX2FwcGVuZChlKSx0aGlzLl9kb0ZpbmFsaXplKCl9LGJsb2NrU2l6ZToxNixfY3JlYXRlSGVscGVyOmZ1bmN0aW9uKGUpe3JldHVybiBmdW5jdGlvbih0LG4pe3JldHVybiBuZXcgZS5pbml0KG4pLmZpbmFsaXplKHQpfX0sX2NyZWF0ZUhtYWNIZWxwZXI6ZnVuY3Rpb24oZSl7cmV0dXJuIGZ1bmN0aW9uKHQsbil7cmV0dXJuIG5ldyBmLkhNQUMuaW5pdChlLG4pLmZpbmFsaXplKHQpfX19KTt2YXIgZj1uLmFsZ289e307cmV0dXJuIG59KE1hdGgpOyFmdW5jdGlvbihlKXtmb3IodmFyIHQ9bixyPXQubGliLGk9ci5Xb3JkQXJyYXkscz1yLkhhc2hlcixyPXQuYWxnbyxvPVtdLGE9W10sdT1mdW5jdGlvbihlKXtyZXR1cm4gNDI5NDk2NzI5NiooZS0oMHxlKSl8MH0sYz0yLGw9MDs2ND5sOyl7dmFyIGg7ZTp7aD1jO2Zvcih2YXIgZj1lLnNxcnQoaCkscD0yO3A8PWY7cCsrKWlmKCEoaCVwKSl7aD0hMTticmVhayBlfWg9ITB9aCYmKDg+bCYmKG9bbF09dShlLnBvdyhjLC41KSkpLGFbbF09dShlLnBvdyhjLDEvMykpLGwrKyksYysrfXZhciBkPVtdLHI9ci5TSEEyNTY9cy5leHRlbmQoe19kb1Jlc2V0OmZ1bmN0aW9uKCl7dGhpcy5faGFzaD1uZXcgaS5pbml0KG8uc2xpY2UoMCkpfSxfZG9Qcm9jZXNzQmxvY2s6ZnVuY3Rpb24oZSx0KXtmb3IodmFyIG49dGhpcy5faGFzaC53b3JkcyxyPW5bMF0saT1uWzFdLHM9blsyXSxvPW5bM10sdT1uWzRdLGM9bls1XSxsPW5bNl0saD1uWzddLGY9MDs2ND5mO2YrKyl7aWYoMTY+ZilkW2ZdPTB8ZVt0K2ZdO2Vsc2V7dmFyIHA9ZFtmLTE1XSx5PWRbZi0yXTtkW2ZdPSgocDw8MjV8cD4+PjcpXihwPDwxNHxwPj4+MTgpXnA+Pj4zKStkW2YtN10rKCh5PDwxNXx5Pj4+MTcpXih5PDwxM3x5Pj4+MTkpXnk+Pj4xMCkrZFtmLTE2XX1wPWgrKCh1PDwyNnx1Pj4+NileKHU8PDIxfHU+Pj4xMSleKHU8PDd8dT4+PjI1KSkrKHUmY15+dSZsKSthW2ZdK2RbZl0seT0oKHI8PDMwfHI+Pj4yKV4ocjw8MTl8cj4+PjEzKV4ocjw8MTB8cj4+PjIyKSkrKHImaV5yJnNeaSZzKSxoPWwsbD1jLGM9dSx1PW8rcHwwLG89cyxzPWksaT1yLHI9cCt5fDB9blswXT1uWzBdK3J8MCxuWzFdPW5bMV0raXwwLG5bMl09blsyXStzfDAsblszXT1uWzNdK298MCxuWzRdPW5bNF0rdXwwLG5bNV09bls1XStjfDAsbls2XT1uWzZdK2x8MCxuWzddPW5bN10raHwwfSxfZG9GaW5hbGl6ZTpmdW5jdGlvbigpe3ZhciB0PXRoaXMuX2RhdGEsbj10LndvcmRzLHI9OCp0aGlzLl9uRGF0YUJ5dGVzLGk9OCp0LnNpZ0J5dGVzO3JldHVybiBuW2k+Pj41XXw9MTI4PDwyNC1pJTMyLG5bMTQrKGkrNjQ+Pj45PDw0KV09ZS5mbG9vcihyLzQyOTQ5NjcyOTYpLG5bMTUrKGkrNjQ+Pj45PDw0KV09cix0LnNpZ0J5dGVzPTQqbi5sZW5ndGgsdGhpcy5fcHJvY2VzcygpLHRoaXMuX2hhc2h9LGNsb25lOmZ1bmN0aW9uKCl7dmFyIGU9cy5jbG9uZS5jYWxsKHRoaXMpO3JldHVybiBlLl9oYXNoPXRoaXMuX2hhc2guY2xvbmUoKSxlfX0pO3QuU0hBMjU2PXMuX2NyZWF0ZUhlbHBlcihyKSx0LkhtYWNTSEEyNTY9cy5fY3JlYXRlSG1hY0hlbHBlcihyKX0oTWF0aCksZnVuY3Rpb24oKXt2YXIgZT1uLHQ9ZS5lbmMuVXRmODtlLmFsZ28uSE1BQz1lLmxpYi5CYXNlLmV4dGVuZCh7aW5pdDpmdW5jdGlvbihlLG4pe2U9dGhpcy5faGFzaGVyPW5ldyBlLmluaXQsXCJzdHJpbmdcIj09dHlwZW9mIG4mJihuPXQucGFyc2UobikpO3ZhciByPWUuYmxvY2tTaXplLGk9NCpyO24uc2lnQnl0ZXM+aSYmKG49ZS5maW5hbGl6ZShuKSksbi5jbGFtcCgpO2Zvcih2YXIgcz10aGlzLl9vS2V5PW4uY2xvbmUoKSxvPXRoaXMuX2lLZXk9bi5jbG9uZSgpLGE9cy53b3Jkcyx1PW8ud29yZHMsYz0wO2M8cjtjKyspYVtjXV49MTU0OTU1NjgyOCx1W2NdXj05MDk1MjI0ODY7cy5zaWdCeXRlcz1vLnNpZ0J5dGVzPWksdGhpcy5yZXNldCgpfSxyZXNldDpmdW5jdGlvbigpe3ZhciBlPXRoaXMuX2hhc2hlcjtlLnJlc2V0KCksZS51cGRhdGUodGhpcy5faUtleSl9LHVwZGF0ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5faGFzaGVyLnVwZGF0ZShlKSx0aGlzfSxmaW5hbGl6ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLl9oYXNoZXI7cmV0dXJuIGU9dC5maW5hbGl6ZShlKSx0LnJlc2V0KCksdC5maW5hbGl6ZSh0aGlzLl9vS2V5LmNsb25lKCkuY29uY2F0KGUpKX19KX0oKSxmdW5jdGlvbigpe3ZhciBlPW4sdD1lLmxpYi5Xb3JkQXJyYXk7ZS5lbmMuQmFzZTY0PXtzdHJpbmdpZnk6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS53b3JkcyxuPWUuc2lnQnl0ZXMscj10aGlzLl9tYXA7ZS5jbGFtcCgpLGU9W107Zm9yKHZhciBpPTA7aTxuO2krPTMpZm9yKHZhciBzPSh0W2k+Pj4yXT4+PjI0LWklNCo4JjI1NSk8PDE2fCh0W2krMT4+PjJdPj4+MjQtKGkrMSklNCo4JjI1NSk8PDh8dFtpKzI+Pj4yXT4+PjI0LShpKzIpJTQqOCYyNTUsbz0wOzQ+byYmaSsuNzUqbzxuO28rKyllLnB1c2goci5jaGFyQXQocz4+PjYqKDMtbykmNjMpKTtpZih0PXIuY2hhckF0KDY0KSlmb3IoO2UubGVuZ3RoJTQ7KWUucHVzaCh0KTtyZXR1cm4gZS5qb2luKFwiXCIpfSxwYXJzZTpmdW5jdGlvbihlKXt2YXIgbj1lLmxlbmd0aCxyPXRoaXMuX21hcCxpPXIuY2hhckF0KDY0KTtpJiYtMSE9KGk9ZS5pbmRleE9mKGkpKSYmKG49aSk7Zm9yKHZhciBpPVtdLHM9MCxvPTA7bzxuO28rKylpZihvJTQpe3ZhciBhPXIuaW5kZXhPZihlLmNoYXJBdChvLTEpKTw8byU0KjIsdT1yLmluZGV4T2YoZS5jaGFyQXQobykpPj4+Ni1vJTQqMjtpW3M+Pj4yXXw9KGF8dSk8PDI0LXMlNCo4LHMrK31yZXR1cm4gdC5jcmVhdGUoaSxzKX0sX21hcDpcIkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky89XCJ9fSgpLGZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQoZSx0LG4scixpLHMsbyl7cmV0dXJuKChlPWUrKHQmbnx+dCZyKStpK28pPDxzfGU+Pj4zMi1zKSt0fWZ1bmN0aW9uIHIoZSx0LG4scixpLHMsbyl7cmV0dXJuKChlPWUrKHQmcnxuJn5yKStpK28pPDxzfGU+Pj4zMi1zKSt0fWZ1bmN0aW9uIGkoZSx0LG4scixpLHMsbyl7cmV0dXJuKChlPWUrKHRebl5yKStpK28pPDxzfGU+Pj4zMi1zKSt0fWZ1bmN0aW9uIHMoZSx0LG4scixpLHMsbyl7cmV0dXJuKChlPWUrKG5eKHR8fnIpKStpK28pPDxzfGU+Pj4zMi1zKSt0fWZvcih2YXIgbz1uLGE9by5saWIsdT1hLldvcmRBcnJheSxjPWEuSGFzaGVyLGE9by5hbGdvLGw9W10saD0wOzY0Pmg7aCsrKWxbaF09NDI5NDk2NzI5NiplLmFicyhlLnNpbihoKzEpKXwwO2E9YS5NRDU9Yy5leHRlbmQoe19kb1Jlc2V0OmZ1bmN0aW9uKCl7dGhpcy5faGFzaD1uZXcgdS5pbml0KFsxNzMyNTg0MTkzLDQwMjMyMzM0MTcsMjU2MjM4MzEwMiwyNzE3MzM4NzhdKX0sX2RvUHJvY2Vzc0Jsb2NrOmZ1bmN0aW9uKGUsbil7Zm9yKHZhciBvPTA7MTY+bztvKyspe3ZhciBhPW4rbyx1PWVbYV07ZVthXT0xNjcxMTkzNSYodTw8OHx1Pj4+MjQpfDQyNzgyNTUzNjAmKHU8PDI0fHU+Pj44KX12YXIgbz10aGlzLl9oYXNoLndvcmRzLGE9ZVtuKzBdLHU9ZVtuKzFdLGM9ZVtuKzJdLGg9ZVtuKzNdLGY9ZVtuKzRdLHA9ZVtuKzVdLGQ9ZVtuKzZdLHk9ZVtuKzddLGc9ZVtuKzhdLGI9ZVtuKzldLF89ZVtuKzEwXSx2PWVbbisxMV0sbT1lW24rMTJdLGs9ZVtuKzEzXSxQPWVbbisxNF0sTz1lW24rMTVdLHc9b1swXSxUPW9bMV0sUz1vWzJdLEM9b1szXSx3PXQodyxULFMsQyxhLDcsbFswXSksQz10KEMsdyxULFMsdSwxMixsWzFdKSxTPXQoUyxDLHcsVCxjLDE3LGxbMl0pLFQ9dChULFMsQyx3LGgsMjIsbFszXSksdz10KHcsVCxTLEMsZiw3LGxbNF0pLEM9dChDLHcsVCxTLHAsMTIsbFs1XSksUz10KFMsQyx3LFQsZCwxNyxsWzZdKSxUPXQoVCxTLEMsdyx5LDIyLGxbN10pLHc9dCh3LFQsUyxDLGcsNyxsWzhdKSxDPXQoQyx3LFQsUyxiLDEyLGxbOV0pLFM9dChTLEMsdyxULF8sMTcsbFsxMF0pLFQ9dChULFMsQyx3LHYsMjIsbFsxMV0pLHc9dCh3LFQsUyxDLG0sNyxsWzEyXSksQz10KEMsdyxULFMsaywxMixsWzEzXSksUz10KFMsQyx3LFQsUCwxNyxsWzE0XSksVD10KFQsUyxDLHcsTywyMixsWzE1XSksdz1yKHcsVCxTLEMsdSw1LGxbMTZdKSxDPXIoQyx3LFQsUyxkLDksbFsxN10pLFM9cihTLEMsdyxULHYsMTQsbFsxOF0pLFQ9cihULFMsQyx3LGEsMjAsbFsxOV0pLHc9cih3LFQsUyxDLHAsNSxsWzIwXSksQz1yKEMsdyxULFMsXyw5LGxbMjFdKSxTPXIoUyxDLHcsVCxPLDE0LGxbMjJdKSxUPXIoVCxTLEMsdyxmLDIwLGxbMjNdKSx3PXIodyxULFMsQyxiLDUsbFsyNF0pLEM9cihDLHcsVCxTLFAsOSxsWzI1XSksUz1yKFMsQyx3LFQsaCwxNCxsWzI2XSksVD1yKFQsUyxDLHcsZywyMCxsWzI3XSksdz1yKHcsVCxTLEMsayw1LGxbMjhdKSxDPXIoQyx3LFQsUyxjLDksbFsyOV0pLFM9cihTLEMsdyxULHksMTQsbFszMF0pLFQ9cihULFMsQyx3LG0sMjAsbFszMV0pLHc9aSh3LFQsUyxDLHAsNCxsWzMyXSksQz1pKEMsdyxULFMsZywxMSxsWzMzXSksUz1pKFMsQyx3LFQsdiwxNixsWzM0XSksVD1pKFQsUyxDLHcsUCwyMyxsWzM1XSksdz1pKHcsVCxTLEMsdSw0LGxbMzZdKSxDPWkoQyx3LFQsUyxmLDExLGxbMzddKSxTPWkoUyxDLHcsVCx5LDE2LGxbMzhdKSxUPWkoVCxTLEMsdyxfLDIzLGxbMzldKSx3PWkodyxULFMsQyxrLDQsbFs0MF0pLEM9aShDLHcsVCxTLGEsMTEsbFs0MV0pLFM9aShTLEMsdyxULGgsMTYsbFs0Ml0pLFQ9aShULFMsQyx3LGQsMjMsbFs0M10pLHc9aSh3LFQsUyxDLGIsNCxsWzQ0XSksQz1pKEMsdyxULFMsbSwxMSxsWzQ1XSksUz1pKFMsQyx3LFQsTywxNixsWzQ2XSksVD1pKFQsUyxDLHcsYywyMyxsWzQ3XSksdz1zKHcsVCxTLEMsYSw2LGxbNDhdKSxDPXMoQyx3LFQsUyx5LDEwLGxbNDldKSxTPXMoUyxDLHcsVCxQLDE1LGxbNTBdKSxUPXMoVCxTLEMsdyxwLDIxLGxbNTFdKSx3PXModyxULFMsQyxtLDYsbFs1Ml0pLEM9cyhDLHcsVCxTLGgsMTAsbFs1M10pLFM9cyhTLEMsdyxULF8sMTUsbFs1NF0pLFQ9cyhULFMsQyx3LHUsMjEsbFs1NV0pLHc9cyh3LFQsUyxDLGcsNixsWzU2XSksQz1zKEMsdyxULFMsTywxMCxsWzU3XSksUz1zKFMsQyx3LFQsZCwxNSxsWzU4XSksVD1zKFQsUyxDLHcsaywyMSxsWzU5XSksdz1zKHcsVCxTLEMsZiw2LGxbNjBdKSxDPXMoQyx3LFQsUyx2LDEwLGxbNjFdKSxTPXMoUyxDLHcsVCxjLDE1LGxbNjJdKSxUPXMoVCxTLEMsdyxiLDIxLGxbNjNdKTtvWzBdPW9bMF0rd3wwLG9bMV09b1sxXStUfDAsb1syXT1vWzJdK1N8MCxvWzNdPW9bM10rQ3wwfSxfZG9GaW5hbGl6ZTpmdW5jdGlvbigpe3ZhciB0PXRoaXMuX2RhdGEsbj10LndvcmRzLHI9OCp0aGlzLl9uRGF0YUJ5dGVzLGk9OCp0LnNpZ0J5dGVzO25baT4+PjVdfD0xMjg8PDI0LWklMzI7dmFyIHM9ZS5mbG9vcihyLzQyOTQ5NjcyOTYpO2ZvcihuWzE1KyhpKzY0Pj4+OTw8NCldPTE2NzExOTM1JihzPDw4fHM+Pj4yNCl8NDI3ODI1NTM2MCYoczw8MjR8cz4+PjgpLG5bMTQrKGkrNjQ+Pj45PDw0KV09MTY3MTE5MzUmKHI8PDh8cj4+PjI0KXw0Mjc4MjU1MzYwJihyPDwyNHxyPj4+OCksdC5zaWdCeXRlcz00KihuLmxlbmd0aCsxKSx0aGlzLl9wcm9jZXNzKCksdD10aGlzLl9oYXNoLG49dC53b3JkcyxyPTA7ND5yO3IrKylpPW5bcl0sbltyXT0xNjcxMTkzNSYoaTw8OHxpPj4+MjQpfDQyNzgyNTUzNjAmKGk8PDI0fGk+Pj44KTtyZXR1cm4gdH0sY2xvbmU6ZnVuY3Rpb24oKXt2YXIgZT1jLmNsb25lLmNhbGwodGhpcyk7cmV0dXJuIGUuX2hhc2g9dGhpcy5faGFzaC5jbG9uZSgpLGV9fSksby5NRDU9Yy5fY3JlYXRlSGVscGVyKGEpLG8uSG1hY01ENT1jLl9jcmVhdGVIbWFjSGVscGVyKGEpfShNYXRoKSxmdW5jdGlvbigpe3ZhciBlPW4sdD1lLmxpYixyPXQuQmFzZSxpPXQuV29yZEFycmF5LHQ9ZS5hbGdvLHM9dC5FdnBLREY9ci5leHRlbmQoe2NmZzpyLmV4dGVuZCh7a2V5U2l6ZTo0LGhhc2hlcjp0Lk1ENSxpdGVyYXRpb25zOjF9KSxpbml0OmZ1bmN0aW9uKGUpe3RoaXMuY2ZnPXRoaXMuY2ZnLmV4dGVuZChlKX0sY29tcHV0ZTpmdW5jdGlvbihlLHQpe2Zvcih2YXIgbj10aGlzLmNmZyxyPW4uaGFzaGVyLmNyZWF0ZSgpLHM9aS5jcmVhdGUoKSxvPXMud29yZHMsYT1uLmtleVNpemUsbj1uLml0ZXJhdGlvbnM7by5sZW5ndGg8YTspe3UmJnIudXBkYXRlKHUpO3ZhciB1PXIudXBkYXRlKGUpLmZpbmFsaXplKHQpO3IucmVzZXQoKTtmb3IodmFyIGM9MTtjPG47YysrKXU9ci5maW5hbGl6ZSh1KSxyLnJlc2V0KCk7cy5jb25jYXQodSl9cmV0dXJuIHMuc2lnQnl0ZXM9NCphLHN9fSk7ZS5FdnBLREY9ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBzLmNyZWF0ZShuKS5jb21wdXRlKGUsdCl9fSgpLG4ubGliLkNpcGhlcnx8ZnVuY3Rpb24oZSl7dmFyIHQ9bixyPXQubGliLGk9ci5CYXNlLHM9ci5Xb3JkQXJyYXksbz1yLkJ1ZmZlcmVkQmxvY2tBbGdvcml0aG0sYT10LmVuYy5CYXNlNjQsdT10LmFsZ28uRXZwS0RGLGM9ci5DaXBoZXI9by5leHRlbmQoe2NmZzppLmV4dGVuZCgpLGNyZWF0ZUVuY3J5cHRvcjpmdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLmNyZWF0ZSh0aGlzLl9FTkNfWEZPUk1fTU9ERSxlLHQpfSxjcmVhdGVEZWNyeXB0b3I6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5jcmVhdGUodGhpcy5fREVDX1hGT1JNX01PREUsZSx0KX0saW5pdDpmdW5jdGlvbihlLHQsbil7dGhpcy5jZmc9dGhpcy5jZmcuZXh0ZW5kKG4pLHRoaXMuX3hmb3JtTW9kZT1lLHRoaXMuX2tleT10LHRoaXMucmVzZXQoKX0scmVzZXQ6ZnVuY3Rpb24oKXtvLnJlc2V0LmNhbGwodGhpcyksdGhpcy5fZG9SZXNldCgpfSxwcm9jZXNzOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9hcHBlbmQoZSksdGhpcy5fcHJvY2VzcygpfSxmaW5hbGl6ZTpmdW5jdGlvbihlKXtyZXR1cm4gZSYmdGhpcy5fYXBwZW5kKGUpLHRoaXMuX2RvRmluYWxpemUoKX0sa2V5U2l6ZTo0LGl2U2l6ZTo0LF9FTkNfWEZPUk1fTU9ERToxLF9ERUNfWEZPUk1fTU9ERToyLF9jcmVhdGVIZWxwZXI6ZnVuY3Rpb24oZSl7cmV0dXJue2VuY3J5cHQ6ZnVuY3Rpb24odCxuLHIpe3JldHVybihcInN0cmluZ1wiPT10eXBlb2Ygbj95OmQpLmVuY3J5cHQoZSx0LG4scil9LGRlY3J5cHQ6ZnVuY3Rpb24odCxuLHIpe3JldHVybihcInN0cmluZ1wiPT10eXBlb2Ygbj95OmQpLmRlY3J5cHQoZSx0LG4scil9fX19KTtyLlN0cmVhbUNpcGhlcj1jLmV4dGVuZCh7X2RvRmluYWxpemU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcHJvY2VzcyghMCl9LGJsb2NrU2l6ZToxfSk7dmFyIGw9dC5tb2RlPXt9LGg9ZnVuY3Rpb24oZSx0LG4pe3ZhciByPXRoaXMuX2l2O3I/dGhpcy5faXY9dm9pZCAwOnI9dGhpcy5fcHJldkJsb2NrO2Zvcih2YXIgaT0wO2k8bjtpKyspZVt0K2ldXj1yW2ldfSxmPShyLkJsb2NrQ2lwaGVyTW9kZT1pLmV4dGVuZCh7Y3JlYXRlRW5jcnlwdG9yOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuRW5jcnlwdG9yLmNyZWF0ZShlLHQpfSxjcmVhdGVEZWNyeXB0b3I6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5EZWNyeXB0b3IuY3JlYXRlKGUsdCl9LGluaXQ6ZnVuY3Rpb24oZSx0KXt0aGlzLl9jaXBoZXI9ZSx0aGlzLl9pdj10fX0pKS5leHRlbmQoKTtmLkVuY3J5cHRvcj1mLmV4dGVuZCh7cHJvY2Vzc0Jsb2NrOmZ1bmN0aW9uKGUsdCl7dmFyIG49dGhpcy5fY2lwaGVyLHI9bi5ibG9ja1NpemU7aC5jYWxsKHRoaXMsZSx0LHIpLG4uZW5jcnlwdEJsb2NrKGUsdCksdGhpcy5fcHJldkJsb2NrPWUuc2xpY2UodCx0K3IpfX0pLGYuRGVjcnlwdG9yPWYuZXh0ZW5kKHtwcm9jZXNzQmxvY2s6ZnVuY3Rpb24oZSx0KXt2YXIgbj10aGlzLl9jaXBoZXIscj1uLmJsb2NrU2l6ZSxpPWUuc2xpY2UodCx0K3IpO24uZGVjcnlwdEJsb2NrKGUsdCksaC5jYWxsKHRoaXMsZSx0LHIpLHRoaXMuX3ByZXZCbG9jaz1pfX0pLGw9bC5DQkM9ZixmPSh0LnBhZD17fSkuUGtjczc9e3BhZDpmdW5jdGlvbihlLHQpe2Zvcih2YXIgbj00KnQsbj1uLWUuc2lnQnl0ZXMlbixyPW48PDI0fG48PDE2fG48PDh8bixpPVtdLG89MDtvPG47bys9NClpLnB1c2gocik7bj1zLmNyZWF0ZShpLG4pLGUuY29uY2F0KG4pfSx1bnBhZDpmdW5jdGlvbihlKXtlLnNpZ0J5dGVzLT0yNTUmZS53b3Jkc1tlLnNpZ0J5dGVzLTE+Pj4yXX19LHIuQmxvY2tDaXBoZXI9Yy5leHRlbmQoe2NmZzpjLmNmZy5leHRlbmQoe21vZGU6bCxwYWRkaW5nOmZ9KSxyZXNldDpmdW5jdGlvbigpe2MucmVzZXQuY2FsbCh0aGlzKTt2YXIgZT10aGlzLmNmZyx0PWUuaXYsZT1lLm1vZGU7aWYodGhpcy5feGZvcm1Nb2RlPT10aGlzLl9FTkNfWEZPUk1fTU9ERSl2YXIgbj1lLmNyZWF0ZUVuY3J5cHRvcjtlbHNlIG49ZS5jcmVhdGVEZWNyeXB0b3IsdGhpcy5fbWluQnVmZmVyU2l6ZT0xO3RoaXMuX21vZGU9bi5jYWxsKGUsdGhpcyx0JiZ0LndvcmRzKX0sX2RvUHJvY2Vzc0Jsb2NrOmZ1bmN0aW9uKGUsdCl7dGhpcy5fbW9kZS5wcm9jZXNzQmxvY2soZSx0KX0sX2RvRmluYWxpemU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLmNmZy5wYWRkaW5nO2lmKHRoaXMuX3hmb3JtTW9kZT09dGhpcy5fRU5DX1hGT1JNX01PREUpe2UucGFkKHRoaXMuX2RhdGEsdGhpcy5ibG9ja1NpemUpO3ZhciB0PXRoaXMuX3Byb2Nlc3MoITApfWVsc2UgdD10aGlzLl9wcm9jZXNzKCEwKSxlLnVucGFkKHQpO3JldHVybiB0fSxibG9ja1NpemU6NH0pO3ZhciBwPXIuQ2lwaGVyUGFyYW1zPWkuZXh0ZW5kKHtpbml0OmZ1bmN0aW9uKGUpe3RoaXMubWl4SW4oZSl9LHRvU3RyaW5nOmZ1bmN0aW9uKGUpe3JldHVybihlfHx0aGlzLmZvcm1hdHRlcikuc3RyaW5naWZ5KHRoaXMpfX0pLGw9KHQuZm9ybWF0PXt9KS5PcGVuU1NMPXtzdHJpbmdpZnk6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5jaXBoZXJ0ZXh0O3JldHVybiBlPWUuc2FsdCwoZT9zLmNyZWF0ZShbMTM5ODg5MzY4NCwxNzAxMDc2ODMxXSkuY29uY2F0KGUpLmNvbmNhdCh0KTp0KS50b1N0cmluZyhhKX0scGFyc2U6ZnVuY3Rpb24oZSl7ZT1hLnBhcnNlKGUpO3ZhciB0PWUud29yZHM7aWYoMTM5ODg5MzY4ND09dFswXSYmMTcwMTA3NjgzMT09dFsxXSl7dmFyIG49cy5jcmVhdGUodC5zbGljZSgyLDQpKTt0LnNwbGljZSgwLDQpLGUuc2lnQnl0ZXMtPTE2fXJldHVybiBwLmNyZWF0ZSh7Y2lwaGVydGV4dDplLHNhbHQ6bn0pfX0sZD1yLlNlcmlhbGl6YWJsZUNpcGhlcj1pLmV4dGVuZCh7Y2ZnOmkuZXh0ZW5kKHtmb3JtYXQ6bH0pLGVuY3J5cHQ6ZnVuY3Rpb24oZSx0LG4scil7cj10aGlzLmNmZy5leHRlbmQocik7dmFyIGk9ZS5jcmVhdGVFbmNyeXB0b3IobixyKTtyZXR1cm4gdD1pLmZpbmFsaXplKHQpLGk9aS5jZmcscC5jcmVhdGUoe2NpcGhlcnRleHQ6dCxrZXk6bixpdjppLml2LGFsZ29yaXRobTplLG1vZGU6aS5tb2RlLHBhZGRpbmc6aS5wYWRkaW5nLGJsb2NrU2l6ZTplLmJsb2NrU2l6ZSxmb3JtYXR0ZXI6ci5mb3JtYXR9KX0sZGVjcnlwdDpmdW5jdGlvbihlLHQsbixyKXtyZXR1cm4gcj10aGlzLmNmZy5leHRlbmQociksdD10aGlzLl9wYXJzZSh0LHIuZm9ybWF0KSxlLmNyZWF0ZURlY3J5cHRvcihuLHIpLmZpbmFsaXplKHQuY2lwaGVydGV4dCl9LF9wYXJzZTpmdW5jdGlvbihlLHQpe3JldHVyblwic3RyaW5nXCI9PXR5cGVvZiBlP3QucGFyc2UoZSx0aGlzKTplfX0pLHQ9KHQua2RmPXt9KS5PcGVuU1NMPXtleGVjdXRlOmZ1bmN0aW9uKGUsdCxuLHIpe3JldHVybiByfHwocj1zLnJhbmRvbSg4KSksZT11LmNyZWF0ZSh7a2V5U2l6ZTp0K259KS5jb21wdXRlKGUsciksbj1zLmNyZWF0ZShlLndvcmRzLnNsaWNlKHQpLDQqbiksZS5zaWdCeXRlcz00KnQscC5jcmVhdGUoe2tleTplLGl2Om4sc2FsdDpyfSl9fSx5PXIuUGFzc3dvcmRCYXNlZENpcGhlcj1kLmV4dGVuZCh7Y2ZnOmQuY2ZnLmV4dGVuZCh7a2RmOnR9KSxlbmNyeXB0OmZ1bmN0aW9uKGUsdCxuLHIpe3JldHVybiByPXRoaXMuY2ZnLmV4dGVuZChyKSxuPXIua2RmLmV4ZWN1dGUobixlLmtleVNpemUsZS5pdlNpemUpLHIuaXY9bi5pdixlPWQuZW5jcnlwdC5jYWxsKHRoaXMsZSx0LG4ua2V5LHIpLGUubWl4SW4obiksZX0sZGVjcnlwdDpmdW5jdGlvbihlLHQsbixyKXtyZXR1cm4gcj10aGlzLmNmZy5leHRlbmQociksdD10aGlzLl9wYXJzZSh0LHIuZm9ybWF0KSxuPXIua2RmLmV4ZWN1dGUobixlLmtleVNpemUsZS5pdlNpemUsdC5zYWx0KSxyLml2PW4uaXYsZC5kZWNyeXB0LmNhbGwodGhpcyxlLHQsbi5rZXkscil9fSl9KCksZnVuY3Rpb24oKXtmb3IodmFyIGU9bix0PWUubGliLkJsb2NrQ2lwaGVyLHI9ZS5hbGdvLGk9W10scz1bXSxvPVtdLGE9W10sdT1bXSxjPVtdLGw9W10saD1bXSxmPVtdLHA9W10sZD1bXSx5PTA7MjU2Pnk7eSsrKWRbeV09MTI4Pnk/eTw8MTp5PDwxXjI4Mztmb3IodmFyIGc9MCxiPTAseT0wOzI1Nj55O3krKyl7dmFyIF89Yl5iPDwxXmI8PDJeYjw8M15iPDw0LF89Xz4+PjheMjU1Jl9eOTk7aVtnXT1fLHNbX109Zzt2YXIgdj1kW2ddLG09ZFt2XSxrPWRbbV0sUD0yNTcqZFtfXV4xNjg0MzAwOCpfO29bZ109UDw8MjR8UD4+PjgsYVtnXT1QPDwxNnxQPj4+MTYsdVtnXT1QPDw4fFA+Pj4yNCxjW2ddPVAsUD0xNjg0MzAwOSprXjY1NTM3Km1eMjU3KnZeMTY4NDMwMDgqZyxsW19dPVA8PDI0fFA+Pj44LGhbX109UDw8MTZ8UD4+PjE2LGZbX109UDw8OHxQPj4+MjQscFtfXT1QLGc/KGc9dl5kW2RbZFtrXnZdXV0sYl49ZFtkW2JdXSk6Zz1iPTF9dmFyIE89WzAsMSwyLDQsOCwxNiwzMiw2NCwxMjgsMjcsNTRdLHI9ci5BRVM9dC5leHRlbmQoe19kb1Jlc2V0OmZ1bmN0aW9uKCl7Zm9yKHZhciBlPXRoaXMuX2tleSx0PWUud29yZHMsbj1lLnNpZ0J5dGVzLzQsZT00KigodGhpcy5fblJvdW5kcz1uKzYpKzEpLHI9dGhpcy5fa2V5U2NoZWR1bGU9W10scz0wO3M8ZTtzKyspaWYoczxuKXJbc109dFtzXTtlbHNle3ZhciBvPXJbcy0xXTtzJW4/NjxuJiY0PT1zJW4mJihvPWlbbz4+PjI0XTw8MjR8aVtvPj4+MTYmMjU1XTw8MTZ8aVtvPj4+OCYyNTVdPDw4fGlbMjU1Jm9dKToobz1vPDw4fG8+Pj4yNCxvPWlbbz4+PjI0XTw8MjR8aVtvPj4+MTYmMjU1XTw8MTZ8aVtvPj4+OCYyNTVdPDw4fGlbMjU1Jm9dLG9ePU9bcy9ufDBdPDwyNCkscltzXT1yW3Mtbl1eb31mb3IodD10aGlzLl9pbnZLZXlTY2hlZHVsZT1bXSxuPTA7bjxlO24rKylzPWUtbixvPW4lND9yW3NdOnJbcy00XSx0W25dPTQ+bnx8ND49cz9vOmxbaVtvPj4+MjRdXV5oW2lbbz4+PjE2JjI1NV1dXmZbaVtvPj4+OCYyNTVdXV5wW2lbMjU1Jm9dXX0sZW5jcnlwdEJsb2NrOmZ1bmN0aW9uKGUsdCl7dGhpcy5fZG9DcnlwdEJsb2NrKGUsdCx0aGlzLl9rZXlTY2hlZHVsZSxvLGEsdSxjLGkpfSxkZWNyeXB0QmxvY2s6ZnVuY3Rpb24oZSx0KXt2YXIgbj1lW3QrMV07ZVt0KzFdPWVbdCszXSxlW3QrM109bix0aGlzLl9kb0NyeXB0QmxvY2soZSx0LHRoaXMuX2ludktleVNjaGVkdWxlLGwsaCxmLHAscyksbj1lW3QrMV0sZVt0KzFdPWVbdCszXSxlW3QrM109bn0sX2RvQ3J5cHRCbG9jazpmdW5jdGlvbihlLHQsbixyLGkscyxvLGEpe2Zvcih2YXIgdT10aGlzLl9uUm91bmRzLGM9ZVt0XV5uWzBdLGw9ZVt0KzFdXm5bMV0saD1lW3QrMl1eblsyXSxmPWVbdCszXV5uWzNdLHA9NCxkPTE7ZDx1O2QrKyl2YXIgeT1yW2M+Pj4yNF1eaVtsPj4+MTYmMjU1XV5zW2g+Pj44JjI1NV1eb1syNTUmZl1ebltwKytdLGc9cltsPj4+MjRdXmlbaD4+PjE2JjI1NV1ec1tmPj4+OCYyNTVdXm9bMjU1JmNdXm5bcCsrXSxiPXJbaD4+PjI0XV5pW2Y+Pj4xNiYyNTVdXnNbYz4+PjgmMjU1XV5vWzI1NSZsXV5uW3ArK10sZj1yW2Y+Pj4yNF1eaVtjPj4+MTYmMjU1XV5zW2w+Pj44JjI1NV1eb1syNTUmaF1ebltwKytdLGM9eSxsPWcsaD1iO3k9KGFbYz4+PjI0XTw8MjR8YVtsPj4+MTYmMjU1XTw8MTZ8YVtoPj4+OCYyNTVdPDw4fGFbMjU1JmZdKV5uW3ArK10sZz0oYVtsPj4+MjRdPDwyNHxhW2g+Pj4xNiYyNTVdPDwxNnxhW2Y+Pj44JjI1NV08PDh8YVsyNTUmY10pXm5bcCsrXSxiPShhW2g+Pj4yNF08PDI0fGFbZj4+PjE2JjI1NV08PDE2fGFbYz4+PjgmMjU1XTw8OHxhWzI1NSZsXSlebltwKytdLGY9KGFbZj4+PjI0XTw8MjR8YVtjPj4+MTYmMjU1XTw8MTZ8YVtsPj4+OCYyNTVdPDw4fGFbMjU1JmhdKV5uW3ArK10sZVt0XT15LGVbdCsxXT1nLGVbdCsyXT1iLGVbdCszXT1mfSxrZXlTaXplOjh9KTtlLkFFUz10Ll9jcmVhdGVIZWxwZXIocil9KCksbi5tb2RlLkVDQj1mdW5jdGlvbigpe3ZhciBlPW4ubGliLkJsb2NrQ2lwaGVyTW9kZS5leHRlbmQoKTtyZXR1cm4gZS5FbmNyeXB0b3I9ZS5leHRlbmQoe3Byb2Nlc3NCbG9jazpmdW5jdGlvbihlLHQpe3RoaXMuX2NpcGhlci5lbmNyeXB0QmxvY2soZSx0KX19KSxlLkRlY3J5cHRvcj1lLmV4dGVuZCh7cHJvY2Vzc0Jsb2NrOmZ1bmN0aW9uKGUsdCl7dGhpcy5fY2lwaGVyLmRlY3J5cHRCbG9jayhlLHQpfX0pLGV9KCksZS5leHBvcnRzPW59LGZ1bmN0aW9uKGUsdCxuKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiByKGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7ZGVmYXVsdDplfX1mdW5jdGlvbiBpKGUsdCl7aWYoIShlIGluc3RhbmNlb2YgdCkpdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKX1PYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KTt2YXIgcz1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSx0KXtmb3IodmFyIG49MDtuPHQubGVuZ3RoO24rKyl7dmFyIHI9dFtuXTtyLmVudW1lcmFibGU9ci5lbnVtZXJhYmxlfHwhMSxyLmNvbmZpZ3VyYWJsZT0hMCxcInZhbHVlXCJpbiByJiYoci53cml0YWJsZT0hMCksT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsci5rZXkscil9fXJldHVybiBmdW5jdGlvbih0LG4scil7cmV0dXJuIG4mJmUodC5wcm90b3R5cGUsbiksciYmZSh0LHIpLHR9fSgpLG89big2KSxhPShyKG8pLG4oMikpLHU9KHIoYSksbig5KSksYz0ocih1KSxuKDExKSksbD1yKGMpLGg9bigxNCksZj1yKGgpLHA9bigxNSksZD1yKHApLHk9KG4oNSksbigxMCkpLGc9cih5KSxiPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0KXt2YXIgbj10LnN1YnNjcmliZUVuZHBvaW50LHI9dC5sZWF2ZUVuZHBvaW50LHM9dC5oZWFydGJlYXRFbmRwb2ludCxvPXQuc2V0U3RhdGVFbmRwb2ludCxhPXQudGltZUVuZHBvaW50LHU9dC5jb25maWcsYz10LmNyeXB0byxoPXQubGlzdGVuZXJNYW5hZ2VyO2kodGhpcyxlKSx0aGlzLl9saXN0ZW5lck1hbmFnZXI9aCx0aGlzLl9jb25maWc9dSx0aGlzLl9sZWF2ZUVuZHBvaW50PXIsdGhpcy5faGVhcnRiZWF0RW5kcG9pbnQ9cyx0aGlzLl9zZXRTdGF0ZUVuZHBvaW50PW8sdGhpcy5fc3Vic2NyaWJlRW5kcG9pbnQ9bix0aGlzLl9jcnlwdG89Yyx0aGlzLl9jaGFubmVscz17fSx0aGlzLl9wcmVzZW5jZUNoYW5uZWxzPXt9LHRoaXMuX2hlYXJ0YmVhdENoYW5uZWxzPXt9LHRoaXMuX2hlYXJ0YmVhdENoYW5uZWxHcm91cHM9e30sdGhpcy5fY2hhbm5lbEdyb3Vwcz17fSx0aGlzLl9wcmVzZW5jZUNoYW5uZWxHcm91cHM9e30sdGhpcy5fcGVuZGluZ0NoYW5uZWxTdWJzY3JpcHRpb25zPVtdLHRoaXMuX3BlbmRpbmdDaGFubmVsR3JvdXBTdWJzY3JpcHRpb25zPVtdLHRoaXMuX2N1cnJlbnRUaW1ldG9rZW49MCx0aGlzLl9sYXN0VGltZXRva2VuPTAsdGhpcy5fc3RvcmVkVGltZXRva2VuPW51bGwsdGhpcy5fc3Vic2NyaXB0aW9uU3RhdHVzQW5ub3VuY2VkPSExLHRoaXMuX2lzT25saW5lPSEwLHRoaXMuX3JlY29ubmVjdGlvbk1hbmFnZXI9bmV3IGwuZGVmYXVsdCh7dGltZUVuZHBvaW50OmF9KSx0aGlzLl9kZWR1cGluZ01hbmFnZXI9bmV3IGYuZGVmYXVsdCh7Y29uZmlnOnV9KX1yZXR1cm4gcyhlLFt7a2V5OlwiYWRhcHRTdGF0ZUNoYW5nZVwiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIG49dGhpcyxyPWUuc3RhdGUsaT1lLmNoYW5uZWxzLHM9dm9pZCAwPT09aT9bXTppLG89ZS5jaGFubmVsR3JvdXBzLGE9dm9pZCAwPT09bz9bXTpvO3JldHVybiBzLmZvckVhY2goZnVuY3Rpb24oZSl7ZSBpbiBuLl9jaGFubmVscyYmKG4uX2NoYW5uZWxzW2VdLnN0YXRlPXIpfSksYS5mb3JFYWNoKGZ1bmN0aW9uKGUpe2UgaW4gbi5fY2hhbm5lbEdyb3VwcyYmKG4uX2NoYW5uZWxHcm91cHNbZV0uc3RhdGU9cil9KSx0aGlzLl9zZXRTdGF0ZUVuZHBvaW50KHtzdGF0ZTpyLGNoYW5uZWxzOnMsY2hhbm5lbEdyb3VwczphfSx0KX19LHtrZXk6XCJhZGFwdFByZXNlbmNlQ2hhbmdlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxuPWUuY29ubmVjdGVkLHI9ZS5jaGFubmVscyxpPXZvaWQgMD09PXI/W106cixzPWUuY2hhbm5lbEdyb3VwcyxvPXZvaWQgMD09PXM/W106cztuPyhpLmZvckVhY2goZnVuY3Rpb24oZSl7dC5faGVhcnRiZWF0Q2hhbm5lbHNbZV09e3N0YXRlOnt9fX0pLG8uZm9yRWFjaChmdW5jdGlvbihlKXt0Ll9oZWFydGJlYXRDaGFubmVsR3JvdXBzW2VdPXtzdGF0ZTp7fX19KSk6KGkuZm9yRWFjaChmdW5jdGlvbihlKXtlIGluIHQuX2hlYXJ0YmVhdENoYW5uZWxzJiZkZWxldGUgdC5faGVhcnRiZWF0Q2hhbm5lbHNbZV19KSxvLmZvckVhY2goZnVuY3Rpb24oZSl7ZSBpbiB0Ll9oZWFydGJlYXRDaGFubmVsR3JvdXBzJiZkZWxldGUgdC5faGVhcnRiZWF0Q2hhbm5lbEdyb3Vwc1tlXX0pLCExPT09dGhpcy5fY29uZmlnLnN1cHByZXNzTGVhdmVFdmVudHMmJnRoaXMuX2xlYXZlRW5kcG9pbnQoe2NoYW5uZWxzOmksY2hhbm5lbEdyb3VwczpvfSxmdW5jdGlvbihlKXt0Ll9saXN0ZW5lck1hbmFnZXIuYW5ub3VuY2VTdGF0dXMoZSl9KSksdGhpcy5yZWNvbm5lY3QoKX19LHtrZXk6XCJhZGFwdFN1YnNjcmliZUNoYW5nZVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj1lLnRpbWV0b2tlbixyPWUuY2hhbm5lbHMsaT12b2lkIDA9PT1yP1tdOnIscz1lLmNoYW5uZWxHcm91cHMsbz12b2lkIDA9PT1zP1tdOnMsYT1lLndpdGhQcmVzZW5jZSx1PXZvaWQgMCE9PWEmJmEsYz1lLndpdGhIZWFydGJlYXRzLGw9dm9pZCAwPT09Y3x8YztpZighdGhpcy5fY29uZmlnLnN1YnNjcmliZUtleXx8XCJcIj09PXRoaXMuX2NvbmZpZy5zdWJzY3JpYmVLZXkpcmV0dXJuIHZvaWQoY29uc29sZSYmY29uc29sZS5sb2cmJmNvbnNvbGUubG9nKFwic3Vic2NyaWJlIGtleSBtaXNzaW5nOyBhYm9ydGluZyBzdWJzY3JpYmVcIikpO24mJih0aGlzLl9sYXN0VGltZXRva2VuPXRoaXMuX2N1cnJlbnRUaW1ldG9rZW4sdGhpcy5fY3VycmVudFRpbWV0b2tlbj1uKSxcblwiMFwiIT09dGhpcy5fY3VycmVudFRpbWV0b2tlbiYmMCE9PXRoaXMuX2N1cnJlbnRUaW1ldG9rZW4mJih0aGlzLl9zdG9yZWRUaW1ldG9rZW49dGhpcy5fY3VycmVudFRpbWV0b2tlbix0aGlzLl9jdXJyZW50VGltZXRva2VuPTApLGkuZm9yRWFjaChmdW5jdGlvbihlKXt0Ll9jaGFubmVsc1tlXT17c3RhdGU6e319LHUmJih0Ll9wcmVzZW5jZUNoYW5uZWxzW2VdPXt9KSxsJiYodC5faGVhcnRiZWF0Q2hhbm5lbHNbZV09e30pLHQuX3BlbmRpbmdDaGFubmVsU3Vic2NyaXB0aW9ucy5wdXNoKGUpfSksby5mb3JFYWNoKGZ1bmN0aW9uKGUpe3QuX2NoYW5uZWxHcm91cHNbZV09e3N0YXRlOnt9fSx1JiYodC5fcHJlc2VuY2VDaGFubmVsR3JvdXBzW2VdPXt9KSxsJiYodC5faGVhcnRiZWF0Q2hhbm5lbEdyb3Vwc1tlXT17fSksdC5fcGVuZGluZ0NoYW5uZWxHcm91cFN1YnNjcmlwdGlvbnMucHVzaChlKX0pLHRoaXMuX3N1YnNjcmlwdGlvblN0YXR1c0Fubm91bmNlZD0hMSx0aGlzLnJlY29ubmVjdCgpfX0se2tleTpcImFkYXB0VW5zdWJzY3JpYmVDaGFuZ2VcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciBuPXRoaXMscj1lLmNoYW5uZWxzLGk9dm9pZCAwPT09cj9bXTpyLHM9ZS5jaGFubmVsR3JvdXBzLG89dm9pZCAwPT09cz9bXTpzLGE9W10sdT1bXTtpLmZvckVhY2goZnVuY3Rpb24oZSl7ZSBpbiBuLl9jaGFubmVscyYmKGRlbGV0ZSBuLl9jaGFubmVsc1tlXSxhLnB1c2goZSksZSBpbiBuLl9oZWFydGJlYXRDaGFubmVscyYmZGVsZXRlIG4uX2hlYXJ0YmVhdENoYW5uZWxzW2VdKSxlIGluIG4uX3ByZXNlbmNlQ2hhbm5lbHMmJihkZWxldGUgbi5fcHJlc2VuY2VDaGFubmVsc1tlXSxhLnB1c2goZSkpfSksby5mb3JFYWNoKGZ1bmN0aW9uKGUpe2UgaW4gbi5fY2hhbm5lbEdyb3VwcyYmKGRlbGV0ZSBuLl9jaGFubmVsR3JvdXBzW2VdLHUucHVzaChlKSxlIGluIG4uX2hlYXJ0YmVhdENoYW5uZWxHcm91cHMmJmRlbGV0ZSBuLl9oZWFydGJlYXRDaGFubmVsR3JvdXBzW2VdKSxlIGluIG4uX3ByZXNlbmNlQ2hhbm5lbEdyb3VwcyYmKGRlbGV0ZSBuLl9jaGFubmVsR3JvdXBzW2VdLHUucHVzaChlKSl9KSwwPT09YS5sZW5ndGgmJjA9PT11Lmxlbmd0aHx8KCExIT09dGhpcy5fY29uZmlnLnN1cHByZXNzTGVhdmVFdmVudHN8fHR8fHRoaXMuX2xlYXZlRW5kcG9pbnQoe2NoYW5uZWxzOmEsY2hhbm5lbEdyb3Vwczp1fSxmdW5jdGlvbihlKXtlLmFmZmVjdGVkQ2hhbm5lbHM9YSxlLmFmZmVjdGVkQ2hhbm5lbEdyb3Vwcz11LGUuY3VycmVudFRpbWV0b2tlbj1uLl9jdXJyZW50VGltZXRva2VuLGUubGFzdFRpbWV0b2tlbj1uLl9sYXN0VGltZXRva2VuLG4uX2xpc3RlbmVyTWFuYWdlci5hbm5vdW5jZVN0YXR1cyhlKX0pLDA9PT1PYmplY3Qua2V5cyh0aGlzLl9jaGFubmVscykubGVuZ3RoJiYwPT09T2JqZWN0LmtleXModGhpcy5fcHJlc2VuY2VDaGFubmVscykubGVuZ3RoJiYwPT09T2JqZWN0LmtleXModGhpcy5fY2hhbm5lbEdyb3VwcykubGVuZ3RoJiYwPT09T2JqZWN0LmtleXModGhpcy5fcHJlc2VuY2VDaGFubmVsR3JvdXBzKS5sZW5ndGgmJih0aGlzLl9sYXN0VGltZXRva2VuPTAsdGhpcy5fY3VycmVudFRpbWV0b2tlbj0wLHRoaXMuX3N0b3JlZFRpbWV0b2tlbj1udWxsLHRoaXMuX3JlZ2lvbj1udWxsLHRoaXMuX3JlY29ubmVjdGlvbk1hbmFnZXIuc3RvcFBvbGxpbmcoKSksdGhpcy5yZWNvbm5lY3QoKSl9fSx7a2V5OlwidW5zdWJzY3JpYmVBbGxcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLmFkYXB0VW5zdWJzY3JpYmVDaGFuZ2Uoe2NoYW5uZWxzOnRoaXMuZ2V0U3Vic2NyaWJlZENoYW5uZWxzKCksY2hhbm5lbEdyb3Vwczp0aGlzLmdldFN1YnNjcmliZWRDaGFubmVsR3JvdXBzKCl9LGUpfX0se2tleTpcImdldEhlYXJ0YmVhdENoYW5uZWxzXCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gT2JqZWN0LmtleXModGhpcy5faGVhcnRiZWF0Q2hhbm5lbHMpfX0se2tleTpcImdldEhlYXJ0YmVhdENoYW5uZWxHcm91cHNcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiBPYmplY3Qua2V5cyh0aGlzLl9oZWFydGJlYXRDaGFubmVsR3JvdXBzKX19LHtrZXk6XCJnZXRTdWJzY3JpYmVkQ2hhbm5lbHNcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiBPYmplY3Qua2V5cyh0aGlzLl9jaGFubmVscyl9fSx7a2V5OlwiZ2V0U3Vic2NyaWJlZENoYW5uZWxHcm91cHNcIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiBPYmplY3Qua2V5cyh0aGlzLl9jaGFubmVsR3JvdXBzKX19LHtrZXk6XCJyZWNvbm5lY3RcIix2YWx1ZTpmdW5jdGlvbigpe3RoaXMuX3N0YXJ0U3Vic2NyaWJlTG9vcCgpLHRoaXMuX3JlZ2lzdGVySGVhcnRiZWF0VGltZXIoKX19LHtrZXk6XCJkaXNjb25uZWN0XCIsdmFsdWU6ZnVuY3Rpb24oKXt0aGlzLl9zdG9wU3Vic2NyaWJlTG9vcCgpLHRoaXMuX3N0b3BIZWFydGJlYXRUaW1lcigpLHRoaXMuX3JlY29ubmVjdGlvbk1hbmFnZXIuc3RvcFBvbGxpbmcoKX19LHtrZXk6XCJfcmVnaXN0ZXJIZWFydGJlYXRUaW1lclwiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5fc3RvcEhlYXJ0YmVhdFRpbWVyKCksMCE9PXRoaXMuX2NvbmZpZy5nZXRIZWFydGJlYXRJbnRlcnZhbCgpJiYodGhpcy5fcGVyZm9ybUhlYXJ0YmVhdExvb3AoKSx0aGlzLl9oZWFydGJlYXRUaW1lcj1zZXRJbnRlcnZhbCh0aGlzLl9wZXJmb3JtSGVhcnRiZWF0TG9vcC5iaW5kKHRoaXMpLDFlMyp0aGlzLl9jb25maWcuZ2V0SGVhcnRiZWF0SW50ZXJ2YWwoKSkpfX0se2tleTpcIl9zdG9wSGVhcnRiZWF0VGltZXJcIix2YWx1ZTpmdW5jdGlvbigpe3RoaXMuX2hlYXJ0YmVhdFRpbWVyJiYoY2xlYXJJbnRlcnZhbCh0aGlzLl9oZWFydGJlYXRUaW1lciksdGhpcy5faGVhcnRiZWF0VGltZXI9bnVsbCl9fSx7a2V5OlwiX3BlcmZvcm1IZWFydGJlYXRMb29wXCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLHQ9dGhpcy5nZXRIZWFydGJlYXRDaGFubmVscygpLG49dGhpcy5nZXRIZWFydGJlYXRDaGFubmVsR3JvdXBzKCkscj17fTtpZigwIT09dC5sZW5ndGh8fDAhPT1uLmxlbmd0aCl7dGhpcy5nZXRTdWJzY3JpYmVkQ2hhbm5lbHMoKS5mb3JFYWNoKGZ1bmN0aW9uKHQpe3ZhciBuPWUuX2NoYW5uZWxzW3RdLnN0YXRlO09iamVjdC5rZXlzKG4pLmxlbmd0aCYmKHJbdF09bil9KSx0aGlzLmdldFN1YnNjcmliZWRDaGFubmVsR3JvdXBzKCkuZm9yRWFjaChmdW5jdGlvbih0KXt2YXIgbj1lLl9jaGFubmVsR3JvdXBzW3RdLnN0YXRlO09iamVjdC5rZXlzKG4pLmxlbmd0aCYmKHJbdF09bil9KTt2YXIgaT1mdW5jdGlvbih0KXt0LmVycm9yJiZlLl9jb25maWcuYW5ub3VuY2VGYWlsZWRIZWFydGJlYXRzJiZlLl9saXN0ZW5lck1hbmFnZXIuYW5ub3VuY2VTdGF0dXModCksdC5lcnJvciYmZS5fY29uZmlnLmF1dG9OZXR3b3JrRGV0ZWN0aW9uJiZlLl9pc09ubGluZSYmKGUuX2lzT25saW5lPSExLGUuZGlzY29ubmVjdCgpLGUuX2xpc3RlbmVyTWFuYWdlci5hbm5vdW5jZU5ldHdvcmtEb3duKCksZS5yZWNvbm5lY3QoKSksIXQuZXJyb3ImJmUuX2NvbmZpZy5hbm5vdW5jZVN1Y2Nlc3NmdWxIZWFydGJlYXRzJiZlLl9saXN0ZW5lck1hbmFnZXIuYW5ub3VuY2VTdGF0dXModCl9O3RoaXMuX2hlYXJ0YmVhdEVuZHBvaW50KHtjaGFubmVsczp0LGNoYW5uZWxHcm91cHM6bixzdGF0ZTpyfSxpLmJpbmQodGhpcykpfX19LHtrZXk6XCJfc3RhcnRTdWJzY3JpYmVMb29wXCIsdmFsdWU6ZnVuY3Rpb24oKXt0aGlzLl9zdG9wU3Vic2NyaWJlTG9vcCgpO3ZhciBlPVtdLHQ9W107aWYoT2JqZWN0LmtleXModGhpcy5fY2hhbm5lbHMpLmZvckVhY2goZnVuY3Rpb24odCl7cmV0dXJuIGUucHVzaCh0KX0pLE9iamVjdC5rZXlzKHRoaXMuX3ByZXNlbmNlQ2hhbm5lbHMpLmZvckVhY2goZnVuY3Rpb24odCl7cmV0dXJuIGUucHVzaCh0K1wiLXBucHJlc1wiKX0pLE9iamVjdC5rZXlzKHRoaXMuX2NoYW5uZWxHcm91cHMpLmZvckVhY2goZnVuY3Rpb24oZSl7cmV0dXJuIHQucHVzaChlKX0pLE9iamVjdC5rZXlzKHRoaXMuX3ByZXNlbmNlQ2hhbm5lbEdyb3VwcykuZm9yRWFjaChmdW5jdGlvbihlKXtyZXR1cm4gdC5wdXNoKGUrXCItcG5wcmVzXCIpfSksMCE9PWUubGVuZ3RofHwwIT09dC5sZW5ndGgpe3ZhciBuPXtjaGFubmVsczplLGNoYW5uZWxHcm91cHM6dCx0aW1ldG9rZW46dGhpcy5fY3VycmVudFRpbWV0b2tlbixmaWx0ZXJFeHByZXNzaW9uOnRoaXMuX2NvbmZpZy5maWx0ZXJFeHByZXNzaW9uLHJlZ2lvbjp0aGlzLl9yZWdpb259O3RoaXMuX3N1YnNjcmliZUNhbGw9dGhpcy5fc3Vic2NyaWJlRW5kcG9pbnQobix0aGlzLl9wcm9jZXNzU3Vic2NyaWJlUmVzcG9uc2UuYmluZCh0aGlzKSl9fX0se2tleTpcIl9wcm9jZXNzU3Vic2NyaWJlUmVzcG9uc2VcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciBuPXRoaXM7aWYoZS5lcnJvcilyZXR1cm4gdm9pZChlLmNhdGVnb3J5PT09Zy5kZWZhdWx0LlBOVGltZW91dENhdGVnb3J5P3RoaXMuX3N0YXJ0U3Vic2NyaWJlTG9vcCgpOmUuY2F0ZWdvcnk9PT1nLmRlZmF1bHQuUE5OZXR3b3JrSXNzdWVzQ2F0ZWdvcnk/KHRoaXMuZGlzY29ubmVjdCgpLGUuZXJyb3ImJnRoaXMuX2NvbmZpZy5hdXRvTmV0d29ya0RldGVjdGlvbiYmdGhpcy5faXNPbmxpbmUmJih0aGlzLl9pc09ubGluZT0hMSx0aGlzLl9saXN0ZW5lck1hbmFnZXIuYW5ub3VuY2VOZXR3b3JrRG93bigpKSx0aGlzLl9yZWNvbm5lY3Rpb25NYW5hZ2VyLm9uUmVjb25uZWN0aW9uKGZ1bmN0aW9uKCl7bi5fY29uZmlnLmF1dG9OZXR3b3JrRGV0ZWN0aW9uJiYhbi5faXNPbmxpbmUmJihuLl9pc09ubGluZT0hMCxuLl9saXN0ZW5lck1hbmFnZXIuYW5ub3VuY2VOZXR3b3JrVXAoKSksbi5yZWNvbm5lY3QoKSxuLl9zdWJzY3JpcHRpb25TdGF0dXNBbm5vdW5jZWQ9ITA7dmFyIHQ9e2NhdGVnb3J5OmcuZGVmYXVsdC5QTlJlY29ubmVjdGVkQ2F0ZWdvcnksb3BlcmF0aW9uOmUub3BlcmF0aW9uLGxhc3RUaW1ldG9rZW46bi5fbGFzdFRpbWV0b2tlbixjdXJyZW50VGltZXRva2VuOm4uX2N1cnJlbnRUaW1ldG9rZW59O24uX2xpc3RlbmVyTWFuYWdlci5hbm5vdW5jZVN0YXR1cyh0KX0pLHRoaXMuX3JlY29ubmVjdGlvbk1hbmFnZXIuc3RhcnRQb2xsaW5nKCksdGhpcy5fbGlzdGVuZXJNYW5hZ2VyLmFubm91bmNlU3RhdHVzKGUpKTplLmNhdGVnb3J5PT09Zy5kZWZhdWx0LlBOQmFkUmVxdWVzdENhdGVnb3J5Pyh0aGlzLl9zdG9wSGVhcnRiZWF0VGltZXIoKSx0aGlzLl9saXN0ZW5lck1hbmFnZXIuYW5ub3VuY2VTdGF0dXMoZSkpOnRoaXMuX2xpc3RlbmVyTWFuYWdlci5hbm5vdW5jZVN0YXR1cyhlKSk7aWYodGhpcy5fc3RvcmVkVGltZXRva2VuPyh0aGlzLl9jdXJyZW50VGltZXRva2VuPXRoaXMuX3N0b3JlZFRpbWV0b2tlbix0aGlzLl9zdG9yZWRUaW1ldG9rZW49bnVsbCk6KHRoaXMuX2xhc3RUaW1ldG9rZW49dGhpcy5fY3VycmVudFRpbWV0b2tlbix0aGlzLl9jdXJyZW50VGltZXRva2VuPXQubWV0YWRhdGEudGltZXRva2VuKSwhdGhpcy5fc3Vic2NyaXB0aW9uU3RhdHVzQW5ub3VuY2VkKXt2YXIgcj17fTtyLmNhdGVnb3J5PWcuZGVmYXVsdC5QTkNvbm5lY3RlZENhdGVnb3J5LHIub3BlcmF0aW9uPWUub3BlcmF0aW9uLHIuYWZmZWN0ZWRDaGFubmVscz10aGlzLl9wZW5kaW5nQ2hhbm5lbFN1YnNjcmlwdGlvbnMsci5zdWJzY3JpYmVkQ2hhbm5lbHM9dGhpcy5nZXRTdWJzY3JpYmVkQ2hhbm5lbHMoKSxyLmFmZmVjdGVkQ2hhbm5lbEdyb3Vwcz10aGlzLl9wZW5kaW5nQ2hhbm5lbEdyb3VwU3Vic2NyaXB0aW9ucyxyLmxhc3RUaW1ldG9rZW49dGhpcy5fbGFzdFRpbWV0b2tlbixyLmN1cnJlbnRUaW1ldG9rZW49dGhpcy5fY3VycmVudFRpbWV0b2tlbix0aGlzLl9zdWJzY3JpcHRpb25TdGF0dXNBbm5vdW5jZWQ9ITAsdGhpcy5fbGlzdGVuZXJNYW5hZ2VyLmFubm91bmNlU3RhdHVzKHIpLHRoaXMuX3BlbmRpbmdDaGFubmVsU3Vic2NyaXB0aW9ucz1bXSx0aGlzLl9wZW5kaW5nQ2hhbm5lbEdyb3VwU3Vic2NyaXB0aW9ucz1bXX12YXIgaT10Lm1lc3NhZ2VzfHxbXSxzPXRoaXMuX2NvbmZpZyxvPXMucmVxdWVzdE1lc3NhZ2VDb3VudFRocmVzaG9sZCxhPXMuZGVkdXBlT25TdWJzY3JpYmU7aWYobyYmaS5sZW5ndGg+PW8pe3ZhciB1PXt9O3UuY2F0ZWdvcnk9Zy5kZWZhdWx0LlBOUmVxdWVzdE1lc3NhZ2VDb3VudEV4Y2VlZGVkQ2F0ZWdvcnksdS5vcGVyYXRpb249ZS5vcGVyYXRpb24sdGhpcy5fbGlzdGVuZXJNYW5hZ2VyLmFubm91bmNlU3RhdHVzKHUpfWkuZm9yRWFjaChmdW5jdGlvbihlKXt2YXIgdD1lLmNoYW5uZWwscj1lLnN1YnNjcmlwdGlvbk1hdGNoLGk9ZS5wdWJsaXNoTWV0YURhdGE7aWYodD09PXImJihyPW51bGwpLGEpe2lmKG4uX2RlZHVwaW5nTWFuYWdlci5pc0R1cGxpY2F0ZShlKSlyZXR1cm47bi5fZGVkdXBpbmdNYW5hZ2VyLmFkZEVudHJ5KGUpfWlmKGQuZGVmYXVsdC5lbmRzV2l0aChlLmNoYW5uZWwsXCItcG5wcmVzXCIpKXt2YXIgcz17fTtzLmNoYW5uZWw9bnVsbCxzLnN1YnNjcmlwdGlvbj1udWxsLHMuYWN0dWFsQ2hhbm5lbD1udWxsIT1yP3Q6bnVsbCxzLnN1YnNjcmliZWRDaGFubmVsPW51bGwhPXI/cjp0LHQmJihzLmNoYW5uZWw9dC5zdWJzdHJpbmcoMCx0Lmxhc3RJbmRleE9mKFwiLXBucHJlc1wiKSkpLHImJihzLnN1YnNjcmlwdGlvbj1yLnN1YnN0cmluZygwLHIubGFzdEluZGV4T2YoXCItcG5wcmVzXCIpKSkscy5hY3Rpb249ZS5wYXlsb2FkLmFjdGlvbixzLnN0YXRlPWUucGF5bG9hZC5kYXRhLHMudGltZXRva2VuPWkucHVibGlzaFRpbWV0b2tlbixzLm9jY3VwYW5jeT1lLnBheWxvYWQub2NjdXBhbmN5LHMudXVpZD1lLnBheWxvYWQudXVpZCxzLnRpbWVzdGFtcD1lLnBheWxvYWQudGltZXN0YW1wLGUucGF5bG9hZC5qb2luJiYocy5qb2luPWUucGF5bG9hZC5qb2luKSxlLnBheWxvYWQubGVhdmUmJihzLmxlYXZlPWUucGF5bG9hZC5sZWF2ZSksZS5wYXlsb2FkLnRpbWVvdXQmJihzLnRpbWVvdXQ9ZS5wYXlsb2FkLnRpbWVvdXQpLG4uX2xpc3RlbmVyTWFuYWdlci5hbm5vdW5jZVByZXNlbmNlKHMpfWVsc2V7dmFyIG89e307by5jaGFubmVsPW51bGwsby5zdWJzY3JpcHRpb249bnVsbCxvLmFjdHVhbENoYW5uZWw9bnVsbCE9cj90Om51bGwsby5zdWJzY3JpYmVkQ2hhbm5lbD1udWxsIT1yP3I6dCxvLmNoYW5uZWw9dCxvLnN1YnNjcmlwdGlvbj1yLG8udGltZXRva2VuPWkucHVibGlzaFRpbWV0b2tlbixvLnB1Ymxpc2hlcj1lLmlzc3VpbmdDbGllbnRJZCxlLnVzZXJNZXRhZGF0YSYmKG8udXNlck1ldGFkYXRhPWUudXNlck1ldGFkYXRhKSxuLl9jb25maWcuY2lwaGVyS2V5P28ubWVzc2FnZT1uLl9jcnlwdG8uZGVjcnlwdChlLnBheWxvYWQpOm8ubWVzc2FnZT1lLnBheWxvYWQsbi5fbGlzdGVuZXJNYW5hZ2VyLmFubm91bmNlTWVzc2FnZShvKX19KSx0aGlzLl9yZWdpb249dC5tZXRhZGF0YS5yZWdpb24sdGhpcy5fc3RhcnRTdWJzY3JpYmVMb29wKCl9fSx7a2V5OlwiX3N0b3BTdWJzY3JpYmVMb29wXCIsdmFsdWU6ZnVuY3Rpb24oKXt0aGlzLl9zdWJzY3JpYmVDYWxsJiYoXCJmdW5jdGlvblwiPT10eXBlb2YgdGhpcy5fc3Vic2NyaWJlQ2FsbC5hYm9ydCYmdGhpcy5fc3Vic2NyaWJlQ2FsbC5hYm9ydCgpLHRoaXMuX3N1YnNjcmliZUNhbGw9bnVsbCl9fV0pLGV9KCk7dC5kZWZhdWx0PWIsZS5leHBvcnRzPXQuZGVmYXVsdH0sZnVuY3Rpb24oZSx0LG4pe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIHIoZSx0KXtpZighKGUgaW5zdGFuY2VvZiB0KSl0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpfU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pO3ZhciBpPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlLHQpe2Zvcih2YXIgbj0wO248dC5sZW5ndGg7bisrKXt2YXIgcj10W25dO3IuZW51bWVyYWJsZT1yLmVudW1lcmFibGV8fCExLHIuY29uZmlndXJhYmxlPSEwLFwidmFsdWVcImluIHImJihyLndyaXRhYmxlPSEwKSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxyLmtleSxyKX19cmV0dXJuIGZ1bmN0aW9uKHQsbixyKXtyZXR1cm4gbiYmZSh0LnByb3RvdHlwZSxuKSxyJiZlKHQsciksdH19KCkscz0obig1KSxuKDEwKSksbz1mdW5jdGlvbihlKXtyZXR1cm4gZSYmZS5fX2VzTW9kdWxlP2U6e2RlZmF1bHQ6ZX19KHMpLGE9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7cih0aGlzLGUpLHRoaXMuX2xpc3RlbmVycz1bXX1yZXR1cm4gaShlLFt7a2V5OlwiYWRkTGlzdGVuZXJcIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl9saXN0ZW5lcnMucHVzaChlKX19LHtrZXk6XCJyZW1vdmVMaXN0ZW5lclwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PVtdO3RoaXMuX2xpc3RlbmVycy5mb3JFYWNoKGZ1bmN0aW9uKG4pe24hPT1lJiZ0LnB1c2gobil9KSx0aGlzLl9saXN0ZW5lcnM9dH19LHtrZXk6XCJyZW1vdmVBbGxMaXN0ZW5lcnNcIix2YWx1ZTpmdW5jdGlvbigpe3RoaXMuX2xpc3RlbmVycz1bXX19LHtrZXk6XCJhbm5vdW5jZVByZXNlbmNlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fbGlzdGVuZXJzLmZvckVhY2goZnVuY3Rpb24odCl7dC5wcmVzZW5jZSYmdC5wcmVzZW5jZShlKX0pfX0se2tleTpcImFubm91bmNlU3RhdHVzXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fbGlzdGVuZXJzLmZvckVhY2goZnVuY3Rpb24odCl7dC5zdGF0dXMmJnQuc3RhdHVzKGUpfSl9fSx7a2V5OlwiYW5ub3VuY2VNZXNzYWdlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5fbGlzdGVuZXJzLmZvckVhY2goZnVuY3Rpb24odCl7dC5tZXNzYWdlJiZ0Lm1lc3NhZ2UoZSl9KX19LHtrZXk6XCJhbm5vdW5jZU5ldHdvcmtVcFwiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9e307ZS5jYXRlZ29yeT1vLmRlZmF1bHQuUE5OZXR3b3JrVXBDYXRlZ29yeSx0aGlzLmFubm91bmNlU3RhdHVzKGUpfX0se2tleTpcImFubm91bmNlTmV0d29ya0Rvd25cIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXt9O2UuY2F0ZWdvcnk9by5kZWZhdWx0LlBOTmV0d29ya0Rvd25DYXRlZ29yeSx0aGlzLmFubm91bmNlU3RhdHVzKGUpfX1dKSxlfSgpO3QuZGVmYXVsdD1hLGUuZXhwb3J0cz10LmRlZmF1bHR9LGZ1bmN0aW9uKGUsdCl7XCJ1c2Ugc3RyaWN0XCI7T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSksdC5kZWZhdWx0PXtQTk5ldHdvcmtVcENhdGVnb3J5OlwiUE5OZXR3b3JrVXBDYXRlZ29yeVwiLFBOTmV0d29ya0Rvd25DYXRlZ29yeTpcIlBOTmV0d29ya0Rvd25DYXRlZ29yeVwiLFBOTmV0d29ya0lzc3Vlc0NhdGVnb3J5OlwiUE5OZXR3b3JrSXNzdWVzQ2F0ZWdvcnlcIixQTlRpbWVvdXRDYXRlZ29yeTpcIlBOVGltZW91dENhdGVnb3J5XCIsUE5CYWRSZXF1ZXN0Q2F0ZWdvcnk6XCJQTkJhZFJlcXVlc3RDYXRlZ29yeVwiLFBOQWNjZXNzRGVuaWVkQ2F0ZWdvcnk6XCJQTkFjY2Vzc0RlbmllZENhdGVnb3J5XCIsUE5Vbmtub3duQ2F0ZWdvcnk6XCJQTlVua25vd25DYXRlZ29yeVwiLFBOUmVjb25uZWN0ZWRDYXRlZ29yeTpcIlBOUmVjb25uZWN0ZWRDYXRlZ29yeVwiLFBOQ29ubmVjdGVkQ2F0ZWdvcnk6XCJQTkNvbm5lY3RlZENhdGVnb3J5XCIsUE5SZXF1ZXN0TWVzc2FnZUNvdW50RXhjZWVkZWRDYXRlZ29yeTpcIlBOUmVxdWVzdE1lc3NhZ2VDb3VudEV4Y2VlZGVkQ2F0ZWdvcnlcIn0sZS5leHBvcnRzPXQuZGVmYXVsdH0sZnVuY3Rpb24oZSx0LG4pe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIHIoZSx0KXtpZighKGUgaW5zdGFuY2VvZiB0KSl0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpfU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pO3ZhciBpPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlLHQpe2Zvcih2YXIgbj0wO248dC5sZW5ndGg7bisrKXt2YXIgcj10W25dO3IuZW51bWVyYWJsZT1yLmVudW1lcmFibGV8fCExLHIuY29uZmlndXJhYmxlPSEwLFwidmFsdWVcImluIHImJihyLndyaXRhYmxlPSEwKSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxyLmtleSxyKX19cmV0dXJuIGZ1bmN0aW9uKHQsbixyKXtyZXR1cm4gbiYmZSh0LnByb3RvdHlwZSxuKSxyJiZlKHQsciksdH19KCkscz1uKDEyKSxvPShmdW5jdGlvbihlKXtlJiZlLl9fZXNNb2R1bGV9KHMpLG4oNSksZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQpe3ZhciBuPXQudGltZUVuZHBvaW50O3IodGhpcyxlKSx0aGlzLl90aW1lRW5kcG9pbnQ9bn1yZXR1cm4gaShlLFt7a2V5Olwib25SZWNvbm5lY3Rpb25cIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLl9yZWNvbm5lY3Rpb25DYWxsYmFjaz1lfX0se2tleTpcInN0YXJ0UG9sbGluZ1wiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5fdGltZVRpbWVyPXNldEludGVydmFsKHRoaXMuX3BlcmZvcm1UaW1lTG9vcC5iaW5kKHRoaXMpLDNlMyl9fSx7a2V5Olwic3RvcFBvbGxpbmdcIix2YWx1ZTpmdW5jdGlvbigpe2NsZWFySW50ZXJ2YWwodGhpcy5fdGltZVRpbWVyKX19LHtrZXk6XCJfcGVyZm9ybVRpbWVMb29wXCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzO3RoaXMuX3RpbWVFbmRwb2ludChmdW5jdGlvbih0KXt0LmVycm9yfHwoY2xlYXJJbnRlcnZhbChlLl90aW1lVGltZXIpLGUuX3JlY29ubmVjdGlvbkNhbGxiYWNrKCkpfSl9fV0pLGV9KCkpO3QuZGVmYXVsdD1vLGUuZXhwb3J0cz10LmRlZmF1bHR9LGZ1bmN0aW9uKGUsdCxuKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiByKCl7cmV0dXJuIGguZGVmYXVsdC5QTlRpbWVPcGVyYXRpb259ZnVuY3Rpb24gaSgpe3JldHVyblwiL3RpbWUvMFwifWZ1bmN0aW9uIHMoZSl7cmV0dXJuIGUuY29uZmlnLmdldFRyYW5zYWN0aW9uVGltZW91dCgpfWZ1bmN0aW9uIG8oKXtyZXR1cm57fX1mdW5jdGlvbiBhKCl7cmV0dXJuITF9ZnVuY3Rpb24gdShlLHQpe3JldHVybnt0aW1ldG9rZW46dFswXX19ZnVuY3Rpb24gYygpe31PYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KSx0LmdldE9wZXJhdGlvbj1yLHQuZ2V0VVJMPWksdC5nZXRSZXF1ZXN0VGltZW91dD1zLHQucHJlcGFyZVBhcmFtcz1vLHQuaXNBdXRoU3VwcG9ydGVkPWEsdC5oYW5kbGVSZXNwb25zZT11LHQudmFsaWRhdGVQYXJhbXM9Yzt2YXIgbD0obig1KSxuKDEzKSksaD1mdW5jdGlvbihlKXtyZXR1cm4gZSYmZS5fX2VzTW9kdWxlP2U6e2RlZmF1bHQ6ZX19KGwpfSxmdW5jdGlvbihlLHQpe1widXNlIHN0cmljdFwiO09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pLHQuZGVmYXVsdD17UE5UaW1lT3BlcmF0aW9uOlwiUE5UaW1lT3BlcmF0aW9uXCIsUE5IaXN0b3J5T3BlcmF0aW9uOlwiUE5IaXN0b3J5T3BlcmF0aW9uXCIsUE5EZWxldGVNZXNzYWdlc09wZXJhdGlvbjpcIlBORGVsZXRlTWVzc2FnZXNPcGVyYXRpb25cIixQTkZldGNoTWVzc2FnZXNPcGVyYXRpb246XCJQTkZldGNoTWVzc2FnZXNPcGVyYXRpb25cIixQTlN1YnNjcmliZU9wZXJhdGlvbjpcIlBOU3Vic2NyaWJlT3BlcmF0aW9uXCIsUE5VbnN1YnNjcmliZU9wZXJhdGlvbjpcIlBOVW5zdWJzY3JpYmVPcGVyYXRpb25cIixQTlB1Ymxpc2hPcGVyYXRpb246XCJQTlB1Ymxpc2hPcGVyYXRpb25cIixQTlB1c2hOb3RpZmljYXRpb25FbmFibGVkQ2hhbm5lbHNPcGVyYXRpb246XCJQTlB1c2hOb3RpZmljYXRpb25FbmFibGVkQ2hhbm5lbHNPcGVyYXRpb25cIixQTlJlbW92ZUFsbFB1c2hOb3RpZmljYXRpb25zT3BlcmF0aW9uOlwiUE5SZW1vdmVBbGxQdXNoTm90aWZpY2F0aW9uc09wZXJhdGlvblwiLFBOV2hlcmVOb3dPcGVyYXRpb246XCJQTldoZXJlTm93T3BlcmF0aW9uXCIsUE5TZXRTdGF0ZU9wZXJhdGlvbjpcIlBOU2V0U3RhdGVPcGVyYXRpb25cIixQTkhlcmVOb3dPcGVyYXRpb246XCJQTkhlcmVOb3dPcGVyYXRpb25cIixQTkdldFN0YXRlT3BlcmF0aW9uOlwiUE5HZXRTdGF0ZU9wZXJhdGlvblwiLFBOSGVhcnRiZWF0T3BlcmF0aW9uOlwiUE5IZWFydGJlYXRPcGVyYXRpb25cIixQTkNoYW5uZWxHcm91cHNPcGVyYXRpb246XCJQTkNoYW5uZWxHcm91cHNPcGVyYXRpb25cIixQTlJlbW92ZUdyb3VwT3BlcmF0aW9uOlwiUE5SZW1vdmVHcm91cE9wZXJhdGlvblwiLFBOQ2hhbm5lbHNGb3JHcm91cE9wZXJhdGlvbjpcIlBOQ2hhbm5lbHNGb3JHcm91cE9wZXJhdGlvblwiLFBOQWRkQ2hhbm5lbHNUb0dyb3VwT3BlcmF0aW9uOlwiUE5BZGRDaGFubmVsc1RvR3JvdXBPcGVyYXRpb25cIixQTlJlbW92ZUNoYW5uZWxzRnJvbUdyb3VwT3BlcmF0aW9uOlwiUE5SZW1vdmVDaGFubmVsc0Zyb21Hcm91cE9wZXJhdGlvblwiLFBOQWNjZXNzTWFuYWdlckdyYW50OlwiUE5BY2Nlc3NNYW5hZ2VyR3JhbnRcIixQTkFjY2Vzc01hbmFnZXJBdWRpdDpcIlBOQWNjZXNzTWFuYWdlckF1ZGl0XCJ9LGUuZXhwb3J0cz10LmRlZmF1bHR9LGZ1bmN0aW9uKGUsdCxuKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiByKGUsdCl7aWYoIShlIGluc3RhbmNlb2YgdCkpdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKX1PYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KTt2YXIgaT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoZSx0KXtmb3IodmFyIG49MDtuPHQubGVuZ3RoO24rKyl7dmFyIHI9dFtuXTtyLmVudW1lcmFibGU9ci5lbnVtZXJhYmxlfHwhMSxyLmNvbmZpZ3VyYWJsZT0hMCxcInZhbHVlXCJpbiByJiYoci53cml0YWJsZT0hMCksT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsci5rZXkscil9fXJldHVybiBmdW5jdGlvbih0LG4scil7cmV0dXJuIG4mJmUodC5wcm90b3R5cGUsbiksciYmZSh0LHIpLHR9fSgpLHM9bigyKSxvPShmdW5jdGlvbihlKXtlJiZlLl9fZXNNb2R1bGV9KHMpLG4oNSksZnVuY3Rpb24oZSl7dmFyIHQ9MDtpZigwPT09ZS5sZW5ndGgpcmV0dXJuIHQ7Zm9yKHZhciBuPTA7bjxlLmxlbmd0aDtuKz0xKXt0PSh0PDw1KS10K2UuY2hhckNvZGVBdChuKSx0Jj10fXJldHVybiB0fSksYT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUodCl7dmFyIG49dC5jb25maWc7cih0aGlzLGUpLHRoaXMuaGFzaEhpc3Rvcnk9W10sdGhpcy5fY29uZmlnPW59cmV0dXJuIGkoZSxbe2tleTpcImdldEtleVwiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PW8oSlNPTi5zdHJpbmdpZnkoZS5wYXlsb2FkKSkudG9TdHJpbmcoKTtyZXR1cm4gZS5wdWJsaXNoTWV0YURhdGEucHVibGlzaFRpbWV0b2tlbitcIi1cIit0fX0se2tleTpcImlzRHVwbGljYXRlXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuaGFzaEhpc3RvcnkuaW5jbHVkZXModGhpcy5nZXRLZXkoZSkpfX0se2tleTpcImFkZEVudHJ5XCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5oYXNoSGlzdG9yeS5sZW5ndGg+PXRoaXMuX2NvbmZpZy5tYXhpbXVtQ2FjaGVTaXplJiZ0aGlzLmhhc2hIaXN0b3J5LnNoaWZ0KCksdGhpcy5oYXNoSGlzdG9yeS5wdXNoKHRoaXMuZ2V0S2V5KGUpKX19LHtrZXk6XCJjbGVhckhpc3RvcnlcIix2YWx1ZTpmdW5jdGlvbigpe3RoaXMuaGFzaEhpc3Rvcnk9W119fV0pLGV9KCk7dC5kZWZhdWx0PWEsZS5leHBvcnRzPXQuZGVmYXVsdH0sZnVuY3Rpb24oZSx0KXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBuKGUpe3ZhciB0PVtdO3JldHVybiBPYmplY3Qua2V5cyhlKS5mb3JFYWNoKGZ1bmN0aW9uKGUpe3JldHVybiB0LnB1c2goZSl9KSx0fWZ1bmN0aW9uIHIoZSl7cmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChlKS5yZXBsYWNlKC9bIX4qJygpXS9nLGZ1bmN0aW9uKGUpe3JldHVyblwiJVwiK2UuY2hhckNvZGVBdCgwKS50b1N0cmluZygxNikudG9VcHBlckNhc2UoKX0pfWZ1bmN0aW9uIGkoZSl7cmV0dXJuIG4oZSkuc29ydCgpfWZ1bmN0aW9uIHMoZSl7cmV0dXJuIGkoZSkubWFwKGZ1bmN0aW9uKHQpe3JldHVybiB0K1wiPVwiK3IoZVt0XSl9KS5qb2luKFwiJlwiKX1mdW5jdGlvbiBvKGUsdCl7cmV0dXJuLTEhPT1lLmluZGV4T2YodCx0aGlzLmxlbmd0aC10Lmxlbmd0aCl9ZnVuY3Rpb24gYSgpe3ZhciBlPXZvaWQgMCx0PXZvaWQgMDtyZXR1cm57cHJvbWlzZTpuZXcgUHJvbWlzZShmdW5jdGlvbihuLHIpe2U9bix0PXJ9KSxyZWplY3Q6dCxmdWxmaWxsOmV9fWUuZXhwb3J0cz17c2lnblBhbUZyb21QYXJhbXM6cyxlbmRzV2l0aDpvLGNyZWF0ZVByb21pc2U6YSxlbmNvZGVTdHJpbmc6cn19LGZ1bmN0aW9uKGUsdCxuKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiByKGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7ZGVmYXVsdDplfX1mdW5jdGlvbiBpKGUsdCl7aWYoIShlIGluc3RhbmNlb2YgdCkpdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKX1mdW5jdGlvbiBzKGUsdCl7aWYoIWUpdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpO3JldHVybiF0fHxcIm9iamVjdFwiIT10eXBlb2YgdCYmXCJmdW5jdGlvblwiIT10eXBlb2YgdD9lOnR9ZnVuY3Rpb24gbyhlLHQpe2lmKFwiZnVuY3Rpb25cIiE9dHlwZW9mIHQmJm51bGwhPT10KXRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiK3R5cGVvZiB0KTtlLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKHQmJnQucHJvdG90eXBlLHtjb25zdHJ1Y3Rvcjp7dmFsdWU6ZSxlbnVtZXJhYmxlOiExLHdyaXRhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH19KSx0JiYoT2JqZWN0LnNldFByb3RvdHlwZU9mP09iamVjdC5zZXRQcm90b3R5cGVPZihlLHQpOmUuX19wcm90b19fPXQpfWZ1bmN0aW9uIGEoZSx0KXtyZXR1cm4gZS50eXBlPXQsZS5lcnJvcj0hMCxlfWZ1bmN0aW9uIHUoZSl7cmV0dXJuIGEoe21lc3NhZ2U6ZX0sXCJ2YWxpZGF0aW9uRXJyb3JcIil9ZnVuY3Rpb24gYyhlLHQsbil7cmV0dXJuIGUudXNlUG9zdCYmZS51c2VQb3N0KHQsbik/ZS5wb3N0VVJMKHQsbik6ZS5nZXRVUkwodCxuKX1mdW5jdGlvbiBsKGUpe2lmKGUuc2RrTmFtZSlyZXR1cm4gZS5zZGtOYW1lO3ZhciB0PVwiUHViTnViLUpTLVwiK2Uuc2RrRmFtaWx5O3JldHVybiBlLnBhcnRuZXJJZCYmKHQrPVwiLVwiK2UucGFydG5lcklkKSx0Kz1cIi9cIitlLmdldFZlcnNpb24oKX1mdW5jdGlvbiBoKGUsdCxuKXt2YXIgcj1lLmNvbmZpZyxpPWUuY3J5cHRvO24udGltZXN0YW1wPU1hdGguZmxvb3IoKG5ldyBEYXRlKS5nZXRUaW1lKCkvMWUzKTt2YXIgcz1yLnN1YnNjcmliZUtleStcIlxcblwiK3IucHVibGlzaEtleStcIlxcblwiK3QrXCJcXG5cIjtzKz15LmRlZmF1bHQuc2lnblBhbUZyb21QYXJhbXMobik7dmFyIG89aS5ITUFDU0hBMjU2KHMpO289by5yZXBsYWNlKC9cXCsvZyxcIi1cIiksbz1vLnJlcGxhY2UoL1xcLy9nLFwiX1wiKSxuLnNpZ25hdHVyZT1vfU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pLHQuZGVmYXVsdD1mdW5jdGlvbihlLHQpe3ZhciBuPWUubmV0d29ya2luZyxyPWUuY29uZmlnLGk9bnVsbCxzPW51bGwsbz17fTt0LmdldE9wZXJhdGlvbigpPT09Xy5kZWZhdWx0LlBOVGltZU9wZXJhdGlvbnx8dC5nZXRPcGVyYXRpb24oKT09PV8uZGVmYXVsdC5QTkNoYW5uZWxHcm91cHNPcGVyYXRpb24/aT1hcmd1bWVudHMubGVuZ3RoPD0yP3ZvaWQgMDphcmd1bWVudHNbMl06KG89YXJndW1lbnRzLmxlbmd0aDw9Mj92b2lkIDA6YXJndW1lbnRzWzJdLGk9YXJndW1lbnRzLmxlbmd0aDw9Mz92b2lkIDA6YXJndW1lbnRzWzNdKSxcInVuZGVmaW5lZFwiPT10eXBlb2YgUHJvbWlzZXx8aXx8KHM9eS5kZWZhdWx0LmNyZWF0ZVByb21pc2UoKSk7dmFyIGE9dC52YWxpZGF0ZVBhcmFtcyhlLG8pO2lmKCFhKXt2YXIgZj10LnByZXBhcmVQYXJhbXMoZSxvKSxkPWModCxlLG8pLGc9dm9pZCAwLGI9e3VybDpkLG9wZXJhdGlvbjp0LmdldE9wZXJhdGlvbigpLHRpbWVvdXQ6dC5nZXRSZXF1ZXN0VGltZW91dChlKX07Zi51dWlkPXIuVVVJRCxmLnBuc2RrPWwociksci51c2VJbnN0YW5jZUlkJiYoZi5pbnN0YW5jZWlkPXIuaW5zdGFuY2VJZCksci51c2VSZXF1ZXN0SWQmJihmLnJlcXVlc3RpZD1wLmRlZmF1bHQuY3JlYXRlVVVJRCgpKSx0LmlzQXV0aFN1cHBvcnRlZCgpJiZyLmdldEF1dGhLZXkoKSYmKGYuYXV0aD1yLmdldEF1dGhLZXkoKSksci5zZWNyZXRLZXkmJmgoZSxkLGYpO3ZhciBtPWZ1bmN0aW9uKG4scil7aWYobi5lcnJvcilyZXR1cm4gdm9pZChpP2kobik6cyYmcy5yZWplY3QobmV3IHYoXCJQdWJOdWIgY2FsbCBmYWlsZWQsIGNoZWNrIHN0YXR1cyBmb3IgZGV0YWlsc1wiLG4pKSk7dmFyIGE9dC5oYW5kbGVSZXNwb25zZShlLHIsbyk7aT9pKG4sYSk6cyYmcy5mdWxmaWxsKGEpfTtpZih0LnVzZVBvc3QmJnQudXNlUG9zdChlLG8pKXt2YXIgaz10LnBvc3RQYXlsb2FkKGUsbyk7Zz1uLlBPU1QoZixrLGIsbSl9ZWxzZSBnPXQudXNlRGVsZXRlJiZ0LnVzZURlbGV0ZSgpP24uREVMRVRFKGYsYixtKTpuLkdFVChmLGIsbSk7cmV0dXJuIHQuZ2V0T3BlcmF0aW9uKCk9PT1fLmRlZmF1bHQuUE5TdWJzY3JpYmVPcGVyYXRpb24/ZzpzP3MucHJvbWlzZTp2b2lkIDB9cmV0dXJuIGk/aSh1KGEpKTpzPyhzLnJlamVjdChuZXcgdihcIlZhbGlkYXRpb24gZmFpbGVkLCBjaGVjayBzdGF0dXMgZm9yIGRldGFpbHNcIix1KGEpKSkscy5wcm9taXNlKTp2b2lkIDB9O3ZhciBmPW4oMykscD1yKGYpLGQ9KG4oNSksbigxNSkpLHk9cihkKSxnPW4oMiksYj0ocihnKSxuKDEzKSksXz1yKGIpLHY9ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdChlLG4pe2kodGhpcyx0KTt2YXIgcj1zKHRoaXMsKHQuX19wcm90b19ffHxPYmplY3QuZ2V0UHJvdG90eXBlT2YodCkpLmNhbGwodGhpcyxlKSk7cmV0dXJuIHIubmFtZT1yLmNvbnN0cnVjdG9yLm5hbWUsci5zdGF0dXM9bixyLm1lc3NhZ2U9ZSxyfXJldHVybiBvKHQsZSksdH0oRXJyb3IpO2UuZXhwb3J0cz10LmRlZmF1bHR9LGZ1bmN0aW9uKGUsdCxuKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiByKGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7ZGVmYXVsdDplfX1mdW5jdGlvbiBpKCl7cmV0dXJuIGYuZGVmYXVsdC5QTkFkZENoYW5uZWxzVG9Hcm91cE9wZXJhdGlvbn1mdW5jdGlvbiBzKGUsdCl7dmFyIG49dC5jaGFubmVscyxyPXQuY2hhbm5lbEdyb3VwLGk9ZS5jb25maWc7cmV0dXJuIHI/biYmMCE9PW4ubGVuZ3RoP2kuc3Vic2NyaWJlS2V5P3ZvaWQgMDpcIk1pc3NpbmcgU3Vic2NyaWJlIEtleVwiOlwiTWlzc2luZyBDaGFubmVsc1wiOlwiTWlzc2luZyBDaGFubmVsIEdyb3VwXCJ9ZnVuY3Rpb24gbyhlLHQpe3ZhciBuPXQuY2hhbm5lbEdyb3VwO3JldHVyblwiL3YxL2NoYW5uZWwtcmVnaXN0cmF0aW9uL3N1Yi1rZXkvXCIrZS5jb25maWcuc3Vic2NyaWJlS2V5K1wiL2NoYW5uZWwtZ3JvdXAvXCIrZC5kZWZhdWx0LmVuY29kZVN0cmluZyhuKX1mdW5jdGlvbiBhKGUpe3JldHVybiBlLmNvbmZpZy5nZXRUcmFuc2FjdGlvblRpbWVvdXQoKX1mdW5jdGlvbiB1KCl7cmV0dXJuITB9ZnVuY3Rpb24gYyhlLHQpe3ZhciBuPXQuY2hhbm5lbHM7cmV0dXJue2FkZDoodm9pZCAwPT09bj9bXTpuKS5qb2luKFwiLFwiKX19ZnVuY3Rpb24gbCgpe3JldHVybnt9fU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pLHQuZ2V0T3BlcmF0aW9uPWksdC52YWxpZGF0ZVBhcmFtcz1zLHQuZ2V0VVJMPW8sdC5nZXRSZXF1ZXN0VGltZW91dD1hLHQuaXNBdXRoU3VwcG9ydGVkPXUsdC5wcmVwYXJlUGFyYW1zPWMsdC5oYW5kbGVSZXNwb25zZT1sO3ZhciBoPShuKDUpLG4oMTMpKSxmPXIoaCkscD1uKDE1KSxkPXIocCl9LGZ1bmN0aW9uKGUsdCxuKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiByKGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7ZGVmYXVsdDplfX1mdW5jdGlvbiBpKCl7cmV0dXJuIGYuZGVmYXVsdC5QTlJlbW92ZUNoYW5uZWxzRnJvbUdyb3VwT3BlcmF0aW9ufWZ1bmN0aW9uIHMoZSx0KXt2YXIgbj10LmNoYW5uZWxzLHI9dC5jaGFubmVsR3JvdXAsaT1lLmNvbmZpZztyZXR1cm4gcj9uJiYwIT09bi5sZW5ndGg/aS5zdWJzY3JpYmVLZXk/dm9pZCAwOlwiTWlzc2luZyBTdWJzY3JpYmUgS2V5XCI6XCJNaXNzaW5nIENoYW5uZWxzXCI6XCJNaXNzaW5nIENoYW5uZWwgR3JvdXBcIn1mdW5jdGlvbiBvKGUsdCl7dmFyIG49dC5jaGFubmVsR3JvdXA7cmV0dXJuXCIvdjEvY2hhbm5lbC1yZWdpc3RyYXRpb24vc3ViLWtleS9cIitlLmNvbmZpZy5zdWJzY3JpYmVLZXkrXCIvY2hhbm5lbC1ncm91cC9cIitkLmRlZmF1bHQuZW5jb2RlU3RyaW5nKG4pfWZ1bmN0aW9uIGEoZSl7cmV0dXJuIGUuY29uZmlnLmdldFRyYW5zYWN0aW9uVGltZW91dCgpfWZ1bmN0aW9uIHUoKXtyZXR1cm4hMH1mdW5jdGlvbiBjKGUsdCl7dmFyIG49dC5jaGFubmVscztyZXR1cm57cmVtb3ZlOih2b2lkIDA9PT1uP1tdOm4pLmpvaW4oXCIsXCIpfX1mdW5jdGlvbiBsKCl7cmV0dXJue319T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSksdC5nZXRPcGVyYXRpb249aSx0LnZhbGlkYXRlUGFyYW1zPXMsdC5nZXRVUkw9byx0LmdldFJlcXVlc3RUaW1lb3V0PWEsdC5pc0F1dGhTdXBwb3J0ZWQ9dSx0LnByZXBhcmVQYXJhbXM9Yyx0LmhhbmRsZVJlc3BvbnNlPWw7dmFyIGg9KG4oNSksbigxMykpLGY9cihoKSxwPW4oMTUpLGQ9cihwKX0sZnVuY3Rpb24oZSx0LG4pe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIHIoZSl7cmV0dXJuIGUmJmUuX19lc01vZHVsZT9lOntkZWZhdWx0OmV9fWZ1bmN0aW9uIGkoKXtyZXR1cm4gZi5kZWZhdWx0LlBOUmVtb3ZlR3JvdXBPcGVyYXRpb259ZnVuY3Rpb24gcyhlLHQpe3ZhciBuPXQuY2hhbm5lbEdyb3VwLHI9ZS5jb25maWc7cmV0dXJuIG4/ci5zdWJzY3JpYmVLZXk/dm9pZCAwOlwiTWlzc2luZyBTdWJzY3JpYmUgS2V5XCI6XCJNaXNzaW5nIENoYW5uZWwgR3JvdXBcIn1mdW5jdGlvbiBvKGUsdCl7dmFyIG49dC5jaGFubmVsR3JvdXA7cmV0dXJuXCIvdjEvY2hhbm5lbC1yZWdpc3RyYXRpb24vc3ViLWtleS9cIitlLmNvbmZpZy5zdWJzY3JpYmVLZXkrXCIvY2hhbm5lbC1ncm91cC9cIitkLmRlZmF1bHQuZW5jb2RlU3RyaW5nKG4pK1wiL3JlbW92ZVwifWZ1bmN0aW9uIGEoKXtyZXR1cm4hMH1mdW5jdGlvbiB1KGUpe3JldHVybiBlLmNvbmZpZy5nZXRUcmFuc2FjdGlvblRpbWVvdXQoKX1mdW5jdGlvbiBjKCl7cmV0dXJue319ZnVuY3Rpb24gbCgpe3JldHVybnt9fU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pLHQuZ2V0T3BlcmF0aW9uPWksdC52YWxpZGF0ZVBhcmFtcz1zLHQuZ2V0VVJMPW8sdC5pc0F1dGhTdXBwb3J0ZWQ9YSx0LmdldFJlcXVlc3RUaW1lb3V0PXUsdC5wcmVwYXJlUGFyYW1zPWMsdC5oYW5kbGVSZXNwb25zZT1sO3ZhciBoPShuKDUpLG4oMTMpKSxmPXIoaCkscD1uKDE1KSxkPXIocCl9LGZ1bmN0aW9uKGUsdCxuKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiByKCl7cmV0dXJuIGguZGVmYXVsdC5QTkNoYW5uZWxHcm91cHNPcGVyYXRpb259ZnVuY3Rpb24gaShlKXtpZighZS5jb25maWcuc3Vic2NyaWJlS2V5KXJldHVyblwiTWlzc2luZyBTdWJzY3JpYmUgS2V5XCJ9ZnVuY3Rpb24gcyhlKXtyZXR1cm5cIi92MS9jaGFubmVsLXJlZ2lzdHJhdGlvbi9zdWIta2V5L1wiK2UuY29uZmlnLnN1YnNjcmliZUtleStcIi9jaGFubmVsLWdyb3VwXCJ9ZnVuY3Rpb24gbyhlKXtyZXR1cm4gZS5jb25maWcuZ2V0VHJhbnNhY3Rpb25UaW1lb3V0KCl9ZnVuY3Rpb24gYSgpe3JldHVybiEwfWZ1bmN0aW9uIHUoKXtyZXR1cm57fX1mdW5jdGlvbiBjKGUsdCl7cmV0dXJue2dyb3Vwczp0LnBheWxvYWQuZ3JvdXBzfX1PYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KSx0LmdldE9wZXJhdGlvbj1yLHQudmFsaWRhdGVQYXJhbXM9aSx0LmdldFVSTD1zLHQuZ2V0UmVxdWVzdFRpbWVvdXQ9byx0LmlzQXV0aFN1cHBvcnRlZD1hLHQucHJlcGFyZVBhcmFtcz11LHQuaGFuZGxlUmVzcG9uc2U9Yzt2YXIgbD0obig1KSxuKDEzKSksaD1mdW5jdGlvbihlKXtyZXR1cm4gZSYmZS5fX2VzTW9kdWxlP2U6e2RlZmF1bHQ6ZX19KGwpfSxmdW5jdGlvbihlLHQsbil7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gcihlKXtyZXR1cm4gZSYmZS5fX2VzTW9kdWxlP2U6e2RlZmF1bHQ6ZX19ZnVuY3Rpb24gaSgpe3JldHVybiBmLmRlZmF1bHQuUE5DaGFubmVsc0Zvckdyb3VwT3BlcmF0aW9ufWZ1bmN0aW9uIHMoZSx0KXt2YXIgbj10LmNoYW5uZWxHcm91cCxyPWUuY29uZmlnO3JldHVybiBuP3Iuc3Vic2NyaWJlS2V5P3ZvaWQgMDpcIk1pc3NpbmcgU3Vic2NyaWJlIEtleVwiOlwiTWlzc2luZyBDaGFubmVsIEdyb3VwXCJ9ZnVuY3Rpb24gbyhlLHQpe3ZhciBuPXQuY2hhbm5lbEdyb3VwO3JldHVyblwiL3YxL2NoYW5uZWwtcmVnaXN0cmF0aW9uL3N1Yi1rZXkvXCIrZS5jb25maWcuc3Vic2NyaWJlS2V5K1wiL2NoYW5uZWwtZ3JvdXAvXCIrZC5kZWZhdWx0LmVuY29kZVN0cmluZyhuKX1mdW5jdGlvbiBhKGUpe3JldHVybiBlLmNvbmZpZy5nZXRUcmFuc2FjdGlvblRpbWVvdXQoKX1mdW5jdGlvbiB1KCl7cmV0dXJuITB9ZnVuY3Rpb24gYygpe3JldHVybnt9fWZ1bmN0aW9uIGwoZSx0KXtyZXR1cm57Y2hhbm5lbHM6dC5wYXlsb2FkLmNoYW5uZWxzfX1PYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KSx0LmdldE9wZXJhdGlvbj1pLHQudmFsaWRhdGVQYXJhbXM9cyx0LmdldFVSTD1vLHQuZ2V0UmVxdWVzdFRpbWVvdXQ9YSx0LmlzQXV0aFN1cHBvcnRlZD11LHQucHJlcGFyZVBhcmFtcz1jLHQuaGFuZGxlUmVzcG9uc2U9bDt2YXIgaD0obig1KSxuKDEzKSksZj1yKGgpLHA9bigxNSksZD1yKHApfSxmdW5jdGlvbihlLHQsbil7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gcigpe3JldHVybiBoLmRlZmF1bHQuUE5QdXNoTm90aWZpY2F0aW9uRW5hYmxlZENoYW5uZWxzT3BlcmF0aW9ufWZ1bmN0aW9uIGkoZSx0KXt2YXIgbj10LmRldmljZSxyPXQucHVzaEdhdGV3YXksaT10LmNoYW5uZWxzLHM9ZS5jb25maWc7cmV0dXJuIG4/cj9pJiYwIT09aS5sZW5ndGg/cy5zdWJzY3JpYmVLZXk/dm9pZCAwOlwiTWlzc2luZyBTdWJzY3JpYmUgS2V5XCI6XCJNaXNzaW5nIENoYW5uZWxzXCI6XCJNaXNzaW5nIEdXIFR5cGUgKHB1c2hHYXRld2F5OiBnY20gb3IgYXBucylcIjpcIk1pc3NpbmcgRGV2aWNlIElEIChkZXZpY2UpXCJ9ZnVuY3Rpb24gcyhlLHQpe3ZhciBuPXQuZGV2aWNlO3JldHVyblwiL3YxL3B1c2gvc3ViLWtleS9cIitlLmNvbmZpZy5zdWJzY3JpYmVLZXkrXCIvZGV2aWNlcy9cIitufWZ1bmN0aW9uIG8oZSl7cmV0dXJuIGUuY29uZmlnLmdldFRyYW5zYWN0aW9uVGltZW91dCgpfWZ1bmN0aW9uIGEoKXtyZXR1cm4hMH1mdW5jdGlvbiB1KGUsdCl7dmFyIG49dC5wdXNoR2F0ZXdheSxyPXQuY2hhbm5lbHM7cmV0dXJue3R5cGU6bixhZGQ6KHZvaWQgMD09PXI/W106cikuam9pbihcIixcIil9fWZ1bmN0aW9uIGMoKXtyZXR1cm57fX1PYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KSx0LmdldE9wZXJhdGlvbj1yLHQudmFsaWRhdGVQYXJhbXM9aSx0LmdldFVSTD1zLHQuZ2V0UmVxdWVzdFRpbWVvdXQ9byx0LmlzQXV0aFN1cHBvcnRlZD1hLHQucHJlcGFyZVBhcmFtcz11LHQuaGFuZGxlUmVzcG9uc2U9Yzt2YXIgbD0obig1KSxuKDEzKSksaD1mdW5jdGlvbihlKXtyZXR1cm4gZSYmZS5fX2VzTW9kdWxlP2U6e2RlZmF1bHQ6ZX19KGwpfSxmdW5jdGlvbihlLHQsbil7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gcigpe3JldHVybiBoLmRlZmF1bHQuUE5QdXNoTm90aWZpY2F0aW9uRW5hYmxlZENoYW5uZWxzT3BlcmF0aW9ufWZ1bmN0aW9uIGkoZSx0KXt2YXIgbj10LmRldmljZSxyPXQucHVzaEdhdGV3YXksaT10LmNoYW5uZWxzLHM9ZS5jb25maWc7cmV0dXJuIG4/cj9pJiYwIT09aS5sZW5ndGg/cy5zdWJzY3JpYmVLZXk/dm9pZCAwOlwiTWlzc2luZyBTdWJzY3JpYmUgS2V5XCI6XCJNaXNzaW5nIENoYW5uZWxzXCI6XCJNaXNzaW5nIEdXIFR5cGUgKHB1c2hHYXRld2F5OiBnY20gb3IgYXBucylcIjpcIk1pc3NpbmcgRGV2aWNlIElEIChkZXZpY2UpXCJ9ZnVuY3Rpb24gcyhlLHQpe3ZhciBuPXQuZGV2aWNlO3JldHVyblwiL3YxL3B1c2gvc3ViLWtleS9cIitlLmNvbmZpZy5zdWJzY3JpYmVLZXkrXCIvZGV2aWNlcy9cIitufWZ1bmN0aW9uIG8oZSl7cmV0dXJuIGUuY29uZmlnLmdldFRyYW5zYWN0aW9uVGltZW91dCgpfWZ1bmN0aW9uIGEoKXtyZXR1cm4hMH1mdW5jdGlvbiB1KGUsdCl7dmFyIG49dC5wdXNoR2F0ZXdheSxyPXQuY2hhbm5lbHM7cmV0dXJue3R5cGU6bixyZW1vdmU6KHZvaWQgMD09PXI/W106cikuam9pbihcIixcIil9fWZ1bmN0aW9uIGMoKXtyZXR1cm57fX1PYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KSx0LmdldE9wZXJhdGlvbj1yLHQudmFsaWRhdGVQYXJhbXM9aSx0LmdldFVSTD1zLHQuZ2V0UmVxdWVzdFRpbWVvdXQ9byx0LmlzQXV0aFN1cHBvcnRlZD1hLHQucHJlcGFyZVBhcmFtcz11LHQuaGFuZGxlUmVzcG9uc2U9Yzt2YXIgbD0obig1KSxuKDEzKSksaD1mdW5jdGlvbihlKXtyZXR1cm4gZSYmZS5fX2VzTW9kdWxlP2U6e2RlZmF1bHQ6ZX19KGwpfSxmdW5jdGlvbihlLHQsbil7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gcigpe3JldHVybiBoLmRlZmF1bHQuUE5QdXNoTm90aWZpY2F0aW9uRW5hYmxlZENoYW5uZWxzT3BlcmF0aW9ufWZ1bmN0aW9uIGkoZSx0KXt2YXIgbj10LmRldmljZSxyPXQucHVzaEdhdGV3YXksaT1lLmNvbmZpZztyZXR1cm4gbj9yP2kuc3Vic2NyaWJlS2V5P3ZvaWQgMDpcIk1pc3NpbmcgU3Vic2NyaWJlIEtleVwiOlwiTWlzc2luZyBHVyBUeXBlIChwdXNoR2F0ZXdheTogZ2NtIG9yIGFwbnMpXCI6XCJNaXNzaW5nIERldmljZSBJRCAoZGV2aWNlKVwifWZ1bmN0aW9uIHMoZSx0KXt2YXIgbj10LmRldmljZTtyZXR1cm5cIi92MS9wdXNoL3N1Yi1rZXkvXCIrZS5jb25maWcuc3Vic2NyaWJlS2V5K1wiL2RldmljZXMvXCIrbn1mdW5jdGlvbiBvKGUpe3JldHVybiBlLmNvbmZpZy5nZXRUcmFuc2FjdGlvblRpbWVvdXQoKX1mdW5jdGlvbiBhKCl7cmV0dXJuITB9ZnVuY3Rpb24gdShlLHQpe3JldHVybnt0eXBlOnQucHVzaEdhdGV3YXl9fWZ1bmN0aW9uIGMoZSx0KXtyZXR1cm57Y2hhbm5lbHM6dH19T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSksdC5nZXRPcGVyYXRpb249cix0LnZhbGlkYXRlUGFyYW1zPWksdC5nZXRVUkw9cyx0LmdldFJlcXVlc3RUaW1lb3V0PW8sdC5pc0F1dGhTdXBwb3J0ZWQ9YSx0LnByZXBhcmVQYXJhbXM9dSx0LmhhbmRsZVJlc3BvbnNlPWM7dmFyIGw9KG4oNSksbigxMykpLGg9ZnVuY3Rpb24oZSl7cmV0dXJuIGUmJmUuX19lc01vZHVsZT9lOntkZWZhdWx0OmV9fShsKX0sZnVuY3Rpb24oZSx0LG4pe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIHIoKXtyZXR1cm4gaC5kZWZhdWx0LlBOUmVtb3ZlQWxsUHVzaE5vdGlmaWNhdGlvbnNPcGVyYXRpb259ZnVuY3Rpb24gaShlLHQpe3ZhciBuPXQuZGV2aWNlLHI9dC5wdXNoR2F0ZXdheSxpPWUuY29uZmlnO3JldHVybiBuP3I/aS5zdWJzY3JpYmVLZXk/dm9pZCAwOlwiTWlzc2luZyBTdWJzY3JpYmUgS2V5XCI6XCJNaXNzaW5nIEdXIFR5cGUgKHB1c2hHYXRld2F5OiBnY20gb3IgYXBucylcIjpcIk1pc3NpbmcgRGV2aWNlIElEIChkZXZpY2UpXCJ9ZnVuY3Rpb24gcyhlLHQpe3ZhciBuPXQuZGV2aWNlO3JldHVyblwiL3YxL3B1c2gvc3ViLWtleS9cIitlLmNvbmZpZy5zdWJzY3JpYmVLZXkrXCIvZGV2aWNlcy9cIituK1wiL3JlbW92ZVwifWZ1bmN0aW9uIG8oZSl7cmV0dXJuIGUuY29uZmlnLmdldFRyYW5zYWN0aW9uVGltZW91dCgpfWZ1bmN0aW9uIGEoKXtyZXR1cm4hMH1mdW5jdGlvbiB1KGUsdCl7cmV0dXJue3R5cGU6dC5wdXNoR2F0ZXdheX19ZnVuY3Rpb24gYygpe3JldHVybnt9fU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pLHQuZ2V0T3BlcmF0aW9uPXIsdC52YWxpZGF0ZVBhcmFtcz1pLHQuZ2V0VVJMPXMsdC5nZXRSZXF1ZXN0VGltZW91dD1vLHQuaXNBdXRoU3VwcG9ydGVkPWEsdC5wcmVwYXJlUGFyYW1zPXUsdC5oYW5kbGVSZXNwb25zZT1jO3ZhciBsPShuKDUpLG4oMTMpKSxoPWZ1bmN0aW9uKGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7ZGVmYXVsdDplfX0obCl9LGZ1bmN0aW9uKGUsdCxuKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiByKGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7ZGVmYXVsdDplfX1mdW5jdGlvbiBpKCl7cmV0dXJuIGYuZGVmYXVsdC5QTlVuc3Vic2NyaWJlT3BlcmF0aW9ufWZ1bmN0aW9uIHMoZSl7aWYoIWUuY29uZmlnLnN1YnNjcmliZUtleSlyZXR1cm5cIk1pc3NpbmcgU3Vic2NyaWJlIEtleVwifWZ1bmN0aW9uIG8oZSx0KXt2YXIgbj1lLmNvbmZpZyxyPXQuY2hhbm5lbHMsaT12b2lkIDA9PT1yP1tdOnIscz1pLmxlbmd0aD4wP2kuam9pbihcIixcIik6XCIsXCI7cmV0dXJuXCIvdjIvcHJlc2VuY2Uvc3ViLWtleS9cIituLnN1YnNjcmliZUtleStcIi9jaGFubmVsL1wiK2QuZGVmYXVsdC5lbmNvZGVTdHJpbmcocykrXCIvbGVhdmVcIn1mdW5jdGlvbiBhKGUpe3JldHVybiBlLmNvbmZpZy5nZXRUcmFuc2FjdGlvblRpbWVvdXQoKX1mdW5jdGlvbiB1KCl7cmV0dXJuITB9ZnVuY3Rpb24gYyhlLHQpe3ZhciBuPXQuY2hhbm5lbEdyb3VwcyxyPXZvaWQgMD09PW4/W106bixpPXt9O3JldHVybiByLmxlbmd0aD4wJiYoaVtcImNoYW5uZWwtZ3JvdXBcIl09ci5qb2luKFwiLFwiKSksaX1mdW5jdGlvbiBsKCl7cmV0dXJue319T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSksdC5nZXRPcGVyYXRpb249aSx0LnZhbGlkYXRlUGFyYW1zPXMsdC5nZXRVUkw9byx0LmdldFJlcXVlc3RUaW1lb3V0PWEsdC5pc0F1dGhTdXBwb3J0ZWQ9dSx0LnByZXBhcmVQYXJhbXM9Yyx0LmhhbmRsZVJlc3BvbnNlPWw7dmFyIGg9KG4oNSksbigxMykpLGY9cihoKSxwPW4oMTUpLGQ9cihwKX0sZnVuY3Rpb24oZSx0LG4pe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIHIoKXtyZXR1cm4gaC5kZWZhdWx0LlBOV2hlcmVOb3dPcGVyYXRpb259ZnVuY3Rpb24gaShlKXtpZighZS5jb25maWcuc3Vic2NyaWJlS2V5KXJldHVyblwiTWlzc2luZyBTdWJzY3JpYmUgS2V5XCJ9ZnVuY3Rpb24gcyhlLHQpe3ZhciBuPWUuY29uZmlnLHI9dC51dWlkLGk9dm9pZCAwPT09cj9uLlVVSUQ6cjtyZXR1cm5cIi92Mi9wcmVzZW5jZS9zdWIta2V5L1wiK24uc3Vic2NyaWJlS2V5K1wiL3V1aWQvXCIraX1mdW5jdGlvbiBvKGUpe3JldHVybiBlLmNvbmZpZy5nZXRUcmFuc2FjdGlvblRpbWVvdXQoKX1mdW5jdGlvbiBhKCl7cmV0dXJuITB9ZnVuY3Rpb24gdSgpe3JldHVybnt9fWZ1bmN0aW9uIGMoZSx0KXtyZXR1cm4gdC5wYXlsb2FkP3tjaGFubmVsczp0LnBheWxvYWQuY2hhbm5lbHN9OntjaGFubmVsczpbXX19T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSksdC5nZXRPcGVyYXRpb249cix0LnZhbGlkYXRlUGFyYW1zPWksdC5nZXRVUkw9cyx0LmdldFJlcXVlc3RUaW1lb3V0PW8sdC5pc0F1dGhTdXBwb3J0ZWQ9YSx0LnByZXBhcmVQYXJhbXM9dSx0LmhhbmRsZVJlc3BvbnNlPWM7dmFyIGw9KG4oNSksbigxMykpLGg9ZnVuY3Rpb24oZSl7cmV0dXJuIGUmJmUuX19lc01vZHVsZT9lOntkZWZhdWx0OmV9fShsKX0sZnVuY3Rpb24oZSx0LG4pe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIHIoZSl7cmV0dXJuIGUmJmUuX19lc01vZHVsZT9lOntkZWZhdWx0OmV9fWZ1bmN0aW9uIGkoKXtyZXR1cm4gZi5kZWZhdWx0LlBOSGVhcnRiZWF0T3BlcmF0aW9ufWZ1bmN0aW9uIHMoZSl7aWYoIWUuY29uZmlnLnN1YnNjcmliZUtleSlyZXR1cm5cIk1pc3NpbmcgU3Vic2NyaWJlIEtleVwifWZ1bmN0aW9uIG8oZSx0KXt2YXIgbj1lLmNvbmZpZyxyPXQuY2hhbm5lbHMsaT12b2lkIDA9PT1yP1tdOnIscz1pLmxlbmd0aD4wP2kuam9pbihcIixcIik6XCIsXCI7cmV0dXJuXCIvdjIvcHJlc2VuY2Uvc3ViLWtleS9cIituLnN1YnNjcmliZUtleStcIi9jaGFubmVsL1wiK2QuZGVmYXVsdC5lbmNvZGVTdHJpbmcocykrXCIvaGVhcnRiZWF0XCJ9ZnVuY3Rpb24gYSgpe3JldHVybiEwfWZ1bmN0aW9uIHUoZSl7cmV0dXJuIGUuY29uZmlnLmdldFRyYW5zYWN0aW9uVGltZW91dCgpfWZ1bmN0aW9uIGMoZSx0KXt2YXIgbj10LmNoYW5uZWxHcm91cHMscj12b2lkIDA9PT1uP1tdOm4saT10LnN0YXRlLHM9dm9pZCAwPT09aT97fTppLG89ZS5jb25maWcsYT17fTtyZXR1cm4gci5sZW5ndGg+MCYmKGFbXCJjaGFubmVsLWdyb3VwXCJdPXIuam9pbihcIixcIikpLGEuc3RhdGU9SlNPTi5zdHJpbmdpZnkocyksYS5oZWFydGJlYXQ9by5nZXRQcmVzZW5jZVRpbWVvdXQoKSxhfWZ1bmN0aW9uIGwoKXtyZXR1cm57fX1PYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KSx0LmdldE9wZXJhdGlvbj1pLHQudmFsaWRhdGVQYXJhbXM9cyx0LmdldFVSTD1vLHQuaXNBdXRoU3VwcG9ydGVkPWEsdC5nZXRSZXF1ZXN0VGltZW91dD11LHQucHJlcGFyZVBhcmFtcz1jLHQuaGFuZGxlUmVzcG9uc2U9bDt2YXIgaD0obig1KSxuKDEzKSksZj1yKGgpLHA9bigxNSksZD1yKHApfSxmdW5jdGlvbihlLHQsbil7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gcihlKXtyZXR1cm4gZSYmZS5fX2VzTW9kdWxlP2U6e2RlZmF1bHQ6ZX19ZnVuY3Rpb24gaSgpe3JldHVybiBmLmRlZmF1bHQuUE5HZXRTdGF0ZU9wZXJhdGlvbn1mdW5jdGlvbiBzKGUpe2lmKCFlLmNvbmZpZy5zdWJzY3JpYmVLZXkpcmV0dXJuXCJNaXNzaW5nIFN1YnNjcmliZSBLZXlcIn1mdW5jdGlvbiBvKGUsdCl7dmFyIG49ZS5jb25maWcscj10LnV1aWQsaT12b2lkIDA9PT1yP24uVVVJRDpyLHM9dC5jaGFubmVscyxvPXZvaWQgMD09PXM/W106cyxhPW8ubGVuZ3RoPjA/by5qb2luKFwiLFwiKTpcIixcIjtyZXR1cm5cIi92Mi9wcmVzZW5jZS9zdWIta2V5L1wiK24uc3Vic2NyaWJlS2V5K1wiL2NoYW5uZWwvXCIrZC5kZWZhdWx0LmVuY29kZVN0cmluZyhhKStcIi91dWlkL1wiK2l9ZnVuY3Rpb24gYShlKXtyZXR1cm4gZS5jb25maWcuZ2V0VHJhbnNhY3Rpb25UaW1lb3V0KCl9ZnVuY3Rpb24gdSgpe3JldHVybiEwfWZ1bmN0aW9uIGMoZSx0KXt2YXIgbj10LmNoYW5uZWxHcm91cHMscj12b2lkIDA9PT1uP1tdOm4saT17fTtyZXR1cm4gci5sZW5ndGg+MCYmKGlbXCJjaGFubmVsLWdyb3VwXCJdPXIuam9pbihcIixcIikpLGl9ZnVuY3Rpb24gbChlLHQsbil7dmFyIHI9bi5jaGFubmVscyxpPXZvaWQgMD09PXI/W106cixzPW4uY2hhbm5lbEdyb3VwcyxvPXZvaWQgMD09PXM/W106cyxhPXt9O3JldHVybiAxPT09aS5sZW5ndGgmJjA9PT1vLmxlbmd0aD9hW2lbMF1dPXQucGF5bG9hZDphPXQucGF5bG9hZCx7Y2hhbm5lbHM6YX19T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSksdC5nZXRPcGVyYXRpb249aSx0LnZhbGlkYXRlUGFyYW1zPXMsdC5nZXRVUkw9byx0LmdldFJlcXVlc3RUaW1lb3V0PWEsdC5pc0F1dGhTdXBwb3J0ZWQ9dSx0LnByZXBhcmVQYXJhbXM9Yyx0LmhhbmRsZVJlc3BvbnNlPWw7dmFyIGg9KG4oNSksbigxMykpLGY9cihoKSxwPW4oMTUpLGQ9cihwKX0sZnVuY3Rpb24oZSx0LG4pe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIHIoZSl7cmV0dXJuIGUmJmUuX19lc01vZHVsZT9lOntkZWZhdWx0OmV9fWZ1bmN0aW9uIGkoKXtyZXR1cm4gZi5kZWZhdWx0LlBOU2V0U3RhdGVPcGVyYXRpb259ZnVuY3Rpb24gcyhlLHQpe3ZhciBuPWUuY29uZmlnLHI9dC5zdGF0ZSxpPXQuY2hhbm5lbHMscz12b2lkIDA9PT1pP1tdOmksbz10LmNoYW5uZWxHcm91cHMsYT12b2lkIDA9PT1vP1tdOm87cmV0dXJuIHI/bi5zdWJzY3JpYmVLZXk/MD09PXMubGVuZ3RoJiYwPT09YS5sZW5ndGg/XCJQbGVhc2UgcHJvdmlkZSBhIGxpc3Qgb2YgY2hhbm5lbHMgYW5kL29yIGNoYW5uZWwtZ3JvdXBzXCI6dm9pZCAwOlwiTWlzc2luZyBTdWJzY3JpYmUgS2V5XCI6XCJNaXNzaW5nIFN0YXRlXCJ9ZnVuY3Rpb24gbyhlLHQpe3ZhciBuPWUuY29uZmlnLHI9dC5jaGFubmVscyxpPXZvaWQgMD09PXI/W106cixzPWkubGVuZ3RoPjA/aS5qb2luKFwiLFwiKTpcIixcIjtyZXR1cm5cIi92Mi9wcmVzZW5jZS9zdWIta2V5L1wiK24uc3Vic2NyaWJlS2V5K1wiL2NoYW5uZWwvXCIrZC5kZWZhdWx0LmVuY29kZVN0cmluZyhzKStcIi91dWlkL1wiK24uVVVJRCtcIi9kYXRhXCJ9ZnVuY3Rpb24gYShlKXtyZXR1cm4gZS5jb25maWcuZ2V0VHJhbnNhY3Rpb25UaW1lb3V0KCl9ZnVuY3Rpb24gdSgpe3JldHVybiEwfWZ1bmN0aW9uIGMoZSx0KXt2YXIgbj10LnN0YXRlLHI9dC5jaGFubmVsR3JvdXBzLGk9dm9pZCAwPT09cj9bXTpyLHM9e307cmV0dXJuIHMuc3RhdGU9SlNPTi5zdHJpbmdpZnkobiksaS5sZW5ndGg+MCYmKHNbXCJjaGFubmVsLWdyb3VwXCJdPWkuam9pbihcIixcIikpLHN9ZnVuY3Rpb24gbChlLHQpe3JldHVybntzdGF0ZTp0LnBheWxvYWR9fU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pLHQuZ2V0T3BlcmF0aW9uPWksdC52YWxpZGF0ZVBhcmFtcz1zLHQuZ2V0VVJMPW8sdC5nZXRSZXF1ZXN0VGltZW91dD1hLHQuaXNBdXRoU3VwcG9ydGVkPXUsdC5wcmVwYXJlUGFyYW1zPWMsdC5oYW5kbGVSZXNwb25zZT1sO3ZhciBoPShuKDUpLG4oMTMpKSxmPXIoaCkscD1uKDE1KSxkPXIocCl9LGZ1bmN0aW9uKGUsdCxuKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiByKGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7ZGVmYXVsdDplfX1mdW5jdGlvbiBpKCl7cmV0dXJuIGYuZGVmYXVsdC5QTkhlcmVOb3dPcGVyYXRpb259ZnVuY3Rpb24gcyhlKXtpZighZS5jb25maWcuc3Vic2NyaWJlS2V5KXJldHVyblwiTWlzc2luZyBTdWJzY3JpYmUgS2V5XCJ9ZnVuY3Rpb24gbyhlLHQpe3ZhciBuPWUuY29uZmlnLHI9dC5jaGFubmVscyxpPXZvaWQgMD09PXI/W106cixzPXQuY2hhbm5lbEdyb3VwcyxvPXZvaWQgMD09PXM/W106cyxhPVwiL3YyL3ByZXNlbmNlL3N1Yi1rZXkvXCIrbi5zdWJzY3JpYmVLZXk7aWYoaS5sZW5ndGg+MHx8by5sZW5ndGg+MCl7dmFyIHU9aS5sZW5ndGg+MD9pLmpvaW4oXCIsXCIpOlwiLFwiO2ErPVwiL2NoYW5uZWwvXCIrZC5kZWZhdWx0LmVuY29kZVN0cmluZyh1KX1yZXR1cm4gYX1mdW5jdGlvbiBhKGUpe3JldHVybiBlLmNvbmZpZy5nZXRUcmFuc2FjdGlvblRpbWVvdXQoKX1mdW5jdGlvbiB1KCl7cmV0dXJuITB9ZnVuY3Rpb24gYyhlLHQpe3ZhciBuPXQuY2hhbm5lbEdyb3VwcyxyPXZvaWQgMD09PW4/W106bixpPXQuaW5jbHVkZVVVSURzLHM9dm9pZCAwPT09aXx8aSxvPXQuaW5jbHVkZVN0YXRlLGE9dm9pZCAwIT09byYmbyx1PXt9O3JldHVybiBzfHwodS5kaXNhYmxlX3V1aWRzPTEpLGEmJih1LnN0YXRlPTEpLHIubGVuZ3RoPjAmJih1W1wiY2hhbm5lbC1ncm91cFwiXT1yLmpvaW4oXCIsXCIpKSx1fWZ1bmN0aW9uIGwoZSx0LG4pe3ZhciByPW4uY2hhbm5lbHMsaT12b2lkIDA9PT1yP1tdOnIscz1uLmNoYW5uZWxHcm91cHMsbz12b2lkIDA9PT1zP1tdOnMsYT1uLmluY2x1ZGVVVUlEcyx1PXZvaWQgMD09PWF8fGEsYz1uLmluY2x1ZGVTdGF0ZSxsPXZvaWQgMCE9PWMmJmM7cmV0dXJuIGkubGVuZ3RoPjF8fG8ubGVuZ3RoPjB8fDA9PT1vLmxlbmd0aCYmMD09PWkubGVuZ3RoP2Z1bmN0aW9uKCl7dmFyIGU9e307cmV0dXJuIGUudG90YWxDaGFubmVscz10LnBheWxvYWQudG90YWxfY2hhbm5lbHMsZS50b3RhbE9jY3VwYW5jeT10LnBheWxvYWQudG90YWxfb2NjdXBhbmN5LGUuY2hhbm5lbHM9e30sT2JqZWN0LmtleXModC5wYXlsb2FkLmNoYW5uZWxzKS5mb3JFYWNoKGZ1bmN0aW9uKG4pe3ZhciByPXQucGF5bG9hZC5jaGFubmVsc1tuXSxpPVtdO3JldHVybiBlLmNoYW5uZWxzW25dPXtvY2N1cGFudHM6aSxuYW1lOm4sb2NjdXBhbmN5OnIub2NjdXBhbmN5fSx1JiZyLnV1aWRzLmZvckVhY2goZnVuY3Rpb24oZSl7bD9pLnB1c2goe3N0YXRlOmUuc3RhdGUsdXVpZDplLnV1aWR9KTppLnB1c2goe3N0YXRlOm51bGwsdXVpZDplfSl9KSxlfSksZX0oKTpmdW5jdGlvbigpe3ZhciBlPXt9LG49W107cmV0dXJuIGUudG90YWxDaGFubmVscz0xLGUudG90YWxPY2N1cGFuY3k9dC5vY2N1cGFuY3ksZS5jaGFubmVscz17fSxlLmNoYW5uZWxzW2lbMF1dPXtvY2N1cGFudHM6bixuYW1lOmlbMF0sb2NjdXBhbmN5OnQub2NjdXBhbmN5fSx1JiZ0LnV1aWRzJiZ0LnV1aWRzLmZvckVhY2goZnVuY3Rpb24oZSl7bD9uLnB1c2goe3N0YXRlOmUuc3RhdGUsdXVpZDplLnV1aWR9KTpuLnB1c2goe3N0YXRlOm51bGwsdXVpZDplfSl9KSxlfSgpfU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pLHQuZ2V0T3BlcmF0aW9uPWksdC52YWxpZGF0ZVBhcmFtcz1zLHQuZ2V0VVJMPW8sdC5nZXRSZXF1ZXN0VGltZW91dD1hLHQuaXNBdXRoU3VwcG9ydGVkPXUsdC5wcmVwYXJlUGFyYW1zPWMsdC5oYW5kbGVSZXNwb25zZT1sO3ZhciBoPShuKDUpLG4oMTMpKSxmPXIoaCkscD1uKDE1KSxkPXIocCl9LGZ1bmN0aW9uKGUsdCxuKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiByKCl7cmV0dXJuIGguZGVmYXVsdC5QTkFjY2Vzc01hbmFnZXJBdWRpdH1mdW5jdGlvbiBpKGUpe2lmKCFlLmNvbmZpZy5zdWJzY3JpYmVLZXkpcmV0dXJuXCJNaXNzaW5nIFN1YnNjcmliZSBLZXlcIn1mdW5jdGlvbiBzKGUpe3JldHVyblwiL3YyL2F1dGgvYXVkaXQvc3ViLWtleS9cIitlLmNvbmZpZy5zdWJzY3JpYmVLZXl9ZnVuY3Rpb24gbyhlKXtyZXR1cm4gZS5jb25maWcuZ2V0VHJhbnNhY3Rpb25UaW1lb3V0KCl9ZnVuY3Rpb24gYSgpe3JldHVybiExfWZ1bmN0aW9uIHUoZSx0KXt2YXIgbj10LmNoYW5uZWwscj10LmNoYW5uZWxHcm91cCxpPXQuYXV0aEtleXMscz12b2lkIDA9PT1pP1tdOmksbz17fTtyZXR1cm4gbiYmKG8uY2hhbm5lbD1uKSxyJiYob1tcImNoYW5uZWwtZ3JvdXBcIl09cikscy5sZW5ndGg+MCYmKG8uYXV0aD1zLmpvaW4oXCIsXCIpKSxvfWZ1bmN0aW9uIGMoZSx0KXtyZXR1cm4gdC5wYXlsb2FkfU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pLHQuZ2V0T3BlcmF0aW9uPXIsdC52YWxpZGF0ZVBhcmFtcz1pLHQuZ2V0VVJMPXMsdC5nZXRSZXF1ZXN0VGltZW91dD1vLHQuaXNBdXRoU3VwcG9ydGVkPWEsdC5wcmVwYXJlUGFyYW1zPXUsdC5oYW5kbGVSZXNwb25zZT1jO3ZhciBsPShuKDUpLG4oMTMpKSxoPWZ1bmN0aW9uKGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7ZGVmYXVsdDplfX0obCl9LGZ1bmN0aW9uKGUsdCxuKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiByKCl7cmV0dXJuIGguZGVmYXVsdC5QTkFjY2Vzc01hbmFnZXJHcmFudH1mdW5jdGlvbiBpKGUpe3ZhciB0PWUuY29uZmlnO3JldHVybiB0LnN1YnNjcmliZUtleT90LnB1Ymxpc2hLZXk/dC5zZWNyZXRLZXk/dm9pZCAwOlwiTWlzc2luZyBTZWNyZXQgS2V5XCI6XCJNaXNzaW5nIFB1Ymxpc2ggS2V5XCI6XCJNaXNzaW5nIFN1YnNjcmliZSBLZXlcIn1mdW5jdGlvbiBzKGUpe3JldHVyblwiL3YyL2F1dGgvZ3JhbnQvc3ViLWtleS9cIitlLmNvbmZpZy5zdWJzY3JpYmVLZXl9ZnVuY3Rpb24gbyhlKXtyZXR1cm4gZS5jb25maWcuZ2V0VHJhbnNhY3Rpb25UaW1lb3V0KCl9ZnVuY3Rpb24gYSgpe3JldHVybiExfWZ1bmN0aW9uIHUoZSx0KXt2YXIgbj10LmNoYW5uZWxzLHI9dm9pZCAwPT09bj9bXTpuLGk9dC5jaGFubmVsR3JvdXBzLHM9dm9pZCAwPT09aT9bXTppLG89dC50dGwsYT10LnJlYWQsdT12b2lkIDAhPT1hJiZhLGM9dC53cml0ZSxsPXZvaWQgMCE9PWMmJmMsaD10Lm1hbmFnZSxmPXZvaWQgMCE9PWgmJmgscD10LmF1dGhLZXlzLGQ9dm9pZCAwPT09cD9bXTpwLHk9e307cmV0dXJuIHkucj11P1wiMVwiOlwiMFwiLHkudz1sP1wiMVwiOlwiMFwiLHkubT1mP1wiMVwiOlwiMFwiLHIubGVuZ3RoPjAmJih5LmNoYW5uZWw9ci5qb2luKFwiLFwiKSkscy5sZW5ndGg+MCYmKHlbXCJjaGFubmVsLWdyb3VwXCJdPXMuam9pbihcIixcIikpLGQubGVuZ3RoPjAmJih5LmF1dGg9ZC5qb2luKFwiLFwiKSksKG98fDA9PT1vKSYmKHkudHRsPW8pLHl9ZnVuY3Rpb24gYygpe3JldHVybnt9fU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pLHQuZ2V0T3BlcmF0aW9uPXIsdC52YWxpZGF0ZVBhcmFtcz1pLHQuZ2V0VVJMPXMsdC5nZXRSZXF1ZXN0VGltZW91dD1vLFxudC5pc0F1dGhTdXBwb3J0ZWQ9YSx0LnByZXBhcmVQYXJhbXM9dSx0LmhhbmRsZVJlc3BvbnNlPWM7dmFyIGw9KG4oNSksbigxMykpLGg9ZnVuY3Rpb24oZSl7cmV0dXJuIGUmJmUuX19lc01vZHVsZT9lOntkZWZhdWx0OmV9fShsKX0sZnVuY3Rpb24oZSx0LG4pe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIHIoZSl7cmV0dXJuIGUmJmUuX19lc01vZHVsZT9lOntkZWZhdWx0OmV9fWZ1bmN0aW9uIGkoZSx0KXt2YXIgbj1lLmNyeXB0byxyPWUuY29uZmlnLGk9SlNPTi5zdHJpbmdpZnkodCk7cmV0dXJuIHIuY2lwaGVyS2V5JiYoaT1uLmVuY3J5cHQoaSksaT1KU09OLnN0cmluZ2lmeShpKSksaX1mdW5jdGlvbiBzKCl7cmV0dXJuIGIuZGVmYXVsdC5QTlB1Ymxpc2hPcGVyYXRpb259ZnVuY3Rpb24gbyhlLHQpe3ZhciBuPWUuY29uZmlnLHI9dC5tZXNzYWdlO3JldHVybiB0LmNoYW5uZWw/cj9uLnN1YnNjcmliZUtleT92b2lkIDA6XCJNaXNzaW5nIFN1YnNjcmliZSBLZXlcIjpcIk1pc3NpbmcgTWVzc2FnZVwiOlwiTWlzc2luZyBDaGFubmVsXCJ9ZnVuY3Rpb24gYShlLHQpe3ZhciBuPXQuc2VuZEJ5UG9zdDtyZXR1cm4gdm9pZCAwIT09biYmbn1mdW5jdGlvbiB1KGUsdCl7dmFyIG49ZS5jb25maWcscj10LmNoYW5uZWwscz10Lm1lc3NhZ2Usbz1pKGUscyk7cmV0dXJuXCIvcHVibGlzaC9cIituLnB1Ymxpc2hLZXkrXCIvXCIrbi5zdWJzY3JpYmVLZXkrXCIvMC9cIit2LmRlZmF1bHQuZW5jb2RlU3RyaW5nKHIpK1wiLzAvXCIrdi5kZWZhdWx0LmVuY29kZVN0cmluZyhvKX1mdW5jdGlvbiBjKGUsdCl7dmFyIG49ZS5jb25maWcscj10LmNoYW5uZWw7cmV0dXJuXCIvcHVibGlzaC9cIituLnB1Ymxpc2hLZXkrXCIvXCIrbi5zdWJzY3JpYmVLZXkrXCIvMC9cIit2LmRlZmF1bHQuZW5jb2RlU3RyaW5nKHIpK1wiLzBcIn1mdW5jdGlvbiBsKGUpe3JldHVybiBlLmNvbmZpZy5nZXRUcmFuc2FjdGlvblRpbWVvdXQoKX1mdW5jdGlvbiBoKCl7cmV0dXJuITB9ZnVuY3Rpb24gZihlLHQpe3JldHVybiBpKGUsdC5tZXNzYWdlKX1mdW5jdGlvbiBwKGUsdCl7dmFyIG49dC5tZXRhLHI9dC5yZXBsaWNhdGUsaT12b2lkIDA9PT1yfHxyLHM9dC5zdG9yZUluSGlzdG9yeSxvPXQudHRsLGE9e307cmV0dXJuIG51bGwhPXMmJihhLnN0b3JlPXM/XCIxXCI6XCIwXCIpLG8mJihhLnR0bD1vKSwhMT09PWkmJihhLm5vcmVwPVwidHJ1ZVwiKSxuJiZcIm9iamVjdFwiPT09KHZvaWQgMD09PW4/XCJ1bmRlZmluZWRcIjp5KG4pKSYmKGEubWV0YT1KU09OLnN0cmluZ2lmeShuKSksYX1mdW5jdGlvbiBkKGUsdCl7cmV0dXJue3RpbWV0b2tlbjp0WzJdfX1PYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KTt2YXIgeT1cImZ1bmN0aW9uXCI9PXR5cGVvZiBTeW1ib2wmJlwic3ltYm9sXCI9PXR5cGVvZiBTeW1ib2wuaXRlcmF0b3I/ZnVuY3Rpb24oZSl7cmV0dXJuIHR5cGVvZiBlfTpmdW5jdGlvbihlKXtyZXR1cm4gZSYmXCJmdW5jdGlvblwiPT10eXBlb2YgU3ltYm9sJiZlLmNvbnN0cnVjdG9yPT09U3ltYm9sJiZlIT09U3ltYm9sLnByb3RvdHlwZT9cInN5bWJvbFwiOnR5cGVvZiBlfTt0LmdldE9wZXJhdGlvbj1zLHQudmFsaWRhdGVQYXJhbXM9byx0LnVzZVBvc3Q9YSx0LmdldFVSTD11LHQucG9zdFVSTD1jLHQuZ2V0UmVxdWVzdFRpbWVvdXQ9bCx0LmlzQXV0aFN1cHBvcnRlZD1oLHQucG9zdFBheWxvYWQ9Zix0LnByZXBhcmVQYXJhbXM9cCx0LmhhbmRsZVJlc3BvbnNlPWQ7dmFyIGc9KG4oNSksbigxMykpLGI9cihnKSxfPW4oMTUpLHY9cihfKX0sZnVuY3Rpb24oZSx0LG4pe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIHIoZSl7cmV0dXJuIGUmJmUuX19lc01vZHVsZT9lOntkZWZhdWx0OmV9fWZ1bmN0aW9uIGkoZSx0KXt2YXIgbj1lLmNvbmZpZyxyPWUuY3J5cHRvO2lmKCFuLmNpcGhlcktleSlyZXR1cm4gdDt0cnl7cmV0dXJuIHIuZGVjcnlwdCh0KX1jYXRjaChlKXtyZXR1cm4gdH19ZnVuY3Rpb24gcygpe3JldHVybiBwLmRlZmF1bHQuUE5IaXN0b3J5T3BlcmF0aW9ufWZ1bmN0aW9uIG8oZSx0KXt2YXIgbj10LmNoYW5uZWwscj1lLmNvbmZpZztyZXR1cm4gbj9yLnN1YnNjcmliZUtleT92b2lkIDA6XCJNaXNzaW5nIFN1YnNjcmliZSBLZXlcIjpcIk1pc3NpbmcgY2hhbm5lbFwifWZ1bmN0aW9uIGEoZSx0KXt2YXIgbj10LmNoYW5uZWw7cmV0dXJuXCIvdjIvaGlzdG9yeS9zdWIta2V5L1wiK2UuY29uZmlnLnN1YnNjcmliZUtleStcIi9jaGFubmVsL1wiK3kuZGVmYXVsdC5lbmNvZGVTdHJpbmcobil9ZnVuY3Rpb24gdShlKXtyZXR1cm4gZS5jb25maWcuZ2V0VHJhbnNhY3Rpb25UaW1lb3V0KCl9ZnVuY3Rpb24gYygpe3JldHVybiEwfWZ1bmN0aW9uIGwoZSx0KXt2YXIgbj10LnN0YXJ0LHI9dC5lbmQsaT10LnJldmVyc2Uscz10LmNvdW50LG89dm9pZCAwPT09cz8xMDA6cyxhPXQuc3RyaW5naWZpZWRUaW1lVG9rZW4sdT12b2lkIDAhPT1hJiZhLGM9e2luY2x1ZGVfdG9rZW46XCJ0cnVlXCJ9O3JldHVybiBjLmNvdW50PW8sbiYmKGMuc3RhcnQ9biksciYmKGMuZW5kPXIpLHUmJihjLnN0cmluZ19tZXNzYWdlX3Rva2VuPVwidHJ1ZVwiKSxudWxsIT1pJiYoYy5yZXZlcnNlPWkudG9TdHJpbmcoKSksY31mdW5jdGlvbiBoKGUsdCl7dmFyIG49e21lc3NhZ2VzOltdLHN0YXJ0VGltZVRva2VuOnRbMV0sZW5kVGltZVRva2VuOnRbMl19O3JldHVybiB0WzBdLmZvckVhY2goZnVuY3Rpb24odCl7dmFyIHI9e3RpbWV0b2tlbjp0LnRpbWV0b2tlbixlbnRyeTppKGUsdC5tZXNzYWdlKX07bi5tZXNzYWdlcy5wdXNoKHIpfSksbn1PYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KSx0LmdldE9wZXJhdGlvbj1zLHQudmFsaWRhdGVQYXJhbXM9byx0LmdldFVSTD1hLHQuZ2V0UmVxdWVzdFRpbWVvdXQ9dSx0LmlzQXV0aFN1cHBvcnRlZD1jLHQucHJlcGFyZVBhcmFtcz1sLHQuaGFuZGxlUmVzcG9uc2U9aDt2YXIgZj0obig1KSxuKDEzKSkscD1yKGYpLGQ9bigxNSkseT1yKGQpfSxmdW5jdGlvbihlLHQsbil7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gcihlKXtyZXR1cm4gZSYmZS5fX2VzTW9kdWxlP2U6e2RlZmF1bHQ6ZX19ZnVuY3Rpb24gaSgpe3JldHVybiBwLmRlZmF1bHQuUE5EZWxldGVNZXNzYWdlc09wZXJhdGlvbn1mdW5jdGlvbiBzKGUsdCl7dmFyIG49dC5jaGFubmVsLHI9ZS5jb25maWc7cmV0dXJuIG4/ci5zdWJzY3JpYmVLZXk/dm9pZCAwOlwiTWlzc2luZyBTdWJzY3JpYmUgS2V5XCI6XCJNaXNzaW5nIGNoYW5uZWxcIn1mdW5jdGlvbiBvKCl7cmV0dXJuITB9ZnVuY3Rpb24gYShlLHQpe3ZhciBuPXQuY2hhbm5lbDtyZXR1cm5cIi92My9oaXN0b3J5L3N1Yi1rZXkvXCIrZS5jb25maWcuc3Vic2NyaWJlS2V5K1wiL2NoYW5uZWwvXCIreS5kZWZhdWx0LmVuY29kZVN0cmluZyhuKX1mdW5jdGlvbiB1KGUpe3JldHVybiBlLmNvbmZpZy5nZXRUcmFuc2FjdGlvblRpbWVvdXQoKX1mdW5jdGlvbiBjKCl7cmV0dXJuITB9ZnVuY3Rpb24gbChlLHQpe3ZhciBuPXQuc3RhcnQscj10LmVuZCxpPXt9O3JldHVybiBuJiYoaS5zdGFydD1uKSxyJiYoaS5lbmQ9ciksaX1mdW5jdGlvbiBoKGUsdCl7cmV0dXJuIHQucGF5bG9hZH1PYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KSx0LmdldE9wZXJhdGlvbj1pLHQudmFsaWRhdGVQYXJhbXM9cyx0LnVzZURlbGV0ZT1vLHQuZ2V0VVJMPWEsdC5nZXRSZXF1ZXN0VGltZW91dD11LHQuaXNBdXRoU3VwcG9ydGVkPWMsdC5wcmVwYXJlUGFyYW1zPWwsdC5oYW5kbGVSZXNwb25zZT1oO3ZhciBmPShuKDUpLG4oMTMpKSxwPXIoZiksZD1uKDE1KSx5PXIoZCl9LGZ1bmN0aW9uKGUsdCxuKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiByKGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7ZGVmYXVsdDplfX1mdW5jdGlvbiBpKGUsdCl7dmFyIG49ZS5jb25maWcscj1lLmNyeXB0bztpZighbi5jaXBoZXJLZXkpcmV0dXJuIHQ7dHJ5e3JldHVybiByLmRlY3J5cHQodCl9Y2F0Y2goZSl7cmV0dXJuIHR9fWZ1bmN0aW9uIHMoKXtyZXR1cm4gcC5kZWZhdWx0LlBORmV0Y2hNZXNzYWdlc09wZXJhdGlvbn1mdW5jdGlvbiBvKGUsdCl7dmFyIG49dC5jaGFubmVscyxyPWUuY29uZmlnO3JldHVybiBuJiYwIT09bi5sZW5ndGg/ci5zdWJzY3JpYmVLZXk/dm9pZCAwOlwiTWlzc2luZyBTdWJzY3JpYmUgS2V5XCI6XCJNaXNzaW5nIGNoYW5uZWxzXCJ9ZnVuY3Rpb24gYShlLHQpe3ZhciBuPXQuY2hhbm5lbHMscj12b2lkIDA9PT1uP1tdOm4saT1lLmNvbmZpZyxzPXIubGVuZ3RoPjA/ci5qb2luKFwiLFwiKTpcIixcIjtyZXR1cm5cIi92My9oaXN0b3J5L3N1Yi1rZXkvXCIraS5zdWJzY3JpYmVLZXkrXCIvY2hhbm5lbC9cIit5LmRlZmF1bHQuZW5jb2RlU3RyaW5nKHMpfWZ1bmN0aW9uIHUoZSl7cmV0dXJuIGUuY29uZmlnLmdldFRyYW5zYWN0aW9uVGltZW91dCgpfWZ1bmN0aW9uIGMoKXtyZXR1cm4hMH1mdW5jdGlvbiBsKGUsdCl7dmFyIG49dC5zdGFydCxyPXQuZW5kLGk9dC5jb3VudCxzPXQuc3RyaW5naWZpZWRUaW1lVG9rZW4sbz12b2lkIDAhPT1zJiZzLGE9e307cmV0dXJuIGkmJihhLm1heD1pKSxuJiYoYS5zdGFydD1uKSxyJiYoYS5lbmQ9ciksbyYmKGEuc3RyaW5nX21lc3NhZ2VfdG9rZW49XCJ0cnVlXCIpLGF9ZnVuY3Rpb24gaChlLHQpe3ZhciBuPXtjaGFubmVsczp7fX07cmV0dXJuIE9iamVjdC5rZXlzKHQuY2hhbm5lbHN8fHt9KS5mb3JFYWNoKGZ1bmN0aW9uKHIpe24uY2hhbm5lbHNbcl09W10sKHQuY2hhbm5lbHNbcl18fFtdKS5mb3JFYWNoKGZ1bmN0aW9uKHQpe3ZhciBzPXt9O3MuY2hhbm5lbD1yLHMuc3Vic2NyaXB0aW9uPW51bGwscy50aW1ldG9rZW49dC50aW1ldG9rZW4scy5tZXNzYWdlPWkoZSx0Lm1lc3NhZ2UpLG4uY2hhbm5lbHNbcl0ucHVzaChzKX0pfSksbn1PYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KSx0LmdldE9wZXJhdGlvbj1zLHQudmFsaWRhdGVQYXJhbXM9byx0LmdldFVSTD1hLHQuZ2V0UmVxdWVzdFRpbWVvdXQ9dSx0LmlzQXV0aFN1cHBvcnRlZD1jLHQucHJlcGFyZVBhcmFtcz1sLHQuaGFuZGxlUmVzcG9uc2U9aDt2YXIgZj0obig1KSxuKDEzKSkscD1yKGYpLGQ9bigxNSkseT1yKGQpfSxmdW5jdGlvbihlLHQsbil7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gcihlKXtyZXR1cm4gZSYmZS5fX2VzTW9kdWxlP2U6e2RlZmF1bHQ6ZX19ZnVuY3Rpb24gaSgpe3JldHVybiBmLmRlZmF1bHQuUE5TdWJzY3JpYmVPcGVyYXRpb259ZnVuY3Rpb24gcyhlKXtpZighZS5jb25maWcuc3Vic2NyaWJlS2V5KXJldHVyblwiTWlzc2luZyBTdWJzY3JpYmUgS2V5XCJ9ZnVuY3Rpb24gbyhlLHQpe3ZhciBuPWUuY29uZmlnLHI9dC5jaGFubmVscyxpPXZvaWQgMD09PXI/W106cixzPWkubGVuZ3RoPjA/aS5qb2luKFwiLFwiKTpcIixcIjtyZXR1cm5cIi92Mi9zdWJzY3JpYmUvXCIrbi5zdWJzY3JpYmVLZXkrXCIvXCIrZC5kZWZhdWx0LmVuY29kZVN0cmluZyhzKStcIi8wXCJ9ZnVuY3Rpb24gYShlKXtyZXR1cm4gZS5jb25maWcuZ2V0U3Vic2NyaWJlVGltZW91dCgpfWZ1bmN0aW9uIHUoKXtyZXR1cm4hMH1mdW5jdGlvbiBjKGUsdCl7dmFyIG49ZS5jb25maWcscj10LmNoYW5uZWxHcm91cHMsaT12b2lkIDA9PT1yP1tdOnIscz10LnRpbWV0b2tlbixvPXQuZmlsdGVyRXhwcmVzc2lvbixhPXQucmVnaW9uLHU9e2hlYXJ0YmVhdDpuLmdldFByZXNlbmNlVGltZW91dCgpfTtyZXR1cm4gaS5sZW5ndGg+MCYmKHVbXCJjaGFubmVsLWdyb3VwXCJdPWkuam9pbihcIixcIikpLG8mJm8ubGVuZ3RoPjAmJih1W1wiZmlsdGVyLWV4cHJcIl09bykscyYmKHUudHQ9cyksYSYmKHUudHI9YSksdX1mdW5jdGlvbiBsKGUsdCl7dmFyIG49W107dC5tLmZvckVhY2goZnVuY3Rpb24oZSl7dmFyIHQ9e3B1Ymxpc2hUaW1ldG9rZW46ZS5wLnQscmVnaW9uOmUucC5yfSxyPXtzaGFyZDpwYXJzZUludChlLmEsMTApLHN1YnNjcmlwdGlvbk1hdGNoOmUuYixjaGFubmVsOmUuYyxwYXlsb2FkOmUuZCxmbGFnczplLmYsaXNzdWluZ0NsaWVudElkOmUuaSxzdWJzY3JpYmVLZXk6ZS5rLG9yaWdpbmF0aW9uVGltZXRva2VuOmUubyx1c2VyTWV0YWRhdGE6ZS51LHB1Ymxpc2hNZXRhRGF0YTp0fTtuLnB1c2gocil9KTt2YXIgcj17dGltZXRva2VuOnQudC50LHJlZ2lvbjp0LnQucn07cmV0dXJue21lc3NhZ2VzOm4sbWV0YWRhdGE6cn19T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSksdC5nZXRPcGVyYXRpb249aSx0LnZhbGlkYXRlUGFyYW1zPXMsdC5nZXRVUkw9byx0LmdldFJlcXVlc3RUaW1lb3V0PWEsdC5pc0F1dGhTdXBwb3J0ZWQ9dSx0LnByZXBhcmVQYXJhbXM9Yyx0LmhhbmRsZVJlc3BvbnNlPWw7dmFyIGg9KG4oNSksbigxMykpLGY9cihoKSxwPW4oMTUpLGQ9cihwKX0sZnVuY3Rpb24oZSx0LG4pe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIHIoZSl7cmV0dXJuIGUmJmUuX19lc01vZHVsZT9lOntkZWZhdWx0OmV9fWZ1bmN0aW9uIGkoZSx0KXtpZighKGUgaW5zdGFuY2VvZiB0KSl0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpfU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pO3ZhciBzPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShlLHQpe2Zvcih2YXIgbj0wO248dC5sZW5ndGg7bisrKXt2YXIgcj10W25dO3IuZW51bWVyYWJsZT1yLmVudW1lcmFibGV8fCExLHIuY29uZmlndXJhYmxlPSEwLFwidmFsdWVcImluIHImJihyLndyaXRhYmxlPSEwKSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxyLmtleSxyKX19cmV0dXJuIGZ1bmN0aW9uKHQsbixyKXtyZXR1cm4gbiYmZSh0LnByb3RvdHlwZSxuKSxyJiZlKHQsciksdH19KCksbz1uKDIpLGE9KHIobyksbigxMCkpLHU9cihhKSxjPShuKDUpLGZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0KXt2YXIgbj10aGlzO2kodGhpcyxlKSx0aGlzLl9tb2R1bGVzPXt9LE9iamVjdC5rZXlzKHQpLmZvckVhY2goZnVuY3Rpb24oZSl7bi5fbW9kdWxlc1tlXT10W2VdLmJpbmQobil9KX1yZXR1cm4gcyhlLFt7a2V5OlwiaW5pdFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuX2NvbmZpZz1lLHRoaXMuX21heFN1YkRvbWFpbj0yMCx0aGlzLl9jdXJyZW50U3ViRG9tYWluPU1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSp0aGlzLl9tYXhTdWJEb21haW4pLHRoaXMuX3Byb3ZpZGVkRlFETj0odGhpcy5fY29uZmlnLnNlY3VyZT9cImh0dHBzOi8vXCI6XCJodHRwOi8vXCIpK3RoaXMuX2NvbmZpZy5vcmlnaW4sdGhpcy5fY29yZVBhcmFtcz17fSx0aGlzLnNoaWZ0U3RhbmRhcmRPcmlnaW4oKX19LHtrZXk6XCJuZXh0T3JpZ2luXCIsdmFsdWU6ZnVuY3Rpb24oKXtpZigtMT09PXRoaXMuX3Byb3ZpZGVkRlFETi5pbmRleE9mKFwicHVic3ViLlwiKSlyZXR1cm4gdGhpcy5fcHJvdmlkZWRGUUROO3ZhciBlPXZvaWQgMDtyZXR1cm4gdGhpcy5fY3VycmVudFN1YkRvbWFpbj10aGlzLl9jdXJyZW50U3ViRG9tYWluKzEsdGhpcy5fY3VycmVudFN1YkRvbWFpbj49dGhpcy5fbWF4U3ViRG9tYWluJiYodGhpcy5fY3VycmVudFN1YkRvbWFpbj0xKSxlPXRoaXMuX2N1cnJlbnRTdWJEb21haW4udG9TdHJpbmcoKSx0aGlzLl9wcm92aWRlZEZRRE4ucmVwbGFjZShcInB1YnN1YlwiLFwicHNcIitlKX19LHtrZXk6XCJoYXNNb2R1bGVcIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gZSBpbiB0aGlzLl9tb2R1bGVzfX0se2tleTpcInNoaWZ0U3RhbmRhcmRPcmlnaW5cIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPWFyZ3VtZW50cy5sZW5ndGg+MCYmdm9pZCAwIT09YXJndW1lbnRzWzBdJiZhcmd1bWVudHNbMF07cmV0dXJuIHRoaXMuX3N0YW5kYXJkT3JpZ2luPXRoaXMubmV4dE9yaWdpbihlKSx0aGlzLl9zdGFuZGFyZE9yaWdpbn19LHtrZXk6XCJnZXRTdGFuZGFyZE9yaWdpblwiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3N0YW5kYXJkT3JpZ2lufX0se2tleTpcIlBPU1RcIix2YWx1ZTpmdW5jdGlvbihlLHQsbixyKXtyZXR1cm4gdGhpcy5fbW9kdWxlcy5wb3N0KGUsdCxuLHIpfX0se2tleTpcIkdFVFwiLHZhbHVlOmZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gdGhpcy5fbW9kdWxlcy5nZXQoZSx0LG4pfX0se2tleTpcIkRFTEVURVwiLHZhbHVlOmZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gdGhpcy5fbW9kdWxlcy5kZWwoZSx0LG4pfX0se2tleTpcIl9kZXRlY3RFcnJvckNhdGVnb3J5XCIsdmFsdWU6ZnVuY3Rpb24oZSl7aWYoXCJFTk9URk9VTkRcIj09PWUuY29kZSlyZXR1cm4gdS5kZWZhdWx0LlBOTmV0d29ya0lzc3Vlc0NhdGVnb3J5O2lmKFwiRUNPTk5SRUZVU0VEXCI9PT1lLmNvZGUpcmV0dXJuIHUuZGVmYXVsdC5QTk5ldHdvcmtJc3N1ZXNDYXRlZ29yeTtpZihcIkVDT05OUkVTRVRcIj09PWUuY29kZSlyZXR1cm4gdS5kZWZhdWx0LlBOTmV0d29ya0lzc3Vlc0NhdGVnb3J5O2lmKFwiRUFJX0FHQUlOXCI9PT1lLmNvZGUpcmV0dXJuIHUuZGVmYXVsdC5QTk5ldHdvcmtJc3N1ZXNDYXRlZ29yeTtpZigwPT09ZS5zdGF0dXN8fGUuaGFzT3duUHJvcGVydHkoXCJzdGF0dXNcIikmJnZvaWQgMD09PWUuc3RhdHVzKXJldHVybiB1LmRlZmF1bHQuUE5OZXR3b3JrSXNzdWVzQ2F0ZWdvcnk7aWYoZS50aW1lb3V0KXJldHVybiB1LmRlZmF1bHQuUE5UaW1lb3V0Q2F0ZWdvcnk7aWYoXCJFVElNRURPVVRcIj09PWUuY29kZSlyZXR1cm4gdS5kZWZhdWx0LlBOTmV0d29ya0lzc3Vlc0NhdGVnb3J5O2lmKGUucmVzcG9uc2Upe2lmKGUucmVzcG9uc2UuYmFkUmVxdWVzdClyZXR1cm4gdS5kZWZhdWx0LlBOQmFkUmVxdWVzdENhdGVnb3J5O2lmKGUucmVzcG9uc2UuZm9yYmlkZGVuKXJldHVybiB1LmRlZmF1bHQuUE5BY2Nlc3NEZW5pZWRDYXRlZ29yeX1yZXR1cm4gdS5kZWZhdWx0LlBOVW5rbm93bkNhdGVnb3J5fX1dKSxlfSgpKTt0LmRlZmF1bHQ9YyxlLmV4cG9ydHM9dC5kZWZhdWx0fSxmdW5jdGlvbihlLHQpe1widXNlIHN0cmljdFwiO09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pLHQuZGVmYXVsdD17Z2V0OmZ1bmN0aW9uKGUpe3RyeXtyZXR1cm4gbG9jYWxTdG9yYWdlLmdldEl0ZW0oZSl9Y2F0Y2goZSl7cmV0dXJuIG51bGx9fSxzZXQ6ZnVuY3Rpb24oZSx0KXt0cnl7cmV0dXJuIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGUsdCl9Y2F0Y2goZSl7cmV0dXJuIG51bGx9fX0sZS5leHBvcnRzPXQuZGVmYXVsdH0sZnVuY3Rpb24oZSx0LG4pe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIHIoZSl7dmFyIHQ9KG5ldyBEYXRlKS5nZXRUaW1lKCksbj0obmV3IERhdGUpLnRvSVNPU3RyaW5nKCkscj1mdW5jdGlvbigpe3JldHVybiBjb25zb2xlJiZjb25zb2xlLmxvZz9jb25zb2xlOndpbmRvdyYmd2luZG93LmNvbnNvbGUmJndpbmRvdy5jb25zb2xlLmxvZz93aW5kb3cuY29uc29sZTpjb25zb2xlfSgpO3IubG9nKFwiPDw8PDxcIiksci5sb2coXCJbXCIrbitcIl1cIixcIlxcblwiLGUudXJsLFwiXFxuXCIsZS5xcyksci5sb2coXCItLS0tLVwiKSxlLm9uKFwicmVzcG9uc2VcIixmdW5jdGlvbihuKXt2YXIgaT0obmV3IERhdGUpLmdldFRpbWUoKSxzPWktdCxvPShuZXcgRGF0ZSkudG9JU09TdHJpbmcoKTtyLmxvZyhcIj4+Pj4+PlwiKSxyLmxvZyhcIltcIitvK1wiIC8gXCIrcytcIl1cIixcIlxcblwiLGUudXJsLFwiXFxuXCIsZS5xcyxcIlxcblwiLG4udGV4dCksci5sb2coXCItLS0tLVwiKX0pfWZ1bmN0aW9uIGkoZSx0LG4pe3ZhciBpPXRoaXM7cmV0dXJuIHRoaXMuX2NvbmZpZy5sb2dWZXJib3NpdHkmJihlPWUudXNlKHIpKSx0aGlzLl9jb25maWcucHJveHkmJnRoaXMuX21vZHVsZXMucHJveHkmJihlPXRoaXMuX21vZHVsZXMucHJveHkuY2FsbCh0aGlzLGUpKSx0aGlzLl9jb25maWcua2VlcEFsaXZlJiZ0aGlzLl9tb2R1bGVzLmtlZXBBbGl2ZSYmKGU9dGhpcy5fbW9kdWxlcy5rZWVwQWxpdmUoZSkpLGUudGltZW91dCh0LnRpbWVvdXQpLmVuZChmdW5jdGlvbihlLHIpe3ZhciBzPXt9O2lmKHMuZXJyb3I9bnVsbCE9PWUscy5vcGVyYXRpb249dC5vcGVyYXRpb24sciYmci5zdGF0dXMmJihzLnN0YXR1c0NvZGU9ci5zdGF0dXMpLGUpe2lmKGUucmVzcG9uc2UmJmUucmVzcG9uc2UudGV4dCYmIWkuX2NvbmZpZy5sb2dWZXJib3NpdHkpdHJ5e3MuZXJyb3JEYXRhPUpTT04ucGFyc2UoZS5yZXNwb25zZS50ZXh0KX1jYXRjaCh0KXtzLmVycm9yRGF0YT1lfWVsc2Ugcy5lcnJvckRhdGE9ZTtyZXR1cm4gcy5jYXRlZ29yeT1pLl9kZXRlY3RFcnJvckNhdGVnb3J5KGUpLG4ocyxudWxsKX12YXIgbz1KU09OLnBhcnNlKHIudGV4dCk7cmV0dXJuIG8uZXJyb3ImJjE9PT1vLmVycm9yJiZvLnN0YXR1cyYmby5tZXNzYWdlJiZvLnNlcnZpY2U/KHMuZXJyb3JEYXRhPW8scy5zdGF0dXNDb2RlPW8uc3RhdHVzLHMuZXJyb3I9ITAscy5jYXRlZ29yeT1pLl9kZXRlY3RFcnJvckNhdGVnb3J5KHMpLG4ocyxudWxsKSk6bihzLG8pfSl9ZnVuY3Rpb24gcyhlLHQsbil7dmFyIHI9Yy5kZWZhdWx0LmdldCh0aGlzLmdldFN0YW5kYXJkT3JpZ2luKCkrdC51cmwpLnF1ZXJ5KGUpO3JldHVybiBpLmNhbGwodGhpcyxyLHQsbil9ZnVuY3Rpb24gbyhlLHQsbixyKXt2YXIgcz1jLmRlZmF1bHQucG9zdCh0aGlzLmdldFN0YW5kYXJkT3JpZ2luKCkrbi51cmwpLnF1ZXJ5KGUpLnNlbmQodCk7cmV0dXJuIGkuY2FsbCh0aGlzLHMsbixyKX1mdW5jdGlvbiBhKGUsdCxuKXt2YXIgcj1jLmRlZmF1bHQuZGVsZXRlKHRoaXMuZ2V0U3RhbmRhcmRPcmlnaW4oKSt0LnVybCkucXVlcnkoZSk7cmV0dXJuIGkuY2FsbCh0aGlzLHIsdCxuKX1PYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KSx0LmdldD1zLHQucG9zdD1vLHQuZGVsPWE7dmFyIHU9big0MiksYz1mdW5jdGlvbihlKXtyZXR1cm4gZSYmZS5fX2VzTW9kdWxlP2U6e2RlZmF1bHQ6ZX19KHUpO24oNSl9LGZ1bmN0aW9uKGUsdCxuKXtmdW5jdGlvbiByKCl7fWZ1bmN0aW9uIGkoZSl7aWYoIXkoZSkpcmV0dXJuIGU7dmFyIHQ9W107Zm9yKHZhciBuIGluIGUpcyh0LG4sZVtuXSk7cmV0dXJuIHQuam9pbihcIiZcIil9ZnVuY3Rpb24gcyhlLHQsbil7aWYobnVsbCE9bilpZihBcnJheS5pc0FycmF5KG4pKW4uZm9yRWFjaChmdW5jdGlvbihuKXtzKGUsdCxuKX0pO2Vsc2UgaWYoeShuKSlmb3IodmFyIHIgaW4gbilzKGUsdCtcIltcIityK1wiXVwiLG5bcl0pO2Vsc2UgZS5wdXNoKGVuY29kZVVSSUNvbXBvbmVudCh0KStcIj1cIitlbmNvZGVVUklDb21wb25lbnQobikpO2Vsc2UgbnVsbD09PW4mJmUucHVzaChlbmNvZGVVUklDb21wb25lbnQodCkpfWZ1bmN0aW9uIG8oZSl7Zm9yKHZhciB0LG4scj17fSxpPWUuc3BsaXQoXCImXCIpLHM9MCxvPWkubGVuZ3RoO3M8bzsrK3MpdD1pW3NdLG49dC5pbmRleE9mKFwiPVwiKSwtMT09bj9yW2RlY29kZVVSSUNvbXBvbmVudCh0KV09XCJcIjpyW2RlY29kZVVSSUNvbXBvbmVudCh0LnNsaWNlKDAsbikpXT1kZWNvZGVVUklDb21wb25lbnQodC5zbGljZShuKzEpKTtyZXR1cm4gcn1mdW5jdGlvbiBhKGUpe2Zvcih2YXIgdCxuLHIsaSxzPWUuc3BsaXQoL1xccj9cXG4vKSxvPXt9LGE9MCx1PXMubGVuZ3RoO2E8dTsrK2Epbj1zW2FdLC0xIT09KHQ9bi5pbmRleE9mKFwiOlwiKSkmJihyPW4uc2xpY2UoMCx0KS50b0xvd2VyQ2FzZSgpLGk9dihuLnNsaWNlKHQrMSkpLG9bcl09aSk7cmV0dXJuIG99ZnVuY3Rpb24gdShlKXtyZXR1cm4vW1xcLytdanNvbigkfFteLVxcd10pLy50ZXN0KGUpfWZ1bmN0aW9uIGMoZSl7dGhpcy5yZXE9ZSx0aGlzLnhocj10aGlzLnJlcS54aHIsdGhpcy50ZXh0PVwiSEVBRFwiIT10aGlzLnJlcS5tZXRob2QmJihcIlwiPT09dGhpcy54aHIucmVzcG9uc2VUeXBlfHxcInRleHRcIj09PXRoaXMueGhyLnJlc3BvbnNlVHlwZSl8fHZvaWQgMD09PXRoaXMueGhyLnJlc3BvbnNlVHlwZT90aGlzLnhoci5yZXNwb25zZVRleHQ6bnVsbCx0aGlzLnN0YXR1c1RleHQ9dGhpcy5yZXEueGhyLnN0YXR1c1RleHQ7dmFyIHQ9dGhpcy54aHIuc3RhdHVzOzEyMjM9PT10JiYodD0yMDQpLHRoaXMuX3NldFN0YXR1c1Byb3BlcnRpZXModCksdGhpcy5oZWFkZXI9dGhpcy5oZWFkZXJzPWEodGhpcy54aHIuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCkpLHRoaXMuaGVhZGVyW1wiY29udGVudC10eXBlXCJdPXRoaXMueGhyLmdldFJlc3BvbnNlSGVhZGVyKFwiY29udGVudC10eXBlXCIpLHRoaXMuX3NldEhlYWRlclByb3BlcnRpZXModGhpcy5oZWFkZXIpLG51bGw9PT10aGlzLnRleHQmJmUuX3Jlc3BvbnNlVHlwZT90aGlzLmJvZHk9dGhpcy54aHIucmVzcG9uc2U6dGhpcy5ib2R5PVwiSEVBRFwiIT10aGlzLnJlcS5tZXRob2Q/dGhpcy5fcGFyc2VCb2R5KHRoaXMudGV4dD90aGlzLnRleHQ6dGhpcy54aHIucmVzcG9uc2UpOm51bGx9ZnVuY3Rpb24gbChlLHQpe3ZhciBuPXRoaXM7dGhpcy5fcXVlcnk9dGhpcy5fcXVlcnl8fFtdLHRoaXMubWV0aG9kPWUsdGhpcy51cmw9dCx0aGlzLmhlYWRlcj17fSx0aGlzLl9oZWFkZXI9e30sdGhpcy5vbihcImVuZFwiLGZ1bmN0aW9uKCl7dmFyIGU9bnVsbCx0PW51bGw7dHJ5e3Q9bmV3IGMobil9Y2F0Y2godCl7cmV0dXJuIGU9bmV3IEVycm9yKFwiUGFyc2VyIGlzIHVuYWJsZSB0byBwYXJzZSB0aGUgcmVzcG9uc2VcIiksZS5wYXJzZT0hMCxlLm9yaWdpbmFsPXQsbi54aHI/KGUucmF3UmVzcG9uc2U9dm9pZCAwPT09bi54aHIucmVzcG9uc2VUeXBlP24ueGhyLnJlc3BvbnNlVGV4dDpuLnhoci5yZXNwb25zZSxlLnN0YXR1cz1uLnhoci5zdGF0dXM/bi54aHIuc3RhdHVzOm51bGwsZS5zdGF0dXNDb2RlPWUuc3RhdHVzKTooZS5yYXdSZXNwb25zZT1udWxsLGUuc3RhdHVzPW51bGwpLG4uY2FsbGJhY2soZSl9bi5lbWl0KFwicmVzcG9uc2VcIix0KTt2YXIgcjt0cnl7bi5faXNSZXNwb25zZU9LKHQpfHwocj1uZXcgRXJyb3IodC5zdGF0dXNUZXh0fHxcIlVuc3VjY2Vzc2Z1bCBIVFRQIHJlc3BvbnNlXCIpKX1jYXRjaChlKXtyPWV9cj8oci5vcmlnaW5hbD1lLHIucmVzcG9uc2U9dCxyLnN0YXR1cz10LnN0YXR1cyxuLmNhbGxiYWNrKHIsdCkpOm4uY2FsbGJhY2sobnVsbCx0KX0pfWZ1bmN0aW9uIGgoZSx0LG4pe3ZhciByPV8oXCJERUxFVEVcIixlKTtyZXR1cm5cImZ1bmN0aW9uXCI9PXR5cGVvZiB0JiYobj10LHQ9bnVsbCksdCYmci5zZW5kKHQpLG4mJnIuZW5kKG4pLHJ9dmFyIGY7XCJ1bmRlZmluZWRcIiE9dHlwZW9mIHdpbmRvdz9mPXdpbmRvdzpcInVuZGVmaW5lZFwiIT10eXBlb2Ygc2VsZj9mPXNlbGY6KGNvbnNvbGUud2FybihcIlVzaW5nIGJyb3dzZXItb25seSB2ZXJzaW9uIG9mIHN1cGVyYWdlbnQgaW4gbm9uLWJyb3dzZXIgZW52aXJvbm1lbnRcIiksZj10aGlzKTt2YXIgcD1uKDQzKSxkPW4oNDQpLHk9big0NSksZz1uKDQ2KSxiPW4oNDgpLF89dD1lLmV4cG9ydHM9ZnVuY3Rpb24oZSxuKXtyZXR1cm5cImZ1bmN0aW9uXCI9PXR5cGVvZiBuP25ldyB0LlJlcXVlc3QoXCJHRVRcIixlKS5lbmQobik6MT09YXJndW1lbnRzLmxlbmd0aD9uZXcgdC5SZXF1ZXN0KFwiR0VUXCIsZSk6bmV3IHQuUmVxdWVzdChlLG4pfTt0LlJlcXVlc3Q9bCxfLmdldFhIUj1mdW5jdGlvbigpe2lmKCEoIWYuWE1MSHR0cFJlcXVlc3R8fGYubG9jYXRpb24mJlwiZmlsZTpcIj09Zi5sb2NhdGlvbi5wcm90b2NvbCYmZi5BY3RpdmVYT2JqZWN0KSlyZXR1cm4gbmV3IFhNTEh0dHBSZXF1ZXN0O3RyeXtyZXR1cm4gbmV3IEFjdGl2ZVhPYmplY3QoXCJNaWNyb3NvZnQuWE1MSFRUUFwiKX1jYXRjaChlKXt9dHJ5e3JldHVybiBuZXcgQWN0aXZlWE9iamVjdChcIk1zeG1sMi5YTUxIVFRQLjYuMFwiKX1jYXRjaChlKXt9dHJ5e3JldHVybiBuZXcgQWN0aXZlWE9iamVjdChcIk1zeG1sMi5YTUxIVFRQLjMuMFwiKX1jYXRjaChlKXt9dHJ5e3JldHVybiBuZXcgQWN0aXZlWE9iamVjdChcIk1zeG1sMi5YTUxIVFRQXCIpfWNhdGNoKGUpe310aHJvdyBFcnJvcihcIkJyb3dzZXItb25seSB2ZXJzaW9uIG9mIHN1cGVyYWdlbnQgY291bGQgbm90IGZpbmQgWEhSXCIpfTt2YXIgdj1cIlwiLnRyaW0/ZnVuY3Rpb24oZSl7cmV0dXJuIGUudHJpbSgpfTpmdW5jdGlvbihlKXtyZXR1cm4gZS5yZXBsYWNlKC8oXlxccyp8XFxzKiQpL2csXCJcIil9O18uc2VyaWFsaXplT2JqZWN0PWksXy5wYXJzZVN0cmluZz1vLF8udHlwZXM9e2h0bWw6XCJ0ZXh0L2h0bWxcIixqc29uOlwiYXBwbGljYXRpb24vanNvblwiLHhtbDpcInRleHQveG1sXCIsdXJsZW5jb2RlZDpcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFwiLGZvcm06XCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWRcIixcImZvcm0tZGF0YVwiOlwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkXCJ9LF8uc2VyaWFsaXplPXtcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFwiOmksXCJhcHBsaWNhdGlvbi9qc29uXCI6SlNPTi5zdHJpbmdpZnl9LF8ucGFyc2U9e1wiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkXCI6byxcImFwcGxpY2F0aW9uL2pzb25cIjpKU09OLnBhcnNlfSxnKGMucHJvdG90eXBlKSxjLnByb3RvdHlwZS5fcGFyc2VCb2R5PWZ1bmN0aW9uKGUpe3ZhciB0PV8ucGFyc2VbdGhpcy50eXBlXTtyZXR1cm4gdGhpcy5yZXEuX3BhcnNlcj90aGlzLnJlcS5fcGFyc2VyKHRoaXMsZSk6KCF0JiZ1KHRoaXMudHlwZSkmJih0PV8ucGFyc2VbXCJhcHBsaWNhdGlvbi9qc29uXCJdKSx0JiZlJiYoZS5sZW5ndGh8fGUgaW5zdGFuY2VvZiBPYmplY3QpP3QoZSk6bnVsbCl9LGMucHJvdG90eXBlLnRvRXJyb3I9ZnVuY3Rpb24oKXt2YXIgZT10aGlzLnJlcSx0PWUubWV0aG9kLG49ZS51cmwscj1cImNhbm5vdCBcIit0K1wiIFwiK24rXCIgKFwiK3RoaXMuc3RhdHVzK1wiKVwiLGk9bmV3IEVycm9yKHIpO3JldHVybiBpLnN0YXR1cz10aGlzLnN0YXR1cyxpLm1ldGhvZD10LGkudXJsPW4saX0sXy5SZXNwb25zZT1jLHAobC5wcm90b3R5cGUpLGQobC5wcm90b3R5cGUpLGwucHJvdG90eXBlLnR5cGU9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuc2V0KFwiQ29udGVudC1UeXBlXCIsXy50eXBlc1tlXXx8ZSksdGhpc30sbC5wcm90b3R5cGUuYWNjZXB0PWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLnNldChcIkFjY2VwdFwiLF8udHlwZXNbZV18fGUpLHRoaXN9LGwucHJvdG90eXBlLmF1dGg9ZnVuY3Rpb24oZSx0LG4pezE9PT1hcmd1bWVudHMubGVuZ3RoJiYodD1cIlwiKSxcIm9iamVjdFwiPT10eXBlb2YgdCYmbnVsbCE9PXQmJihuPXQsdD1cIlwiKSxufHwobj17dHlwZTpcImZ1bmN0aW9uXCI9PXR5cGVvZiBidG9hP1wiYmFzaWNcIjpcImF1dG9cIn0pO3ZhciByPWZ1bmN0aW9uKGUpe2lmKFwiZnVuY3Rpb25cIj09dHlwZW9mIGJ0b2EpcmV0dXJuIGJ0b2EoZSk7dGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IHVzZSBiYXNpYyBhdXRoLCBidG9hIGlzIG5vdCBhIGZ1bmN0aW9uXCIpfTtyZXR1cm4gdGhpcy5fYXV0aChlLHQsbixyKX0sbC5wcm90b3R5cGUucXVlcnk9ZnVuY3Rpb24oZSl7cmV0dXJuXCJzdHJpbmdcIiE9dHlwZW9mIGUmJihlPWkoZSkpLGUmJnRoaXMuX3F1ZXJ5LnB1c2goZSksdGhpc30sbC5wcm90b3R5cGUuYXR0YWNoPWZ1bmN0aW9uKGUsdCxuKXtpZih0KXtpZih0aGlzLl9kYXRhKXRocm93IEVycm9yKFwic3VwZXJhZ2VudCBjYW4ndCBtaXggLnNlbmQoKSBhbmQgLmF0dGFjaCgpXCIpO3RoaXMuX2dldEZvcm1EYXRhKCkuYXBwZW5kKGUsdCxufHx0Lm5hbWUpfXJldHVybiB0aGlzfSxsLnByb3RvdHlwZS5fZ2V0Rm9ybURhdGE9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZm9ybURhdGF8fCh0aGlzLl9mb3JtRGF0YT1uZXcgZi5Gb3JtRGF0YSksdGhpcy5fZm9ybURhdGF9LGwucHJvdG90eXBlLmNhbGxiYWNrPWZ1bmN0aW9uKGUsdCl7aWYodGhpcy5fc2hvdWxkUmV0cnkoZSx0KSlyZXR1cm4gdGhpcy5fcmV0cnkoKTt2YXIgbj10aGlzLl9jYWxsYmFjazt0aGlzLmNsZWFyVGltZW91dCgpLGUmJih0aGlzLl9tYXhSZXRyaWVzJiYoZS5yZXRyaWVzPXRoaXMuX3JldHJpZXMtMSksdGhpcy5lbWl0KFwiZXJyb3JcIixlKSksbihlLHQpfSxsLnByb3RvdHlwZS5jcm9zc0RvbWFpbkVycm9yPWZ1bmN0aW9uKCl7dmFyIGU9bmV3IEVycm9yKFwiUmVxdWVzdCBoYXMgYmVlbiB0ZXJtaW5hdGVkXFxuUG9zc2libGUgY2F1c2VzOiB0aGUgbmV0d29yayBpcyBvZmZsaW5lLCBPcmlnaW4gaXMgbm90IGFsbG93ZWQgYnkgQWNjZXNzLUNvbnRyb2wtQWxsb3ctT3JpZ2luLCB0aGUgcGFnZSBpcyBiZWluZyB1bmxvYWRlZCwgZXRjLlwiKTtlLmNyb3NzRG9tYWluPSEwLGUuc3RhdHVzPXRoaXMuc3RhdHVzLGUubWV0aG9kPXRoaXMubWV0aG9kLGUudXJsPXRoaXMudXJsLHRoaXMuY2FsbGJhY2soZSl9LGwucHJvdG90eXBlLmJ1ZmZlcj1sLnByb3RvdHlwZS5jYT1sLnByb3RvdHlwZS5hZ2VudD1mdW5jdGlvbigpe3JldHVybiBjb25zb2xlLndhcm4oXCJUaGlzIGlzIG5vdCBzdXBwb3J0ZWQgaW4gYnJvd3NlciB2ZXJzaW9uIG9mIHN1cGVyYWdlbnRcIiksdGhpc30sbC5wcm90b3R5cGUucGlwZT1sLnByb3RvdHlwZS53cml0ZT1mdW5jdGlvbigpe3Rocm93IEVycm9yKFwiU3RyZWFtaW5nIGlzIG5vdCBzdXBwb3J0ZWQgaW4gYnJvd3NlciB2ZXJzaW9uIG9mIHN1cGVyYWdlbnRcIil9LGwucHJvdG90eXBlLl9pc0hvc3Q9ZnVuY3Rpb24oZSl7cmV0dXJuIGUmJlwib2JqZWN0XCI9PXR5cGVvZiBlJiYhQXJyYXkuaXNBcnJheShlKSYmXCJbb2JqZWN0IE9iamVjdF1cIiE9PU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChlKX0sbC5wcm90b3R5cGUuZW5kPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9lbmRDYWxsZWQmJmNvbnNvbGUud2FybihcIldhcm5pbmc6IC5lbmQoKSB3YXMgY2FsbGVkIHR3aWNlLiBUaGlzIGlzIG5vdCBzdXBwb3J0ZWQgaW4gc3VwZXJhZ2VudFwiKSx0aGlzLl9lbmRDYWxsZWQ9ITAsdGhpcy5fY2FsbGJhY2s9ZXx8cix0aGlzLl9maW5hbGl6ZVF1ZXJ5U3RyaW5nKCksdGhpcy5fZW5kKCl9LGwucHJvdG90eXBlLl9lbmQ9ZnVuY3Rpb24oKXt2YXIgZT10aGlzLHQ9dGhpcy54aHI9Xy5nZXRYSFIoKSxuPXRoaXMuX2Zvcm1EYXRhfHx0aGlzLl9kYXRhO3RoaXMuX3NldFRpbWVvdXRzKCksdC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKXt2YXIgbj10LnJlYWR5U3RhdGU7aWYobj49MiYmZS5fcmVzcG9uc2VUaW1lb3V0VGltZXImJmNsZWFyVGltZW91dChlLl9yZXNwb25zZVRpbWVvdXRUaW1lciksND09bil7dmFyIHI7dHJ5e3I9dC5zdGF0dXN9Y2F0Y2goZSl7cj0wfWlmKCFyKXtpZihlLnRpbWVkb3V0fHxlLl9hYm9ydGVkKXJldHVybjtyZXR1cm4gZS5jcm9zc0RvbWFpbkVycm9yKCl9ZS5lbWl0KFwiZW5kXCIpfX07dmFyIHI9ZnVuY3Rpb24odCxuKXtuLnRvdGFsPjAmJihuLnBlcmNlbnQ9bi5sb2FkZWQvbi50b3RhbCoxMDApLG4uZGlyZWN0aW9uPXQsZS5lbWl0KFwicHJvZ3Jlc3NcIixuKX07aWYodGhpcy5oYXNMaXN0ZW5lcnMoXCJwcm9ncmVzc1wiKSl0cnl7dC5vbnByb2dyZXNzPXIuYmluZChudWxsLFwiZG93bmxvYWRcIiksdC51cGxvYWQmJih0LnVwbG9hZC5vbnByb2dyZXNzPXIuYmluZChudWxsLFwidXBsb2FkXCIpKX1jYXRjaChlKXt9dHJ5e3RoaXMudXNlcm5hbWUmJnRoaXMucGFzc3dvcmQ/dC5vcGVuKHRoaXMubWV0aG9kLHRoaXMudXJsLCEwLHRoaXMudXNlcm5hbWUsdGhpcy5wYXNzd29yZCk6dC5vcGVuKHRoaXMubWV0aG9kLHRoaXMudXJsLCEwKX1jYXRjaChlKXtyZXR1cm4gdGhpcy5jYWxsYmFjayhlKX1pZih0aGlzLl93aXRoQ3JlZGVudGlhbHMmJih0LndpdGhDcmVkZW50aWFscz0hMCksIXRoaXMuX2Zvcm1EYXRhJiZcIkdFVFwiIT10aGlzLm1ldGhvZCYmXCJIRUFEXCIhPXRoaXMubWV0aG9kJiZcInN0cmluZ1wiIT10eXBlb2YgbiYmIXRoaXMuX2lzSG9zdChuKSl7dmFyIGk9dGhpcy5faGVhZGVyW1wiY29udGVudC10eXBlXCJdLHM9dGhpcy5fc2VyaWFsaXplcnx8Xy5zZXJpYWxpemVbaT9pLnNwbGl0KFwiO1wiKVswXTpcIlwiXTshcyYmdShpKSYmKHM9Xy5zZXJpYWxpemVbXCJhcHBsaWNhdGlvbi9qc29uXCJdKSxzJiYobj1zKG4pKX1mb3IodmFyIG8gaW4gdGhpcy5oZWFkZXIpbnVsbCE9dGhpcy5oZWFkZXJbb10mJnRoaXMuaGVhZGVyLmhhc093blByb3BlcnR5KG8pJiZ0LnNldFJlcXVlc3RIZWFkZXIobyx0aGlzLmhlYWRlcltvXSk7cmV0dXJuIHRoaXMuX3Jlc3BvbnNlVHlwZSYmKHQucmVzcG9uc2VUeXBlPXRoaXMuX3Jlc3BvbnNlVHlwZSksdGhpcy5lbWl0KFwicmVxdWVzdFwiLHRoaXMpLHQuc2VuZCh2b2lkIDAhPT1uP246bnVsbCksdGhpc30sXy5hZ2VudD1mdW5jdGlvbigpe3JldHVybiBuZXcgYn0sW1wiR0VUXCIsXCJQT1NUXCIsXCJPUFRJT05TXCIsXCJQQVRDSFwiLFwiUFVUXCIsXCJERUxFVEVcIl0uZm9yRWFjaChmdW5jdGlvbihlKXtiLnByb3RvdHlwZVtlLnRvTG93ZXJDYXNlKCldPWZ1bmN0aW9uKHQsbil7dmFyIHI9bmV3IF8uUmVxdWVzdChlLHQpO3JldHVybiB0aGlzLl9zZXREZWZhdWx0cyhyKSxuJiZyLmVuZChuKSxyfX0pLGIucHJvdG90eXBlLmRlbD1iLnByb3RvdHlwZS5kZWxldGUsXy5nZXQ9ZnVuY3Rpb24oZSx0LG4pe3ZhciByPV8oXCJHRVRcIixlKTtyZXR1cm5cImZ1bmN0aW9uXCI9PXR5cGVvZiB0JiYobj10LHQ9bnVsbCksdCYmci5xdWVyeSh0KSxuJiZyLmVuZChuKSxyfSxfLmhlYWQ9ZnVuY3Rpb24oZSx0LG4pe3ZhciByPV8oXCJIRUFEXCIsZSk7cmV0dXJuXCJmdW5jdGlvblwiPT10eXBlb2YgdCYmKG49dCx0PW51bGwpLHQmJnIucXVlcnkodCksbiYmci5lbmQobikscn0sXy5vcHRpb25zPWZ1bmN0aW9uKGUsdCxuKXt2YXIgcj1fKFwiT1BUSU9OU1wiLGUpO3JldHVyblwiZnVuY3Rpb25cIj09dHlwZW9mIHQmJihuPXQsdD1udWxsKSx0JiZyLnNlbmQodCksbiYmci5lbmQobikscn0sXy5kZWw9aCxfLmRlbGV0ZT1oLF8ucGF0Y2g9ZnVuY3Rpb24oZSx0LG4pe3ZhciByPV8oXCJQQVRDSFwiLGUpO3JldHVyblwiZnVuY3Rpb25cIj09dHlwZW9mIHQmJihuPXQsdD1udWxsKSx0JiZyLnNlbmQodCksbiYmci5lbmQobikscn0sXy5wb3N0PWZ1bmN0aW9uKGUsdCxuKXt2YXIgcj1fKFwiUE9TVFwiLGUpO3JldHVyblwiZnVuY3Rpb25cIj09dHlwZW9mIHQmJihuPXQsdD1udWxsKSx0JiZyLnNlbmQodCksbiYmci5lbmQobikscn0sXy5wdXQ9ZnVuY3Rpb24oZSx0LG4pe3ZhciByPV8oXCJQVVRcIixlKTtyZXR1cm5cImZ1bmN0aW9uXCI9PXR5cGVvZiB0JiYobj10LHQ9bnVsbCksdCYmci5zZW5kKHQpLG4mJnIuZW5kKG4pLHJ9fSxmdW5jdGlvbihlLHQsbil7ZnVuY3Rpb24gcihlKXtpZihlKXJldHVybiBpKGUpfWZ1bmN0aW9uIGkoZSl7Zm9yKHZhciB0IGluIHIucHJvdG90eXBlKWVbdF09ci5wcm90b3R5cGVbdF07cmV0dXJuIGV9ZS5leHBvcnRzPXIsci5wcm90b3R5cGUub249ci5wcm90b3R5cGUuYWRkRXZlbnRMaXN0ZW5lcj1mdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLl9jYWxsYmFja3M9dGhpcy5fY2FsbGJhY2tzfHx7fSwodGhpcy5fY2FsbGJhY2tzW1wiJFwiK2VdPXRoaXMuX2NhbGxiYWNrc1tcIiRcIitlXXx8W10pLnB1c2godCksdGhpc30sci5wcm90b3R5cGUub25jZT1mdW5jdGlvbihlLHQpe2Z1bmN0aW9uIG4oKXt0aGlzLm9mZihlLG4pLHQuYXBwbHkodGhpcyxhcmd1bWVudHMpfXJldHVybiBuLmZuPXQsdGhpcy5vbihlLG4pLHRoaXN9LHIucHJvdG90eXBlLm9mZj1yLnByb3RvdHlwZS5yZW1vdmVMaXN0ZW5lcj1yLnByb3RvdHlwZS5yZW1vdmVBbGxMaXN0ZW5lcnM9ci5wcm90b3R5cGUucmVtb3ZlRXZlbnRMaXN0ZW5lcj1mdW5jdGlvbihlLHQpe2lmKHRoaXMuX2NhbGxiYWNrcz10aGlzLl9jYWxsYmFja3N8fHt9LDA9PWFyZ3VtZW50cy5sZW5ndGgpcmV0dXJuIHRoaXMuX2NhbGxiYWNrcz17fSx0aGlzO3ZhciBuPXRoaXMuX2NhbGxiYWNrc1tcIiRcIitlXTtpZighbilyZXR1cm4gdGhpcztpZigxPT1hcmd1bWVudHMubGVuZ3RoKXJldHVybiBkZWxldGUgdGhpcy5fY2FsbGJhY2tzW1wiJFwiK2VdLHRoaXM7Zm9yKHZhciByLGk9MDtpPG4ubGVuZ3RoO2krKylpZigocj1uW2ldKT09PXR8fHIuZm49PT10KXtuLnNwbGljZShpLDEpO2JyZWFrfXJldHVybiB0aGlzfSxyLnByb3RvdHlwZS5lbWl0PWZ1bmN0aW9uKGUpe3RoaXMuX2NhbGxiYWNrcz10aGlzLl9jYWxsYmFja3N8fHt9O3ZhciB0PVtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpLG49dGhpcy5fY2FsbGJhY2tzW1wiJFwiK2VdO2lmKG4pe249bi5zbGljZSgwKTtmb3IodmFyIHI9MCxpPW4ubGVuZ3RoO3I8aTsrK3IpbltyXS5hcHBseSh0aGlzLHQpfXJldHVybiB0aGlzfSxyLnByb3RvdHlwZS5saXN0ZW5lcnM9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2NhbGxiYWNrcz10aGlzLl9jYWxsYmFja3N8fHt9LHRoaXMuX2NhbGxiYWNrc1tcIiRcIitlXXx8W119LHIucHJvdG90eXBlLmhhc0xpc3RlbmVycz1mdW5jdGlvbihlKXtyZXR1cm4hIXRoaXMubGlzdGVuZXJzKGUpLmxlbmd0aH19LGZ1bmN0aW9uKGUsdCxuKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiByKGUpe2lmKGUpcmV0dXJuIGkoZSl9ZnVuY3Rpb24gaShlKXtmb3IodmFyIHQgaW4gci5wcm90b3R5cGUpZVt0XT1yLnByb3RvdHlwZVt0XTtyZXR1cm4gZX12YXIgcz1uKDQ1KTtlLmV4cG9ydHM9cixyLnByb3RvdHlwZS5jbGVhclRpbWVvdXQ9ZnVuY3Rpb24oKXtyZXR1cm4gY2xlYXJUaW1lb3V0KHRoaXMuX3RpbWVyKSxjbGVhclRpbWVvdXQodGhpcy5fcmVzcG9uc2VUaW1lb3V0VGltZXIpLGRlbGV0ZSB0aGlzLl90aW1lcixkZWxldGUgdGhpcy5fcmVzcG9uc2VUaW1lb3V0VGltZXIsdGhpc30sci5wcm90b3R5cGUucGFyc2U9ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX3BhcnNlcj1lLHRoaXN9LHIucHJvdG90eXBlLnJlc3BvbnNlVHlwZT1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fcmVzcG9uc2VUeXBlPWUsdGhpc30sci5wcm90b3R5cGUuc2VyaWFsaXplPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9zZXJpYWxpemVyPWUsdGhpc30sci5wcm90b3R5cGUudGltZW91dD1mdW5jdGlvbihlKXtpZighZXx8XCJvYmplY3RcIiE9dHlwZW9mIGUpcmV0dXJuIHRoaXMuX3RpbWVvdXQ9ZSx0aGlzLl9yZXNwb25zZVRpbWVvdXQ9MCx0aGlzO2Zvcih2YXIgdCBpbiBlKXN3aXRjaCh0KXtjYXNlXCJkZWFkbGluZVwiOnRoaXMuX3RpbWVvdXQ9ZS5kZWFkbGluZTticmVhaztjYXNlXCJyZXNwb25zZVwiOnRoaXMuX3Jlc3BvbnNlVGltZW91dD1lLnJlc3BvbnNlO2JyZWFrO2RlZmF1bHQ6Y29uc29sZS53YXJuKFwiVW5rbm93biB0aW1lb3V0IG9wdGlvblwiLHQpfXJldHVybiB0aGlzfSxyLnByb3RvdHlwZS5yZXRyeT1mdW5jdGlvbihlLHQpe3JldHVybiAwIT09YXJndW1lbnRzLmxlbmd0aCYmITAhPT1lfHwoZT0xKSxlPD0wJiYoZT0wKSx0aGlzLl9tYXhSZXRyaWVzPWUsdGhpcy5fcmV0cmllcz0wLHRoaXMuX3JldHJ5Q2FsbGJhY2s9dCx0aGlzfTt2YXIgbz1bXCJFQ09OTlJFU0VUXCIsXCJFVElNRURPVVRcIixcIkVBRERSSU5GT1wiLFwiRVNPQ0tFVFRJTUVET1VUXCJdO3IucHJvdG90eXBlLl9zaG91bGRSZXRyeT1mdW5jdGlvbihlLHQpe2lmKCF0aGlzLl9tYXhSZXRyaWVzfHx0aGlzLl9yZXRyaWVzKys+PXRoaXMuX21heFJldHJpZXMpcmV0dXJuITE7aWYodGhpcy5fcmV0cnlDYWxsYmFjayl0cnl7dmFyIG49dGhpcy5fcmV0cnlDYWxsYmFjayhlLHQpO2lmKCEwPT09bilyZXR1cm4hMDtpZighMT09PW4pcmV0dXJuITF9Y2F0Y2goZSl7Y29uc29sZS5lcnJvcihlKX1pZih0JiZ0LnN0YXR1cyYmdC5zdGF0dXM+PTUwMCYmNTAxIT10LnN0YXR1cylyZXR1cm4hMDtpZihlKXtpZihlLmNvZGUmJn5vLmluZGV4T2YoZS5jb2RlKSlyZXR1cm4hMDtpZihlLnRpbWVvdXQmJlwiRUNPTk5BQk9SVEVEXCI9PWUuY29kZSlyZXR1cm4hMDtpZihlLmNyb3NzRG9tYWluKXJldHVybiEwfXJldHVybiExfSxyLnByb3RvdHlwZS5fcmV0cnk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jbGVhclRpbWVvdXQoKSx0aGlzLnJlcSYmKHRoaXMucmVxPW51bGwsdGhpcy5yZXE9dGhpcy5yZXF1ZXN0KCkpLHRoaXMuX2Fib3J0ZWQ9ITEsdGhpcy50aW1lZG91dD0hMSx0aGlzLl9lbmQoKX0sci5wcm90b3R5cGUudGhlbj1mdW5jdGlvbihlLHQpe2lmKCF0aGlzLl9mdWxsZmlsbGVkUHJvbWlzZSl7dmFyIG49dGhpczt0aGlzLl9lbmRDYWxsZWQmJmNvbnNvbGUud2FybihcIldhcm5pbmc6IHN1cGVyYWdlbnQgcmVxdWVzdCB3YXMgc2VudCB0d2ljZSwgYmVjYXVzZSBib3RoIC5lbmQoKSBhbmQgLnRoZW4oKSB3ZXJlIGNhbGxlZC4gTmV2ZXIgY2FsbCAuZW5kKCkgaWYgeW91IHVzZSBwcm9taXNlc1wiKSx0aGlzLl9mdWxsZmlsbGVkUHJvbWlzZT1uZXcgUHJvbWlzZShmdW5jdGlvbihlLHQpe24uZW5kKGZ1bmN0aW9uKG4scil7bj90KG4pOmUocil9KX0pfXJldHVybiB0aGlzLl9mdWxsZmlsbGVkUHJvbWlzZS50aGVuKGUsdCl9LHIucHJvdG90eXBlLmNhdGNoPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLnRoZW4odm9pZCAwLGUpfSxyLnByb3RvdHlwZS51c2U9ZnVuY3Rpb24oZSl7cmV0dXJuIGUodGhpcyksdGhpc30sci5wcm90b3R5cGUub2s9ZnVuY3Rpb24oZSl7aWYoXCJmdW5jdGlvblwiIT10eXBlb2YgZSl0aHJvdyBFcnJvcihcIkNhbGxiYWNrIHJlcXVpcmVkXCIpO3JldHVybiB0aGlzLl9va0NhbGxiYWNrPWUsdGhpc30sci5wcm90b3R5cGUuX2lzUmVzcG9uc2VPSz1mdW5jdGlvbihlKXtyZXR1cm4hIWUmJih0aGlzLl9va0NhbGxiYWNrP3RoaXMuX29rQ2FsbGJhY2soZSk6ZS5zdGF0dXM+PTIwMCYmZS5zdGF0dXM8MzAwKX0sci5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9oZWFkZXJbZS50b0xvd2VyQ2FzZSgpXX0sci5wcm90b3R5cGUuZ2V0SGVhZGVyPXIucHJvdG90eXBlLmdldCxyLnByb3RvdHlwZS5zZXQ9ZnVuY3Rpb24oZSx0KXtpZihzKGUpKXtmb3IodmFyIG4gaW4gZSl0aGlzLnNldChuLGVbbl0pO3JldHVybiB0aGlzfXJldHVybiB0aGlzLl9oZWFkZXJbZS50b0xvd2VyQ2FzZSgpXT10LHRoaXMuaGVhZGVyW2VdPXQsdGhpc30sci5wcm90b3R5cGUudW5zZXQ9ZnVuY3Rpb24oZSl7cmV0dXJuIGRlbGV0ZSB0aGlzLl9oZWFkZXJbZS50b0xvd2VyQ2FzZSgpXSxkZWxldGUgdGhpcy5oZWFkZXJbZV0sdGhpc30sci5wcm90b3R5cGUuZmllbGQ9ZnVuY3Rpb24oZSx0KXtpZihudWxsPT09ZXx8dm9pZCAwPT09ZSl0aHJvdyBuZXcgRXJyb3IoXCIuZmllbGQobmFtZSwgdmFsKSBuYW1lIGNhbiBub3QgYmUgZW1wdHlcIik7aWYodGhpcy5fZGF0YSYmY29uc29sZS5lcnJvcihcIi5maWVsZCgpIGNhbid0IGJlIHVzZWQgaWYgLnNlbmQoKSBpcyB1c2VkLiBQbGVhc2UgdXNlIG9ubHkgLnNlbmQoKSBvciBvbmx5IC5maWVsZCgpICYgLmF0dGFjaCgpXCIpLHMoZSkpe2Zvcih2YXIgbiBpbiBlKXRoaXMuZmllbGQobixlW25dKTtyZXR1cm4gdGhpc31pZihBcnJheS5pc0FycmF5KHQpKXtmb3IodmFyIHIgaW4gdCl0aGlzLmZpZWxkKGUsdFtyXSk7cmV0dXJuIHRoaXN9aWYobnVsbD09PXR8fHZvaWQgMD09PXQpdGhyb3cgbmV3IEVycm9yKFwiLmZpZWxkKG5hbWUsIHZhbCkgdmFsIGNhbiBub3QgYmUgZW1wdHlcIik7cmV0dXJuXCJib29sZWFuXCI9PXR5cGVvZiB0JiYodD1cIlwiK3QpLHRoaXMuX2dldEZvcm1EYXRhKCkuYXBwZW5kKGUsdCksdGhpc30sci5wcm90b3R5cGUuYWJvcnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fYWJvcnRlZD90aGlzOih0aGlzLl9hYm9ydGVkPSEwLHRoaXMueGhyJiZ0aGlzLnhoci5hYm9ydCgpLHRoaXMucmVxJiZ0aGlzLnJlcS5hYm9ydCgpLHRoaXMuY2xlYXJUaW1lb3V0KCksdGhpcy5lbWl0KFwiYWJvcnRcIiksdGhpcyl9LHIucHJvdG90eXBlLl9hdXRoPWZ1bmN0aW9uKGUsdCxuLHIpe3N3aXRjaChuLnR5cGUpe2Nhc2VcImJhc2ljXCI6dGhpcy5zZXQoXCJBdXRob3JpemF0aW9uXCIsXCJCYXNpYyBcIityKGUrXCI6XCIrdCkpO2JyZWFrO2Nhc2VcImF1dG9cIjp0aGlzLnVzZXJuYW1lPWUsdGhpcy5wYXNzd29yZD10O2JyZWFrO2Nhc2VcImJlYXJlclwiOnRoaXMuc2V0KFwiQXV0aG9yaXphdGlvblwiLFwiQmVhcmVyIFwiK2UpfXJldHVybiB0aGlzfSxyLnByb3RvdHlwZS53aXRoQ3JlZGVudGlhbHM9ZnVuY3Rpb24oZSl7cmV0dXJuIHZvaWQgMD09ZSYmKGU9ITApLHRoaXMuX3dpdGhDcmVkZW50aWFscz1lLHRoaXN9LHIucHJvdG90eXBlLnJlZGlyZWN0cz1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fbWF4UmVkaXJlY3RzPWUsdGhpc30sci5wcm90b3R5cGUubWF4UmVzcG9uc2VTaXplPWZ1bmN0aW9uKGUpe2lmKFwibnVtYmVyXCIhPXR5cGVvZiBlKXRocm93IFR5cGVFcnJvcihcIkludmFsaWQgYXJndW1lbnRcIik7cmV0dXJuIHRoaXMuX21heFJlc3BvbnNlU2l6ZT1lLHRoaXN9LHIucHJvdG90eXBlLnRvSlNPTj1mdW5jdGlvbigpe3JldHVybnttZXRob2Q6dGhpcy5tZXRob2QsdXJsOnRoaXMudXJsLGRhdGE6dGhpcy5fZGF0YSxoZWFkZXJzOnRoaXMuX2hlYWRlcn19LHIucHJvdG90eXBlLnNlbmQ9ZnVuY3Rpb24oZSl7dmFyIHQ9cyhlKSxuPXRoaXMuX2hlYWRlcltcImNvbnRlbnQtdHlwZVwiXTtpZih0aGlzLl9mb3JtRGF0YSYmY29uc29sZS5lcnJvcihcIi5zZW5kKCkgY2FuJ3QgYmUgdXNlZCBpZiAuYXR0YWNoKCkgb3IgLmZpZWxkKCkgaXMgdXNlZC4gUGxlYXNlIHVzZSBvbmx5IC5zZW5kKCkgb3Igb25seSAuZmllbGQoKSAmIC5hdHRhY2goKVwiKSx0JiYhdGhpcy5fZGF0YSlBcnJheS5pc0FycmF5KGUpP3RoaXMuX2RhdGE9W106dGhpcy5faXNIb3N0KGUpfHwodGhpcy5fZGF0YT17fSk7ZWxzZSBpZihlJiZ0aGlzLl9kYXRhJiZ0aGlzLl9pc0hvc3QodGhpcy5fZGF0YSkpdGhyb3cgRXJyb3IoXCJDYW4ndCBtZXJnZSB0aGVzZSBzZW5kIGNhbGxzXCIpO2lmKHQmJnModGhpcy5fZGF0YSkpZm9yKHZhciByIGluIGUpdGhpcy5fZGF0YVtyXT1lW3JdO2Vsc2VcInN0cmluZ1wiPT10eXBlb2YgZT8obnx8dGhpcy50eXBlKFwiZm9ybVwiKSxuPXRoaXMuX2hlYWRlcltcImNvbnRlbnQtdHlwZVwiXSx0aGlzLl9kYXRhPVwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkXCI9PW4/dGhpcy5fZGF0YT90aGlzLl9kYXRhK1wiJlwiK2U6ZToodGhpcy5fZGF0YXx8XCJcIikrZSk6dGhpcy5fZGF0YT1lO3JldHVybiF0fHx0aGlzLl9pc0hvc3QoZSk/dGhpczoobnx8dGhpcy50eXBlKFwianNvblwiKSx0aGlzKX0sci5wcm90b3R5cGUuc29ydFF1ZXJ5PWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9zb3J0PXZvaWQgMD09PWV8fGUsdGhpc30sci5wcm90b3R5cGUuX2ZpbmFsaXplUXVlcnlTdHJpbmc9ZnVuY3Rpb24oKXt2YXIgZT10aGlzLl9xdWVyeS5qb2luKFwiJlwiKTtpZihlJiYodGhpcy51cmwrPSh0aGlzLnVybC5pbmRleE9mKFwiP1wiKT49MD9cIiZcIjpcIj9cIikrZSksdGhpcy5fcXVlcnkubGVuZ3RoPTAsdGhpcy5fc29ydCl7dmFyIHQ9dGhpcy51cmwuaW5kZXhPZihcIj9cIik7aWYodD49MCl7dmFyIG49dGhpcy51cmwuc3Vic3RyaW5nKHQrMSkuc3BsaXQoXCImXCIpO1wiZnVuY3Rpb25cIj09dHlwZW9mIHRoaXMuX3NvcnQ/bi5zb3J0KHRoaXMuX3NvcnQpOm4uc29ydCgpLHRoaXMudXJsPXRoaXMudXJsLnN1YnN0cmluZygwLHQpK1wiP1wiK24uam9pbihcIiZcIil9fX0sci5wcm90b3R5cGUuX2FwcGVuZFF1ZXJ5U3RyaW5nPWZ1bmN0aW9uKCl7Y29uc29sZS50cmFjZShcIlVuc3VwcG9ydGVkXCIpfSxyLnByb3RvdHlwZS5fdGltZW91dEVycm9yPWZ1bmN0aW9uKGUsdCxuKXtpZighdGhpcy5fYWJvcnRlZCl7dmFyIHI9bmV3IEVycm9yKGUrdCtcIm1zIGV4Y2VlZGVkXCIpO3IudGltZW91dD10LHIuY29kZT1cIkVDT05OQUJPUlRFRFwiLHIuZXJybm89bix0aGlzLnRpbWVkb3V0PSEwLHRoaXMuYWJvcnQoKSx0aGlzLmNhbGxiYWNrKHIpfX0sci5wcm90b3R5cGUuX3NldFRpbWVvdXRzPWZ1bmN0aW9uKCl7dmFyIGU9dGhpczt0aGlzLl90aW1lb3V0JiYhdGhpcy5fdGltZXImJih0aGlzLl90aW1lcj1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7ZS5fdGltZW91dEVycm9yKFwiVGltZW91dCBvZiBcIixlLl90aW1lb3V0LFwiRVRJTUVcIil9LHRoaXMuX3RpbWVvdXQpKSx0aGlzLl9yZXNwb25zZVRpbWVvdXQmJiF0aGlzLl9yZXNwb25zZVRpbWVvdXRUaW1lciYmKHRoaXMuX3Jlc3BvbnNlVGltZW91dFRpbWVyPXNldFRpbWVvdXQoZnVuY3Rpb24oKXtlLl90aW1lb3V0RXJyb3IoXCJSZXNwb25zZSB0aW1lb3V0IG9mIFwiLGUuX3Jlc3BvbnNlVGltZW91dCxcIkVUSU1FRE9VVFwiKX0sdGhpcy5fcmVzcG9uc2VUaW1lb3V0KSl9fSxmdW5jdGlvbihlLHQpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIG4oZSl7cmV0dXJuIG51bGwhPT1lJiZcIm9iamVjdFwiPT10eXBlb2YgZX1lLmV4cG9ydHM9bn0sZnVuY3Rpb24oZSx0LG4pe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIHIoZSl7aWYoZSlyZXR1cm4gaShlKX1mdW5jdGlvbiBpKGUpe2Zvcih2YXIgdCBpbiByLnByb3RvdHlwZSllW3RdPXIucHJvdG90eXBlW3RdO3JldHVybiBlfXZhciBzPW4oNDcpO2UuZXhwb3J0cz1yLHIucHJvdG90eXBlLmdldD1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5oZWFkZXJbZS50b0xvd2VyQ2FzZSgpXX0sci5wcm90b3R5cGUuX3NldEhlYWRlclByb3BlcnRpZXM9ZnVuY3Rpb24oZSl7dmFyIHQ9ZVtcImNvbnRlbnQtdHlwZVwiXXx8XCJcIjt0aGlzLnR5cGU9cy50eXBlKHQpO3ZhciBuPXMucGFyYW1zKHQpO2Zvcih2YXIgciBpbiBuKXRoaXNbcl09bltyXTt0aGlzLmxpbmtzPXt9O3RyeXtlLmxpbmsmJih0aGlzLmxpbmtzPXMucGFyc2VMaW5rcyhlLmxpbmspKX1jYXRjaChlKXt9fSxyLnByb3RvdHlwZS5fc2V0U3RhdHVzUHJvcGVydGllcz1mdW5jdGlvbihlKXt2YXIgdD1lLzEwMHwwO3RoaXMuc3RhdHVzPXRoaXMuc3RhdHVzQ29kZT1lLHRoaXMuc3RhdHVzVHlwZT10LHRoaXMuaW5mbz0xPT10LHRoaXMub2s9Mj09dCx0aGlzLnJlZGlyZWN0PTM9PXQsdGhpcy5jbGllbnRFcnJvcj00PT10LHRoaXMuc2VydmVyRXJyb3I9NT09dCx0aGlzLmVycm9yPSg0PT10fHw1PT10KSYmdGhpcy50b0Vycm9yKCksdGhpcy5hY2NlcHRlZD0yMDI9PWUsdGhpcy5ub0NvbnRlbnQ9MjA0PT1lLHRoaXMuYmFkUmVxdWVzdD00MDA9PWUsdGhpcy51bmF1dGhvcml6ZWQ9NDAxPT1lLHRoaXMubm90QWNjZXB0YWJsZT00MDY9PWUsdGhpcy5mb3JiaWRkZW49NDAzPT1lLHRoaXMubm90Rm91bmQ9NDA0PT1lfX0sZnVuY3Rpb24oZSx0KXtcInVzZSBzdHJpY3RcIjt0LnR5cGU9ZnVuY3Rpb24oZSl7cmV0dXJuIGUuc3BsaXQoLyAqOyAqLykuc2hpZnQoKX0sdC5wYXJhbXM9ZnVuY3Rpb24oZSl7cmV0dXJuIGUuc3BsaXQoLyAqOyAqLykucmVkdWNlKGZ1bmN0aW9uKGUsdCl7dmFyIG49dC5zcGxpdCgvICo9ICovKSxyPW4uc2hpZnQoKSxpPW4uc2hpZnQoKTtyZXR1cm4gciYmaSYmKGVbcl09aSksZX0se30pfSx0LnBhcnNlTGlua3M9ZnVuY3Rpb24oZSl7cmV0dXJuIGUuc3BsaXQoLyAqLCAqLykucmVkdWNlKGZ1bmN0aW9uKGUsdCl7dmFyIG49dC5zcGxpdCgvICo7ICovKSxyPW5bMF0uc2xpY2UoMSwtMSk7cmV0dXJuIGVbblsxXS5zcGxpdCgvICo9ICovKVsxXS5zbGljZSgxLC0xKV09cixlfSx7fSl9LHQuY2xlYW5IZWFkZXI9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZGVsZXRlIGVbXCJjb250ZW50LXR5cGVcIl0sZGVsZXRlIGVbXCJjb250ZW50LWxlbmd0aFwiXSxkZWxldGUgZVtcInRyYW5zZmVyLWVuY29kaW5nXCJdLGRlbGV0ZSBlLmhvc3QsdCYmKGRlbGV0ZSBlLmF1dGhvcml6YXRpb24sZGVsZXRlIGUuY29va2llKSxlfX0sZnVuY3Rpb24oZSx0KXtmdW5jdGlvbiBuKCl7dGhpcy5fZGVmYXVsdHM9W119W1widXNlXCIsXCJvblwiLFwib25jZVwiLFwic2V0XCIsXCJxdWVyeVwiLFwidHlwZVwiLFwiYWNjZXB0XCIsXCJhdXRoXCIsXCJ3aXRoQ3JlZGVudGlhbHNcIixcInNvcnRRdWVyeVwiLFwicmV0cnlcIixcIm9rXCIsXCJyZWRpcmVjdHNcIixcInRpbWVvdXRcIixcImJ1ZmZlclwiLFwic2VyaWFsaXplXCIsXCJwYXJzZVwiLFwiY2FcIixcImtleVwiLFwicGZ4XCIsXCJjZXJ0XCJdLmZvckVhY2goZnVuY3Rpb24oZSl7bi5wcm90b3R5cGVbZV09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZGVmYXVsdHMucHVzaCh7Zm46ZSxhcmd1bWVudHM6YXJndW1lbnRzfSksdGhpc319KSxuLnByb3RvdHlwZS5fc2V0RGVmYXVsdHM9ZnVuY3Rpb24oZSl7dGhpcy5fZGVmYXVsdHMuZm9yRWFjaChmdW5jdGlvbih0KXtlW3QuZm5dLmFwcGx5KGUsdC5hcmd1bWVudHMpfSl9LGUuZXhwb3J0cz1ufV0pfSk7IiwiLy8gQ29weXJpZ2h0IEpveWVudCwgSW5jLiBhbmQgb3RoZXIgTm9kZSBjb250cmlidXRvcnMuXG4vL1xuLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGFcbi8vIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGVcbi8vIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZ1xuLy8gd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLFxuLy8gZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdFxuLy8gcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlXG4vLyBmb2xsb3dpbmcgY29uZGl0aW9uczpcbi8vXG4vLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZFxuLy8gaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4vL1xuLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTU1xuLy8gT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRlxuLy8gTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTlxuLy8gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sXG4vLyBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1Jcbi8vIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEVcbi8vIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuXG5cbid1c2Ugc3RyaWN0JztcblxuLy8gSWYgb2JqLmhhc093blByb3BlcnR5IGhhcyBiZWVuIG92ZXJyaWRkZW4sIHRoZW4gY2FsbGluZ1xuLy8gb2JqLmhhc093blByb3BlcnR5KHByb3ApIHdpbGwgYnJlYWsuXG4vLyBTZWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9qb3llbnQvbm9kZS9pc3N1ZXMvMTcwN1xuZnVuY3Rpb24gaGFzT3duUHJvcGVydHkob2JqLCBwcm9wKSB7XG4gIHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihxcywgc2VwLCBlcSwgb3B0aW9ucykge1xuICBzZXAgPSBzZXAgfHwgJyYnO1xuICBlcSA9IGVxIHx8ICc9JztcbiAgdmFyIG9iaiA9IHt9O1xuXG4gIGlmICh0eXBlb2YgcXMgIT09ICdzdHJpbmcnIHx8IHFzLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiBvYmo7XG4gIH1cblxuICB2YXIgcmVnZXhwID0gL1xcKy9nO1xuICBxcyA9IHFzLnNwbGl0KHNlcCk7XG5cbiAgdmFyIG1heEtleXMgPSAxMDAwO1xuICBpZiAob3B0aW9ucyAmJiB0eXBlb2Ygb3B0aW9ucy5tYXhLZXlzID09PSAnbnVtYmVyJykge1xuICAgIG1heEtleXMgPSBvcHRpb25zLm1heEtleXM7XG4gIH1cblxuICB2YXIgbGVuID0gcXMubGVuZ3RoO1xuICAvLyBtYXhLZXlzIDw9IDAgbWVhbnMgdGhhdCB3ZSBzaG91bGQgbm90IGxpbWl0IGtleXMgY291bnRcbiAgaWYgKG1heEtleXMgPiAwICYmIGxlbiA+IG1heEtleXMpIHtcbiAgICBsZW4gPSBtYXhLZXlzO1xuICB9XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47ICsraSkge1xuICAgIHZhciB4ID0gcXNbaV0ucmVwbGFjZShyZWdleHAsICclMjAnKSxcbiAgICAgICAgaWR4ID0geC5pbmRleE9mKGVxKSxcbiAgICAgICAga3N0ciwgdnN0ciwgaywgdjtcblxuICAgIGlmIChpZHggPj0gMCkge1xuICAgICAga3N0ciA9IHguc3Vic3RyKDAsIGlkeCk7XG4gICAgICB2c3RyID0geC5zdWJzdHIoaWR4ICsgMSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGtzdHIgPSB4O1xuICAgICAgdnN0ciA9ICcnO1xuICAgIH1cblxuICAgIGsgPSBkZWNvZGVVUklDb21wb25lbnQoa3N0cik7XG4gICAgdiA9IGRlY29kZVVSSUNvbXBvbmVudCh2c3RyKTtcblxuICAgIGlmICghaGFzT3duUHJvcGVydHkob2JqLCBrKSkge1xuICAgICAgb2JqW2tdID0gdjtcbiAgICB9IGVsc2UgaWYgKGlzQXJyYXkob2JqW2tdKSkge1xuICAgICAgb2JqW2tdLnB1c2godik7XG4gICAgfSBlbHNlIHtcbiAgICAgIG9ialtrXSA9IFtvYmpba10sIHZdO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBvYmo7XG59O1xuXG52YXIgaXNBcnJheSA9IEFycmF5LmlzQXJyYXkgfHwgZnVuY3Rpb24gKHhzKSB7XG4gIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoeHMpID09PSAnW29iamVjdCBBcnJheV0nO1xufTtcbiIsIi8vIENvcHlyaWdodCBKb3llbnQsIEluYy4gYW5kIG90aGVyIE5vZGUgY29udHJpYnV0b3JzLlxuLy9cbi8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhXG4vLyBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlXG4vLyBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmdcbi8vIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCxcbi8vIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXRcbi8vIHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZVxuLy8gZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4vL1xuLy8gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWRcbi8vIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuLy9cbi8vIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1Ncbi8vIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0Zcbi8vIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU5cbi8vIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLFxuLy8gREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SXG4vLyBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFXG4vLyBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLlxuXG4ndXNlIHN0cmljdCc7XG5cbnZhciBzdHJpbmdpZnlQcmltaXRpdmUgPSBmdW5jdGlvbih2KSB7XG4gIHN3aXRjaCAodHlwZW9mIHYpIHtcbiAgICBjYXNlICdzdHJpbmcnOlxuICAgICAgcmV0dXJuIHY7XG5cbiAgICBjYXNlICdib29sZWFuJzpcbiAgICAgIHJldHVybiB2ID8gJ3RydWUnIDogJ2ZhbHNlJztcblxuICAgIGNhc2UgJ251bWJlcic6XG4gICAgICByZXR1cm4gaXNGaW5pdGUodikgPyB2IDogJyc7XG5cbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuICcnO1xuICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG9iaiwgc2VwLCBlcSwgbmFtZSkge1xuICBzZXAgPSBzZXAgfHwgJyYnO1xuICBlcSA9IGVxIHx8ICc9JztcbiAgaWYgKG9iaiA9PT0gbnVsbCkge1xuICAgIG9iaiA9IHVuZGVmaW5lZDtcbiAgfVxuXG4gIGlmICh0eXBlb2Ygb2JqID09PSAnb2JqZWN0Jykge1xuICAgIHJldHVybiBtYXAob2JqZWN0S2V5cyhvYmopLCBmdW5jdGlvbihrKSB7XG4gICAgICB2YXIga3MgPSBlbmNvZGVVUklDb21wb25lbnQoc3RyaW5naWZ5UHJpbWl0aXZlKGspKSArIGVxO1xuICAgICAgaWYgKGlzQXJyYXkob2JqW2tdKSkge1xuICAgICAgICByZXR1cm4gbWFwKG9ialtrXSwgZnVuY3Rpb24odikge1xuICAgICAgICAgIHJldHVybiBrcyArIGVuY29kZVVSSUNvbXBvbmVudChzdHJpbmdpZnlQcmltaXRpdmUodikpO1xuICAgICAgICB9KS5qb2luKHNlcCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4ga3MgKyBlbmNvZGVVUklDb21wb25lbnQoc3RyaW5naWZ5UHJpbWl0aXZlKG9ialtrXSkpO1xuICAgICAgfVxuICAgIH0pLmpvaW4oc2VwKTtcblxuICB9XG5cbiAgaWYgKCFuYW1lKSByZXR1cm4gJyc7XG4gIHJldHVybiBlbmNvZGVVUklDb21wb25lbnQoc3RyaW5naWZ5UHJpbWl0aXZlKG5hbWUpKSArIGVxICtcbiAgICAgICAgIGVuY29kZVVSSUNvbXBvbmVudChzdHJpbmdpZnlQcmltaXRpdmUob2JqKSk7XG59O1xuXG52YXIgaXNBcnJheSA9IEFycmF5LmlzQXJyYXkgfHwgZnVuY3Rpb24gKHhzKSB7XG4gIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoeHMpID09PSAnW29iamVjdCBBcnJheV0nO1xufTtcblxuZnVuY3Rpb24gbWFwICh4cywgZikge1xuICBpZiAoeHMubWFwKSByZXR1cm4geHMubWFwKGYpO1xuICB2YXIgcmVzID0gW107XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgeHMubGVuZ3RoOyBpKyspIHtcbiAgICByZXMucHVzaChmKHhzW2ldLCBpKSk7XG4gIH1cbiAgcmV0dXJuIHJlcztcbn1cblxudmFyIG9iamVjdEtleXMgPSBPYmplY3Qua2V5cyB8fCBmdW5jdGlvbiAob2JqKSB7XG4gIHZhciByZXMgPSBbXTtcbiAgZm9yICh2YXIga2V5IGluIG9iaikge1xuICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSByZXMucHVzaChrZXkpO1xuICB9XG4gIHJldHVybiByZXM7XG59O1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG5leHBvcnRzLmRlY29kZSA9IGV4cG9ydHMucGFyc2UgPSByZXF1aXJlKCcuL2RlY29kZScpO1xuZXhwb3J0cy5lbmNvZGUgPSBleHBvcnRzLnN0cmluZ2lmeSA9IHJlcXVpcmUoJy4vZW5jb2RlJyk7XG4iLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNC1wcmVzZW50LCBGYWNlYm9vaywgSW5jLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICovXG5cbi8vIFRoaXMgbWV0aG9kIG9mIG9idGFpbmluZyBhIHJlZmVyZW5jZSB0byB0aGUgZ2xvYmFsIG9iamVjdCBuZWVkcyB0byBiZVxuLy8ga2VwdCBpZGVudGljYWwgdG8gdGhlIHdheSBpdCBpcyBvYnRhaW5lZCBpbiBydW50aW1lLmpzXG52YXIgZyA9IChmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHRoaXMgfHwgKHR5cGVvZiBzZWxmID09PSBcIm9iamVjdFwiICYmIHNlbGYpO1xufSkoKSB8fCBGdW5jdGlvbihcInJldHVybiB0aGlzXCIpKCk7XG5cbi8vIFVzZSBgZ2V0T3duUHJvcGVydHlOYW1lc2AgYmVjYXVzZSBub3QgYWxsIGJyb3dzZXJzIHN1cHBvcnQgY2FsbGluZ1xuLy8gYGhhc093blByb3BlcnR5YCBvbiB0aGUgZ2xvYmFsIGBzZWxmYCBvYmplY3QgaW4gYSB3b3JrZXIuIFNlZSAjMTgzLlxudmFyIGhhZFJ1bnRpbWUgPSBnLnJlZ2VuZXJhdG9yUnVudGltZSAmJlxuICBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhnKS5pbmRleE9mKFwicmVnZW5lcmF0b3JSdW50aW1lXCIpID49IDA7XG5cbi8vIFNhdmUgdGhlIG9sZCByZWdlbmVyYXRvclJ1bnRpbWUgaW4gY2FzZSBpdCBuZWVkcyB0byBiZSByZXN0b3JlZCBsYXRlci5cbnZhciBvbGRSdW50aW1lID0gaGFkUnVudGltZSAmJiBnLnJlZ2VuZXJhdG9yUnVudGltZTtcblxuLy8gRm9yY2UgcmVldmFsdXRhdGlvbiBvZiBydW50aW1lLmpzLlxuZy5yZWdlbmVyYXRvclJ1bnRpbWUgPSB1bmRlZmluZWQ7XG5cbm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcIi4vcnVudGltZVwiKTtcblxuaWYgKGhhZFJ1bnRpbWUpIHtcbiAgLy8gUmVzdG9yZSB0aGUgb3JpZ2luYWwgcnVudGltZS5cbiAgZy5yZWdlbmVyYXRvclJ1bnRpbWUgPSBvbGRSdW50aW1lO1xufSBlbHNlIHtcbiAgLy8gUmVtb3ZlIHRoZSBnbG9iYWwgcHJvcGVydHkgYWRkZWQgYnkgcnVudGltZS5qcy5cbiAgdHJ5IHtcbiAgICBkZWxldGUgZy5yZWdlbmVyYXRvclJ1bnRpbWU7XG4gIH0gY2F0Y2goZSkge1xuICAgIGcucmVnZW5lcmF0b3JSdW50aW1lID0gdW5kZWZpbmVkO1xuICB9XG59XG4iLCIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNC1wcmVzZW50LCBGYWNlYm9vaywgSW5jLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICovXG5cbiEoZnVuY3Rpb24oZ2xvYmFsKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIHZhciBPcCA9IE9iamVjdC5wcm90b3R5cGU7XG4gIHZhciBoYXNPd24gPSBPcC5oYXNPd25Qcm9wZXJ0eTtcbiAgdmFyIHVuZGVmaW5lZDsgLy8gTW9yZSBjb21wcmVzc2libGUgdGhhbiB2b2lkIDAuXG4gIHZhciAkU3ltYm9sID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiID8gU3ltYm9sIDoge307XG4gIHZhciBpdGVyYXRvclN5bWJvbCA9ICRTeW1ib2wuaXRlcmF0b3IgfHwgXCJAQGl0ZXJhdG9yXCI7XG4gIHZhciBhc3luY0l0ZXJhdG9yU3ltYm9sID0gJFN5bWJvbC5hc3luY0l0ZXJhdG9yIHx8IFwiQEBhc3luY0l0ZXJhdG9yXCI7XG4gIHZhciB0b1N0cmluZ1RhZ1N5bWJvbCA9ICRTeW1ib2wudG9TdHJpbmdUYWcgfHwgXCJAQHRvU3RyaW5nVGFnXCI7XG5cbiAgdmFyIGluTW9kdWxlID0gdHlwZW9mIG1vZHVsZSA9PT0gXCJvYmplY3RcIjtcbiAgdmFyIHJ1bnRpbWUgPSBnbG9iYWwucmVnZW5lcmF0b3JSdW50aW1lO1xuICBpZiAocnVudGltZSkge1xuICAgIGlmIChpbk1vZHVsZSkge1xuICAgICAgLy8gSWYgcmVnZW5lcmF0b3JSdW50aW1lIGlzIGRlZmluZWQgZ2xvYmFsbHkgYW5kIHdlJ3JlIGluIGEgbW9kdWxlLFxuICAgICAgLy8gbWFrZSB0aGUgZXhwb3J0cyBvYmplY3QgaWRlbnRpY2FsIHRvIHJlZ2VuZXJhdG9yUnVudGltZS5cbiAgICAgIG1vZHVsZS5leHBvcnRzID0gcnVudGltZTtcbiAgICB9XG4gICAgLy8gRG9uJ3QgYm90aGVyIGV2YWx1YXRpbmcgdGhlIHJlc3Qgb2YgdGhpcyBmaWxlIGlmIHRoZSBydW50aW1lIHdhc1xuICAgIC8vIGFscmVhZHkgZGVmaW5lZCBnbG9iYWxseS5cbiAgICByZXR1cm47XG4gIH1cblxuICAvLyBEZWZpbmUgdGhlIHJ1bnRpbWUgZ2xvYmFsbHkgKGFzIGV4cGVjdGVkIGJ5IGdlbmVyYXRlZCBjb2RlKSBhcyBlaXRoZXJcbiAgLy8gbW9kdWxlLmV4cG9ydHMgKGlmIHdlJ3JlIGluIGEgbW9kdWxlKSBvciBhIG5ldywgZW1wdHkgb2JqZWN0LlxuICBydW50aW1lID0gZ2xvYmFsLnJlZ2VuZXJhdG9yUnVudGltZSA9IGluTW9kdWxlID8gbW9kdWxlLmV4cG9ydHMgOiB7fTtcblxuICBmdW5jdGlvbiB3cmFwKGlubmVyRm4sIG91dGVyRm4sIHNlbGYsIHRyeUxvY3NMaXN0KSB7XG4gICAgLy8gSWYgb3V0ZXJGbiBwcm92aWRlZCBhbmQgb3V0ZXJGbi5wcm90b3R5cGUgaXMgYSBHZW5lcmF0b3IsIHRoZW4gb3V0ZXJGbi5wcm90b3R5cGUgaW5zdGFuY2VvZiBHZW5lcmF0b3IuXG4gICAgdmFyIHByb3RvR2VuZXJhdG9yID0gb3V0ZXJGbiAmJiBvdXRlckZuLnByb3RvdHlwZSBpbnN0YW5jZW9mIEdlbmVyYXRvciA/IG91dGVyRm4gOiBHZW5lcmF0b3I7XG4gICAgdmFyIGdlbmVyYXRvciA9IE9iamVjdC5jcmVhdGUocHJvdG9HZW5lcmF0b3IucHJvdG90eXBlKTtcbiAgICB2YXIgY29udGV4dCA9IG5ldyBDb250ZXh0KHRyeUxvY3NMaXN0IHx8IFtdKTtcblxuICAgIC8vIFRoZSAuX2ludm9rZSBtZXRob2QgdW5pZmllcyB0aGUgaW1wbGVtZW50YXRpb25zIG9mIHRoZSAubmV4dCxcbiAgICAvLyAudGhyb3csIGFuZCAucmV0dXJuIG1ldGhvZHMuXG4gICAgZ2VuZXJhdG9yLl9pbnZva2UgPSBtYWtlSW52b2tlTWV0aG9kKGlubmVyRm4sIHNlbGYsIGNvbnRleHQpO1xuXG4gICAgcmV0dXJuIGdlbmVyYXRvcjtcbiAgfVxuICBydW50aW1lLndyYXAgPSB3cmFwO1xuXG4gIC8vIFRyeS9jYXRjaCBoZWxwZXIgdG8gbWluaW1pemUgZGVvcHRpbWl6YXRpb25zLiBSZXR1cm5zIGEgY29tcGxldGlvblxuICAvLyByZWNvcmQgbGlrZSBjb250ZXh0LnRyeUVudHJpZXNbaV0uY29tcGxldGlvbi4gVGhpcyBpbnRlcmZhY2UgY291bGRcbiAgLy8gaGF2ZSBiZWVuIChhbmQgd2FzIHByZXZpb3VzbHkpIGRlc2lnbmVkIHRvIHRha2UgYSBjbG9zdXJlIHRvIGJlXG4gIC8vIGludm9rZWQgd2l0aG91dCBhcmd1bWVudHMsIGJ1dCBpbiBhbGwgdGhlIGNhc2VzIHdlIGNhcmUgYWJvdXQgd2VcbiAgLy8gYWxyZWFkeSBoYXZlIGFuIGV4aXN0aW5nIG1ldGhvZCB3ZSB3YW50IHRvIGNhbGwsIHNvIHRoZXJlJ3Mgbm8gbmVlZFxuICAvLyB0byBjcmVhdGUgYSBuZXcgZnVuY3Rpb24gb2JqZWN0LiBXZSBjYW4gZXZlbiBnZXQgYXdheSB3aXRoIGFzc3VtaW5nXG4gIC8vIHRoZSBtZXRob2QgdGFrZXMgZXhhY3RseSBvbmUgYXJndW1lbnQsIHNpbmNlIHRoYXQgaGFwcGVucyB0byBiZSB0cnVlXG4gIC8vIGluIGV2ZXJ5IGNhc2UsIHNvIHdlIGRvbid0IGhhdmUgdG8gdG91Y2ggdGhlIGFyZ3VtZW50cyBvYmplY3QuIFRoZVxuICAvLyBvbmx5IGFkZGl0aW9uYWwgYWxsb2NhdGlvbiByZXF1aXJlZCBpcyB0aGUgY29tcGxldGlvbiByZWNvcmQsIHdoaWNoXG4gIC8vIGhhcyBhIHN0YWJsZSBzaGFwZSBhbmQgc28gaG9wZWZ1bGx5IHNob3VsZCBiZSBjaGVhcCB0byBhbGxvY2F0ZS5cbiAgZnVuY3Rpb24gdHJ5Q2F0Y2goZm4sIG9iaiwgYXJnKSB7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiB7IHR5cGU6IFwibm9ybWFsXCIsIGFyZzogZm4uY2FsbChvYmosIGFyZykgfTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIHJldHVybiB7IHR5cGU6IFwidGhyb3dcIiwgYXJnOiBlcnIgfTtcbiAgICB9XG4gIH1cblxuICB2YXIgR2VuU3RhdGVTdXNwZW5kZWRTdGFydCA9IFwic3VzcGVuZGVkU3RhcnRcIjtcbiAgdmFyIEdlblN0YXRlU3VzcGVuZGVkWWllbGQgPSBcInN1c3BlbmRlZFlpZWxkXCI7XG4gIHZhciBHZW5TdGF0ZUV4ZWN1dGluZyA9IFwiZXhlY3V0aW5nXCI7XG4gIHZhciBHZW5TdGF0ZUNvbXBsZXRlZCA9IFwiY29tcGxldGVkXCI7XG5cbiAgLy8gUmV0dXJuaW5nIHRoaXMgb2JqZWN0IGZyb20gdGhlIGlubmVyRm4gaGFzIHRoZSBzYW1lIGVmZmVjdCBhc1xuICAvLyBicmVha2luZyBvdXQgb2YgdGhlIGRpc3BhdGNoIHN3aXRjaCBzdGF0ZW1lbnQuXG4gIHZhciBDb250aW51ZVNlbnRpbmVsID0ge307XG5cbiAgLy8gRHVtbXkgY29uc3RydWN0b3IgZnVuY3Rpb25zIHRoYXQgd2UgdXNlIGFzIHRoZSAuY29uc3RydWN0b3IgYW5kXG4gIC8vIC5jb25zdHJ1Y3Rvci5wcm90b3R5cGUgcHJvcGVydGllcyBmb3IgZnVuY3Rpb25zIHRoYXQgcmV0dXJuIEdlbmVyYXRvclxuICAvLyBvYmplY3RzLiBGb3IgZnVsbCBzcGVjIGNvbXBsaWFuY2UsIHlvdSBtYXkgd2lzaCB0byBjb25maWd1cmUgeW91clxuICAvLyBtaW5pZmllciBub3QgdG8gbWFuZ2xlIHRoZSBuYW1lcyBvZiB0aGVzZSB0d28gZnVuY3Rpb25zLlxuICBmdW5jdGlvbiBHZW5lcmF0b3IoKSB7fVxuICBmdW5jdGlvbiBHZW5lcmF0b3JGdW5jdGlvbigpIHt9XG4gIGZ1bmN0aW9uIEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlKCkge31cblxuICAvLyBUaGlzIGlzIGEgcG9seWZpbGwgZm9yICVJdGVyYXRvclByb3RvdHlwZSUgZm9yIGVudmlyb25tZW50cyB0aGF0XG4gIC8vIGRvbid0IG5hdGl2ZWx5IHN1cHBvcnQgaXQuXG4gIHZhciBJdGVyYXRvclByb3RvdHlwZSA9IHt9O1xuICBJdGVyYXRvclByb3RvdHlwZVtpdGVyYXRvclN5bWJvbF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgdmFyIGdldFByb3RvID0gT2JqZWN0LmdldFByb3RvdHlwZU9mO1xuICB2YXIgTmF0aXZlSXRlcmF0b3JQcm90b3R5cGUgPSBnZXRQcm90byAmJiBnZXRQcm90byhnZXRQcm90byh2YWx1ZXMoW10pKSk7XG4gIGlmIChOYXRpdmVJdGVyYXRvclByb3RvdHlwZSAmJlxuICAgICAgTmF0aXZlSXRlcmF0b3JQcm90b3R5cGUgIT09IE9wICYmXG4gICAgICBoYXNPd24uY2FsbChOYXRpdmVJdGVyYXRvclByb3RvdHlwZSwgaXRlcmF0b3JTeW1ib2wpKSB7XG4gICAgLy8gVGhpcyBlbnZpcm9ubWVudCBoYXMgYSBuYXRpdmUgJUl0ZXJhdG9yUHJvdG90eXBlJTsgdXNlIGl0IGluc3RlYWRcbiAgICAvLyBvZiB0aGUgcG9seWZpbGwuXG4gICAgSXRlcmF0b3JQcm90b3R5cGUgPSBOYXRpdmVJdGVyYXRvclByb3RvdHlwZTtcbiAgfVxuXG4gIHZhciBHcCA9IEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlLnByb3RvdHlwZSA9XG4gICAgR2VuZXJhdG9yLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoSXRlcmF0b3JQcm90b3R5cGUpO1xuICBHZW5lcmF0b3JGdW5jdGlvbi5wcm90b3R5cGUgPSBHcC5jb25zdHJ1Y3RvciA9IEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlO1xuICBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IEdlbmVyYXRvckZ1bmN0aW9uO1xuICBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZVt0b1N0cmluZ1RhZ1N5bWJvbF0gPVxuICAgIEdlbmVyYXRvckZ1bmN0aW9uLmRpc3BsYXlOYW1lID0gXCJHZW5lcmF0b3JGdW5jdGlvblwiO1xuXG4gIC8vIEhlbHBlciBmb3IgZGVmaW5pbmcgdGhlIC5uZXh0LCAudGhyb3csIGFuZCAucmV0dXJuIG1ldGhvZHMgb2YgdGhlXG4gIC8vIEl0ZXJhdG9yIGludGVyZmFjZSBpbiB0ZXJtcyBvZiBhIHNpbmdsZSAuX2ludm9rZSBtZXRob2QuXG4gIGZ1bmN0aW9uIGRlZmluZUl0ZXJhdG9yTWV0aG9kcyhwcm90b3R5cGUpIHtcbiAgICBbXCJuZXh0XCIsIFwidGhyb3dcIiwgXCJyZXR1cm5cIl0uZm9yRWFjaChmdW5jdGlvbihtZXRob2QpIHtcbiAgICAgIHByb3RvdHlwZVttZXRob2RdID0gZnVuY3Rpb24oYXJnKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pbnZva2UobWV0aG9kLCBhcmcpO1xuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuXG4gIHJ1bnRpbWUuaXNHZW5lcmF0b3JGdW5jdGlvbiA9IGZ1bmN0aW9uKGdlbkZ1bikge1xuICAgIHZhciBjdG9yID0gdHlwZW9mIGdlbkZ1biA9PT0gXCJmdW5jdGlvblwiICYmIGdlbkZ1bi5jb25zdHJ1Y3RvcjtcbiAgICByZXR1cm4gY3RvclxuICAgICAgPyBjdG9yID09PSBHZW5lcmF0b3JGdW5jdGlvbiB8fFxuICAgICAgICAvLyBGb3IgdGhlIG5hdGl2ZSBHZW5lcmF0b3JGdW5jdGlvbiBjb25zdHJ1Y3RvciwgdGhlIGJlc3Qgd2UgY2FuXG4gICAgICAgIC8vIGRvIGlzIHRvIGNoZWNrIGl0cyAubmFtZSBwcm9wZXJ0eS5cbiAgICAgICAgKGN0b3IuZGlzcGxheU5hbWUgfHwgY3Rvci5uYW1lKSA9PT0gXCJHZW5lcmF0b3JGdW5jdGlvblwiXG4gICAgICA6IGZhbHNlO1xuICB9O1xuXG4gIHJ1bnRpbWUubWFyayA9IGZ1bmN0aW9uKGdlbkZ1bikge1xuICAgIGlmIChPYmplY3Quc2V0UHJvdG90eXBlT2YpIHtcbiAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZihnZW5GdW4sIEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZ2VuRnVuLl9fcHJvdG9fXyA9IEdlbmVyYXRvckZ1bmN0aW9uUHJvdG90eXBlO1xuICAgICAgaWYgKCEodG9TdHJpbmdUYWdTeW1ib2wgaW4gZ2VuRnVuKSkge1xuICAgICAgICBnZW5GdW5bdG9TdHJpbmdUYWdTeW1ib2xdID0gXCJHZW5lcmF0b3JGdW5jdGlvblwiO1xuICAgICAgfVxuICAgIH1cbiAgICBnZW5GdW4ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShHcCk7XG4gICAgcmV0dXJuIGdlbkZ1bjtcbiAgfTtcblxuICAvLyBXaXRoaW4gdGhlIGJvZHkgb2YgYW55IGFzeW5jIGZ1bmN0aW9uLCBgYXdhaXQgeGAgaXMgdHJhbnNmb3JtZWQgdG9cbiAgLy8gYHlpZWxkIHJlZ2VuZXJhdG9yUnVudGltZS5hd3JhcCh4KWAsIHNvIHRoYXQgdGhlIHJ1bnRpbWUgY2FuIHRlc3RcbiAgLy8gYGhhc093bi5jYWxsKHZhbHVlLCBcIl9fYXdhaXRcIilgIHRvIGRldGVybWluZSBpZiB0aGUgeWllbGRlZCB2YWx1ZSBpc1xuICAvLyBtZWFudCB0byBiZSBhd2FpdGVkLlxuICBydW50aW1lLmF3cmFwID0gZnVuY3Rpb24oYXJnKSB7XG4gICAgcmV0dXJuIHsgX19hd2FpdDogYXJnIH07XG4gIH07XG5cbiAgZnVuY3Rpb24gQXN5bmNJdGVyYXRvcihnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBpbnZva2UobWV0aG9kLCBhcmcsIHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgdmFyIHJlY29yZCA9IHRyeUNhdGNoKGdlbmVyYXRvclttZXRob2RdLCBnZW5lcmF0b3IsIGFyZyk7XG4gICAgICBpZiAocmVjb3JkLnR5cGUgPT09IFwidGhyb3dcIikge1xuICAgICAgICByZWplY3QocmVjb3JkLmFyZyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgcmVzdWx0ID0gcmVjb3JkLmFyZztcbiAgICAgICAgdmFyIHZhbHVlID0gcmVzdWx0LnZhbHVlO1xuICAgICAgICBpZiAodmFsdWUgJiZcbiAgICAgICAgICAgIHR5cGVvZiB2YWx1ZSA9PT0gXCJvYmplY3RcIiAmJlxuICAgICAgICAgICAgaGFzT3duLmNhbGwodmFsdWUsIFwiX19hd2FpdFwiKSkge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodmFsdWUuX19hd2FpdCkudGhlbihmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgICAgaW52b2tlKFwibmV4dFwiLCB2YWx1ZSwgcmVzb2x2ZSwgcmVqZWN0KTtcbiAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgIGludm9rZShcInRocm93XCIsIGVyciwgcmVzb2x2ZSwgcmVqZWN0KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodmFsdWUpLnRoZW4oZnVuY3Rpb24odW53cmFwcGVkKSB7XG4gICAgICAgICAgLy8gV2hlbiBhIHlpZWxkZWQgUHJvbWlzZSBpcyByZXNvbHZlZCwgaXRzIGZpbmFsIHZhbHVlIGJlY29tZXNcbiAgICAgICAgICAvLyB0aGUgLnZhbHVlIG9mIHRoZSBQcm9taXNlPHt2YWx1ZSxkb25lfT4gcmVzdWx0IGZvciB0aGVcbiAgICAgICAgICAvLyBjdXJyZW50IGl0ZXJhdGlvbi5cbiAgICAgICAgICByZXN1bHQudmFsdWUgPSB1bndyYXBwZWQ7XG4gICAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xuICAgICAgICB9LCBmdW5jdGlvbihlcnJvcikge1xuICAgICAgICAgIC8vIElmIGEgcmVqZWN0ZWQgUHJvbWlzZSB3YXMgeWllbGRlZCwgdGhyb3cgdGhlIHJlamVjdGlvbiBiYWNrXG4gICAgICAgICAgLy8gaW50byB0aGUgYXN5bmMgZ2VuZXJhdG9yIGZ1bmN0aW9uIHNvIGl0IGNhbiBiZSBoYW5kbGVkIHRoZXJlLlxuICAgICAgICAgIHJldHVybiBpbnZva2UoXCJ0aHJvd1wiLCBlcnJvciwgcmVzb2x2ZSwgcmVqZWN0KTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdmFyIHByZXZpb3VzUHJvbWlzZTtcblxuICAgIGZ1bmN0aW9uIGVucXVldWUobWV0aG9kLCBhcmcpIHtcbiAgICAgIGZ1bmN0aW9uIGNhbGxJbnZva2VXaXRoTWV0aG9kQW5kQXJnKCkge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgaW52b2tlKG1ldGhvZCwgYXJnLCByZXNvbHZlLCByZWplY3QpO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHByZXZpb3VzUHJvbWlzZSA9XG4gICAgICAgIC8vIElmIGVucXVldWUgaGFzIGJlZW4gY2FsbGVkIGJlZm9yZSwgdGhlbiB3ZSB3YW50IHRvIHdhaXQgdW50aWxcbiAgICAgICAgLy8gYWxsIHByZXZpb3VzIFByb21pc2VzIGhhdmUgYmVlbiByZXNvbHZlZCBiZWZvcmUgY2FsbGluZyBpbnZva2UsXG4gICAgICAgIC8vIHNvIHRoYXQgcmVzdWx0cyBhcmUgYWx3YXlzIGRlbGl2ZXJlZCBpbiB0aGUgY29ycmVjdCBvcmRlci4gSWZcbiAgICAgICAgLy8gZW5xdWV1ZSBoYXMgbm90IGJlZW4gY2FsbGVkIGJlZm9yZSwgdGhlbiBpdCBpcyBpbXBvcnRhbnQgdG9cbiAgICAgICAgLy8gY2FsbCBpbnZva2UgaW1tZWRpYXRlbHksIHdpdGhvdXQgd2FpdGluZyBvbiBhIGNhbGxiYWNrIHRvIGZpcmUsXG4gICAgICAgIC8vIHNvIHRoYXQgdGhlIGFzeW5jIGdlbmVyYXRvciBmdW5jdGlvbiBoYXMgdGhlIG9wcG9ydHVuaXR5IHRvIGRvXG4gICAgICAgIC8vIGFueSBuZWNlc3Nhcnkgc2V0dXAgaW4gYSBwcmVkaWN0YWJsZSB3YXkuIFRoaXMgcHJlZGljdGFiaWxpdHlcbiAgICAgICAgLy8gaXMgd2h5IHRoZSBQcm9taXNlIGNvbnN0cnVjdG9yIHN5bmNocm9ub3VzbHkgaW52b2tlcyBpdHNcbiAgICAgICAgLy8gZXhlY3V0b3IgY2FsbGJhY2ssIGFuZCB3aHkgYXN5bmMgZnVuY3Rpb25zIHN5bmNocm9ub3VzbHlcbiAgICAgICAgLy8gZXhlY3V0ZSBjb2RlIGJlZm9yZSB0aGUgZmlyc3QgYXdhaXQuIFNpbmNlIHdlIGltcGxlbWVudCBzaW1wbGVcbiAgICAgICAgLy8gYXN5bmMgZnVuY3Rpb25zIGluIHRlcm1zIG9mIGFzeW5jIGdlbmVyYXRvcnMsIGl0IGlzIGVzcGVjaWFsbHlcbiAgICAgICAgLy8gaW1wb3J0YW50IHRvIGdldCB0aGlzIHJpZ2h0LCBldmVuIHRob3VnaCBpdCByZXF1aXJlcyBjYXJlLlxuICAgICAgICBwcmV2aW91c1Byb21pc2UgPyBwcmV2aW91c1Byb21pc2UudGhlbihcbiAgICAgICAgICBjYWxsSW52b2tlV2l0aE1ldGhvZEFuZEFyZyxcbiAgICAgICAgICAvLyBBdm9pZCBwcm9wYWdhdGluZyBmYWlsdXJlcyB0byBQcm9taXNlcyByZXR1cm5lZCBieSBsYXRlclxuICAgICAgICAgIC8vIGludm9jYXRpb25zIG9mIHRoZSBpdGVyYXRvci5cbiAgICAgICAgICBjYWxsSW52b2tlV2l0aE1ldGhvZEFuZEFyZ1xuICAgICAgICApIDogY2FsbEludm9rZVdpdGhNZXRob2RBbmRBcmcoKTtcbiAgICB9XG5cbiAgICAvLyBEZWZpbmUgdGhlIHVuaWZpZWQgaGVscGVyIG1ldGhvZCB0aGF0IGlzIHVzZWQgdG8gaW1wbGVtZW50IC5uZXh0LFxuICAgIC8vIC50aHJvdywgYW5kIC5yZXR1cm4gKHNlZSBkZWZpbmVJdGVyYXRvck1ldGhvZHMpLlxuICAgIHRoaXMuX2ludm9rZSA9IGVucXVldWU7XG4gIH1cblxuICBkZWZpbmVJdGVyYXRvck1ldGhvZHMoQXN5bmNJdGVyYXRvci5wcm90b3R5cGUpO1xuICBBc3luY0l0ZXJhdG9yLnByb3RvdHlwZVthc3luY0l0ZXJhdG9yU3ltYm9sXSA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcbiAgcnVudGltZS5Bc3luY0l0ZXJhdG9yID0gQXN5bmNJdGVyYXRvcjtcblxuICAvLyBOb3RlIHRoYXQgc2ltcGxlIGFzeW5jIGZ1bmN0aW9ucyBhcmUgaW1wbGVtZW50ZWQgb24gdG9wIG9mXG4gIC8vIEFzeW5jSXRlcmF0b3Igb2JqZWN0czsgdGhleSBqdXN0IHJldHVybiBhIFByb21pc2UgZm9yIHRoZSB2YWx1ZSBvZlxuICAvLyB0aGUgZmluYWwgcmVzdWx0IHByb2R1Y2VkIGJ5IHRoZSBpdGVyYXRvci5cbiAgcnVudGltZS5hc3luYyA9IGZ1bmN0aW9uKGlubmVyRm4sIG91dGVyRm4sIHNlbGYsIHRyeUxvY3NMaXN0KSB7XG4gICAgdmFyIGl0ZXIgPSBuZXcgQXN5bmNJdGVyYXRvcihcbiAgICAgIHdyYXAoaW5uZXJGbiwgb3V0ZXJGbiwgc2VsZiwgdHJ5TG9jc0xpc3QpXG4gICAgKTtcblxuICAgIHJldHVybiBydW50aW1lLmlzR2VuZXJhdG9yRnVuY3Rpb24ob3V0ZXJGbilcbiAgICAgID8gaXRlciAvLyBJZiBvdXRlckZuIGlzIGEgZ2VuZXJhdG9yLCByZXR1cm4gdGhlIGZ1bGwgaXRlcmF0b3IuXG4gICAgICA6IGl0ZXIubmV4dCgpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgcmV0dXJuIHJlc3VsdC5kb25lID8gcmVzdWx0LnZhbHVlIDogaXRlci5uZXh0KCk7XG4gICAgICAgIH0pO1xuICB9O1xuXG4gIGZ1bmN0aW9uIG1ha2VJbnZva2VNZXRob2QoaW5uZXJGbiwgc2VsZiwgY29udGV4dCkge1xuICAgIHZhciBzdGF0ZSA9IEdlblN0YXRlU3VzcGVuZGVkU3RhcnQ7XG5cbiAgICByZXR1cm4gZnVuY3Rpb24gaW52b2tlKG1ldGhvZCwgYXJnKSB7XG4gICAgICBpZiAoc3RhdGUgPT09IEdlblN0YXRlRXhlY3V0aW5nKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IHJ1bm5pbmdcIik7XG4gICAgICB9XG5cbiAgICAgIGlmIChzdGF0ZSA9PT0gR2VuU3RhdGVDb21wbGV0ZWQpIHtcbiAgICAgICAgaWYgKG1ldGhvZCA9PT0gXCJ0aHJvd1wiKSB7XG4gICAgICAgICAgdGhyb3cgYXJnO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQmUgZm9yZ2l2aW5nLCBwZXIgMjUuMy4zLjMuMyBvZiB0aGUgc3BlYzpcbiAgICAgICAgLy8gaHR0cHM6Ly9wZW9wbGUubW96aWxsYS5vcmcvfmpvcmVuZG9yZmYvZXM2LWRyYWZ0Lmh0bWwjc2VjLWdlbmVyYXRvcnJlc3VtZVxuICAgICAgICByZXR1cm4gZG9uZVJlc3VsdCgpO1xuICAgICAgfVxuXG4gICAgICBjb250ZXh0Lm1ldGhvZCA9IG1ldGhvZDtcbiAgICAgIGNvbnRleHQuYXJnID0gYXJnO1xuXG4gICAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgICB2YXIgZGVsZWdhdGUgPSBjb250ZXh0LmRlbGVnYXRlO1xuICAgICAgICBpZiAoZGVsZWdhdGUpIHtcbiAgICAgICAgICB2YXIgZGVsZWdhdGVSZXN1bHQgPSBtYXliZUludm9rZURlbGVnYXRlKGRlbGVnYXRlLCBjb250ZXh0KTtcbiAgICAgICAgICBpZiAoZGVsZWdhdGVSZXN1bHQpIHtcbiAgICAgICAgICAgIGlmIChkZWxlZ2F0ZVJlc3VsdCA9PT0gQ29udGludWVTZW50aW5lbCkgY29udGludWU7XG4gICAgICAgICAgICByZXR1cm4gZGVsZWdhdGVSZXN1bHQ7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGNvbnRleHQubWV0aG9kID09PSBcIm5leHRcIikge1xuICAgICAgICAgIC8vIFNldHRpbmcgY29udGV4dC5fc2VudCBmb3IgbGVnYWN5IHN1cHBvcnQgb2YgQmFiZWwnc1xuICAgICAgICAgIC8vIGZ1bmN0aW9uLnNlbnQgaW1wbGVtZW50YXRpb24uXG4gICAgICAgICAgY29udGV4dC5zZW50ID0gY29udGV4dC5fc2VudCA9IGNvbnRleHQuYXJnO1xuXG4gICAgICAgIH0gZWxzZSBpZiAoY29udGV4dC5tZXRob2QgPT09IFwidGhyb3dcIikge1xuICAgICAgICAgIGlmIChzdGF0ZSA9PT0gR2VuU3RhdGVTdXNwZW5kZWRTdGFydCkge1xuICAgICAgICAgICAgc3RhdGUgPSBHZW5TdGF0ZUNvbXBsZXRlZDtcbiAgICAgICAgICAgIHRocm93IGNvbnRleHQuYXJnO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNvbnRleHQuZGlzcGF0Y2hFeGNlcHRpb24oY29udGV4dC5hcmcpO1xuXG4gICAgICAgIH0gZWxzZSBpZiAoY29udGV4dC5tZXRob2QgPT09IFwicmV0dXJuXCIpIHtcbiAgICAgICAgICBjb250ZXh0LmFicnVwdChcInJldHVyblwiLCBjb250ZXh0LmFyZyk7XG4gICAgICAgIH1cblxuICAgICAgICBzdGF0ZSA9IEdlblN0YXRlRXhlY3V0aW5nO1xuXG4gICAgICAgIHZhciByZWNvcmQgPSB0cnlDYXRjaChpbm5lckZuLCBzZWxmLCBjb250ZXh0KTtcbiAgICAgICAgaWYgKHJlY29yZC50eXBlID09PSBcIm5vcm1hbFwiKSB7XG4gICAgICAgICAgLy8gSWYgYW4gZXhjZXB0aW9uIGlzIHRocm93biBmcm9tIGlubmVyRm4sIHdlIGxlYXZlIHN0YXRlID09PVxuICAgICAgICAgIC8vIEdlblN0YXRlRXhlY3V0aW5nIGFuZCBsb29wIGJhY2sgZm9yIGFub3RoZXIgaW52b2NhdGlvbi5cbiAgICAgICAgICBzdGF0ZSA9IGNvbnRleHQuZG9uZVxuICAgICAgICAgICAgPyBHZW5TdGF0ZUNvbXBsZXRlZFxuICAgICAgICAgICAgOiBHZW5TdGF0ZVN1c3BlbmRlZFlpZWxkO1xuXG4gICAgICAgICAgaWYgKHJlY29yZC5hcmcgPT09IENvbnRpbnVlU2VudGluZWwpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB2YWx1ZTogcmVjb3JkLmFyZyxcbiAgICAgICAgICAgIGRvbmU6IGNvbnRleHQuZG9uZVxuICAgICAgICAgIH07XG5cbiAgICAgICAgfSBlbHNlIGlmIChyZWNvcmQudHlwZSA9PT0gXCJ0aHJvd1wiKSB7XG4gICAgICAgICAgc3RhdGUgPSBHZW5TdGF0ZUNvbXBsZXRlZDtcbiAgICAgICAgICAvLyBEaXNwYXRjaCB0aGUgZXhjZXB0aW9uIGJ5IGxvb3BpbmcgYmFjayBhcm91bmQgdG8gdGhlXG4gICAgICAgICAgLy8gY29udGV4dC5kaXNwYXRjaEV4Y2VwdGlvbihjb250ZXh0LmFyZykgY2FsbCBhYm92ZS5cbiAgICAgICAgICBjb250ZXh0Lm1ldGhvZCA9IFwidGhyb3dcIjtcbiAgICAgICAgICBjb250ZXh0LmFyZyA9IHJlY29yZC5hcmc7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICB9XG5cbiAgLy8gQ2FsbCBkZWxlZ2F0ZS5pdGVyYXRvcltjb250ZXh0Lm1ldGhvZF0oY29udGV4dC5hcmcpIGFuZCBoYW5kbGUgdGhlXG4gIC8vIHJlc3VsdCwgZWl0aGVyIGJ5IHJldHVybmluZyBhIHsgdmFsdWUsIGRvbmUgfSByZXN1bHQgZnJvbSB0aGVcbiAgLy8gZGVsZWdhdGUgaXRlcmF0b3IsIG9yIGJ5IG1vZGlmeWluZyBjb250ZXh0Lm1ldGhvZCBhbmQgY29udGV4dC5hcmcsXG4gIC8vIHNldHRpbmcgY29udGV4dC5kZWxlZ2F0ZSB0byBudWxsLCBhbmQgcmV0dXJuaW5nIHRoZSBDb250aW51ZVNlbnRpbmVsLlxuICBmdW5jdGlvbiBtYXliZUludm9rZURlbGVnYXRlKGRlbGVnYXRlLCBjb250ZXh0KSB7XG4gICAgdmFyIG1ldGhvZCA9IGRlbGVnYXRlLml0ZXJhdG9yW2NvbnRleHQubWV0aG9kXTtcbiAgICBpZiAobWV0aG9kID09PSB1bmRlZmluZWQpIHtcbiAgICAgIC8vIEEgLnRocm93IG9yIC5yZXR1cm4gd2hlbiB0aGUgZGVsZWdhdGUgaXRlcmF0b3IgaGFzIG5vIC50aHJvd1xuICAgICAgLy8gbWV0aG9kIGFsd2F5cyB0ZXJtaW5hdGVzIHRoZSB5aWVsZCogbG9vcC5cbiAgICAgIGNvbnRleHQuZGVsZWdhdGUgPSBudWxsO1xuXG4gICAgICBpZiAoY29udGV4dC5tZXRob2QgPT09IFwidGhyb3dcIikge1xuICAgICAgICBpZiAoZGVsZWdhdGUuaXRlcmF0b3IucmV0dXJuKSB7XG4gICAgICAgICAgLy8gSWYgdGhlIGRlbGVnYXRlIGl0ZXJhdG9yIGhhcyBhIHJldHVybiBtZXRob2QsIGdpdmUgaXQgYVxuICAgICAgICAgIC8vIGNoYW5jZSB0byBjbGVhbiB1cC5cbiAgICAgICAgICBjb250ZXh0Lm1ldGhvZCA9IFwicmV0dXJuXCI7XG4gICAgICAgICAgY29udGV4dC5hcmcgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgbWF5YmVJbnZva2VEZWxlZ2F0ZShkZWxlZ2F0ZSwgY29udGV4dCk7XG5cbiAgICAgICAgICBpZiAoY29udGV4dC5tZXRob2QgPT09IFwidGhyb3dcIikge1xuICAgICAgICAgICAgLy8gSWYgbWF5YmVJbnZva2VEZWxlZ2F0ZShjb250ZXh0KSBjaGFuZ2VkIGNvbnRleHQubWV0aG9kIGZyb21cbiAgICAgICAgICAgIC8vIFwicmV0dXJuXCIgdG8gXCJ0aHJvd1wiLCBsZXQgdGhhdCBvdmVycmlkZSB0aGUgVHlwZUVycm9yIGJlbG93LlxuICAgICAgICAgICAgcmV0dXJuIENvbnRpbnVlU2VudGluZWw7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29udGV4dC5tZXRob2QgPSBcInRocm93XCI7XG4gICAgICAgIGNvbnRleHQuYXJnID0gbmV3IFR5cGVFcnJvcihcbiAgICAgICAgICBcIlRoZSBpdGVyYXRvciBkb2VzIG5vdCBwcm92aWRlIGEgJ3Rocm93JyBtZXRob2RcIik7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBDb250aW51ZVNlbnRpbmVsO1xuICAgIH1cblxuICAgIHZhciByZWNvcmQgPSB0cnlDYXRjaChtZXRob2QsIGRlbGVnYXRlLml0ZXJhdG9yLCBjb250ZXh0LmFyZyk7XG5cbiAgICBpZiAocmVjb3JkLnR5cGUgPT09IFwidGhyb3dcIikge1xuICAgICAgY29udGV4dC5tZXRob2QgPSBcInRocm93XCI7XG4gICAgICBjb250ZXh0LmFyZyA9IHJlY29yZC5hcmc7XG4gICAgICBjb250ZXh0LmRlbGVnYXRlID0gbnVsbDtcbiAgICAgIHJldHVybiBDb250aW51ZVNlbnRpbmVsO1xuICAgIH1cblxuICAgIHZhciBpbmZvID0gcmVjb3JkLmFyZztcblxuICAgIGlmICghIGluZm8pIHtcbiAgICAgIGNvbnRleHQubWV0aG9kID0gXCJ0aHJvd1wiO1xuICAgICAgY29udGV4dC5hcmcgPSBuZXcgVHlwZUVycm9yKFwiaXRlcmF0b3IgcmVzdWx0IGlzIG5vdCBhbiBvYmplY3RcIik7XG4gICAgICBjb250ZXh0LmRlbGVnYXRlID0gbnVsbDtcbiAgICAgIHJldHVybiBDb250aW51ZVNlbnRpbmVsO1xuICAgIH1cblxuICAgIGlmIChpbmZvLmRvbmUpIHtcbiAgICAgIC8vIEFzc2lnbiB0aGUgcmVzdWx0IG9mIHRoZSBmaW5pc2hlZCBkZWxlZ2F0ZSB0byB0aGUgdGVtcG9yYXJ5XG4gICAgICAvLyB2YXJpYWJsZSBzcGVjaWZpZWQgYnkgZGVsZWdhdGUucmVzdWx0TmFtZSAoc2VlIGRlbGVnYXRlWWllbGQpLlxuICAgICAgY29udGV4dFtkZWxlZ2F0ZS5yZXN1bHROYW1lXSA9IGluZm8udmFsdWU7XG5cbiAgICAgIC8vIFJlc3VtZSBleGVjdXRpb24gYXQgdGhlIGRlc2lyZWQgbG9jYXRpb24gKHNlZSBkZWxlZ2F0ZVlpZWxkKS5cbiAgICAgIGNvbnRleHQubmV4dCA9IGRlbGVnYXRlLm5leHRMb2M7XG5cbiAgICAgIC8vIElmIGNvbnRleHQubWV0aG9kIHdhcyBcInRocm93XCIgYnV0IHRoZSBkZWxlZ2F0ZSBoYW5kbGVkIHRoZVxuICAgICAgLy8gZXhjZXB0aW9uLCBsZXQgdGhlIG91dGVyIGdlbmVyYXRvciBwcm9jZWVkIG5vcm1hbGx5LiBJZlxuICAgICAgLy8gY29udGV4dC5tZXRob2Qgd2FzIFwibmV4dFwiLCBmb3JnZXQgY29udGV4dC5hcmcgc2luY2UgaXQgaGFzIGJlZW5cbiAgICAgIC8vIFwiY29uc3VtZWRcIiBieSB0aGUgZGVsZWdhdGUgaXRlcmF0b3IuIElmIGNvbnRleHQubWV0aG9kIHdhc1xuICAgICAgLy8gXCJyZXR1cm5cIiwgYWxsb3cgdGhlIG9yaWdpbmFsIC5yZXR1cm4gY2FsbCB0byBjb250aW51ZSBpbiB0aGVcbiAgICAgIC8vIG91dGVyIGdlbmVyYXRvci5cbiAgICAgIGlmIChjb250ZXh0Lm1ldGhvZCAhPT0gXCJyZXR1cm5cIikge1xuICAgICAgICBjb250ZXh0Lm1ldGhvZCA9IFwibmV4dFwiO1xuICAgICAgICBjb250ZXh0LmFyZyA9IHVuZGVmaW5lZDtcbiAgICAgIH1cblxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBSZS15aWVsZCB0aGUgcmVzdWx0IHJldHVybmVkIGJ5IHRoZSBkZWxlZ2F0ZSBtZXRob2QuXG4gICAgICByZXR1cm4gaW5mbztcbiAgICB9XG5cbiAgICAvLyBUaGUgZGVsZWdhdGUgaXRlcmF0b3IgaXMgZmluaXNoZWQsIHNvIGZvcmdldCBpdCBhbmQgY29udGludWUgd2l0aFxuICAgIC8vIHRoZSBvdXRlciBnZW5lcmF0b3IuXG4gICAgY29udGV4dC5kZWxlZ2F0ZSA9IG51bGw7XG4gICAgcmV0dXJuIENvbnRpbnVlU2VudGluZWw7XG4gIH1cblxuICAvLyBEZWZpbmUgR2VuZXJhdG9yLnByb3RvdHlwZS57bmV4dCx0aHJvdyxyZXR1cm59IGluIHRlcm1zIG9mIHRoZVxuICAvLyB1bmlmaWVkIC5faW52b2tlIGhlbHBlciBtZXRob2QuXG4gIGRlZmluZUl0ZXJhdG9yTWV0aG9kcyhHcCk7XG5cbiAgR3BbdG9TdHJpbmdUYWdTeW1ib2xdID0gXCJHZW5lcmF0b3JcIjtcblxuICAvLyBBIEdlbmVyYXRvciBzaG91bGQgYWx3YXlzIHJldHVybiBpdHNlbGYgYXMgdGhlIGl0ZXJhdG9yIG9iamVjdCB3aGVuIHRoZVxuICAvLyBAQGl0ZXJhdG9yIGZ1bmN0aW9uIGlzIGNhbGxlZCBvbiBpdC4gU29tZSBicm93c2VycycgaW1wbGVtZW50YXRpb25zIG9mIHRoZVxuICAvLyBpdGVyYXRvciBwcm90b3R5cGUgY2hhaW4gaW5jb3JyZWN0bHkgaW1wbGVtZW50IHRoaXMsIGNhdXNpbmcgdGhlIEdlbmVyYXRvclxuICAvLyBvYmplY3QgdG8gbm90IGJlIHJldHVybmVkIGZyb20gdGhpcyBjYWxsLiBUaGlzIGVuc3VyZXMgdGhhdCBkb2Vzbid0IGhhcHBlbi5cbiAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9mYWNlYm9vay9yZWdlbmVyYXRvci9pc3N1ZXMvMjc0IGZvciBtb3JlIGRldGFpbHMuXG4gIEdwW2l0ZXJhdG9yU3ltYm9sXSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIEdwLnRvU3RyaW5nID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIFwiW29iamVjdCBHZW5lcmF0b3JdXCI7XG4gIH07XG5cbiAgZnVuY3Rpb24gcHVzaFRyeUVudHJ5KGxvY3MpIHtcbiAgICB2YXIgZW50cnkgPSB7IHRyeUxvYzogbG9jc1swXSB9O1xuXG4gICAgaWYgKDEgaW4gbG9jcykge1xuICAgICAgZW50cnkuY2F0Y2hMb2MgPSBsb2NzWzFdO1xuICAgIH1cblxuICAgIGlmICgyIGluIGxvY3MpIHtcbiAgICAgIGVudHJ5LmZpbmFsbHlMb2MgPSBsb2NzWzJdO1xuICAgICAgZW50cnkuYWZ0ZXJMb2MgPSBsb2NzWzNdO1xuICAgIH1cblxuICAgIHRoaXMudHJ5RW50cmllcy5wdXNoKGVudHJ5KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJlc2V0VHJ5RW50cnkoZW50cnkpIHtcbiAgICB2YXIgcmVjb3JkID0gZW50cnkuY29tcGxldGlvbiB8fCB7fTtcbiAgICByZWNvcmQudHlwZSA9IFwibm9ybWFsXCI7XG4gICAgZGVsZXRlIHJlY29yZC5hcmc7XG4gICAgZW50cnkuY29tcGxldGlvbiA9IHJlY29yZDtcbiAgfVxuXG4gIGZ1bmN0aW9uIENvbnRleHQodHJ5TG9jc0xpc3QpIHtcbiAgICAvLyBUaGUgcm9vdCBlbnRyeSBvYmplY3QgKGVmZmVjdGl2ZWx5IGEgdHJ5IHN0YXRlbWVudCB3aXRob3V0IGEgY2F0Y2hcbiAgICAvLyBvciBhIGZpbmFsbHkgYmxvY2spIGdpdmVzIHVzIGEgcGxhY2UgdG8gc3RvcmUgdmFsdWVzIHRocm93biBmcm9tXG4gICAgLy8gbG9jYXRpb25zIHdoZXJlIHRoZXJlIGlzIG5vIGVuY2xvc2luZyB0cnkgc3RhdGVtZW50LlxuICAgIHRoaXMudHJ5RW50cmllcyA9IFt7IHRyeUxvYzogXCJyb290XCIgfV07XG4gICAgdHJ5TG9jc0xpc3QuZm9yRWFjaChwdXNoVHJ5RW50cnksIHRoaXMpO1xuICAgIHRoaXMucmVzZXQodHJ1ZSk7XG4gIH1cblxuICBydW50aW1lLmtleXMgPSBmdW5jdGlvbihvYmplY3QpIHtcbiAgICB2YXIga2V5cyA9IFtdO1xuICAgIGZvciAodmFyIGtleSBpbiBvYmplY3QpIHtcbiAgICAgIGtleXMucHVzaChrZXkpO1xuICAgIH1cbiAgICBrZXlzLnJldmVyc2UoKTtcblxuICAgIC8vIFJhdGhlciB0aGFuIHJldHVybmluZyBhbiBvYmplY3Qgd2l0aCBhIG5leHQgbWV0aG9kLCB3ZSBrZWVwXG4gICAgLy8gdGhpbmdzIHNpbXBsZSBhbmQgcmV0dXJuIHRoZSBuZXh0IGZ1bmN0aW9uIGl0c2VsZi5cbiAgICByZXR1cm4gZnVuY3Rpb24gbmV4dCgpIHtcbiAgICAgIHdoaWxlIChrZXlzLmxlbmd0aCkge1xuICAgICAgICB2YXIga2V5ID0ga2V5cy5wb3AoKTtcbiAgICAgICAgaWYgKGtleSBpbiBvYmplY3QpIHtcbiAgICAgICAgICBuZXh0LnZhbHVlID0ga2V5O1xuICAgICAgICAgIG5leHQuZG9uZSA9IGZhbHNlO1xuICAgICAgICAgIHJldHVybiBuZXh0O1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIFRvIGF2b2lkIGNyZWF0aW5nIGFuIGFkZGl0aW9uYWwgb2JqZWN0LCB3ZSBqdXN0IGhhbmcgdGhlIC52YWx1ZVxuICAgICAgLy8gYW5kIC5kb25lIHByb3BlcnRpZXMgb2ZmIHRoZSBuZXh0IGZ1bmN0aW9uIG9iamVjdCBpdHNlbGYuIFRoaXNcbiAgICAgIC8vIGFsc28gZW5zdXJlcyB0aGF0IHRoZSBtaW5pZmllciB3aWxsIG5vdCBhbm9ueW1pemUgdGhlIGZ1bmN0aW9uLlxuICAgICAgbmV4dC5kb25lID0gdHJ1ZTtcbiAgICAgIHJldHVybiBuZXh0O1xuICAgIH07XG4gIH07XG5cbiAgZnVuY3Rpb24gdmFsdWVzKGl0ZXJhYmxlKSB7XG4gICAgaWYgKGl0ZXJhYmxlKSB7XG4gICAgICB2YXIgaXRlcmF0b3JNZXRob2QgPSBpdGVyYWJsZVtpdGVyYXRvclN5bWJvbF07XG4gICAgICBpZiAoaXRlcmF0b3JNZXRob2QpIHtcbiAgICAgICAgcmV0dXJuIGl0ZXJhdG9yTWV0aG9kLmNhbGwoaXRlcmFibGUpO1xuICAgICAgfVxuXG4gICAgICBpZiAodHlwZW9mIGl0ZXJhYmxlLm5leHQgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICByZXR1cm4gaXRlcmFibGU7XG4gICAgICB9XG5cbiAgICAgIGlmICghaXNOYU4oaXRlcmFibGUubGVuZ3RoKSkge1xuICAgICAgICB2YXIgaSA9IC0xLCBuZXh0ID0gZnVuY3Rpb24gbmV4dCgpIHtcbiAgICAgICAgICB3aGlsZSAoKytpIDwgaXRlcmFibGUubGVuZ3RoKSB7XG4gICAgICAgICAgICBpZiAoaGFzT3duLmNhbGwoaXRlcmFibGUsIGkpKSB7XG4gICAgICAgICAgICAgIG5leHQudmFsdWUgPSBpdGVyYWJsZVtpXTtcbiAgICAgICAgICAgICAgbmV4dC5kb25lID0gZmFsc2U7XG4gICAgICAgICAgICAgIHJldHVybiBuZXh0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIG5leHQudmFsdWUgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgbmV4dC5kb25lID0gdHJ1ZTtcblxuICAgICAgICAgIHJldHVybiBuZXh0O1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBuZXh0Lm5leHQgPSBuZXh0O1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFJldHVybiBhbiBpdGVyYXRvciB3aXRoIG5vIHZhbHVlcy5cbiAgICByZXR1cm4geyBuZXh0OiBkb25lUmVzdWx0IH07XG4gIH1cbiAgcnVudGltZS52YWx1ZXMgPSB2YWx1ZXM7XG5cbiAgZnVuY3Rpb24gZG9uZVJlc3VsdCgpIHtcbiAgICByZXR1cm4geyB2YWx1ZTogdW5kZWZpbmVkLCBkb25lOiB0cnVlIH07XG4gIH1cblxuICBDb250ZXh0LnByb3RvdHlwZSA9IHtcbiAgICBjb25zdHJ1Y3RvcjogQ29udGV4dCxcblxuICAgIHJlc2V0OiBmdW5jdGlvbihza2lwVGVtcFJlc2V0KSB7XG4gICAgICB0aGlzLnByZXYgPSAwO1xuICAgICAgdGhpcy5uZXh0ID0gMDtcbiAgICAgIC8vIFJlc2V0dGluZyBjb250ZXh0Ll9zZW50IGZvciBsZWdhY3kgc3VwcG9ydCBvZiBCYWJlbCdzXG4gICAgICAvLyBmdW5jdGlvbi5zZW50IGltcGxlbWVudGF0aW9uLlxuICAgICAgdGhpcy5zZW50ID0gdGhpcy5fc2VudCA9IHVuZGVmaW5lZDtcbiAgICAgIHRoaXMuZG9uZSA9IGZhbHNlO1xuICAgICAgdGhpcy5kZWxlZ2F0ZSA9IG51bGw7XG5cbiAgICAgIHRoaXMubWV0aG9kID0gXCJuZXh0XCI7XG4gICAgICB0aGlzLmFyZyA9IHVuZGVmaW5lZDtcblxuICAgICAgdGhpcy50cnlFbnRyaWVzLmZvckVhY2gocmVzZXRUcnlFbnRyeSk7XG5cbiAgICAgIGlmICghc2tpcFRlbXBSZXNldCkge1xuICAgICAgICBmb3IgKHZhciBuYW1lIGluIHRoaXMpIHtcbiAgICAgICAgICAvLyBOb3Qgc3VyZSBhYm91dCB0aGUgb3B0aW1hbCBvcmRlciBvZiB0aGVzZSBjb25kaXRpb25zOlxuICAgICAgICAgIGlmIChuYW1lLmNoYXJBdCgwKSA9PT0gXCJ0XCIgJiZcbiAgICAgICAgICAgICAgaGFzT3duLmNhbGwodGhpcywgbmFtZSkgJiZcbiAgICAgICAgICAgICAgIWlzTmFOKCtuYW1lLnNsaWNlKDEpKSkge1xuICAgICAgICAgICAgdGhpc1tuYW1lXSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuXG4gICAgc3RvcDogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLmRvbmUgPSB0cnVlO1xuXG4gICAgICB2YXIgcm9vdEVudHJ5ID0gdGhpcy50cnlFbnRyaWVzWzBdO1xuICAgICAgdmFyIHJvb3RSZWNvcmQgPSByb290RW50cnkuY29tcGxldGlvbjtcbiAgICAgIGlmIChyb290UmVjb3JkLnR5cGUgPT09IFwidGhyb3dcIikge1xuICAgICAgICB0aHJvdyByb290UmVjb3JkLmFyZztcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMucnZhbDtcbiAgICB9LFxuXG4gICAgZGlzcGF0Y2hFeGNlcHRpb246IGZ1bmN0aW9uKGV4Y2VwdGlvbikge1xuICAgICAgaWYgKHRoaXMuZG9uZSkge1xuICAgICAgICB0aHJvdyBleGNlcHRpb247XG4gICAgICB9XG5cbiAgICAgIHZhciBjb250ZXh0ID0gdGhpcztcbiAgICAgIGZ1bmN0aW9uIGhhbmRsZShsb2MsIGNhdWdodCkge1xuICAgICAgICByZWNvcmQudHlwZSA9IFwidGhyb3dcIjtcbiAgICAgICAgcmVjb3JkLmFyZyA9IGV4Y2VwdGlvbjtcbiAgICAgICAgY29udGV4dC5uZXh0ID0gbG9jO1xuXG4gICAgICAgIGlmIChjYXVnaHQpIHtcbiAgICAgICAgICAvLyBJZiB0aGUgZGlzcGF0Y2hlZCBleGNlcHRpb24gd2FzIGNhdWdodCBieSBhIGNhdGNoIGJsb2NrLFxuICAgICAgICAgIC8vIHRoZW4gbGV0IHRoYXQgY2F0Y2ggYmxvY2sgaGFuZGxlIHRoZSBleGNlcHRpb24gbm9ybWFsbHkuXG4gICAgICAgICAgY29udGV4dC5tZXRob2QgPSBcIm5leHRcIjtcbiAgICAgICAgICBjb250ZXh0LmFyZyA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAhISBjYXVnaHQ7XG4gICAgICB9XG5cbiAgICAgIGZvciAodmFyIGkgPSB0aGlzLnRyeUVudHJpZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyAtLWkpIHtcbiAgICAgICAgdmFyIGVudHJ5ID0gdGhpcy50cnlFbnRyaWVzW2ldO1xuICAgICAgICB2YXIgcmVjb3JkID0gZW50cnkuY29tcGxldGlvbjtcblxuICAgICAgICBpZiAoZW50cnkudHJ5TG9jID09PSBcInJvb3RcIikge1xuICAgICAgICAgIC8vIEV4Y2VwdGlvbiB0aHJvd24gb3V0c2lkZSBvZiBhbnkgdHJ5IGJsb2NrIHRoYXQgY291bGQgaGFuZGxlXG4gICAgICAgICAgLy8gaXQsIHNvIHNldCB0aGUgY29tcGxldGlvbiB2YWx1ZSBvZiB0aGUgZW50aXJlIGZ1bmN0aW9uIHRvXG4gICAgICAgICAgLy8gdGhyb3cgdGhlIGV4Y2VwdGlvbi5cbiAgICAgICAgICByZXR1cm4gaGFuZGxlKFwiZW5kXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGVudHJ5LnRyeUxvYyA8PSB0aGlzLnByZXYpIHtcbiAgICAgICAgICB2YXIgaGFzQ2F0Y2ggPSBoYXNPd24uY2FsbChlbnRyeSwgXCJjYXRjaExvY1wiKTtcbiAgICAgICAgICB2YXIgaGFzRmluYWxseSA9IGhhc093bi5jYWxsKGVudHJ5LCBcImZpbmFsbHlMb2NcIik7XG5cbiAgICAgICAgICBpZiAoaGFzQ2F0Y2ggJiYgaGFzRmluYWxseSkge1xuICAgICAgICAgICAgaWYgKHRoaXMucHJldiA8IGVudHJ5LmNhdGNoTG9jKSB7XG4gICAgICAgICAgICAgIHJldHVybiBoYW5kbGUoZW50cnkuY2F0Y2hMb2MsIHRydWUpO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnByZXYgPCBlbnRyeS5maW5hbGx5TG9jKSB7XG4gICAgICAgICAgICAgIHJldHVybiBoYW5kbGUoZW50cnkuZmluYWxseUxvYyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICB9IGVsc2UgaWYgKGhhc0NhdGNoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wcmV2IDwgZW50cnkuY2F0Y2hMb2MpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZShlbnRyeS5jYXRjaExvYywgdHJ1ZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICB9IGVsc2UgaWYgKGhhc0ZpbmFsbHkpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnByZXYgPCBlbnRyeS5maW5hbGx5TG9jKSB7XG4gICAgICAgICAgICAgIHJldHVybiBoYW5kbGUoZW50cnkuZmluYWxseUxvYyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwidHJ5IHN0YXRlbWVudCB3aXRob3V0IGNhdGNoIG9yIGZpbmFsbHlcIik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcblxuICAgIGFicnVwdDogZnVuY3Rpb24odHlwZSwgYXJnKSB7XG4gICAgICBmb3IgKHZhciBpID0gdGhpcy50cnlFbnRyaWVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pKSB7XG4gICAgICAgIHZhciBlbnRyeSA9IHRoaXMudHJ5RW50cmllc1tpXTtcbiAgICAgICAgaWYgKGVudHJ5LnRyeUxvYyA8PSB0aGlzLnByZXYgJiZcbiAgICAgICAgICAgIGhhc093bi5jYWxsKGVudHJ5LCBcImZpbmFsbHlMb2NcIikgJiZcbiAgICAgICAgICAgIHRoaXMucHJldiA8IGVudHJ5LmZpbmFsbHlMb2MpIHtcbiAgICAgICAgICB2YXIgZmluYWxseUVudHJ5ID0gZW50cnk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKGZpbmFsbHlFbnRyeSAmJlxuICAgICAgICAgICh0eXBlID09PSBcImJyZWFrXCIgfHxcbiAgICAgICAgICAgdHlwZSA9PT0gXCJjb250aW51ZVwiKSAmJlxuICAgICAgICAgIGZpbmFsbHlFbnRyeS50cnlMb2MgPD0gYXJnICYmXG4gICAgICAgICAgYXJnIDw9IGZpbmFsbHlFbnRyeS5maW5hbGx5TG9jKSB7XG4gICAgICAgIC8vIElnbm9yZSB0aGUgZmluYWxseSBlbnRyeSBpZiBjb250cm9sIGlzIG5vdCBqdW1waW5nIHRvIGFcbiAgICAgICAgLy8gbG9jYXRpb24gb3V0c2lkZSB0aGUgdHJ5L2NhdGNoIGJsb2NrLlxuICAgICAgICBmaW5hbGx5RW50cnkgPSBudWxsO1xuICAgICAgfVxuXG4gICAgICB2YXIgcmVjb3JkID0gZmluYWxseUVudHJ5ID8gZmluYWxseUVudHJ5LmNvbXBsZXRpb24gOiB7fTtcbiAgICAgIHJlY29yZC50eXBlID0gdHlwZTtcbiAgICAgIHJlY29yZC5hcmcgPSBhcmc7XG5cbiAgICAgIGlmIChmaW5hbGx5RW50cnkpIHtcbiAgICAgICAgdGhpcy5tZXRob2QgPSBcIm5leHRcIjtcbiAgICAgICAgdGhpcy5uZXh0ID0gZmluYWxseUVudHJ5LmZpbmFsbHlMb2M7XG4gICAgICAgIHJldHVybiBDb250aW51ZVNlbnRpbmVsO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcy5jb21wbGV0ZShyZWNvcmQpO1xuICAgIH0sXG5cbiAgICBjb21wbGV0ZTogZnVuY3Rpb24ocmVjb3JkLCBhZnRlckxvYykge1xuICAgICAgaWYgKHJlY29yZC50eXBlID09PSBcInRocm93XCIpIHtcbiAgICAgICAgdGhyb3cgcmVjb3JkLmFyZztcbiAgICAgIH1cblxuICAgICAgaWYgKHJlY29yZC50eXBlID09PSBcImJyZWFrXCIgfHxcbiAgICAgICAgICByZWNvcmQudHlwZSA9PT0gXCJjb250aW51ZVwiKSB7XG4gICAgICAgIHRoaXMubmV4dCA9IHJlY29yZC5hcmc7XG4gICAgICB9IGVsc2UgaWYgKHJlY29yZC50eXBlID09PSBcInJldHVyblwiKSB7XG4gICAgICAgIHRoaXMucnZhbCA9IHRoaXMuYXJnID0gcmVjb3JkLmFyZztcbiAgICAgICAgdGhpcy5tZXRob2QgPSBcInJldHVyblwiO1xuICAgICAgICB0aGlzLm5leHQgPSBcImVuZFwiO1xuICAgICAgfSBlbHNlIGlmIChyZWNvcmQudHlwZSA9PT0gXCJub3JtYWxcIiAmJiBhZnRlckxvYykge1xuICAgICAgICB0aGlzLm5leHQgPSBhZnRlckxvYztcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIENvbnRpbnVlU2VudGluZWw7XG4gICAgfSxcblxuICAgIGZpbmlzaDogZnVuY3Rpb24oZmluYWxseUxvYykge1xuICAgICAgZm9yICh2YXIgaSA9IHRoaXMudHJ5RW50cmllcy5sZW5ndGggLSAxOyBpID49IDA7IC0taSkge1xuICAgICAgICB2YXIgZW50cnkgPSB0aGlzLnRyeUVudHJpZXNbaV07XG4gICAgICAgIGlmIChlbnRyeS5maW5hbGx5TG9jID09PSBmaW5hbGx5TG9jKSB7XG4gICAgICAgICAgdGhpcy5jb21wbGV0ZShlbnRyeS5jb21wbGV0aW9uLCBlbnRyeS5hZnRlckxvYyk7XG4gICAgICAgICAgcmVzZXRUcnlFbnRyeShlbnRyeSk7XG4gICAgICAgICAgcmV0dXJuIENvbnRpbnVlU2VudGluZWw7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuXG4gICAgXCJjYXRjaFwiOiBmdW5jdGlvbih0cnlMb2MpIHtcbiAgICAgIGZvciAodmFyIGkgPSB0aGlzLnRyeUVudHJpZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyAtLWkpIHtcbiAgICAgICAgdmFyIGVudHJ5ID0gdGhpcy50cnlFbnRyaWVzW2ldO1xuICAgICAgICBpZiAoZW50cnkudHJ5TG9jID09PSB0cnlMb2MpIHtcbiAgICAgICAgICB2YXIgcmVjb3JkID0gZW50cnkuY29tcGxldGlvbjtcbiAgICAgICAgICBpZiAocmVjb3JkLnR5cGUgPT09IFwidGhyb3dcIikge1xuICAgICAgICAgICAgdmFyIHRocm93biA9IHJlY29yZC5hcmc7XG4gICAgICAgICAgICByZXNldFRyeUVudHJ5KGVudHJ5KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHRocm93bjtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBUaGUgY29udGV4dC5jYXRjaCBtZXRob2QgbXVzdCBvbmx5IGJlIGNhbGxlZCB3aXRoIGEgbG9jYXRpb25cbiAgICAgIC8vIGFyZ3VtZW50IHRoYXQgY29ycmVzcG9uZHMgdG8gYSBrbm93biBjYXRjaCBibG9jay5cbiAgICAgIHRocm93IG5ldyBFcnJvcihcImlsbGVnYWwgY2F0Y2ggYXR0ZW1wdFwiKTtcbiAgICB9LFxuXG4gICAgZGVsZWdhdGVZaWVsZDogZnVuY3Rpb24oaXRlcmFibGUsIHJlc3VsdE5hbWUsIG5leHRMb2MpIHtcbiAgICAgIHRoaXMuZGVsZWdhdGUgPSB7XG4gICAgICAgIGl0ZXJhdG9yOiB2YWx1ZXMoaXRlcmFibGUpLFxuICAgICAgICByZXN1bHROYW1lOiByZXN1bHROYW1lLFxuICAgICAgICBuZXh0TG9jOiBuZXh0TG9jXG4gICAgICB9O1xuXG4gICAgICBpZiAodGhpcy5tZXRob2QgPT09IFwibmV4dFwiKSB7XG4gICAgICAgIC8vIERlbGliZXJhdGVseSBmb3JnZXQgdGhlIGxhc3Qgc2VudCB2YWx1ZSBzbyB0aGF0IHdlIGRvbid0XG4gICAgICAgIC8vIGFjY2lkZW50YWxseSBwYXNzIGl0IG9uIHRvIHRoZSBkZWxlZ2F0ZS5cbiAgICAgICAgdGhpcy5hcmcgPSB1bmRlZmluZWQ7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBDb250aW51ZVNlbnRpbmVsO1xuICAgIH1cbiAgfTtcbn0pKFxuICAvLyBJbiBzbG9wcHkgbW9kZSwgdW5ib3VuZCBgdGhpc2AgcmVmZXJzIHRvIHRoZSBnbG9iYWwgb2JqZWN0LCBmYWxsYmFjayB0b1xuICAvLyBGdW5jdGlvbiBjb25zdHJ1Y3RvciBpZiB3ZSdyZSBpbiBnbG9iYWwgc3RyaWN0IG1vZGUuIFRoYXQgaXMgc2FkbHkgYSBmb3JtXG4gIC8vIG9mIGluZGlyZWN0IGV2YWwgd2hpY2ggdmlvbGF0ZXMgQ29udGVudCBTZWN1cml0eSBQb2xpY3kuXG4gIChmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcyB8fCAodHlwZW9mIHNlbGYgPT09IFwib2JqZWN0XCIgJiYgc2VsZik7XG4gIH0pKCkgfHwgRnVuY3Rpb24oXCJyZXR1cm4gdGhpc1wiKSgpXG4pO1xuIiwiLyoqIFBVUkVfSU1QT1JUU19TVEFSVCAgUFVSRV9JTVBPUlRTX0VORCAqL1xuZXhwb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJy4vaW50ZXJuYWwvT2JzZXJ2YWJsZSc7XG5leHBvcnQgeyBDb25uZWN0YWJsZU9ic2VydmFibGUgfSBmcm9tICcuL2ludGVybmFsL29ic2VydmFibGUvQ29ubmVjdGFibGVPYnNlcnZhYmxlJztcbmV4cG9ydCB7IEdyb3VwZWRPYnNlcnZhYmxlIH0gZnJvbSAnLi9pbnRlcm5hbC9vcGVyYXRvcnMvZ3JvdXBCeSc7XG5leHBvcnQgeyBvYnNlcnZhYmxlIH0gZnJvbSAnLi9pbnRlcm5hbC9zeW1ib2wvb2JzZXJ2YWJsZSc7XG5leHBvcnQgeyBTdWJqZWN0IH0gZnJvbSAnLi9pbnRlcm5hbC9TdWJqZWN0JztcbmV4cG9ydCB7IEJlaGF2aW9yU3ViamVjdCB9IGZyb20gJy4vaW50ZXJuYWwvQmVoYXZpb3JTdWJqZWN0JztcbmV4cG9ydCB7IFJlcGxheVN1YmplY3QgfSBmcm9tICcuL2ludGVybmFsL1JlcGxheVN1YmplY3QnO1xuZXhwb3J0IHsgQXN5bmNTdWJqZWN0IH0gZnJvbSAnLi9pbnRlcm5hbC9Bc3luY1N1YmplY3QnO1xuZXhwb3J0IHsgYXNhcCBhcyBhc2FwU2NoZWR1bGVyIH0gZnJvbSAnLi9pbnRlcm5hbC9zY2hlZHVsZXIvYXNhcCc7XG5leHBvcnQgeyBhc3luYyBhcyBhc3luY1NjaGVkdWxlciB9IGZyb20gJy4vaW50ZXJuYWwvc2NoZWR1bGVyL2FzeW5jJztcbmV4cG9ydCB7IHF1ZXVlIGFzIHF1ZXVlU2NoZWR1bGVyIH0gZnJvbSAnLi9pbnRlcm5hbC9zY2hlZHVsZXIvcXVldWUnO1xuZXhwb3J0IHsgYW5pbWF0aW9uRnJhbWUgYXMgYW5pbWF0aW9uRnJhbWVTY2hlZHVsZXIgfSBmcm9tICcuL2ludGVybmFsL3NjaGVkdWxlci9hbmltYXRpb25GcmFtZSc7XG5leHBvcnQgeyBWaXJ0dWFsVGltZVNjaGVkdWxlciwgVmlydHVhbEFjdGlvbiB9IGZyb20gJy4vaW50ZXJuYWwvc2NoZWR1bGVyL1ZpcnR1YWxUaW1lU2NoZWR1bGVyJztcbmV4cG9ydCB7IFNjaGVkdWxlciB9IGZyb20gJy4vaW50ZXJuYWwvU2NoZWR1bGVyJztcbmV4cG9ydCB7IFN1YnNjcmlwdGlvbiB9IGZyb20gJy4vaW50ZXJuYWwvU3Vic2NyaXB0aW9uJztcbmV4cG9ydCB7IFN1YnNjcmliZXIgfSBmcm9tICcuL2ludGVybmFsL1N1YnNjcmliZXInO1xuZXhwb3J0IHsgTm90aWZpY2F0aW9uIH0gZnJvbSAnLi9pbnRlcm5hbC9Ob3RpZmljYXRpb24nO1xuZXhwb3J0IHsgcGlwZSB9IGZyb20gJy4vaW50ZXJuYWwvdXRpbC9waXBlJztcbmV4cG9ydCB7IG5vb3AgfSBmcm9tICcuL2ludGVybmFsL3V0aWwvbm9vcCc7XG5leHBvcnQgeyBpZGVudGl0eSB9IGZyb20gJy4vaW50ZXJuYWwvdXRpbC9pZGVudGl0eSc7XG5leHBvcnQgeyBpc09ic2VydmFibGUgfSBmcm9tICcuL2ludGVybmFsL3V0aWwvaXNPYnNlcnZhYmxlJztcbmV4cG9ydCB7IEFyZ3VtZW50T3V0T2ZSYW5nZUVycm9yIH0gZnJvbSAnLi9pbnRlcm5hbC91dGlsL0FyZ3VtZW50T3V0T2ZSYW5nZUVycm9yJztcbmV4cG9ydCB7IEVtcHR5RXJyb3IgfSBmcm9tICcuL2ludGVybmFsL3V0aWwvRW1wdHlFcnJvcic7XG5leHBvcnQgeyBPYmplY3RVbnN1YnNjcmliZWRFcnJvciB9IGZyb20gJy4vaW50ZXJuYWwvdXRpbC9PYmplY3RVbnN1YnNjcmliZWRFcnJvcic7XG5leHBvcnQgeyBVbnN1YnNjcmlwdGlvbkVycm9yIH0gZnJvbSAnLi9pbnRlcm5hbC91dGlsL1Vuc3Vic2NyaXB0aW9uRXJyb3InO1xuZXhwb3J0IHsgVGltZW91dEVycm9yIH0gZnJvbSAnLi9pbnRlcm5hbC91dGlsL1RpbWVvdXRFcnJvcic7XG5leHBvcnQgeyBiaW5kQ2FsbGJhY2sgfSBmcm9tICcuL2ludGVybmFsL29ic2VydmFibGUvYmluZENhbGxiYWNrJztcbmV4cG9ydCB7IGJpbmROb2RlQ2FsbGJhY2sgfSBmcm9tICcuL2ludGVybmFsL29ic2VydmFibGUvYmluZE5vZGVDYWxsYmFjayc7XG5leHBvcnQgeyBjb21iaW5lTGF0ZXN0IH0gZnJvbSAnLi9pbnRlcm5hbC9vYnNlcnZhYmxlL2NvbWJpbmVMYXRlc3QnO1xuZXhwb3J0IHsgY29uY2F0IH0gZnJvbSAnLi9pbnRlcm5hbC9vYnNlcnZhYmxlL2NvbmNhdCc7XG5leHBvcnQgeyBkZWZlciB9IGZyb20gJy4vaW50ZXJuYWwvb2JzZXJ2YWJsZS9kZWZlcic7XG5leHBvcnQgeyBlbXB0eSB9IGZyb20gJy4vaW50ZXJuYWwvb2JzZXJ2YWJsZS9lbXB0eSc7XG5leHBvcnQgeyBmb3JrSm9pbiB9IGZyb20gJy4vaW50ZXJuYWwvb2JzZXJ2YWJsZS9mb3JrSm9pbic7XG5leHBvcnQgeyBmcm9tIH0gZnJvbSAnLi9pbnRlcm5hbC9vYnNlcnZhYmxlL2Zyb20nO1xuZXhwb3J0IHsgZnJvbUV2ZW50IH0gZnJvbSAnLi9pbnRlcm5hbC9vYnNlcnZhYmxlL2Zyb21FdmVudCc7XG5leHBvcnQgeyBmcm9tRXZlbnRQYXR0ZXJuIH0gZnJvbSAnLi9pbnRlcm5hbC9vYnNlcnZhYmxlL2Zyb21FdmVudFBhdHRlcm4nO1xuZXhwb3J0IHsgZ2VuZXJhdGUgfSBmcm9tICcuL2ludGVybmFsL29ic2VydmFibGUvZ2VuZXJhdGUnO1xuZXhwb3J0IHsgaWlmIH0gZnJvbSAnLi9pbnRlcm5hbC9vYnNlcnZhYmxlL2lpZic7XG5leHBvcnQgeyBpbnRlcnZhbCB9IGZyb20gJy4vaW50ZXJuYWwvb2JzZXJ2YWJsZS9pbnRlcnZhbCc7XG5leHBvcnQgeyBtZXJnZSB9IGZyb20gJy4vaW50ZXJuYWwvb2JzZXJ2YWJsZS9tZXJnZSc7XG5leHBvcnQgeyBuZXZlciB9IGZyb20gJy4vaW50ZXJuYWwvb2JzZXJ2YWJsZS9uZXZlcic7XG5leHBvcnQgeyBvZiB9IGZyb20gJy4vaW50ZXJuYWwvb2JzZXJ2YWJsZS9vZic7XG5leHBvcnQgeyBvbkVycm9yUmVzdW1lTmV4dCB9IGZyb20gJy4vaW50ZXJuYWwvb2JzZXJ2YWJsZS9vbkVycm9yUmVzdW1lTmV4dCc7XG5leHBvcnQgeyBwYWlycyB9IGZyb20gJy4vaW50ZXJuYWwvb2JzZXJ2YWJsZS9wYWlycyc7XG5leHBvcnQgeyByYWNlIH0gZnJvbSAnLi9pbnRlcm5hbC9vYnNlcnZhYmxlL3JhY2UnO1xuZXhwb3J0IHsgcmFuZ2UgfSBmcm9tICcuL2ludGVybmFsL29ic2VydmFibGUvcmFuZ2UnO1xuZXhwb3J0IHsgdGhyb3dFcnJvciB9IGZyb20gJy4vaW50ZXJuYWwvb2JzZXJ2YWJsZS90aHJvd0Vycm9yJztcbmV4cG9ydCB7IHRpbWVyIH0gZnJvbSAnLi9pbnRlcm5hbC9vYnNlcnZhYmxlL3RpbWVyJztcbmV4cG9ydCB7IHVzaW5nIH0gZnJvbSAnLi9pbnRlcm5hbC9vYnNlcnZhYmxlL3VzaW5nJztcbmV4cG9ydCB7IHppcCB9IGZyb20gJy4vaW50ZXJuYWwvb2JzZXJ2YWJsZS96aXAnO1xuZXhwb3J0IHsgRU1QVFkgfSBmcm9tICcuL2ludGVybmFsL29ic2VydmFibGUvZW1wdHknO1xuZXhwb3J0IHsgTkVWRVIgfSBmcm9tICcuL2ludGVybmFsL29ic2VydmFibGUvbmV2ZXInO1xuZXhwb3J0IHsgY29uZmlnIH0gZnJvbSAnLi9pbnRlcm5hbC9jb25maWcnO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwXG4iLCIvKiogUFVSRV9JTVBPUlRTX1NUQVJUIHRzbGliLF9TdWJqZWN0LF9TdWJzY3JpcHRpb24gUFVSRV9JTVBPUlRTX0VORCAqL1xuaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IFN1YmplY3QgfSBmcm9tICcuL1N1YmplY3QnO1xuaW1wb3J0IHsgU3Vic2NyaXB0aW9uIH0gZnJvbSAnLi9TdWJzY3JpcHRpb24nO1xudmFyIEFzeW5jU3ViamVjdCA9IC8qQF9fUFVSRV9fKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhBc3luY1N1YmplY3QsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQXN5bmNTdWJqZWN0KCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMudmFsdWUgPSBudWxsO1xuICAgICAgICBfdGhpcy5oYXNOZXh0ID0gZmFsc2U7XG4gICAgICAgIF90aGlzLmhhc0NvbXBsZXRlZCA9IGZhbHNlO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIEFzeW5jU3ViamVjdC5wcm90b3R5cGUuX3N1YnNjcmliZSA9IGZ1bmN0aW9uIChzdWJzY3JpYmVyKSB7XG4gICAgICAgIGlmICh0aGlzLmhhc0Vycm9yKSB7XG4gICAgICAgICAgICBzdWJzY3JpYmVyLmVycm9yKHRoaXMudGhyb3duRXJyb3IpO1xuICAgICAgICAgICAgcmV0dXJuIFN1YnNjcmlwdGlvbi5FTVBUWTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLmhhc0NvbXBsZXRlZCAmJiB0aGlzLmhhc05leHQpIHtcbiAgICAgICAgICAgIHN1YnNjcmliZXIubmV4dCh0aGlzLnZhbHVlKTtcbiAgICAgICAgICAgIHN1YnNjcmliZXIuY29tcGxldGUoKTtcbiAgICAgICAgICAgIHJldHVybiBTdWJzY3JpcHRpb24uRU1QVFk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF9zdXBlci5wcm90b3R5cGUuX3N1YnNjcmliZS5jYWxsKHRoaXMsIHN1YnNjcmliZXIpO1xuICAgIH07XG4gICAgQXN5bmNTdWJqZWN0LnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICghdGhpcy5oYXNDb21wbGV0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMuaGFzTmV4dCA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEFzeW5jU3ViamVjdC5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgaWYgKCF0aGlzLmhhc0NvbXBsZXRlZCkge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5lcnJvci5jYWxsKHRoaXMsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQXN5bmNTdWJqZWN0LnByb3RvdHlwZS5jb21wbGV0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5oYXNDb21wbGV0ZWQgPSB0cnVlO1xuICAgICAgICBpZiAodGhpcy5oYXNOZXh0KSB7XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLm5leHQuY2FsbCh0aGlzLCB0aGlzLnZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmNvbXBsZXRlLmNhbGwodGhpcyk7XG4gICAgfTtcbiAgICByZXR1cm4gQXN5bmNTdWJqZWN0O1xufShTdWJqZWN0KSk7XG5leHBvcnQgeyBBc3luY1N1YmplY3QgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUFzeW5jU3ViamVjdC5qcy5tYXBcbiIsIi8qKiBQVVJFX0lNUE9SVFNfU1RBUlQgdHNsaWIsX1N1YmplY3QsX3V0aWxfT2JqZWN0VW5zdWJzY3JpYmVkRXJyb3IgUFVSRV9JTVBPUlRTX0VORCAqL1xuaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IFN1YmplY3QgfSBmcm9tICcuL1N1YmplY3QnO1xuaW1wb3J0IHsgT2JqZWN0VW5zdWJzY3JpYmVkRXJyb3IgfSBmcm9tICcuL3V0aWwvT2JqZWN0VW5zdWJzY3JpYmVkRXJyb3InO1xudmFyIEJlaGF2aW9yU3ViamVjdCA9IC8qQF9fUFVSRV9fKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhCZWhhdmlvclN1YmplY3QsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQmVoYXZpb3JTdWJqZWN0KF92YWx1ZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5fdmFsdWUgPSBfdmFsdWU7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEJlaGF2aW9yU3ViamVjdC5wcm90b3R5cGUsIFwidmFsdWVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldFZhbHVlKCk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEJlaGF2aW9yU3ViamVjdC5wcm90b3R5cGUuX3N1YnNjcmliZSA9IGZ1bmN0aW9uIChzdWJzY3JpYmVyKSB7XG4gICAgICAgIHZhciBzdWJzY3JpcHRpb24gPSBfc3VwZXIucHJvdG90eXBlLl9zdWJzY3JpYmUuY2FsbCh0aGlzLCBzdWJzY3JpYmVyKTtcbiAgICAgICAgaWYgKHN1YnNjcmlwdGlvbiAmJiAhc3Vic2NyaXB0aW9uLmNsb3NlZCkge1xuICAgICAgICAgICAgc3Vic2NyaWJlci5uZXh0KHRoaXMuX3ZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3Vic2NyaXB0aW9uO1xuICAgIH07XG4gICAgQmVoYXZpb3JTdWJqZWN0LnByb3RvdHlwZS5nZXRWYWx1ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuaGFzRXJyb3IpIHtcbiAgICAgICAgICAgIHRocm93IHRoaXMudGhyb3duRXJyb3I7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5jbG9zZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBPYmplY3RVbnN1YnNjcmliZWRFcnJvcigpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3ZhbHVlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBCZWhhdmlvclN1YmplY3QucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5uZXh0LmNhbGwodGhpcywgdGhpcy5fdmFsdWUgPSB2YWx1ZSk7XG4gICAgfTtcbiAgICByZXR1cm4gQmVoYXZpb3JTdWJqZWN0O1xufShTdWJqZWN0KSk7XG5leHBvcnQgeyBCZWhhdmlvclN1YmplY3QgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUJlaGF2aW9yU3ViamVjdC5qcy5tYXBcbiIsIi8qKiBQVVJFX0lNUE9SVFNfU1RBUlQgdHNsaWIsX1N1YnNjcmliZXIgUFVSRV9JTVBPUlRTX0VORCAqL1xuaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IFN1YnNjcmliZXIgfSBmcm9tICcuL1N1YnNjcmliZXInO1xudmFyIElubmVyU3Vic2NyaWJlciA9IC8qQF9fUFVSRV9fKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhJbm5lclN1YnNjcmliZXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gSW5uZXJTdWJzY3JpYmVyKHBhcmVudCwgb3V0ZXJWYWx1ZSwgb3V0ZXJJbmRleCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG4gICAgICAgIF90aGlzLm91dGVyVmFsdWUgPSBvdXRlclZhbHVlO1xuICAgICAgICBfdGhpcy5vdXRlckluZGV4ID0gb3V0ZXJJbmRleDtcbiAgICAgICAgX3RoaXMuaW5kZXggPSAwO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIElubmVyU3Vic2NyaWJlci5wcm90b3R5cGUuX25leHQgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5wYXJlbnQubm90aWZ5TmV4dCh0aGlzLm91dGVyVmFsdWUsIHZhbHVlLCB0aGlzLm91dGVySW5kZXgsIHRoaXMuaW5kZXgrKywgdGhpcyk7XG4gICAgfTtcbiAgICBJbm5lclN1YnNjcmliZXIucHJvdG90eXBlLl9lcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICB0aGlzLnBhcmVudC5ub3RpZnlFcnJvcihlcnJvciwgdGhpcyk7XG4gICAgICAgIHRoaXMudW5zdWJzY3JpYmUoKTtcbiAgICB9O1xuICAgIElubmVyU3Vic2NyaWJlci5wcm90b3R5cGUuX2NvbXBsZXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnBhcmVudC5ub3RpZnlDb21wbGV0ZSh0aGlzKTtcbiAgICAgICAgdGhpcy51bnN1YnNjcmliZSgpO1xuICAgIH07XG4gICAgcmV0dXJuIElubmVyU3Vic2NyaWJlcjtcbn0oU3Vic2NyaWJlcikpO1xuZXhwb3J0IHsgSW5uZXJTdWJzY3JpYmVyIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1Jbm5lclN1YnNjcmliZXIuanMubWFwXG4iLCIvKiogUFVSRV9JTVBPUlRTX1NUQVJUIF9vYnNlcnZhYmxlX2VtcHR5LF9vYnNlcnZhYmxlX29mLF9vYnNlcnZhYmxlX3Rocm93RXJyb3IgUFVSRV9JTVBPUlRTX0VORCAqL1xuaW1wb3J0IHsgZW1wdHkgfSBmcm9tICcuL29ic2VydmFibGUvZW1wdHknO1xuaW1wb3J0IHsgb2YgfSBmcm9tICcuL29ic2VydmFibGUvb2YnO1xuaW1wb3J0IHsgdGhyb3dFcnJvciB9IGZyb20gJy4vb2JzZXJ2YWJsZS90aHJvd0Vycm9yJztcbnZhciBOb3RpZmljYXRpb24gPSAvKkBfX1BVUkVfXyovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gTm90aWZpY2F0aW9uKGtpbmQsIHZhbHVlLCBlcnJvcikge1xuICAgICAgICB0aGlzLmtpbmQgPSBraW5kO1xuICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgICAgIHRoaXMuZXJyb3IgPSBlcnJvcjtcbiAgICAgICAgdGhpcy5oYXNWYWx1ZSA9IGtpbmQgPT09ICdOJztcbiAgICB9XG4gICAgTm90aWZpY2F0aW9uLnByb3RvdHlwZS5vYnNlcnZlID0gZnVuY3Rpb24gKG9ic2VydmVyKSB7XG4gICAgICAgIHN3aXRjaCAodGhpcy5raW5kKSB7XG4gICAgICAgICAgICBjYXNlICdOJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gb2JzZXJ2ZXIubmV4dCAmJiBvYnNlcnZlci5uZXh0KHRoaXMudmFsdWUpO1xuICAgICAgICAgICAgY2FzZSAnRSc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG9ic2VydmVyLmVycm9yICYmIG9ic2VydmVyLmVycm9yKHRoaXMuZXJyb3IpO1xuICAgICAgICAgICAgY2FzZSAnQyc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG9ic2VydmVyLmNvbXBsZXRlICYmIG9ic2VydmVyLmNvbXBsZXRlKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE5vdGlmaWNhdGlvbi5wcm90b3R5cGUuZG8gPSBmdW5jdGlvbiAobmV4dCwgZXJyb3IsIGNvbXBsZXRlKSB7XG4gICAgICAgIHZhciBraW5kID0gdGhpcy5raW5kO1xuICAgICAgICBzd2l0Y2ggKGtpbmQpIHtcbiAgICAgICAgICAgIGNhc2UgJ04nOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXh0ICYmIG5leHQodGhpcy52YWx1ZSk7XG4gICAgICAgICAgICBjYXNlICdFJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gZXJyb3IgJiYgZXJyb3IodGhpcy5lcnJvcik7XG4gICAgICAgICAgICBjYXNlICdDJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gY29tcGxldGUgJiYgY29tcGxldGUoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgTm90aWZpY2F0aW9uLnByb3RvdHlwZS5hY2NlcHQgPSBmdW5jdGlvbiAobmV4dE9yT2JzZXJ2ZXIsIGVycm9yLCBjb21wbGV0ZSkge1xuICAgICAgICBpZiAobmV4dE9yT2JzZXJ2ZXIgJiYgdHlwZW9mIG5leHRPck9ic2VydmVyLm5leHQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm9ic2VydmUobmV4dE9yT2JzZXJ2ZXIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZG8obmV4dE9yT2JzZXJ2ZXIsIGVycm9yLCBjb21wbGV0ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE5vdGlmaWNhdGlvbi5wcm90b3R5cGUudG9PYnNlcnZhYmxlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIga2luZCA9IHRoaXMua2luZDtcbiAgICAgICAgc3dpdGNoIChraW5kKSB7XG4gICAgICAgICAgICBjYXNlICdOJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gb2YodGhpcy52YWx1ZSk7XG4gICAgICAgICAgICBjYXNlICdFJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhyb3dFcnJvcih0aGlzLmVycm9yKTtcbiAgICAgICAgICAgIGNhc2UgJ0MnOlxuICAgICAgICAgICAgICAgIHJldHVybiBlbXB0eSgpO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IG5ldyBFcnJvcigndW5leHBlY3RlZCBub3RpZmljYXRpb24ga2luZCB2YWx1ZScpO1xuICAgIH07XG4gICAgTm90aWZpY2F0aW9uLmNyZWF0ZU5leHQgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgTm90aWZpY2F0aW9uKCdOJywgdmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBOb3RpZmljYXRpb24udW5kZWZpbmVkVmFsdWVOb3RpZmljYXRpb247XG4gICAgfTtcbiAgICBOb3RpZmljYXRpb24uY3JlYXRlRXJyb3IgPSBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgIHJldHVybiBuZXcgTm90aWZpY2F0aW9uKCdFJywgdW5kZWZpbmVkLCBlcnIpO1xuICAgIH07XG4gICAgTm90aWZpY2F0aW9uLmNyZWF0ZUNvbXBsZXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gTm90aWZpY2F0aW9uLmNvbXBsZXRlTm90aWZpY2F0aW9uO1xuICAgIH07XG4gICAgTm90aWZpY2F0aW9uLmNvbXBsZXRlTm90aWZpY2F0aW9uID0gbmV3IE5vdGlmaWNhdGlvbignQycpO1xuICAgIE5vdGlmaWNhdGlvbi51bmRlZmluZWRWYWx1ZU5vdGlmaWNhdGlvbiA9IG5ldyBOb3RpZmljYXRpb24oJ04nLCB1bmRlZmluZWQpO1xuICAgIHJldHVybiBOb3RpZmljYXRpb247XG59KCkpO1xuZXhwb3J0IHsgTm90aWZpY2F0aW9uIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1Ob3RpZmljYXRpb24uanMubWFwXG4iLCIvKiogUFVSRV9JTVBPUlRTX1NUQVJUIF91dGlsX2NhblJlcG9ydEVycm9yLF91dGlsX3RvU3Vic2NyaWJlcixfaW50ZXJuYWxfc3ltYm9sX29ic2VydmFibGUsX3V0aWxfcGlwZSxfY29uZmlnIFBVUkVfSU1QT1JUU19FTkQgKi9cbmltcG9ydCB7IGNhblJlcG9ydEVycm9yIH0gZnJvbSAnLi91dGlsL2NhblJlcG9ydEVycm9yJztcbmltcG9ydCB7IHRvU3Vic2NyaWJlciB9IGZyb20gJy4vdXRpbC90b1N1YnNjcmliZXInO1xuaW1wb3J0IHsgb2JzZXJ2YWJsZSBhcyBTeW1ib2xfb2JzZXJ2YWJsZSB9IGZyb20gJy4uL2ludGVybmFsL3N5bWJvbC9vYnNlcnZhYmxlJztcbmltcG9ydCB7IHBpcGVGcm9tQXJyYXkgfSBmcm9tICcuL3V0aWwvcGlwZSc7XG5pbXBvcnQgeyBjb25maWcgfSBmcm9tICcuL2NvbmZpZyc7XG52YXIgT2JzZXJ2YWJsZSA9IC8qQF9fUFVSRV9fKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBPYnNlcnZhYmxlKHN1YnNjcmliZSkge1xuICAgICAgICB0aGlzLl9pc1NjYWxhciA9IGZhbHNlO1xuICAgICAgICBpZiAoc3Vic2NyaWJlKSB7XG4gICAgICAgICAgICB0aGlzLl9zdWJzY3JpYmUgPSBzdWJzY3JpYmU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgT2JzZXJ2YWJsZS5wcm90b3R5cGUubGlmdCA9IGZ1bmN0aW9uIChvcGVyYXRvcikge1xuICAgICAgICB2YXIgb2JzZXJ2YWJsZSA9IG5ldyBPYnNlcnZhYmxlKCk7XG4gICAgICAgIG9ic2VydmFibGUuc291cmNlID0gdGhpcztcbiAgICAgICAgb2JzZXJ2YWJsZS5vcGVyYXRvciA9IG9wZXJhdG9yO1xuICAgICAgICByZXR1cm4gb2JzZXJ2YWJsZTtcbiAgICB9O1xuICAgIE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZSA9IGZ1bmN0aW9uIChvYnNlcnZlck9yTmV4dCwgZXJyb3IsIGNvbXBsZXRlKSB7XG4gICAgICAgIHZhciBvcGVyYXRvciA9IHRoaXMub3BlcmF0b3I7XG4gICAgICAgIHZhciBzaW5rID0gdG9TdWJzY3JpYmVyKG9ic2VydmVyT3JOZXh0LCBlcnJvciwgY29tcGxldGUpO1xuICAgICAgICBpZiAob3BlcmF0b3IpIHtcbiAgICAgICAgICAgIG9wZXJhdG9yLmNhbGwoc2luaywgdGhpcy5zb3VyY2UpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc2luay5hZGQodGhpcy5zb3VyY2UgfHwgKGNvbmZpZy51c2VEZXByZWNhdGVkU3luY2hyb25vdXNFcnJvckhhbmRsaW5nICYmICFzaW5rLnN5bmNFcnJvclRocm93YWJsZSkgP1xuICAgICAgICAgICAgICAgIHRoaXMuX3N1YnNjcmliZShzaW5rKSA6XG4gICAgICAgICAgICAgICAgdGhpcy5fdHJ5U3Vic2NyaWJlKHNpbmspKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29uZmlnLnVzZURlcHJlY2F0ZWRTeW5jaHJvbm91c0Vycm9ySGFuZGxpbmcpIHtcbiAgICAgICAgICAgIGlmIChzaW5rLnN5bmNFcnJvclRocm93YWJsZSkge1xuICAgICAgICAgICAgICAgIHNpbmsuc3luY0Vycm9yVGhyb3dhYmxlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaWYgKHNpbmsuc3luY0Vycm9yVGhyb3duKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IHNpbmsuc3luY0Vycm9yVmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzaW5rO1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZS5wcm90b3R5cGUuX3RyeVN1YnNjcmliZSA9IGZ1bmN0aW9uIChzaW5rKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc3Vic2NyaWJlKHNpbmspO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIGlmIChjb25maWcudXNlRGVwcmVjYXRlZFN5bmNocm9ub3VzRXJyb3JIYW5kbGluZykge1xuICAgICAgICAgICAgICAgIHNpbmsuc3luY0Vycm9yVGhyb3duID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBzaW5rLnN5bmNFcnJvclZhbHVlID0gZXJyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNhblJlcG9ydEVycm9yKHNpbmspKSB7XG4gICAgICAgICAgICAgICAgc2luay5lcnJvcihlcnIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGVycik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE9ic2VydmFibGUucHJvdG90eXBlLmZvckVhY2ggPSBmdW5jdGlvbiAobmV4dCwgcHJvbWlzZUN0b3IpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcHJvbWlzZUN0b3IgPSBnZXRQcm9taXNlQ3Rvcihwcm9taXNlQ3Rvcik7XG4gICAgICAgIHJldHVybiBuZXcgcHJvbWlzZUN0b3IoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgdmFyIHN1YnNjcmlwdGlvbjtcbiAgICAgICAgICAgIHN1YnNjcmlwdGlvbiA9IF90aGlzLnN1YnNjcmliZShmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBuZXh0KHZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN1YnNjcmlwdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCByZWplY3QsIHJlc29sdmUpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIE9ic2VydmFibGUucHJvdG90eXBlLl9zdWJzY3JpYmUgPSBmdW5jdGlvbiAoc3Vic2NyaWJlcikge1xuICAgICAgICB2YXIgc291cmNlID0gdGhpcy5zb3VyY2U7XG4gICAgICAgIHJldHVybiBzb3VyY2UgJiYgc291cmNlLnN1YnNjcmliZShzdWJzY3JpYmVyKTtcbiAgICB9O1xuICAgIE9ic2VydmFibGUucHJvdG90eXBlW1N5bWJvbF9vYnNlcnZhYmxlXSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlLnByb3RvdHlwZS5waXBlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgb3BlcmF0aW9ucyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgb3BlcmF0aW9uc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvcGVyYXRpb25zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHBpcGVGcm9tQXJyYXkob3BlcmF0aW9ucykodGhpcyk7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlLnByb3RvdHlwZS50b1Byb21pc2UgPSBmdW5jdGlvbiAocHJvbWlzZUN0b3IpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcHJvbWlzZUN0b3IgPSBnZXRQcm9taXNlQ3Rvcihwcm9taXNlQ3Rvcik7XG4gICAgICAgIHJldHVybiBuZXcgcHJvbWlzZUN0b3IoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgdmFyIHZhbHVlO1xuICAgICAgICAgICAgX3RoaXMuc3Vic2NyaWJlKGZ1bmN0aW9uICh4KSB7IHJldHVybiB2YWx1ZSA9IHg7IH0sIGZ1bmN0aW9uIChlcnIpIHsgcmV0dXJuIHJlamVjdChlcnIpOyB9LCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXNvbHZlKHZhbHVlKTsgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZS5jcmVhdGUgPSBmdW5jdGlvbiAoc3Vic2NyaWJlKSB7XG4gICAgICAgIHJldHVybiBuZXcgT2JzZXJ2YWJsZShzdWJzY3JpYmUpO1xuICAgIH07XG4gICAgcmV0dXJuIE9ic2VydmFibGU7XG59KCkpO1xuZXhwb3J0IHsgT2JzZXJ2YWJsZSB9O1xuZnVuY3Rpb24gZ2V0UHJvbWlzZUN0b3IocHJvbWlzZUN0b3IpIHtcbiAgICBpZiAoIXByb21pc2VDdG9yKSB7XG4gICAgICAgIHByb21pc2VDdG9yID0gY29uZmlnLlByb21pc2UgfHwgUHJvbWlzZTtcbiAgICB9XG4gICAgaWYgKCFwcm9taXNlQ3Rvcikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ25vIFByb21pc2UgaW1wbCBmb3VuZCcpO1xuICAgIH1cbiAgICByZXR1cm4gcHJvbWlzZUN0b3I7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1PYnNlcnZhYmxlLmpzLm1hcFxuIiwiLyoqIFBVUkVfSU1QT1JUU19TVEFSVCBfY29uZmlnLF91dGlsX2hvc3RSZXBvcnRFcnJvciBQVVJFX0lNUE9SVFNfRU5EICovXG5pbXBvcnQgeyBjb25maWcgfSBmcm9tICcuL2NvbmZpZyc7XG5pbXBvcnQgeyBob3N0UmVwb3J0RXJyb3IgfSBmcm9tICcuL3V0aWwvaG9zdFJlcG9ydEVycm9yJztcbmV4cG9ydCB2YXIgZW1wdHkgPSB7XG4gICAgY2xvc2VkOiB0cnVlLFxuICAgIG5leHQ6IGZ1bmN0aW9uICh2YWx1ZSkgeyB9LFxuICAgIGVycm9yOiBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgIGlmIChjb25maWcudXNlRGVwcmVjYXRlZFN5bmNocm9ub3VzRXJyb3JIYW5kbGluZykge1xuICAgICAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaG9zdFJlcG9ydEVycm9yKGVycik7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7IH1cbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1PYnNlcnZlci5qcy5tYXBcbiIsIi8qKiBQVVJFX0lNUE9SVFNfU1RBUlQgdHNsaWIsX1N1YnNjcmliZXIgUFVSRV9JTVBPUlRTX0VORCAqL1xuaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IFN1YnNjcmliZXIgfSBmcm9tICcuL1N1YnNjcmliZXInO1xudmFyIE91dGVyU3Vic2NyaWJlciA9IC8qQF9fUFVSRV9fKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhPdXRlclN1YnNjcmliZXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gT3V0ZXJTdWJzY3JpYmVyKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIE91dGVyU3Vic2NyaWJlci5wcm90b3R5cGUubm90aWZ5TmV4dCA9IGZ1bmN0aW9uIChvdXRlclZhbHVlLCBpbm5lclZhbHVlLCBvdXRlckluZGV4LCBpbm5lckluZGV4LCBpbm5lclN1Yikge1xuICAgICAgICB0aGlzLmRlc3RpbmF0aW9uLm5leHQoaW5uZXJWYWx1ZSk7XG4gICAgfTtcbiAgICBPdXRlclN1YnNjcmliZXIucHJvdG90eXBlLm5vdGlmeUVycm9yID0gZnVuY3Rpb24gKGVycm9yLCBpbm5lclN1Yikge1xuICAgICAgICB0aGlzLmRlc3RpbmF0aW9uLmVycm9yKGVycm9yKTtcbiAgICB9O1xuICAgIE91dGVyU3Vic2NyaWJlci5wcm90b3R5cGUubm90aWZ5Q29tcGxldGUgPSBmdW5jdGlvbiAoaW5uZXJTdWIpIHtcbiAgICAgICAgdGhpcy5kZXN0aW5hdGlvbi5jb21wbGV0ZSgpO1xuICAgIH07XG4gICAgcmV0dXJuIE91dGVyU3Vic2NyaWJlcjtcbn0oU3Vic2NyaWJlcikpO1xuZXhwb3J0IHsgT3V0ZXJTdWJzY3JpYmVyIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1PdXRlclN1YnNjcmliZXIuanMubWFwXG4iLCIvKiogUFVSRV9JTVBPUlRTX1NUQVJUIHRzbGliLF9TdWJqZWN0LF9zY2hlZHVsZXJfcXVldWUsX1N1YnNjcmlwdGlvbixfb3BlcmF0b3JzX29ic2VydmVPbixfdXRpbF9PYmplY3RVbnN1YnNjcmliZWRFcnJvcixfU3ViamVjdFN1YnNjcmlwdGlvbiBQVVJFX0lNUE9SVFNfRU5EICovXG5pbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xuaW1wb3J0IHsgU3ViamVjdCB9IGZyb20gJy4vU3ViamVjdCc7XG5pbXBvcnQgeyBxdWV1ZSB9IGZyb20gJy4vc2NoZWR1bGVyL3F1ZXVlJztcbmltcG9ydCB7IFN1YnNjcmlwdGlvbiB9IGZyb20gJy4vU3Vic2NyaXB0aW9uJztcbmltcG9ydCB7IE9ic2VydmVPblN1YnNjcmliZXIgfSBmcm9tICcuL29wZXJhdG9ycy9vYnNlcnZlT24nO1xuaW1wb3J0IHsgT2JqZWN0VW5zdWJzY3JpYmVkRXJyb3IgfSBmcm9tICcuL3V0aWwvT2JqZWN0VW5zdWJzY3JpYmVkRXJyb3InO1xuaW1wb3J0IHsgU3ViamVjdFN1YnNjcmlwdGlvbiB9IGZyb20gJy4vU3ViamVjdFN1YnNjcmlwdGlvbic7XG52YXIgUmVwbGF5U3ViamVjdCA9IC8qQF9fUFVSRV9fKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhSZXBsYXlTdWJqZWN0LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFJlcGxheVN1YmplY3QoYnVmZmVyU2l6ZSwgd2luZG93VGltZSwgc2NoZWR1bGVyKSB7XG4gICAgICAgIGlmIChidWZmZXJTaXplID09PSB2b2lkIDApIHtcbiAgICAgICAgICAgIGJ1ZmZlclNpemUgPSBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHdpbmRvd1RpbWUgPT09IHZvaWQgMCkge1xuICAgICAgICAgICAgd2luZG93VGltZSA9IE51bWJlci5QT1NJVElWRV9JTkZJTklUWTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5zY2hlZHVsZXIgPSBzY2hlZHVsZXI7XG4gICAgICAgIF90aGlzLl9ldmVudHMgPSBbXTtcbiAgICAgICAgX3RoaXMuX2luZmluaXRlVGltZVdpbmRvdyA9IGZhbHNlO1xuICAgICAgICBfdGhpcy5fYnVmZmVyU2l6ZSA9IGJ1ZmZlclNpemUgPCAxID8gMSA6IGJ1ZmZlclNpemU7XG4gICAgICAgIF90aGlzLl93aW5kb3dUaW1lID0gd2luZG93VGltZSA8IDEgPyAxIDogd2luZG93VGltZTtcbiAgICAgICAgaWYgKHdpbmRvd1RpbWUgPT09IE51bWJlci5QT1NJVElWRV9JTkZJTklUWSkge1xuICAgICAgICAgICAgX3RoaXMuX2luZmluaXRlVGltZVdpbmRvdyA9IHRydWU7XG4gICAgICAgICAgICBfdGhpcy5uZXh0ID0gX3RoaXMubmV4dEluZmluaXRlVGltZVdpbmRvdztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIF90aGlzLm5leHQgPSBfdGhpcy5uZXh0VGltZVdpbmRvdztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIFJlcGxheVN1YmplY3QucHJvdG90eXBlLm5leHRJbmZpbml0ZVRpbWVXaW5kb3cgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIF9ldmVudHMgPSB0aGlzLl9ldmVudHM7XG4gICAgICAgIF9ldmVudHMucHVzaCh2YWx1ZSk7XG4gICAgICAgIGlmIChfZXZlbnRzLmxlbmd0aCA+IHRoaXMuX2J1ZmZlclNpemUpIHtcbiAgICAgICAgICAgIF9ldmVudHMuc2hpZnQoKTtcbiAgICAgICAgfVxuICAgICAgICBfc3VwZXIucHJvdG90eXBlLm5leHQuY2FsbCh0aGlzLCB2YWx1ZSk7XG4gICAgfTtcbiAgICBSZXBsYXlTdWJqZWN0LnByb3RvdHlwZS5uZXh0VGltZVdpbmRvdyA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9ldmVudHMucHVzaChuZXcgUmVwbGF5RXZlbnQodGhpcy5fZ2V0Tm93KCksIHZhbHVlKSk7XG4gICAgICAgIHRoaXMuX3RyaW1CdWZmZXJUaGVuR2V0RXZlbnRzKCk7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUubmV4dC5jYWxsKHRoaXMsIHZhbHVlKTtcbiAgICB9O1xuICAgIFJlcGxheVN1YmplY3QucHJvdG90eXBlLl9zdWJzY3JpYmUgPSBmdW5jdGlvbiAoc3Vic2NyaWJlcikge1xuICAgICAgICB2YXIgX2luZmluaXRlVGltZVdpbmRvdyA9IHRoaXMuX2luZmluaXRlVGltZVdpbmRvdztcbiAgICAgICAgdmFyIF9ldmVudHMgPSBfaW5maW5pdGVUaW1lV2luZG93ID8gdGhpcy5fZXZlbnRzIDogdGhpcy5fdHJpbUJ1ZmZlclRoZW5HZXRFdmVudHMoKTtcbiAgICAgICAgdmFyIHNjaGVkdWxlciA9IHRoaXMuc2NoZWR1bGVyO1xuICAgICAgICB2YXIgbGVuID0gX2V2ZW50cy5sZW5ndGg7XG4gICAgICAgIHZhciBzdWJzY3JpcHRpb247XG4gICAgICAgIGlmICh0aGlzLmNsb3NlZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IE9iamVjdFVuc3Vic2NyaWJlZEVycm9yKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5pc1N0b3BwZWQgfHwgdGhpcy5oYXNFcnJvcikge1xuICAgICAgICAgICAgc3Vic2NyaXB0aW9uID0gU3Vic2NyaXB0aW9uLkVNUFRZO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5vYnNlcnZlcnMucHVzaChzdWJzY3JpYmVyKTtcbiAgICAgICAgICAgIHN1YnNjcmlwdGlvbiA9IG5ldyBTdWJqZWN0U3Vic2NyaXB0aW9uKHRoaXMsIHN1YnNjcmliZXIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzY2hlZHVsZXIpIHtcbiAgICAgICAgICAgIHN1YnNjcmliZXIuYWRkKHN1YnNjcmliZXIgPSBuZXcgT2JzZXJ2ZU9uU3Vic2NyaWJlcihzdWJzY3JpYmVyLCBzY2hlZHVsZXIpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoX2luZmluaXRlVGltZVdpbmRvdykge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW4gJiYgIXN1YnNjcmliZXIuY2xvc2VkOyBpKyspIHtcbiAgICAgICAgICAgICAgICBzdWJzY3JpYmVyLm5leHQoX2V2ZW50c1tpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbiAmJiAhc3Vic2NyaWJlci5jbG9zZWQ7IGkrKykge1xuICAgICAgICAgICAgICAgIHN1YnNjcmliZXIubmV4dChfZXZlbnRzW2ldLnZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5oYXNFcnJvcikge1xuICAgICAgICAgICAgc3Vic2NyaWJlci5lcnJvcih0aGlzLnRocm93bkVycm9yKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLmlzU3RvcHBlZCkge1xuICAgICAgICAgICAgc3Vic2NyaWJlci5jb21wbGV0ZSgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzdWJzY3JpcHRpb247XG4gICAgfTtcbiAgICBSZXBsYXlTdWJqZWN0LnByb3RvdHlwZS5fZ2V0Tm93ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKHRoaXMuc2NoZWR1bGVyIHx8IHF1ZXVlKS5ub3coKTtcbiAgICB9O1xuICAgIFJlcGxheVN1YmplY3QucHJvdG90eXBlLl90cmltQnVmZmVyVGhlbkdldEV2ZW50cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG5vdyA9IHRoaXMuX2dldE5vdygpO1xuICAgICAgICB2YXIgX2J1ZmZlclNpemUgPSB0aGlzLl9idWZmZXJTaXplO1xuICAgICAgICB2YXIgX3dpbmRvd1RpbWUgPSB0aGlzLl93aW5kb3dUaW1lO1xuICAgICAgICB2YXIgX2V2ZW50cyA9IHRoaXMuX2V2ZW50cztcbiAgICAgICAgdmFyIGV2ZW50c0NvdW50ID0gX2V2ZW50cy5sZW5ndGg7XG4gICAgICAgIHZhciBzcGxpY2VDb3VudCA9IDA7XG4gICAgICAgIHdoaWxlIChzcGxpY2VDb3VudCA8IGV2ZW50c0NvdW50KSB7XG4gICAgICAgICAgICBpZiAoKG5vdyAtIF9ldmVudHNbc3BsaWNlQ291bnRdLnRpbWUpIDwgX3dpbmRvd1RpbWUpIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNwbGljZUNvdW50Kys7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGV2ZW50c0NvdW50ID4gX2J1ZmZlclNpemUpIHtcbiAgICAgICAgICAgIHNwbGljZUNvdW50ID0gTWF0aC5tYXgoc3BsaWNlQ291bnQsIGV2ZW50c0NvdW50IC0gX2J1ZmZlclNpemUpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzcGxpY2VDb3VudCA+IDApIHtcbiAgICAgICAgICAgIF9ldmVudHMuc3BsaWNlKDAsIHNwbGljZUNvdW50KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX2V2ZW50cztcbiAgICB9O1xuICAgIHJldHVybiBSZXBsYXlTdWJqZWN0O1xufShTdWJqZWN0KSk7XG5leHBvcnQgeyBSZXBsYXlTdWJqZWN0IH07XG52YXIgUmVwbGF5RXZlbnQgPSAvKkBfX1BVUkVfXyovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gUmVwbGF5RXZlbnQodGltZSwgdmFsdWUpIHtcbiAgICAgICAgdGhpcy50aW1lID0gdGltZTtcbiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgIH1cbiAgICByZXR1cm4gUmVwbGF5RXZlbnQ7XG59KCkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9UmVwbGF5U3ViamVjdC5qcy5tYXBcbiIsInZhciBTY2hlZHVsZXIgPSAvKkBfX1BVUkVfXyovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gU2NoZWR1bGVyKFNjaGVkdWxlckFjdGlvbiwgbm93KSB7XG4gICAgICAgIGlmIChub3cgPT09IHZvaWQgMCkge1xuICAgICAgICAgICAgbm93ID0gU2NoZWR1bGVyLm5vdztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLlNjaGVkdWxlckFjdGlvbiA9IFNjaGVkdWxlckFjdGlvbjtcbiAgICAgICAgdGhpcy5ub3cgPSBub3c7XG4gICAgfVxuICAgIFNjaGVkdWxlci5wcm90b3R5cGUuc2NoZWR1bGUgPSBmdW5jdGlvbiAod29yaywgZGVsYXksIHN0YXRlKSB7XG4gICAgICAgIGlmIChkZWxheSA9PT0gdm9pZCAwKSB7XG4gICAgICAgICAgICBkZWxheSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyB0aGlzLlNjaGVkdWxlckFjdGlvbih0aGlzLCB3b3JrKS5zY2hlZHVsZShzdGF0ZSwgZGVsYXkpO1xuICAgIH07XG4gICAgU2NoZWR1bGVyLm5vdyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIERhdGUubm93KCk7IH07XG4gICAgcmV0dXJuIFNjaGVkdWxlcjtcbn0oKSk7XG5leHBvcnQgeyBTY2hlZHVsZXIgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVNjaGVkdWxlci5qcy5tYXBcbiIsIi8qKiBQVVJFX0lNUE9SVFNfU1RBUlQgdHNsaWIsX09ic2VydmFibGUsX1N1YnNjcmliZXIsX1N1YnNjcmlwdGlvbixfdXRpbF9PYmplY3RVbnN1YnNjcmliZWRFcnJvcixfU3ViamVjdFN1YnNjcmlwdGlvbixfaW50ZXJuYWxfc3ltYm9sX3J4U3Vic2NyaWJlciBQVVJFX0lNUE9SVFNfRU5EICovXG5pbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xuaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJy4vT2JzZXJ2YWJsZSc7XG5pbXBvcnQgeyBTdWJzY3JpYmVyIH0gZnJvbSAnLi9TdWJzY3JpYmVyJztcbmltcG9ydCB7IFN1YnNjcmlwdGlvbiB9IGZyb20gJy4vU3Vic2NyaXB0aW9uJztcbmltcG9ydCB7IE9iamVjdFVuc3Vic2NyaWJlZEVycm9yIH0gZnJvbSAnLi91dGlsL09iamVjdFVuc3Vic2NyaWJlZEVycm9yJztcbmltcG9ydCB7IFN1YmplY3RTdWJzY3JpcHRpb24gfSBmcm9tICcuL1N1YmplY3RTdWJzY3JpcHRpb24nO1xuaW1wb3J0IHsgcnhTdWJzY3JpYmVyIGFzIHJ4U3Vic2NyaWJlclN5bWJvbCB9IGZyb20gJy4uL2ludGVybmFsL3N5bWJvbC9yeFN1YnNjcmliZXInO1xudmFyIFN1YmplY3RTdWJzY3JpYmVyID0gLypAX19QVVJFX18qLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHRzbGliXzEuX19leHRlbmRzKFN1YmplY3RTdWJzY3JpYmVyLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN1YmplY3RTdWJzY3JpYmVyKGRlc3RpbmF0aW9uKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGRlc3RpbmF0aW9uKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5kZXN0aW5hdGlvbiA9IGRlc3RpbmF0aW9uO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIHJldHVybiBTdWJqZWN0U3Vic2NyaWJlcjtcbn0oU3Vic2NyaWJlcikpO1xuZXhwb3J0IHsgU3ViamVjdFN1YnNjcmliZXIgfTtcbnZhciBTdWJqZWN0ID0gLypAX19QVVJFX18qLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHRzbGliXzEuX19leHRlbmRzKFN1YmplY3QsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3ViamVjdCgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMub2JzZXJ2ZXJzID0gW107XG4gICAgICAgIF90aGlzLmNsb3NlZCA9IGZhbHNlO1xuICAgICAgICBfdGhpcy5pc1N0b3BwZWQgPSBmYWxzZTtcbiAgICAgICAgX3RoaXMuaGFzRXJyb3IgPSBmYWxzZTtcbiAgICAgICAgX3RoaXMudGhyb3duRXJyb3IgPSBudWxsO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIFN1YmplY3QucHJvdG90eXBlW3J4U3Vic2NyaWJlclN5bWJvbF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBuZXcgU3ViamVjdFN1YnNjcmliZXIodGhpcyk7XG4gICAgfTtcbiAgICBTdWJqZWN0LnByb3RvdHlwZS5saWZ0ID0gZnVuY3Rpb24gKG9wZXJhdG9yKSB7XG4gICAgICAgIHZhciBzdWJqZWN0ID0gbmV3IEFub255bW91c1N1YmplY3QodGhpcywgdGhpcyk7XG4gICAgICAgIHN1YmplY3Qub3BlcmF0b3IgPSBvcGVyYXRvcjtcbiAgICAgICAgcmV0dXJuIHN1YmplY3Q7XG4gICAgfTtcbiAgICBTdWJqZWN0LnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLmNsb3NlZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IE9iamVjdFVuc3Vic2NyaWJlZEVycm9yKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuICAgICAgICAgICAgdmFyIG9ic2VydmVycyA9IHRoaXMub2JzZXJ2ZXJzO1xuICAgICAgICAgICAgdmFyIGxlbiA9IG9ic2VydmVycy5sZW5ndGg7XG4gICAgICAgICAgICB2YXIgY29weSA9IG9ic2VydmVycy5zbGljZSgpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgICAgIGNvcHlbaV0ubmV4dCh2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFN1YmplY3QucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGVycikge1xuICAgICAgICBpZiAodGhpcy5jbG9zZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBPYmplY3RVbnN1YnNjcmliZWRFcnJvcigpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaGFzRXJyb3IgPSB0cnVlO1xuICAgICAgICB0aGlzLnRocm93bkVycm9yID0gZXJyO1xuICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICAgIHZhciBvYnNlcnZlcnMgPSB0aGlzLm9ic2VydmVycztcbiAgICAgICAgdmFyIGxlbiA9IG9ic2VydmVycy5sZW5ndGg7XG4gICAgICAgIHZhciBjb3B5ID0gb2JzZXJ2ZXJzLnNsaWNlKCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIGNvcHlbaV0uZXJyb3IoZXJyKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm9ic2VydmVycy5sZW5ndGggPSAwO1xuICAgIH07XG4gICAgU3ViamVjdC5wcm90b3R5cGUuY29tcGxldGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmNsb3NlZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IE9iamVjdFVuc3Vic2NyaWJlZEVycm9yKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgICB2YXIgb2JzZXJ2ZXJzID0gdGhpcy5vYnNlcnZlcnM7XG4gICAgICAgIHZhciBsZW4gPSBvYnNlcnZlcnMubGVuZ3RoO1xuICAgICAgICB2YXIgY29weSA9IG9ic2VydmVycy5zbGljZSgpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICBjb3B5W2ldLmNvbXBsZXRlKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5vYnNlcnZlcnMubGVuZ3RoID0gMDtcbiAgICB9O1xuICAgIFN1YmplY3QucHJvdG90eXBlLnVuc3Vic2NyaWJlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICAgIHRoaXMuY2xvc2VkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5vYnNlcnZlcnMgPSBudWxsO1xuICAgIH07XG4gICAgU3ViamVjdC5wcm90b3R5cGUuX3RyeVN1YnNjcmliZSA9IGZ1bmN0aW9uIChzdWJzY3JpYmVyKSB7XG4gICAgICAgIGlmICh0aGlzLmNsb3NlZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IE9iamVjdFVuc3Vic2NyaWJlZEVycm9yKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gX3N1cGVyLnByb3RvdHlwZS5fdHJ5U3Vic2NyaWJlLmNhbGwodGhpcywgc3Vic2NyaWJlcik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFN1YmplY3QucHJvdG90eXBlLl9zdWJzY3JpYmUgPSBmdW5jdGlvbiAoc3Vic2NyaWJlcikge1xuICAgICAgICBpZiAodGhpcy5jbG9zZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBPYmplY3RVbnN1YnNjcmliZWRFcnJvcigpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuaGFzRXJyb3IpIHtcbiAgICAgICAgICAgIHN1YnNjcmliZXIuZXJyb3IodGhpcy50aHJvd25FcnJvcik7XG4gICAgICAgICAgICByZXR1cm4gU3Vic2NyaXB0aW9uLkVNUFRZO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuaXNTdG9wcGVkKSB7XG4gICAgICAgICAgICBzdWJzY3JpYmVyLmNvbXBsZXRlKCk7XG4gICAgICAgICAgICByZXR1cm4gU3Vic2NyaXB0aW9uLkVNUFRZO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5vYnNlcnZlcnMucHVzaChzdWJzY3JpYmVyKTtcbiAgICAgICAgICAgIHJldHVybiBuZXcgU3ViamVjdFN1YnNjcmlwdGlvbih0aGlzLCBzdWJzY3JpYmVyKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU3ViamVjdC5wcm90b3R5cGUuYXNPYnNlcnZhYmxlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgb2JzZXJ2YWJsZSA9IG5ldyBPYnNlcnZhYmxlKCk7XG4gICAgICAgIG9ic2VydmFibGUuc291cmNlID0gdGhpcztcbiAgICAgICAgcmV0dXJuIG9ic2VydmFibGU7XG4gICAgfTtcbiAgICBTdWJqZWN0LmNyZWF0ZSA9IGZ1bmN0aW9uIChkZXN0aW5hdGlvbiwgc291cmNlKSB7XG4gICAgICAgIHJldHVybiBuZXcgQW5vbnltb3VzU3ViamVjdChkZXN0aW5hdGlvbiwgc291cmNlKTtcbiAgICB9O1xuICAgIHJldHVybiBTdWJqZWN0O1xufShPYnNlcnZhYmxlKSk7XG5leHBvcnQgeyBTdWJqZWN0IH07XG52YXIgQW5vbnltb3VzU3ViamVjdCA9IC8qQF9fUFVSRV9fKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhBbm9ueW1vdXNTdWJqZWN0LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEFub255bW91c1N1YmplY3QoZGVzdGluYXRpb24sIHNvdXJjZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5kZXN0aW5hdGlvbiA9IGRlc3RpbmF0aW9uO1xuICAgICAgICBfdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgQW5vbnltb3VzU3ViamVjdC5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgZGVzdGluYXRpb24gPSB0aGlzLmRlc3RpbmF0aW9uO1xuICAgICAgICBpZiAoZGVzdGluYXRpb24gJiYgZGVzdGluYXRpb24ubmV4dCkge1xuICAgICAgICAgICAgZGVzdGluYXRpb24ubmV4dCh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEFub255bW91c1N1YmplY3QucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGVycikge1xuICAgICAgICB2YXIgZGVzdGluYXRpb24gPSB0aGlzLmRlc3RpbmF0aW9uO1xuICAgICAgICBpZiAoZGVzdGluYXRpb24gJiYgZGVzdGluYXRpb24uZXJyb3IpIHtcbiAgICAgICAgICAgIHRoaXMuZGVzdGluYXRpb24uZXJyb3IoZXJyKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQW5vbnltb3VzU3ViamVjdC5wcm90b3R5cGUuY29tcGxldGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBkZXN0aW5hdGlvbiA9IHRoaXMuZGVzdGluYXRpb247XG4gICAgICAgIGlmIChkZXN0aW5hdGlvbiAmJiBkZXN0aW5hdGlvbi5jb21wbGV0ZSkge1xuICAgICAgICAgICAgdGhpcy5kZXN0aW5hdGlvbi5jb21wbGV0ZSgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBBbm9ueW1vdXNTdWJqZWN0LnByb3RvdHlwZS5fc3Vic2NyaWJlID0gZnVuY3Rpb24gKHN1YnNjcmliZXIpIHtcbiAgICAgICAgdmFyIHNvdXJjZSA9IHRoaXMuc291cmNlO1xuICAgICAgICBpZiAoc291cmNlKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKHN1YnNjcmliZXIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFN1YnNjcmlwdGlvbi5FTVBUWTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIEFub255bW91c1N1YmplY3Q7XG59KFN1YmplY3QpKTtcbmV4cG9ydCB7IEFub255bW91c1N1YmplY3QgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVN1YmplY3QuanMubWFwXG4iLCIvKiogUFVSRV9JTVBPUlRTX1NUQVJUIHRzbGliLF9TdWJzY3JpcHRpb24gUFVSRV9JTVBPUlRTX0VORCAqL1xuaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IFN1YnNjcmlwdGlvbiB9IGZyb20gJy4vU3Vic2NyaXB0aW9uJztcbnZhciBTdWJqZWN0U3Vic2NyaXB0aW9uID0gLypAX19QVVJFX18qLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHRzbGliXzEuX19leHRlbmRzKFN1YmplY3RTdWJzY3JpcHRpb24sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3ViamVjdFN1YnNjcmlwdGlvbihzdWJqZWN0LCBzdWJzY3JpYmVyKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLnN1YmplY3QgPSBzdWJqZWN0O1xuICAgICAgICBfdGhpcy5zdWJzY3JpYmVyID0gc3Vic2NyaWJlcjtcbiAgICAgICAgX3RoaXMuY2xvc2VkID0gZmFsc2U7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgU3ViamVjdFN1YnNjcmlwdGlvbi5wcm90b3R5cGUudW5zdWJzY3JpYmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmNsb3NlZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2xvc2VkID0gdHJ1ZTtcbiAgICAgICAgdmFyIHN1YmplY3QgPSB0aGlzLnN1YmplY3Q7XG4gICAgICAgIHZhciBvYnNlcnZlcnMgPSBzdWJqZWN0Lm9ic2VydmVycztcbiAgICAgICAgdGhpcy5zdWJqZWN0ID0gbnVsbDtcbiAgICAgICAgaWYgKCFvYnNlcnZlcnMgfHwgb2JzZXJ2ZXJzLmxlbmd0aCA9PT0gMCB8fCBzdWJqZWN0LmlzU3RvcHBlZCB8fCBzdWJqZWN0LmNsb3NlZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzdWJzY3JpYmVySW5kZXggPSBvYnNlcnZlcnMuaW5kZXhPZih0aGlzLnN1YnNjcmliZXIpO1xuICAgICAgICBpZiAoc3Vic2NyaWJlckluZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgb2JzZXJ2ZXJzLnNwbGljZShzdWJzY3JpYmVySW5kZXgsIDEpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gU3ViamVjdFN1YnNjcmlwdGlvbjtcbn0oU3Vic2NyaXB0aW9uKSk7XG5leHBvcnQgeyBTdWJqZWN0U3Vic2NyaXB0aW9uIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1TdWJqZWN0U3Vic2NyaXB0aW9uLmpzLm1hcFxuIiwiLyoqIFBVUkVfSU1QT1JUU19TVEFSVCB0c2xpYixfdXRpbF9pc0Z1bmN0aW9uLF9PYnNlcnZlcixfU3Vic2NyaXB0aW9uLF9pbnRlcm5hbF9zeW1ib2xfcnhTdWJzY3JpYmVyLF9jb25maWcsX3V0aWxfaG9zdFJlcG9ydEVycm9yIFBVUkVfSU1QT1JUU19FTkQgKi9cbmltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XG5pbXBvcnQgeyBpc0Z1bmN0aW9uIH0gZnJvbSAnLi91dGlsL2lzRnVuY3Rpb24nO1xuaW1wb3J0IHsgZW1wdHkgYXMgZW1wdHlPYnNlcnZlciB9IGZyb20gJy4vT2JzZXJ2ZXInO1xuaW1wb3J0IHsgU3Vic2NyaXB0aW9uIH0gZnJvbSAnLi9TdWJzY3JpcHRpb24nO1xuaW1wb3J0IHsgcnhTdWJzY3JpYmVyIGFzIHJ4U3Vic2NyaWJlclN5bWJvbCB9IGZyb20gJy4uL2ludGVybmFsL3N5bWJvbC9yeFN1YnNjcmliZXInO1xuaW1wb3J0IHsgY29uZmlnIH0gZnJvbSAnLi9jb25maWcnO1xuaW1wb3J0IHsgaG9zdFJlcG9ydEVycm9yIH0gZnJvbSAnLi91dGlsL2hvc3RSZXBvcnRFcnJvcic7XG52YXIgU3Vic2NyaWJlciA9IC8qQF9fUFVSRV9fKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhTdWJzY3JpYmVyLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN1YnNjcmliZXIoZGVzdGluYXRpb25Pck5leHQsIGVycm9yLCBjb21wbGV0ZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5zeW5jRXJyb3JWYWx1ZSA9IG51bGw7XG4gICAgICAgIF90aGlzLnN5bmNFcnJvclRocm93biA9IGZhbHNlO1xuICAgICAgICBfdGhpcy5zeW5jRXJyb3JUaHJvd2FibGUgPSBmYWxzZTtcbiAgICAgICAgX3RoaXMuaXNTdG9wcGVkID0gZmFsc2U7XG4gICAgICAgIF90aGlzLl9wYXJlbnRTdWJzY3JpcHRpb24gPSBudWxsO1xuICAgICAgICBzd2l0Y2ggKGFyZ3VtZW50cy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICBfdGhpcy5kZXN0aW5hdGlvbiA9IGVtcHR5T2JzZXJ2ZXI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgaWYgKCFkZXN0aW5hdGlvbk9yTmV4dCkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5kZXN0aW5hdGlvbiA9IGVtcHR5T2JzZXJ2ZXI7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGRlc3RpbmF0aW9uT3JOZXh0ID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGVzdGluYXRpb25Pck5leHQgaW5zdGFuY2VvZiBTdWJzY3JpYmVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5zeW5jRXJyb3JUaHJvd2FibGUgPSBkZXN0aW5hdGlvbk9yTmV4dC5zeW5jRXJyb3JUaHJvd2FibGU7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5kZXN0aW5hdGlvbiA9IGRlc3RpbmF0aW9uT3JOZXh0O1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVzdGluYXRpb25Pck5leHQuYWRkKF90aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnN5bmNFcnJvclRocm93YWJsZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5kZXN0aW5hdGlvbiA9IG5ldyBTYWZlU3Vic2NyaWJlcihfdGhpcywgZGVzdGluYXRpb25Pck5leHQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgX3RoaXMuc3luY0Vycm9yVGhyb3dhYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBfdGhpcy5kZXN0aW5hdGlvbiA9IG5ldyBTYWZlU3Vic2NyaWJlcihfdGhpcywgZGVzdGluYXRpb25Pck5leHQsIGVycm9yLCBjb21wbGV0ZSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBTdWJzY3JpYmVyLnByb3RvdHlwZVtyeFN1YnNjcmliZXJTeW1ib2xdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfTtcbiAgICBTdWJzY3JpYmVyLmNyZWF0ZSA9IGZ1bmN0aW9uIChuZXh0LCBlcnJvciwgY29tcGxldGUpIHtcbiAgICAgICAgdmFyIHN1YnNjcmliZXIgPSBuZXcgU3Vic2NyaWJlcihuZXh0LCBlcnJvciwgY29tcGxldGUpO1xuICAgICAgICBzdWJzY3JpYmVyLnN5bmNFcnJvclRocm93YWJsZSA9IGZhbHNlO1xuICAgICAgICByZXR1cm4gc3Vic2NyaWJlcjtcbiAgICB9O1xuICAgIFN1YnNjcmliZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuICAgICAgICAgICAgdGhpcy5fbmV4dCh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFN1YnNjcmliZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGVycikge1xuICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG4gICAgICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLl9lcnJvcihlcnIpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTdWJzY3JpYmVyLnByb3RvdHlwZS5jb21wbGV0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuICAgICAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5fY29tcGxldGUoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU3Vic2NyaWJlci5wcm90b3R5cGUudW5zdWJzY3JpYmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmNsb3NlZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS51bnN1YnNjcmliZS5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgU3Vic2NyaWJlci5wcm90b3R5cGUuX25leHQgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5kZXN0aW5hdGlvbi5uZXh0KHZhbHVlKTtcbiAgICB9O1xuICAgIFN1YnNjcmliZXIucHJvdG90eXBlLl9lcnJvciA9IGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgdGhpcy5kZXN0aW5hdGlvbi5lcnJvcihlcnIpO1xuICAgICAgICB0aGlzLnVuc3Vic2NyaWJlKCk7XG4gICAgfTtcbiAgICBTdWJzY3JpYmVyLnByb3RvdHlwZS5fY29tcGxldGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuZGVzdGluYXRpb24uY29tcGxldGUoKTtcbiAgICAgICAgdGhpcy51bnN1YnNjcmliZSgpO1xuICAgIH07XG4gICAgU3Vic2NyaWJlci5wcm90b3R5cGUuX3Vuc3Vic2NyaWJlQW5kUmVjeWNsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF9hID0gdGhpcywgX3BhcmVudCA9IF9hLl9wYXJlbnQsIF9wYXJlbnRzID0gX2EuX3BhcmVudHM7XG4gICAgICAgIHRoaXMuX3BhcmVudCA9IG51bGw7XG4gICAgICAgIHRoaXMuX3BhcmVudHMgPSBudWxsO1xuICAgICAgICB0aGlzLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgIHRoaXMuY2xvc2VkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuaXNTdG9wcGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX3BhcmVudCA9IF9wYXJlbnQ7XG4gICAgICAgIHRoaXMuX3BhcmVudHMgPSBfcGFyZW50cztcbiAgICAgICAgdGhpcy5fcGFyZW50U3Vic2NyaXB0aW9uID0gbnVsbDtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICByZXR1cm4gU3Vic2NyaWJlcjtcbn0oU3Vic2NyaXB0aW9uKSk7XG5leHBvcnQgeyBTdWJzY3JpYmVyIH07XG52YXIgU2FmZVN1YnNjcmliZXIgPSAvKkBfX1BVUkVfXyovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoU2FmZVN1YnNjcmliZXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU2FmZVN1YnNjcmliZXIoX3BhcmVudFN1YnNjcmliZXIsIG9ic2VydmVyT3JOZXh0LCBlcnJvciwgY29tcGxldGUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX3BhcmVudFN1YnNjcmliZXIgPSBfcGFyZW50U3Vic2NyaWJlcjtcbiAgICAgICAgdmFyIG5leHQ7XG4gICAgICAgIHZhciBjb250ZXh0ID0gX3RoaXM7XG4gICAgICAgIGlmIChpc0Z1bmN0aW9uKG9ic2VydmVyT3JOZXh0KSkge1xuICAgICAgICAgICAgbmV4dCA9IG9ic2VydmVyT3JOZXh0O1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKG9ic2VydmVyT3JOZXh0KSB7XG4gICAgICAgICAgICBuZXh0ID0gb2JzZXJ2ZXJPck5leHQubmV4dDtcbiAgICAgICAgICAgIGVycm9yID0gb2JzZXJ2ZXJPck5leHQuZXJyb3I7XG4gICAgICAgICAgICBjb21wbGV0ZSA9IG9ic2VydmVyT3JOZXh0LmNvbXBsZXRlO1xuICAgICAgICAgICAgaWYgKG9ic2VydmVyT3JOZXh0ICE9PSBlbXB0eU9ic2VydmVyKSB7XG4gICAgICAgICAgICAgICAgY29udGV4dCA9IE9iamVjdC5jcmVhdGUob2JzZXJ2ZXJPck5leHQpO1xuICAgICAgICAgICAgICAgIGlmIChpc0Z1bmN0aW9uKGNvbnRleHQudW5zdWJzY3JpYmUpKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmFkZChjb250ZXh0LnVuc3Vic2NyaWJlLmJpbmQoY29udGV4dCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb250ZXh0LnVuc3Vic2NyaWJlID0gX3RoaXMudW5zdWJzY3JpYmUuYmluZChfdGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgX3RoaXMuX2NvbnRleHQgPSBjb250ZXh0O1xuICAgICAgICBfdGhpcy5fbmV4dCA9IG5leHQ7XG4gICAgICAgIF90aGlzLl9lcnJvciA9IGVycm9yO1xuICAgICAgICBfdGhpcy5fY29tcGxldGUgPSBjb21wbGV0ZTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBTYWZlU3Vic2NyaWJlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkICYmIHRoaXMuX25leHQpIHtcbiAgICAgICAgICAgIHZhciBfcGFyZW50U3Vic2NyaWJlciA9IHRoaXMuX3BhcmVudFN1YnNjcmliZXI7XG4gICAgICAgICAgICBpZiAoIWNvbmZpZy51c2VEZXByZWNhdGVkU3luY2hyb25vdXNFcnJvckhhbmRsaW5nIHx8ICFfcGFyZW50U3Vic2NyaWJlci5zeW5jRXJyb3JUaHJvd2FibGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9fdHJ5T3JVbnN1Yih0aGlzLl9uZXh0LCB2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLl9fdHJ5T3JTZXRFcnJvcihfcGFyZW50U3Vic2NyaWJlciwgdGhpcy5fbmV4dCwgdmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy51bnN1YnNjcmliZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBTYWZlU3Vic2NyaWJlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgICAgIHZhciBfcGFyZW50U3Vic2NyaWJlciA9IHRoaXMuX3BhcmVudFN1YnNjcmliZXI7XG4gICAgICAgICAgICB2YXIgdXNlRGVwcmVjYXRlZFN5bmNocm9ub3VzRXJyb3JIYW5kbGluZyA9IGNvbmZpZy51c2VEZXByZWNhdGVkU3luY2hyb25vdXNFcnJvckhhbmRsaW5nO1xuICAgICAgICAgICAgaWYgKHRoaXMuX2Vycm9yKSB7XG4gICAgICAgICAgICAgICAgaWYgKCF1c2VEZXByZWNhdGVkU3luY2hyb25vdXNFcnJvckhhbmRsaW5nIHx8ICFfcGFyZW50U3Vic2NyaWJlci5zeW5jRXJyb3JUaHJvd2FibGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fX3RyeU9yVW5zdWIodGhpcy5fZXJyb3IsIGVycik7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudW5zdWJzY3JpYmUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX190cnlPclNldEVycm9yKF9wYXJlbnRTdWJzY3JpYmVyLCB0aGlzLl9lcnJvciwgZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51bnN1YnNjcmliZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKCFfcGFyZW50U3Vic2NyaWJlci5zeW5jRXJyb3JUaHJvd2FibGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgICAgICAgICAgaWYgKHVzZURlcHJlY2F0ZWRTeW5jaHJvbm91c0Vycm9ySGFuZGxpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBob3N0UmVwb3J0RXJyb3IoZXJyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmICh1c2VEZXByZWNhdGVkU3luY2hyb25vdXNFcnJvckhhbmRsaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgIF9wYXJlbnRTdWJzY3JpYmVyLnN5bmNFcnJvclZhbHVlID0gZXJyO1xuICAgICAgICAgICAgICAgICAgICBfcGFyZW50U3Vic2NyaWJlci5zeW5jRXJyb3JUaHJvd24gPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaG9zdFJlcG9ydEVycm9yKGVycik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMudW5zdWJzY3JpYmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgU2FmZVN1YnNjcmliZXIucHJvdG90eXBlLmNvbXBsZXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG4gICAgICAgICAgICB2YXIgX3BhcmVudFN1YnNjcmliZXIgPSB0aGlzLl9wYXJlbnRTdWJzY3JpYmVyO1xuICAgICAgICAgICAgaWYgKHRoaXMuX2NvbXBsZXRlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHdyYXBwZWRDb21wbGV0ZSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLl9jb21wbGV0ZS5jYWxsKF90aGlzLl9jb250ZXh0KTsgfTtcbiAgICAgICAgICAgICAgICBpZiAoIWNvbmZpZy51c2VEZXByZWNhdGVkU3luY2hyb25vdXNFcnJvckhhbmRsaW5nIHx8ICFfcGFyZW50U3Vic2NyaWJlci5zeW5jRXJyb3JUaHJvd2FibGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fX3RyeU9yVW5zdWIod3JhcHBlZENvbXBsZXRlKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51bnN1YnNjcmliZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fX3RyeU9yU2V0RXJyb3IoX3BhcmVudFN1YnNjcmliZXIsIHdyYXBwZWRDb21wbGV0ZSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudW5zdWJzY3JpYmUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNhZmVTdWJzY3JpYmVyLnByb3RvdHlwZS5fX3RyeU9yVW5zdWIgPSBmdW5jdGlvbiAoZm4sIHZhbHVlKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBmbi5jYWxsKHRoaXMuX2NvbnRleHQsIHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICB0aGlzLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgICAgICBpZiAoY29uZmlnLnVzZURlcHJlY2F0ZWRTeW5jaHJvbm91c0Vycm9ySGFuZGxpbmcpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBlcnI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBob3N0UmVwb3J0RXJyb3IoZXJyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgU2FmZVN1YnNjcmliZXIucHJvdG90eXBlLl9fdHJ5T3JTZXRFcnJvciA9IGZ1bmN0aW9uIChwYXJlbnQsIGZuLCB2YWx1ZSkge1xuICAgICAgICBpZiAoIWNvbmZpZy51c2VEZXByZWNhdGVkU3luY2hyb25vdXNFcnJvckhhbmRsaW5nKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2JhZCBjYWxsJyk7XG4gICAgICAgIH1cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGZuLmNhbGwodGhpcy5fY29udGV4dCwgdmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIGlmIChjb25maWcudXNlRGVwcmVjYXRlZFN5bmNocm9ub3VzRXJyb3JIYW5kbGluZykge1xuICAgICAgICAgICAgICAgIHBhcmVudC5zeW5jRXJyb3JWYWx1ZSA9IGVycjtcbiAgICAgICAgICAgICAgICBwYXJlbnQuc3luY0Vycm9yVGhyb3duID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGhvc3RSZXBvcnRFcnJvcihlcnIpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIFNhZmVTdWJzY3JpYmVyLnByb3RvdHlwZS5fdW5zdWJzY3JpYmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfcGFyZW50U3Vic2NyaWJlciA9IHRoaXMuX3BhcmVudFN1YnNjcmliZXI7XG4gICAgICAgIHRoaXMuX2NvbnRleHQgPSBudWxsO1xuICAgICAgICB0aGlzLl9wYXJlbnRTdWJzY3JpYmVyID0gbnVsbDtcbiAgICAgICAgX3BhcmVudFN1YnNjcmliZXIudW5zdWJzY3JpYmUoKTtcbiAgICB9O1xuICAgIHJldHVybiBTYWZlU3Vic2NyaWJlcjtcbn0oU3Vic2NyaWJlcikpO1xuZXhwb3J0IHsgU2FmZVN1YnNjcmliZXIgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVN1YnNjcmliZXIuanMubWFwXG4iLCIvKiogUFVSRV9JTVBPUlRTX1NUQVJUIF91dGlsX2lzQXJyYXksX3V0aWxfaXNPYmplY3QsX3V0aWxfaXNGdW5jdGlvbixfdXRpbF90cnlDYXRjaCxfdXRpbF9lcnJvck9iamVjdCxfdXRpbF9VbnN1YnNjcmlwdGlvbkVycm9yIFBVUkVfSU1QT1JUU19FTkQgKi9cbmltcG9ydCB7IGlzQXJyYXkgfSBmcm9tICcuL3V0aWwvaXNBcnJheSc7XG5pbXBvcnQgeyBpc09iamVjdCB9IGZyb20gJy4vdXRpbC9pc09iamVjdCc7XG5pbXBvcnQgeyBpc0Z1bmN0aW9uIH0gZnJvbSAnLi91dGlsL2lzRnVuY3Rpb24nO1xuaW1wb3J0IHsgdHJ5Q2F0Y2ggfSBmcm9tICcuL3V0aWwvdHJ5Q2F0Y2gnO1xuaW1wb3J0IHsgZXJyb3JPYmplY3QgfSBmcm9tICcuL3V0aWwvZXJyb3JPYmplY3QnO1xuaW1wb3J0IHsgVW5zdWJzY3JpcHRpb25FcnJvciB9IGZyb20gJy4vdXRpbC9VbnN1YnNjcmlwdGlvbkVycm9yJztcbnZhciBTdWJzY3JpcHRpb24gPSAvKkBfX1BVUkVfXyovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gU3Vic2NyaXB0aW9uKHVuc3Vic2NyaWJlKSB7XG4gICAgICAgIHRoaXMuY2xvc2VkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX3BhcmVudCA9IG51bGw7XG4gICAgICAgIHRoaXMuX3BhcmVudHMgPSBudWxsO1xuICAgICAgICB0aGlzLl9zdWJzY3JpcHRpb25zID0gbnVsbDtcbiAgICAgICAgaWYgKHVuc3Vic2NyaWJlKSB7XG4gICAgICAgICAgICB0aGlzLl91bnN1YnNjcmliZSA9IHVuc3Vic2NyaWJlO1xuICAgICAgICB9XG4gICAgfVxuICAgIFN1YnNjcmlwdGlvbi5wcm90b3R5cGUudW5zdWJzY3JpYmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBoYXNFcnJvcnMgPSBmYWxzZTtcbiAgICAgICAgdmFyIGVycm9ycztcbiAgICAgICAgaWYgKHRoaXMuY2xvc2VkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIF9hID0gdGhpcywgX3BhcmVudCA9IF9hLl9wYXJlbnQsIF9wYXJlbnRzID0gX2EuX3BhcmVudHMsIF91bnN1YnNjcmliZSA9IF9hLl91bnN1YnNjcmliZSwgX3N1YnNjcmlwdGlvbnMgPSBfYS5fc3Vic2NyaXB0aW9ucztcbiAgICAgICAgdGhpcy5jbG9zZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLl9wYXJlbnQgPSBudWxsO1xuICAgICAgICB0aGlzLl9wYXJlbnRzID0gbnVsbDtcbiAgICAgICAgdGhpcy5fc3Vic2NyaXB0aW9ucyA9IG51bGw7XG4gICAgICAgIHZhciBpbmRleCA9IC0xO1xuICAgICAgICB2YXIgbGVuID0gX3BhcmVudHMgPyBfcGFyZW50cy5sZW5ndGggOiAwO1xuICAgICAgICB3aGlsZSAoX3BhcmVudCkge1xuICAgICAgICAgICAgX3BhcmVudC5yZW1vdmUodGhpcyk7XG4gICAgICAgICAgICBfcGFyZW50ID0gKytpbmRleCA8IGxlbiAmJiBfcGFyZW50c1tpbmRleF0gfHwgbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXNGdW5jdGlvbihfdW5zdWJzY3JpYmUpKSB7XG4gICAgICAgICAgICB2YXIgdHJpYWwgPSB0cnlDYXRjaChfdW5zdWJzY3JpYmUpLmNhbGwodGhpcyk7XG4gICAgICAgICAgICBpZiAodHJpYWwgPT09IGVycm9yT2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgaGFzRXJyb3JzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBlcnJvcnMgPSBlcnJvcnMgfHwgKGVycm9yT2JqZWN0LmUgaW5zdGFuY2VvZiBVbnN1YnNjcmlwdGlvbkVycm9yID9cbiAgICAgICAgICAgICAgICAgICAgZmxhdHRlblVuc3Vic2NyaXB0aW9uRXJyb3JzKGVycm9yT2JqZWN0LmUuZXJyb3JzKSA6IFtlcnJvck9iamVjdC5lXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzQXJyYXkoX3N1YnNjcmlwdGlvbnMpKSB7XG4gICAgICAgICAgICBpbmRleCA9IC0xO1xuICAgICAgICAgICAgbGVuID0gX3N1YnNjcmlwdGlvbnMubGVuZ3RoO1xuICAgICAgICAgICAgd2hpbGUgKCsraW5kZXggPCBsZW4pIHtcbiAgICAgICAgICAgICAgICB2YXIgc3ViID0gX3N1YnNjcmlwdGlvbnNbaW5kZXhdO1xuICAgICAgICAgICAgICAgIGlmIChpc09iamVjdChzdWIpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0cmlhbCA9IHRyeUNhdGNoKHN1Yi51bnN1YnNjcmliZSkuY2FsbChzdWIpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodHJpYWwgPT09IGVycm9yT2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBoYXNFcnJvcnMgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JzID0gZXJyb3JzIHx8IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVyciA9IGVycm9yT2JqZWN0LmU7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXJyIGluc3RhbmNlb2YgVW5zdWJzY3JpcHRpb25FcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9ycyA9IGVycm9ycy5jb25jYXQoZmxhdHRlblVuc3Vic2NyaXB0aW9uRXJyb3JzKGVyci5lcnJvcnMpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9ycy5wdXNoKGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGhhc0Vycm9ycykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFVuc3Vic2NyaXB0aW9uRXJyb3IoZXJyb3JzKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU3Vic2NyaXB0aW9uLnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAodGVhcmRvd24pIHtcbiAgICAgICAgaWYgKCF0ZWFyZG93biB8fCAodGVhcmRvd24gPT09IFN1YnNjcmlwdGlvbi5FTVBUWSkpIHtcbiAgICAgICAgICAgIHJldHVybiBTdWJzY3JpcHRpb24uRU1QVFk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRlYXJkb3duID09PSB0aGlzKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgICAgICB2YXIgc3Vic2NyaXB0aW9uID0gdGVhcmRvd247XG4gICAgICAgIHN3aXRjaCAodHlwZW9mIHRlYXJkb3duKSB7XG4gICAgICAgICAgICBjYXNlICdmdW5jdGlvbic6XG4gICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9uID0gbmV3IFN1YnNjcmlwdGlvbih0ZWFyZG93bik7XG4gICAgICAgICAgICBjYXNlICdvYmplY3QnOlxuICAgICAgICAgICAgICAgIGlmIChzdWJzY3JpcHRpb24uY2xvc2VkIHx8IHR5cGVvZiBzdWJzY3JpcHRpb24udW5zdWJzY3JpYmUgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN1YnNjcmlwdGlvbjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5jbG9zZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzdWJzY3JpcHRpb247XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiBzdWJzY3JpcHRpb24uX2FkZFBhcmVudCAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdG1wID0gc3Vic2NyaXB0aW9uO1xuICAgICAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb24gPSBuZXcgU3Vic2NyaXB0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbi5fc3Vic2NyaXB0aW9ucyA9IFt0bXBdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCd1bnJlY29nbml6ZWQgdGVhcmRvd24gJyArIHRlYXJkb3duICsgJyBhZGRlZCB0byBTdWJzY3JpcHRpb24uJyk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHN1YnNjcmlwdGlvbnMgPSB0aGlzLl9zdWJzY3JpcHRpb25zIHx8ICh0aGlzLl9zdWJzY3JpcHRpb25zID0gW10pO1xuICAgICAgICBzdWJzY3JpcHRpb25zLnB1c2goc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgc3Vic2NyaXB0aW9uLl9hZGRQYXJlbnQodGhpcyk7XG4gICAgICAgIHJldHVybiBzdWJzY3JpcHRpb247XG4gICAgfTtcbiAgICBTdWJzY3JpcHRpb24ucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uIChzdWJzY3JpcHRpb24pIHtcbiAgICAgICAgdmFyIHN1YnNjcmlwdGlvbnMgPSB0aGlzLl9zdWJzY3JpcHRpb25zO1xuICAgICAgICBpZiAoc3Vic2NyaXB0aW9ucykge1xuICAgICAgICAgICAgdmFyIHN1YnNjcmlwdGlvbkluZGV4ID0gc3Vic2NyaXB0aW9ucy5pbmRleE9mKHN1YnNjcmlwdGlvbik7XG4gICAgICAgICAgICBpZiAoc3Vic2NyaXB0aW9uSW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9ucy5zcGxpY2Uoc3Vic2NyaXB0aW9uSW5kZXgsIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBTdWJzY3JpcHRpb24ucHJvdG90eXBlLl9hZGRQYXJlbnQgPSBmdW5jdGlvbiAocGFyZW50KSB7XG4gICAgICAgIHZhciBfYSA9IHRoaXMsIF9wYXJlbnQgPSBfYS5fcGFyZW50LCBfcGFyZW50cyA9IF9hLl9wYXJlbnRzO1xuICAgICAgICBpZiAoIV9wYXJlbnQgfHwgX3BhcmVudCA9PT0gcGFyZW50KSB7XG4gICAgICAgICAgICB0aGlzLl9wYXJlbnQgPSBwYXJlbnQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIV9wYXJlbnRzKSB7XG4gICAgICAgICAgICB0aGlzLl9wYXJlbnRzID0gW3BhcmVudF07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoX3BhcmVudHMuaW5kZXhPZihwYXJlbnQpID09PSAtMSkge1xuICAgICAgICAgICAgX3BhcmVudHMucHVzaChwYXJlbnQpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTdWJzY3JpcHRpb24uRU1QVFkgPSAoZnVuY3Rpb24gKGVtcHR5KSB7XG4gICAgICAgIGVtcHR5LmNsb3NlZCA9IHRydWU7XG4gICAgICAgIHJldHVybiBlbXB0eTtcbiAgICB9KG5ldyBTdWJzY3JpcHRpb24oKSkpO1xuICAgIHJldHVybiBTdWJzY3JpcHRpb247XG59KCkpO1xuZXhwb3J0IHsgU3Vic2NyaXB0aW9uIH07XG5mdW5jdGlvbiBmbGF0dGVuVW5zdWJzY3JpcHRpb25FcnJvcnMoZXJyb3JzKSB7XG4gICAgcmV0dXJuIGVycm9ycy5yZWR1Y2UoZnVuY3Rpb24gKGVycnMsIGVycikgeyByZXR1cm4gZXJycy5jb25jYXQoKGVyciBpbnN0YW5jZW9mIFVuc3Vic2NyaXB0aW9uRXJyb3IpID8gZXJyLmVycm9ycyA6IGVycik7IH0sIFtdKTtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVN1YnNjcmlwdGlvbi5qcy5tYXBcbiIsIi8qKiBQVVJFX0lNUE9SVFNfU1RBUlQgIFBVUkVfSU1QT1JUU19FTkQgKi9cbnZhciBfZW5hYmxlX3N1cGVyX2dyb3NzX21vZGVfdGhhdF93aWxsX2NhdXNlX2JhZF90aGluZ3MgPSBmYWxzZTtcbmV4cG9ydCB2YXIgY29uZmlnID0ge1xuICAgIFByb21pc2U6IHVuZGVmaW5lZCxcbiAgICBzZXQgdXNlRGVwcmVjYXRlZFN5bmNocm9ub3VzRXJyb3JIYW5kbGluZyh2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgIHZhciBlcnJvciA9IC8qQF9fUFVSRV9fKi8gbmV3IEVycm9yKCk7XG4gICAgICAgICAgICAvKkBfX1BVUkVfXyovIGNvbnNvbGUud2FybignREVQUkVDQVRFRCEgUnhKUyB3YXMgc2V0IHRvIHVzZSBkZXByZWNhdGVkIHN5bmNocm9ub3VzIGVycm9yIGhhbmRsaW5nIGJlaGF2aW9yIGJ5IGNvZGUgYXQ6IFxcbicgKyBlcnJvci5zdGFjayk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoX2VuYWJsZV9zdXBlcl9ncm9zc19tb2RlX3RoYXRfd2lsbF9jYXVzZV9iYWRfdGhpbmdzKSB7XG4gICAgICAgICAgICAvKkBfX1BVUkVfXyovIGNvbnNvbGUubG9nKCdSeEpTOiBCYWNrIHRvIGEgYmV0dGVyIGVycm9yIGJlaGF2aW9yLiBUaGFuayB5b3UuIDwzJyk7XG4gICAgICAgIH1cbiAgICAgICAgX2VuYWJsZV9zdXBlcl9ncm9zc19tb2RlX3RoYXRfd2lsbF9jYXVzZV9iYWRfdGhpbmdzID0gdmFsdWU7XG4gICAgfSxcbiAgICBnZXQgdXNlRGVwcmVjYXRlZFN5bmNocm9ub3VzRXJyb3JIYW5kbGluZygpIHtcbiAgICAgICAgcmV0dXJuIF9lbmFibGVfc3VwZXJfZ3Jvc3NfbW9kZV90aGF0X3dpbGxfY2F1c2VfYmFkX3RoaW5ncztcbiAgICB9LFxufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNvbmZpZy5qcy5tYXBcbiIsIi8qKiBQVVJFX0lNUE9SVFNfU1RBUlQgdHNsaWIsX1N1YmplY3QsX09ic2VydmFibGUsX1N1YnNjcmliZXIsX1N1YnNjcmlwdGlvbixfb3BlcmF0b3JzX3JlZkNvdW50IFBVUkVfSU1QT1JUU19FTkQgKi9cbmltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XG5pbXBvcnQgeyBTdWJqZWN0U3Vic2NyaWJlciB9IGZyb20gJy4uL1N1YmplY3QnO1xuaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJy4uL09ic2VydmFibGUnO1xuaW1wb3J0IHsgU3Vic2NyaWJlciB9IGZyb20gJy4uL1N1YnNjcmliZXInO1xuaW1wb3J0IHsgU3Vic2NyaXB0aW9uIH0gZnJvbSAnLi4vU3Vic2NyaXB0aW9uJztcbmltcG9ydCB7IHJlZkNvdW50IGFzIGhpZ2hlck9yZGVyUmVmQ291bnQgfSBmcm9tICcuLi9vcGVyYXRvcnMvcmVmQ291bnQnO1xudmFyIENvbm5lY3RhYmxlT2JzZXJ2YWJsZSA9IC8qQF9fUFVSRV9fKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhDb25uZWN0YWJsZU9ic2VydmFibGUsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQ29ubmVjdGFibGVPYnNlcnZhYmxlKHNvdXJjZSwgc3ViamVjdEZhY3RvcnkpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgICBfdGhpcy5zdWJqZWN0RmFjdG9yeSA9IHN1YmplY3RGYWN0b3J5O1xuICAgICAgICBfdGhpcy5fcmVmQ291bnQgPSAwO1xuICAgICAgICBfdGhpcy5faXNDb21wbGV0ZSA9IGZhbHNlO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIENvbm5lY3RhYmxlT2JzZXJ2YWJsZS5wcm90b3R5cGUuX3N1YnNjcmliZSA9IGZ1bmN0aW9uIChzdWJzY3JpYmVyKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFN1YmplY3QoKS5zdWJzY3JpYmUoc3Vic2NyaWJlcik7XG4gICAgfTtcbiAgICBDb25uZWN0YWJsZU9ic2VydmFibGUucHJvdG90eXBlLmdldFN1YmplY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzdWJqZWN0ID0gdGhpcy5fc3ViamVjdDtcbiAgICAgICAgaWYgKCFzdWJqZWN0IHx8IHN1YmplY3QuaXNTdG9wcGVkKSB7XG4gICAgICAgICAgICB0aGlzLl9zdWJqZWN0ID0gdGhpcy5zdWJqZWN0RmFjdG9yeSgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLl9zdWJqZWN0O1xuICAgIH07XG4gICAgQ29ubmVjdGFibGVPYnNlcnZhYmxlLnByb3RvdHlwZS5jb25uZWN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY29ubmVjdGlvbiA9IHRoaXMuX2Nvbm5lY3Rpb247XG4gICAgICAgIGlmICghY29ubmVjdGlvbikge1xuICAgICAgICAgICAgdGhpcy5faXNDb21wbGV0ZSA9IGZhbHNlO1xuICAgICAgICAgICAgY29ubmVjdGlvbiA9IHRoaXMuX2Nvbm5lY3Rpb24gPSBuZXcgU3Vic2NyaXB0aW9uKCk7XG4gICAgICAgICAgICBjb25uZWN0aW9uLmFkZCh0aGlzLnNvdXJjZVxuICAgICAgICAgICAgICAgIC5zdWJzY3JpYmUobmV3IENvbm5lY3RhYmxlU3Vic2NyaWJlcih0aGlzLmdldFN1YmplY3QoKSwgdGhpcykpKTtcbiAgICAgICAgICAgIGlmIChjb25uZWN0aW9uLmNsb3NlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2Nvbm5lY3Rpb24gPSBudWxsO1xuICAgICAgICAgICAgICAgIGNvbm5lY3Rpb24gPSBTdWJzY3JpcHRpb24uRU1QVFk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jb25uZWN0aW9uID0gY29ubmVjdGlvbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29ubmVjdGlvbjtcbiAgICB9O1xuICAgIENvbm5lY3RhYmxlT2JzZXJ2YWJsZS5wcm90b3R5cGUucmVmQ291bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBoaWdoZXJPcmRlclJlZkNvdW50KCkodGhpcyk7XG4gICAgfTtcbiAgICByZXR1cm4gQ29ubmVjdGFibGVPYnNlcnZhYmxlO1xufShPYnNlcnZhYmxlKSk7XG5leHBvcnQgeyBDb25uZWN0YWJsZU9ic2VydmFibGUgfTtcbnZhciBjb25uZWN0YWJsZVByb3RvID0gQ29ubmVjdGFibGVPYnNlcnZhYmxlLnByb3RvdHlwZTtcbmV4cG9ydCB2YXIgY29ubmVjdGFibGVPYnNlcnZhYmxlRGVzY3JpcHRvciA9IHtcbiAgICBvcGVyYXRvcjogeyB2YWx1ZTogbnVsbCB9LFxuICAgIF9yZWZDb3VudDogeyB2YWx1ZTogMCwgd3JpdGFibGU6IHRydWUgfSxcbiAgICBfc3ViamVjdDogeyB2YWx1ZTogbnVsbCwgd3JpdGFibGU6IHRydWUgfSxcbiAgICBfY29ubmVjdGlvbjogeyB2YWx1ZTogbnVsbCwgd3JpdGFibGU6IHRydWUgfSxcbiAgICBfc3Vic2NyaWJlOiB7IHZhbHVlOiBjb25uZWN0YWJsZVByb3RvLl9zdWJzY3JpYmUgfSxcbiAgICBfaXNDb21wbGV0ZTogeyB2YWx1ZTogY29ubmVjdGFibGVQcm90by5faXNDb21wbGV0ZSwgd3JpdGFibGU6IHRydWUgfSxcbiAgICBnZXRTdWJqZWN0OiB7IHZhbHVlOiBjb25uZWN0YWJsZVByb3RvLmdldFN1YmplY3QgfSxcbiAgICBjb25uZWN0OiB7IHZhbHVlOiBjb25uZWN0YWJsZVByb3RvLmNvbm5lY3QgfSxcbiAgICByZWZDb3VudDogeyB2YWx1ZTogY29ubmVjdGFibGVQcm90by5yZWZDb3VudCB9XG59O1xudmFyIENvbm5lY3RhYmxlU3Vic2NyaWJlciA9IC8qQF9fUFVSRV9fKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhDb25uZWN0YWJsZVN1YnNjcmliZXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQ29ubmVjdGFibGVTdWJzY3JpYmVyKGRlc3RpbmF0aW9uLCBjb25uZWN0YWJsZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBkZXN0aW5hdGlvbikgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuY29ubmVjdGFibGUgPSBjb25uZWN0YWJsZTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBDb25uZWN0YWJsZVN1YnNjcmliZXIucHJvdG90eXBlLl9lcnJvciA9IGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgdGhpcy5fdW5zdWJzY3JpYmUoKTtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fZXJyb3IuY2FsbCh0aGlzLCBlcnIpO1xuICAgIH07XG4gICAgQ29ubmVjdGFibGVTdWJzY3JpYmVyLnByb3RvdHlwZS5fY29tcGxldGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuY29ubmVjdGFibGUuX2lzQ29tcGxldGUgPSB0cnVlO1xuICAgICAgICB0aGlzLl91bnN1YnNjcmliZSgpO1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLl9jb21wbGV0ZS5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgQ29ubmVjdGFibGVTdWJzY3JpYmVyLnByb3RvdHlwZS5fdW5zdWJzY3JpYmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjb25uZWN0YWJsZSA9IHRoaXMuY29ubmVjdGFibGU7XG4gICAgICAgIGlmIChjb25uZWN0YWJsZSkge1xuICAgICAgICAgICAgdGhpcy5jb25uZWN0YWJsZSA9IG51bGw7XG4gICAgICAgICAgICB2YXIgY29ubmVjdGlvbiA9IGNvbm5lY3RhYmxlLl9jb25uZWN0aW9uO1xuICAgICAgICAgICAgY29ubmVjdGFibGUuX3JlZkNvdW50ID0gMDtcbiAgICAgICAgICAgIGNvbm5lY3RhYmxlLl9zdWJqZWN0ID0gbnVsbDtcbiAgICAgICAgICAgIGNvbm5lY3RhYmxlLl9jb25uZWN0aW9uID0gbnVsbDtcbiAgICAgICAgICAgIGlmIChjb25uZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgY29ubmVjdGlvbi51bnN1YnNjcmliZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gQ29ubmVjdGFibGVTdWJzY3JpYmVyO1xufShTdWJqZWN0U3Vic2NyaWJlcikpO1xudmFyIFJlZkNvdW50T3BlcmF0b3IgPSAvKkBfX1BVUkVfXyovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gUmVmQ291bnRPcGVyYXRvcihjb25uZWN0YWJsZSkge1xuICAgICAgICB0aGlzLmNvbm5lY3RhYmxlID0gY29ubmVjdGFibGU7XG4gICAgfVxuICAgIFJlZkNvdW50T3BlcmF0b3IucHJvdG90eXBlLmNhbGwgPSBmdW5jdGlvbiAoc3Vic2NyaWJlciwgc291cmNlKSB7XG4gICAgICAgIHZhciBjb25uZWN0YWJsZSA9IHRoaXMuY29ubmVjdGFibGU7XG4gICAgICAgIGNvbm5lY3RhYmxlLl9yZWZDb3VudCsrO1xuICAgICAgICB2YXIgcmVmQ291bnRlciA9IG5ldyBSZWZDb3VudFN1YnNjcmliZXIoc3Vic2NyaWJlciwgY29ubmVjdGFibGUpO1xuICAgICAgICB2YXIgc3Vic2NyaXB0aW9uID0gc291cmNlLnN1YnNjcmliZShyZWZDb3VudGVyKTtcbiAgICAgICAgaWYgKCFyZWZDb3VudGVyLmNsb3NlZCkge1xuICAgICAgICAgICAgcmVmQ291bnRlci5jb25uZWN0aW9uID0gY29ubmVjdGFibGUuY29ubmVjdCgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzdWJzY3JpcHRpb247XG4gICAgfTtcbiAgICByZXR1cm4gUmVmQ291bnRPcGVyYXRvcjtcbn0oKSk7XG52YXIgUmVmQ291bnRTdWJzY3JpYmVyID0gLypAX19QVVJFX18qLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHRzbGliXzEuX19leHRlbmRzKFJlZkNvdW50U3Vic2NyaWJlciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBSZWZDb3VudFN1YnNjcmliZXIoZGVzdGluYXRpb24sIGNvbm5lY3RhYmxlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGRlc3RpbmF0aW9uKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5jb25uZWN0YWJsZSA9IGNvbm5lY3RhYmxlO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIFJlZkNvdW50U3Vic2NyaWJlci5wcm90b3R5cGUuX3Vuc3Vic2NyaWJlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY29ubmVjdGFibGUgPSB0aGlzLmNvbm5lY3RhYmxlO1xuICAgICAgICBpZiAoIWNvbm5lY3RhYmxlKSB7XG4gICAgICAgICAgICB0aGlzLmNvbm5lY3Rpb24gPSBudWxsO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY29ubmVjdGFibGUgPSBudWxsO1xuICAgICAgICB2YXIgcmVmQ291bnQgPSBjb25uZWN0YWJsZS5fcmVmQ291bnQ7XG4gICAgICAgIGlmIChyZWZDb3VudCA8PSAwKSB7XG4gICAgICAgICAgICB0aGlzLmNvbm5lY3Rpb24gPSBudWxsO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbm5lY3RhYmxlLl9yZWZDb3VudCA9IHJlZkNvdW50IC0gMTtcbiAgICAgICAgaWYgKHJlZkNvdW50ID4gMSkge1xuICAgICAgICAgICAgdGhpcy5jb25uZWN0aW9uID0gbnVsbDtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY29ubmVjdGlvbiA9IHRoaXMuY29ubmVjdGlvbjtcbiAgICAgICAgdmFyIHNoYXJlZENvbm5lY3Rpb24gPSBjb25uZWN0YWJsZS5fY29ubmVjdGlvbjtcbiAgICAgICAgdGhpcy5jb25uZWN0aW9uID0gbnVsbDtcbiAgICAgICAgaWYgKHNoYXJlZENvbm5lY3Rpb24gJiYgKCFjb25uZWN0aW9uIHx8IHNoYXJlZENvbm5lY3Rpb24gPT09IGNvbm5lY3Rpb24pKSB7XG4gICAgICAgICAgICBzaGFyZWRDb25uZWN0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBSZWZDb3VudFN1YnNjcmliZXI7XG59KFN1YnNjcmliZXIpKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUNvbm5lY3RhYmxlT2JzZXJ2YWJsZS5qcy5tYXBcbiIsIi8qKiBQVVJFX0lNUE9SVFNfU1RBUlQgX09ic2VydmFibGUsX0FzeW5jU3ViamVjdCxfb3BlcmF0b3JzX21hcCxfdXRpbF9jYW5SZXBvcnRFcnJvcixfdXRpbF9pc0FycmF5LF91dGlsX2lzU2NoZWR1bGVyIFBVUkVfSU1QT1JUU19FTkQgKi9cbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICcuLi9PYnNlcnZhYmxlJztcbmltcG9ydCB7IEFzeW5jU3ViamVjdCB9IGZyb20gJy4uL0FzeW5jU3ViamVjdCc7XG5pbXBvcnQgeyBtYXAgfSBmcm9tICcuLi9vcGVyYXRvcnMvbWFwJztcbmltcG9ydCB7IGNhblJlcG9ydEVycm9yIH0gZnJvbSAnLi4vdXRpbC9jYW5SZXBvcnRFcnJvcic7XG5pbXBvcnQgeyBpc0FycmF5IH0gZnJvbSAnLi4vdXRpbC9pc0FycmF5JztcbmltcG9ydCB7IGlzU2NoZWR1bGVyIH0gZnJvbSAnLi4vdXRpbC9pc1NjaGVkdWxlcic7XG5leHBvcnQgZnVuY3Rpb24gYmluZENhbGxiYWNrKGNhbGxiYWNrRnVuYywgcmVzdWx0U2VsZWN0b3IsIHNjaGVkdWxlcikge1xuICAgIGlmIChyZXN1bHRTZWxlY3Rvcikge1xuICAgICAgICBpZiAoaXNTY2hlZHVsZXIocmVzdWx0U2VsZWN0b3IpKSB7XG4gICAgICAgICAgICBzY2hlZHVsZXIgPSByZXN1bHRTZWxlY3RvcjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBiaW5kQ2FsbGJhY2soY2FsbGJhY2tGdW5jLCBzY2hlZHVsZXIpLmFwcGx5KHZvaWQgMCwgYXJncykucGlwZShtYXAoZnVuY3Rpb24gKGFyZ3MpIHsgcmV0dXJuIGlzQXJyYXkoYXJncykgPyByZXN1bHRTZWxlY3Rvci5hcHBseSh2b2lkIDAsIGFyZ3MpIDogcmVzdWx0U2VsZWN0b3IoYXJncyk7IH0pKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY29udGV4dCA9IHRoaXM7XG4gICAgICAgIHZhciBzdWJqZWN0O1xuICAgICAgICB2YXIgcGFyYW1zID0ge1xuICAgICAgICAgICAgY29udGV4dDogY29udGV4dCxcbiAgICAgICAgICAgIHN1YmplY3Q6IHN1YmplY3QsXG4gICAgICAgICAgICBjYWxsYmFja0Z1bmM6IGNhbGxiYWNrRnVuYyxcbiAgICAgICAgICAgIHNjaGVkdWxlcjogc2NoZWR1bGVyLFxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gbmV3IE9ic2VydmFibGUoZnVuY3Rpb24gKHN1YnNjcmliZXIpIHtcbiAgICAgICAgICAgIGlmICghc2NoZWR1bGVyKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFzdWJqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YmplY3QgPSBuZXcgQXN5bmNTdWJqZWN0KCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBoYW5kbGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlubmVyQXJncyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbm5lckFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHN1YmplY3QubmV4dChpbm5lckFyZ3MubGVuZ3RoIDw9IDEgPyBpbm5lckFyZ3NbMF0gOiBpbm5lckFyZ3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3ViamVjdC5jb21wbGV0ZSgpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2tGdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MuY29uY2F0KFtoYW5kbGVyXSkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjYW5SZXBvcnRFcnJvcihzdWJqZWN0KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YmplY3QuZXJyb3IoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBzdWJqZWN0LnN1YnNjcmliZShzdWJzY3JpYmVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBzdGF0ZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgYXJnczogYXJncywgc3Vic2NyaWJlcjogc3Vic2NyaWJlciwgcGFyYW1zOiBwYXJhbXMsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2NoZWR1bGVyLnNjaGVkdWxlKGRpc3BhdGNoLCAwLCBzdGF0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG59XG5mdW5jdGlvbiBkaXNwYXRjaChzdGF0ZSkge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHZhciBhcmdzID0gc3RhdGUuYXJncywgc3Vic2NyaWJlciA9IHN0YXRlLnN1YnNjcmliZXIsIHBhcmFtcyA9IHN0YXRlLnBhcmFtcztcbiAgICB2YXIgY2FsbGJhY2tGdW5jID0gcGFyYW1zLmNhbGxiYWNrRnVuYywgY29udGV4dCA9IHBhcmFtcy5jb250ZXh0LCBzY2hlZHVsZXIgPSBwYXJhbXMuc2NoZWR1bGVyO1xuICAgIHZhciBzdWJqZWN0ID0gcGFyYW1zLnN1YmplY3Q7XG4gICAgaWYgKCFzdWJqZWN0KSB7XG4gICAgICAgIHN1YmplY3QgPSBwYXJhbXMuc3ViamVjdCA9IG5ldyBBc3luY1N1YmplY3QoKTtcbiAgICAgICAgdmFyIGhhbmRsZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgaW5uZXJBcmdzID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIGlubmVyQXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHZhbHVlID0gaW5uZXJBcmdzLmxlbmd0aCA8PSAxID8gaW5uZXJBcmdzWzBdIDogaW5uZXJBcmdzO1xuICAgICAgICAgICAgX3RoaXMuYWRkKHNjaGVkdWxlci5zY2hlZHVsZShkaXNwYXRjaE5leHQsIDAsIHsgdmFsdWU6IHZhbHVlLCBzdWJqZWN0OiBzdWJqZWN0IH0pKTtcbiAgICAgICAgfTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNhbGxiYWNrRnVuYy5hcHBseShjb250ZXh0LCBhcmdzLmNvbmNhdChbaGFuZGxlcl0pKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICBzdWJqZWN0LmVycm9yKGVycik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdGhpcy5hZGQoc3ViamVjdC5zdWJzY3JpYmUoc3Vic2NyaWJlcikpO1xufVxuZnVuY3Rpb24gZGlzcGF0Y2hOZXh0KHN0YXRlKSB7XG4gICAgdmFyIHZhbHVlID0gc3RhdGUudmFsdWUsIHN1YmplY3QgPSBzdGF0ZS5zdWJqZWN0O1xuICAgIHN1YmplY3QubmV4dCh2YWx1ZSk7XG4gICAgc3ViamVjdC5jb21wbGV0ZSgpO1xufVxuZnVuY3Rpb24gZGlzcGF0Y2hFcnJvcihzdGF0ZSkge1xuICAgIHZhciBlcnIgPSBzdGF0ZS5lcnIsIHN1YmplY3QgPSBzdGF0ZS5zdWJqZWN0O1xuICAgIHN1YmplY3QuZXJyb3IoZXJyKTtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJpbmRDYWxsYmFjay5qcy5tYXBcbiIsIi8qKiBQVVJFX0lNUE9SVFNfU1RBUlQgX09ic2VydmFibGUsX0FzeW5jU3ViamVjdCxfb3BlcmF0b3JzX21hcCxfdXRpbF9jYW5SZXBvcnRFcnJvcixfdXRpbF9pc1NjaGVkdWxlcixfdXRpbF9pc0FycmF5IFBVUkVfSU1QT1JUU19FTkQgKi9cbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICcuLi9PYnNlcnZhYmxlJztcbmltcG9ydCB7IEFzeW5jU3ViamVjdCB9IGZyb20gJy4uL0FzeW5jU3ViamVjdCc7XG5pbXBvcnQgeyBtYXAgfSBmcm9tICcuLi9vcGVyYXRvcnMvbWFwJztcbmltcG9ydCB7IGNhblJlcG9ydEVycm9yIH0gZnJvbSAnLi4vdXRpbC9jYW5SZXBvcnRFcnJvcic7XG5pbXBvcnQgeyBpc1NjaGVkdWxlciB9IGZyb20gJy4uL3V0aWwvaXNTY2hlZHVsZXInO1xuaW1wb3J0IHsgaXNBcnJheSB9IGZyb20gJy4uL3V0aWwvaXNBcnJheSc7XG5leHBvcnQgZnVuY3Rpb24gYmluZE5vZGVDYWxsYmFjayhjYWxsYmFja0Z1bmMsIHJlc3VsdFNlbGVjdG9yLCBzY2hlZHVsZXIpIHtcbiAgICBpZiAocmVzdWx0U2VsZWN0b3IpIHtcbiAgICAgICAgaWYgKGlzU2NoZWR1bGVyKHJlc3VsdFNlbGVjdG9yKSkge1xuICAgICAgICAgICAgc2NoZWR1bGVyID0gcmVzdWx0U2VsZWN0b3I7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gYmluZE5vZGVDYWxsYmFjayhjYWxsYmFja0Z1bmMsIHNjaGVkdWxlcikuYXBwbHkodm9pZCAwLCBhcmdzKS5waXBlKG1hcChmdW5jdGlvbiAoYXJncykgeyByZXR1cm4gaXNBcnJheShhcmdzKSA/IHJlc3VsdFNlbGVjdG9yLmFwcGx5KHZvaWQgMCwgYXJncykgOiByZXN1bHRTZWxlY3RvcihhcmdzKTsgfSkpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHZhciBwYXJhbXMgPSB7XG4gICAgICAgICAgICBzdWJqZWN0OiB1bmRlZmluZWQsXG4gICAgICAgICAgICBhcmdzOiBhcmdzLFxuICAgICAgICAgICAgY2FsbGJhY2tGdW5jOiBjYWxsYmFja0Z1bmMsXG4gICAgICAgICAgICBzY2hlZHVsZXI6IHNjaGVkdWxlcixcbiAgICAgICAgICAgIGNvbnRleHQ6IHRoaXMsXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBuZXcgT2JzZXJ2YWJsZShmdW5jdGlvbiAoc3Vic2NyaWJlcikge1xuICAgICAgICAgICAgdmFyIGNvbnRleHQgPSBwYXJhbXMuY29udGV4dDtcbiAgICAgICAgICAgIHZhciBzdWJqZWN0ID0gcGFyYW1zLnN1YmplY3Q7XG4gICAgICAgICAgICBpZiAoIXNjaGVkdWxlcikge1xuICAgICAgICAgICAgICAgIGlmICghc3ViamVjdCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJqZWN0ID0gcGFyYW1zLnN1YmplY3QgPSBuZXcgQXN5bmNTdWJqZWN0KCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBoYW5kbGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlubmVyQXJncyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbm5lckFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlcnIgPSBpbm5lckFyZ3Muc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJqZWN0LmVycm9yKGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgc3ViamVjdC5uZXh0KGlubmVyQXJncy5sZW5ndGggPD0gMSA/IGlubmVyQXJnc1swXSA6IGlubmVyQXJncyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWJqZWN0LmNvbXBsZXRlKCk7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFja0Z1bmMuYXBwbHkoY29udGV4dCwgYXJncy5jb25jYXQoW2hhbmRsZXJdKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNhblJlcG9ydEVycm9yKHN1YmplY3QpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViamVjdC5lcnJvcihlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1YmplY3Quc3Vic2NyaWJlKHN1YnNjcmliZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNjaGVkdWxlci5zY2hlZHVsZShkaXNwYXRjaCwgMCwgeyBwYXJhbXM6IHBhcmFtcywgc3Vic2NyaWJlcjogc3Vic2NyaWJlciwgY29udGV4dDogY29udGV4dCB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbn1cbmZ1bmN0aW9uIGRpc3BhdGNoKHN0YXRlKSB7XG4gICAgdmFyIF90aGlzID0gdGhpcztcbiAgICB2YXIgcGFyYW1zID0gc3RhdGUucGFyYW1zLCBzdWJzY3JpYmVyID0gc3RhdGUuc3Vic2NyaWJlciwgY29udGV4dCA9IHN0YXRlLmNvbnRleHQ7XG4gICAgdmFyIGNhbGxiYWNrRnVuYyA9IHBhcmFtcy5jYWxsYmFja0Z1bmMsIGFyZ3MgPSBwYXJhbXMuYXJncywgc2NoZWR1bGVyID0gcGFyYW1zLnNjaGVkdWxlcjtcbiAgICB2YXIgc3ViamVjdCA9IHBhcmFtcy5zdWJqZWN0O1xuICAgIGlmICghc3ViamVjdCkge1xuICAgICAgICBzdWJqZWN0ID0gcGFyYW1zLnN1YmplY3QgPSBuZXcgQXN5bmNTdWJqZWN0KCk7XG4gICAgICAgIHZhciBoYW5kbGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGlubmVyQXJncyA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICBpbm5lckFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBlcnIgPSBpbm5lckFyZ3Muc2hpZnQoKTtcbiAgICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5hZGQoc2NoZWR1bGVyLnNjaGVkdWxlKGRpc3BhdGNoRXJyb3IsIDAsIHsgZXJyOiBlcnIsIHN1YmplY3Q6IHN1YmplY3QgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gaW5uZXJBcmdzLmxlbmd0aCA8PSAxID8gaW5uZXJBcmdzWzBdIDogaW5uZXJBcmdzO1xuICAgICAgICAgICAgICAgIF90aGlzLmFkZChzY2hlZHVsZXIuc2NoZWR1bGUoZGlzcGF0Y2hOZXh0LCAwLCB7IHZhbHVlOiB2YWx1ZSwgc3ViamVjdDogc3ViamVjdCB9KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjYWxsYmFja0Z1bmMuYXBwbHkoY29udGV4dCwgYXJncy5jb25jYXQoW2hhbmRsZXJdKSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgdGhpcy5hZGQoc2NoZWR1bGVyLnNjaGVkdWxlKGRpc3BhdGNoRXJyb3IsIDAsIHsgZXJyOiBlcnIsIHN1YmplY3Q6IHN1YmplY3QgfSkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRoaXMuYWRkKHN1YmplY3Quc3Vic2NyaWJlKHN1YnNjcmliZXIpKTtcbn1cbmZ1bmN0aW9uIGRpc3BhdGNoTmV4dChhcmcpIHtcbiAgICB2YXIgdmFsdWUgPSBhcmcudmFsdWUsIHN1YmplY3QgPSBhcmcuc3ViamVjdDtcbiAgICBzdWJqZWN0Lm5leHQodmFsdWUpO1xuICAgIHN1YmplY3QuY29tcGxldGUoKTtcbn1cbmZ1bmN0aW9uIGRpc3BhdGNoRXJyb3IoYXJnKSB7XG4gICAgdmFyIGVyciA9IGFyZy5lcnIsIHN1YmplY3QgPSBhcmcuc3ViamVjdDtcbiAgICBzdWJqZWN0LmVycm9yKGVycik7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1iaW5kTm9kZUNhbGxiYWNrLmpzLm1hcFxuIiwiLyoqIFBVUkVfSU1QT1JUU19TVEFSVCB0c2xpYixfdXRpbF9pc1NjaGVkdWxlcixfdXRpbF9pc0FycmF5LF9PdXRlclN1YnNjcmliZXIsX3V0aWxfc3Vic2NyaWJlVG9SZXN1bHQsX2Zyb21BcnJheSBQVVJFX0lNUE9SVFNfRU5EICovXG5pbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xuaW1wb3J0IHsgaXNTY2hlZHVsZXIgfSBmcm9tICcuLi91dGlsL2lzU2NoZWR1bGVyJztcbmltcG9ydCB7IGlzQXJyYXkgfSBmcm9tICcuLi91dGlsL2lzQXJyYXknO1xuaW1wb3J0IHsgT3V0ZXJTdWJzY3JpYmVyIH0gZnJvbSAnLi4vT3V0ZXJTdWJzY3JpYmVyJztcbmltcG9ydCB7IHN1YnNjcmliZVRvUmVzdWx0IH0gZnJvbSAnLi4vdXRpbC9zdWJzY3JpYmVUb1Jlc3VsdCc7XG5pbXBvcnQgeyBmcm9tQXJyYXkgfSBmcm9tICcuL2Zyb21BcnJheSc7XG52YXIgTk9ORSA9IHt9O1xuZXhwb3J0IGZ1bmN0aW9uIGNvbWJpbmVMYXRlc3QoKSB7XG4gICAgdmFyIG9ic2VydmFibGVzID0gW107XG4gICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgb2JzZXJ2YWJsZXNbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICB9XG4gICAgdmFyIHJlc3VsdFNlbGVjdG9yID0gbnVsbDtcbiAgICB2YXIgc2NoZWR1bGVyID0gbnVsbDtcbiAgICBpZiAoaXNTY2hlZHVsZXIob2JzZXJ2YWJsZXNbb2JzZXJ2YWJsZXMubGVuZ3RoIC0gMV0pKSB7XG4gICAgICAgIHNjaGVkdWxlciA9IG9ic2VydmFibGVzLnBvcCgpO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIG9ic2VydmFibGVzW29ic2VydmFibGVzLmxlbmd0aCAtIDFdID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHJlc3VsdFNlbGVjdG9yID0gb2JzZXJ2YWJsZXMucG9wKCk7XG4gICAgfVxuICAgIGlmIChvYnNlcnZhYmxlcy5sZW5ndGggPT09IDEgJiYgaXNBcnJheShvYnNlcnZhYmxlc1swXSkpIHtcbiAgICAgICAgb2JzZXJ2YWJsZXMgPSBvYnNlcnZhYmxlc1swXTtcbiAgICB9XG4gICAgcmV0dXJuIGZyb21BcnJheShvYnNlcnZhYmxlcywgc2NoZWR1bGVyKS5saWZ0KG5ldyBDb21iaW5lTGF0ZXN0T3BlcmF0b3IocmVzdWx0U2VsZWN0b3IpKTtcbn1cbnZhciBDb21iaW5lTGF0ZXN0T3BlcmF0b3IgPSAvKkBfX1BVUkVfXyovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ29tYmluZUxhdGVzdE9wZXJhdG9yKHJlc3VsdFNlbGVjdG9yKSB7XG4gICAgICAgIHRoaXMucmVzdWx0U2VsZWN0b3IgPSByZXN1bHRTZWxlY3RvcjtcbiAgICB9XG4gICAgQ29tYmluZUxhdGVzdE9wZXJhdG9yLnByb3RvdHlwZS5jYWxsID0gZnVuY3Rpb24gKHN1YnNjcmliZXIsIHNvdXJjZSkge1xuICAgICAgICByZXR1cm4gc291cmNlLnN1YnNjcmliZShuZXcgQ29tYmluZUxhdGVzdFN1YnNjcmliZXIoc3Vic2NyaWJlciwgdGhpcy5yZXN1bHRTZWxlY3RvcikpO1xuICAgIH07XG4gICAgcmV0dXJuIENvbWJpbmVMYXRlc3RPcGVyYXRvcjtcbn0oKSk7XG5leHBvcnQgeyBDb21iaW5lTGF0ZXN0T3BlcmF0b3IgfTtcbnZhciBDb21iaW5lTGF0ZXN0U3Vic2NyaWJlciA9IC8qQF9fUFVSRV9fKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhDb21iaW5lTGF0ZXN0U3Vic2NyaWJlciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBDb21iaW5lTGF0ZXN0U3Vic2NyaWJlcihkZXN0aW5hdGlvbiwgcmVzdWx0U2VsZWN0b3IpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZGVzdGluYXRpb24pIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLnJlc3VsdFNlbGVjdG9yID0gcmVzdWx0U2VsZWN0b3I7XG4gICAgICAgIF90aGlzLmFjdGl2ZSA9IDA7XG4gICAgICAgIF90aGlzLnZhbHVlcyA9IFtdO1xuICAgICAgICBfdGhpcy5vYnNlcnZhYmxlcyA9IFtdO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIENvbWJpbmVMYXRlc3RTdWJzY3JpYmVyLnByb3RvdHlwZS5fbmV4dCA9IGZ1bmN0aW9uIChvYnNlcnZhYmxlKSB7XG4gICAgICAgIHRoaXMudmFsdWVzLnB1c2goTk9ORSk7XG4gICAgICAgIHRoaXMub2JzZXJ2YWJsZXMucHVzaChvYnNlcnZhYmxlKTtcbiAgICB9O1xuICAgIENvbWJpbmVMYXRlc3RTdWJzY3JpYmVyLnByb3RvdHlwZS5fY29tcGxldGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBvYnNlcnZhYmxlcyA9IHRoaXMub2JzZXJ2YWJsZXM7XG4gICAgICAgIHZhciBsZW4gPSBvYnNlcnZhYmxlcy5sZW5ndGg7XG4gICAgICAgIGlmIChsZW4gPT09IDApIHtcbiAgICAgICAgICAgIHRoaXMuZGVzdGluYXRpb24uY29tcGxldGUoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuYWN0aXZlID0gbGVuO1xuICAgICAgICAgICAgdGhpcy50b1Jlc3BvbmQgPSBsZW47XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIG9ic2VydmFibGUgPSBvYnNlcnZhYmxlc1tpXTtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZChzdWJzY3JpYmVUb1Jlc3VsdCh0aGlzLCBvYnNlcnZhYmxlLCBvYnNlcnZhYmxlLCBpKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENvbWJpbmVMYXRlc3RTdWJzY3JpYmVyLnByb3RvdHlwZS5ub3RpZnlDb21wbGV0ZSA9IGZ1bmN0aW9uICh1bnVzZWQpIHtcbiAgICAgICAgaWYgKCh0aGlzLmFjdGl2ZSAtPSAxKSA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy5kZXN0aW5hdGlvbi5jb21wbGV0ZSgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBDb21iaW5lTGF0ZXN0U3Vic2NyaWJlci5wcm90b3R5cGUubm90aWZ5TmV4dCA9IGZ1bmN0aW9uIChvdXRlclZhbHVlLCBpbm5lclZhbHVlLCBvdXRlckluZGV4LCBpbm5lckluZGV4LCBpbm5lclN1Yikge1xuICAgICAgICB2YXIgdmFsdWVzID0gdGhpcy52YWx1ZXM7XG4gICAgICAgIHZhciBvbGRWYWwgPSB2YWx1ZXNbb3V0ZXJJbmRleF07XG4gICAgICAgIHZhciB0b1Jlc3BvbmQgPSAhdGhpcy50b1Jlc3BvbmRcbiAgICAgICAgICAgID8gMFxuICAgICAgICAgICAgOiBvbGRWYWwgPT09IE5PTkUgPyAtLXRoaXMudG9SZXNwb25kIDogdGhpcy50b1Jlc3BvbmQ7XG4gICAgICAgIHZhbHVlc1tvdXRlckluZGV4XSA9IGlubmVyVmFsdWU7XG4gICAgICAgIGlmICh0b1Jlc3BvbmQgPT09IDApIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnJlc3VsdFNlbGVjdG9yKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdHJ5UmVzdWx0U2VsZWN0b3IodmFsdWVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuZGVzdGluYXRpb24ubmV4dCh2YWx1ZXMuc2xpY2UoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENvbWJpbmVMYXRlc3RTdWJzY3JpYmVyLnByb3RvdHlwZS5fdHJ5UmVzdWx0U2VsZWN0b3IgPSBmdW5jdGlvbiAodmFsdWVzKSB7XG4gICAgICAgIHZhciByZXN1bHQ7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXN1bHQgPSB0aGlzLnJlc3VsdFNlbGVjdG9yLmFwcGx5KHRoaXMsIHZhbHVlcyk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgdGhpcy5kZXN0aW5hdGlvbi5lcnJvcihlcnIpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZGVzdGluYXRpb24ubmV4dChyZXN1bHQpO1xuICAgIH07XG4gICAgcmV0dXJuIENvbWJpbmVMYXRlc3RTdWJzY3JpYmVyO1xufShPdXRlclN1YnNjcmliZXIpKTtcbmV4cG9ydCB7IENvbWJpbmVMYXRlc3RTdWJzY3JpYmVyIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1jb21iaW5lTGF0ZXN0LmpzLm1hcFxuIiwiLyoqIFBVUkVfSU1QT1JUU19TVEFSVCBfdXRpbF9pc1NjaGVkdWxlcixfb2YsX2Zyb20sX29wZXJhdG9yc19jb25jYXRBbGwgUFVSRV9JTVBPUlRTX0VORCAqL1xuaW1wb3J0IHsgaXNTY2hlZHVsZXIgfSBmcm9tICcuLi91dGlsL2lzU2NoZWR1bGVyJztcbmltcG9ydCB7IG9mIH0gZnJvbSAnLi9vZic7XG5pbXBvcnQgeyBmcm9tIH0gZnJvbSAnLi9mcm9tJztcbmltcG9ydCB7IGNvbmNhdEFsbCB9IGZyb20gJy4uL29wZXJhdG9ycy9jb25jYXRBbGwnO1xuZXhwb3J0IGZ1bmN0aW9uIGNvbmNhdCgpIHtcbiAgICB2YXIgb2JzZXJ2YWJsZXMgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICBvYnNlcnZhYmxlc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgIH1cbiAgICBpZiAob2JzZXJ2YWJsZXMubGVuZ3RoID09PSAxIHx8IChvYnNlcnZhYmxlcy5sZW5ndGggPT09IDIgJiYgaXNTY2hlZHVsZXIob2JzZXJ2YWJsZXNbMV0pKSkge1xuICAgICAgICByZXR1cm4gZnJvbShvYnNlcnZhYmxlc1swXSk7XG4gICAgfVxuICAgIHJldHVybiBjb25jYXRBbGwoKShvZi5hcHBseSh2b2lkIDAsIG9ic2VydmFibGVzKSk7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1jb25jYXQuanMubWFwXG4iLCIvKiogUFVSRV9JTVBPUlRTX1NUQVJUIF9PYnNlcnZhYmxlLF9mcm9tLF9lbXB0eSBQVVJFX0lNUE9SVFNfRU5EICovXG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAnLi4vT2JzZXJ2YWJsZSc7XG5pbXBvcnQgeyBmcm9tIH0gZnJvbSAnLi9mcm9tJztcbmltcG9ydCB7IGVtcHR5IH0gZnJvbSAnLi9lbXB0eSc7XG5leHBvcnQgZnVuY3Rpb24gZGVmZXIob2JzZXJ2YWJsZUZhY3RvcnkpIHtcbiAgICByZXR1cm4gbmV3IE9ic2VydmFibGUoZnVuY3Rpb24gKHN1YnNjcmliZXIpIHtcbiAgICAgICAgdmFyIGlucHV0O1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaW5wdXQgPSBvYnNlcnZhYmxlRmFjdG9yeSgpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIHN1YnNjcmliZXIuZXJyb3IoZXJyKTtcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNvdXJjZSA9IGlucHV0ID8gZnJvbShpbnB1dCkgOiBlbXB0eSgpO1xuICAgICAgICByZXR1cm4gc291cmNlLnN1YnNjcmliZShzdWJzY3JpYmVyKTtcbiAgICB9KTtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRlZmVyLmpzLm1hcFxuIiwiLyoqIFBVUkVfSU1QT1JUU19TVEFSVCBfT2JzZXJ2YWJsZSBQVVJFX0lNUE9SVFNfRU5EICovXG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAnLi4vT2JzZXJ2YWJsZSc7XG5leHBvcnQgdmFyIEVNUFRZID0gLypAX19QVVJFX18qLyBuZXcgT2JzZXJ2YWJsZShmdW5jdGlvbiAoc3Vic2NyaWJlcikgeyByZXR1cm4gc3Vic2NyaWJlci5jb21wbGV0ZSgpOyB9KTtcbmV4cG9ydCBmdW5jdGlvbiBlbXB0eShzY2hlZHVsZXIpIHtcbiAgICByZXR1cm4gc2NoZWR1bGVyID8gZW1wdHlTY2hlZHVsZWQoc2NoZWR1bGVyKSA6IEVNUFRZO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGVtcHR5U2NoZWR1bGVkKHNjaGVkdWxlcikge1xuICAgIHJldHVybiBuZXcgT2JzZXJ2YWJsZShmdW5jdGlvbiAoc3Vic2NyaWJlcikgeyByZXR1cm4gc2NoZWR1bGVyLnNjaGVkdWxlKGZ1bmN0aW9uICgpIHsgcmV0dXJuIHN1YnNjcmliZXIuY29tcGxldGUoKTsgfSk7IH0pO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZW1wdHkuanMubWFwXG4iLCIvKiogUFVSRV9JTVBPUlRTX1NUQVJUIHRzbGliLF9PYnNlcnZhYmxlLF91dGlsX2lzQXJyYXksX2VtcHR5LF91dGlsX3N1YnNjcmliZVRvUmVzdWx0LF9PdXRlclN1YnNjcmliZXIsX29wZXJhdG9yc19tYXAgUFVSRV9JTVBPUlRTX0VORCAqL1xuaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICcuLi9PYnNlcnZhYmxlJztcbmltcG9ydCB7IGlzQXJyYXkgfSBmcm9tICcuLi91dGlsL2lzQXJyYXknO1xuaW1wb3J0IHsgRU1QVFkgfSBmcm9tICcuL2VtcHR5JztcbmltcG9ydCB7IHN1YnNjcmliZVRvUmVzdWx0IH0gZnJvbSAnLi4vdXRpbC9zdWJzY3JpYmVUb1Jlc3VsdCc7XG5pbXBvcnQgeyBPdXRlclN1YnNjcmliZXIgfSBmcm9tICcuLi9PdXRlclN1YnNjcmliZXInO1xuaW1wb3J0IHsgbWFwIH0gZnJvbSAnLi4vb3BlcmF0b3JzL21hcCc7XG5leHBvcnQgZnVuY3Rpb24gZm9ya0pvaW4oKSB7XG4gICAgdmFyIHNvdXJjZXMgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICBzb3VyY2VzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgfVxuICAgIHZhciByZXN1bHRTZWxlY3RvcjtcbiAgICBpZiAodHlwZW9mIHNvdXJjZXNbc291cmNlcy5sZW5ndGggLSAxXSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICByZXN1bHRTZWxlY3RvciA9IHNvdXJjZXMucG9wKCk7XG4gICAgfVxuICAgIGlmIChzb3VyY2VzLmxlbmd0aCA9PT0gMSAmJiBpc0FycmF5KHNvdXJjZXNbMF0pKSB7XG4gICAgICAgIHNvdXJjZXMgPSBzb3VyY2VzWzBdO1xuICAgIH1cbiAgICBpZiAoc291cmNlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgcmV0dXJuIEVNUFRZO1xuICAgIH1cbiAgICBpZiAocmVzdWx0U2VsZWN0b3IpIHtcbiAgICAgICAgcmV0dXJuIGZvcmtKb2luKHNvdXJjZXMpLnBpcGUobWFwKGZ1bmN0aW9uIChhcmdzKSB7IHJldHVybiByZXN1bHRTZWxlY3Rvci5hcHBseSh2b2lkIDAsIGFyZ3MpOyB9KSk7XG4gICAgfVxuICAgIHJldHVybiBuZXcgT2JzZXJ2YWJsZShmdW5jdGlvbiAoc3Vic2NyaWJlcikge1xuICAgICAgICByZXR1cm4gbmV3IEZvcmtKb2luU3Vic2NyaWJlcihzdWJzY3JpYmVyLCBzb3VyY2VzKTtcbiAgICB9KTtcbn1cbnZhciBGb3JrSm9pblN1YnNjcmliZXIgPSAvKkBfX1BVUkVfXyovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoRm9ya0pvaW5TdWJzY3JpYmVyLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEZvcmtKb2luU3Vic2NyaWJlcihkZXN0aW5hdGlvbiwgc291cmNlcykge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBkZXN0aW5hdGlvbikgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuc291cmNlcyA9IHNvdXJjZXM7XG4gICAgICAgIF90aGlzLmNvbXBsZXRlZCA9IDA7XG4gICAgICAgIF90aGlzLmhhdmVWYWx1ZXMgPSAwO1xuICAgICAgICB2YXIgbGVuID0gc291cmNlcy5sZW5ndGg7XG4gICAgICAgIF90aGlzLnZhbHVlcyA9IG5ldyBBcnJheShsZW4pO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgc291cmNlID0gc291cmNlc1tpXTtcbiAgICAgICAgICAgIHZhciBpbm5lclN1YnNjcmlwdGlvbiA9IHN1YnNjcmliZVRvUmVzdWx0KF90aGlzLCBzb3VyY2UsIG51bGwsIGkpO1xuICAgICAgICAgICAgaWYgKGlubmVyU3Vic2NyaXB0aW9uKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuYWRkKGlubmVyU3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIEZvcmtKb2luU3Vic2NyaWJlci5wcm90b3R5cGUubm90aWZ5TmV4dCA9IGZ1bmN0aW9uIChvdXRlclZhbHVlLCBpbm5lclZhbHVlLCBvdXRlckluZGV4LCBpbm5lckluZGV4LCBpbm5lclN1Yikge1xuICAgICAgICB0aGlzLnZhbHVlc1tvdXRlckluZGV4XSA9IGlubmVyVmFsdWU7XG4gICAgICAgIGlmICghaW5uZXJTdWIuX2hhc1ZhbHVlKSB7XG4gICAgICAgICAgICBpbm5lclN1Yi5faGFzVmFsdWUgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5oYXZlVmFsdWVzKys7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZvcmtKb2luU3Vic2NyaWJlci5wcm90b3R5cGUubm90aWZ5Q29tcGxldGUgPSBmdW5jdGlvbiAoaW5uZXJTdWIpIHtcbiAgICAgICAgdmFyIF9hID0gdGhpcywgZGVzdGluYXRpb24gPSBfYS5kZXN0aW5hdGlvbiwgaGF2ZVZhbHVlcyA9IF9hLmhhdmVWYWx1ZXMsIHZhbHVlcyA9IF9hLnZhbHVlcztcbiAgICAgICAgdmFyIGxlbiA9IHZhbHVlcy5sZW5ndGg7XG4gICAgICAgIGlmICghaW5uZXJTdWIuX2hhc1ZhbHVlKSB7XG4gICAgICAgICAgICBkZXN0aW5hdGlvbi5jb21wbGV0ZSgpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY29tcGxldGVkKys7XG4gICAgICAgIGlmICh0aGlzLmNvbXBsZXRlZCAhPT0gbGVuKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGhhdmVWYWx1ZXMgPT09IGxlbikge1xuICAgICAgICAgICAgZGVzdGluYXRpb24ubmV4dCh2YWx1ZXMpO1xuICAgICAgICB9XG4gICAgICAgIGRlc3RpbmF0aW9uLmNvbXBsZXRlKCk7XG4gICAgfTtcbiAgICByZXR1cm4gRm9ya0pvaW5TdWJzY3JpYmVyO1xufShPdXRlclN1YnNjcmliZXIpKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWZvcmtKb2luLmpzLm1hcFxuIiwiLyoqIFBVUkVfSU1QT1JUU19TVEFSVCBfT2JzZXJ2YWJsZSxfdXRpbF9pc1Byb21pc2UsX3V0aWxfaXNBcnJheUxpa2UsX3V0aWxfaXNJbnRlcm9wT2JzZXJ2YWJsZSxfdXRpbF9pc0l0ZXJhYmxlLF9mcm9tQXJyYXksX2Zyb21Qcm9taXNlLF9mcm9tSXRlcmFibGUsX2Zyb21PYnNlcnZhYmxlLF91dGlsX3N1YnNjcmliZVRvIFBVUkVfSU1QT1JUU19FTkQgKi9cbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICcuLi9PYnNlcnZhYmxlJztcbmltcG9ydCB7IGlzUHJvbWlzZSB9IGZyb20gJy4uL3V0aWwvaXNQcm9taXNlJztcbmltcG9ydCB7IGlzQXJyYXlMaWtlIH0gZnJvbSAnLi4vdXRpbC9pc0FycmF5TGlrZSc7XG5pbXBvcnQgeyBpc0ludGVyb3BPYnNlcnZhYmxlIH0gZnJvbSAnLi4vdXRpbC9pc0ludGVyb3BPYnNlcnZhYmxlJztcbmltcG9ydCB7IGlzSXRlcmFibGUgfSBmcm9tICcuLi91dGlsL2lzSXRlcmFibGUnO1xuaW1wb3J0IHsgZnJvbUFycmF5IH0gZnJvbSAnLi9mcm9tQXJyYXknO1xuaW1wb3J0IHsgZnJvbVByb21pc2UgfSBmcm9tICcuL2Zyb21Qcm9taXNlJztcbmltcG9ydCB7IGZyb21JdGVyYWJsZSB9IGZyb20gJy4vZnJvbUl0ZXJhYmxlJztcbmltcG9ydCB7IGZyb21PYnNlcnZhYmxlIH0gZnJvbSAnLi9mcm9tT2JzZXJ2YWJsZSc7XG5pbXBvcnQgeyBzdWJzY3JpYmVUbyB9IGZyb20gJy4uL3V0aWwvc3Vic2NyaWJlVG8nO1xuZXhwb3J0IGZ1bmN0aW9uIGZyb20oaW5wdXQsIHNjaGVkdWxlcikge1xuICAgIGlmICghc2NoZWR1bGVyKSB7XG4gICAgICAgIGlmIChpbnB1dCBpbnN0YW5jZW9mIE9ic2VydmFibGUpIHtcbiAgICAgICAgICAgIHJldHVybiBpbnB1dDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IE9ic2VydmFibGUoc3Vic2NyaWJlVG8oaW5wdXQpKTtcbiAgICB9XG4gICAgaWYgKGlucHV0ICE9IG51bGwpIHtcbiAgICAgICAgaWYgKGlzSW50ZXJvcE9ic2VydmFibGUoaW5wdXQpKSB7XG4gICAgICAgICAgICByZXR1cm4gZnJvbU9ic2VydmFibGUoaW5wdXQsIHNjaGVkdWxlcik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoaXNQcm9taXNlKGlucHV0KSkge1xuICAgICAgICAgICAgcmV0dXJuIGZyb21Qcm9taXNlKGlucHV0LCBzY2hlZHVsZXIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGlzQXJyYXlMaWtlKGlucHV0KSkge1xuICAgICAgICAgICAgcmV0dXJuIGZyb21BcnJheShpbnB1dCwgc2NoZWR1bGVyKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChpc0l0ZXJhYmxlKGlucHV0KSB8fCB0eXBlb2YgaW5wdXQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICByZXR1cm4gZnJvbUl0ZXJhYmxlKGlucHV0LCBzY2hlZHVsZXIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoKGlucHV0ICE9PSBudWxsICYmIHR5cGVvZiBpbnB1dCB8fCBpbnB1dCkgKyAnIGlzIG5vdCBvYnNlcnZhYmxlJyk7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1mcm9tLmpzLm1hcFxuIiwiLyoqIFBVUkVfSU1QT1JUU19TVEFSVCBfT2JzZXJ2YWJsZSxfU3Vic2NyaXB0aW9uLF91dGlsX3N1YnNjcmliZVRvQXJyYXkgUFVSRV9JTVBPUlRTX0VORCAqL1xuaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJy4uL09ic2VydmFibGUnO1xuaW1wb3J0IHsgU3Vic2NyaXB0aW9uIH0gZnJvbSAnLi4vU3Vic2NyaXB0aW9uJztcbmltcG9ydCB7IHN1YnNjcmliZVRvQXJyYXkgfSBmcm9tICcuLi91dGlsL3N1YnNjcmliZVRvQXJyYXknO1xuZXhwb3J0IGZ1bmN0aW9uIGZyb21BcnJheShpbnB1dCwgc2NoZWR1bGVyKSB7XG4gICAgaWYgKCFzY2hlZHVsZXIpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBPYnNlcnZhYmxlKHN1YnNjcmliZVRvQXJyYXkoaW5wdXQpKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBuZXcgT2JzZXJ2YWJsZShmdW5jdGlvbiAoc3Vic2NyaWJlcikge1xuICAgICAgICAgICAgdmFyIHN1YiA9IG5ldyBTdWJzY3JpcHRpb24oKTtcbiAgICAgICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgICAgIHN1Yi5hZGQoc2NoZWR1bGVyLnNjaGVkdWxlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAoaSA9PT0gaW5wdXQubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnNjcmliZXIuY29tcGxldGUoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzdWJzY3JpYmVyLm5leHQoaW5wdXRbaSsrXSk7XG4gICAgICAgICAgICAgICAgaWYgKCFzdWJzY3JpYmVyLmNsb3NlZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWIuYWRkKHRoaXMuc2NoZWR1bGUoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgcmV0dXJuIHN1YjtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZnJvbUFycmF5LmpzLm1hcFxuIiwiLyoqIFBVUkVfSU1QT1JUU19TVEFSVCBfT2JzZXJ2YWJsZSxfdXRpbF9pc0FycmF5LF91dGlsX2lzRnVuY3Rpb24sX29wZXJhdG9yc19tYXAgUFVSRV9JTVBPUlRTX0VORCAqL1xuaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJy4uL09ic2VydmFibGUnO1xuaW1wb3J0IHsgaXNBcnJheSB9IGZyb20gJy4uL3V0aWwvaXNBcnJheSc7XG5pbXBvcnQgeyBpc0Z1bmN0aW9uIH0gZnJvbSAnLi4vdXRpbC9pc0Z1bmN0aW9uJztcbmltcG9ydCB7IG1hcCB9IGZyb20gJy4uL29wZXJhdG9ycy9tYXAnO1xudmFyIHRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZztcbmV4cG9ydCBmdW5jdGlvbiBmcm9tRXZlbnQodGFyZ2V0LCBldmVudE5hbWUsIG9wdGlvbnMsIHJlc3VsdFNlbGVjdG9yKSB7XG4gICAgaWYgKGlzRnVuY3Rpb24ob3B0aW9ucykpIHtcbiAgICAgICAgcmVzdWx0U2VsZWN0b3IgPSBvcHRpb25zO1xuICAgICAgICBvcHRpb25zID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBpZiAocmVzdWx0U2VsZWN0b3IpIHtcbiAgICAgICAgcmV0dXJuIGZyb21FdmVudCh0YXJnZXQsIGV2ZW50TmFtZSwgb3B0aW9ucykucGlwZShtYXAoZnVuY3Rpb24gKGFyZ3MpIHsgcmV0dXJuIGlzQXJyYXkoYXJncykgPyByZXN1bHRTZWxlY3Rvci5hcHBseSh2b2lkIDAsIGFyZ3MpIDogcmVzdWx0U2VsZWN0b3IoYXJncyk7IH0pKTtcbiAgICB9XG4gICAgcmV0dXJuIG5ldyBPYnNlcnZhYmxlKGZ1bmN0aW9uIChzdWJzY3JpYmVyKSB7XG4gICAgICAgIGZ1bmN0aW9uIGhhbmRsZXIoZSkge1xuICAgICAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgc3Vic2NyaWJlci5uZXh0KEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cykpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgc3Vic2NyaWJlci5uZXh0KGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHNldHVwU3Vic2NyaXB0aW9uKHRhcmdldCwgZXZlbnROYW1lLCBoYW5kbGVyLCBzdWJzY3JpYmVyLCBvcHRpb25zKTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIHNldHVwU3Vic2NyaXB0aW9uKHNvdXJjZU9iaiwgZXZlbnROYW1lLCBoYW5kbGVyLCBzdWJzY3JpYmVyLCBvcHRpb25zKSB7XG4gICAgdmFyIHVuc3Vic2NyaWJlO1xuICAgIGlmIChpc0V2ZW50VGFyZ2V0KHNvdXJjZU9iaikpIHtcbiAgICAgICAgdmFyIHNvdXJjZV8xID0gc291cmNlT2JqO1xuICAgICAgICBzb3VyY2VPYmouYWRkRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIGhhbmRsZXIsIG9wdGlvbnMpO1xuICAgICAgICB1bnN1YnNjcmliZSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHNvdXJjZV8xLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBoYW5kbGVyLCBvcHRpb25zKTsgfTtcbiAgICB9XG4gICAgZWxzZSBpZiAoaXNKUXVlcnlTdHlsZUV2ZW50RW1pdHRlcihzb3VyY2VPYmopKSB7XG4gICAgICAgIHZhciBzb3VyY2VfMiA9IHNvdXJjZU9iajtcbiAgICAgICAgc291cmNlT2JqLm9uKGV2ZW50TmFtZSwgaGFuZGxlcik7XG4gICAgICAgIHVuc3Vic2NyaWJlID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gc291cmNlXzIub2ZmKGV2ZW50TmFtZSwgaGFuZGxlcik7IH07XG4gICAgfVxuICAgIGVsc2UgaWYgKGlzTm9kZVN0eWxlRXZlbnRFbWl0dGVyKHNvdXJjZU9iaikpIHtcbiAgICAgICAgdmFyIHNvdXJjZV8zID0gc291cmNlT2JqO1xuICAgICAgICBzb3VyY2VPYmouYWRkTGlzdGVuZXIoZXZlbnROYW1lLCBoYW5kbGVyKTtcbiAgICAgICAgdW5zdWJzY3JpYmUgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBzb3VyY2VfMy5yZW1vdmVMaXN0ZW5lcihldmVudE5hbWUsIGhhbmRsZXIpOyB9O1xuICAgIH1cbiAgICBlbHNlIGlmIChzb3VyY2VPYmogJiYgc291cmNlT2JqLmxlbmd0aCkge1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gc291cmNlT2JqLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICBzZXR1cFN1YnNjcmlwdGlvbihzb3VyY2VPYmpbaV0sIGV2ZW50TmFtZSwgaGFuZGxlciwgc3Vic2NyaWJlciwgb3B0aW9ucyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgZXZlbnQgdGFyZ2V0Jyk7XG4gICAgfVxuICAgIHN1YnNjcmliZXIuYWRkKHVuc3Vic2NyaWJlKTtcbn1cbmZ1bmN0aW9uIGlzTm9kZVN0eWxlRXZlbnRFbWl0dGVyKHNvdXJjZU9iaikge1xuICAgIHJldHVybiBzb3VyY2VPYmogJiYgdHlwZW9mIHNvdXJjZU9iai5hZGRMaXN0ZW5lciA9PT0gJ2Z1bmN0aW9uJyAmJiB0eXBlb2Ygc291cmNlT2JqLnJlbW92ZUxpc3RlbmVyID09PSAnZnVuY3Rpb24nO1xufVxuZnVuY3Rpb24gaXNKUXVlcnlTdHlsZUV2ZW50RW1pdHRlcihzb3VyY2VPYmopIHtcbiAgICByZXR1cm4gc291cmNlT2JqICYmIHR5cGVvZiBzb3VyY2VPYmoub24gPT09ICdmdW5jdGlvbicgJiYgdHlwZW9mIHNvdXJjZU9iai5vZmYgPT09ICdmdW5jdGlvbic7XG59XG5mdW5jdGlvbiBpc0V2ZW50VGFyZ2V0KHNvdXJjZU9iaikge1xuICAgIHJldHVybiBzb3VyY2VPYmogJiYgdHlwZW9mIHNvdXJjZU9iai5hZGRFdmVudExpc3RlbmVyID09PSAnZnVuY3Rpb24nICYmIHR5cGVvZiBzb3VyY2VPYmoucmVtb3ZlRXZlbnRMaXN0ZW5lciA9PT0gJ2Z1bmN0aW9uJztcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWZyb21FdmVudC5qcy5tYXBcbiIsIi8qKiBQVVJFX0lNUE9SVFNfU1RBUlQgX09ic2VydmFibGUsX3V0aWxfaXNBcnJheSxfdXRpbF9pc0Z1bmN0aW9uLF9vcGVyYXRvcnNfbWFwIFBVUkVfSU1QT1JUU19FTkQgKi9cbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICcuLi9PYnNlcnZhYmxlJztcbmltcG9ydCB7IGlzQXJyYXkgfSBmcm9tICcuLi91dGlsL2lzQXJyYXknO1xuaW1wb3J0IHsgaXNGdW5jdGlvbiB9IGZyb20gJy4uL3V0aWwvaXNGdW5jdGlvbic7XG5pbXBvcnQgeyBtYXAgfSBmcm9tICcuLi9vcGVyYXRvcnMvbWFwJztcbmV4cG9ydCBmdW5jdGlvbiBmcm9tRXZlbnRQYXR0ZXJuKGFkZEhhbmRsZXIsIHJlbW92ZUhhbmRsZXIsIHJlc3VsdFNlbGVjdG9yKSB7XG4gICAgaWYgKHJlc3VsdFNlbGVjdG9yKSB7XG4gICAgICAgIHJldHVybiBmcm9tRXZlbnRQYXR0ZXJuKGFkZEhhbmRsZXIsIHJlbW92ZUhhbmRsZXIpLnBpcGUobWFwKGZ1bmN0aW9uIChhcmdzKSB7IHJldHVybiBpc0FycmF5KGFyZ3MpID8gcmVzdWx0U2VsZWN0b3IuYXBwbHkodm9pZCAwLCBhcmdzKSA6IHJlc3VsdFNlbGVjdG9yKGFyZ3MpOyB9KSk7XG4gICAgfVxuICAgIHJldHVybiBuZXcgT2JzZXJ2YWJsZShmdW5jdGlvbiAoc3Vic2NyaWJlcikge1xuICAgICAgICB2YXIgaGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBlID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIGVbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBzdWJzY3JpYmVyLm5leHQoZS5sZW5ndGggPT09IDEgPyBlWzBdIDogZSk7XG4gICAgICAgIH07XG4gICAgICAgIHZhciByZXRWYWx1ZTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldFZhbHVlID0gYWRkSGFuZGxlcihoYW5kbGVyKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICBzdWJzY3JpYmVyLmVycm9yKGVycik7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIGlmICghaXNGdW5jdGlvbihyZW1vdmVIYW5kbGVyKSkge1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVtb3ZlSGFuZGxlcihoYW5kbGVyLCByZXRWYWx1ZSk7IH07XG4gICAgfSk7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1mcm9tRXZlbnRQYXR0ZXJuLmpzLm1hcFxuIiwiLyoqIFBVUkVfSU1QT1JUU19TVEFSVCBfT2JzZXJ2YWJsZSxfU3Vic2NyaXB0aW9uLF9zeW1ib2xfaXRlcmF0b3IsX3V0aWxfc3Vic2NyaWJlVG9JdGVyYWJsZSBQVVJFX0lNUE9SVFNfRU5EICovXG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAnLi4vT2JzZXJ2YWJsZSc7XG5pbXBvcnQgeyBTdWJzY3JpcHRpb24gfSBmcm9tICcuLi9TdWJzY3JpcHRpb24nO1xuaW1wb3J0IHsgaXRlcmF0b3IgYXMgU3ltYm9sX2l0ZXJhdG9yIH0gZnJvbSAnLi4vc3ltYm9sL2l0ZXJhdG9yJztcbmltcG9ydCB7IHN1YnNjcmliZVRvSXRlcmFibGUgfSBmcm9tICcuLi91dGlsL3N1YnNjcmliZVRvSXRlcmFibGUnO1xuZXhwb3J0IGZ1bmN0aW9uIGZyb21JdGVyYWJsZShpbnB1dCwgc2NoZWR1bGVyKSB7XG4gICAgaWYgKCFpbnB1dCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0l0ZXJhYmxlIGNhbm5vdCBiZSBudWxsJyk7XG4gICAgfVxuICAgIGlmICghc2NoZWR1bGVyKSB7XG4gICAgICAgIHJldHVybiBuZXcgT2JzZXJ2YWJsZShzdWJzY3JpYmVUb0l0ZXJhYmxlKGlucHV0KSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gbmV3IE9ic2VydmFibGUoZnVuY3Rpb24gKHN1YnNjcmliZXIpIHtcbiAgICAgICAgICAgIHZhciBzdWIgPSBuZXcgU3Vic2NyaXB0aW9uKCk7XG4gICAgICAgICAgICB2YXIgaXRlcmF0b3I7XG4gICAgICAgICAgICBzdWIuYWRkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAoaXRlcmF0b3IgJiYgdHlwZW9mIGl0ZXJhdG9yLnJldHVybiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICBpdGVyYXRvci5yZXR1cm4oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHN1Yi5hZGQoc2NoZWR1bGVyLnNjaGVkdWxlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpdGVyYXRvciA9IGlucHV0W1N5bWJvbF9pdGVyYXRvcl0oKTtcbiAgICAgICAgICAgICAgICBzdWIuYWRkKHNjaGVkdWxlci5zY2hlZHVsZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdWJzY3JpYmVyLmNsb3NlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRvbmU7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gaXRlcmF0b3IubmV4dCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSByZXN1bHQudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBkb25lID0gcmVzdWx0LmRvbmU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3Vic2NyaWJlci5lcnJvcihlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChkb25lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWJzY3JpYmVyLmNvbXBsZXRlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWJzY3JpYmVyLm5leHQodmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zY2hlZHVsZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgcmV0dXJuIHN1YjtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZnJvbUl0ZXJhYmxlLmpzLm1hcFxuIiwiLyoqIFBVUkVfSU1QT1JUU19TVEFSVCBfT2JzZXJ2YWJsZSxfU3Vic2NyaXB0aW9uLF9zeW1ib2xfb2JzZXJ2YWJsZSxfdXRpbF9zdWJzY3JpYmVUb09ic2VydmFibGUgUFVSRV9JTVBPUlRTX0VORCAqL1xuaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJy4uL09ic2VydmFibGUnO1xuaW1wb3J0IHsgU3Vic2NyaXB0aW9uIH0gZnJvbSAnLi4vU3Vic2NyaXB0aW9uJztcbmltcG9ydCB7IG9ic2VydmFibGUgYXMgU3ltYm9sX29ic2VydmFibGUgfSBmcm9tICcuLi9zeW1ib2wvb2JzZXJ2YWJsZSc7XG5pbXBvcnQgeyBzdWJzY3JpYmVUb09ic2VydmFibGUgfSBmcm9tICcuLi91dGlsL3N1YnNjcmliZVRvT2JzZXJ2YWJsZSc7XG5leHBvcnQgZnVuY3Rpb24gZnJvbU9ic2VydmFibGUoaW5wdXQsIHNjaGVkdWxlcikge1xuICAgIGlmICghc2NoZWR1bGVyKSB7XG4gICAgICAgIHJldHVybiBuZXcgT2JzZXJ2YWJsZShzdWJzY3JpYmVUb09ic2VydmFibGUoaW5wdXQpKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBuZXcgT2JzZXJ2YWJsZShmdW5jdGlvbiAoc3Vic2NyaWJlcikge1xuICAgICAgICAgICAgdmFyIHN1YiA9IG5ldyBTdWJzY3JpcHRpb24oKTtcbiAgICAgICAgICAgIHN1Yi5hZGQoc2NoZWR1bGVyLnNjaGVkdWxlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgb2JzZXJ2YWJsZSA9IGlucHV0W1N5bWJvbF9vYnNlcnZhYmxlXSgpO1xuICAgICAgICAgICAgICAgIHN1Yi5hZGQob2JzZXJ2YWJsZS5zdWJzY3JpYmUoe1xuICAgICAgICAgICAgICAgICAgICBuZXh0OiBmdW5jdGlvbiAodmFsdWUpIHsgc3ViLmFkZChzY2hlZHVsZXIuc2NoZWR1bGUoZnVuY3Rpb24gKCkgeyByZXR1cm4gc3Vic2NyaWJlci5uZXh0KHZhbHVlKTsgfSkpOyB9LFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKGVycikgeyBzdWIuYWRkKHNjaGVkdWxlci5zY2hlZHVsZShmdW5jdGlvbiAoKSB7IHJldHVybiBzdWJzY3JpYmVyLmVycm9yKGVycik7IH0pKTsgfSxcbiAgICAgICAgICAgICAgICAgICAgY29tcGxldGU6IGZ1bmN0aW9uICgpIHsgc3ViLmFkZChzY2hlZHVsZXIuc2NoZWR1bGUoZnVuY3Rpb24gKCkgeyByZXR1cm4gc3Vic2NyaWJlci5jb21wbGV0ZSgpOyB9KSk7IH0sXG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgcmV0dXJuIHN1YjtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZnJvbU9ic2VydmFibGUuanMubWFwXG4iLCIvKiogUFVSRV9JTVBPUlRTX1NUQVJUIF9PYnNlcnZhYmxlLF9TdWJzY3JpcHRpb24sX3V0aWxfc3Vic2NyaWJlVG9Qcm9taXNlIFBVUkVfSU1QT1JUU19FTkQgKi9cbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICcuLi9PYnNlcnZhYmxlJztcbmltcG9ydCB7IFN1YnNjcmlwdGlvbiB9IGZyb20gJy4uL1N1YnNjcmlwdGlvbic7XG5pbXBvcnQgeyBzdWJzY3JpYmVUb1Byb21pc2UgfSBmcm9tICcuLi91dGlsL3N1YnNjcmliZVRvUHJvbWlzZSc7XG5leHBvcnQgZnVuY3Rpb24gZnJvbVByb21pc2UoaW5wdXQsIHNjaGVkdWxlcikge1xuICAgIGlmICghc2NoZWR1bGVyKSB7XG4gICAgICAgIHJldHVybiBuZXcgT2JzZXJ2YWJsZShzdWJzY3JpYmVUb1Byb21pc2UoaW5wdXQpKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBuZXcgT2JzZXJ2YWJsZShmdW5jdGlvbiAoc3Vic2NyaWJlcikge1xuICAgICAgICAgICAgdmFyIHN1YiA9IG5ldyBTdWJzY3JpcHRpb24oKTtcbiAgICAgICAgICAgIHN1Yi5hZGQoc2NoZWR1bGVyLnNjaGVkdWxlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5wdXQudGhlbihmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgc3ViLmFkZChzY2hlZHVsZXIuc2NoZWR1bGUoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3Vic2NyaWJlci5uZXh0KHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Yi5hZGQoc2NoZWR1bGVyLnNjaGVkdWxlKGZ1bmN0aW9uICgpIHsgcmV0dXJuIHN1YnNjcmliZXIuY29tcGxldGUoKTsgfSkpO1xuICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgICAgICAgICBzdWIuYWRkKHNjaGVkdWxlci5zY2hlZHVsZShmdW5jdGlvbiAoKSB7IHJldHVybiBzdWJzY3JpYmVyLmVycm9yKGVycik7IH0pKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIHJldHVybiBzdWI7XG4gICAgICAgIH0pO1xuICAgIH1cbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWZyb21Qcm9taXNlLmpzLm1hcFxuIiwiLyoqIFBVUkVfSU1QT1JUU19TVEFSVCBfT2JzZXJ2YWJsZSxfdXRpbF9pZGVudGl0eSxfdXRpbF9pc1NjaGVkdWxlciBQVVJFX0lNUE9SVFNfRU5EICovXG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAnLi4vT2JzZXJ2YWJsZSc7XG5pbXBvcnQgeyBpZGVudGl0eSB9IGZyb20gJy4uL3V0aWwvaWRlbnRpdHknO1xuaW1wb3J0IHsgaXNTY2hlZHVsZXIgfSBmcm9tICcuLi91dGlsL2lzU2NoZWR1bGVyJztcbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZShpbml0aWFsU3RhdGVPck9wdGlvbnMsIGNvbmRpdGlvbiwgaXRlcmF0ZSwgcmVzdWx0U2VsZWN0b3JPck9ic2VydmFibGUsIHNjaGVkdWxlcikge1xuICAgIHZhciByZXN1bHRTZWxlY3RvcjtcbiAgICB2YXIgaW5pdGlhbFN0YXRlO1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09IDEpIHtcbiAgICAgICAgdmFyIG9wdGlvbnMgPSBpbml0aWFsU3RhdGVPck9wdGlvbnM7XG4gICAgICAgIGluaXRpYWxTdGF0ZSA9IG9wdGlvbnMuaW5pdGlhbFN0YXRlO1xuICAgICAgICBjb25kaXRpb24gPSBvcHRpb25zLmNvbmRpdGlvbjtcbiAgICAgICAgaXRlcmF0ZSA9IG9wdGlvbnMuaXRlcmF0ZTtcbiAgICAgICAgcmVzdWx0U2VsZWN0b3IgPSBvcHRpb25zLnJlc3VsdFNlbGVjdG9yIHx8IGlkZW50aXR5O1xuICAgICAgICBzY2hlZHVsZXIgPSBvcHRpb25zLnNjaGVkdWxlcjtcbiAgICB9XG4gICAgZWxzZSBpZiAocmVzdWx0U2VsZWN0b3JPck9ic2VydmFibGUgPT09IHVuZGVmaW5lZCB8fCBpc1NjaGVkdWxlcihyZXN1bHRTZWxlY3Rvck9yT2JzZXJ2YWJsZSkpIHtcbiAgICAgICAgaW5pdGlhbFN0YXRlID0gaW5pdGlhbFN0YXRlT3JPcHRpb25zO1xuICAgICAgICByZXN1bHRTZWxlY3RvciA9IGlkZW50aXR5O1xuICAgICAgICBzY2hlZHVsZXIgPSByZXN1bHRTZWxlY3Rvck9yT2JzZXJ2YWJsZTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGluaXRpYWxTdGF0ZSA9IGluaXRpYWxTdGF0ZU9yT3B0aW9ucztcbiAgICAgICAgcmVzdWx0U2VsZWN0b3IgPSByZXN1bHRTZWxlY3Rvck9yT2JzZXJ2YWJsZTtcbiAgICB9XG4gICAgcmV0dXJuIG5ldyBPYnNlcnZhYmxlKGZ1bmN0aW9uIChzdWJzY3JpYmVyKSB7XG4gICAgICAgIHZhciBzdGF0ZSA9IGluaXRpYWxTdGF0ZTtcbiAgICAgICAgaWYgKHNjaGVkdWxlcikge1xuICAgICAgICAgICAgcmV0dXJuIHNjaGVkdWxlci5zY2hlZHVsZShkaXNwYXRjaCwgMCwge1xuICAgICAgICAgICAgICAgIHN1YnNjcmliZXI6IHN1YnNjcmliZXIsXG4gICAgICAgICAgICAgICAgaXRlcmF0ZTogaXRlcmF0ZSxcbiAgICAgICAgICAgICAgICBjb25kaXRpb246IGNvbmRpdGlvbixcbiAgICAgICAgICAgICAgICByZXN1bHRTZWxlY3RvcjogcmVzdWx0U2VsZWN0b3IsXG4gICAgICAgICAgICAgICAgc3RhdGU6IHN0YXRlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBkbyB7XG4gICAgICAgICAgICBpZiAoY29uZGl0aW9uKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbmRpdGlvblJlc3VsdCA9IHZvaWQgMDtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBjb25kaXRpb25SZXN1bHQgPSBjb25kaXRpb24oc3RhdGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnNjcmliZXIuZXJyb3IoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCFjb25kaXRpb25SZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3Vic2NyaWJlci5jb21wbGV0ZSgpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgdmFsdWUgPSB2b2lkIDA7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gcmVzdWx0U2VsZWN0b3Ioc3RhdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgIHN1YnNjcmliZXIuZXJyb3IoZXJyKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc3Vic2NyaWJlci5uZXh0KHZhbHVlKTtcbiAgICAgICAgICAgIGlmIChzdWJzY3JpYmVyLmNsb3NlZCkge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBzdGF0ZSA9IGl0ZXJhdGUoc3RhdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgIHN1YnNjcmliZXIuZXJyb3IoZXJyKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IHdoaWxlICh0cnVlKTtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGRpc3BhdGNoKHN0YXRlKSB7XG4gICAgdmFyIHN1YnNjcmliZXIgPSBzdGF0ZS5zdWJzY3JpYmVyLCBjb25kaXRpb24gPSBzdGF0ZS5jb25kaXRpb247XG4gICAgaWYgKHN1YnNjcmliZXIuY2xvc2VkKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIGlmIChzdGF0ZS5uZWVkSXRlcmF0ZSkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgc3RhdGUuc3RhdGUgPSBzdGF0ZS5pdGVyYXRlKHN0YXRlLnN0YXRlKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICBzdWJzY3JpYmVyLmVycm9yKGVycik7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBzdGF0ZS5uZWVkSXRlcmF0ZSA9IHRydWU7XG4gICAgfVxuICAgIGlmIChjb25kaXRpb24pIHtcbiAgICAgICAgdmFyIGNvbmRpdGlvblJlc3VsdCA9IHZvaWQgMDtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbmRpdGlvblJlc3VsdCA9IGNvbmRpdGlvbihzdGF0ZS5zdGF0ZSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgc3Vic2NyaWJlci5lcnJvcihlcnIpO1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWNvbmRpdGlvblJlc3VsdCkge1xuICAgICAgICAgICAgc3Vic2NyaWJlci5jb21wbGV0ZSgpO1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3Vic2NyaWJlci5jbG9zZWQpIHtcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmFyIHZhbHVlO1xuICAgIHRyeSB7XG4gICAgICAgIHZhbHVlID0gc3RhdGUucmVzdWx0U2VsZWN0b3Ioc3RhdGUuc3RhdGUpO1xuICAgIH1cbiAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHN1YnNjcmliZXIuZXJyb3IoZXJyKTtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgaWYgKHN1YnNjcmliZXIuY2xvc2VkKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIHN1YnNjcmliZXIubmV4dCh2YWx1ZSk7XG4gICAgaWYgKHN1YnNjcmliZXIuY2xvc2VkKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLnNjaGVkdWxlKHN0YXRlKTtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWdlbmVyYXRlLmpzLm1hcFxuIiwiLyoqIFBVUkVfSU1QT1JUU19TVEFSVCBfZGVmZXIsX2VtcHR5IFBVUkVfSU1QT1JUU19FTkQgKi9cbmltcG9ydCB7IGRlZmVyIH0gZnJvbSAnLi9kZWZlcic7XG5pbXBvcnQgeyBFTVBUWSB9IGZyb20gJy4vZW1wdHknO1xuZXhwb3J0IGZ1bmN0aW9uIGlpZihjb25kaXRpb24sIHRydWVSZXN1bHQsIGZhbHNlUmVzdWx0KSB7XG4gICAgaWYgKHRydWVSZXN1bHQgPT09IHZvaWQgMCkge1xuICAgICAgICB0cnVlUmVzdWx0ID0gRU1QVFk7XG4gICAgfVxuICAgIGlmIChmYWxzZVJlc3VsdCA9PT0gdm9pZCAwKSB7XG4gICAgICAgIGZhbHNlUmVzdWx0ID0gRU1QVFk7XG4gICAgfVxuICAgIHJldHVybiBkZWZlcihmdW5jdGlvbiAoKSB7IHJldHVybiBjb25kaXRpb24oKSA/IHRydWVSZXN1bHQgOiBmYWxzZVJlc3VsdDsgfSk7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1paWYuanMubWFwXG4iLCIvKiogUFVSRV9JTVBPUlRTX1NUQVJUIF9PYnNlcnZhYmxlLF9zY2hlZHVsZXJfYXN5bmMsX3V0aWxfaXNOdW1lcmljIFBVUkVfSU1QT1JUU19FTkQgKi9cbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICcuLi9PYnNlcnZhYmxlJztcbmltcG9ydCB7IGFzeW5jIH0gZnJvbSAnLi4vc2NoZWR1bGVyL2FzeW5jJztcbmltcG9ydCB7IGlzTnVtZXJpYyB9IGZyb20gJy4uL3V0aWwvaXNOdW1lcmljJztcbmV4cG9ydCBmdW5jdGlvbiBpbnRlcnZhbChwZXJpb2QsIHNjaGVkdWxlcikge1xuICAgIGlmIChwZXJpb2QgPT09IHZvaWQgMCkge1xuICAgICAgICBwZXJpb2QgPSAwO1xuICAgIH1cbiAgICBpZiAoc2NoZWR1bGVyID09PSB2b2lkIDApIHtcbiAgICAgICAgc2NoZWR1bGVyID0gYXN5bmM7XG4gICAgfVxuICAgIGlmICghaXNOdW1lcmljKHBlcmlvZCkgfHwgcGVyaW9kIDwgMCkge1xuICAgICAgICBwZXJpb2QgPSAwO1xuICAgIH1cbiAgICBpZiAoIXNjaGVkdWxlciB8fCB0eXBlb2Ygc2NoZWR1bGVyLnNjaGVkdWxlICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHNjaGVkdWxlciA9IGFzeW5jO1xuICAgIH1cbiAgICByZXR1cm4gbmV3IE9ic2VydmFibGUoZnVuY3Rpb24gKHN1YnNjcmliZXIpIHtcbiAgICAgICAgc3Vic2NyaWJlci5hZGQoc2NoZWR1bGVyLnNjaGVkdWxlKGRpc3BhdGNoLCBwZXJpb2QsIHsgc3Vic2NyaWJlcjogc3Vic2NyaWJlciwgY291bnRlcjogMCwgcGVyaW9kOiBwZXJpb2QgfSkpO1xuICAgICAgICByZXR1cm4gc3Vic2NyaWJlcjtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGRpc3BhdGNoKHN0YXRlKSB7XG4gICAgdmFyIHN1YnNjcmliZXIgPSBzdGF0ZS5zdWJzY3JpYmVyLCBjb3VudGVyID0gc3RhdGUuY291bnRlciwgcGVyaW9kID0gc3RhdGUucGVyaW9kO1xuICAgIHN1YnNjcmliZXIubmV4dChjb3VudGVyKTtcbiAgICB0aGlzLnNjaGVkdWxlKHsgc3Vic2NyaWJlcjogc3Vic2NyaWJlciwgY291bnRlcjogY291bnRlciArIDEsIHBlcmlvZDogcGVyaW9kIH0sIHBlcmlvZCk7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbnRlcnZhbC5qcy5tYXBcbiIsIi8qKiBQVVJFX0lNUE9SVFNfU1RBUlQgX09ic2VydmFibGUsX3V0aWxfaXNTY2hlZHVsZXIsX29wZXJhdG9yc19tZXJnZUFsbCxfZnJvbUFycmF5IFBVUkVfSU1QT1JUU19FTkQgKi9cbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICcuLi9PYnNlcnZhYmxlJztcbmltcG9ydCB7IGlzU2NoZWR1bGVyIH0gZnJvbSAnLi4vdXRpbC9pc1NjaGVkdWxlcic7XG5pbXBvcnQgeyBtZXJnZUFsbCB9IGZyb20gJy4uL29wZXJhdG9ycy9tZXJnZUFsbCc7XG5pbXBvcnQgeyBmcm9tQXJyYXkgfSBmcm9tICcuL2Zyb21BcnJheSc7XG5leHBvcnQgZnVuY3Rpb24gbWVyZ2UoKSB7XG4gICAgdmFyIG9ic2VydmFibGVzID0gW107XG4gICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgb2JzZXJ2YWJsZXNbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICB9XG4gICAgdmFyIGNvbmN1cnJlbnQgPSBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFk7XG4gICAgdmFyIHNjaGVkdWxlciA9IG51bGw7XG4gICAgdmFyIGxhc3QgPSBvYnNlcnZhYmxlc1tvYnNlcnZhYmxlcy5sZW5ndGggLSAxXTtcbiAgICBpZiAoaXNTY2hlZHVsZXIobGFzdCkpIHtcbiAgICAgICAgc2NoZWR1bGVyID0gb2JzZXJ2YWJsZXMucG9wKCk7XG4gICAgICAgIGlmIChvYnNlcnZhYmxlcy5sZW5ndGggPiAxICYmIHR5cGVvZiBvYnNlcnZhYmxlc1tvYnNlcnZhYmxlcy5sZW5ndGggLSAxXSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgIGNvbmN1cnJlbnQgPSBvYnNlcnZhYmxlcy5wb3AoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmICh0eXBlb2YgbGFzdCA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgY29uY3VycmVudCA9IG9ic2VydmFibGVzLnBvcCgpO1xuICAgIH1cbiAgICBpZiAoc2NoZWR1bGVyID09PSBudWxsICYmIG9ic2VydmFibGVzLmxlbmd0aCA9PT0gMSAmJiBvYnNlcnZhYmxlc1swXSBpbnN0YW5jZW9mIE9ic2VydmFibGUpIHtcbiAgICAgICAgcmV0dXJuIG9ic2VydmFibGVzWzBdO1xuICAgIH1cbiAgICByZXR1cm4gbWVyZ2VBbGwoY29uY3VycmVudCkoZnJvbUFycmF5KG9ic2VydmFibGVzLCBzY2hlZHVsZXIpKTtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1lcmdlLmpzLm1hcFxuIiwiLyoqIFBVUkVfSU1QT1JUU19TVEFSVCBfT2JzZXJ2YWJsZSxfdXRpbF9ub29wIFBVUkVfSU1QT1JUU19FTkQgKi9cbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICcuLi9PYnNlcnZhYmxlJztcbmltcG9ydCB7IG5vb3AgfSBmcm9tICcuLi91dGlsL25vb3AnO1xuZXhwb3J0IHZhciBORVZFUiA9IC8qQF9fUFVSRV9fKi8gbmV3IE9ic2VydmFibGUobm9vcCk7XG5leHBvcnQgZnVuY3Rpb24gbmV2ZXIoKSB7XG4gICAgcmV0dXJuIE5FVkVSO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bmV2ZXIuanMubWFwXG4iLCIvKiogUFVSRV9JTVBPUlRTX1NUQVJUIF91dGlsX2lzU2NoZWR1bGVyLF9mcm9tQXJyYXksX2VtcHR5LF9zY2FsYXIgUFVSRV9JTVBPUlRTX0VORCAqL1xuaW1wb3J0IHsgaXNTY2hlZHVsZXIgfSBmcm9tICcuLi91dGlsL2lzU2NoZWR1bGVyJztcbmltcG9ydCB7IGZyb21BcnJheSB9IGZyb20gJy4vZnJvbUFycmF5JztcbmltcG9ydCB7IGVtcHR5IH0gZnJvbSAnLi9lbXB0eSc7XG5pbXBvcnQgeyBzY2FsYXIgfSBmcm9tICcuL3NjYWxhcic7XG5leHBvcnQgZnVuY3Rpb24gb2YoKSB7XG4gICAgdmFyIGFyZ3MgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgfVxuICAgIHZhciBzY2hlZHVsZXIgPSBhcmdzW2FyZ3MubGVuZ3RoIC0gMV07XG4gICAgaWYgKGlzU2NoZWR1bGVyKHNjaGVkdWxlcikpIHtcbiAgICAgICAgYXJncy5wb3AoKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHNjaGVkdWxlciA9IHVuZGVmaW5lZDtcbiAgICB9XG4gICAgc3dpdGNoIChhcmdzLmxlbmd0aCkge1xuICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICByZXR1cm4gZW1wdHkoc2NoZWR1bGVyKTtcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgcmV0dXJuIHNjaGVkdWxlciA/IGZyb21BcnJheShhcmdzLCBzY2hlZHVsZXIpIDogc2NhbGFyKGFyZ3NbMF0pO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuIGZyb21BcnJheShhcmdzLCBzY2hlZHVsZXIpO1xuICAgIH1cbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW9mLmpzLm1hcFxuIiwiLyoqIFBVUkVfSU1QT1JUU19TVEFSVCBfT2JzZXJ2YWJsZSxfZnJvbSxfdXRpbF9pc0FycmF5LF9lbXB0eSBQVVJFX0lNUE9SVFNfRU5EICovXG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAnLi4vT2JzZXJ2YWJsZSc7XG5pbXBvcnQgeyBmcm9tIH0gZnJvbSAnLi9mcm9tJztcbmltcG9ydCB7IGlzQXJyYXkgfSBmcm9tICcuLi91dGlsL2lzQXJyYXknO1xuaW1wb3J0IHsgRU1QVFkgfSBmcm9tICcuL2VtcHR5JztcbmV4cG9ydCBmdW5jdGlvbiBvbkVycm9yUmVzdW1lTmV4dCgpIHtcbiAgICB2YXIgc291cmNlcyA9IFtdO1xuICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHNvdXJjZXNbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICB9XG4gICAgaWYgKHNvdXJjZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJldHVybiBFTVBUWTtcbiAgICB9XG4gICAgdmFyIGZpcnN0ID0gc291cmNlc1swXSwgcmVtYWluZGVyID0gc291cmNlcy5zbGljZSgxKTtcbiAgICBpZiAoc291cmNlcy5sZW5ndGggPT09IDEgJiYgaXNBcnJheShmaXJzdCkpIHtcbiAgICAgICAgcmV0dXJuIG9uRXJyb3JSZXN1bWVOZXh0LmFwcGx5KHZvaWQgMCwgZmlyc3QpO1xuICAgIH1cbiAgICByZXR1cm4gbmV3IE9ic2VydmFibGUoZnVuY3Rpb24gKHN1YnNjcmliZXIpIHtcbiAgICAgICAgdmFyIHN1Yk5leHQgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBzdWJzY3JpYmVyLmFkZChvbkVycm9yUmVzdW1lTmV4dC5hcHBseSh2b2lkIDAsIHJlbWFpbmRlcikuc3Vic2NyaWJlKHN1YnNjcmliZXIpKTsgfTtcbiAgICAgICAgcmV0dXJuIGZyb20oZmlyc3QpLnN1YnNjcmliZSh7XG4gICAgICAgICAgICBuZXh0OiBmdW5jdGlvbiAodmFsdWUpIHsgc3Vic2NyaWJlci5uZXh0KHZhbHVlKTsgfSxcbiAgICAgICAgICAgIGVycm9yOiBzdWJOZXh0LFxuICAgICAgICAgICAgY29tcGxldGU6IHN1Yk5leHQsXG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9b25FcnJvclJlc3VtZU5leHQuanMubWFwXG4iLCIvKiogUFVSRV9JTVBPUlRTX1NUQVJUIF9PYnNlcnZhYmxlLF9TdWJzY3JpcHRpb24gUFVSRV9JTVBPUlRTX0VORCAqL1xuaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJy4uL09ic2VydmFibGUnO1xuaW1wb3J0IHsgU3Vic2NyaXB0aW9uIH0gZnJvbSAnLi4vU3Vic2NyaXB0aW9uJztcbmV4cG9ydCBmdW5jdGlvbiBwYWlycyhvYmosIHNjaGVkdWxlcikge1xuICAgIGlmICghc2NoZWR1bGVyKSB7XG4gICAgICAgIHJldHVybiBuZXcgT2JzZXJ2YWJsZShmdW5jdGlvbiAoc3Vic2NyaWJlcikge1xuICAgICAgICAgICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmopO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aCAmJiAhc3Vic2NyaWJlci5jbG9zZWQ7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBrZXkgPSBrZXlzW2ldO1xuICAgICAgICAgICAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgICAgICAgICBzdWJzY3JpYmVyLm5leHQoW2tleSwgb2JqW2tleV1dKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzdWJzY3JpYmVyLmNvbXBsZXRlKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIG5ldyBPYnNlcnZhYmxlKGZ1bmN0aW9uIChzdWJzY3JpYmVyKSB7XG4gICAgICAgICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iaik7XG4gICAgICAgICAgICB2YXIgc3Vic2NyaXB0aW9uID0gbmV3IFN1YnNjcmlwdGlvbigpO1xuICAgICAgICAgICAgc3Vic2NyaXB0aW9uLmFkZChzY2hlZHVsZXIuc2NoZWR1bGUoZGlzcGF0Y2gsIDAsIHsga2V5czoga2V5cywgaW5kZXg6IDAsIHN1YnNjcmliZXI6IHN1YnNjcmliZXIsIHN1YnNjcmlwdGlvbjogc3Vic2NyaXB0aW9uLCBvYmo6IG9iaiB9KSk7XG4gICAgICAgICAgICByZXR1cm4gc3Vic2NyaXB0aW9uO1xuICAgICAgICB9KTtcbiAgICB9XG59XG5leHBvcnQgZnVuY3Rpb24gZGlzcGF0Y2goc3RhdGUpIHtcbiAgICB2YXIga2V5cyA9IHN0YXRlLmtleXMsIGluZGV4ID0gc3RhdGUuaW5kZXgsIHN1YnNjcmliZXIgPSBzdGF0ZS5zdWJzY3JpYmVyLCBzdWJzY3JpcHRpb24gPSBzdGF0ZS5zdWJzY3JpcHRpb24sIG9iaiA9IHN0YXRlLm9iajtcbiAgICBpZiAoIXN1YnNjcmliZXIuY2xvc2VkKSB7XG4gICAgICAgIGlmIChpbmRleCA8IGtleXMubGVuZ3RoKSB7XG4gICAgICAgICAgICB2YXIga2V5ID0ga2V5c1tpbmRleF07XG4gICAgICAgICAgICBzdWJzY3JpYmVyLm5leHQoW2tleSwgb2JqW2tleV1dKTtcbiAgICAgICAgICAgIHN1YnNjcmlwdGlvbi5hZGQodGhpcy5zY2hlZHVsZSh7IGtleXM6IGtleXMsIGluZGV4OiBpbmRleCArIDEsIHN1YnNjcmliZXI6IHN1YnNjcmliZXIsIHN1YnNjcmlwdGlvbjogc3Vic2NyaXB0aW9uLCBvYmo6IG9iaiB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBzdWJzY3JpYmVyLmNvbXBsZXRlKCk7XG4gICAgICAgIH1cbiAgICB9XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWlycy5qcy5tYXBcbiIsIi8qKiBQVVJFX0lNUE9SVFNfU1RBUlQgdHNsaWIsX3V0aWxfaXNBcnJheSxfZnJvbUFycmF5LF9PdXRlclN1YnNjcmliZXIsX3V0aWxfc3Vic2NyaWJlVG9SZXN1bHQgUFVSRV9JTVBPUlRTX0VORCAqL1xuaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IGlzQXJyYXkgfSBmcm9tICcuLi91dGlsL2lzQXJyYXknO1xuaW1wb3J0IHsgZnJvbUFycmF5IH0gZnJvbSAnLi9mcm9tQXJyYXknO1xuaW1wb3J0IHsgT3V0ZXJTdWJzY3JpYmVyIH0gZnJvbSAnLi4vT3V0ZXJTdWJzY3JpYmVyJztcbmltcG9ydCB7IHN1YnNjcmliZVRvUmVzdWx0IH0gZnJvbSAnLi4vdXRpbC9zdWJzY3JpYmVUb1Jlc3VsdCc7XG5leHBvcnQgZnVuY3Rpb24gcmFjZSgpIHtcbiAgICB2YXIgb2JzZXJ2YWJsZXMgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICBvYnNlcnZhYmxlc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgIH1cbiAgICBpZiAob2JzZXJ2YWJsZXMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgIGlmIChpc0FycmF5KG9ic2VydmFibGVzWzBdKSkge1xuICAgICAgICAgICAgb2JzZXJ2YWJsZXMgPSBvYnNlcnZhYmxlc1swXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBvYnNlcnZhYmxlc1swXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZnJvbUFycmF5KG9ic2VydmFibGVzLCB1bmRlZmluZWQpLmxpZnQobmV3IFJhY2VPcGVyYXRvcigpKTtcbn1cbnZhciBSYWNlT3BlcmF0b3IgPSAvKkBfX1BVUkVfXyovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gUmFjZU9wZXJhdG9yKCkge1xuICAgIH1cbiAgICBSYWNlT3BlcmF0b3IucHJvdG90eXBlLmNhbGwgPSBmdW5jdGlvbiAoc3Vic2NyaWJlciwgc291cmNlKSB7XG4gICAgICAgIHJldHVybiBzb3VyY2Uuc3Vic2NyaWJlKG5ldyBSYWNlU3Vic2NyaWJlcihzdWJzY3JpYmVyKSk7XG4gICAgfTtcbiAgICByZXR1cm4gUmFjZU9wZXJhdG9yO1xufSgpKTtcbmV4cG9ydCB7IFJhY2VPcGVyYXRvciB9O1xudmFyIFJhY2VTdWJzY3JpYmVyID0gLypAX19QVVJFX18qLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHRzbGliXzEuX19leHRlbmRzKFJhY2VTdWJzY3JpYmVyLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFJhY2VTdWJzY3JpYmVyKGRlc3RpbmF0aW9uKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGRlc3RpbmF0aW9uKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5oYXNGaXJzdCA9IGZhbHNlO1xuICAgICAgICBfdGhpcy5vYnNlcnZhYmxlcyA9IFtdO1xuICAgICAgICBfdGhpcy5zdWJzY3JpcHRpb25zID0gW107XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgUmFjZVN1YnNjcmliZXIucHJvdG90eXBlLl9uZXh0ID0gZnVuY3Rpb24gKG9ic2VydmFibGUpIHtcbiAgICAgICAgdGhpcy5vYnNlcnZhYmxlcy5wdXNoKG9ic2VydmFibGUpO1xuICAgIH07XG4gICAgUmFjZVN1YnNjcmliZXIucHJvdG90eXBlLl9jb21wbGV0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG9ic2VydmFibGVzID0gdGhpcy5vYnNlcnZhYmxlcztcbiAgICAgICAgdmFyIGxlbiA9IG9ic2VydmFibGVzLmxlbmd0aDtcbiAgICAgICAgaWYgKGxlbiA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy5kZXN0aW5hdGlvbi5jb21wbGV0ZSgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW4gJiYgIXRoaXMuaGFzRmlyc3Q7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBvYnNlcnZhYmxlID0gb2JzZXJ2YWJsZXNbaV07XG4gICAgICAgICAgICAgICAgdmFyIHN1YnNjcmlwdGlvbiA9IHN1YnNjcmliZVRvUmVzdWx0KHRoaXMsIG9ic2VydmFibGUsIG9ic2VydmFibGUsIGkpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnN1YnNjcmlwdGlvbnMpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2goc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5hZGQoc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMub2JzZXJ2YWJsZXMgPSBudWxsO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBSYWNlU3Vic2NyaWJlci5wcm90b3R5cGUubm90aWZ5TmV4dCA9IGZ1bmN0aW9uIChvdXRlclZhbHVlLCBpbm5lclZhbHVlLCBvdXRlckluZGV4LCBpbm5lckluZGV4LCBpbm5lclN1Yikge1xuICAgICAgICBpZiAoIXRoaXMuaGFzRmlyc3QpIHtcbiAgICAgICAgICAgIHRoaXMuaGFzRmlyc3QgPSB0cnVlO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnN1YnNjcmlwdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoaSAhPT0gb3V0ZXJJbmRleCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgc3Vic2NyaXB0aW9uID0gdGhpcy5zdWJzY3JpcHRpb25zW2ldO1xuICAgICAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmUoc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZGVzdGluYXRpb24ubmV4dChpbm5lclZhbHVlKTtcbiAgICB9O1xuICAgIHJldHVybiBSYWNlU3Vic2NyaWJlcjtcbn0oT3V0ZXJTdWJzY3JpYmVyKSk7XG5leHBvcnQgeyBSYWNlU3Vic2NyaWJlciB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cmFjZS5qcy5tYXBcbiIsIi8qKiBQVVJFX0lNUE9SVFNfU1RBUlQgX09ic2VydmFibGUgUFVSRV9JTVBPUlRTX0VORCAqL1xuaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJy4uL09ic2VydmFibGUnO1xuZXhwb3J0IGZ1bmN0aW9uIHJhbmdlKHN0YXJ0LCBjb3VudCwgc2NoZWR1bGVyKSB7XG4gICAgaWYgKHN0YXJ0ID09PSB2b2lkIDApIHtcbiAgICAgICAgc3RhcnQgPSAwO1xuICAgIH1cbiAgICBpZiAoY291bnQgPT09IHZvaWQgMCkge1xuICAgICAgICBjb3VudCA9IDA7XG4gICAgfVxuICAgIHJldHVybiBuZXcgT2JzZXJ2YWJsZShmdW5jdGlvbiAoc3Vic2NyaWJlcikge1xuICAgICAgICB2YXIgaW5kZXggPSAwO1xuICAgICAgICB2YXIgY3VycmVudCA9IHN0YXJ0O1xuICAgICAgICBpZiAoc2NoZWR1bGVyKSB7XG4gICAgICAgICAgICByZXR1cm4gc2NoZWR1bGVyLnNjaGVkdWxlKGRpc3BhdGNoLCAwLCB7XG4gICAgICAgICAgICAgICAgaW5kZXg6IGluZGV4LCBjb3VudDogY291bnQsIHN0YXJ0OiBzdGFydCwgc3Vic2NyaWJlcjogc3Vic2NyaWJlclxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgICAgaWYgKGluZGV4KysgPj0gY291bnQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3Vic2NyaWJlci5jb21wbGV0ZSgpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3Vic2NyaWJlci5uZXh0KGN1cnJlbnQrKyk7XG4gICAgICAgICAgICAgICAgaWYgKHN1YnNjcmliZXIuY2xvc2VkKSB7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gd2hpbGUgKHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfSk7XG59XG5leHBvcnQgZnVuY3Rpb24gZGlzcGF0Y2goc3RhdGUpIHtcbiAgICB2YXIgc3RhcnQgPSBzdGF0ZS5zdGFydCwgaW5kZXggPSBzdGF0ZS5pbmRleCwgY291bnQgPSBzdGF0ZS5jb3VudCwgc3Vic2NyaWJlciA9IHN0YXRlLnN1YnNjcmliZXI7XG4gICAgaWYgKGluZGV4ID49IGNvdW50KSB7XG4gICAgICAgIHN1YnNjcmliZXIuY29tcGxldGUoKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBzdWJzY3JpYmVyLm5leHQoc3RhcnQpO1xuICAgIGlmIChzdWJzY3JpYmVyLmNsb3NlZCkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHN0YXRlLmluZGV4ID0gaW5kZXggKyAxO1xuICAgIHN0YXRlLnN0YXJ0ID0gc3RhcnQgKyAxO1xuICAgIHRoaXMuc2NoZWR1bGUoc3RhdGUpO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cmFuZ2UuanMubWFwXG4iLCIvKiogUFVSRV9JTVBPUlRTX1NUQVJUIF9PYnNlcnZhYmxlIFBVUkVfSU1QT1JUU19FTkQgKi9cbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICcuLi9PYnNlcnZhYmxlJztcbmV4cG9ydCBmdW5jdGlvbiBzY2FsYXIodmFsdWUpIHtcbiAgICB2YXIgcmVzdWx0ID0gbmV3IE9ic2VydmFibGUoZnVuY3Rpb24gKHN1YnNjcmliZXIpIHtcbiAgICAgICAgc3Vic2NyaWJlci5uZXh0KHZhbHVlKTtcbiAgICAgICAgc3Vic2NyaWJlci5jb21wbGV0ZSgpO1xuICAgIH0pO1xuICAgIHJlc3VsdC5faXNTY2FsYXIgPSB0cnVlO1xuICAgIHJlc3VsdC52YWx1ZSA9IHZhbHVlO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zY2FsYXIuanMubWFwXG4iLCIvKiogUFVSRV9JTVBPUlRTX1NUQVJUIF9PYnNlcnZhYmxlIFBVUkVfSU1QT1JUU19FTkQgKi9cbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICcuLi9PYnNlcnZhYmxlJztcbmV4cG9ydCBmdW5jdGlvbiB0aHJvd0Vycm9yKGVycm9yLCBzY2hlZHVsZXIpIHtcbiAgICBpZiAoIXNjaGVkdWxlcikge1xuICAgICAgICByZXR1cm4gbmV3IE9ic2VydmFibGUoZnVuY3Rpb24gKHN1YnNjcmliZXIpIHsgcmV0dXJuIHN1YnNjcmliZXIuZXJyb3IoZXJyb3IpOyB9KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBuZXcgT2JzZXJ2YWJsZShmdW5jdGlvbiAoc3Vic2NyaWJlcikgeyByZXR1cm4gc2NoZWR1bGVyLnNjaGVkdWxlKGRpc3BhdGNoLCAwLCB7IGVycm9yOiBlcnJvciwgc3Vic2NyaWJlcjogc3Vic2NyaWJlciB9KTsgfSk7XG4gICAgfVxufVxuZnVuY3Rpb24gZGlzcGF0Y2goX2EpIHtcbiAgICB2YXIgZXJyb3IgPSBfYS5lcnJvciwgc3Vic2NyaWJlciA9IF9hLnN1YnNjcmliZXI7XG4gICAgc3Vic2NyaWJlci5lcnJvcihlcnJvcik7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD10aHJvd0Vycm9yLmpzLm1hcFxuIiwiLyoqIFBVUkVfSU1QT1JUU19TVEFSVCBfT2JzZXJ2YWJsZSxfc2NoZWR1bGVyX2FzeW5jLF91dGlsX2lzTnVtZXJpYyxfdXRpbF9pc1NjaGVkdWxlciBQVVJFX0lNUE9SVFNfRU5EICovXG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAnLi4vT2JzZXJ2YWJsZSc7XG5pbXBvcnQgeyBhc3luYyB9IGZyb20gJy4uL3NjaGVkdWxlci9hc3luYyc7XG5pbXBvcnQgeyBpc051bWVyaWMgfSBmcm9tICcuLi91dGlsL2lzTnVtZXJpYyc7XG5pbXBvcnQgeyBpc1NjaGVkdWxlciB9IGZyb20gJy4uL3V0aWwvaXNTY2hlZHVsZXInO1xuZXhwb3J0IGZ1bmN0aW9uIHRpbWVyKGR1ZVRpbWUsIHBlcmlvZE9yU2NoZWR1bGVyLCBzY2hlZHVsZXIpIHtcbiAgICBpZiAoZHVlVGltZSA9PT0gdm9pZCAwKSB7XG4gICAgICAgIGR1ZVRpbWUgPSAwO1xuICAgIH1cbiAgICB2YXIgcGVyaW9kID0gLTE7XG4gICAgaWYgKGlzTnVtZXJpYyhwZXJpb2RPclNjaGVkdWxlcikpIHtcbiAgICAgICAgcGVyaW9kID0gTnVtYmVyKHBlcmlvZE9yU2NoZWR1bGVyKSA8IDEgJiYgMSB8fCBOdW1iZXIocGVyaW9kT3JTY2hlZHVsZXIpO1xuICAgIH1cbiAgICBlbHNlIGlmIChpc1NjaGVkdWxlcihwZXJpb2RPclNjaGVkdWxlcikpIHtcbiAgICAgICAgc2NoZWR1bGVyID0gcGVyaW9kT3JTY2hlZHVsZXI7XG4gICAgfVxuICAgIGlmICghaXNTY2hlZHVsZXIoc2NoZWR1bGVyKSkge1xuICAgICAgICBzY2hlZHVsZXIgPSBhc3luYztcbiAgICB9XG4gICAgcmV0dXJuIG5ldyBPYnNlcnZhYmxlKGZ1bmN0aW9uIChzdWJzY3JpYmVyKSB7XG4gICAgICAgIHZhciBkdWUgPSBpc051bWVyaWMoZHVlVGltZSlcbiAgICAgICAgICAgID8gZHVlVGltZVxuICAgICAgICAgICAgOiAoK2R1ZVRpbWUgLSBzY2hlZHVsZXIubm93KCkpO1xuICAgICAgICByZXR1cm4gc2NoZWR1bGVyLnNjaGVkdWxlKGRpc3BhdGNoLCBkdWUsIHtcbiAgICAgICAgICAgIGluZGV4OiAwLCBwZXJpb2Q6IHBlcmlvZCwgc3Vic2NyaWJlcjogc3Vic2NyaWJlclxuICAgICAgICB9KTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGRpc3BhdGNoKHN0YXRlKSB7XG4gICAgdmFyIGluZGV4ID0gc3RhdGUuaW5kZXgsIHBlcmlvZCA9IHN0YXRlLnBlcmlvZCwgc3Vic2NyaWJlciA9IHN0YXRlLnN1YnNjcmliZXI7XG4gICAgc3Vic2NyaWJlci5uZXh0KGluZGV4KTtcbiAgICBpZiAoc3Vic2NyaWJlci5jbG9zZWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBlbHNlIGlmIChwZXJpb2QgPT09IC0xKSB7XG4gICAgICAgIHJldHVybiBzdWJzY3JpYmVyLmNvbXBsZXRlKCk7XG4gICAgfVxuICAgIHN0YXRlLmluZGV4ID0gaW5kZXggKyAxO1xuICAgIHRoaXMuc2NoZWR1bGUoc3RhdGUsIHBlcmlvZCk7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD10aW1lci5qcy5tYXBcbiIsIi8qKiBQVVJFX0lNUE9SVFNfU1RBUlQgX09ic2VydmFibGUsX2Zyb20sX2VtcHR5IFBVUkVfSU1QT1JUU19FTkQgKi9cbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICcuLi9PYnNlcnZhYmxlJztcbmltcG9ydCB7IGZyb20gfSBmcm9tICcuL2Zyb20nO1xuaW1wb3J0IHsgRU1QVFkgfSBmcm9tICcuL2VtcHR5JztcbmV4cG9ydCBmdW5jdGlvbiB1c2luZyhyZXNvdXJjZUZhY3RvcnksIG9ic2VydmFibGVGYWN0b3J5KSB7XG4gICAgcmV0dXJuIG5ldyBPYnNlcnZhYmxlKGZ1bmN0aW9uIChzdWJzY3JpYmVyKSB7XG4gICAgICAgIHZhciByZXNvdXJjZTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJlc291cmNlID0gcmVzb3VyY2VGYWN0b3J5KCk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgc3Vic2NyaWJlci5lcnJvcihlcnIpO1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcmVzdWx0O1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmVzdWx0ID0gb2JzZXJ2YWJsZUZhY3RvcnkocmVzb3VyY2UpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIHN1YnNjcmliZXIuZXJyb3IoZXJyKTtcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNvdXJjZSA9IHJlc3VsdCA/IGZyb20ocmVzdWx0KSA6IEVNUFRZO1xuICAgICAgICB2YXIgc3Vic2NyaXB0aW9uID0gc291cmNlLnN1YnNjcmliZShzdWJzY3JpYmVyKTtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgICAgICAgICAgaWYgKHJlc291cmNlKSB7XG4gICAgICAgICAgICAgICAgcmVzb3VyY2UudW5zdWJzY3JpYmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9KTtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXVzaW5nLmpzLm1hcFxuIiwiLyoqIFBVUkVfSU1QT1JUU19TVEFSVCB0c2xpYixfZnJvbUFycmF5LF91dGlsX2lzQXJyYXksX1N1YnNjcmliZXIsX091dGVyU3Vic2NyaWJlcixfdXRpbF9zdWJzY3JpYmVUb1Jlc3VsdCxfLi5faW50ZXJuYWxfc3ltYm9sX2l0ZXJhdG9yIFBVUkVfSU1QT1JUU19FTkQgKi9cbmltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XG5pbXBvcnQgeyBmcm9tQXJyYXkgfSBmcm9tICcuL2Zyb21BcnJheSc7XG5pbXBvcnQgeyBpc0FycmF5IH0gZnJvbSAnLi4vdXRpbC9pc0FycmF5JztcbmltcG9ydCB7IFN1YnNjcmliZXIgfSBmcm9tICcuLi9TdWJzY3JpYmVyJztcbmltcG9ydCB7IE91dGVyU3Vic2NyaWJlciB9IGZyb20gJy4uL091dGVyU3Vic2NyaWJlcic7XG5pbXBvcnQgeyBzdWJzY3JpYmVUb1Jlc3VsdCB9IGZyb20gJy4uL3V0aWwvc3Vic2NyaWJlVG9SZXN1bHQnO1xuaW1wb3J0IHsgaXRlcmF0b3IgYXMgU3ltYm9sX2l0ZXJhdG9yIH0gZnJvbSAnLi4vLi4vaW50ZXJuYWwvc3ltYm9sL2l0ZXJhdG9yJztcbmV4cG9ydCBmdW5jdGlvbiB6aXAoKSB7XG4gICAgdmFyIG9ic2VydmFibGVzID0gW107XG4gICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgb2JzZXJ2YWJsZXNbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICB9XG4gICAgdmFyIHJlc3VsdFNlbGVjdG9yID0gb2JzZXJ2YWJsZXNbb2JzZXJ2YWJsZXMubGVuZ3RoIC0gMV07XG4gICAgaWYgKHR5cGVvZiByZXN1bHRTZWxlY3RvciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBvYnNlcnZhYmxlcy5wb3AoKTtcbiAgICB9XG4gICAgcmV0dXJuIGZyb21BcnJheShvYnNlcnZhYmxlcywgdW5kZWZpbmVkKS5saWZ0KG5ldyBaaXBPcGVyYXRvcihyZXN1bHRTZWxlY3RvcikpO1xufVxudmFyIFppcE9wZXJhdG9yID0gLypAX19QVVJFX18qLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFppcE9wZXJhdG9yKHJlc3VsdFNlbGVjdG9yKSB7XG4gICAgICAgIHRoaXMucmVzdWx0U2VsZWN0b3IgPSByZXN1bHRTZWxlY3RvcjtcbiAgICB9XG4gICAgWmlwT3BlcmF0b3IucHJvdG90eXBlLmNhbGwgPSBmdW5jdGlvbiAoc3Vic2NyaWJlciwgc291cmNlKSB7XG4gICAgICAgIHJldHVybiBzb3VyY2Uuc3Vic2NyaWJlKG5ldyBaaXBTdWJzY3JpYmVyKHN1YnNjcmliZXIsIHRoaXMucmVzdWx0U2VsZWN0b3IpKTtcbiAgICB9O1xuICAgIHJldHVybiBaaXBPcGVyYXRvcjtcbn0oKSk7XG5leHBvcnQgeyBaaXBPcGVyYXRvciB9O1xudmFyIFppcFN1YnNjcmliZXIgPSAvKkBfX1BVUkVfXyovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoWmlwU3Vic2NyaWJlciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBaaXBTdWJzY3JpYmVyKGRlc3RpbmF0aW9uLCByZXN1bHRTZWxlY3RvciwgdmFsdWVzKSB7XG4gICAgICAgIGlmICh2YWx1ZXMgPT09IHZvaWQgMCkge1xuICAgICAgICAgICAgdmFsdWVzID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBkZXN0aW5hdGlvbikgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuaXRlcmF0b3JzID0gW107XG4gICAgICAgIF90aGlzLmFjdGl2ZSA9IDA7XG4gICAgICAgIF90aGlzLnJlc3VsdFNlbGVjdG9yID0gKHR5cGVvZiByZXN1bHRTZWxlY3RvciA9PT0gJ2Z1bmN0aW9uJykgPyByZXN1bHRTZWxlY3RvciA6IG51bGw7XG4gICAgICAgIF90aGlzLnZhbHVlcyA9IHZhbHVlcztcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBaaXBTdWJzY3JpYmVyLnByb3RvdHlwZS5fbmV4dCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgaXRlcmF0b3JzID0gdGhpcy5pdGVyYXRvcnM7XG4gICAgICAgIGlmIChpc0FycmF5KHZhbHVlKSkge1xuICAgICAgICAgICAgaXRlcmF0b3JzLnB1c2gobmV3IFN0YXRpY0FycmF5SXRlcmF0b3IodmFsdWUpKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0eXBlb2YgdmFsdWVbU3ltYm9sX2l0ZXJhdG9yXSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgaXRlcmF0b3JzLnB1c2gobmV3IFN0YXRpY0l0ZXJhdG9yKHZhbHVlW1N5bWJvbF9pdGVyYXRvcl0oKSkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaXRlcmF0b3JzLnB1c2gobmV3IFppcEJ1ZmZlckl0ZXJhdG9yKHRoaXMuZGVzdGluYXRpb24sIHRoaXMsIHZhbHVlKSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFppcFN1YnNjcmliZXIucHJvdG90eXBlLl9jb21wbGV0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGl0ZXJhdG9ycyA9IHRoaXMuaXRlcmF0b3JzO1xuICAgICAgICB2YXIgbGVuID0gaXRlcmF0b3JzLmxlbmd0aDtcbiAgICAgICAgdGhpcy51bnN1YnNjcmliZSgpO1xuICAgICAgICBpZiAobGVuID09PSAwKSB7XG4gICAgICAgICAgICB0aGlzLmRlc3RpbmF0aW9uLmNvbXBsZXRlKCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5hY3RpdmUgPSBsZW47XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpdGVyYXRvciA9IGl0ZXJhdG9yc1tpXTtcbiAgICAgICAgICAgIGlmIChpdGVyYXRvci5zdGlsbFVuc3Vic2NyaWJlZCkge1xuICAgICAgICAgICAgICAgIHZhciBkZXN0aW5hdGlvbiA9IHRoaXMuZGVzdGluYXRpb247XG4gICAgICAgICAgICAgICAgZGVzdGluYXRpb24uYWRkKGl0ZXJhdG9yLnN1YnNjcmliZShpdGVyYXRvciwgaSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hY3RpdmUtLTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgWmlwU3Vic2NyaWJlci5wcm90b3R5cGUubm90aWZ5SW5hY3RpdmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuYWN0aXZlLS07XG4gICAgICAgIGlmICh0aGlzLmFjdGl2ZSA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy5kZXN0aW5hdGlvbi5jb21wbGV0ZSgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBaaXBTdWJzY3JpYmVyLnByb3RvdHlwZS5jaGVja0l0ZXJhdG9ycyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGl0ZXJhdG9ycyA9IHRoaXMuaXRlcmF0b3JzO1xuICAgICAgICB2YXIgbGVuID0gaXRlcmF0b3JzLmxlbmd0aDtcbiAgICAgICAgdmFyIGRlc3RpbmF0aW9uID0gdGhpcy5kZXN0aW5hdGlvbjtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZXJhdG9yID0gaXRlcmF0b3JzW2ldO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBpdGVyYXRvci5oYXNWYWx1ZSA9PT0gJ2Z1bmN0aW9uJyAmJiAhaXRlcmF0b3IuaGFzVmFsdWUoKSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgc2hvdWxkQ29tcGxldGUgPSBmYWxzZTtcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZXJhdG9yID0gaXRlcmF0b3JzW2ldO1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGl0ZXJhdG9yLm5leHQoKTtcbiAgICAgICAgICAgIGlmIChpdGVyYXRvci5oYXNDb21wbGV0ZWQoKSkge1xuICAgICAgICAgICAgICAgIHNob3VsZENvbXBsZXRlID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChyZXN1bHQuZG9uZSkge1xuICAgICAgICAgICAgICAgIGRlc3RpbmF0aW9uLmNvbXBsZXRlKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYXJncy5wdXNoKHJlc3VsdC52YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucmVzdWx0U2VsZWN0b3IpIHtcbiAgICAgICAgICAgIHRoaXMuX3RyeXJlc3VsdFNlbGVjdG9yKGFyZ3MpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZGVzdGluYXRpb24ubmV4dChhcmdzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2hvdWxkQ29tcGxldGUpIHtcbiAgICAgICAgICAgIGRlc3RpbmF0aW9uLmNvbXBsZXRlKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFppcFN1YnNjcmliZXIucHJvdG90eXBlLl90cnlyZXN1bHRTZWxlY3RvciA9IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgIHZhciByZXN1bHQ7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXN1bHQgPSB0aGlzLnJlc3VsdFNlbGVjdG9yLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIHRoaXMuZGVzdGluYXRpb24uZXJyb3IoZXJyKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmRlc3RpbmF0aW9uLm5leHQocmVzdWx0KTtcbiAgICB9O1xuICAgIHJldHVybiBaaXBTdWJzY3JpYmVyO1xufShTdWJzY3JpYmVyKSk7XG5leHBvcnQgeyBaaXBTdWJzY3JpYmVyIH07XG52YXIgU3RhdGljSXRlcmF0b3IgPSAvKkBfX1BVUkVfXyovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gU3RhdGljSXRlcmF0b3IoaXRlcmF0b3IpIHtcbiAgICAgICAgdGhpcy5pdGVyYXRvciA9IGl0ZXJhdG9yO1xuICAgICAgICB0aGlzLm5leHRSZXN1bHQgPSBpdGVyYXRvci5uZXh0KCk7XG4gICAgfVxuICAgIFN0YXRpY0l0ZXJhdG9yLnByb3RvdHlwZS5oYXNWYWx1ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICBTdGF0aWNJdGVyYXRvci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHRoaXMubmV4dFJlc3VsdDtcbiAgICAgICAgdGhpcy5uZXh0UmVzdWx0ID0gdGhpcy5pdGVyYXRvci5uZXh0KCk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBTdGF0aWNJdGVyYXRvci5wcm90b3R5cGUuaGFzQ29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbmV4dFJlc3VsdCA9IHRoaXMubmV4dFJlc3VsdDtcbiAgICAgICAgcmV0dXJuIG5leHRSZXN1bHQgJiYgbmV4dFJlc3VsdC5kb25lO1xuICAgIH07XG4gICAgcmV0dXJuIFN0YXRpY0l0ZXJhdG9yO1xufSgpKTtcbnZhciBTdGF0aWNBcnJheUl0ZXJhdG9yID0gLypAX19QVVJFX18qLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFN0YXRpY0FycmF5SXRlcmF0b3IoYXJyYXkpIHtcbiAgICAgICAgdGhpcy5hcnJheSA9IGFycmF5O1xuICAgICAgICB0aGlzLmluZGV4ID0gMDtcbiAgICAgICAgdGhpcy5sZW5ndGggPSAwO1xuICAgICAgICB0aGlzLmxlbmd0aCA9IGFycmF5Lmxlbmd0aDtcbiAgICB9XG4gICAgU3RhdGljQXJyYXlJdGVyYXRvci5wcm90b3R5cGVbU3ltYm9sX2l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBTdGF0aWNBcnJheUl0ZXJhdG9yLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBpID0gdGhpcy5pbmRleCsrO1xuICAgICAgICB2YXIgYXJyYXkgPSB0aGlzLmFycmF5O1xuICAgICAgICByZXR1cm4gaSA8IHRoaXMubGVuZ3RoID8geyB2YWx1ZTogYXJyYXlbaV0sIGRvbmU6IGZhbHNlIH0gOiB7IHZhbHVlOiBudWxsLCBkb25lOiB0cnVlIH07XG4gICAgfTtcbiAgICBTdGF0aWNBcnJheUl0ZXJhdG9yLnByb3RvdHlwZS5oYXNWYWx1ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXJyYXkubGVuZ3RoID4gdGhpcy5pbmRleDtcbiAgICB9O1xuICAgIFN0YXRpY0FycmF5SXRlcmF0b3IucHJvdG90eXBlLmhhc0NvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXJyYXkubGVuZ3RoID09PSB0aGlzLmluZGV4O1xuICAgIH07XG4gICAgcmV0dXJuIFN0YXRpY0FycmF5SXRlcmF0b3I7XG59KCkpO1xudmFyIFppcEJ1ZmZlckl0ZXJhdG9yID0gLypAX19QVVJFX18qLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHRzbGliXzEuX19leHRlbmRzKFppcEJ1ZmZlckl0ZXJhdG9yLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFppcEJ1ZmZlckl0ZXJhdG9yKGRlc3RpbmF0aW9uLCBwYXJlbnQsIG9ic2VydmFibGUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZGVzdGluYXRpb24pIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLnBhcmVudCA9IHBhcmVudDtcbiAgICAgICAgX3RoaXMub2JzZXJ2YWJsZSA9IG9ic2VydmFibGU7XG4gICAgICAgIF90aGlzLnN0aWxsVW5zdWJzY3JpYmVkID0gdHJ1ZTtcbiAgICAgICAgX3RoaXMuYnVmZmVyID0gW107XG4gICAgICAgIF90aGlzLmlzQ29tcGxldGUgPSBmYWxzZTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBaaXBCdWZmZXJJdGVyYXRvci5wcm90b3R5cGVbU3ltYm9sX2l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBaaXBCdWZmZXJJdGVyYXRvci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGJ1ZmZlciA9IHRoaXMuYnVmZmVyO1xuICAgICAgICBpZiAoYnVmZmVyLmxlbmd0aCA9PT0gMCAmJiB0aGlzLmlzQ29tcGxldGUpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBudWxsLCBkb25lOiB0cnVlIH07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogYnVmZmVyLnNoaWZ0KCksIGRvbmU6IGZhbHNlIH07XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFppcEJ1ZmZlckl0ZXJhdG9yLnByb3RvdHlwZS5oYXNWYWx1ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYnVmZmVyLmxlbmd0aCA+IDA7XG4gICAgfTtcbiAgICBaaXBCdWZmZXJJdGVyYXRvci5wcm90b3R5cGUuaGFzQ29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5idWZmZXIubGVuZ3RoID09PSAwICYmIHRoaXMuaXNDb21wbGV0ZTtcbiAgICB9O1xuICAgIFppcEJ1ZmZlckl0ZXJhdG9yLnByb3RvdHlwZS5ub3RpZnlDb21wbGV0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuYnVmZmVyLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHRoaXMuaXNDb21wbGV0ZSA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5ub3RpZnlJbmFjdGl2ZSgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5kZXN0aW5hdGlvbi5jb21wbGV0ZSgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBaaXBCdWZmZXJJdGVyYXRvci5wcm90b3R5cGUubm90aWZ5TmV4dCA9IGZ1bmN0aW9uIChvdXRlclZhbHVlLCBpbm5lclZhbHVlLCBvdXRlckluZGV4LCBpbm5lckluZGV4LCBpbm5lclN1Yikge1xuICAgICAgICB0aGlzLmJ1ZmZlci5wdXNoKGlubmVyVmFsdWUpO1xuICAgICAgICB0aGlzLnBhcmVudC5jaGVja0l0ZXJhdG9ycygpO1xuICAgIH07XG4gICAgWmlwQnVmZmVySXRlcmF0b3IucHJvdG90eXBlLnN1YnNjcmliZSA9IGZ1bmN0aW9uICh2YWx1ZSwgaW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIHN1YnNjcmliZVRvUmVzdWx0KHRoaXMsIHRoaXMub2JzZXJ2YWJsZSwgdGhpcywgaW5kZXgpO1xuICAgIH07XG4gICAgcmV0dXJuIFppcEJ1ZmZlckl0ZXJhdG9yO1xufShPdXRlclN1YnNjcmliZXIpKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXppcC5qcy5tYXBcbiIsIi8qKiBQVVJFX0lNUE9SVFNfU1RBUlQgX21lcmdlQWxsIFBVUkVfSU1QT1JUU19FTkQgKi9cbmltcG9ydCB7IG1lcmdlQWxsIH0gZnJvbSAnLi9tZXJnZUFsbCc7XG5leHBvcnQgZnVuY3Rpb24gY29uY2F0QWxsKCkge1xuICAgIHJldHVybiBtZXJnZUFsbCgxKTtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNvbmNhdEFsbC5qcy5tYXBcbiIsIi8qKiBQVVJFX0lNUE9SVFNfU1RBUlQgdHNsaWIsX1N1YnNjcmliZXIsX1N1YnNjcmlwdGlvbixfT2JzZXJ2YWJsZSxfU3ViamVjdCBQVVJFX0lNUE9SVFNfRU5EICovXG5pbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xuaW1wb3J0IHsgU3Vic2NyaWJlciB9IGZyb20gJy4uL1N1YnNjcmliZXInO1xuaW1wb3J0IHsgU3Vic2NyaXB0aW9uIH0gZnJvbSAnLi4vU3Vic2NyaXB0aW9uJztcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICcuLi9PYnNlcnZhYmxlJztcbmltcG9ydCB7IFN1YmplY3QgfSBmcm9tICcuLi9TdWJqZWN0JztcbmV4cG9ydCBmdW5jdGlvbiBncm91cEJ5KGtleVNlbGVjdG9yLCBlbGVtZW50U2VsZWN0b3IsIGR1cmF0aW9uU2VsZWN0b3IsIHN1YmplY3RTZWxlY3Rvcikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoc291cmNlKSB7XG4gICAgICAgIHJldHVybiBzb3VyY2UubGlmdChuZXcgR3JvdXBCeU9wZXJhdG9yKGtleVNlbGVjdG9yLCBlbGVtZW50U2VsZWN0b3IsIGR1cmF0aW9uU2VsZWN0b3IsIHN1YmplY3RTZWxlY3RvcikpO1xuICAgIH07XG59XG52YXIgR3JvdXBCeU9wZXJhdG9yID0gLypAX19QVVJFX18qLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEdyb3VwQnlPcGVyYXRvcihrZXlTZWxlY3RvciwgZWxlbWVudFNlbGVjdG9yLCBkdXJhdGlvblNlbGVjdG9yLCBzdWJqZWN0U2VsZWN0b3IpIHtcbiAgICAgICAgdGhpcy5rZXlTZWxlY3RvciA9IGtleVNlbGVjdG9yO1xuICAgICAgICB0aGlzLmVsZW1lbnRTZWxlY3RvciA9IGVsZW1lbnRTZWxlY3RvcjtcbiAgICAgICAgdGhpcy5kdXJhdGlvblNlbGVjdG9yID0gZHVyYXRpb25TZWxlY3RvcjtcbiAgICAgICAgdGhpcy5zdWJqZWN0U2VsZWN0b3IgPSBzdWJqZWN0U2VsZWN0b3I7XG4gICAgfVxuICAgIEdyb3VwQnlPcGVyYXRvci5wcm90b3R5cGUuY2FsbCA9IGZ1bmN0aW9uIChzdWJzY3JpYmVyLCBzb3VyY2UpIHtcbiAgICAgICAgcmV0dXJuIHNvdXJjZS5zdWJzY3JpYmUobmV3IEdyb3VwQnlTdWJzY3JpYmVyKHN1YnNjcmliZXIsIHRoaXMua2V5U2VsZWN0b3IsIHRoaXMuZWxlbWVudFNlbGVjdG9yLCB0aGlzLmR1cmF0aW9uU2VsZWN0b3IsIHRoaXMuc3ViamVjdFNlbGVjdG9yKSk7XG4gICAgfTtcbiAgICByZXR1cm4gR3JvdXBCeU9wZXJhdG9yO1xufSgpKTtcbnZhciBHcm91cEJ5U3Vic2NyaWJlciA9IC8qQF9fUFVSRV9fKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhHcm91cEJ5U3Vic2NyaWJlciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBHcm91cEJ5U3Vic2NyaWJlcihkZXN0aW5hdGlvbiwga2V5U2VsZWN0b3IsIGVsZW1lbnRTZWxlY3RvciwgZHVyYXRpb25TZWxlY3Rvciwgc3ViamVjdFNlbGVjdG9yKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGRlc3RpbmF0aW9uKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5rZXlTZWxlY3RvciA9IGtleVNlbGVjdG9yO1xuICAgICAgICBfdGhpcy5lbGVtZW50U2VsZWN0b3IgPSBlbGVtZW50U2VsZWN0b3I7XG4gICAgICAgIF90aGlzLmR1cmF0aW9uU2VsZWN0b3IgPSBkdXJhdGlvblNlbGVjdG9yO1xuICAgICAgICBfdGhpcy5zdWJqZWN0U2VsZWN0b3IgPSBzdWJqZWN0U2VsZWN0b3I7XG4gICAgICAgIF90aGlzLmdyb3VwcyA9IG51bGw7XG4gICAgICAgIF90aGlzLmF0dGVtcHRlZFRvVW5zdWJzY3JpYmUgPSBmYWxzZTtcbiAgICAgICAgX3RoaXMuY291bnQgPSAwO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIEdyb3VwQnlTdWJzY3JpYmVyLnByb3RvdHlwZS5fbmV4dCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIga2V5O1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAga2V5ID0gdGhpcy5rZXlTZWxlY3Rvcih2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgdGhpcy5lcnJvcihlcnIpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2dyb3VwKHZhbHVlLCBrZXkpO1xuICAgIH07XG4gICAgR3JvdXBCeVN1YnNjcmliZXIucHJvdG90eXBlLl9ncm91cCA9IGZ1bmN0aW9uICh2YWx1ZSwga2V5KSB7XG4gICAgICAgIHZhciBncm91cHMgPSB0aGlzLmdyb3VwcztcbiAgICAgICAgaWYgKCFncm91cHMpIHtcbiAgICAgICAgICAgIGdyb3VwcyA9IHRoaXMuZ3JvdXBzID0gbmV3IE1hcCgpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBncm91cCA9IGdyb3Vwcy5nZXQoa2V5KTtcbiAgICAgICAgdmFyIGVsZW1lbnQ7XG4gICAgICAgIGlmICh0aGlzLmVsZW1lbnRTZWxlY3Rvcikge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBlbGVtZW50ID0gdGhpcy5lbGVtZW50U2VsZWN0b3IodmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgIHRoaXMuZXJyb3IoZXJyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGVsZW1lbnQgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWdyb3VwKSB7XG4gICAgICAgICAgICBncm91cCA9ICh0aGlzLnN1YmplY3RTZWxlY3RvciA/IHRoaXMuc3ViamVjdFNlbGVjdG9yKCkgOiBuZXcgU3ViamVjdCgpKTtcbiAgICAgICAgICAgIGdyb3Vwcy5zZXQoa2V5LCBncm91cCk7XG4gICAgICAgICAgICB2YXIgZ3JvdXBlZE9ic2VydmFibGUgPSBuZXcgR3JvdXBlZE9ic2VydmFibGUoa2V5LCBncm91cCwgdGhpcyk7XG4gICAgICAgICAgICB0aGlzLmRlc3RpbmF0aW9uLm5leHQoZ3JvdXBlZE9ic2VydmFibGUpO1xuICAgICAgICAgICAgaWYgKHRoaXMuZHVyYXRpb25TZWxlY3Rvcikge1xuICAgICAgICAgICAgICAgIHZhciBkdXJhdGlvbiA9IHZvaWQgMDtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbiA9IHRoaXMuZHVyYXRpb25TZWxlY3RvcihuZXcgR3JvdXBlZE9ic2VydmFibGUoa2V5LCBncm91cCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZXJyb3IoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmFkZChkdXJhdGlvbi5zdWJzY3JpYmUobmV3IEdyb3VwRHVyYXRpb25TdWJzY3JpYmVyKGtleSwgZ3JvdXAsIHRoaXMpKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFncm91cC5jbG9zZWQpIHtcbiAgICAgICAgICAgIGdyb3VwLm5leHQoZWxlbWVudCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEdyb3VwQnlTdWJzY3JpYmVyLnByb3RvdHlwZS5fZXJyb3IgPSBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgIHZhciBncm91cHMgPSB0aGlzLmdyb3VwcztcbiAgICAgICAgaWYgKGdyb3Vwcykge1xuICAgICAgICAgICAgZ3JvdXBzLmZvckVhY2goZnVuY3Rpb24gKGdyb3VwLCBrZXkpIHtcbiAgICAgICAgICAgICAgICBncm91cC5lcnJvcihlcnIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBncm91cHMuY2xlYXIoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmRlc3RpbmF0aW9uLmVycm9yKGVycik7XG4gICAgfTtcbiAgICBHcm91cEJ5U3Vic2NyaWJlci5wcm90b3R5cGUuX2NvbXBsZXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZ3JvdXBzID0gdGhpcy5ncm91cHM7XG4gICAgICAgIGlmIChncm91cHMpIHtcbiAgICAgICAgICAgIGdyb3Vwcy5mb3JFYWNoKGZ1bmN0aW9uIChncm91cCwga2V5KSB7XG4gICAgICAgICAgICAgICAgZ3JvdXAuY29tcGxldGUoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZ3JvdXBzLmNsZWFyKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5kZXN0aW5hdGlvbi5jb21wbGV0ZSgpO1xuICAgIH07XG4gICAgR3JvdXBCeVN1YnNjcmliZXIucHJvdG90eXBlLnJlbW92ZUdyb3VwID0gZnVuY3Rpb24gKGtleSkge1xuICAgICAgICB0aGlzLmdyb3Vwcy5kZWxldGUoa2V5KTtcbiAgICB9O1xuICAgIEdyb3VwQnlTdWJzY3JpYmVyLnByb3RvdHlwZS51bnN1YnNjcmliZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmNsb3NlZCkge1xuICAgICAgICAgICAgdGhpcy5hdHRlbXB0ZWRUb1Vuc3Vic2NyaWJlID0gdHJ1ZTtcbiAgICAgICAgICAgIGlmICh0aGlzLmNvdW50ID09PSAwKSB7XG4gICAgICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS51bnN1YnNjcmliZS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gR3JvdXBCeVN1YnNjcmliZXI7XG59KFN1YnNjcmliZXIpKTtcbnZhciBHcm91cER1cmF0aW9uU3Vic2NyaWJlciA9IC8qQF9fUFVSRV9fKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhHcm91cER1cmF0aW9uU3Vic2NyaWJlciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBHcm91cER1cmF0aW9uU3Vic2NyaWJlcihrZXksIGdyb3VwLCBwYXJlbnQpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZ3JvdXApIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmtleSA9IGtleTtcbiAgICAgICAgX3RoaXMuZ3JvdXAgPSBncm91cDtcbiAgICAgICAgX3RoaXMucGFyZW50ID0gcGFyZW50O1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIEdyb3VwRHVyYXRpb25TdWJzY3JpYmVyLnByb3RvdHlwZS5fbmV4dCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLmNvbXBsZXRlKCk7XG4gICAgfTtcbiAgICBHcm91cER1cmF0aW9uU3Vic2NyaWJlci5wcm90b3R5cGUuX3Vuc3Vic2NyaWJlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX2EgPSB0aGlzLCBwYXJlbnQgPSBfYS5wYXJlbnQsIGtleSA9IF9hLmtleTtcbiAgICAgICAgdGhpcy5rZXkgPSB0aGlzLnBhcmVudCA9IG51bGw7XG4gICAgICAgIGlmIChwYXJlbnQpIHtcbiAgICAgICAgICAgIHBhcmVudC5yZW1vdmVHcm91cChrZXkpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gR3JvdXBEdXJhdGlvblN1YnNjcmliZXI7XG59KFN1YnNjcmliZXIpKTtcbnZhciBHcm91cGVkT2JzZXJ2YWJsZSA9IC8qQF9fUFVSRV9fKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhHcm91cGVkT2JzZXJ2YWJsZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBHcm91cGVkT2JzZXJ2YWJsZShrZXksIGdyb3VwU3ViamVjdCwgcmVmQ291bnRTdWJzY3JpcHRpb24pIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMua2V5ID0ga2V5O1xuICAgICAgICBfdGhpcy5ncm91cFN1YmplY3QgPSBncm91cFN1YmplY3Q7XG4gICAgICAgIF90aGlzLnJlZkNvdW50U3Vic2NyaXB0aW9uID0gcmVmQ291bnRTdWJzY3JpcHRpb247XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgR3JvdXBlZE9ic2VydmFibGUucHJvdG90eXBlLl9zdWJzY3JpYmUgPSBmdW5jdGlvbiAoc3Vic2NyaWJlcikge1xuICAgICAgICB2YXIgc3Vic2NyaXB0aW9uID0gbmV3IFN1YnNjcmlwdGlvbigpO1xuICAgICAgICB2YXIgX2EgPSB0aGlzLCByZWZDb3VudFN1YnNjcmlwdGlvbiA9IF9hLnJlZkNvdW50U3Vic2NyaXB0aW9uLCBncm91cFN1YmplY3QgPSBfYS5ncm91cFN1YmplY3Q7XG4gICAgICAgIGlmIChyZWZDb3VudFN1YnNjcmlwdGlvbiAmJiAhcmVmQ291bnRTdWJzY3JpcHRpb24uY2xvc2VkKSB7XG4gICAgICAgICAgICBzdWJzY3JpcHRpb24uYWRkKG5ldyBJbm5lclJlZkNvdW50U3Vic2NyaXB0aW9uKHJlZkNvdW50U3Vic2NyaXB0aW9uKSk7XG4gICAgICAgIH1cbiAgICAgICAgc3Vic2NyaXB0aW9uLmFkZChncm91cFN1YmplY3Quc3Vic2NyaWJlKHN1YnNjcmliZXIpKTtcbiAgICAgICAgcmV0dXJuIHN1YnNjcmlwdGlvbjtcbiAgICB9O1xuICAgIHJldHVybiBHcm91cGVkT2JzZXJ2YWJsZTtcbn0oT2JzZXJ2YWJsZSkpO1xuZXhwb3J0IHsgR3JvdXBlZE9ic2VydmFibGUgfTtcbnZhciBJbm5lclJlZkNvdW50U3Vic2NyaXB0aW9uID0gLypAX19QVVJFX18qLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHRzbGliXzEuX19leHRlbmRzKElubmVyUmVmQ291bnRTdWJzY3JpcHRpb24sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gSW5uZXJSZWZDb3VudFN1YnNjcmlwdGlvbihwYXJlbnQpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMucGFyZW50ID0gcGFyZW50O1xuICAgICAgICBwYXJlbnQuY291bnQrKztcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBJbm5lclJlZkNvdW50U3Vic2NyaXB0aW9uLnByb3RvdHlwZS51bnN1YnNjcmliZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50O1xuICAgICAgICBpZiAoIXBhcmVudC5jbG9zZWQgJiYgIXRoaXMuY2xvc2VkKSB7XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLnVuc3Vic2NyaWJlLmNhbGwodGhpcyk7XG4gICAgICAgICAgICBwYXJlbnQuY291bnQgLT0gMTtcbiAgICAgICAgICAgIGlmIChwYXJlbnQuY291bnQgPT09IDAgJiYgcGFyZW50LmF0dGVtcHRlZFRvVW5zdWJzY3JpYmUpIHtcbiAgICAgICAgICAgICAgICBwYXJlbnQudW5zdWJzY3JpYmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIElubmVyUmVmQ291bnRTdWJzY3JpcHRpb247XG59KFN1YnNjcmlwdGlvbikpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Z3JvdXBCeS5qcy5tYXBcbiIsIi8qKiBQVVJFX0lNUE9SVFNfU1RBUlQgdHNsaWIsX1N1YnNjcmliZXIgUFVSRV9JTVBPUlRTX0VORCAqL1xuaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IFN1YnNjcmliZXIgfSBmcm9tICcuLi9TdWJzY3JpYmVyJztcbmV4cG9ydCBmdW5jdGlvbiBtYXAocHJvamVjdCwgdGhpc0FyZykge1xuICAgIHJldHVybiBmdW5jdGlvbiBtYXBPcGVyYXRpb24oc291cmNlKSB7XG4gICAgICAgIGlmICh0eXBlb2YgcHJvamVjdCAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignYXJndW1lbnQgaXMgbm90IGEgZnVuY3Rpb24uIEFyZSB5b3UgbG9va2luZyBmb3IgYG1hcFRvKClgPycpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzb3VyY2UubGlmdChuZXcgTWFwT3BlcmF0b3IocHJvamVjdCwgdGhpc0FyZykpO1xuICAgIH07XG59XG52YXIgTWFwT3BlcmF0b3IgPSAvKkBfX1BVUkVfXyovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gTWFwT3BlcmF0b3IocHJvamVjdCwgdGhpc0FyZykge1xuICAgICAgICB0aGlzLnByb2plY3QgPSBwcm9qZWN0O1xuICAgICAgICB0aGlzLnRoaXNBcmcgPSB0aGlzQXJnO1xuICAgIH1cbiAgICBNYXBPcGVyYXRvci5wcm90b3R5cGUuY2FsbCA9IGZ1bmN0aW9uIChzdWJzY3JpYmVyLCBzb3VyY2UpIHtcbiAgICAgICAgcmV0dXJuIHNvdXJjZS5zdWJzY3JpYmUobmV3IE1hcFN1YnNjcmliZXIoc3Vic2NyaWJlciwgdGhpcy5wcm9qZWN0LCB0aGlzLnRoaXNBcmcpKTtcbiAgICB9O1xuICAgIHJldHVybiBNYXBPcGVyYXRvcjtcbn0oKSk7XG5leHBvcnQgeyBNYXBPcGVyYXRvciB9O1xudmFyIE1hcFN1YnNjcmliZXIgPSAvKkBfX1BVUkVfXyovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoTWFwU3Vic2NyaWJlciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBNYXBTdWJzY3JpYmVyKGRlc3RpbmF0aW9uLCBwcm9qZWN0LCB0aGlzQXJnKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGRlc3RpbmF0aW9uKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5wcm9qZWN0ID0gcHJvamVjdDtcbiAgICAgICAgX3RoaXMuY291bnQgPSAwO1xuICAgICAgICBfdGhpcy50aGlzQXJnID0gdGhpc0FyZyB8fCBfdGhpcztcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBNYXBTdWJzY3JpYmVyLnByb3RvdHlwZS5fbmV4dCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgcmVzdWx0O1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy5wcm9qZWN0LmNhbGwodGhpcy50aGlzQXJnLCB2YWx1ZSwgdGhpcy5jb3VudCsrKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICB0aGlzLmRlc3RpbmF0aW9uLmVycm9yKGVycik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5kZXN0aW5hdGlvbi5uZXh0KHJlc3VsdCk7XG4gICAgfTtcbiAgICByZXR1cm4gTWFwU3Vic2NyaWJlcjtcbn0oU3Vic2NyaWJlcikpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bWFwLmpzLm1hcFxuIiwiLyoqIFBVUkVfSU1QT1JUU19TVEFSVCBfbWVyZ2VNYXAsX3V0aWxfaWRlbnRpdHkgUFVSRV9JTVBPUlRTX0VORCAqL1xuaW1wb3J0IHsgbWVyZ2VNYXAgfSBmcm9tICcuL21lcmdlTWFwJztcbmltcG9ydCB7IGlkZW50aXR5IH0gZnJvbSAnLi4vdXRpbC9pZGVudGl0eSc7XG5leHBvcnQgZnVuY3Rpb24gbWVyZ2VBbGwoY29uY3VycmVudCkge1xuICAgIGlmIChjb25jdXJyZW50ID09PSB2b2lkIDApIHtcbiAgICAgICAgY29uY3VycmVudCA9IE51bWJlci5QT1NJVElWRV9JTkZJTklUWTtcbiAgICB9XG4gICAgcmV0dXJuIG1lcmdlTWFwKGlkZW50aXR5LCBjb25jdXJyZW50KTtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1lcmdlQWxsLmpzLm1hcFxuIiwiLyoqIFBVUkVfSU1QT1JUU19TVEFSVCB0c2xpYixfdXRpbF9zdWJzY3JpYmVUb1Jlc3VsdCxfT3V0ZXJTdWJzY3JpYmVyLF9Jbm5lclN1YnNjcmliZXIsX21hcCxfb2JzZXJ2YWJsZV9mcm9tIFBVUkVfSU1QT1JUU19FTkQgKi9cbmltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XG5pbXBvcnQgeyBzdWJzY3JpYmVUb1Jlc3VsdCB9IGZyb20gJy4uL3V0aWwvc3Vic2NyaWJlVG9SZXN1bHQnO1xuaW1wb3J0IHsgT3V0ZXJTdWJzY3JpYmVyIH0gZnJvbSAnLi4vT3V0ZXJTdWJzY3JpYmVyJztcbmltcG9ydCB7IElubmVyU3Vic2NyaWJlciB9IGZyb20gJy4uL0lubmVyU3Vic2NyaWJlcic7XG5pbXBvcnQgeyBtYXAgfSBmcm9tICcuL21hcCc7XG5pbXBvcnQgeyBmcm9tIH0gZnJvbSAnLi4vb2JzZXJ2YWJsZS9mcm9tJztcbmV4cG9ydCBmdW5jdGlvbiBtZXJnZU1hcChwcm9qZWN0LCByZXN1bHRTZWxlY3RvciwgY29uY3VycmVudCkge1xuICAgIGlmIChjb25jdXJyZW50ID09PSB2b2lkIDApIHtcbiAgICAgICAgY29uY3VycmVudCA9IE51bWJlci5QT1NJVElWRV9JTkZJTklUWTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiByZXN1bHRTZWxlY3RvciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHNvdXJjZSkgeyByZXR1cm4gc291cmNlLnBpcGUobWVyZ2VNYXAoZnVuY3Rpb24gKGEsIGkpIHsgcmV0dXJuIGZyb20ocHJvamVjdChhLCBpKSkucGlwZShtYXAoZnVuY3Rpb24gKGIsIGlpKSB7IHJldHVybiByZXN1bHRTZWxlY3RvcihhLCBiLCBpLCBpaSk7IH0pKTsgfSwgY29uY3VycmVudCkpOyB9O1xuICAgIH1cbiAgICBlbHNlIGlmICh0eXBlb2YgcmVzdWx0U2VsZWN0b3IgPT09ICdudW1iZXInKSB7XG4gICAgICAgIGNvbmN1cnJlbnQgPSByZXN1bHRTZWxlY3RvcjtcbiAgICB9XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChzb3VyY2UpIHsgcmV0dXJuIHNvdXJjZS5saWZ0KG5ldyBNZXJnZU1hcE9wZXJhdG9yKHByb2plY3QsIGNvbmN1cnJlbnQpKTsgfTtcbn1cbnZhciBNZXJnZU1hcE9wZXJhdG9yID0gLypAX19QVVJFX18qLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIE1lcmdlTWFwT3BlcmF0b3IocHJvamVjdCwgY29uY3VycmVudCkge1xuICAgICAgICBpZiAoY29uY3VycmVudCA9PT0gdm9pZCAwKSB7XG4gICAgICAgICAgICBjb25jdXJyZW50ID0gTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucHJvamVjdCA9IHByb2plY3Q7XG4gICAgICAgIHRoaXMuY29uY3VycmVudCA9IGNvbmN1cnJlbnQ7XG4gICAgfVxuICAgIE1lcmdlTWFwT3BlcmF0b3IucHJvdG90eXBlLmNhbGwgPSBmdW5jdGlvbiAob2JzZXJ2ZXIsIHNvdXJjZSkge1xuICAgICAgICByZXR1cm4gc291cmNlLnN1YnNjcmliZShuZXcgTWVyZ2VNYXBTdWJzY3JpYmVyKG9ic2VydmVyLCB0aGlzLnByb2plY3QsIHRoaXMuY29uY3VycmVudCkpO1xuICAgIH07XG4gICAgcmV0dXJuIE1lcmdlTWFwT3BlcmF0b3I7XG59KCkpO1xuZXhwb3J0IHsgTWVyZ2VNYXBPcGVyYXRvciB9O1xudmFyIE1lcmdlTWFwU3Vic2NyaWJlciA9IC8qQF9fUFVSRV9fKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhNZXJnZU1hcFN1YnNjcmliZXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gTWVyZ2VNYXBTdWJzY3JpYmVyKGRlc3RpbmF0aW9uLCBwcm9qZWN0LCBjb25jdXJyZW50KSB7XG4gICAgICAgIGlmIChjb25jdXJyZW50ID09PSB2b2lkIDApIHtcbiAgICAgICAgICAgIGNvbmN1cnJlbnQgPSBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZGVzdGluYXRpb24pIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLnByb2plY3QgPSBwcm9qZWN0O1xuICAgICAgICBfdGhpcy5jb25jdXJyZW50ID0gY29uY3VycmVudDtcbiAgICAgICAgX3RoaXMuaGFzQ29tcGxldGVkID0gZmFsc2U7XG4gICAgICAgIF90aGlzLmJ1ZmZlciA9IFtdO1xuICAgICAgICBfdGhpcy5hY3RpdmUgPSAwO1xuICAgICAgICBfdGhpcy5pbmRleCA9IDA7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgTWVyZ2VNYXBTdWJzY3JpYmVyLnByb3RvdHlwZS5fbmV4dCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy5hY3RpdmUgPCB0aGlzLmNvbmN1cnJlbnQpIHtcbiAgICAgICAgICAgIHRoaXMuX3RyeU5leHQodmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5idWZmZXIucHVzaCh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE1lcmdlTWFwU3Vic2NyaWJlci5wcm90b3R5cGUuX3RyeU5leHQgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIHJlc3VsdDtcbiAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5pbmRleCsrO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy5wcm9qZWN0KHZhbHVlLCBpbmRleCk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgdGhpcy5kZXN0aW5hdGlvbi5lcnJvcihlcnIpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuYWN0aXZlKys7XG4gICAgICAgIHRoaXMuX2lubmVyU3ViKHJlc3VsdCwgdmFsdWUsIGluZGV4KTtcbiAgICB9O1xuICAgIE1lcmdlTWFwU3Vic2NyaWJlci5wcm90b3R5cGUuX2lubmVyU3ViID0gZnVuY3Rpb24gKGlzaCwgdmFsdWUsIGluZGV4KSB7XG4gICAgICAgIHZhciBpbm5lclN1YnNjcmliZXIgPSBuZXcgSW5uZXJTdWJzY3JpYmVyKHRoaXMsIHVuZGVmaW5lZCwgdW5kZWZpbmVkKTtcbiAgICAgICAgdmFyIGRlc3RpbmF0aW9uID0gdGhpcy5kZXN0aW5hdGlvbjtcbiAgICAgICAgZGVzdGluYXRpb24uYWRkKGlubmVyU3Vic2NyaWJlcik7XG4gICAgICAgIHN1YnNjcmliZVRvUmVzdWx0KHRoaXMsIGlzaCwgdmFsdWUsIGluZGV4LCBpbm5lclN1YnNjcmliZXIpO1xuICAgIH07XG4gICAgTWVyZ2VNYXBTdWJzY3JpYmVyLnByb3RvdHlwZS5fY29tcGxldGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuaGFzQ29tcGxldGVkID0gdHJ1ZTtcbiAgICAgICAgaWYgKHRoaXMuYWN0aXZlID09PSAwICYmIHRoaXMuYnVmZmVyLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy5kZXN0aW5hdGlvbi5jb21wbGV0ZSgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudW5zdWJzY3JpYmUoKTtcbiAgICB9O1xuICAgIE1lcmdlTWFwU3Vic2NyaWJlci5wcm90b3R5cGUubm90aWZ5TmV4dCA9IGZ1bmN0aW9uIChvdXRlclZhbHVlLCBpbm5lclZhbHVlLCBvdXRlckluZGV4LCBpbm5lckluZGV4LCBpbm5lclN1Yikge1xuICAgICAgICB0aGlzLmRlc3RpbmF0aW9uLm5leHQoaW5uZXJWYWx1ZSk7XG4gICAgfTtcbiAgICBNZXJnZU1hcFN1YnNjcmliZXIucHJvdG90eXBlLm5vdGlmeUNvbXBsZXRlID0gZnVuY3Rpb24gKGlubmVyU3ViKSB7XG4gICAgICAgIHZhciBidWZmZXIgPSB0aGlzLmJ1ZmZlcjtcbiAgICAgICAgdGhpcy5yZW1vdmUoaW5uZXJTdWIpO1xuICAgICAgICB0aGlzLmFjdGl2ZS0tO1xuICAgICAgICBpZiAoYnVmZmVyLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHRoaXMuX25leHQoYnVmZmVyLnNoaWZ0KCkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuYWN0aXZlID09PSAwICYmIHRoaXMuaGFzQ29tcGxldGVkKSB7XG4gICAgICAgICAgICB0aGlzLmRlc3RpbmF0aW9uLmNvbXBsZXRlKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBNZXJnZU1hcFN1YnNjcmliZXI7XG59KE91dGVyU3Vic2NyaWJlcikpO1xuZXhwb3J0IHsgTWVyZ2VNYXBTdWJzY3JpYmVyIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tZXJnZU1hcC5qcy5tYXBcbiIsIi8qKiBQVVJFX0lNUE9SVFNfU1RBUlQgdHNsaWIsX1N1YnNjcmliZXIsX05vdGlmaWNhdGlvbiBQVVJFX0lNUE9SVFNfRU5EICovXG5pbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xuaW1wb3J0IHsgU3Vic2NyaWJlciB9IGZyb20gJy4uL1N1YnNjcmliZXInO1xuaW1wb3J0IHsgTm90aWZpY2F0aW9uIH0gZnJvbSAnLi4vTm90aWZpY2F0aW9uJztcbmV4cG9ydCBmdW5jdGlvbiBvYnNlcnZlT24oc2NoZWR1bGVyLCBkZWxheSkge1xuICAgIGlmIChkZWxheSA9PT0gdm9pZCAwKSB7XG4gICAgICAgIGRlbGF5ID0gMDtcbiAgICB9XG4gICAgcmV0dXJuIGZ1bmN0aW9uIG9ic2VydmVPbk9wZXJhdG9yRnVuY3Rpb24oc291cmNlKSB7XG4gICAgICAgIHJldHVybiBzb3VyY2UubGlmdChuZXcgT2JzZXJ2ZU9uT3BlcmF0b3Ioc2NoZWR1bGVyLCBkZWxheSkpO1xuICAgIH07XG59XG52YXIgT2JzZXJ2ZU9uT3BlcmF0b3IgPSAvKkBfX1BVUkVfXyovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gT2JzZXJ2ZU9uT3BlcmF0b3Ioc2NoZWR1bGVyLCBkZWxheSkge1xuICAgICAgICBpZiAoZGVsYXkgPT09IHZvaWQgMCkge1xuICAgICAgICAgICAgZGVsYXkgPSAwO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuICAgICAgICB0aGlzLmRlbGF5ID0gZGVsYXk7XG4gICAgfVxuICAgIE9ic2VydmVPbk9wZXJhdG9yLnByb3RvdHlwZS5jYWxsID0gZnVuY3Rpb24gKHN1YnNjcmliZXIsIHNvdXJjZSkge1xuICAgICAgICByZXR1cm4gc291cmNlLnN1YnNjcmliZShuZXcgT2JzZXJ2ZU9uU3Vic2NyaWJlcihzdWJzY3JpYmVyLCB0aGlzLnNjaGVkdWxlciwgdGhpcy5kZWxheSkpO1xuICAgIH07XG4gICAgcmV0dXJuIE9ic2VydmVPbk9wZXJhdG9yO1xufSgpKTtcbmV4cG9ydCB7IE9ic2VydmVPbk9wZXJhdG9yIH07XG52YXIgT2JzZXJ2ZU9uU3Vic2NyaWJlciA9IC8qQF9fUFVSRV9fKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhPYnNlcnZlT25TdWJzY3JpYmVyLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIE9ic2VydmVPblN1YnNjcmliZXIoZGVzdGluYXRpb24sIHNjaGVkdWxlciwgZGVsYXkpIHtcbiAgICAgICAgaWYgKGRlbGF5ID09PSB2b2lkIDApIHtcbiAgICAgICAgICAgIGRlbGF5ID0gMDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBkZXN0aW5hdGlvbikgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuICAgICAgICBfdGhpcy5kZWxheSA9IGRlbGF5O1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9ic2VydmVPblN1YnNjcmliZXIuZGlzcGF0Y2ggPSBmdW5jdGlvbiAoYXJnKSB7XG4gICAgICAgIHZhciBub3RpZmljYXRpb24gPSBhcmcubm90aWZpY2F0aW9uLCBkZXN0aW5hdGlvbiA9IGFyZy5kZXN0aW5hdGlvbjtcbiAgICAgICAgbm90aWZpY2F0aW9uLm9ic2VydmUoZGVzdGluYXRpb24pO1xuICAgICAgICB0aGlzLnVuc3Vic2NyaWJlKCk7XG4gICAgfTtcbiAgICBPYnNlcnZlT25TdWJzY3JpYmVyLnByb3RvdHlwZS5zY2hlZHVsZU1lc3NhZ2UgPSBmdW5jdGlvbiAobm90aWZpY2F0aW9uKSB7XG4gICAgICAgIHZhciBkZXN0aW5hdGlvbiA9IHRoaXMuZGVzdGluYXRpb247XG4gICAgICAgIGRlc3RpbmF0aW9uLmFkZCh0aGlzLnNjaGVkdWxlci5zY2hlZHVsZShPYnNlcnZlT25TdWJzY3JpYmVyLmRpc3BhdGNoLCB0aGlzLmRlbGF5LCBuZXcgT2JzZXJ2ZU9uTWVzc2FnZShub3RpZmljYXRpb24sIHRoaXMuZGVzdGluYXRpb24pKSk7XG4gICAgfTtcbiAgICBPYnNlcnZlT25TdWJzY3JpYmVyLnByb3RvdHlwZS5fbmV4dCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLnNjaGVkdWxlTWVzc2FnZShOb3RpZmljYXRpb24uY3JlYXRlTmV4dCh2YWx1ZSkpO1xuICAgIH07XG4gICAgT2JzZXJ2ZU9uU3Vic2NyaWJlci5wcm90b3R5cGUuX2Vycm9yID0gZnVuY3Rpb24gKGVycikge1xuICAgICAgICB0aGlzLnNjaGVkdWxlTWVzc2FnZShOb3RpZmljYXRpb24uY3JlYXRlRXJyb3IoZXJyKSk7XG4gICAgICAgIHRoaXMudW5zdWJzY3JpYmUoKTtcbiAgICB9O1xuICAgIE9ic2VydmVPblN1YnNjcmliZXIucHJvdG90eXBlLl9jb21wbGV0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5zY2hlZHVsZU1lc3NhZ2UoTm90aWZpY2F0aW9uLmNyZWF0ZUNvbXBsZXRlKCkpO1xuICAgICAgICB0aGlzLnVuc3Vic2NyaWJlKCk7XG4gICAgfTtcbiAgICByZXR1cm4gT2JzZXJ2ZU9uU3Vic2NyaWJlcjtcbn0oU3Vic2NyaWJlcikpO1xuZXhwb3J0IHsgT2JzZXJ2ZU9uU3Vic2NyaWJlciB9O1xudmFyIE9ic2VydmVPbk1lc3NhZ2UgPSAvKkBfX1BVUkVfXyovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gT2JzZXJ2ZU9uTWVzc2FnZShub3RpZmljYXRpb24sIGRlc3RpbmF0aW9uKSB7XG4gICAgICAgIHRoaXMubm90aWZpY2F0aW9uID0gbm90aWZpY2F0aW9uO1xuICAgICAgICB0aGlzLmRlc3RpbmF0aW9uID0gZGVzdGluYXRpb247XG4gICAgfVxuICAgIHJldHVybiBPYnNlcnZlT25NZXNzYWdlO1xufSgpKTtcbmV4cG9ydCB7IE9ic2VydmVPbk1lc3NhZ2UgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW9ic2VydmVPbi5qcy5tYXBcbiIsIi8qKiBQVVJFX0lNUE9SVFNfU1RBUlQgdHNsaWIsX1N1YnNjcmliZXIgUFVSRV9JTVBPUlRTX0VORCAqL1xuaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IFN1YnNjcmliZXIgfSBmcm9tICcuLi9TdWJzY3JpYmVyJztcbmV4cG9ydCBmdW5jdGlvbiByZWZDb3VudCgpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gcmVmQ291bnRPcGVyYXRvckZ1bmN0aW9uKHNvdXJjZSkge1xuICAgICAgICByZXR1cm4gc291cmNlLmxpZnQobmV3IFJlZkNvdW50T3BlcmF0b3Ioc291cmNlKSk7XG4gICAgfTtcbn1cbnZhciBSZWZDb3VudE9wZXJhdG9yID0gLypAX19QVVJFX18qLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFJlZkNvdW50T3BlcmF0b3IoY29ubmVjdGFibGUpIHtcbiAgICAgICAgdGhpcy5jb25uZWN0YWJsZSA9IGNvbm5lY3RhYmxlO1xuICAgIH1cbiAgICBSZWZDb3VudE9wZXJhdG9yLnByb3RvdHlwZS5jYWxsID0gZnVuY3Rpb24gKHN1YnNjcmliZXIsIHNvdXJjZSkge1xuICAgICAgICB2YXIgY29ubmVjdGFibGUgPSB0aGlzLmNvbm5lY3RhYmxlO1xuICAgICAgICBjb25uZWN0YWJsZS5fcmVmQ291bnQrKztcbiAgICAgICAgdmFyIHJlZkNvdW50ZXIgPSBuZXcgUmVmQ291bnRTdWJzY3JpYmVyKHN1YnNjcmliZXIsIGNvbm5lY3RhYmxlKTtcbiAgICAgICAgdmFyIHN1YnNjcmlwdGlvbiA9IHNvdXJjZS5zdWJzY3JpYmUocmVmQ291bnRlcik7XG4gICAgICAgIGlmICghcmVmQ291bnRlci5jbG9zZWQpIHtcbiAgICAgICAgICAgIHJlZkNvdW50ZXIuY29ubmVjdGlvbiA9IGNvbm5lY3RhYmxlLmNvbm5lY3QoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3Vic2NyaXB0aW9uO1xuICAgIH07XG4gICAgcmV0dXJuIFJlZkNvdW50T3BlcmF0b3I7XG59KCkpO1xudmFyIFJlZkNvdW50U3Vic2NyaWJlciA9IC8qQF9fUFVSRV9fKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhSZWZDb3VudFN1YnNjcmliZXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gUmVmQ291bnRTdWJzY3JpYmVyKGRlc3RpbmF0aW9uLCBjb25uZWN0YWJsZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBkZXN0aW5hdGlvbikgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuY29ubmVjdGFibGUgPSBjb25uZWN0YWJsZTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBSZWZDb3VudFN1YnNjcmliZXIucHJvdG90eXBlLl91bnN1YnNjcmliZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGNvbm5lY3RhYmxlID0gdGhpcy5jb25uZWN0YWJsZTtcbiAgICAgICAgaWYgKCFjb25uZWN0YWJsZSkge1xuICAgICAgICAgICAgdGhpcy5jb25uZWN0aW9uID0gbnVsbDtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNvbm5lY3RhYmxlID0gbnVsbDtcbiAgICAgICAgdmFyIHJlZkNvdW50ID0gY29ubmVjdGFibGUuX3JlZkNvdW50O1xuICAgICAgICBpZiAocmVmQ291bnQgPD0gMCkge1xuICAgICAgICAgICAgdGhpcy5jb25uZWN0aW9uID0gbnVsbDtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25uZWN0YWJsZS5fcmVmQ291bnQgPSByZWZDb3VudCAtIDE7XG4gICAgICAgIGlmIChyZWZDb3VudCA+IDEpIHtcbiAgICAgICAgICAgIHRoaXMuY29ubmVjdGlvbiA9IG51bGw7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNvbm5lY3Rpb24gPSB0aGlzLmNvbm5lY3Rpb247XG4gICAgICAgIHZhciBzaGFyZWRDb25uZWN0aW9uID0gY29ubmVjdGFibGUuX2Nvbm5lY3Rpb247XG4gICAgICAgIHRoaXMuY29ubmVjdGlvbiA9IG51bGw7XG4gICAgICAgIGlmIChzaGFyZWRDb25uZWN0aW9uICYmICghY29ubmVjdGlvbiB8fCBzaGFyZWRDb25uZWN0aW9uID09PSBjb25uZWN0aW9uKSkge1xuICAgICAgICAgICAgc2hhcmVkQ29ubmVjdGlvbi51bnN1YnNjcmliZSgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gUmVmQ291bnRTdWJzY3JpYmVyO1xufShTdWJzY3JpYmVyKSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1yZWZDb3VudC5qcy5tYXBcbiIsIi8qKiBQVVJFX0lNUE9SVFNfU1RBUlQgdHNsaWIsX1N1YnNjcmlwdGlvbiBQVVJFX0lNUE9SVFNfRU5EICovXG5pbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xuaW1wb3J0IHsgU3Vic2NyaXB0aW9uIH0gZnJvbSAnLi4vU3Vic2NyaXB0aW9uJztcbnZhciBBY3Rpb24gPSAvKkBfX1BVUkVfXyovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoQWN0aW9uLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEFjdGlvbihzY2hlZHVsZXIsIHdvcmspIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgfVxuICAgIEFjdGlvbi5wcm90b3R5cGUuc2NoZWR1bGUgPSBmdW5jdGlvbiAoc3RhdGUsIGRlbGF5KSB7XG4gICAgICAgIGlmIChkZWxheSA9PT0gdm9pZCAwKSB7XG4gICAgICAgICAgICBkZWxheSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICByZXR1cm4gQWN0aW9uO1xufShTdWJzY3JpcHRpb24pKTtcbmV4cG9ydCB7IEFjdGlvbiB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9QWN0aW9uLmpzLm1hcFxuIiwiLyoqIFBVUkVfSU1QT1JUU19TVEFSVCB0c2xpYixfQXN5bmNBY3Rpb24gUFVSRV9JTVBPUlRTX0VORCAqL1xuaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IEFzeW5jQWN0aW9uIH0gZnJvbSAnLi9Bc3luY0FjdGlvbic7XG52YXIgQW5pbWF0aW9uRnJhbWVBY3Rpb24gPSAvKkBfX1BVUkVfXyovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoQW5pbWF0aW9uRnJhbWVBY3Rpb24sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQW5pbWF0aW9uRnJhbWVBY3Rpb24oc2NoZWR1bGVyLCB3b3JrKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHNjaGVkdWxlciwgd29yaykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuICAgICAgICBfdGhpcy53b3JrID0gd29yaztcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBBbmltYXRpb25GcmFtZUFjdGlvbi5wcm90b3R5cGUucmVxdWVzdEFzeW5jSWQgPSBmdW5jdGlvbiAoc2NoZWR1bGVyLCBpZCwgZGVsYXkpIHtcbiAgICAgICAgaWYgKGRlbGF5ID09PSB2b2lkIDApIHtcbiAgICAgICAgICAgIGRlbGF5ID0gMDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZGVsYXkgIT09IG51bGwgJiYgZGVsYXkgPiAwKSB7XG4gICAgICAgICAgICByZXR1cm4gX3N1cGVyLnByb3RvdHlwZS5yZXF1ZXN0QXN5bmNJZC5jYWxsKHRoaXMsIHNjaGVkdWxlciwgaWQsIGRlbGF5KTtcbiAgICAgICAgfVxuICAgICAgICBzY2hlZHVsZXIuYWN0aW9ucy5wdXNoKHRoaXMpO1xuICAgICAgICByZXR1cm4gc2NoZWR1bGVyLnNjaGVkdWxlZCB8fCAoc2NoZWR1bGVyLnNjaGVkdWxlZCA9IHJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbiAoKSB7IHJldHVybiBzY2hlZHVsZXIuZmx1c2gobnVsbCk7IH0pKTtcbiAgICB9O1xuICAgIEFuaW1hdGlvbkZyYW1lQWN0aW9uLnByb3RvdHlwZS5yZWN5Y2xlQXN5bmNJZCA9IGZ1bmN0aW9uIChzY2hlZHVsZXIsIGlkLCBkZWxheSkge1xuICAgICAgICBpZiAoZGVsYXkgPT09IHZvaWQgMCkge1xuICAgICAgICAgICAgZGVsYXkgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGlmICgoZGVsYXkgIT09IG51bGwgJiYgZGVsYXkgPiAwKSB8fCAoZGVsYXkgPT09IG51bGwgJiYgdGhpcy5kZWxheSA+IDApKSB7XG4gICAgICAgICAgICByZXR1cm4gX3N1cGVyLnByb3RvdHlwZS5yZWN5Y2xlQXN5bmNJZC5jYWxsKHRoaXMsIHNjaGVkdWxlciwgaWQsIGRlbGF5KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2NoZWR1bGVyLmFjdGlvbnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBjYW5jZWxBbmltYXRpb25GcmFtZShpZCk7XG4gICAgICAgICAgICBzY2hlZHVsZXIuc2NoZWR1bGVkID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfTtcbiAgICByZXR1cm4gQW5pbWF0aW9uRnJhbWVBY3Rpb247XG59KEFzeW5jQWN0aW9uKSk7XG5leHBvcnQgeyBBbmltYXRpb25GcmFtZUFjdGlvbiB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9QW5pbWF0aW9uRnJhbWVBY3Rpb24uanMubWFwXG4iLCIvKiogUFVSRV9JTVBPUlRTX1NUQVJUIHRzbGliLF9Bc3luY1NjaGVkdWxlciBQVVJFX0lNUE9SVFNfRU5EICovXG5pbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xuaW1wb3J0IHsgQXN5bmNTY2hlZHVsZXIgfSBmcm9tICcuL0FzeW5jU2NoZWR1bGVyJztcbnZhciBBbmltYXRpb25GcmFtZVNjaGVkdWxlciA9IC8qQF9fUFVSRV9fKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhBbmltYXRpb25GcmFtZVNjaGVkdWxlciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBBbmltYXRpb25GcmFtZVNjaGVkdWxlcigpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBBbmltYXRpb25GcmFtZVNjaGVkdWxlci5wcm90b3R5cGUuZmx1c2ggPSBmdW5jdGlvbiAoYWN0aW9uKSB7XG4gICAgICAgIHRoaXMuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5zY2hlZHVsZWQgPSB1bmRlZmluZWQ7XG4gICAgICAgIHZhciBhY3Rpb25zID0gdGhpcy5hY3Rpb25zO1xuICAgICAgICB2YXIgZXJyb3I7XG4gICAgICAgIHZhciBpbmRleCA9IC0xO1xuICAgICAgICB2YXIgY291bnQgPSBhY3Rpb25zLmxlbmd0aDtcbiAgICAgICAgYWN0aW9uID0gYWN0aW9uIHx8IGFjdGlvbnMuc2hpZnQoKTtcbiAgICAgICAgZG8ge1xuICAgICAgICAgICAgaWYgKGVycm9yID0gYWN0aW9uLmV4ZWN1dGUoYWN0aW9uLnN0YXRlLCBhY3Rpb24uZGVsYXkpKSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gd2hpbGUgKCsraW5kZXggPCBjb3VudCAmJiAoYWN0aW9uID0gYWN0aW9ucy5zaGlmdCgpKSk7XG4gICAgICAgIHRoaXMuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgd2hpbGUgKCsraW5kZXggPCBjb3VudCAmJiAoYWN0aW9uID0gYWN0aW9ucy5zaGlmdCgpKSkge1xuICAgICAgICAgICAgICAgIGFjdGlvbi51bnN1YnNjcmliZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBBbmltYXRpb25GcmFtZVNjaGVkdWxlcjtcbn0oQXN5bmNTY2hlZHVsZXIpKTtcbmV4cG9ydCB7IEFuaW1hdGlvbkZyYW1lU2NoZWR1bGVyIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1BbmltYXRpb25GcmFtZVNjaGVkdWxlci5qcy5tYXBcbiIsIi8qKiBQVVJFX0lNUE9SVFNfU1RBUlQgdHNsaWIsX3V0aWxfSW1tZWRpYXRlLF9Bc3luY0FjdGlvbiBQVVJFX0lNUE9SVFNfRU5EICovXG5pbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xuaW1wb3J0IHsgSW1tZWRpYXRlIH0gZnJvbSAnLi4vdXRpbC9JbW1lZGlhdGUnO1xuaW1wb3J0IHsgQXN5bmNBY3Rpb24gfSBmcm9tICcuL0FzeW5jQWN0aW9uJztcbnZhciBBc2FwQWN0aW9uID0gLypAX19QVVJFX18qLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHRzbGliXzEuX19leHRlbmRzKEFzYXBBY3Rpb24sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQXNhcEFjdGlvbihzY2hlZHVsZXIsIHdvcmspIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgc2NoZWR1bGVyLCB3b3JrKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5zY2hlZHVsZXIgPSBzY2hlZHVsZXI7XG4gICAgICAgIF90aGlzLndvcmsgPSB3b3JrO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIEFzYXBBY3Rpb24ucHJvdG90eXBlLnJlcXVlc3RBc3luY0lkID0gZnVuY3Rpb24gKHNjaGVkdWxlciwgaWQsIGRlbGF5KSB7XG4gICAgICAgIGlmIChkZWxheSA9PT0gdm9pZCAwKSB7XG4gICAgICAgICAgICBkZWxheSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRlbGF5ICE9PSBudWxsICYmIGRlbGF5ID4gMCkge1xuICAgICAgICAgICAgcmV0dXJuIF9zdXBlci5wcm90b3R5cGUucmVxdWVzdEFzeW5jSWQuY2FsbCh0aGlzLCBzY2hlZHVsZXIsIGlkLCBkZWxheSk7XG4gICAgICAgIH1cbiAgICAgICAgc2NoZWR1bGVyLmFjdGlvbnMucHVzaCh0aGlzKTtcbiAgICAgICAgcmV0dXJuIHNjaGVkdWxlci5zY2hlZHVsZWQgfHwgKHNjaGVkdWxlci5zY2hlZHVsZWQgPSBJbW1lZGlhdGUuc2V0SW1tZWRpYXRlKHNjaGVkdWxlci5mbHVzaC5iaW5kKHNjaGVkdWxlciwgbnVsbCkpKTtcbiAgICB9O1xuICAgIEFzYXBBY3Rpb24ucHJvdG90eXBlLnJlY3ljbGVBc3luY0lkID0gZnVuY3Rpb24gKHNjaGVkdWxlciwgaWQsIGRlbGF5KSB7XG4gICAgICAgIGlmIChkZWxheSA9PT0gdm9pZCAwKSB7XG4gICAgICAgICAgICBkZWxheSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKChkZWxheSAhPT0gbnVsbCAmJiBkZWxheSA+IDApIHx8IChkZWxheSA9PT0gbnVsbCAmJiB0aGlzLmRlbGF5ID4gMCkpIHtcbiAgICAgICAgICAgIHJldHVybiBfc3VwZXIucHJvdG90eXBlLnJlY3ljbGVBc3luY0lkLmNhbGwodGhpcywgc2NoZWR1bGVyLCBpZCwgZGVsYXkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzY2hlZHVsZXIuYWN0aW9ucy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIEltbWVkaWF0ZS5jbGVhckltbWVkaWF0ZShpZCk7XG4gICAgICAgICAgICBzY2hlZHVsZXIuc2NoZWR1bGVkID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfTtcbiAgICByZXR1cm4gQXNhcEFjdGlvbjtcbn0oQXN5bmNBY3Rpb24pKTtcbmV4cG9ydCB7IEFzYXBBY3Rpb24gfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUFzYXBBY3Rpb24uanMubWFwXG4iLCIvKiogUFVSRV9JTVBPUlRTX1NUQVJUIHRzbGliLF9Bc3luY1NjaGVkdWxlciBQVVJFX0lNUE9SVFNfRU5EICovXG5pbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xuaW1wb3J0IHsgQXN5bmNTY2hlZHVsZXIgfSBmcm9tICcuL0FzeW5jU2NoZWR1bGVyJztcbnZhciBBc2FwU2NoZWR1bGVyID0gLypAX19QVVJFX18qLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHRzbGliXzEuX19leHRlbmRzKEFzYXBTY2hlZHVsZXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQXNhcFNjaGVkdWxlcigpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBBc2FwU2NoZWR1bGVyLnByb3RvdHlwZS5mbHVzaCA9IGZ1bmN0aW9uIChhY3Rpb24pIHtcbiAgICAgICAgdGhpcy5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLnNjaGVkdWxlZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdmFyIGFjdGlvbnMgPSB0aGlzLmFjdGlvbnM7XG4gICAgICAgIHZhciBlcnJvcjtcbiAgICAgICAgdmFyIGluZGV4ID0gLTE7XG4gICAgICAgIHZhciBjb3VudCA9IGFjdGlvbnMubGVuZ3RoO1xuICAgICAgICBhY3Rpb24gPSBhY3Rpb24gfHwgYWN0aW9ucy5zaGlmdCgpO1xuICAgICAgICBkbyB7XG4gICAgICAgICAgICBpZiAoZXJyb3IgPSBhY3Rpb24uZXhlY3V0ZShhY3Rpb24uc3RhdGUsIGFjdGlvbi5kZWxheSkpIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSB3aGlsZSAoKytpbmRleCA8IGNvdW50ICYmIChhY3Rpb24gPSBhY3Rpb25zLnNoaWZ0KCkpKTtcbiAgICAgICAgdGhpcy5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgICB3aGlsZSAoKytpbmRleCA8IGNvdW50ICYmIChhY3Rpb24gPSBhY3Rpb25zLnNoaWZ0KCkpKSB7XG4gICAgICAgICAgICAgICAgYWN0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIEFzYXBTY2hlZHVsZXI7XG59KEFzeW5jU2NoZWR1bGVyKSk7XG5leHBvcnQgeyBBc2FwU2NoZWR1bGVyIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1Bc2FwU2NoZWR1bGVyLmpzLm1hcFxuIiwiLyoqIFBVUkVfSU1QT1JUU19TVEFSVCB0c2xpYixfQWN0aW9uIFBVUkVfSU1QT1JUU19FTkQgKi9cbmltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XG5pbXBvcnQgeyBBY3Rpb24gfSBmcm9tICcuL0FjdGlvbic7XG52YXIgQXN5bmNBY3Rpb24gPSAvKkBfX1BVUkVfXyovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoQXN5bmNBY3Rpb24sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQXN5bmNBY3Rpb24oc2NoZWR1bGVyLCB3b3JrKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHNjaGVkdWxlciwgd29yaykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuICAgICAgICBfdGhpcy53b3JrID0gd29yaztcbiAgICAgICAgX3RoaXMucGVuZGluZyA9IGZhbHNlO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIEFzeW5jQWN0aW9uLnByb3RvdHlwZS5zY2hlZHVsZSA9IGZ1bmN0aW9uIChzdGF0ZSwgZGVsYXkpIHtcbiAgICAgICAgaWYgKGRlbGF5ID09PSB2b2lkIDApIHtcbiAgICAgICAgICAgIGRlbGF5ID0gMDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5jbG9zZWQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc3RhdGUgPSBzdGF0ZTtcbiAgICAgICAgdmFyIGlkID0gdGhpcy5pZDtcbiAgICAgICAgdmFyIHNjaGVkdWxlciA9IHRoaXMuc2NoZWR1bGVyO1xuICAgICAgICBpZiAoaWQgIT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5pZCA9IHRoaXMucmVjeWNsZUFzeW5jSWQoc2NoZWR1bGVyLCBpZCwgZGVsYXkpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucGVuZGluZyA9IHRydWU7XG4gICAgICAgIHRoaXMuZGVsYXkgPSBkZWxheTtcbiAgICAgICAgdGhpcy5pZCA9IHRoaXMuaWQgfHwgdGhpcy5yZXF1ZXN0QXN5bmNJZChzY2hlZHVsZXIsIHRoaXMuaWQsIGRlbGF5KTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBBc3luY0FjdGlvbi5wcm90b3R5cGUucmVxdWVzdEFzeW5jSWQgPSBmdW5jdGlvbiAoc2NoZWR1bGVyLCBpZCwgZGVsYXkpIHtcbiAgICAgICAgaWYgKGRlbGF5ID09PSB2b2lkIDApIHtcbiAgICAgICAgICAgIGRlbGF5ID0gMDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2V0SW50ZXJ2YWwoc2NoZWR1bGVyLmZsdXNoLmJpbmQoc2NoZWR1bGVyLCB0aGlzKSwgZGVsYXkpO1xuICAgIH07XG4gICAgQXN5bmNBY3Rpb24ucHJvdG90eXBlLnJlY3ljbGVBc3luY0lkID0gZnVuY3Rpb24gKHNjaGVkdWxlciwgaWQsIGRlbGF5KSB7XG4gICAgICAgIGlmIChkZWxheSA9PT0gdm9pZCAwKSB7XG4gICAgICAgICAgICBkZWxheSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRlbGF5ICE9PSBudWxsICYmIHRoaXMuZGVsYXkgPT09IGRlbGF5ICYmIHRoaXMucGVuZGluZyA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIHJldHVybiBpZDtcbiAgICAgICAgfVxuICAgICAgICBjbGVhckludGVydmFsKGlkKTtcbiAgICB9O1xuICAgIEFzeW5jQWN0aW9uLnByb3RvdHlwZS5leGVjdXRlID0gZnVuY3Rpb24gKHN0YXRlLCBkZWxheSkge1xuICAgICAgICBpZiAodGhpcy5jbG9zZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgRXJyb3IoJ2V4ZWN1dGluZyBhIGNhbmNlbGxlZCBhY3Rpb24nKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnBlbmRpbmcgPSBmYWxzZTtcbiAgICAgICAgdmFyIGVycm9yID0gdGhpcy5fZXhlY3V0ZShzdGF0ZSwgZGVsYXkpO1xuICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiBlcnJvcjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLnBlbmRpbmcgPT09IGZhbHNlICYmIHRoaXMuaWQgIT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5pZCA9IHRoaXMucmVjeWNsZUFzeW5jSWQodGhpcy5zY2hlZHVsZXIsIHRoaXMuaWQsIG51bGwpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBBc3luY0FjdGlvbi5wcm90b3R5cGUuX2V4ZWN1dGUgPSBmdW5jdGlvbiAoc3RhdGUsIGRlbGF5KSB7XG4gICAgICAgIHZhciBlcnJvcmVkID0gZmFsc2U7XG4gICAgICAgIHZhciBlcnJvclZhbHVlID0gdW5kZWZpbmVkO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdGhpcy53b3JrKHN0YXRlKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgZXJyb3JlZCA9IHRydWU7XG4gICAgICAgICAgICBlcnJvclZhbHVlID0gISFlICYmIGUgfHwgbmV3IEVycm9yKGUpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChlcnJvcmVkKSB7XG4gICAgICAgICAgICB0aGlzLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgICAgICByZXR1cm4gZXJyb3JWYWx1ZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQXN5bmNBY3Rpb24ucHJvdG90eXBlLl91bnN1YnNjcmliZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGlkID0gdGhpcy5pZDtcbiAgICAgICAgdmFyIHNjaGVkdWxlciA9IHRoaXMuc2NoZWR1bGVyO1xuICAgICAgICB2YXIgYWN0aW9ucyA9IHNjaGVkdWxlci5hY3Rpb25zO1xuICAgICAgICB2YXIgaW5kZXggPSBhY3Rpb25zLmluZGV4T2YodGhpcyk7XG4gICAgICAgIHRoaXMud29yayA9IG51bGw7XG4gICAgICAgIHRoaXMuc3RhdGUgPSBudWxsO1xuICAgICAgICB0aGlzLnBlbmRpbmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5zY2hlZHVsZXIgPSBudWxsO1xuICAgICAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgICBhY3Rpb25zLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlkICE9IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMuaWQgPSB0aGlzLnJlY3ljbGVBc3luY0lkKHNjaGVkdWxlciwgaWQsIG51bGwpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZGVsYXkgPSBudWxsO1xuICAgIH07XG4gICAgcmV0dXJuIEFzeW5jQWN0aW9uO1xufShBY3Rpb24pKTtcbmV4cG9ydCB7IEFzeW5jQWN0aW9uIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1Bc3luY0FjdGlvbi5qcy5tYXBcbiIsIi8qKiBQVVJFX0lNUE9SVFNfU1RBUlQgdHNsaWIsX1NjaGVkdWxlciBQVVJFX0lNUE9SVFNfRU5EICovXG5pbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xuaW1wb3J0IHsgU2NoZWR1bGVyIH0gZnJvbSAnLi4vU2NoZWR1bGVyJztcbnZhciBBc3luY1NjaGVkdWxlciA9IC8qQF9fUFVSRV9fKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhBc3luY1NjaGVkdWxlciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBBc3luY1NjaGVkdWxlcihTY2hlZHVsZXJBY3Rpb24sIG5vdykge1xuICAgICAgICBpZiAobm93ID09PSB2b2lkIDApIHtcbiAgICAgICAgICAgIG5vdyA9IFNjaGVkdWxlci5ub3c7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgU2NoZWR1bGVyQWN0aW9uLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoQXN5bmNTY2hlZHVsZXIuZGVsZWdhdGUgJiYgQXN5bmNTY2hlZHVsZXIuZGVsZWdhdGUgIT09IF90aGlzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEFzeW5jU2NoZWR1bGVyLmRlbGVnYXRlLm5vdygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5vdygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5hY3Rpb25zID0gW107XG4gICAgICAgIF90aGlzLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICBfdGhpcy5zY2hlZHVsZWQgPSB1bmRlZmluZWQ7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgQXN5bmNTY2hlZHVsZXIucHJvdG90eXBlLnNjaGVkdWxlID0gZnVuY3Rpb24gKHdvcmssIGRlbGF5LCBzdGF0ZSkge1xuICAgICAgICBpZiAoZGVsYXkgPT09IHZvaWQgMCkge1xuICAgICAgICAgICAgZGVsYXkgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGlmIChBc3luY1NjaGVkdWxlci5kZWxlZ2F0ZSAmJiBBc3luY1NjaGVkdWxlci5kZWxlZ2F0ZSAhPT0gdGhpcykge1xuICAgICAgICAgICAgcmV0dXJuIEFzeW5jU2NoZWR1bGVyLmRlbGVnYXRlLnNjaGVkdWxlKHdvcmssIGRlbGF5LCBzdGF0ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gX3N1cGVyLnByb3RvdHlwZS5zY2hlZHVsZS5jYWxsKHRoaXMsIHdvcmssIGRlbGF5LCBzdGF0ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEFzeW5jU2NoZWR1bGVyLnByb3RvdHlwZS5mbHVzaCA9IGZ1bmN0aW9uIChhY3Rpb24pIHtcbiAgICAgICAgdmFyIGFjdGlvbnMgPSB0aGlzLmFjdGlvbnM7XG4gICAgICAgIGlmICh0aGlzLmFjdGl2ZSkge1xuICAgICAgICAgICAgYWN0aW9ucy5wdXNoKGFjdGlvbik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGVycm9yO1xuICAgICAgICB0aGlzLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIGRvIHtcbiAgICAgICAgICAgIGlmIChlcnJvciA9IGFjdGlvbi5leGVjdXRlKGFjdGlvbi5zdGF0ZSwgYWN0aW9uLmRlbGF5KSkge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IHdoaWxlIChhY3Rpb24gPSBhY3Rpb25zLnNoaWZ0KCkpO1xuICAgICAgICB0aGlzLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgIHdoaWxlIChhY3Rpb24gPSBhY3Rpb25zLnNoaWZ0KCkpIHtcbiAgICAgICAgICAgICAgICBhY3Rpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gQXN5bmNTY2hlZHVsZXI7XG59KFNjaGVkdWxlcikpO1xuZXhwb3J0IHsgQXN5bmNTY2hlZHVsZXIgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUFzeW5jU2NoZWR1bGVyLmpzLm1hcFxuIiwiLyoqIFBVUkVfSU1QT1JUU19TVEFSVCB0c2xpYixfQXN5bmNBY3Rpb24gUFVSRV9JTVBPUlRTX0VORCAqL1xuaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IEFzeW5jQWN0aW9uIH0gZnJvbSAnLi9Bc3luY0FjdGlvbic7XG52YXIgUXVldWVBY3Rpb24gPSAvKkBfX1BVUkVfXyovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoUXVldWVBY3Rpb24sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gUXVldWVBY3Rpb24oc2NoZWR1bGVyLCB3b3JrKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHNjaGVkdWxlciwgd29yaykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuICAgICAgICBfdGhpcy53b3JrID0gd29yaztcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBRdWV1ZUFjdGlvbi5wcm90b3R5cGUuc2NoZWR1bGUgPSBmdW5jdGlvbiAoc3RhdGUsIGRlbGF5KSB7XG4gICAgICAgIGlmIChkZWxheSA9PT0gdm9pZCAwKSB7XG4gICAgICAgICAgICBkZWxheSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRlbGF5ID4gMCkge1xuICAgICAgICAgICAgcmV0dXJuIF9zdXBlci5wcm90b3R5cGUuc2NoZWR1bGUuY2FsbCh0aGlzLCBzdGF0ZSwgZGVsYXkpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZGVsYXkgPSBkZWxheTtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHN0YXRlO1xuICAgICAgICB0aGlzLnNjaGVkdWxlci5mbHVzaCh0aGlzKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBRdWV1ZUFjdGlvbi5wcm90b3R5cGUuZXhlY3V0ZSA9IGZ1bmN0aW9uIChzdGF0ZSwgZGVsYXkpIHtcbiAgICAgICAgcmV0dXJuIChkZWxheSA+IDAgfHwgdGhpcy5jbG9zZWQpID9cbiAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUuZXhlY3V0ZS5jYWxsKHRoaXMsIHN0YXRlLCBkZWxheSkgOlxuICAgICAgICAgICAgdGhpcy5fZXhlY3V0ZShzdGF0ZSwgZGVsYXkpO1xuICAgIH07XG4gICAgUXVldWVBY3Rpb24ucHJvdG90eXBlLnJlcXVlc3RBc3luY0lkID0gZnVuY3Rpb24gKHNjaGVkdWxlciwgaWQsIGRlbGF5KSB7XG4gICAgICAgIGlmIChkZWxheSA9PT0gdm9pZCAwKSB7XG4gICAgICAgICAgICBkZWxheSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKChkZWxheSAhPT0gbnVsbCAmJiBkZWxheSA+IDApIHx8IChkZWxheSA9PT0gbnVsbCAmJiB0aGlzLmRlbGF5ID4gMCkpIHtcbiAgICAgICAgICAgIHJldHVybiBfc3VwZXIucHJvdG90eXBlLnJlcXVlc3RBc3luY0lkLmNhbGwodGhpcywgc2NoZWR1bGVyLCBpZCwgZGVsYXkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzY2hlZHVsZXIuZmx1c2godGhpcyk7XG4gICAgfTtcbiAgICByZXR1cm4gUXVldWVBY3Rpb247XG59KEFzeW5jQWN0aW9uKSk7XG5leHBvcnQgeyBRdWV1ZUFjdGlvbiB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9UXVldWVBY3Rpb24uanMubWFwXG4iLCIvKiogUFVSRV9JTVBPUlRTX1NUQVJUIHRzbGliLF9Bc3luY1NjaGVkdWxlciBQVVJFX0lNUE9SVFNfRU5EICovXG5pbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xuaW1wb3J0IHsgQXN5bmNTY2hlZHVsZXIgfSBmcm9tICcuL0FzeW5jU2NoZWR1bGVyJztcbnZhciBRdWV1ZVNjaGVkdWxlciA9IC8qQF9fUFVSRV9fKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhRdWV1ZVNjaGVkdWxlciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBRdWV1ZVNjaGVkdWxlcigpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICByZXR1cm4gUXVldWVTY2hlZHVsZXI7XG59KEFzeW5jU2NoZWR1bGVyKSk7XG5leHBvcnQgeyBRdWV1ZVNjaGVkdWxlciB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9UXVldWVTY2hlZHVsZXIuanMubWFwXG4iLCIvKiogUFVSRV9JTVBPUlRTX1NUQVJUIHRzbGliLF9Bc3luY0FjdGlvbixfQXN5bmNTY2hlZHVsZXIgUFVSRV9JTVBPUlRTX0VORCAqL1xuaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IEFzeW5jQWN0aW9uIH0gZnJvbSAnLi9Bc3luY0FjdGlvbic7XG5pbXBvcnQgeyBBc3luY1NjaGVkdWxlciB9IGZyb20gJy4vQXN5bmNTY2hlZHVsZXInO1xudmFyIFZpcnR1YWxUaW1lU2NoZWR1bGVyID0gLypAX19QVVJFX18qLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHRzbGliXzEuX19leHRlbmRzKFZpcnR1YWxUaW1lU2NoZWR1bGVyLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFZpcnR1YWxUaW1lU2NoZWR1bGVyKFNjaGVkdWxlckFjdGlvbiwgbWF4RnJhbWVzKSB7XG4gICAgICAgIGlmIChTY2hlZHVsZXJBY3Rpb24gPT09IHZvaWQgMCkge1xuICAgICAgICAgICAgU2NoZWR1bGVyQWN0aW9uID0gVmlydHVhbEFjdGlvbjtcbiAgICAgICAgfVxuICAgICAgICBpZiAobWF4RnJhbWVzID09PSB2b2lkIDApIHtcbiAgICAgICAgICAgIG1heEZyYW1lcyA9IE51bWJlci5QT1NJVElWRV9JTkZJTklUWTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBTY2hlZHVsZXJBY3Rpb24sIGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLmZyYW1lOyB9KSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5tYXhGcmFtZXMgPSBtYXhGcmFtZXM7XG4gICAgICAgIF90aGlzLmZyYW1lID0gMDtcbiAgICAgICAgX3RoaXMuaW5kZXggPSAtMTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBWaXJ0dWFsVGltZVNjaGVkdWxlci5wcm90b3R5cGUuZmx1c2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfYSA9IHRoaXMsIGFjdGlvbnMgPSBfYS5hY3Rpb25zLCBtYXhGcmFtZXMgPSBfYS5tYXhGcmFtZXM7XG4gICAgICAgIHZhciBlcnJvciwgYWN0aW9uO1xuICAgICAgICB3aGlsZSAoKGFjdGlvbiA9IGFjdGlvbnMuc2hpZnQoKSkgJiYgKHRoaXMuZnJhbWUgPSBhY3Rpb24uZGVsYXkpIDw9IG1heEZyYW1lcykge1xuICAgICAgICAgICAgaWYgKGVycm9yID0gYWN0aW9uLmV4ZWN1dGUoYWN0aW9uLnN0YXRlLCBhY3Rpb24uZGVsYXkpKSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgICB3aGlsZSAoYWN0aW9uID0gYWN0aW9ucy5zaGlmdCgpKSB7XG4gICAgICAgICAgICAgICAgYWN0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlydHVhbFRpbWVTY2hlZHVsZXIuZnJhbWVUaW1lRmFjdG9yID0gMTA7XG4gICAgcmV0dXJuIFZpcnR1YWxUaW1lU2NoZWR1bGVyO1xufShBc3luY1NjaGVkdWxlcikpO1xuZXhwb3J0IHsgVmlydHVhbFRpbWVTY2hlZHVsZXIgfTtcbnZhciBWaXJ0dWFsQWN0aW9uID0gLypAX19QVVJFX18qLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHRzbGliXzEuX19leHRlbmRzKFZpcnR1YWxBY3Rpb24sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVmlydHVhbEFjdGlvbihzY2hlZHVsZXIsIHdvcmssIGluZGV4KSB7XG4gICAgICAgIGlmIChpbmRleCA9PT0gdm9pZCAwKSB7XG4gICAgICAgICAgICBpbmRleCA9IHNjaGVkdWxlci5pbmRleCArPSAxO1xuICAgICAgICB9XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHNjaGVkdWxlciwgd29yaykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuICAgICAgICBfdGhpcy53b3JrID0gd29yaztcbiAgICAgICAgX3RoaXMuaW5kZXggPSBpbmRleDtcbiAgICAgICAgX3RoaXMuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgX3RoaXMuaW5kZXggPSBzY2hlZHVsZXIuaW5kZXggPSBpbmRleDtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBWaXJ0dWFsQWN0aW9uLnByb3RvdHlwZS5zY2hlZHVsZSA9IGZ1bmN0aW9uIChzdGF0ZSwgZGVsYXkpIHtcbiAgICAgICAgaWYgKGRlbGF5ID09PSB2b2lkIDApIHtcbiAgICAgICAgICAgIGRlbGF5ID0gMDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRoaXMuaWQpIHtcbiAgICAgICAgICAgIHJldHVybiBfc3VwZXIucHJvdG90eXBlLnNjaGVkdWxlLmNhbGwodGhpcywgc3RhdGUsIGRlbGF5KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB2YXIgYWN0aW9uID0gbmV3IFZpcnR1YWxBY3Rpb24odGhpcy5zY2hlZHVsZXIsIHRoaXMud29yayk7XG4gICAgICAgIHRoaXMuYWRkKGFjdGlvbik7XG4gICAgICAgIHJldHVybiBhY3Rpb24uc2NoZWR1bGUoc3RhdGUsIGRlbGF5KTtcbiAgICB9O1xuICAgIFZpcnR1YWxBY3Rpb24ucHJvdG90eXBlLnJlcXVlc3RBc3luY0lkID0gZnVuY3Rpb24gKHNjaGVkdWxlciwgaWQsIGRlbGF5KSB7XG4gICAgICAgIGlmIChkZWxheSA9PT0gdm9pZCAwKSB7XG4gICAgICAgICAgICBkZWxheSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5kZWxheSA9IHNjaGVkdWxlci5mcmFtZSArIGRlbGF5O1xuICAgICAgICB2YXIgYWN0aW9ucyA9IHNjaGVkdWxlci5hY3Rpb25zO1xuICAgICAgICBhY3Rpb25zLnB1c2godGhpcyk7XG4gICAgICAgIGFjdGlvbnMuc29ydChWaXJ0dWFsQWN0aW9uLnNvcnRBY3Rpb25zKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICBWaXJ0dWFsQWN0aW9uLnByb3RvdHlwZS5yZWN5Y2xlQXN5bmNJZCA9IGZ1bmN0aW9uIChzY2hlZHVsZXIsIGlkLCBkZWxheSkge1xuICAgICAgICBpZiAoZGVsYXkgPT09IHZvaWQgMCkge1xuICAgICAgICAgICAgZGVsYXkgPSAwO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfTtcbiAgICBWaXJ0dWFsQWN0aW9uLnByb3RvdHlwZS5fZXhlY3V0ZSA9IGZ1bmN0aW9uIChzdGF0ZSwgZGVsYXkpIHtcbiAgICAgICAgaWYgKHRoaXMuYWN0aXZlID09PSB0cnVlKSB7XG4gICAgICAgICAgICByZXR1cm4gX3N1cGVyLnByb3RvdHlwZS5fZXhlY3V0ZS5jYWxsKHRoaXMsIHN0YXRlLCBkZWxheSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpcnR1YWxBY3Rpb24uc29ydEFjdGlvbnMgPSBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICBpZiAoYS5kZWxheSA9PT0gYi5kZWxheSkge1xuICAgICAgICAgICAgaWYgKGEuaW5kZXggPT09IGIuaW5kZXgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGEuaW5kZXggPiBiLmluZGV4KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoYS5kZWxheSA+IGIuZGVsYXkpIHtcbiAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gVmlydHVhbEFjdGlvbjtcbn0oQXN5bmNBY3Rpb24pKTtcbmV4cG9ydCB7IFZpcnR1YWxBY3Rpb24gfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVZpcnR1YWxUaW1lU2NoZWR1bGVyLmpzLm1hcFxuIiwiLyoqIFBVUkVfSU1QT1JUU19TVEFSVCBfQW5pbWF0aW9uRnJhbWVBY3Rpb24sX0FuaW1hdGlvbkZyYW1lU2NoZWR1bGVyIFBVUkVfSU1QT1JUU19FTkQgKi9cbmltcG9ydCB7IEFuaW1hdGlvbkZyYW1lQWN0aW9uIH0gZnJvbSAnLi9BbmltYXRpb25GcmFtZUFjdGlvbic7XG5pbXBvcnQgeyBBbmltYXRpb25GcmFtZVNjaGVkdWxlciB9IGZyb20gJy4vQW5pbWF0aW9uRnJhbWVTY2hlZHVsZXInO1xuZXhwb3J0IHZhciBhbmltYXRpb25GcmFtZSA9IC8qQF9fUFVSRV9fKi8gbmV3IEFuaW1hdGlvbkZyYW1lU2NoZWR1bGVyKEFuaW1hdGlvbkZyYW1lQWN0aW9uKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFuaW1hdGlvbkZyYW1lLmpzLm1hcFxuIiwiLyoqIFBVUkVfSU1QT1JUU19TVEFSVCBfQXNhcEFjdGlvbixfQXNhcFNjaGVkdWxlciBQVVJFX0lNUE9SVFNfRU5EICovXG5pbXBvcnQgeyBBc2FwQWN0aW9uIH0gZnJvbSAnLi9Bc2FwQWN0aW9uJztcbmltcG9ydCB7IEFzYXBTY2hlZHVsZXIgfSBmcm9tICcuL0FzYXBTY2hlZHVsZXInO1xuZXhwb3J0IHZhciBhc2FwID0gLypAX19QVVJFX18qLyBuZXcgQXNhcFNjaGVkdWxlcihBc2FwQWN0aW9uKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFzYXAuanMubWFwXG4iLCIvKiogUFVSRV9JTVBPUlRTX1NUQVJUIF9Bc3luY0FjdGlvbixfQXN5bmNTY2hlZHVsZXIgUFVSRV9JTVBPUlRTX0VORCAqL1xuaW1wb3J0IHsgQXN5bmNBY3Rpb24gfSBmcm9tICcuL0FzeW5jQWN0aW9uJztcbmltcG9ydCB7IEFzeW5jU2NoZWR1bGVyIH0gZnJvbSAnLi9Bc3luY1NjaGVkdWxlcic7XG5leHBvcnQgdmFyIGFzeW5jID0gLypAX19QVVJFX18qLyBuZXcgQXN5bmNTY2hlZHVsZXIoQXN5bmNBY3Rpb24pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXN5bmMuanMubWFwXG4iLCIvKiogUFVSRV9JTVBPUlRTX1NUQVJUIF9RdWV1ZUFjdGlvbixfUXVldWVTY2hlZHVsZXIgUFVSRV9JTVBPUlRTX0VORCAqL1xuaW1wb3J0IHsgUXVldWVBY3Rpb24gfSBmcm9tICcuL1F1ZXVlQWN0aW9uJztcbmltcG9ydCB7IFF1ZXVlU2NoZWR1bGVyIH0gZnJvbSAnLi9RdWV1ZVNjaGVkdWxlcic7XG5leHBvcnQgdmFyIHF1ZXVlID0gLypAX19QVVJFX18qLyBuZXcgUXVldWVTY2hlZHVsZXIoUXVldWVBY3Rpb24pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cXVldWUuanMubWFwXG4iLCIvKiogUFVSRV9JTVBPUlRTX1NUQVJUICBQVVJFX0lNUE9SVFNfRU5EICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0U3ltYm9sSXRlcmF0b3IoKSB7XG4gICAgaWYgKHR5cGVvZiBTeW1ib2wgIT09ICdmdW5jdGlvbicgfHwgIVN5bWJvbC5pdGVyYXRvcikge1xuICAgICAgICByZXR1cm4gJ0BAaXRlcmF0b3InO1xuICAgIH1cbiAgICByZXR1cm4gU3ltYm9sLml0ZXJhdG9yO1xufVxuZXhwb3J0IHZhciBpdGVyYXRvciA9IC8qQF9fUFVSRV9fKi8gZ2V0U3ltYm9sSXRlcmF0b3IoKTtcbmV4cG9ydCB2YXIgJCRpdGVyYXRvciA9IGl0ZXJhdG9yO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aXRlcmF0b3IuanMubWFwXG4iLCIvKiogUFVSRV9JTVBPUlRTX1NUQVJUICBQVVJFX0lNUE9SVFNfRU5EICovXG5leHBvcnQgdmFyIG9ic2VydmFibGUgPSB0eXBlb2YgU3ltYm9sID09PSAnZnVuY3Rpb24nICYmIFN5bWJvbC5vYnNlcnZhYmxlIHx8ICdAQG9ic2VydmFibGUnO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9b2JzZXJ2YWJsZS5qcy5tYXBcbiIsIi8qKiBQVVJFX0lNUE9SVFNfU1RBUlQgIFBVUkVfSU1QT1JUU19FTkQgKi9cbmV4cG9ydCB2YXIgcnhTdWJzY3JpYmVyID0gdHlwZW9mIFN5bWJvbCA9PT0gJ2Z1bmN0aW9uJ1xuICAgID8gLypAX19QVVJFX18qLyBTeW1ib2woJ3J4U3Vic2NyaWJlcicpXG4gICAgOiAnQEByeFN1YnNjcmliZXJfJyArIC8qQF9fUFVSRV9fKi8gTWF0aC5yYW5kb20oKTtcbmV4cG9ydCB2YXIgJCRyeFN1YnNjcmliZXIgPSByeFN1YnNjcmliZXI7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1yeFN1YnNjcmliZXIuanMubWFwXG4iLCIvKiogUFVSRV9JTVBPUlRTX1NUQVJUICBQVVJFX0lNUE9SVFNfRU5EICovXG5mdW5jdGlvbiBBcmd1bWVudE91dE9mUmFuZ2VFcnJvckltcGwoKSB7XG4gICAgRXJyb3IuY2FsbCh0aGlzKTtcbiAgICB0aGlzLm1lc3NhZ2UgPSAnYXJndW1lbnQgb3V0IG9mIHJhbmdlJztcbiAgICB0aGlzLm5hbWUgPSAnQXJndW1lbnRPdXRPZlJhbmdlRXJyb3InO1xuICAgIHJldHVybiB0aGlzO1xufVxuQXJndW1lbnRPdXRPZlJhbmdlRXJyb3JJbXBsLnByb3RvdHlwZSA9IC8qQF9fUFVSRV9fKi8gT2JqZWN0LmNyZWF0ZShFcnJvci5wcm90b3R5cGUpO1xuZXhwb3J0IHZhciBBcmd1bWVudE91dE9mUmFuZ2VFcnJvciA9IEFyZ3VtZW50T3V0T2ZSYW5nZUVycm9ySW1wbDtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUFyZ3VtZW50T3V0T2ZSYW5nZUVycm9yLmpzLm1hcFxuIiwiLyoqIFBVUkVfSU1QT1JUU19TVEFSVCAgUFVSRV9JTVBPUlRTX0VORCAqL1xuZnVuY3Rpb24gRW1wdHlFcnJvckltcGwoKSB7XG4gICAgRXJyb3IuY2FsbCh0aGlzKTtcbiAgICB0aGlzLm1lc3NhZ2UgPSAnbm8gZWxlbWVudHMgaW4gc2VxdWVuY2UnO1xuICAgIHRoaXMubmFtZSA9ICdFbXB0eUVycm9yJztcbiAgICByZXR1cm4gdGhpcztcbn1cbkVtcHR5RXJyb3JJbXBsLnByb3RvdHlwZSA9IC8qQF9fUFVSRV9fKi8gT2JqZWN0LmNyZWF0ZShFcnJvci5wcm90b3R5cGUpO1xuZXhwb3J0IHZhciBFbXB0eUVycm9yID0gRW1wdHlFcnJvckltcGw7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1FbXB0eUVycm9yLmpzLm1hcFxuIiwiLyoqIFBVUkVfSU1QT1JUU19TVEFSVCAgUFVSRV9JTVBPUlRTX0VORCAqL1xudmFyIG5leHRIYW5kbGUgPSAxO1xudmFyIHRhc2tzQnlIYW5kbGUgPSB7fTtcbmZ1bmN0aW9uIHJ1bklmUHJlc2VudChoYW5kbGUpIHtcbiAgICB2YXIgY2IgPSB0YXNrc0J5SGFuZGxlW2hhbmRsZV07XG4gICAgaWYgKGNiKSB7XG4gICAgICAgIGNiKCk7XG4gICAgfVxufVxuZXhwb3J0IHZhciBJbW1lZGlhdGUgPSB7XG4gICAgc2V0SW1tZWRpYXRlOiBmdW5jdGlvbiAoY2IpIHtcbiAgICAgICAgdmFyIGhhbmRsZSA9IG5leHRIYW5kbGUrKztcbiAgICAgICAgdGFza3NCeUhhbmRsZVtoYW5kbGVdID0gY2I7XG4gICAgICAgIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24gKCkgeyByZXR1cm4gcnVuSWZQcmVzZW50KGhhbmRsZSk7IH0pO1xuICAgICAgICByZXR1cm4gaGFuZGxlO1xuICAgIH0sXG4gICAgY2xlYXJJbW1lZGlhdGU6IGZ1bmN0aW9uIChoYW5kbGUpIHtcbiAgICAgICAgZGVsZXRlIHRhc2tzQnlIYW5kbGVbaGFuZGxlXTtcbiAgICB9LFxufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUltbWVkaWF0ZS5qcy5tYXBcbiIsIi8qKiBQVVJFX0lNUE9SVFNfU1RBUlQgIFBVUkVfSU1QT1JUU19FTkQgKi9cbmZ1bmN0aW9uIE9iamVjdFVuc3Vic2NyaWJlZEVycm9ySW1wbCgpIHtcbiAgICBFcnJvci5jYWxsKHRoaXMpO1xuICAgIHRoaXMubWVzc2FnZSA9ICdvYmplY3QgdW5zdWJzY3JpYmVkJztcbiAgICB0aGlzLm5hbWUgPSAnT2JqZWN0VW5zdWJzY3JpYmVkRXJyb3InO1xuICAgIHJldHVybiB0aGlzO1xufVxuT2JqZWN0VW5zdWJzY3JpYmVkRXJyb3JJbXBsLnByb3RvdHlwZSA9IC8qQF9fUFVSRV9fKi8gT2JqZWN0LmNyZWF0ZShFcnJvci5wcm90b3R5cGUpO1xuZXhwb3J0IHZhciBPYmplY3RVbnN1YnNjcmliZWRFcnJvciA9IE9iamVjdFVuc3Vic2NyaWJlZEVycm9ySW1wbDtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPU9iamVjdFVuc3Vic2NyaWJlZEVycm9yLmpzLm1hcFxuIiwiLyoqIFBVUkVfSU1QT1JUU19TVEFSVCAgUFVSRV9JTVBPUlRTX0VORCAqL1xuZnVuY3Rpb24gVGltZW91dEVycm9ySW1wbCgpIHtcbiAgICBFcnJvci5jYWxsKHRoaXMpO1xuICAgIHRoaXMubWVzc2FnZSA9ICdUaW1lb3V0IGhhcyBvY2N1cnJlZCc7XG4gICAgdGhpcy5uYW1lID0gJ1RpbWVvdXRFcnJvcic7XG4gICAgcmV0dXJuIHRoaXM7XG59XG5UaW1lb3V0RXJyb3JJbXBsLnByb3RvdHlwZSA9IC8qQF9fUFVSRV9fKi8gT2JqZWN0LmNyZWF0ZShFcnJvci5wcm90b3R5cGUpO1xuZXhwb3J0IHZhciBUaW1lb3V0RXJyb3IgPSBUaW1lb3V0RXJyb3JJbXBsO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9VGltZW91dEVycm9yLmpzLm1hcFxuIiwiLyoqIFBVUkVfSU1QT1JUU19TVEFSVCAgUFVSRV9JTVBPUlRTX0VORCAqL1xuZnVuY3Rpb24gVW5zdWJzY3JpcHRpb25FcnJvckltcGwoZXJyb3JzKSB7XG4gICAgRXJyb3IuY2FsbCh0aGlzKTtcbiAgICB0aGlzLm1lc3NhZ2UgPSBlcnJvcnMgP1xuICAgICAgICBlcnJvcnMubGVuZ3RoICsgXCIgZXJyb3JzIG9jY3VycmVkIGR1cmluZyB1bnN1YnNjcmlwdGlvbjpcXG5cIiArIGVycm9ycy5tYXAoZnVuY3Rpb24gKGVyciwgaSkgeyByZXR1cm4gaSArIDEgKyBcIikgXCIgKyBlcnIudG9TdHJpbmcoKTsgfSkuam9pbignXFxuICAnKSA6ICcnO1xuICAgIHRoaXMubmFtZSA9ICdVbnN1YnNjcmlwdGlvbkVycm9yJztcbiAgICB0aGlzLmVycm9ycyA9IGVycm9ycztcbiAgICByZXR1cm4gdGhpcztcbn1cblVuc3Vic2NyaXB0aW9uRXJyb3JJbXBsLnByb3RvdHlwZSA9IC8qQF9fUFVSRV9fKi8gT2JqZWN0LmNyZWF0ZShFcnJvci5wcm90b3R5cGUpO1xuZXhwb3J0IHZhciBVbnN1YnNjcmlwdGlvbkVycm9yID0gVW5zdWJzY3JpcHRpb25FcnJvckltcGw7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1VbnN1YnNjcmlwdGlvbkVycm9yLmpzLm1hcFxuIiwiLyoqIFBVUkVfSU1QT1JUU19TVEFSVCBfU3Vic2NyaWJlciBQVVJFX0lNUE9SVFNfRU5EICovXG5pbXBvcnQgeyBTdWJzY3JpYmVyIH0gZnJvbSAnLi4vU3Vic2NyaWJlcic7XG5leHBvcnQgZnVuY3Rpb24gY2FuUmVwb3J0RXJyb3Iob2JzZXJ2ZXIpIHtcbiAgICB3aGlsZSAob2JzZXJ2ZXIpIHtcbiAgICAgICAgdmFyIF9hID0gb2JzZXJ2ZXIsIGNsb3NlZF8xID0gX2EuY2xvc2VkLCBkZXN0aW5hdGlvbiA9IF9hLmRlc3RpbmF0aW9uLCBpc1N0b3BwZWQgPSBfYS5pc1N0b3BwZWQ7XG4gICAgICAgIGlmIChjbG9zZWRfMSB8fCBpc1N0b3BwZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChkZXN0aW5hdGlvbiAmJiBkZXN0aW5hdGlvbiBpbnN0YW5jZW9mIFN1YnNjcmliZXIpIHtcbiAgICAgICAgICAgIG9ic2VydmVyID0gZGVzdGluYXRpb247XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBvYnNlcnZlciA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1jYW5SZXBvcnRFcnJvci5qcy5tYXBcbiIsIi8qKiBQVVJFX0lNUE9SVFNfU1RBUlQgIFBVUkVfSU1QT1JUU19FTkQgKi9cbmV4cG9ydCB2YXIgZXJyb3JPYmplY3QgPSB7IGU6IHt9IH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1lcnJvck9iamVjdC5qcy5tYXBcbiIsIi8qKiBQVVJFX0lNUE9SVFNfU1RBUlQgIFBVUkVfSU1QT1JUU19FTkQgKi9cbmV4cG9ydCBmdW5jdGlvbiBob3N0UmVwb3J0RXJyb3IoZXJyKSB7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IHRocm93IGVycjsgfSk7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1ob3N0UmVwb3J0RXJyb3IuanMubWFwXG4iLCIvKiogUFVSRV9JTVBPUlRTX1NUQVJUICBQVVJFX0lNUE9SVFNfRU5EICovXG5leHBvcnQgZnVuY3Rpb24gaWRlbnRpdHkoeCkge1xuICAgIHJldHVybiB4O1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aWRlbnRpdHkuanMubWFwXG4iLCIvKiogUFVSRV9JTVBPUlRTX1NUQVJUICBQVVJFX0lNUE9SVFNfRU5EICovXG5leHBvcnQgdmFyIGlzQXJyYXkgPSBBcnJheS5pc0FycmF5IHx8IChmdW5jdGlvbiAoeCkgeyByZXR1cm4geCAmJiB0eXBlb2YgeC5sZW5ndGggPT09ICdudW1iZXInOyB9KTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWlzQXJyYXkuanMubWFwXG4iLCIvKiogUFVSRV9JTVBPUlRTX1NUQVJUICBQVVJFX0lNUE9SVFNfRU5EICovXG5leHBvcnQgdmFyIGlzQXJyYXlMaWtlID0gKGZ1bmN0aW9uICh4KSB7IHJldHVybiB4ICYmIHR5cGVvZiB4Lmxlbmd0aCA9PT0gJ251bWJlcicgJiYgdHlwZW9mIHggIT09ICdmdW5jdGlvbic7IH0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aXNBcnJheUxpa2UuanMubWFwXG4iLCIvKiogUFVSRV9JTVBPUlRTX1NUQVJUICBQVVJFX0lNUE9SVFNfRU5EICovXG5leHBvcnQgZnVuY3Rpb24gaXNGdW5jdGlvbih4KSB7XG4gICAgcmV0dXJuIHR5cGVvZiB4ID09PSAnZnVuY3Rpb24nO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aXNGdW5jdGlvbi5qcy5tYXBcbiIsIi8qKiBQVVJFX0lNUE9SVFNfU1RBUlQgX3N5bWJvbF9vYnNlcnZhYmxlIFBVUkVfSU1QT1JUU19FTkQgKi9cbmltcG9ydCB7IG9ic2VydmFibGUgYXMgU3ltYm9sX29ic2VydmFibGUgfSBmcm9tICcuLi9zeW1ib2wvb2JzZXJ2YWJsZSc7XG5leHBvcnQgZnVuY3Rpb24gaXNJbnRlcm9wT2JzZXJ2YWJsZShpbnB1dCkge1xuICAgIHJldHVybiBpbnB1dCAmJiB0eXBlb2YgaW5wdXRbU3ltYm9sX29ic2VydmFibGVdID09PSAnZnVuY3Rpb24nO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aXNJbnRlcm9wT2JzZXJ2YWJsZS5qcy5tYXBcbiIsIi8qKiBQVVJFX0lNUE9SVFNfU1RBUlQgX3N5bWJvbF9pdGVyYXRvciBQVVJFX0lNUE9SVFNfRU5EICovXG5pbXBvcnQgeyBpdGVyYXRvciBhcyBTeW1ib2xfaXRlcmF0b3IgfSBmcm9tICcuLi9zeW1ib2wvaXRlcmF0b3InO1xuZXhwb3J0IGZ1bmN0aW9uIGlzSXRlcmFibGUoaW5wdXQpIHtcbiAgICByZXR1cm4gaW5wdXQgJiYgdHlwZW9mIGlucHV0W1N5bWJvbF9pdGVyYXRvcl0gPT09ICdmdW5jdGlvbic7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pc0l0ZXJhYmxlLmpzLm1hcFxuIiwiLyoqIFBVUkVfSU1QT1JUU19TVEFSVCBfaXNBcnJheSBQVVJFX0lNUE9SVFNfRU5EICovXG5pbXBvcnQgeyBpc0FycmF5IH0gZnJvbSAnLi9pc0FycmF5JztcbmV4cG9ydCBmdW5jdGlvbiBpc051bWVyaWModmFsKSB7XG4gICAgcmV0dXJuICFpc0FycmF5KHZhbCkgJiYgKHZhbCAtIHBhcnNlRmxvYXQodmFsKSArIDEpID49IDA7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pc051bWVyaWMuanMubWFwXG4iLCIvKiogUFVSRV9JTVBPUlRTX1NUQVJUICBQVVJFX0lNUE9SVFNfRU5EICovXG5leHBvcnQgZnVuY3Rpb24gaXNPYmplY3QoeCkge1xuICAgIHJldHVybiB4ICE9IG51bGwgJiYgdHlwZW9mIHggPT09ICdvYmplY3QnO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aXNPYmplY3QuanMubWFwXG4iLCIvKiogUFVSRV9JTVBPUlRTX1NUQVJUIF9PYnNlcnZhYmxlIFBVUkVfSU1QT1JUU19FTkQgKi9cbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICcuLi9PYnNlcnZhYmxlJztcbmV4cG9ydCBmdW5jdGlvbiBpc09ic2VydmFibGUob2JqKSB7XG4gICAgcmV0dXJuICEhb2JqICYmIChvYmogaW5zdGFuY2VvZiBPYnNlcnZhYmxlIHx8ICh0eXBlb2Ygb2JqLmxpZnQgPT09ICdmdW5jdGlvbicgJiYgdHlwZW9mIG9iai5zdWJzY3JpYmUgPT09ICdmdW5jdGlvbicpKTtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWlzT2JzZXJ2YWJsZS5qcy5tYXBcbiIsIi8qKiBQVVJFX0lNUE9SVFNfU1RBUlQgIFBVUkVfSU1QT1JUU19FTkQgKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1Byb21pc2UodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUgJiYgdHlwZW9mIHZhbHVlLnN1YnNjcmliZSAhPT0gJ2Z1bmN0aW9uJyAmJiB0eXBlb2YgdmFsdWUudGhlbiA9PT0gJ2Z1bmN0aW9uJztcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWlzUHJvbWlzZS5qcy5tYXBcbiIsIi8qKiBQVVJFX0lNUE9SVFNfU1RBUlQgIFBVUkVfSU1QT1JUU19FTkQgKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1NjaGVkdWxlcih2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZSAmJiB0eXBlb2YgdmFsdWUuc2NoZWR1bGUgPT09ICdmdW5jdGlvbic7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pc1NjaGVkdWxlci5qcy5tYXBcbiIsIi8qKiBQVVJFX0lNUE9SVFNfU1RBUlQgIFBVUkVfSU1QT1JUU19FTkQgKi9cbmV4cG9ydCBmdW5jdGlvbiBub29wKCkgeyB9XG4vLyMgc291cmNlTWFwcGluZ1VSTD1ub29wLmpzLm1hcFxuIiwiLyoqIFBVUkVfSU1QT1JUU19TVEFSVCBfbm9vcCBQVVJFX0lNUE9SVFNfRU5EICovXG5pbXBvcnQgeyBub29wIH0gZnJvbSAnLi9ub29wJztcbmV4cG9ydCBmdW5jdGlvbiBwaXBlKCkge1xuICAgIHZhciBmbnMgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICBmbnNbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICB9XG4gICAgcmV0dXJuIHBpcGVGcm9tQXJyYXkoZm5zKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBwaXBlRnJvbUFycmF5KGZucykge1xuICAgIGlmICghZm5zKSB7XG4gICAgICAgIHJldHVybiBub29wO1xuICAgIH1cbiAgICBpZiAoZm5zLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICByZXR1cm4gZm5zWzBdO1xuICAgIH1cbiAgICByZXR1cm4gZnVuY3Rpb24gcGlwZWQoaW5wdXQpIHtcbiAgICAgICAgcmV0dXJuIGZucy5yZWR1Y2UoZnVuY3Rpb24gKHByZXYsIGZuKSB7IHJldHVybiBmbihwcmV2KTsgfSwgaW5wdXQpO1xuICAgIH07XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1waXBlLmpzLm1hcFxuIiwiLyoqIFBVUkVfSU1QT1JUU19TVEFSVCBfT2JzZXJ2YWJsZSxfc3Vic2NyaWJlVG9BcnJheSxfc3Vic2NyaWJlVG9Qcm9taXNlLF9zdWJzY3JpYmVUb0l0ZXJhYmxlLF9zdWJzY3JpYmVUb09ic2VydmFibGUsX2lzQXJyYXlMaWtlLF9pc1Byb21pc2UsX2lzT2JqZWN0LF9zeW1ib2xfaXRlcmF0b3IsX3N5bWJvbF9vYnNlcnZhYmxlIFBVUkVfSU1QT1JUU19FTkQgKi9cbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICcuLi9PYnNlcnZhYmxlJztcbmltcG9ydCB7IHN1YnNjcmliZVRvQXJyYXkgfSBmcm9tICcuL3N1YnNjcmliZVRvQXJyYXknO1xuaW1wb3J0IHsgc3Vic2NyaWJlVG9Qcm9taXNlIH0gZnJvbSAnLi9zdWJzY3JpYmVUb1Byb21pc2UnO1xuaW1wb3J0IHsgc3Vic2NyaWJlVG9JdGVyYWJsZSB9IGZyb20gJy4vc3Vic2NyaWJlVG9JdGVyYWJsZSc7XG5pbXBvcnQgeyBzdWJzY3JpYmVUb09ic2VydmFibGUgfSBmcm9tICcuL3N1YnNjcmliZVRvT2JzZXJ2YWJsZSc7XG5pbXBvcnQgeyBpc0FycmF5TGlrZSB9IGZyb20gJy4vaXNBcnJheUxpa2UnO1xuaW1wb3J0IHsgaXNQcm9taXNlIH0gZnJvbSAnLi9pc1Byb21pc2UnO1xuaW1wb3J0IHsgaXNPYmplY3QgfSBmcm9tICcuL2lzT2JqZWN0JztcbmltcG9ydCB7IGl0ZXJhdG9yIGFzIFN5bWJvbF9pdGVyYXRvciB9IGZyb20gJy4uL3N5bWJvbC9pdGVyYXRvcic7XG5pbXBvcnQgeyBvYnNlcnZhYmxlIGFzIFN5bWJvbF9vYnNlcnZhYmxlIH0gZnJvbSAnLi4vc3ltYm9sL29ic2VydmFibGUnO1xuZXhwb3J0IHZhciBzdWJzY3JpYmVUbyA9IGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICBpZiAocmVzdWx0IGluc3RhbmNlb2YgT2JzZXJ2YWJsZSkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHN1YnNjcmliZXIpIHtcbiAgICAgICAgICAgIGlmIChyZXN1bHQuX2lzU2NhbGFyKSB7XG4gICAgICAgICAgICAgICAgc3Vic2NyaWJlci5uZXh0KHJlc3VsdC52YWx1ZSk7XG4gICAgICAgICAgICAgICAgc3Vic2NyaWJlci5jb21wbGV0ZSgpO1xuICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0LnN1YnNjcmliZShzdWJzY3JpYmVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG4gICAgZWxzZSBpZiAocmVzdWx0ICYmIHR5cGVvZiByZXN1bHRbU3ltYm9sX29ic2VydmFibGVdID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHJldHVybiBzdWJzY3JpYmVUb09ic2VydmFibGUocmVzdWx0KTtcbiAgICB9XG4gICAgZWxzZSBpZiAoaXNBcnJheUxpa2UocmVzdWx0KSkge1xuICAgICAgICByZXR1cm4gc3Vic2NyaWJlVG9BcnJheShyZXN1bHQpO1xuICAgIH1cbiAgICBlbHNlIGlmIChpc1Byb21pc2UocmVzdWx0KSkge1xuICAgICAgICByZXR1cm4gc3Vic2NyaWJlVG9Qcm9taXNlKHJlc3VsdCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKHJlc3VsdCAmJiB0eXBlb2YgcmVzdWx0W1N5bWJvbF9pdGVyYXRvcl0gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgcmV0dXJuIHN1YnNjcmliZVRvSXRlcmFibGUocmVzdWx0KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IGlzT2JqZWN0KHJlc3VsdCkgPyAnYW4gaW52YWxpZCBvYmplY3QnIDogXCInXCIgKyByZXN1bHQgKyBcIidcIjtcbiAgICAgICAgdmFyIG1zZyA9IFwiWW91IHByb3ZpZGVkIFwiICsgdmFsdWUgKyBcIiB3aGVyZSBhIHN0cmVhbSB3YXMgZXhwZWN0ZWQuXCJcbiAgICAgICAgICAgICsgJyBZb3UgY2FuIHByb3ZpZGUgYW4gT2JzZXJ2YWJsZSwgUHJvbWlzZSwgQXJyYXksIG9yIEl0ZXJhYmxlLic7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IobXNnKTtcbiAgICB9XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c3Vic2NyaWJlVG8uanMubWFwXG4iLCIvKiogUFVSRV9JTVBPUlRTX1NUQVJUICBQVVJFX0lNUE9SVFNfRU5EICovXG5leHBvcnQgdmFyIHN1YnNjcmliZVRvQXJyYXkgPSBmdW5jdGlvbiAoYXJyYXkpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHN1YnNjcmliZXIpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGFycmF5Lmxlbmd0aDsgaSA8IGxlbiAmJiAhc3Vic2NyaWJlci5jbG9zZWQ7IGkrKykge1xuICAgICAgICAgICAgc3Vic2NyaWJlci5uZXh0KGFycmF5W2ldKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXN1YnNjcmliZXIuY2xvc2VkKSB7XG4gICAgICAgICAgICBzdWJzY3JpYmVyLmNvbXBsZXRlKCk7XG4gICAgICAgIH1cbiAgICB9O1xufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXN1YnNjcmliZVRvQXJyYXkuanMubWFwXG4iLCIvKiogUFVSRV9JTVBPUlRTX1NUQVJUIF9zeW1ib2xfaXRlcmF0b3IgUFVSRV9JTVBPUlRTX0VORCAqL1xuaW1wb3J0IHsgaXRlcmF0b3IgYXMgU3ltYm9sX2l0ZXJhdG9yIH0gZnJvbSAnLi4vc3ltYm9sL2l0ZXJhdG9yJztcbmV4cG9ydCB2YXIgc3Vic2NyaWJlVG9JdGVyYWJsZSA9IGZ1bmN0aW9uIChpdGVyYWJsZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoc3Vic2NyaWJlcikge1xuICAgICAgICB2YXIgaXRlcmF0b3IgPSBpdGVyYWJsZVtTeW1ib2xfaXRlcmF0b3JdKCk7XG4gICAgICAgIGRvIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gaXRlcmF0b3IubmV4dCgpO1xuICAgICAgICAgICAgaWYgKGl0ZW0uZG9uZSkge1xuICAgICAgICAgICAgICAgIHN1YnNjcmliZXIuY29tcGxldGUoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHN1YnNjcmliZXIubmV4dChpdGVtLnZhbHVlKTtcbiAgICAgICAgICAgIGlmIChzdWJzY3JpYmVyLmNsb3NlZCkge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IHdoaWxlICh0cnVlKTtcbiAgICAgICAgaWYgKHR5cGVvZiBpdGVyYXRvci5yZXR1cm4gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHN1YnNjcmliZXIuYWRkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAoaXRlcmF0b3IucmV0dXJuKSB7XG4gICAgICAgICAgICAgICAgICAgIGl0ZXJhdG9yLnJldHVybigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzdWJzY3JpYmVyO1xuICAgIH07XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c3Vic2NyaWJlVG9JdGVyYWJsZS5qcy5tYXBcbiIsIi8qKiBQVVJFX0lNUE9SVFNfU1RBUlQgX3N5bWJvbF9vYnNlcnZhYmxlIFBVUkVfSU1QT1JUU19FTkQgKi9cbmltcG9ydCB7IG9ic2VydmFibGUgYXMgU3ltYm9sX29ic2VydmFibGUgfSBmcm9tICcuLi9zeW1ib2wvb2JzZXJ2YWJsZSc7XG5leHBvcnQgdmFyIHN1YnNjcmliZVRvT2JzZXJ2YWJsZSA9IGZ1bmN0aW9uIChvYmopIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHN1YnNjcmliZXIpIHtcbiAgICAgICAgdmFyIG9icyA9IG9ialtTeW1ib2xfb2JzZXJ2YWJsZV0oKTtcbiAgICAgICAgaWYgKHR5cGVvZiBvYnMuc3Vic2NyaWJlICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdQcm92aWRlZCBvYmplY3QgZG9lcyBub3QgY29ycmVjdGx5IGltcGxlbWVudCBTeW1ib2wub2JzZXJ2YWJsZScpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG9icy5zdWJzY3JpYmUoc3Vic2NyaWJlcik7XG4gICAgICAgIH1cbiAgICB9O1xufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXN1YnNjcmliZVRvT2JzZXJ2YWJsZS5qcy5tYXBcbiIsIi8qKiBQVVJFX0lNUE9SVFNfU1RBUlQgX2hvc3RSZXBvcnRFcnJvciBQVVJFX0lNUE9SVFNfRU5EICovXG5pbXBvcnQgeyBob3N0UmVwb3J0RXJyb3IgfSBmcm9tICcuL2hvc3RSZXBvcnRFcnJvcic7XG5leHBvcnQgdmFyIHN1YnNjcmliZVRvUHJvbWlzZSA9IGZ1bmN0aW9uIChwcm9taXNlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChzdWJzY3JpYmVyKSB7XG4gICAgICAgIHByb21pc2UudGhlbihmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGlmICghc3Vic2NyaWJlci5jbG9zZWQpIHtcbiAgICAgICAgICAgICAgICBzdWJzY3JpYmVyLm5leHQodmFsdWUpO1xuICAgICAgICAgICAgICAgIHN1YnNjcmliZXIuY29tcGxldGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgZnVuY3Rpb24gKGVycikgeyByZXR1cm4gc3Vic2NyaWJlci5lcnJvcihlcnIpOyB9KVxuICAgICAgICAgICAgLnRoZW4obnVsbCwgaG9zdFJlcG9ydEVycm9yKTtcbiAgICAgICAgcmV0dXJuIHN1YnNjcmliZXI7XG4gICAgfTtcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zdWJzY3JpYmVUb1Byb21pc2UuanMubWFwXG4iLCIvKiogUFVSRV9JTVBPUlRTX1NUQVJUIF9Jbm5lclN1YnNjcmliZXIsX3N1YnNjcmliZVRvIFBVUkVfSU1QT1JUU19FTkQgKi9cbmltcG9ydCB7IElubmVyU3Vic2NyaWJlciB9IGZyb20gJy4uL0lubmVyU3Vic2NyaWJlcic7XG5pbXBvcnQgeyBzdWJzY3JpYmVUbyB9IGZyb20gJy4vc3Vic2NyaWJlVG8nO1xuZXhwb3J0IGZ1bmN0aW9uIHN1YnNjcmliZVRvUmVzdWx0KG91dGVyU3Vic2NyaWJlciwgcmVzdWx0LCBvdXRlclZhbHVlLCBvdXRlckluZGV4LCBkZXN0aW5hdGlvbikge1xuICAgIGlmIChkZXN0aW5hdGlvbiA9PT0gdm9pZCAwKSB7XG4gICAgICAgIGRlc3RpbmF0aW9uID0gbmV3IElubmVyU3Vic2NyaWJlcihvdXRlclN1YnNjcmliZXIsIG91dGVyVmFsdWUsIG91dGVySW5kZXgpO1xuICAgIH1cbiAgICBpZiAoZGVzdGluYXRpb24uY2xvc2VkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgcmV0dXJuIHN1YnNjcmliZVRvKHJlc3VsdCkoZGVzdGluYXRpb24pO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c3Vic2NyaWJlVG9SZXN1bHQuanMubWFwXG4iLCIvKiogUFVSRV9JTVBPUlRTX1NUQVJUIF9TdWJzY3JpYmVyLF9zeW1ib2xfcnhTdWJzY3JpYmVyLF9PYnNlcnZlciBQVVJFX0lNUE9SVFNfRU5EICovXG5pbXBvcnQgeyBTdWJzY3JpYmVyIH0gZnJvbSAnLi4vU3Vic2NyaWJlcic7XG5pbXBvcnQgeyByeFN1YnNjcmliZXIgYXMgcnhTdWJzY3JpYmVyU3ltYm9sIH0gZnJvbSAnLi4vc3ltYm9sL3J4U3Vic2NyaWJlcic7XG5pbXBvcnQgeyBlbXB0eSBhcyBlbXB0eU9ic2VydmVyIH0gZnJvbSAnLi4vT2JzZXJ2ZXInO1xuZXhwb3J0IGZ1bmN0aW9uIHRvU3Vic2NyaWJlcihuZXh0T3JPYnNlcnZlciwgZXJyb3IsIGNvbXBsZXRlKSB7XG4gICAgaWYgKG5leHRPck9ic2VydmVyKSB7XG4gICAgICAgIGlmIChuZXh0T3JPYnNlcnZlciBpbnN0YW5jZW9mIFN1YnNjcmliZXIpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXh0T3JPYnNlcnZlcjtcbiAgICAgICAgfVxuICAgICAgICBpZiAobmV4dE9yT2JzZXJ2ZXJbcnhTdWJzY3JpYmVyU3ltYm9sXSkge1xuICAgICAgICAgICAgcmV0dXJuIG5leHRPck9ic2VydmVyW3J4U3Vic2NyaWJlclN5bWJvbF0oKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoIW5leHRPck9ic2VydmVyICYmICFlcnJvciAmJiAhY29tcGxldGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBTdWJzY3JpYmVyKGVtcHR5T2JzZXJ2ZXIpO1xuICAgIH1cbiAgICByZXR1cm4gbmV3IFN1YnNjcmliZXIobmV4dE9yT2JzZXJ2ZXIsIGVycm9yLCBjb21wbGV0ZSk7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD10b1N1YnNjcmliZXIuanMubWFwXG4iLCIvKiogUFVSRV9JTVBPUlRTX1NUQVJUIF9lcnJvck9iamVjdCBQVVJFX0lNUE9SVFNfRU5EICovXG5pbXBvcnQgeyBlcnJvck9iamVjdCB9IGZyb20gJy4vZXJyb3JPYmplY3QnO1xudmFyIHRyeUNhdGNoVGFyZ2V0O1xuZnVuY3Rpb24gdHJ5Q2F0Y2hlcigpIHtcbiAgICB0cnkge1xuICAgICAgICByZXR1cm4gdHJ5Q2F0Y2hUYXJnZXQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgZXJyb3JPYmplY3QuZSA9IGU7XG4gICAgICAgIHJldHVybiBlcnJvck9iamVjdDtcbiAgICB9XG59XG5leHBvcnQgZnVuY3Rpb24gdHJ5Q2F0Y2goZm4pIHtcbiAgICB0cnlDYXRjaFRhcmdldCA9IGZuO1xuICAgIHJldHVybiB0cnlDYXRjaGVyO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dHJ5Q2F0Y2guanMubWFwXG4iLCIvKlxuICpcbiAqIENvcHJ5cmlnaHQgMjAxOCwgQ3JhaWcgQ29uZG9uXG4gKiBMaWNlbnNlZCB1bmRlciBNSVRcbiAqXG4gKiBGaWx0ZXIgSmF2YVNjcmlwdCBvYmplY3RzIHdpdGggbW9uZ29kYiBxdWVyaWVzXG4gKi9cblxuLyoqXG4gKi9cblxuZnVuY3Rpb24gaXNGdW5jdGlvbih2YWx1ZSkge1xuICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnZnVuY3Rpb24nO1xufVxuXG4vKipcbiAqL1xuXG5mdW5jdGlvbiBpc0FycmF5KHZhbHVlKSB7XG4gIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodmFsdWUpID09PSAnW29iamVjdCBBcnJheV0nO1xufVxuXG4vKipcbiAqL1xuXG5mdW5jdGlvbiBjb21wYXJhYmxlKHZhbHVlKSB7XG4gIGlmICh2YWx1ZSBpbnN0YW5jZW9mIERhdGUpIHtcbiAgICByZXR1cm4gdmFsdWUuZ2V0VGltZSgpO1xuICB9IGVsc2UgaWYgKGlzQXJyYXkodmFsdWUpKSB7XG4gICAgcmV0dXJuIHZhbHVlLm1hcChjb21wYXJhYmxlKTtcbiAgfSBlbHNlIGlmICh2YWx1ZSAmJiB0eXBlb2YgdmFsdWUudG9KU09OID09PSAnZnVuY3Rpb24nKSB7XG4gICAgcmV0dXJuIHZhbHVlLnRvSlNPTigpO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxufVxuXG5mdW5jdGlvbiBnZXQob2JqLCBrZXkpIHtcbiAgcmV0dXJuIGlzRnVuY3Rpb24ob2JqLmdldCkgPyBvYmouZ2V0KGtleSkgOiBvYmpba2V5XTtcbn1cblxuLyoqXG4gKi9cblxuZnVuY3Rpb24gb3IodmFsaWRhdG9yKSB7XG4gIHJldHVybiBmdW5jdGlvbihhLCBiKSB7XG4gICAgaWYgKCFpc0FycmF5KGIpIHx8ICFiLmxlbmd0aCkge1xuICAgICAgcmV0dXJuIHZhbGlkYXRvcihhLCBiKTtcbiAgICB9XG4gICAgZm9yICh2YXIgaSA9IDAsIG4gPSBiLmxlbmd0aDsgaSA8IG47IGkrKykge1xuICAgICAgaWYgKHZhbGlkYXRvcihhLCBnZXQoYixpKSkpIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cblxuLyoqXG4gKi9cblxuZnVuY3Rpb24gYW5kKHZhbGlkYXRvcikge1xuICByZXR1cm4gZnVuY3Rpb24oYSwgYikge1xuICAgIGlmICghaXNBcnJheShiKSB8fCAhYi5sZW5ndGgpIHtcbiAgICAgIHJldHVybiB2YWxpZGF0b3IoYSwgYik7XG4gICAgfVxuICAgIGZvciAodmFyIGkgPSAwLCBuID0gYi5sZW5ndGg7IGkgPCBuOyBpKyspIHtcbiAgICAgIGlmICghdmFsaWRhdG9yKGEsIGdldChiLCBpKSkpIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH07XG59XG5cbmZ1bmN0aW9uIHZhbGlkYXRlKHZhbGlkYXRvciwgYiwgaywgbykge1xuICByZXR1cm4gdmFsaWRhdG9yLnYodmFsaWRhdG9yLmEsIGIsIGssIG8pO1xufVxuXG52YXIgT1BFUkFUT1JTID0ge1xuXG4gIC8qKlxuICAgKi9cblxuICAkZXE6IG9yKGZ1bmN0aW9uKGEsIGIpIHtcbiAgICByZXR1cm4gYShiKTtcbiAgfSksXG5cbiAgLyoqXG4gICAqL1xuXG4gICRuZTogYW5kKGZ1bmN0aW9uKGEsIGIpIHtcbiAgICByZXR1cm4gIWEoYik7XG4gIH0pLFxuXG4gIC8qKlxuICAgKi9cblxuICAkZ3Q6IG9yKGZ1bmN0aW9uKGEsIGIpIHtcbiAgICByZXR1cm4gY29tcGFyZShjb21wYXJhYmxlKGIpLCBhKSA+IDA7XG4gIH0pLFxuXG4gIC8qKlxuICAgKi9cblxuICAkZ3RlOiBvcihmdW5jdGlvbihhLCBiKSB7XG4gICAgcmV0dXJuIGNvbXBhcmUoY29tcGFyYWJsZShiKSwgYSkgPj0gMDtcbiAgfSksXG5cbiAgLyoqXG4gICAqL1xuXG4gICRsdDogb3IoZnVuY3Rpb24oYSwgYikge1xuICAgIHJldHVybiBjb21wYXJlKGNvbXBhcmFibGUoYiksIGEpIDwgMDtcbiAgfSksXG5cbiAgLyoqXG4gICAqL1xuXG4gICRsdGU6IG9yKGZ1bmN0aW9uKGEsIGIpIHtcbiAgICByZXR1cm4gY29tcGFyZShjb21wYXJhYmxlKGIpLCBhKSA8PSAwO1xuICB9KSxcblxuICAvKipcbiAgICovXG5cbiAgJG1vZDogb3IoZnVuY3Rpb24oYSwgYikge1xuICAgIHJldHVybiBiICUgYVswXSA9PSBhWzFdO1xuICB9KSxcblxuICAvKipcbiAgICovXG5cbiAgJGluOiBmdW5jdGlvbihhLCBiKSB7XG5cbiAgICBpZiAoYiBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICBmb3IgKHZhciBpID0gYi5sZW5ndGg7IGktLTspIHtcbiAgICAgICAgaWYgKH5hLmluZGV4T2YoY29tcGFyYWJsZShnZXQoYiwgaSkpKSkge1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciBjb21wYXJhYmxlQiA9IGNvbXBhcmFibGUoYik7XG4gICAgICBpZiAoY29tcGFyYWJsZUIgPT09IGIgJiYgdHlwZW9mIGIgPT09ICdvYmplY3QnKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSBhLmxlbmd0aDsgaS0tOykge1xuICAgICAgICAgIGlmIChTdHJpbmcoYVtpXSkgPT09IFN0cmluZyhiKSAmJiBTdHJpbmcoYikgIT09ICdbb2JqZWN0IE9iamVjdF0nKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLypcbiAgICAgICAgSGFuZGxlcyBkb2N1bWVudHMgdGhhdCBhcmUgdW5kZWZpbmVkLCB3aGlsc3QgYWxzb1xuICAgICAgICBoYXZpbmcgYSAnbnVsbCcgZWxlbWVudCBpbiB0aGUgcGFyYW1ldGVycyB0byAkaW4uXG4gICAgICAqL1xuICAgICAgaWYgKHR5cGVvZiBjb21wYXJhYmxlQiA9PSAndW5kZWZpbmVkJykge1xuICAgICAgICBmb3IgKHZhciBpID0gYS5sZW5ndGg7IGktLTspIHtcbiAgICAgICAgICBpZiAoYVtpXSA9PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLypcbiAgICAgICAgSGFuZGxlcyB0aGUgY2FzZSBvZiB7J2ZpZWxkJzogeyRpbjogWy9yZWdleHAxLywgL3JlZ2V4cDIvLCAuLi5dfX1cbiAgICAgICovXG4gICAgICBmb3IgKHZhciBpID0gYS5sZW5ndGg7IGktLTspIHtcbiAgICAgICAgdmFyIHZhbGlkYXRvciA9IGNyZWF0ZVJvb3RWYWxpZGF0b3IoZ2V0KGEsIGkpLCB1bmRlZmluZWQpO1xuICAgICAgICB2YXIgcmVzdWx0ID0gdmFsaWRhdGUodmFsaWRhdG9yLCBiLCBpLCBhKTtcbiAgICAgICAgaWYgKChyZXN1bHQpICYmIChTdHJpbmcocmVzdWx0KSAhPT0gJ1tvYmplY3QgT2JqZWN0XScpICYmIChTdHJpbmcoYikgIT09ICdbb2JqZWN0IE9iamVjdF0nKSkge1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiAhIX5hLmluZGV4T2YoY29tcGFyYWJsZUIpO1xuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfSxcblxuICAvKipcbiAgICovXG5cbiAgJG5pbjogZnVuY3Rpb24oYSwgYiwgaywgbykge1xuICAgIHJldHVybiAhT1BFUkFUT1JTLiRpbihhLCBiLCBrLCBvKTtcbiAgfSxcblxuICAvKipcbiAgICovXG5cbiAgJG5vdDogZnVuY3Rpb24oYSwgYiwgaywgbykge1xuICAgIHJldHVybiAhdmFsaWRhdGUoYSwgYiwgaywgbyk7XG4gIH0sXG5cbiAgLyoqXG4gICAqL1xuXG4gICR0eXBlOiBmdW5jdGlvbihhLCBiKSB7XG4gICAgcmV0dXJuIGIgIT0gdm9pZCAwID8gYiBpbnN0YW5jZW9mIGEgfHwgYi5jb25zdHJ1Y3RvciA9PSBhIDogZmFsc2U7XG4gICAgfSxcblxuICAvKipcbiAgICovXG5cbiAgJGFsbDogZnVuY3Rpb24oYSwgYiwgaywgbykge1xuICAgIHJldHVybiBPUEVSQVRPUlMuJGFuZChhLCBiLCBrLCBvKTtcbiAgfSxcblxuICAvKipcbiAgICovXG5cbiAgJHNpemU6IGZ1bmN0aW9uKGEsIGIpIHtcbiAgICByZXR1cm4gYiA/IGEgPT09IGIubGVuZ3RoIDogZmFsc2U7XG4gIH0sXG5cbiAgLyoqXG4gICAqL1xuXG4gICRvcjogZnVuY3Rpb24oYSwgYiwgaywgbykge1xuICAgIGZvciAodmFyIGkgPSAwLCBuID0gYS5sZW5ndGg7IGkgPCBuOyBpKyspIGlmICh2YWxpZGF0ZShnZXQoYSwgaSksIGIsIGssIG8pKSByZXR1cm4gdHJ1ZTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH0sXG5cbiAgLyoqXG4gICAqL1xuXG4gICRub3I6IGZ1bmN0aW9uKGEsIGIsIGssIG8pIHtcbiAgICByZXR1cm4gIU9QRVJBVE9SUy4kb3IoYSwgYiwgaywgbyk7XG4gIH0sXG5cbiAgLyoqXG4gICAqL1xuXG4gICRhbmQ6IGZ1bmN0aW9uKGEsIGIsIGssIG8pIHtcbiAgICBmb3IgKHZhciBpID0gMCwgbiA9IGEubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XG4gICAgICBpZiAoIXZhbGlkYXRlKGdldChhLCBpKSwgYiwgaywgbykpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSxcblxuICAvKipcbiAgICovXG5cbiAgJHJlZ2V4OiBvcihmdW5jdGlvbihhLCBiKSB7XG4gICAgcmV0dXJuIHR5cGVvZiBiID09PSAnc3RyaW5nJyAmJiBhLnRlc3QoYik7XG4gIH0pLFxuXG4gIC8qKlxuICAgKi9cblxuICAkd2hlcmU6IGZ1bmN0aW9uKGEsIGIsIGssIG8pIHtcbiAgICByZXR1cm4gYS5jYWxsKGIsIGIsIGssIG8pO1xuICB9LFxuXG4gIC8qKlxuICAgKi9cblxuICAkZWxlbU1hdGNoOiBmdW5jdGlvbihhLCBiLCBrLCBvKSB7XG4gICAgaWYgKGlzQXJyYXkoYikpIHtcbiAgICAgIHJldHVybiAhIX5zZWFyY2goYiwgYSk7XG4gICAgfVxuICAgIHJldHVybiB2YWxpZGF0ZShhLCBiLCBrLCBvKTtcbiAgfSxcblxuICAvKipcbiAgICovXG5cbiAgJGV4aXN0czogZnVuY3Rpb24oYSwgYiwgaywgbykge1xuICAgIHJldHVybiBvLmhhc093blByb3BlcnR5KGspID09PSBhO1xuICB9XG59O1xuXG4vKipcbiAqL1xuXG52YXIgcHJlcGFyZSA9IHtcblxuICAvKipcbiAgICovXG5cbiAgJGVxOiBmdW5jdGlvbihhKSB7XG5cbiAgICBpZiAoYSBpbnN0YW5jZW9mIFJlZ0V4cCkge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uKGIpIHtcbiAgICAgICAgcmV0dXJuIHR5cGVvZiBiID09PSAnc3RyaW5nJyAmJiBhLnRlc3QoYik7XG4gICAgICB9O1xuICAgIH0gZWxzZSBpZiAoYSBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XG4gICAgICByZXR1cm4gYTtcbiAgICB9IGVsc2UgaWYgKGlzQXJyYXkoYSkgJiYgIWEubGVuZ3RoKSB7XG4gICAgICAvLyBTcGVjaWFsIGNhc2Ugb2YgYSA9PSBbXVxuICAgICAgcmV0dXJuIGZ1bmN0aW9uKGIpIHtcbiAgICAgICAgcmV0dXJuIChpc0FycmF5KGIpICYmICFiLmxlbmd0aCk7XG4gICAgICB9O1xuICAgIH0gZWxzZSBpZiAoYSA9PT0gbnVsbCl7XG4gICAgICByZXR1cm4gZnVuY3Rpb24oYil7XG4gICAgICAgIC8vd2lsbCBtYXRjaCBib3RoIG51bGwgYW5kIHVuZGVmaW5lZFxuICAgICAgICByZXR1cm4gYiA9PSBudWxsO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBmdW5jdGlvbihiKSB7XG4gICAgICByZXR1cm4gY29tcGFyZShjb21wYXJhYmxlKGIpLCBjb21wYXJhYmxlKGEpKSA9PT0gMDtcbiAgICB9O1xuICB9LFxuXG4gIC8qKlxuICAgKi9cblxuICAkbmU6IGZ1bmN0aW9uKGEpIHtcbiAgICByZXR1cm4gcHJlcGFyZS4kZXEoYSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqL1xuXG4gICRhbmQ6IGZ1bmN0aW9uKGEpIHtcbiAgICByZXR1cm4gYS5tYXAocGFyc2UpO1xuICB9LFxuXG4gIC8qKlxuICAgKi9cblxuICAkYWxsOiBmdW5jdGlvbihhKSB7XG4gICAgcmV0dXJuIHByZXBhcmUuJGFuZChhKTtcbiAgfSxcblxuICAvKipcbiAgICovXG5cbiAgJG9yOiBmdW5jdGlvbihhKSB7XG4gICAgcmV0dXJuIGEubWFwKHBhcnNlKTtcbiAgfSxcblxuICAvKipcbiAgICovXG5cbiAgJG5vcjogZnVuY3Rpb24oYSkge1xuICAgIHJldHVybiBhLm1hcChwYXJzZSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqL1xuXG4gICRub3Q6IGZ1bmN0aW9uKGEpIHtcbiAgICByZXR1cm4gcGFyc2UoYSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqL1xuXG4gICRyZWdleDogZnVuY3Rpb24oYSwgcXVlcnkpIHtcbiAgICByZXR1cm4gbmV3IFJlZ0V4cChhLCBxdWVyeS4kb3B0aW9ucyk7XG4gIH0sXG5cbiAgLyoqXG4gICAqL1xuXG4gICR3aGVyZTogZnVuY3Rpb24oYSkge1xuICAgIHJldHVybiB0eXBlb2YgYSA9PT0gJ3N0cmluZycgPyBuZXcgRnVuY3Rpb24oJ29iaicsICdyZXR1cm4gJyArIGEpIDogYTtcbiAgfSxcblxuICAvKipcbiAgICovXG5cbiAgJGVsZW1NYXRjaDogZnVuY3Rpb24oYSkge1xuICAgIHJldHVybiBwYXJzZShhKTtcbiAgfSxcblxuICAvKipcbiAgICovXG5cbiAgJGV4aXN0czogZnVuY3Rpb24oYSkge1xuICAgIHJldHVybiAhIWE7XG4gIH1cbn07XG5cbi8qKlxuICovXG5cbmZ1bmN0aW9uIHNlYXJjaChhcnJheSwgdmFsaWRhdG9yKSB7XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykge1xuICAgIHZhciByZXN1bHQgPSBnZXQoYXJyYXksIGkpO1xuICAgIGlmICh2YWxpZGF0ZSh2YWxpZGF0b3IsIGdldChhcnJheSwgaSkpKSB7XG4gICAgICByZXR1cm4gaTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gLTE7XG59XG5cbi8qKlxuICovXG5cbmZ1bmN0aW9uIGNyZWF0ZVZhbGlkYXRvcihhLCB2YWxpZGF0ZSkge1xuICByZXR1cm4geyBhOiBhLCB2OiB2YWxpZGF0ZSB9O1xufVxuXG4vKipcbiAqL1xuXG5mdW5jdGlvbiBuZXN0ZWRWYWxpZGF0b3IoYSwgYikge1xuICB2YXIgdmFsdWVzICA9IFtdO1xuICBmaW5kVmFsdWVzKGIsIGEuaywgMCwgYiwgdmFsdWVzKTtcblxuICBpZiAodmFsdWVzLmxlbmd0aCA9PT0gMSkge1xuICAgIHZhciBmaXJzdCA9IHZhbHVlc1swXTtcbiAgICByZXR1cm4gdmFsaWRhdGUoYS5udiwgZmlyc3RbMF0sIGZpcnN0WzFdLCBmaXJzdFsyXSk7XG4gIH1cblxuICAvLyBJZiB0aGUgcXVlcnkgY29udGFpbnMgJG5lLCBuZWVkIHRvIHRlc3QgYWxsIGVsZW1lbnRzIEFORGVkIHRvZ2V0aGVyXG4gIHZhciBpbmNsdXNpdmUgPSBhICYmIGEucSAmJiB0eXBlb2YgYS5xLiRuZSAhPT0gJ3VuZGVmaW5lZCc7XG4gIHZhciBhbGxWYWxpZCA9IGluY2x1c2l2ZTtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCB2YWx1ZXMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgcmVzdWx0ID0gdmFsdWVzW2ldO1xuICAgIHZhciBpc1ZhbGlkID0gdmFsaWRhdGUoYS5udiwgcmVzdWx0WzBdLCByZXN1bHRbMV0sIHJlc3VsdFsyXSk7XG4gICAgaWYgKGluY2x1c2l2ZSkge1xuICAgICAgYWxsVmFsaWQgJj0gaXNWYWxpZDtcbiAgICB9IGVsc2Uge1xuICAgICAgYWxsVmFsaWQgfD0gaXNWYWxpZDtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGFsbFZhbGlkO1xufVxuXG4vKipcbiAqL1xuXG5mdW5jdGlvbiBmaW5kVmFsdWVzKGN1cnJlbnQsIGtleXBhdGgsIGluZGV4LCBvYmplY3QsIHZhbHVlcykge1xuXG4gIGlmIChpbmRleCA9PT0ga2V5cGF0aC5sZW5ndGggfHwgY3VycmVudCA9PSB2b2lkIDApIHtcblxuICAgIHZhbHVlcy5wdXNoKFtjdXJyZW50LCBrZXlwYXRoW2luZGV4IC0gMV0sIG9iamVjdF0pO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBrID0gZ2V0KGtleXBhdGgsIGluZGV4KTtcblxuICAvLyBlbnN1cmUgdGhhdCBpZiBjdXJyZW50IGlzIGFuIGFycmF5LCB0aGF0IHRoZSBjdXJyZW50IGtleVxuICAvLyBpcyBOT1QgYW4gYXJyYXkgaW5kZXguIFRoaXMgc29ydCBvZiB0aGluZyBuZWVkcyB0byB3b3JrOlxuICAvLyBzaWZ0KHsnZm9vLjAnOjQyfSwgW3tmb286IFs0Ml19XSk7XG4gIGlmIChpc0FycmF5KGN1cnJlbnQpICYmIGlzTmFOKE51bWJlcihrKSkpIHtcbiAgICBmb3IgKHZhciBpID0gMCwgbiA9IGN1cnJlbnQubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XG4gICAgICBmaW5kVmFsdWVzKGdldChjdXJyZW50LCBpKSwga2V5cGF0aCwgaW5kZXgsIGN1cnJlbnQsIHZhbHVlcyk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGZpbmRWYWx1ZXMoZ2V0KGN1cnJlbnQsIGspLCBrZXlwYXRoLCBpbmRleCArIDEsIGN1cnJlbnQsIHZhbHVlcyk7XG4gIH1cbn1cblxuLyoqXG4gKi9cblxuZnVuY3Rpb24gY3JlYXRlTmVzdGVkVmFsaWRhdG9yKGtleXBhdGgsIGEsIHEpIHtcbiAgcmV0dXJuIHsgYTogeyBrOiBrZXlwYXRoLCBudjogYSwgcTogcSB9LCB2OiBuZXN0ZWRWYWxpZGF0b3IgfTtcbn1cblxuLyoqXG4gKiBmbGF0dGVuIHRoZSBxdWVyeVxuICovXG5cbmZ1bmN0aW9uIGlzVmFuaWxsYU9iamVjdCh2YWx1ZSkge1xuICByZXR1cm4gdmFsdWUgJiYgdmFsdWUuY29uc3RydWN0b3IgPT09IE9iamVjdDtcbn1cblxuZnVuY3Rpb24gcGFyc2UocXVlcnkpIHtcbiAgcXVlcnkgPSBjb21wYXJhYmxlKHF1ZXJ5KTtcblxuICBpZiAoIXF1ZXJ5IHx8ICFpc1ZhbmlsbGFPYmplY3QocXVlcnkpKSB7IC8vIGNyb3NzIGJyb3dzZXIgc3VwcG9ydFxuICAgIHF1ZXJ5ID0geyAkZXE6IHF1ZXJ5IH07XG4gIH1cblxuICB2YXIgdmFsaWRhdG9ycyA9IFtdO1xuXG4gIGZvciAodmFyIGtleSBpbiBxdWVyeSkge1xuICAgIHZhciBhID0gcXVlcnlba2V5XTtcblxuICAgIGlmIChrZXkgPT09ICckb3B0aW9ucycpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIGlmIChPUEVSQVRPUlNba2V5XSkge1xuICAgICAgaWYgKHByZXBhcmVba2V5XSkgYSA9IHByZXBhcmVba2V5XShhLCBxdWVyeSk7XG4gICAgICB2YWxpZGF0b3JzLnB1c2goY3JlYXRlVmFsaWRhdG9yKGNvbXBhcmFibGUoYSksIE9QRVJBVE9SU1trZXldKSk7XG4gICAgfSBlbHNlIHtcblxuICAgICAgaWYgKGtleS5jaGFyQ29kZUF0KDApID09PSAzNikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Vua25vd24gb3BlcmF0aW9uICcgKyBrZXkpO1xuICAgICAgfVxuICAgICAgdmFsaWRhdG9ycy5wdXNoKGNyZWF0ZU5lc3RlZFZhbGlkYXRvcihrZXkuc3BsaXQoJy4nKSwgcGFyc2UoYSksIGEpKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gdmFsaWRhdG9ycy5sZW5ndGggPT09IDEgPyB2YWxpZGF0b3JzWzBdIDogY3JlYXRlVmFsaWRhdG9yKHZhbGlkYXRvcnMsIE9QRVJBVE9SUy4kYW5kKTtcbn1cblxuLyoqXG4gKi9cblxuZnVuY3Rpb24gY3JlYXRlUm9vdFZhbGlkYXRvcihxdWVyeSwgZ2V0dGVyKSB7XG4gIHZhciB2YWxpZGF0b3IgPSBwYXJzZShxdWVyeSk7XG4gIGlmIChnZXR0ZXIpIHtcbiAgICB2YWxpZGF0b3IgPSB7XG4gICAgICBhOiB2YWxpZGF0b3IsXG4gICAgICB2OiBmdW5jdGlvbihhLCBiLCBrLCBvKSB7XG4gICAgICAgIHJldHVybiB2YWxpZGF0ZShhLCBnZXR0ZXIoYiksIGssIG8pO1xuICAgICAgfVxuICAgIH07XG4gIH1cbiAgcmV0dXJuIHZhbGlkYXRvcjtcbn1cblxuLyoqXG4gKi9cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gc2lmdChxdWVyeSwgYXJyYXksIGdldHRlcikge1xuXG4gIGlmIChpc0Z1bmN0aW9uKGFycmF5KSkge1xuICAgIGdldHRlciA9IGFycmF5O1xuICAgIGFycmF5ICA9IHZvaWQgMDtcbiAgfVxuXG4gIHZhciB2YWxpZGF0b3IgPSBjcmVhdGVSb290VmFsaWRhdG9yKHF1ZXJ5LCBnZXR0ZXIpO1xuXG4gIGZ1bmN0aW9uIGZpbHRlcihiLCBrLCBvKSB7XG4gICAgcmV0dXJuIHZhbGlkYXRlKHZhbGlkYXRvciwgYiwgaywgbyk7XG4gIH1cblxuICBpZiAoYXJyYXkpIHtcbiAgICByZXR1cm4gYXJyYXkuZmlsdGVyKGZpbHRlcik7XG4gIH1cblxuICByZXR1cm4gZmlsdGVyO1xufVxuXG4vKipcbiAqL1xuXG5leHBvcnQgZnVuY3Rpb24gaW5kZXhPZihxdWVyeSwgYXJyYXksIGdldHRlcikge1xuICByZXR1cm4gc2VhcmNoKGFycmF5LCBjcmVhdGVSb290VmFsaWRhdG9yKHF1ZXJ5LCBnZXR0ZXIpKTtcbn07XG5cbi8qKlxuICovXG5cbmV4cG9ydCBmdW5jdGlvbiBjb21wYXJlKGEsIGIpIHtcbiAgaWYoYT09PWIpIHJldHVybiAwO1xuICBpZih0eXBlb2YgYSA9PT0gdHlwZW9mIGIpIHtcbiAgICBpZiAoYSA+IGIpIHtcbiAgICAgIHJldHVybiAxO1xuICAgIH1cbiAgICBpZiAoYSA8IGIpIHtcbiAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gIH1cbn07IiwiLyohICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbkNvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2VcclxudGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGVcclxuTGljZW5zZSBhdCBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuXHJcblRISVMgQ09ERSBJUyBQUk9WSURFRCBPTiBBTiAqQVMgSVMqIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcclxuS0lORCwgRUlUSEVSIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIFdJVEhPVVQgTElNSVRBVElPTiBBTlkgSU1QTElFRFxyXG5XQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgVElUTEUsIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLFxyXG5NRVJDSEFOVEFCTElUWSBPUiBOT04tSU5GUklOR0VNRU5ULlxyXG5cclxuU2VlIHRoZSBBcGFjaGUgVmVyc2lvbiAyLjAgTGljZW5zZSBmb3Igc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zXHJcbmFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogKi9cclxuLyogZ2xvYmFsIFJlZmxlY3QsIFByb21pc2UgKi9cclxuXHJcbnZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24oZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXh0ZW5kcyhkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbn1cclxuXHJcbmV4cG9ydCB2YXIgX19hc3NpZ24gPSBmdW5jdGlvbigpIHtcclxuICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiBfX2Fzc2lnbih0KSB7XHJcbiAgICAgICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHMgPSBhcmd1bWVudHNbaV07XHJcbiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSkgdFtwXSA9IHNbcF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIF9fYXNzaWduLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3Jlc3QocywgZSkge1xyXG4gICAgdmFyIHQgPSB7fTtcclxuICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSAmJiBlLmluZGV4T2YocCkgPCAwKVxyXG4gICAgICAgIHRbcF0gPSBzW3BdO1xyXG4gICAgaWYgKHMgIT0gbnVsbCAmJiB0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9PT0gXCJmdW5jdGlvblwiKVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBwID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzKTsgaSA8IHAubGVuZ3RoOyBpKyspIGlmIChlLmluZGV4T2YocFtpXSkgPCAwKVxyXG4gICAgICAgICAgICB0W3BbaV1dID0gc1twW2ldXTtcclxuICAgIHJldHVybiB0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xyXG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XHJcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xyXG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcGFyYW0ocGFyYW1JbmRleCwgZGVjb3JhdG9yKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCwga2V5KSB7IGRlY29yYXRvcih0YXJnZXQsIGtleSwgcGFyYW1JbmRleCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpIHtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gUmVmbGVjdC5tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0ZXIodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHJlc3VsdC52YWx1ZSk7IH0pLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZ2VuZXJhdG9yKHRoaXNBcmcsIGJvZHkpIHtcclxuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XHJcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xyXG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcclxuICAgICAgICB3aGlsZSAoXykgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0gb3BbMF0gJiAyID8geVtcInJldHVyblwiXSA6IG9wWzBdID8geVtcInRocm93XCJdIHx8ICgodCA9IHlbXCJyZXR1cm5cIl0pICYmIHQuY2FsbCh5KSwgMCkgOiB5Lm5leHQpICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xyXG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07XHJcbiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgMDogY2FzZSAxOiB0ID0gb3A7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA0OiBfLmxhYmVsKys7IHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNzogb3AgPSBfLm9wcy5wb3AoKTsgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSAzICYmICghdCB8fCAob3BbMV0gPiB0WzBdICYmIG9wWzFdIDwgdFszXSkpKSB7IF8ubGFiZWwgPSBvcFsxXTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDYgJiYgXy5sYWJlbCA8IHRbMV0pIHsgXy5sYWJlbCA9IHRbMV07IHQgPSBvcDsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRbMl0pIF8ub3BzLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgb3AgPSBib2R5LmNhbGwodGhpc0FyZywgXyk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkgeyBvcCA9IFs2LCBlXTsgeSA9IDA7IH0gZmluYWxseSB7IGYgPSB0ID0gMDsgfVxyXG4gICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHBvcnRTdGFyKG0sIGV4cG9ydHMpIHtcclxuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fdmFsdWVzKG8pIHtcclxuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXSwgaSA9IDA7XHJcbiAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwO1xyXG4gICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVhZChvLCBuKSB7XHJcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl07XHJcbiAgICBpZiAoIW0pIHJldHVybiBvO1xyXG4gICAgdmFyIGkgPSBtLmNhbGwobyksIHIsIGFyID0gW10sIGU7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHdoaWxlICgobiA9PT0gdm9pZCAwIHx8IG4tLSA+IDApICYmICEociA9IGkubmV4dCgpKS5kb25lKSBhci5wdXNoKHIudmFsdWUpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGVycm9yKSB7IGUgPSB7IGVycm9yOiBlcnJvciB9OyB9XHJcbiAgICBmaW5hbGx5IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpZiAociAmJiAhci5kb25lICYmIChtID0gaVtcInJldHVyblwiXSkpIG0uY2FsbChpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZmluYWxseSB7IGlmIChlKSB0aHJvdyBlLmVycm9yOyB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZCgpIHtcclxuICAgIGZvciAodmFyIGFyID0gW10sIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKVxyXG4gICAgICAgIGFyID0gYXIuY29uY2F0KF9fcmVhZChhcmd1bWVudHNbaV0pKTtcclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXQodikge1xyXG4gICAgcmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBfX2F3YWl0ID8gKHRoaXMudiA9IHYsIHRoaXMpIDogbmV3IF9fYXdhaXQodik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jR2VuZXJhdG9yKHRoaXNBcmcsIF9hcmd1bWVudHMsIGdlbmVyYXRvcikge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBnID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pLCBpLCBxID0gW107XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaWYgKGdbbl0pIGlbbl0gPSBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKGEsIGIpIHsgcS5wdXNoKFtuLCB2LCBhLCBiXSkgPiAxIHx8IHJlc3VtZShuLCB2KTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHJlc3VtZShuLCB2KSB7IHRyeSB7IHN0ZXAoZ1tuXSh2KSk7IH0gY2F0Y2ggKGUpIHsgc2V0dGxlKHFbMF1bM10sIGUpOyB9IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAocikgeyByLnZhbHVlIGluc3RhbmNlb2YgX19hd2FpdCA/IFByb21pc2UucmVzb2x2ZShyLnZhbHVlLnYpLnRoZW4oZnVsZmlsbCwgcmVqZWN0KSA6IHNldHRsZShxWzBdWzJdLCByKTsgfVxyXG4gICAgZnVuY3Rpb24gZnVsZmlsbCh2YWx1ZSkgeyByZXN1bWUoXCJuZXh0XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gcmVqZWN0KHZhbHVlKSB7IHJlc3VtZShcInRocm93XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKGYsIHYpIHsgaWYgKGYodiksIHEuc2hpZnQoKSwgcS5sZW5ndGgpIHJlc3VtZShxWzBdWzBdLCBxWzBdWzFdKTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0RlbGVnYXRvcihvKSB7XHJcbiAgICB2YXIgaSwgcDtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiwgZnVuY3Rpb24gKGUpIHsgdGhyb3cgZTsgfSksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4sIGYpIHsgaVtuXSA9IG9bbl0gPyBmdW5jdGlvbiAodikgeyByZXR1cm4gKHAgPSAhcCkgPyB7IHZhbHVlOiBfX2F3YWl0KG9bbl0odikpLCBkb25lOiBuID09PSBcInJldHVyblwiIH0gOiBmID8gZih2KSA6IHY7IH0gOiBmOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jVmFsdWVzKG8pIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgbSA9IG9bU3ltYm9sLmFzeW5jSXRlcmF0b3JdLCBpO1xyXG4gICAgcmV0dXJuIG0gPyBtLmNhbGwobykgOiAobyA9IHR5cGVvZiBfX3ZhbHVlcyA9PT0gXCJmdW5jdGlvblwiID8gX192YWx1ZXMobykgOiBvW1N5bWJvbC5pdGVyYXRvcl0oKSwgaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGkpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlbbl0gPSBvW25dICYmIGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHYgPSBvW25dKHYpLCBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCB2LmRvbmUsIHYudmFsdWUpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgZCwgdikgeyBQcm9taXNlLnJlc29sdmUodikudGhlbihmdW5jdGlvbih2KSB7IHJlc29sdmUoeyB2YWx1ZTogdiwgZG9uZTogZCB9KTsgfSwgcmVqZWN0KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tYWtlVGVtcGxhdGVPYmplY3QoY29va2VkLCByYXcpIHtcclxuICAgIGlmIChPYmplY3QuZGVmaW5lUHJvcGVydHkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNvb2tlZCwgXCJyYXdcIiwgeyB2YWx1ZTogcmF3IH0pOyB9IGVsc2UgeyBjb29rZWQucmF3ID0gcmF3OyB9XHJcbiAgICByZXR1cm4gY29va2VkO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0U3Rhcihtb2QpIHtcclxuICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XHJcbiAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSBpZiAoT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgcmVzdWx0W2tdID0gbW9kW2tdO1xyXG4gICAgcmVzdWx0LmRlZmF1bHQgPSBtb2Q7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnREZWZhdWx0KG1vZCkge1xyXG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBkZWZhdWx0OiBtb2QgfTtcclxufVxyXG4iLCIoZnVuY3Rpb24gKG5hbWUsIGNvbnRleHQsIGRlZmluaXRpb24pIHtcbiAgaWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnICYmIG1vZHVsZS5leHBvcnRzKSBtb2R1bGUuZXhwb3J0cyA9IGRlZmluaXRpb24oKTtcbiAgZWxzZSBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSBkZWZpbmUoZGVmaW5pdGlvbik7XG4gIGVsc2UgY29udGV4dFtuYW1lXSA9IGRlZmluaXRpb24oKTtcbn0pKCd1cmxqb2luJywgdGhpcywgZnVuY3Rpb24gKCkge1xuXG4gIGZ1bmN0aW9uIG5vcm1hbGl6ZSAoc3RyQXJyYXkpIHtcbiAgICB2YXIgcmVzdWx0QXJyYXkgPSBbXTtcblxuICAgIC8vIElmIHRoZSBmaXJzdCBwYXJ0IGlzIGEgcGxhaW4gcHJvdG9jb2wsIHdlIGNvbWJpbmUgaXQgd2l0aCB0aGUgbmV4dCBwYXJ0LlxuICAgIGlmIChzdHJBcnJheVswXS5tYXRjaCgvXlteLzpdKzpcXC8qJC8pICYmIHN0ckFycmF5Lmxlbmd0aCA+IDEpIHtcbiAgICAgIHZhciBmaXJzdCA9IHN0ckFycmF5LnNoaWZ0KCk7XG4gICAgICBzdHJBcnJheVswXSA9IGZpcnN0ICsgc3RyQXJyYXlbMF07XG4gICAgfVxuXG4gICAgLy8gVGhlcmUgbXVzdCBiZSB0d28gb3IgdGhyZWUgc2xhc2hlcyBpbiB0aGUgZmlsZSBwcm90b2NvbCwgdHdvIHNsYXNoZXMgaW4gYW55dGhpbmcgZWxzZS5cbiAgICBpZiAoc3RyQXJyYXlbMF0ubWF0Y2goL15maWxlOlxcL1xcL1xcLy8pKSB7XG4gICAgICBzdHJBcnJheVswXSA9IHN0ckFycmF5WzBdLnJlcGxhY2UoL14oW14vOl0rKTpcXC8qLywgJyQxOi8vLycpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzdHJBcnJheVswXSA9IHN0ckFycmF5WzBdLnJlcGxhY2UoL14oW14vOl0rKTpcXC8qLywgJyQxOi8vJyk7XG4gICAgfVxuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdHJBcnJheS5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIGNvbXBvbmVudCA9IHN0ckFycmF5W2ldO1xuXG4gICAgICBpZiAodHlwZW9mIGNvbXBvbmVudCAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignVXJsIG11c3QgYmUgYSBzdHJpbmcuIFJlY2VpdmVkICcgKyBjb21wb25lbnQpO1xuICAgICAgfVxuXG4gICAgICBpZiAoY29tcG9uZW50ID09PSAnJykgeyBjb250aW51ZTsgfVxuXG4gICAgICBpZiAoaSA+IDApIHtcbiAgICAgICAgLy8gUmVtb3ZpbmcgdGhlIHN0YXJ0aW5nIHNsYXNoZXMgZm9yIGVhY2ggY29tcG9uZW50IGJ1dCB0aGUgZmlyc3QuXG4gICAgICAgIGNvbXBvbmVudCA9IGNvbXBvbmVudC5yZXBsYWNlKC9eW1xcL10rLywgJycpO1xuICAgICAgfVxuICAgICAgaWYgKGkgPCBzdHJBcnJheS5sZW5ndGggLSAxKSB7XG4gICAgICAgIC8vIFJlbW92aW5nIHRoZSBlbmRpbmcgc2xhc2hlcyBmb3IgZWFjaCBjb21wb25lbnQgYnV0IHRoZSBsYXN0LlxuICAgICAgICBjb21wb25lbnQgPSBjb21wb25lbnQucmVwbGFjZSgvW1xcL10rJC8sICcnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIEZvciB0aGUgbGFzdCBjb21wb25lbnQgd2Ugd2lsbCBjb21iaW5lIG11bHRpcGxlIHNsYXNoZXMgdG8gYSBzaW5nbGUgb25lLlxuICAgICAgICBjb21wb25lbnQgPSBjb21wb25lbnQucmVwbGFjZSgvW1xcL10rJC8sICcvJyk7XG4gICAgICB9XG5cbiAgICAgIHJlc3VsdEFycmF5LnB1c2goY29tcG9uZW50KTtcblxuICAgIH1cblxuICAgIHZhciBzdHIgPSByZXN1bHRBcnJheS5qb2luKCcvJyk7XG4gICAgLy8gRWFjaCBpbnB1dCBjb21wb25lbnQgaXMgbm93IHNlcGFyYXRlZCBieSBhIHNpbmdsZSBzbGFzaCBleGNlcHQgdGhlIHBvc3NpYmxlIGZpcnN0IHBsYWluIHByb3RvY29sIHBhcnQuXG5cbiAgICAvLyByZW1vdmUgdHJhaWxpbmcgc2xhc2ggYmVmb3JlIHBhcmFtZXRlcnMgb3IgaGFzaFxuICAgIHN0ciA9IHN0ci5yZXBsYWNlKC9cXC8oXFw/fCZ8I1teIV0pL2csICckMScpO1xuXG4gICAgLy8gcmVwbGFjZSA/IGluIHBhcmFtZXRlcnMgd2l0aCAmXG4gICAgdmFyIHBhcnRzID0gc3RyLnNwbGl0KCc/Jyk7XG4gICAgc3RyID0gcGFydHMuc2hpZnQoKSArIChwYXJ0cy5sZW5ndGggPiAwID8gJz8nOiAnJykgKyBwYXJ0cy5qb2luKCcmJyk7XG5cbiAgICByZXR1cm4gc3RyO1xuICB9XG5cbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgaW5wdXQ7XG5cbiAgICBpZiAodHlwZW9mIGFyZ3VtZW50c1swXSA9PT0gJ29iamVjdCcpIHtcbiAgICAgIGlucHV0ID0gYXJndW1lbnRzWzBdO1xuICAgIH0gZWxzZSB7XG4gICAgICBpbnB1dCA9IFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzKTtcbiAgICB9XG5cbiAgICByZXR1cm4gbm9ybWFsaXplKGlucHV0KTtcbiAgfTtcblxufSk7XG4iLCIvLyBDb3B5cmlnaHQgSm95ZW50LCBJbmMuIGFuZCBvdGhlciBOb2RlIGNvbnRyaWJ1dG9ycy5cbi8vXG4vLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYVxuLy8gY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZVxuLy8gXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nXG4vLyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsXG4vLyBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0XG4vLyBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGVcbi8vIGZvbGxvd2luZyBjb25kaXRpb25zOlxuLy9cbi8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkXG4vLyBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbi8vXG4vLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTXG4vLyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GXG4vLyBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOXG4vLyBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSxcbi8vIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUlxuLy8gT1RIRVJXSVNFLCBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRVxuLy8gVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS5cblxuJ3VzZSBzdHJpY3QnO1xuXG52YXIgcHVueWNvZGUgPSByZXF1aXJlKCdwdW55Y29kZScpO1xudmFyIHV0aWwgPSByZXF1aXJlKCcuL3V0aWwnKTtcblxuZXhwb3J0cy5wYXJzZSA9IHVybFBhcnNlO1xuZXhwb3J0cy5yZXNvbHZlID0gdXJsUmVzb2x2ZTtcbmV4cG9ydHMucmVzb2x2ZU9iamVjdCA9IHVybFJlc29sdmVPYmplY3Q7XG5leHBvcnRzLmZvcm1hdCA9IHVybEZvcm1hdDtcblxuZXhwb3J0cy5VcmwgPSBVcmw7XG5cbmZ1bmN0aW9uIFVybCgpIHtcbiAgdGhpcy5wcm90b2NvbCA9IG51bGw7XG4gIHRoaXMuc2xhc2hlcyA9IG51bGw7XG4gIHRoaXMuYXV0aCA9IG51bGw7XG4gIHRoaXMuaG9zdCA9IG51bGw7XG4gIHRoaXMucG9ydCA9IG51bGw7XG4gIHRoaXMuaG9zdG5hbWUgPSBudWxsO1xuICB0aGlzLmhhc2ggPSBudWxsO1xuICB0aGlzLnNlYXJjaCA9IG51bGw7XG4gIHRoaXMucXVlcnkgPSBudWxsO1xuICB0aGlzLnBhdGhuYW1lID0gbnVsbDtcbiAgdGhpcy5wYXRoID0gbnVsbDtcbiAgdGhpcy5ocmVmID0gbnVsbDtcbn1cblxuLy8gUmVmZXJlbmNlOiBSRkMgMzk4NiwgUkZDIDE4MDgsIFJGQyAyMzk2XG5cbi8vIGRlZmluZSB0aGVzZSBoZXJlIHNvIGF0IGxlYXN0IHRoZXkgb25seSBoYXZlIHRvIGJlXG4vLyBjb21waWxlZCBvbmNlIG9uIHRoZSBmaXJzdCBtb2R1bGUgbG9hZC5cbnZhciBwcm90b2NvbFBhdHRlcm4gPSAvXihbYS16MC05ListXSs6KS9pLFxuICAgIHBvcnRQYXR0ZXJuID0gLzpbMC05XSokLyxcblxuICAgIC8vIFNwZWNpYWwgY2FzZSBmb3IgYSBzaW1wbGUgcGF0aCBVUkxcbiAgICBzaW1wbGVQYXRoUGF0dGVybiA9IC9eKFxcL1xcLz8oPyFcXC8pW15cXD9cXHNdKikoXFw/W15cXHNdKik/JC8sXG5cbiAgICAvLyBSRkMgMjM5NjogY2hhcmFjdGVycyByZXNlcnZlZCBmb3IgZGVsaW1pdGluZyBVUkxzLlxuICAgIC8vIFdlIGFjdHVhbGx5IGp1c3QgYXV0by1lc2NhcGUgdGhlc2UuXG4gICAgZGVsaW1zID0gWyc8JywgJz4nLCAnXCInLCAnYCcsICcgJywgJ1xccicsICdcXG4nLCAnXFx0J10sXG5cbiAgICAvLyBSRkMgMjM5NjogY2hhcmFjdGVycyBub3QgYWxsb3dlZCBmb3IgdmFyaW91cyByZWFzb25zLlxuICAgIHVud2lzZSA9IFsneycsICd9JywgJ3wnLCAnXFxcXCcsICdeJywgJ2AnXS5jb25jYXQoZGVsaW1zKSxcblxuICAgIC8vIEFsbG93ZWQgYnkgUkZDcywgYnV0IGNhdXNlIG9mIFhTUyBhdHRhY2tzLiAgQWx3YXlzIGVzY2FwZSB0aGVzZS5cbiAgICBhdXRvRXNjYXBlID0gWydcXCcnXS5jb25jYXQodW53aXNlKSxcbiAgICAvLyBDaGFyYWN0ZXJzIHRoYXQgYXJlIG5ldmVyIGV2ZXIgYWxsb3dlZCBpbiBhIGhvc3RuYW1lLlxuICAgIC8vIE5vdGUgdGhhdCBhbnkgaW52YWxpZCBjaGFycyBhcmUgYWxzbyBoYW5kbGVkLCBidXQgdGhlc2VcbiAgICAvLyBhcmUgdGhlIG9uZXMgdGhhdCBhcmUgKmV4cGVjdGVkKiB0byBiZSBzZWVuLCBzbyB3ZSBmYXN0LXBhdGhcbiAgICAvLyB0aGVtLlxuICAgIG5vbkhvc3RDaGFycyA9IFsnJScsICcvJywgJz8nLCAnOycsICcjJ10uY29uY2F0KGF1dG9Fc2NhcGUpLFxuICAgIGhvc3RFbmRpbmdDaGFycyA9IFsnLycsICc/JywgJyMnXSxcbiAgICBob3N0bmFtZU1heExlbiA9IDI1NSxcbiAgICBob3N0bmFtZVBhcnRQYXR0ZXJuID0gL15bK2EtejAtOUEtWl8tXXswLDYzfSQvLFxuICAgIGhvc3RuYW1lUGFydFN0YXJ0ID0gL14oWythLXowLTlBLVpfLV17MCw2M30pKC4qKSQvLFxuICAgIC8vIHByb3RvY29scyB0aGF0IGNhbiBhbGxvdyBcInVuc2FmZVwiIGFuZCBcInVud2lzZVwiIGNoYXJzLlxuICAgIHVuc2FmZVByb3RvY29sID0ge1xuICAgICAgJ2phdmFzY3JpcHQnOiB0cnVlLFxuICAgICAgJ2phdmFzY3JpcHQ6JzogdHJ1ZVxuICAgIH0sXG4gICAgLy8gcHJvdG9jb2xzIHRoYXQgbmV2ZXIgaGF2ZSBhIGhvc3RuYW1lLlxuICAgIGhvc3RsZXNzUHJvdG9jb2wgPSB7XG4gICAgICAnamF2YXNjcmlwdCc6IHRydWUsXG4gICAgICAnamF2YXNjcmlwdDonOiB0cnVlXG4gICAgfSxcbiAgICAvLyBwcm90b2NvbHMgdGhhdCBhbHdheXMgY29udGFpbiBhIC8vIGJpdC5cbiAgICBzbGFzaGVkUHJvdG9jb2wgPSB7XG4gICAgICAnaHR0cCc6IHRydWUsXG4gICAgICAnaHR0cHMnOiB0cnVlLFxuICAgICAgJ2Z0cCc6IHRydWUsXG4gICAgICAnZ29waGVyJzogdHJ1ZSxcbiAgICAgICdmaWxlJzogdHJ1ZSxcbiAgICAgICdodHRwOic6IHRydWUsXG4gICAgICAnaHR0cHM6JzogdHJ1ZSxcbiAgICAgICdmdHA6JzogdHJ1ZSxcbiAgICAgICdnb3BoZXI6JzogdHJ1ZSxcbiAgICAgICdmaWxlOic6IHRydWVcbiAgICB9LFxuICAgIHF1ZXJ5c3RyaW5nID0gcmVxdWlyZSgncXVlcnlzdHJpbmcnKTtcblxuZnVuY3Rpb24gdXJsUGFyc2UodXJsLCBwYXJzZVF1ZXJ5U3RyaW5nLCBzbGFzaGVzRGVub3RlSG9zdCkge1xuICBpZiAodXJsICYmIHV0aWwuaXNPYmplY3QodXJsKSAmJiB1cmwgaW5zdGFuY2VvZiBVcmwpIHJldHVybiB1cmw7XG5cbiAgdmFyIHUgPSBuZXcgVXJsO1xuICB1LnBhcnNlKHVybCwgcGFyc2VRdWVyeVN0cmluZywgc2xhc2hlc0Rlbm90ZUhvc3QpO1xuICByZXR1cm4gdTtcbn1cblxuVXJsLnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uKHVybCwgcGFyc2VRdWVyeVN0cmluZywgc2xhc2hlc0Rlbm90ZUhvc3QpIHtcbiAgaWYgKCF1dGlsLmlzU3RyaW5nKHVybCkpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiUGFyYW1ldGVyICd1cmwnIG11c3QgYmUgYSBzdHJpbmcsIG5vdCBcIiArIHR5cGVvZiB1cmwpO1xuICB9XG5cbiAgLy8gQ29weSBjaHJvbWUsIElFLCBvcGVyYSBiYWNrc2xhc2gtaGFuZGxpbmcgYmVoYXZpb3IuXG4gIC8vIEJhY2sgc2xhc2hlcyBiZWZvcmUgdGhlIHF1ZXJ5IHN0cmluZyBnZXQgY29udmVydGVkIHRvIGZvcndhcmQgc2xhc2hlc1xuICAvLyBTZWU6IGh0dHBzOi8vY29kZS5nb29nbGUuY29tL3AvY2hyb21pdW0vaXNzdWVzL2RldGFpbD9pZD0yNTkxNlxuICB2YXIgcXVlcnlJbmRleCA9IHVybC5pbmRleE9mKCc/JyksXG4gICAgICBzcGxpdHRlciA9XG4gICAgICAgICAgKHF1ZXJ5SW5kZXggIT09IC0xICYmIHF1ZXJ5SW5kZXggPCB1cmwuaW5kZXhPZignIycpKSA/ICc/JyA6ICcjJyxcbiAgICAgIHVTcGxpdCA9IHVybC5zcGxpdChzcGxpdHRlciksXG4gICAgICBzbGFzaFJlZ2V4ID0gL1xcXFwvZztcbiAgdVNwbGl0WzBdID0gdVNwbGl0WzBdLnJlcGxhY2Uoc2xhc2hSZWdleCwgJy8nKTtcbiAgdXJsID0gdVNwbGl0LmpvaW4oc3BsaXR0ZXIpO1xuXG4gIHZhciByZXN0ID0gdXJsO1xuXG4gIC8vIHRyaW0gYmVmb3JlIHByb2NlZWRpbmcuXG4gIC8vIFRoaXMgaXMgdG8gc3VwcG9ydCBwYXJzZSBzdHVmZiBsaWtlIFwiICBodHRwOi8vZm9vLmNvbSAgXFxuXCJcbiAgcmVzdCA9IHJlc3QudHJpbSgpO1xuXG4gIGlmICghc2xhc2hlc0Rlbm90ZUhvc3QgJiYgdXJsLnNwbGl0KCcjJykubGVuZ3RoID09PSAxKSB7XG4gICAgLy8gVHJ5IGZhc3QgcGF0aCByZWdleHBcbiAgICB2YXIgc2ltcGxlUGF0aCA9IHNpbXBsZVBhdGhQYXR0ZXJuLmV4ZWMocmVzdCk7XG4gICAgaWYgKHNpbXBsZVBhdGgpIHtcbiAgICAgIHRoaXMucGF0aCA9IHJlc3Q7XG4gICAgICB0aGlzLmhyZWYgPSByZXN0O1xuICAgICAgdGhpcy5wYXRobmFtZSA9IHNpbXBsZVBhdGhbMV07XG4gICAgICBpZiAoc2ltcGxlUGF0aFsyXSkge1xuICAgICAgICB0aGlzLnNlYXJjaCA9IHNpbXBsZVBhdGhbMl07XG4gICAgICAgIGlmIChwYXJzZVF1ZXJ5U3RyaW5nKSB7XG4gICAgICAgICAgdGhpcy5xdWVyeSA9IHF1ZXJ5c3RyaW5nLnBhcnNlKHRoaXMuc2VhcmNoLnN1YnN0cigxKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5xdWVyeSA9IHRoaXMuc2VhcmNoLnN1YnN0cigxKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChwYXJzZVF1ZXJ5U3RyaW5nKSB7XG4gICAgICAgIHRoaXMuc2VhcmNoID0gJyc7XG4gICAgICAgIHRoaXMucXVlcnkgPSB7fTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgfVxuXG4gIHZhciBwcm90byA9IHByb3RvY29sUGF0dGVybi5leGVjKHJlc3QpO1xuICBpZiAocHJvdG8pIHtcbiAgICBwcm90byA9IHByb3RvWzBdO1xuICAgIHZhciBsb3dlclByb3RvID0gcHJvdG8udG9Mb3dlckNhc2UoKTtcbiAgICB0aGlzLnByb3RvY29sID0gbG93ZXJQcm90bztcbiAgICByZXN0ID0gcmVzdC5zdWJzdHIocHJvdG8ubGVuZ3RoKTtcbiAgfVxuXG4gIC8vIGZpZ3VyZSBvdXQgaWYgaXQncyBnb3QgYSBob3N0XG4gIC8vIHVzZXJAc2VydmVyIGlzICphbHdheXMqIGludGVycHJldGVkIGFzIGEgaG9zdG5hbWUsIGFuZCB1cmxcbiAgLy8gcmVzb2x1dGlvbiB3aWxsIHRyZWF0IC8vZm9vL2JhciBhcyBob3N0PWZvbyxwYXRoPWJhciBiZWNhdXNlIHRoYXQnc1xuICAvLyBob3cgdGhlIGJyb3dzZXIgcmVzb2x2ZXMgcmVsYXRpdmUgVVJMcy5cbiAgaWYgKHNsYXNoZXNEZW5vdGVIb3N0IHx8IHByb3RvIHx8IHJlc3QubWF0Y2goL15cXC9cXC9bXkBcXC9dK0BbXkBcXC9dKy8pKSB7XG4gICAgdmFyIHNsYXNoZXMgPSByZXN0LnN1YnN0cigwLCAyKSA9PT0gJy8vJztcbiAgICBpZiAoc2xhc2hlcyAmJiAhKHByb3RvICYmIGhvc3RsZXNzUHJvdG9jb2xbcHJvdG9dKSkge1xuICAgICAgcmVzdCA9IHJlc3Quc3Vic3RyKDIpO1xuICAgICAgdGhpcy5zbGFzaGVzID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICBpZiAoIWhvc3RsZXNzUHJvdG9jb2xbcHJvdG9dICYmXG4gICAgICAoc2xhc2hlcyB8fCAocHJvdG8gJiYgIXNsYXNoZWRQcm90b2NvbFtwcm90b10pKSkge1xuXG4gICAgLy8gdGhlcmUncyBhIGhvc3RuYW1lLlxuICAgIC8vIHRoZSBmaXJzdCBpbnN0YW5jZSBvZiAvLCA/LCA7LCBvciAjIGVuZHMgdGhlIGhvc3QuXG4gICAgLy9cbiAgICAvLyBJZiB0aGVyZSBpcyBhbiBAIGluIHRoZSBob3N0bmFtZSwgdGhlbiBub24taG9zdCBjaGFycyAqYXJlKiBhbGxvd2VkXG4gICAgLy8gdG8gdGhlIGxlZnQgb2YgdGhlIGxhc3QgQCBzaWduLCB1bmxlc3Mgc29tZSBob3N0LWVuZGluZyBjaGFyYWN0ZXJcbiAgICAvLyBjb21lcyAqYmVmb3JlKiB0aGUgQC1zaWduLlxuICAgIC8vIFVSTHMgYXJlIG9ibm94aW91cy5cbiAgICAvL1xuICAgIC8vIGV4OlxuICAgIC8vIGh0dHA6Ly9hQGJAYy8gPT4gdXNlcjphQGIgaG9zdDpjXG4gICAgLy8gaHR0cDovL2FAYj9AYyA9PiB1c2VyOmEgaG9zdDpjIHBhdGg6Lz9AY1xuXG4gICAgLy8gdjAuMTIgVE9ETyhpc2FhY3MpOiBUaGlzIGlzIG5vdCBxdWl0ZSBob3cgQ2hyb21lIGRvZXMgdGhpbmdzLlxuICAgIC8vIFJldmlldyBvdXIgdGVzdCBjYXNlIGFnYWluc3QgYnJvd3NlcnMgbW9yZSBjb21wcmVoZW5zaXZlbHkuXG5cbiAgICAvLyBmaW5kIHRoZSBmaXJzdCBpbnN0YW5jZSBvZiBhbnkgaG9zdEVuZGluZ0NoYXJzXG4gICAgdmFyIGhvc3RFbmQgPSAtMTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGhvc3RFbmRpbmdDaGFycy5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIGhlYyA9IHJlc3QuaW5kZXhPZihob3N0RW5kaW5nQ2hhcnNbaV0pO1xuICAgICAgaWYgKGhlYyAhPT0gLTEgJiYgKGhvc3RFbmQgPT09IC0xIHx8IGhlYyA8IGhvc3RFbmQpKVxuICAgICAgICBob3N0RW5kID0gaGVjO1xuICAgIH1cblxuICAgIC8vIGF0IHRoaXMgcG9pbnQsIGVpdGhlciB3ZSBoYXZlIGFuIGV4cGxpY2l0IHBvaW50IHdoZXJlIHRoZVxuICAgIC8vIGF1dGggcG9ydGlvbiBjYW5ub3QgZ28gcGFzdCwgb3IgdGhlIGxhc3QgQCBjaGFyIGlzIHRoZSBkZWNpZGVyLlxuICAgIHZhciBhdXRoLCBhdFNpZ247XG4gICAgaWYgKGhvc3RFbmQgPT09IC0xKSB7XG4gICAgICAvLyBhdFNpZ24gY2FuIGJlIGFueXdoZXJlLlxuICAgICAgYXRTaWduID0gcmVzdC5sYXN0SW5kZXhPZignQCcpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBhdFNpZ24gbXVzdCBiZSBpbiBhdXRoIHBvcnRpb24uXG4gICAgICAvLyBodHRwOi8vYUBiL2NAZCA9PiBob3N0OmIgYXV0aDphIHBhdGg6L2NAZFxuICAgICAgYXRTaWduID0gcmVzdC5sYXN0SW5kZXhPZignQCcsIGhvc3RFbmQpO1xuICAgIH1cblxuICAgIC8vIE5vdyB3ZSBoYXZlIGEgcG9ydGlvbiB3aGljaCBpcyBkZWZpbml0ZWx5IHRoZSBhdXRoLlxuICAgIC8vIFB1bGwgdGhhdCBvZmYuXG4gICAgaWYgKGF0U2lnbiAhPT0gLTEpIHtcbiAgICAgIGF1dGggPSByZXN0LnNsaWNlKDAsIGF0U2lnbik7XG4gICAgICByZXN0ID0gcmVzdC5zbGljZShhdFNpZ24gKyAxKTtcbiAgICAgIHRoaXMuYXV0aCA9IGRlY29kZVVSSUNvbXBvbmVudChhdXRoKTtcbiAgICB9XG5cbiAgICAvLyB0aGUgaG9zdCBpcyB0aGUgcmVtYWluaW5nIHRvIHRoZSBsZWZ0IG9mIHRoZSBmaXJzdCBub24taG9zdCBjaGFyXG4gICAgaG9zdEVuZCA9IC0xO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9uSG9zdENoYXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgaGVjID0gcmVzdC5pbmRleE9mKG5vbkhvc3RDaGFyc1tpXSk7XG4gICAgICBpZiAoaGVjICE9PSAtMSAmJiAoaG9zdEVuZCA9PT0gLTEgfHwgaGVjIDwgaG9zdEVuZCkpXG4gICAgICAgIGhvc3RFbmQgPSBoZWM7XG4gICAgfVxuICAgIC8vIGlmIHdlIHN0aWxsIGhhdmUgbm90IGhpdCBpdCwgdGhlbiB0aGUgZW50aXJlIHRoaW5nIGlzIGEgaG9zdC5cbiAgICBpZiAoaG9zdEVuZCA9PT0gLTEpXG4gICAgICBob3N0RW5kID0gcmVzdC5sZW5ndGg7XG5cbiAgICB0aGlzLmhvc3QgPSByZXN0LnNsaWNlKDAsIGhvc3RFbmQpO1xuICAgIHJlc3QgPSByZXN0LnNsaWNlKGhvc3RFbmQpO1xuXG4gICAgLy8gcHVsbCBvdXQgcG9ydC5cbiAgICB0aGlzLnBhcnNlSG9zdCgpO1xuXG4gICAgLy8gd2UndmUgaW5kaWNhdGVkIHRoYXQgdGhlcmUgaXMgYSBob3N0bmFtZSxcbiAgICAvLyBzbyBldmVuIGlmIGl0J3MgZW1wdHksIGl0IGhhcyB0byBiZSBwcmVzZW50LlxuICAgIHRoaXMuaG9zdG5hbWUgPSB0aGlzLmhvc3RuYW1lIHx8ICcnO1xuXG4gICAgLy8gaWYgaG9zdG5hbWUgYmVnaW5zIHdpdGggWyBhbmQgZW5kcyB3aXRoIF1cbiAgICAvLyBhc3N1bWUgdGhhdCBpdCdzIGFuIElQdjYgYWRkcmVzcy5cbiAgICB2YXIgaXB2Nkhvc3RuYW1lID0gdGhpcy5ob3N0bmFtZVswXSA9PT0gJ1snICYmXG4gICAgICAgIHRoaXMuaG9zdG5hbWVbdGhpcy5ob3N0bmFtZS5sZW5ndGggLSAxXSA9PT0gJ10nO1xuXG4gICAgLy8gdmFsaWRhdGUgYSBsaXR0bGUuXG4gICAgaWYgKCFpcHY2SG9zdG5hbWUpIHtcbiAgICAgIHZhciBob3N0cGFydHMgPSB0aGlzLmhvc3RuYW1lLnNwbGl0KC9cXC4vKTtcbiAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gaG9zdHBhcnRzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICB2YXIgcGFydCA9IGhvc3RwYXJ0c1tpXTtcbiAgICAgICAgaWYgKCFwYXJ0KSBjb250aW51ZTtcbiAgICAgICAgaWYgKCFwYXJ0Lm1hdGNoKGhvc3RuYW1lUGFydFBhdHRlcm4pKSB7XG4gICAgICAgICAgdmFyIG5ld3BhcnQgPSAnJztcbiAgICAgICAgICBmb3IgKHZhciBqID0gMCwgayA9IHBhcnQubGVuZ3RoOyBqIDwgazsgaisrKSB7XG4gICAgICAgICAgICBpZiAocGFydC5jaGFyQ29kZUF0KGopID4gMTI3KSB7XG4gICAgICAgICAgICAgIC8vIHdlIHJlcGxhY2Ugbm9uLUFTQ0lJIGNoYXIgd2l0aCBhIHRlbXBvcmFyeSBwbGFjZWhvbGRlclxuICAgICAgICAgICAgICAvLyB3ZSBuZWVkIHRoaXMgdG8gbWFrZSBzdXJlIHNpemUgb2YgaG9zdG5hbWUgaXMgbm90XG4gICAgICAgICAgICAgIC8vIGJyb2tlbiBieSByZXBsYWNpbmcgbm9uLUFTQ0lJIGJ5IG5vdGhpbmdcbiAgICAgICAgICAgICAgbmV3cGFydCArPSAneCc7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBuZXdwYXJ0ICs9IHBhcnRbal07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIC8vIHdlIHRlc3QgYWdhaW4gd2l0aCBBU0NJSSBjaGFyIG9ubHlcbiAgICAgICAgICBpZiAoIW5ld3BhcnQubWF0Y2goaG9zdG5hbWVQYXJ0UGF0dGVybikpIHtcbiAgICAgICAgICAgIHZhciB2YWxpZFBhcnRzID0gaG9zdHBhcnRzLnNsaWNlKDAsIGkpO1xuICAgICAgICAgICAgdmFyIG5vdEhvc3QgPSBob3N0cGFydHMuc2xpY2UoaSArIDEpO1xuICAgICAgICAgICAgdmFyIGJpdCA9IHBhcnQubWF0Y2goaG9zdG5hbWVQYXJ0U3RhcnQpO1xuICAgICAgICAgICAgaWYgKGJpdCkge1xuICAgICAgICAgICAgICB2YWxpZFBhcnRzLnB1c2goYml0WzFdKTtcbiAgICAgICAgICAgICAgbm90SG9zdC51bnNoaWZ0KGJpdFsyXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobm90SG9zdC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgcmVzdCA9ICcvJyArIG5vdEhvc3Quam9pbignLicpICsgcmVzdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuaG9zdG5hbWUgPSB2YWxpZFBhcnRzLmpvaW4oJy4nKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh0aGlzLmhvc3RuYW1lLmxlbmd0aCA+IGhvc3RuYW1lTWF4TGVuKSB7XG4gICAgICB0aGlzLmhvc3RuYW1lID0gJyc7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIGhvc3RuYW1lcyBhcmUgYWx3YXlzIGxvd2VyIGNhc2UuXG4gICAgICB0aGlzLmhvc3RuYW1lID0gdGhpcy5ob3N0bmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgIH1cblxuICAgIGlmICghaXB2Nkhvc3RuYW1lKSB7XG4gICAgICAvLyBJRE5BIFN1cHBvcnQ6IFJldHVybnMgYSBwdW55Y29kZWQgcmVwcmVzZW50YXRpb24gb2YgXCJkb21haW5cIi5cbiAgICAgIC8vIEl0IG9ubHkgY29udmVydHMgcGFydHMgb2YgdGhlIGRvbWFpbiBuYW1lIHRoYXRcbiAgICAgIC8vIGhhdmUgbm9uLUFTQ0lJIGNoYXJhY3RlcnMsIGkuZS4gaXQgZG9lc24ndCBtYXR0ZXIgaWZcbiAgICAgIC8vIHlvdSBjYWxsIGl0IHdpdGggYSBkb21haW4gdGhhdCBhbHJlYWR5IGlzIEFTQ0lJLW9ubHkuXG4gICAgICB0aGlzLmhvc3RuYW1lID0gcHVueWNvZGUudG9BU0NJSSh0aGlzLmhvc3RuYW1lKTtcbiAgICB9XG5cbiAgICB2YXIgcCA9IHRoaXMucG9ydCA/ICc6JyArIHRoaXMucG9ydCA6ICcnO1xuICAgIHZhciBoID0gdGhpcy5ob3N0bmFtZSB8fCAnJztcbiAgICB0aGlzLmhvc3QgPSBoICsgcDtcbiAgICB0aGlzLmhyZWYgKz0gdGhpcy5ob3N0O1xuXG4gICAgLy8gc3RyaXAgWyBhbmQgXSBmcm9tIHRoZSBob3N0bmFtZVxuICAgIC8vIHRoZSBob3N0IGZpZWxkIHN0aWxsIHJldGFpbnMgdGhlbSwgdGhvdWdoXG4gICAgaWYgKGlwdjZIb3N0bmFtZSkge1xuICAgICAgdGhpcy5ob3N0bmFtZSA9IHRoaXMuaG9zdG5hbWUuc3Vic3RyKDEsIHRoaXMuaG9zdG5hbWUubGVuZ3RoIC0gMik7XG4gICAgICBpZiAocmVzdFswXSAhPT0gJy8nKSB7XG4gICAgICAgIHJlc3QgPSAnLycgKyByZXN0O1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vIG5vdyByZXN0IGlzIHNldCB0byB0aGUgcG9zdC1ob3N0IHN0dWZmLlxuICAvLyBjaG9wIG9mZiBhbnkgZGVsaW0gY2hhcnMuXG4gIGlmICghdW5zYWZlUHJvdG9jb2xbbG93ZXJQcm90b10pIHtcblxuICAgIC8vIEZpcnN0LCBtYWtlIDEwMCUgc3VyZSB0aGF0IGFueSBcImF1dG9Fc2NhcGVcIiBjaGFycyBnZXRcbiAgICAvLyBlc2NhcGVkLCBldmVuIGlmIGVuY29kZVVSSUNvbXBvbmVudCBkb2Vzbid0IHRoaW5rIHRoZXlcbiAgICAvLyBuZWVkIHRvIGJlLlxuICAgIGZvciAodmFyIGkgPSAwLCBsID0gYXV0b0VzY2FwZS5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgIHZhciBhZSA9IGF1dG9Fc2NhcGVbaV07XG4gICAgICBpZiAocmVzdC5pbmRleE9mKGFlKSA9PT0gLTEpXG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgdmFyIGVzYyA9IGVuY29kZVVSSUNvbXBvbmVudChhZSk7XG4gICAgICBpZiAoZXNjID09PSBhZSkge1xuICAgICAgICBlc2MgPSBlc2NhcGUoYWUpO1xuICAgICAgfVxuICAgICAgcmVzdCA9IHJlc3Quc3BsaXQoYWUpLmpvaW4oZXNjKTtcbiAgICB9XG4gIH1cblxuXG4gIC8vIGNob3Agb2ZmIGZyb20gdGhlIHRhaWwgZmlyc3QuXG4gIHZhciBoYXNoID0gcmVzdC5pbmRleE9mKCcjJyk7XG4gIGlmIChoYXNoICE9PSAtMSkge1xuICAgIC8vIGdvdCBhIGZyYWdtZW50IHN0cmluZy5cbiAgICB0aGlzLmhhc2ggPSByZXN0LnN1YnN0cihoYXNoKTtcbiAgICByZXN0ID0gcmVzdC5zbGljZSgwLCBoYXNoKTtcbiAgfVxuICB2YXIgcW0gPSByZXN0LmluZGV4T2YoJz8nKTtcbiAgaWYgKHFtICE9PSAtMSkge1xuICAgIHRoaXMuc2VhcmNoID0gcmVzdC5zdWJzdHIocW0pO1xuICAgIHRoaXMucXVlcnkgPSByZXN0LnN1YnN0cihxbSArIDEpO1xuICAgIGlmIChwYXJzZVF1ZXJ5U3RyaW5nKSB7XG4gICAgICB0aGlzLnF1ZXJ5ID0gcXVlcnlzdHJpbmcucGFyc2UodGhpcy5xdWVyeSk7XG4gICAgfVxuICAgIHJlc3QgPSByZXN0LnNsaWNlKDAsIHFtKTtcbiAgfSBlbHNlIGlmIChwYXJzZVF1ZXJ5U3RyaW5nKSB7XG4gICAgLy8gbm8gcXVlcnkgc3RyaW5nLCBidXQgcGFyc2VRdWVyeVN0cmluZyBzdGlsbCByZXF1ZXN0ZWRcbiAgICB0aGlzLnNlYXJjaCA9ICcnO1xuICAgIHRoaXMucXVlcnkgPSB7fTtcbiAgfVxuICBpZiAocmVzdCkgdGhpcy5wYXRobmFtZSA9IHJlc3Q7XG4gIGlmIChzbGFzaGVkUHJvdG9jb2xbbG93ZXJQcm90b10gJiZcbiAgICAgIHRoaXMuaG9zdG5hbWUgJiYgIXRoaXMucGF0aG5hbWUpIHtcbiAgICB0aGlzLnBhdGhuYW1lID0gJy8nO1xuICB9XG5cbiAgLy90byBzdXBwb3J0IGh0dHAucmVxdWVzdFxuICBpZiAodGhpcy5wYXRobmFtZSB8fCB0aGlzLnNlYXJjaCkge1xuICAgIHZhciBwID0gdGhpcy5wYXRobmFtZSB8fCAnJztcbiAgICB2YXIgcyA9IHRoaXMuc2VhcmNoIHx8ICcnO1xuICAgIHRoaXMucGF0aCA9IHAgKyBzO1xuICB9XG5cbiAgLy8gZmluYWxseSwgcmVjb25zdHJ1Y3QgdGhlIGhyZWYgYmFzZWQgb24gd2hhdCBoYXMgYmVlbiB2YWxpZGF0ZWQuXG4gIHRoaXMuaHJlZiA9IHRoaXMuZm9ybWF0KCk7XG4gIHJldHVybiB0aGlzO1xufTtcblxuLy8gZm9ybWF0IGEgcGFyc2VkIG9iamVjdCBpbnRvIGEgdXJsIHN0cmluZ1xuZnVuY3Rpb24gdXJsRm9ybWF0KG9iaikge1xuICAvLyBlbnN1cmUgaXQncyBhbiBvYmplY3QsIGFuZCBub3QgYSBzdHJpbmcgdXJsLlxuICAvLyBJZiBpdCdzIGFuIG9iaiwgdGhpcyBpcyBhIG5vLW9wLlxuICAvLyB0aGlzIHdheSwgeW91IGNhbiBjYWxsIHVybF9mb3JtYXQoKSBvbiBzdHJpbmdzXG4gIC8vIHRvIGNsZWFuIHVwIHBvdGVudGlhbGx5IHdvbmt5IHVybHMuXG4gIGlmICh1dGlsLmlzU3RyaW5nKG9iaikpIG9iaiA9IHVybFBhcnNlKG9iaik7XG4gIGlmICghKG9iaiBpbnN0YW5jZW9mIFVybCkpIHJldHVybiBVcmwucHJvdG90eXBlLmZvcm1hdC5jYWxsKG9iaik7XG4gIHJldHVybiBvYmouZm9ybWF0KCk7XG59XG5cblVybC5wcm90b3R5cGUuZm9ybWF0ID0gZnVuY3Rpb24oKSB7XG4gIHZhciBhdXRoID0gdGhpcy5hdXRoIHx8ICcnO1xuICBpZiAoYXV0aCkge1xuICAgIGF1dGggPSBlbmNvZGVVUklDb21wb25lbnQoYXV0aCk7XG4gICAgYXV0aCA9IGF1dGgucmVwbGFjZSgvJTNBL2ksICc6Jyk7XG4gICAgYXV0aCArPSAnQCc7XG4gIH1cblxuICB2YXIgcHJvdG9jb2wgPSB0aGlzLnByb3RvY29sIHx8ICcnLFxuICAgICAgcGF0aG5hbWUgPSB0aGlzLnBhdGhuYW1lIHx8ICcnLFxuICAgICAgaGFzaCA9IHRoaXMuaGFzaCB8fCAnJyxcbiAgICAgIGhvc3QgPSBmYWxzZSxcbiAgICAgIHF1ZXJ5ID0gJyc7XG5cbiAgaWYgKHRoaXMuaG9zdCkge1xuICAgIGhvc3QgPSBhdXRoICsgdGhpcy5ob3N0O1xuICB9IGVsc2UgaWYgKHRoaXMuaG9zdG5hbWUpIHtcbiAgICBob3N0ID0gYXV0aCArICh0aGlzLmhvc3RuYW1lLmluZGV4T2YoJzonKSA9PT0gLTEgP1xuICAgICAgICB0aGlzLmhvc3RuYW1lIDpcbiAgICAgICAgJ1snICsgdGhpcy5ob3N0bmFtZSArICddJyk7XG4gICAgaWYgKHRoaXMucG9ydCkge1xuICAgICAgaG9zdCArPSAnOicgKyB0aGlzLnBvcnQ7XG4gICAgfVxuICB9XG5cbiAgaWYgKHRoaXMucXVlcnkgJiZcbiAgICAgIHV0aWwuaXNPYmplY3QodGhpcy5xdWVyeSkgJiZcbiAgICAgIE9iamVjdC5rZXlzKHRoaXMucXVlcnkpLmxlbmd0aCkge1xuICAgIHF1ZXJ5ID0gcXVlcnlzdHJpbmcuc3RyaW5naWZ5KHRoaXMucXVlcnkpO1xuICB9XG5cbiAgdmFyIHNlYXJjaCA9IHRoaXMuc2VhcmNoIHx8IChxdWVyeSAmJiAoJz8nICsgcXVlcnkpKSB8fCAnJztcblxuICBpZiAocHJvdG9jb2wgJiYgcHJvdG9jb2wuc3Vic3RyKC0xKSAhPT0gJzonKSBwcm90b2NvbCArPSAnOic7XG5cbiAgLy8gb25seSB0aGUgc2xhc2hlZFByb3RvY29scyBnZXQgdGhlIC8vLiAgTm90IG1haWx0bzosIHhtcHA6LCBldGMuXG4gIC8vIHVubGVzcyB0aGV5IGhhZCB0aGVtIHRvIGJlZ2luIHdpdGguXG4gIGlmICh0aGlzLnNsYXNoZXMgfHxcbiAgICAgICghcHJvdG9jb2wgfHwgc2xhc2hlZFByb3RvY29sW3Byb3RvY29sXSkgJiYgaG9zdCAhPT0gZmFsc2UpIHtcbiAgICBob3N0ID0gJy8vJyArIChob3N0IHx8ICcnKTtcbiAgICBpZiAocGF0aG5hbWUgJiYgcGF0aG5hbWUuY2hhckF0KDApICE9PSAnLycpIHBhdGhuYW1lID0gJy8nICsgcGF0aG5hbWU7XG4gIH0gZWxzZSBpZiAoIWhvc3QpIHtcbiAgICBob3N0ID0gJyc7XG4gIH1cblxuICBpZiAoaGFzaCAmJiBoYXNoLmNoYXJBdCgwKSAhPT0gJyMnKSBoYXNoID0gJyMnICsgaGFzaDtcbiAgaWYgKHNlYXJjaCAmJiBzZWFyY2guY2hhckF0KDApICE9PSAnPycpIHNlYXJjaCA9ICc/JyArIHNlYXJjaDtcblxuICBwYXRobmFtZSA9IHBhdGhuYW1lLnJlcGxhY2UoL1s/I10vZywgZnVuY3Rpb24obWF0Y2gpIHtcbiAgICByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KG1hdGNoKTtcbiAgfSk7XG4gIHNlYXJjaCA9IHNlYXJjaC5yZXBsYWNlKCcjJywgJyUyMycpO1xuXG4gIHJldHVybiBwcm90b2NvbCArIGhvc3QgKyBwYXRobmFtZSArIHNlYXJjaCArIGhhc2g7XG59O1xuXG5mdW5jdGlvbiB1cmxSZXNvbHZlKHNvdXJjZSwgcmVsYXRpdmUpIHtcbiAgcmV0dXJuIHVybFBhcnNlKHNvdXJjZSwgZmFsc2UsIHRydWUpLnJlc29sdmUocmVsYXRpdmUpO1xufVxuXG5VcmwucHJvdG90eXBlLnJlc29sdmUgPSBmdW5jdGlvbihyZWxhdGl2ZSkge1xuICByZXR1cm4gdGhpcy5yZXNvbHZlT2JqZWN0KHVybFBhcnNlKHJlbGF0aXZlLCBmYWxzZSwgdHJ1ZSkpLmZvcm1hdCgpO1xufTtcblxuZnVuY3Rpb24gdXJsUmVzb2x2ZU9iamVjdChzb3VyY2UsIHJlbGF0aXZlKSB7XG4gIGlmICghc291cmNlKSByZXR1cm4gcmVsYXRpdmU7XG4gIHJldHVybiB1cmxQYXJzZShzb3VyY2UsIGZhbHNlLCB0cnVlKS5yZXNvbHZlT2JqZWN0KHJlbGF0aXZlKTtcbn1cblxuVXJsLnByb3RvdHlwZS5yZXNvbHZlT2JqZWN0ID0gZnVuY3Rpb24ocmVsYXRpdmUpIHtcbiAgaWYgKHV0aWwuaXNTdHJpbmcocmVsYXRpdmUpKSB7XG4gICAgdmFyIHJlbCA9IG5ldyBVcmwoKTtcbiAgICByZWwucGFyc2UocmVsYXRpdmUsIGZhbHNlLCB0cnVlKTtcbiAgICByZWxhdGl2ZSA9IHJlbDtcbiAgfVxuXG4gIHZhciByZXN1bHQgPSBuZXcgVXJsKCk7XG4gIHZhciB0a2V5cyA9IE9iamVjdC5rZXlzKHRoaXMpO1xuICBmb3IgKHZhciB0ayA9IDA7IHRrIDwgdGtleXMubGVuZ3RoOyB0aysrKSB7XG4gICAgdmFyIHRrZXkgPSB0a2V5c1t0a107XG4gICAgcmVzdWx0W3RrZXldID0gdGhpc1t0a2V5XTtcbiAgfVxuXG4gIC8vIGhhc2ggaXMgYWx3YXlzIG92ZXJyaWRkZW4sIG5vIG1hdHRlciB3aGF0LlxuICAvLyBldmVuIGhyZWY9XCJcIiB3aWxsIHJlbW92ZSBpdC5cbiAgcmVzdWx0Lmhhc2ggPSByZWxhdGl2ZS5oYXNoO1xuXG4gIC8vIGlmIHRoZSByZWxhdGl2ZSB1cmwgaXMgZW1wdHksIHRoZW4gdGhlcmUncyBub3RoaW5nIGxlZnQgdG8gZG8gaGVyZS5cbiAgaWYgKHJlbGF0aXZlLmhyZWYgPT09ICcnKSB7XG4gICAgcmVzdWx0LmhyZWYgPSByZXN1bHQuZm9ybWF0KCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIC8vIGhyZWZzIGxpa2UgLy9mb28vYmFyIGFsd2F5cyBjdXQgdG8gdGhlIHByb3RvY29sLlxuICBpZiAocmVsYXRpdmUuc2xhc2hlcyAmJiAhcmVsYXRpdmUucHJvdG9jb2wpIHtcbiAgICAvLyB0YWtlIGV2ZXJ5dGhpbmcgZXhjZXB0IHRoZSBwcm90b2NvbCBmcm9tIHJlbGF0aXZlXG4gICAgdmFyIHJrZXlzID0gT2JqZWN0LmtleXMocmVsYXRpdmUpO1xuICAgIGZvciAodmFyIHJrID0gMDsgcmsgPCBya2V5cy5sZW5ndGg7IHJrKyspIHtcbiAgICAgIHZhciBya2V5ID0gcmtleXNbcmtdO1xuICAgICAgaWYgKHJrZXkgIT09ICdwcm90b2NvbCcpXG4gICAgICAgIHJlc3VsdFtya2V5XSA9IHJlbGF0aXZlW3JrZXldO1xuICAgIH1cblxuICAgIC8vdXJsUGFyc2UgYXBwZW5kcyB0cmFpbGluZyAvIHRvIHVybHMgbGlrZSBodHRwOi8vd3d3LmV4YW1wbGUuY29tXG4gICAgaWYgKHNsYXNoZWRQcm90b2NvbFtyZXN1bHQucHJvdG9jb2xdICYmXG4gICAgICAgIHJlc3VsdC5ob3N0bmFtZSAmJiAhcmVzdWx0LnBhdGhuYW1lKSB7XG4gICAgICByZXN1bHQucGF0aCA9IHJlc3VsdC5wYXRobmFtZSA9ICcvJztcbiAgICB9XG5cbiAgICByZXN1bHQuaHJlZiA9IHJlc3VsdC5mb3JtYXQoKTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgaWYgKHJlbGF0aXZlLnByb3RvY29sICYmIHJlbGF0aXZlLnByb3RvY29sICE9PSByZXN1bHQucHJvdG9jb2wpIHtcbiAgICAvLyBpZiBpdCdzIGEga25vd24gdXJsIHByb3RvY29sLCB0aGVuIGNoYW5naW5nXG4gICAgLy8gdGhlIHByb3RvY29sIGRvZXMgd2VpcmQgdGhpbmdzXG4gICAgLy8gZmlyc3QsIGlmIGl0J3Mgbm90IGZpbGU6LCB0aGVuIHdlIE1VU1QgaGF2ZSBhIGhvc3QsXG4gICAgLy8gYW5kIGlmIHRoZXJlIHdhcyBhIHBhdGhcbiAgICAvLyB0byBiZWdpbiB3aXRoLCB0aGVuIHdlIE1VU1QgaGF2ZSBhIHBhdGguXG4gICAgLy8gaWYgaXQgaXMgZmlsZTosIHRoZW4gdGhlIGhvc3QgaXMgZHJvcHBlZCxcbiAgICAvLyBiZWNhdXNlIHRoYXQncyBrbm93biB0byBiZSBob3N0bGVzcy5cbiAgICAvLyBhbnl0aGluZyBlbHNlIGlzIGFzc3VtZWQgdG8gYmUgYWJzb2x1dGUuXG4gICAgaWYgKCFzbGFzaGVkUHJvdG9jb2xbcmVsYXRpdmUucHJvdG9jb2xdKSB7XG4gICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKHJlbGF0aXZlKTtcbiAgICAgIGZvciAodmFyIHYgPSAwOyB2IDwga2V5cy5sZW5ndGg7IHYrKykge1xuICAgICAgICB2YXIgayA9IGtleXNbdl07XG4gICAgICAgIHJlc3VsdFtrXSA9IHJlbGF0aXZlW2tdO1xuICAgICAgfVxuICAgICAgcmVzdWx0LmhyZWYgPSByZXN1bHQuZm9ybWF0KCk7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cblxuICAgIHJlc3VsdC5wcm90b2NvbCA9IHJlbGF0aXZlLnByb3RvY29sO1xuICAgIGlmICghcmVsYXRpdmUuaG9zdCAmJiAhaG9zdGxlc3NQcm90b2NvbFtyZWxhdGl2ZS5wcm90b2NvbF0pIHtcbiAgICAgIHZhciByZWxQYXRoID0gKHJlbGF0aXZlLnBhdGhuYW1lIHx8ICcnKS5zcGxpdCgnLycpO1xuICAgICAgd2hpbGUgKHJlbFBhdGgubGVuZ3RoICYmICEocmVsYXRpdmUuaG9zdCA9IHJlbFBhdGguc2hpZnQoKSkpO1xuICAgICAgaWYgKCFyZWxhdGl2ZS5ob3N0KSByZWxhdGl2ZS5ob3N0ID0gJyc7XG4gICAgICBpZiAoIXJlbGF0aXZlLmhvc3RuYW1lKSByZWxhdGl2ZS5ob3N0bmFtZSA9ICcnO1xuICAgICAgaWYgKHJlbFBhdGhbMF0gIT09ICcnKSByZWxQYXRoLnVuc2hpZnQoJycpO1xuICAgICAgaWYgKHJlbFBhdGgubGVuZ3RoIDwgMikgcmVsUGF0aC51bnNoaWZ0KCcnKTtcbiAgICAgIHJlc3VsdC5wYXRobmFtZSA9IHJlbFBhdGguam9pbignLycpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXN1bHQucGF0aG5hbWUgPSByZWxhdGl2ZS5wYXRobmFtZTtcbiAgICB9XG4gICAgcmVzdWx0LnNlYXJjaCA9IHJlbGF0aXZlLnNlYXJjaDtcbiAgICByZXN1bHQucXVlcnkgPSByZWxhdGl2ZS5xdWVyeTtcbiAgICByZXN1bHQuaG9zdCA9IHJlbGF0aXZlLmhvc3QgfHwgJyc7XG4gICAgcmVzdWx0LmF1dGggPSByZWxhdGl2ZS5hdXRoO1xuICAgIHJlc3VsdC5ob3N0bmFtZSA9IHJlbGF0aXZlLmhvc3RuYW1lIHx8IHJlbGF0aXZlLmhvc3Q7XG4gICAgcmVzdWx0LnBvcnQgPSByZWxhdGl2ZS5wb3J0O1xuICAgIC8vIHRvIHN1cHBvcnQgaHR0cC5yZXF1ZXN0XG4gICAgaWYgKHJlc3VsdC5wYXRobmFtZSB8fCByZXN1bHQuc2VhcmNoKSB7XG4gICAgICB2YXIgcCA9IHJlc3VsdC5wYXRobmFtZSB8fCAnJztcbiAgICAgIHZhciBzID0gcmVzdWx0LnNlYXJjaCB8fCAnJztcbiAgICAgIHJlc3VsdC5wYXRoID0gcCArIHM7XG4gICAgfVxuICAgIHJlc3VsdC5zbGFzaGVzID0gcmVzdWx0LnNsYXNoZXMgfHwgcmVsYXRpdmUuc2xhc2hlcztcbiAgICByZXN1bHQuaHJlZiA9IHJlc3VsdC5mb3JtYXQoKTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgdmFyIGlzU291cmNlQWJzID0gKHJlc3VsdC5wYXRobmFtZSAmJiByZXN1bHQucGF0aG5hbWUuY2hhckF0KDApID09PSAnLycpLFxuICAgICAgaXNSZWxBYnMgPSAoXG4gICAgICAgICAgcmVsYXRpdmUuaG9zdCB8fFxuICAgICAgICAgIHJlbGF0aXZlLnBhdGhuYW1lICYmIHJlbGF0aXZlLnBhdGhuYW1lLmNoYXJBdCgwKSA9PT0gJy8nXG4gICAgICApLFxuICAgICAgbXVzdEVuZEFicyA9IChpc1JlbEFicyB8fCBpc1NvdXJjZUFicyB8fFxuICAgICAgICAgICAgICAgICAgICAocmVzdWx0Lmhvc3QgJiYgcmVsYXRpdmUucGF0aG5hbWUpKSxcbiAgICAgIHJlbW92ZUFsbERvdHMgPSBtdXN0RW5kQWJzLFxuICAgICAgc3JjUGF0aCA9IHJlc3VsdC5wYXRobmFtZSAmJiByZXN1bHQucGF0aG5hbWUuc3BsaXQoJy8nKSB8fCBbXSxcbiAgICAgIHJlbFBhdGggPSByZWxhdGl2ZS5wYXRobmFtZSAmJiByZWxhdGl2ZS5wYXRobmFtZS5zcGxpdCgnLycpIHx8IFtdLFxuICAgICAgcHN5Y2hvdGljID0gcmVzdWx0LnByb3RvY29sICYmICFzbGFzaGVkUHJvdG9jb2xbcmVzdWx0LnByb3RvY29sXTtcblxuICAvLyBpZiB0aGUgdXJsIGlzIGEgbm9uLXNsYXNoZWQgdXJsLCB0aGVuIHJlbGF0aXZlXG4gIC8vIGxpbmtzIGxpa2UgLi4vLi4gc2hvdWxkIGJlIGFibGVcbiAgLy8gdG8gY3Jhd2wgdXAgdG8gdGhlIGhvc3RuYW1lLCBhcyB3ZWxsLiAgVGhpcyBpcyBzdHJhbmdlLlxuICAvLyByZXN1bHQucHJvdG9jb2wgaGFzIGFscmVhZHkgYmVlbiBzZXQgYnkgbm93LlxuICAvLyBMYXRlciBvbiwgcHV0IHRoZSBmaXJzdCBwYXRoIHBhcnQgaW50byB0aGUgaG9zdCBmaWVsZC5cbiAgaWYgKHBzeWNob3RpYykge1xuICAgIHJlc3VsdC5ob3N0bmFtZSA9ICcnO1xuICAgIHJlc3VsdC5wb3J0ID0gbnVsbDtcbiAgICBpZiAocmVzdWx0Lmhvc3QpIHtcbiAgICAgIGlmIChzcmNQYXRoWzBdID09PSAnJykgc3JjUGF0aFswXSA9IHJlc3VsdC5ob3N0O1xuICAgICAgZWxzZSBzcmNQYXRoLnVuc2hpZnQocmVzdWx0Lmhvc3QpO1xuICAgIH1cbiAgICByZXN1bHQuaG9zdCA9ICcnO1xuICAgIGlmIChyZWxhdGl2ZS5wcm90b2NvbCkge1xuICAgICAgcmVsYXRpdmUuaG9zdG5hbWUgPSBudWxsO1xuICAgICAgcmVsYXRpdmUucG9ydCA9IG51bGw7XG4gICAgICBpZiAocmVsYXRpdmUuaG9zdCkge1xuICAgICAgICBpZiAocmVsUGF0aFswXSA9PT0gJycpIHJlbFBhdGhbMF0gPSByZWxhdGl2ZS5ob3N0O1xuICAgICAgICBlbHNlIHJlbFBhdGgudW5zaGlmdChyZWxhdGl2ZS5ob3N0KTtcbiAgICAgIH1cbiAgICAgIHJlbGF0aXZlLmhvc3QgPSBudWxsO1xuICAgIH1cbiAgICBtdXN0RW5kQWJzID0gbXVzdEVuZEFicyAmJiAocmVsUGF0aFswXSA9PT0gJycgfHwgc3JjUGF0aFswXSA9PT0gJycpO1xuICB9XG5cbiAgaWYgKGlzUmVsQWJzKSB7XG4gICAgLy8gaXQncyBhYnNvbHV0ZS5cbiAgICByZXN1bHQuaG9zdCA9IChyZWxhdGl2ZS5ob3N0IHx8IHJlbGF0aXZlLmhvc3QgPT09ICcnKSA/XG4gICAgICAgICAgICAgICAgICByZWxhdGl2ZS5ob3N0IDogcmVzdWx0Lmhvc3Q7XG4gICAgcmVzdWx0Lmhvc3RuYW1lID0gKHJlbGF0aXZlLmhvc3RuYW1lIHx8IHJlbGF0aXZlLmhvc3RuYW1lID09PSAnJykgP1xuICAgICAgICAgICAgICAgICAgICAgIHJlbGF0aXZlLmhvc3RuYW1lIDogcmVzdWx0Lmhvc3RuYW1lO1xuICAgIHJlc3VsdC5zZWFyY2ggPSByZWxhdGl2ZS5zZWFyY2g7XG4gICAgcmVzdWx0LnF1ZXJ5ID0gcmVsYXRpdmUucXVlcnk7XG4gICAgc3JjUGF0aCA9IHJlbFBhdGg7XG4gICAgLy8gZmFsbCB0aHJvdWdoIHRvIHRoZSBkb3QtaGFuZGxpbmcgYmVsb3cuXG4gIH0gZWxzZSBpZiAocmVsUGF0aC5sZW5ndGgpIHtcbiAgICAvLyBpdCdzIHJlbGF0aXZlXG4gICAgLy8gdGhyb3cgYXdheSB0aGUgZXhpc3RpbmcgZmlsZSwgYW5kIHRha2UgdGhlIG5ldyBwYXRoIGluc3RlYWQuXG4gICAgaWYgKCFzcmNQYXRoKSBzcmNQYXRoID0gW107XG4gICAgc3JjUGF0aC5wb3AoKTtcbiAgICBzcmNQYXRoID0gc3JjUGF0aC5jb25jYXQocmVsUGF0aCk7XG4gICAgcmVzdWx0LnNlYXJjaCA9IHJlbGF0aXZlLnNlYXJjaDtcbiAgICByZXN1bHQucXVlcnkgPSByZWxhdGl2ZS5xdWVyeTtcbiAgfSBlbHNlIGlmICghdXRpbC5pc051bGxPclVuZGVmaW5lZChyZWxhdGl2ZS5zZWFyY2gpKSB7XG4gICAgLy8ganVzdCBwdWxsIG91dCB0aGUgc2VhcmNoLlxuICAgIC8vIGxpa2UgaHJlZj0nP2ZvbycuXG4gICAgLy8gUHV0IHRoaXMgYWZ0ZXIgdGhlIG90aGVyIHR3byBjYXNlcyBiZWNhdXNlIGl0IHNpbXBsaWZpZXMgdGhlIGJvb2xlYW5zXG4gICAgaWYgKHBzeWNob3RpYykge1xuICAgICAgcmVzdWx0Lmhvc3RuYW1lID0gcmVzdWx0Lmhvc3QgPSBzcmNQYXRoLnNoaWZ0KCk7XG4gICAgICAvL29jY2F0aW9uYWx5IHRoZSBhdXRoIGNhbiBnZXQgc3R1Y2sgb25seSBpbiBob3N0XG4gICAgICAvL3RoaXMgZXNwZWNpYWxseSBoYXBwZW5zIGluIGNhc2VzIGxpa2VcbiAgICAgIC8vdXJsLnJlc29sdmVPYmplY3QoJ21haWx0bzpsb2NhbDFAZG9tYWluMScsICdsb2NhbDJAZG9tYWluMicpXG4gICAgICB2YXIgYXV0aEluSG9zdCA9IHJlc3VsdC5ob3N0ICYmIHJlc3VsdC5ob3N0LmluZGV4T2YoJ0AnKSA+IDAgP1xuICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQuaG9zdC5zcGxpdCgnQCcpIDogZmFsc2U7XG4gICAgICBpZiAoYXV0aEluSG9zdCkge1xuICAgICAgICByZXN1bHQuYXV0aCA9IGF1dGhJbkhvc3Quc2hpZnQoKTtcbiAgICAgICAgcmVzdWx0Lmhvc3QgPSByZXN1bHQuaG9zdG5hbWUgPSBhdXRoSW5Ib3N0LnNoaWZ0KCk7XG4gICAgICB9XG4gICAgfVxuICAgIHJlc3VsdC5zZWFyY2ggPSByZWxhdGl2ZS5zZWFyY2g7XG4gICAgcmVzdWx0LnF1ZXJ5ID0gcmVsYXRpdmUucXVlcnk7XG4gICAgLy90byBzdXBwb3J0IGh0dHAucmVxdWVzdFxuICAgIGlmICghdXRpbC5pc051bGwocmVzdWx0LnBhdGhuYW1lKSB8fCAhdXRpbC5pc051bGwocmVzdWx0LnNlYXJjaCkpIHtcbiAgICAgIHJlc3VsdC5wYXRoID0gKHJlc3VsdC5wYXRobmFtZSA/IHJlc3VsdC5wYXRobmFtZSA6ICcnKSArXG4gICAgICAgICAgICAgICAgICAgIChyZXN1bHQuc2VhcmNoID8gcmVzdWx0LnNlYXJjaCA6ICcnKTtcbiAgICB9XG4gICAgcmVzdWx0LmhyZWYgPSByZXN1bHQuZm9ybWF0KCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIGlmICghc3JjUGF0aC5sZW5ndGgpIHtcbiAgICAvLyBubyBwYXRoIGF0IGFsbC4gIGVhc3kuXG4gICAgLy8gd2UndmUgYWxyZWFkeSBoYW5kbGVkIHRoZSBvdGhlciBzdHVmZiBhYm92ZS5cbiAgICByZXN1bHQucGF0aG5hbWUgPSBudWxsO1xuICAgIC8vdG8gc3VwcG9ydCBodHRwLnJlcXVlc3RcbiAgICBpZiAocmVzdWx0LnNlYXJjaCkge1xuICAgICAgcmVzdWx0LnBhdGggPSAnLycgKyByZXN1bHQuc2VhcmNoO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXN1bHQucGF0aCA9IG51bGw7XG4gICAgfVxuICAgIHJlc3VsdC5ocmVmID0gcmVzdWx0LmZvcm1hdCgpO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICAvLyBpZiBhIHVybCBFTkRzIGluIC4gb3IgLi4sIHRoZW4gaXQgbXVzdCBnZXQgYSB0cmFpbGluZyBzbGFzaC5cbiAgLy8gaG93ZXZlciwgaWYgaXQgZW5kcyBpbiBhbnl0aGluZyBlbHNlIG5vbi1zbGFzaHksXG4gIC8vIHRoZW4gaXQgbXVzdCBOT1QgZ2V0IGEgdHJhaWxpbmcgc2xhc2guXG4gIHZhciBsYXN0ID0gc3JjUGF0aC5zbGljZSgtMSlbMF07XG4gIHZhciBoYXNUcmFpbGluZ1NsYXNoID0gKFxuICAgICAgKHJlc3VsdC5ob3N0IHx8IHJlbGF0aXZlLmhvc3QgfHwgc3JjUGF0aC5sZW5ndGggPiAxKSAmJlxuICAgICAgKGxhc3QgPT09ICcuJyB8fCBsYXN0ID09PSAnLi4nKSB8fCBsYXN0ID09PSAnJyk7XG5cbiAgLy8gc3RyaXAgc2luZ2xlIGRvdHMsIHJlc29sdmUgZG91YmxlIGRvdHMgdG8gcGFyZW50IGRpclxuICAvLyBpZiB0aGUgcGF0aCB0cmllcyB0byBnbyBhYm92ZSB0aGUgcm9vdCwgYHVwYCBlbmRzIHVwID4gMFxuICB2YXIgdXAgPSAwO1xuICBmb3IgKHZhciBpID0gc3JjUGF0aC5sZW5ndGg7IGkgPj0gMDsgaS0tKSB7XG4gICAgbGFzdCA9IHNyY1BhdGhbaV07XG4gICAgaWYgKGxhc3QgPT09ICcuJykge1xuICAgICAgc3JjUGF0aC5zcGxpY2UoaSwgMSk7XG4gICAgfSBlbHNlIGlmIChsYXN0ID09PSAnLi4nKSB7XG4gICAgICBzcmNQYXRoLnNwbGljZShpLCAxKTtcbiAgICAgIHVwKys7XG4gICAgfSBlbHNlIGlmICh1cCkge1xuICAgICAgc3JjUGF0aC5zcGxpY2UoaSwgMSk7XG4gICAgICB1cC0tO1xuICAgIH1cbiAgfVxuXG4gIC8vIGlmIHRoZSBwYXRoIGlzIGFsbG93ZWQgdG8gZ28gYWJvdmUgdGhlIHJvb3QsIHJlc3RvcmUgbGVhZGluZyAuLnNcbiAgaWYgKCFtdXN0RW5kQWJzICYmICFyZW1vdmVBbGxEb3RzKSB7XG4gICAgZm9yICg7IHVwLS07IHVwKSB7XG4gICAgICBzcmNQYXRoLnVuc2hpZnQoJy4uJyk7XG4gICAgfVxuICB9XG5cbiAgaWYgKG11c3RFbmRBYnMgJiYgc3JjUGF0aFswXSAhPT0gJycgJiZcbiAgICAgICghc3JjUGF0aFswXSB8fCBzcmNQYXRoWzBdLmNoYXJBdCgwKSAhPT0gJy8nKSkge1xuICAgIHNyY1BhdGgudW5zaGlmdCgnJyk7XG4gIH1cblxuICBpZiAoaGFzVHJhaWxpbmdTbGFzaCAmJiAoc3JjUGF0aC5qb2luKCcvJykuc3Vic3RyKC0xKSAhPT0gJy8nKSkge1xuICAgIHNyY1BhdGgucHVzaCgnJyk7XG4gIH1cblxuICB2YXIgaXNBYnNvbHV0ZSA9IHNyY1BhdGhbMF0gPT09ICcnIHx8XG4gICAgICAoc3JjUGF0aFswXSAmJiBzcmNQYXRoWzBdLmNoYXJBdCgwKSA9PT0gJy8nKTtcblxuICAvLyBwdXQgdGhlIGhvc3QgYmFja1xuICBpZiAocHN5Y2hvdGljKSB7XG4gICAgcmVzdWx0Lmhvc3RuYW1lID0gcmVzdWx0Lmhvc3QgPSBpc0Fic29sdXRlID8gJycgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3JjUGF0aC5sZW5ndGggPyBzcmNQYXRoLnNoaWZ0KCkgOiAnJztcbiAgICAvL29jY2F0aW9uYWx5IHRoZSBhdXRoIGNhbiBnZXQgc3R1Y2sgb25seSBpbiBob3N0XG4gICAgLy90aGlzIGVzcGVjaWFsbHkgaGFwcGVucyBpbiBjYXNlcyBsaWtlXG4gICAgLy91cmwucmVzb2x2ZU9iamVjdCgnbWFpbHRvOmxvY2FsMUBkb21haW4xJywgJ2xvY2FsMkBkb21haW4yJylcbiAgICB2YXIgYXV0aEluSG9zdCA9IHJlc3VsdC5ob3N0ICYmIHJlc3VsdC5ob3N0LmluZGV4T2YoJ0AnKSA+IDAgP1xuICAgICAgICAgICAgICAgICAgICAgcmVzdWx0Lmhvc3Quc3BsaXQoJ0AnKSA6IGZhbHNlO1xuICAgIGlmIChhdXRoSW5Ib3N0KSB7XG4gICAgICByZXN1bHQuYXV0aCA9IGF1dGhJbkhvc3Quc2hpZnQoKTtcbiAgICAgIHJlc3VsdC5ob3N0ID0gcmVzdWx0Lmhvc3RuYW1lID0gYXV0aEluSG9zdC5zaGlmdCgpO1xuICAgIH1cbiAgfVxuXG4gIG11c3RFbmRBYnMgPSBtdXN0RW5kQWJzIHx8IChyZXN1bHQuaG9zdCAmJiBzcmNQYXRoLmxlbmd0aCk7XG5cbiAgaWYgKG11c3RFbmRBYnMgJiYgIWlzQWJzb2x1dGUpIHtcbiAgICBzcmNQYXRoLnVuc2hpZnQoJycpO1xuICB9XG5cbiAgaWYgKCFzcmNQYXRoLmxlbmd0aCkge1xuICAgIHJlc3VsdC5wYXRobmFtZSA9IG51bGw7XG4gICAgcmVzdWx0LnBhdGggPSBudWxsO1xuICB9IGVsc2Uge1xuICAgIHJlc3VsdC5wYXRobmFtZSA9IHNyY1BhdGguam9pbignLycpO1xuICB9XG5cbiAgLy90byBzdXBwb3J0IHJlcXVlc3QuaHR0cFxuICBpZiAoIXV0aWwuaXNOdWxsKHJlc3VsdC5wYXRobmFtZSkgfHwgIXV0aWwuaXNOdWxsKHJlc3VsdC5zZWFyY2gpKSB7XG4gICAgcmVzdWx0LnBhdGggPSAocmVzdWx0LnBhdGhuYW1lID8gcmVzdWx0LnBhdGhuYW1lIDogJycpICtcbiAgICAgICAgICAgICAgICAgIChyZXN1bHQuc2VhcmNoID8gcmVzdWx0LnNlYXJjaCA6ICcnKTtcbiAgfVxuICByZXN1bHQuYXV0aCA9IHJlbGF0aXZlLmF1dGggfHwgcmVzdWx0LmF1dGg7XG4gIHJlc3VsdC5zbGFzaGVzID0gcmVzdWx0LnNsYXNoZXMgfHwgcmVsYXRpdmUuc2xhc2hlcztcbiAgcmVzdWx0LmhyZWYgPSByZXN1bHQuZm9ybWF0KCk7XG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG5VcmwucHJvdG90eXBlLnBhcnNlSG9zdCA9IGZ1bmN0aW9uKCkge1xuICB2YXIgaG9zdCA9IHRoaXMuaG9zdDtcbiAgdmFyIHBvcnQgPSBwb3J0UGF0dGVybi5leGVjKGhvc3QpO1xuICBpZiAocG9ydCkge1xuICAgIHBvcnQgPSBwb3J0WzBdO1xuICAgIGlmIChwb3J0ICE9PSAnOicpIHtcbiAgICAgIHRoaXMucG9ydCA9IHBvcnQuc3Vic3RyKDEpO1xuICAgIH1cbiAgICBob3N0ID0gaG9zdC5zdWJzdHIoMCwgaG9zdC5sZW5ndGggLSBwb3J0Lmxlbmd0aCk7XG4gIH1cbiAgaWYgKGhvc3QpIHRoaXMuaG9zdG5hbWUgPSBob3N0O1xufTtcbiIsIid1c2Ugc3RyaWN0JztcblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIGlzU3RyaW5nOiBmdW5jdGlvbihhcmcpIHtcbiAgICByZXR1cm4gdHlwZW9mKGFyZykgPT09ICdzdHJpbmcnO1xuICB9LFxuICBpc09iamVjdDogZnVuY3Rpb24oYXJnKSB7XG4gICAgcmV0dXJuIHR5cGVvZihhcmcpID09PSAnb2JqZWN0JyAmJiBhcmcgIT09IG51bGw7XG4gIH0sXG4gIGlzTnVsbDogZnVuY3Rpb24oYXJnKSB7XG4gICAgcmV0dXJuIGFyZyA9PT0gbnVsbDtcbiAgfSxcbiAgaXNOdWxsT3JVbmRlZmluZWQ6IGZ1bmN0aW9uKGFyZykge1xuICAgIHJldHVybiBhcmcgPT0gbnVsbDtcbiAgfVxufTtcbiIsInZhciBnO1xuXG4vLyBUaGlzIHdvcmtzIGluIG5vbi1zdHJpY3QgbW9kZVxuZyA9IChmdW5jdGlvbigpIHtcblx0cmV0dXJuIHRoaXM7XG59KSgpO1xuXG50cnkge1xuXHQvLyBUaGlzIHdvcmtzIGlmIGV2YWwgaXMgYWxsb3dlZCAoc2VlIENTUClcblx0ZyA9IGcgfHwgbmV3IEZ1bmN0aW9uKFwicmV0dXJuIHRoaXNcIikoKTtcbn0gY2F0Y2ggKGUpIHtcblx0Ly8gVGhpcyB3b3JrcyBpZiB0aGUgd2luZG93IHJlZmVyZW5jZSBpcyBhdmFpbGFibGVcblx0aWYgKHR5cGVvZiB3aW5kb3cgPT09IFwib2JqZWN0XCIpIGcgPSB3aW5kb3c7XG59XG5cbi8vIGcgY2FuIHN0aWxsIGJlIHVuZGVmaW5lZCwgYnV0IG5vdGhpbmcgdG8gZG8gYWJvdXQgaXQuLi5cbi8vIFdlIHJldHVybiB1bmRlZmluZWQsIGluc3RlYWQgb2Ygbm90aGluZyBoZXJlLCBzbyBpdCdzXG4vLyBlYXNpZXIgdG8gaGFuZGxlIHRoaXMgY2FzZS4gaWYoIWdsb2JhbCkgeyAuLi59XG5cbm1vZHVsZS5leHBvcnRzID0gZztcbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24obW9kdWxlKSB7XG5cdGlmICghbW9kdWxlLndlYnBhY2tQb2x5ZmlsbCkge1xuXHRcdG1vZHVsZS5kZXByZWNhdGUgPSBmdW5jdGlvbigpIHt9O1xuXHRcdG1vZHVsZS5wYXRocyA9IFtdO1xuXHRcdC8vIG1vZHVsZS5wYXJlbnQgPSB1bmRlZmluZWQgYnkgZGVmYXVsdFxuXHRcdGlmICghbW9kdWxlLmNoaWxkcmVuKSBtb2R1bGUuY2hpbGRyZW4gPSBbXTtcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobW9kdWxlLCBcImxvYWRlZFwiLCB7XG5cdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIG1vZHVsZS5sO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShtb2R1bGUsIFwiaWRcIiwge1xuXHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiBtb2R1bGUuaTtcblx0XHRcdH1cblx0XHR9KTtcblx0XHRtb2R1bGUud2VicGFja1BvbHlmaWxsID0gMTtcblx0fVxuXHRyZXR1cm4gbW9kdWxlO1xufTtcbiIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcblxudmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrXCIpKTtcblxudmFyIF9jcmVhdGVDbGFzczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2NyZWF0ZUNsYXNzXCIpKTtcblxudmFyIF9pc1BsYWluT2JqZWN0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwibG9kYXNoL2lzUGxhaW5PYmplY3RcIikpO1xuXG52YXIgX2tpbnZleSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vZXJyb3JzL2tpbnZleVwiKSk7XG5cbi8qKlxuICogVGhpcyBjbGFzcyBwcm92aWRlcyBhIHdheSB0byBhY2Nlc3MgdGhlIEFDTCAoQWNjZXNzIENvbnRyb2wgTGlzdClcbiAqIGluZm9ybWF0aW9uIGZvciBhbiBlbnRpdHkgYW5kIHRvIG1vZGlmeSB0aGUgYWNjZXNzIGNvbnRyb2wgcGVybWlzc2lvbnMuXG4gKi9cbnZhciBBY2wgPVxuLyojX19QVVJFX18qL1xuZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBBY2woZW50aXR5KSB7XG4gICAgKDAsIF9jbGFzc0NhbGxDaGVjazIuZGVmYXVsdCkodGhpcywgQWNsKTtcblxuICAgIGlmICghKDAsIF9pc1BsYWluT2JqZWN0LmRlZmF1bHQpKGVudGl0eSkpIHtcbiAgICAgIHRocm93IG5ldyBfa2ludmV5LmRlZmF1bHQoJ2VudGl0eSBtdXN0IGJlIGFuIG9iamVjdC4nKTtcbiAgICB9XG5cbiAgICBlbnRpdHkuX2FjbCA9IGVudGl0eS5fYWNsIHx8IHt9OyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXBhcmFtLXJlYXNzaWduXG5cbiAgICB0aGlzLmVudGl0eSA9IGVudGl0eTtcbiAgfVxuICAvKipcbiAgICogR2V0IHRoZSBjcmVhdG9yLlxuICAgKlxuICAgKiBAcmV0dXJucyB7c3RyaW5nfSBDcmVhdG9yXG4gICAqL1xuXG5cbiAgKDAsIF9jcmVhdGVDbGFzczIuZGVmYXVsdCkoQWNsLCBbe1xuICAgIGtleTogXCJhZGRSZWFkZXJcIixcblxuICAgIC8qKlxuICAgICAqIEFkZCBhIHJlYWRlci5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSByZWFkZXIgUmVhZGVyXG4gICAgICogQHJldHVybnMge0FjbH0gQWNsXG4gICAgICovXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGFkZFJlYWRlcihyZWFkZXIpIHtcbiAgICAgIHZhciByID0gdGhpcy5yZWFkZXJzO1xuXG4gICAgICBpZiAoci5pbmRleE9mKHJlYWRlcikgPT09IC0xKSB7XG4gICAgICAgIHIucHVzaChyZWFkZXIpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmVudGl0eS5fYWNsLnIgPSByO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZCBhIHJlYWRlciBncm91cC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBncm91cCBSZWFkZXIgZ3JvdXBcbiAgICAgKiBAcmV0dXJucyB7QWNsfSBBY2xcbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiBcImFkZFJlYWRlckdyb3VwXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGFkZFJlYWRlckdyb3VwKGdyb3VwKSB7XG4gICAgICB2YXIgZ3JvdXBzID0gdGhpcy5yZWFkZXJHcm91cHM7XG5cbiAgICAgIGlmIChncm91cHMuaW5kZXhPZihncm91cCkgPT09IC0xKSB7XG4gICAgICAgIGdyb3Vwcy5wdXNoKGdyb3VwKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5lbnRpdHkuX2FjbC5ncm91cHMgPSBPYmplY3QuYXNzaWduKHt9LCB0aGlzLmVudGl0eS5fYWNsLmdyb3Vwcywge1xuICAgICAgICByOiBncm91cHNcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZCBhIHdyaXRlci5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB3cml0ZXIgV3JpdGVyXG4gICAgICogQHJldHVybnMge0FjbH0gQWNsXG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJhZGRXcml0ZXJcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gYWRkV3JpdGVyKHdyaXRlcikge1xuICAgICAgdmFyIHcgPSB0aGlzLndyaXRlcnM7XG5cbiAgICAgIGlmICh3LmluZGV4T2Yod3JpdGVyKSA9PT0gLTEpIHtcbiAgICAgICAgdy5wdXNoKHdyaXRlcik7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuZW50aXR5Ll9hY2wudyA9IHc7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkIGEgd3JpdGVyIGdyb3VwLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGdyb3VwIFdyaXRlciBncm91cFxuICAgICAqIEByZXR1cm5zIHtBY2x9IEFjbFxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6IFwiYWRkV3JpdGVyR3JvdXBcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gYWRkV3JpdGVyR3JvdXAoZ3JvdXApIHtcbiAgICAgIHZhciBncm91cHMgPSB0aGlzLndyaXRlckdyb3VwcztcblxuICAgICAgaWYgKGdyb3Vwcy5pbmRleE9mKGdyb3VwKSA9PT0gLTEpIHtcbiAgICAgICAgZ3JvdXBzLnB1c2goZ3JvdXApO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmVudGl0eS5fYWNsLmdyb3VwcyA9IE9iamVjdC5hc3NpZ24oe30sIHRoaXMuZW50aXR5Ll9hY2wuZ3JvdXBzLCB7XG4gICAgICAgIHc6IGdyb3Vwc1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2hlY2sgaWYgZ2xvYmFsbHkgcmVhZGFibGUgaXMgYWxsb3dlZC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIGdsb2JhbGx5IHJlYWRhYmxlIGlzIGFsbG93ZWQgb3RoZXJ3aXNlIGZhbHNlXG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJpc0dsb2JhbGx5UmVhZGFibGVcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gaXNHbG9iYWxseVJlYWRhYmxlKCkge1xuICAgICAgcmV0dXJuIHRoaXMuZW50aXR5Ll9hY2wuZ3IgPT09IHRydWU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENoZWNrIGlmIGdsb2JhbGx5IHdyaXRhYmxlIGlzIGFsbG93ZWQuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiBnbG9iYWxseSB3cml0YWJsZSBpcyBhbGxvd2VkIG90aGVyd2lzZSBmYWxzZVxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6IFwiaXNHbG9iYWxseVdyaXRhYmxlXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGlzR2xvYmFsbHlXcml0YWJsZSgpIHtcbiAgICAgIHJldHVybiB0aGlzLmVudGl0eS5fYWNsLmd3ID09PSB0cnVlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgYSByZWFkZXIuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gcmVhZGVyIFJlYWRlclxuICAgICAqIEByZXR1cm5zIHtBY2x9IEFjbFxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6IFwicmVtb3ZlUmVhZGVyXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZVJlYWRlcihyZWFkZXIpIHtcbiAgICAgIHZhciByID0gdGhpcy5yZWFkZXJzO1xuICAgICAgdmFyIGluZGV4ID0gci5pbmRleE9mKHJlYWRlcik7XG5cbiAgICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgICAgci5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmVudGl0eS5fYWNsLnIgPSByO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlbW92ZSBhIHJlYWRlciBncm91cC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBncm91cCBSZWFkZXIgZ3JvdXBcbiAgICAgKiBAcmV0dXJucyB7QWNsfSBBY2xcbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiBcInJlbW92ZVJlYWRlckdyb3VwXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZVJlYWRlckdyb3VwKGdyb3VwKSB7XG4gICAgICB2YXIgZ3JvdXBzID0gdGhpcy5yZWFkZXJHcm91cHM7XG4gICAgICB2YXIgaW5kZXggPSBncm91cHMuaW5kZXhPZihncm91cCk7XG5cbiAgICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgICAgZ3JvdXBzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuZW50aXR5Ll9hY2wuZ3JvdXBzID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5lbnRpdHkuX2FjbC5ncm91cHMsIHtcbiAgICAgICAgcjogZ3JvdXBzXG4gICAgICB9KTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgYSB3cml0ZXIuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gd3JpdGVyIFdyaXRlclxuICAgICAqIEByZXR1cm5zIHtBY2x9IEFjbFxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6IFwicmVtb3ZlV3JpdGVyXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZVdyaXRlcih3cml0ZXIpIHtcbiAgICAgIHZhciB3ID0gdGhpcy53cml0ZXJzO1xuICAgICAgdmFyIGluZGV4ID0gdy5pbmRleE9mKHdyaXRlcik7XG5cbiAgICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgICAgdy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmVudGl0eS5fYWNsLncgPSB3O1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlbW92ZSBhIHdyaXRlciBncm91cC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBncm91cCBXcml0ZXIgZ3JvdXBcbiAgICAgKiBAcmV0dXJucyB7QWNsfSBBY2xcbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiBcInJlbW92ZVdyaXRlckdyb3VwXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZVdyaXRlckdyb3VwKGdyb3VwKSB7XG4gICAgICB2YXIgZ3JvdXBzID0gdGhpcy53cml0ZXJHcm91cHM7XG4gICAgICB2YXIgaW5kZXggPSBncm91cHMuaW5kZXhPZihncm91cCk7XG5cbiAgICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgICAgZ3JvdXBzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuZW50aXR5Ll9hY2wuZ3JvdXBzID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5lbnRpdHkuX2FjbC5ncm91cHMsIHtcbiAgICAgICAgdzogZ3JvdXBzXG4gICAgICB9KTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgYWNsIGFzIGEgcGxhaW4gb2JqZWN0LlxuICAgICAqXG4gICAgICogQHJldHVybnMge09iamVjdH0gQWNsIGFzIGEgcGxhaW4gb2JqZWN0LlxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6IFwidG9QbGFpbk9iamVjdFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiB0b1BsYWluT2JqZWN0KCkge1xuICAgICAgcmV0dXJuIHRoaXMuZW50aXR5Ll9hY2w7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImNyZWF0b3JcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLmVudGl0eS5fYWNsLmNyZWF0b3I7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgcmVhZGVycy5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtzdHJpbmdbXX0gUmVhZGVyc1xuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6IFwicmVhZGVyc1wiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIEFycmF5LmlzQXJyYXkodGhpcy5lbnRpdHkuX2FjbC5yKSA/IHRoaXMuZW50aXR5Ll9hY2wuciA6IFtdO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIHdyaXRlcnMuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nW119IFdyaXRlcnNcbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiBcIndyaXRlcnNcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiBBcnJheS5pc0FycmF5KHRoaXMuZW50aXR5Ll9hY2wudykgPyB0aGlzLmVudGl0eS5fYWNsLncgOiBbXTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0IHRoZSByZWFkZXIgZ3JvdXBzLlxuICAgICAqXG4gICAgICogQHJldHVybnMge3N0cmluZ1tdfSBSZWFkZXIgZ3JvdXBzXG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJyZWFkZXJHcm91cHNcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLmVudGl0eS5fYWNsLmdyb3VwcyAmJiBBcnJheS5pc0FycmF5KHRoaXMuZW50aXR5Ll9hY2wuZ3JvdXBzLnIpID8gdGhpcy5lbnRpdHkuX2FjbC5ncm91cHMuciA6IFtdO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIHdyaXRlciBncm91cHMuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nW119IFdyaXRlciBncm91cHNcbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiBcIndyaXRlckdyb3Vwc1wiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMuZW50aXR5Ll9hY2wuZ3JvdXBzICYmIEFycmF5LmlzQXJyYXkodGhpcy5lbnRpdHkuX2FjbC5ncm91cHMudykgPyB0aGlzLmVudGl0eS5fYWNsLmdyb3Vwcy53IDogW107XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldCB0aGUgZ2xvYmFsbHkgcmVhZGFibGUgcGVybWlzc2lvbi5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gZ3IgR2xvYmFsbHkgcmVhZGFibGVcbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiBcImdsb2JhbGx5UmVhZGFibGVcIixcbiAgICBzZXQ6IGZ1bmN0aW9uIHNldChncikge1xuICAgICAgdGhpcy5lbnRpdHkuX2FjbC5nciA9IGdyID09PSB0cnVlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXQgdGhlIGdsb2JhbGx5IHdyaXRhYmxlIHBlcm1pc3Npb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IGd3IEdsb2JhbGx5IHdyaXRhYmxlXG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJnbG9iYWxseVdyaXRhYmxlXCIsXG4gICAgc2V0OiBmdW5jdGlvbiBzZXQoZ3cpIHtcbiAgICAgIHRoaXMuZW50aXR5Ll9hY2wuZ3cgPSBndyA9PT0gdHJ1ZTtcbiAgICB9XG4gIH1dKTtcbiAgcmV0dXJuIEFjbDtcbn0oKTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gQWNsOyIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcblxudmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrXCIpKTtcblxudmFyIF9jcmVhdGVDbGFzczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2NyZWF0ZUNsYXNzXCIpKTtcblxudmFyIF9xdWVyeSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uL3F1ZXJ5XCIpKTtcblxudmFyIEFnZ3JlZ2F0aW9uID1cbi8qI19fUFVSRV9fKi9cbmZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gQWdncmVnYXRpb24oYWdncmVnYXRpb24pIHtcbiAgICAoMCwgX2NsYXNzQ2FsbENoZWNrMi5kZWZhdWx0KSh0aGlzLCBBZ2dyZWdhdGlvbik7XG4gICAgdmFyIGNvbmZpZyA9IE9iamVjdC5hc3NpZ24oe30sIHtcbiAgICAgIHF1ZXJ5OiBudWxsLFxuICAgICAgaW5pdGlhbDoge30sXG4gICAgICBrZXk6IHt9LFxuICAgICAgcmVkdWNlRm46IGZ1bmN0aW9uIHJlZHVjZUZuKCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICB9LCBhZ2dyZWdhdGlvbik7XG4gICAgdGhpcy5xdWVyeSA9IGNvbmZpZy5xdWVyeTtcbiAgICB0aGlzLmluaXRpYWwgPSBjb25maWcuaW5pdGlhbDtcbiAgICB0aGlzLmtleSA9IGNvbmZpZy5rZXk7XG4gICAgdGhpcy5yZWR1Y2VGbiA9IGNvbmZpZy5yZWR1Y2VGbjtcbiAgfVxuXG4gICgwLCBfY3JlYXRlQ2xhc3MyLmRlZmF1bHQpKEFnZ3JlZ2F0aW9uLCBbe1xuICAgIGtleTogXCJieVwiLFxuXG4gICAgLyoqXG4gICAgICogQWRkcyB0aGUgZmlsZWQgdG8gdGhlIGFycmF5IG9mIGZpZWxkcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBmaWVsZFxuICAgICAqIEByZXR1cm5zIHtBZ2dyZWdhdGlvbn0gQWdncmVnYXRpb25cbiAgICAgKi9cbiAgICB2YWx1ZTogZnVuY3Rpb24gYnkoZmllbGQpIHtcbiAgICAgIHRoaXMua2V5W2ZpZWxkXSA9IHRydWU7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwicHJvY2Vzc1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBwcm9jZXNzKCkge1xuICAgICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgICAgdmFyIGRvY3MgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IFtdO1xuXG4gICAgICBpZiAoZG9jcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHZhciBmaWVsZHMgPSBPYmplY3Qua2V5cyh0aGlzLmtleSk7XG4gICAgICAgIHZhciBmaWx0ZXJlZERvY3MgPSBkb2NzO1xuXG4gICAgICAgIGlmICh0aGlzLnF1ZXJ5KSB7XG4gICAgICAgICAgZmlsdGVyZWREb2NzID0gdGhpcy5xdWVyeS5wcm9jZXNzKGRvY3MpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGZpZWxkcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgcmV0dXJuIGZpZWxkcy5yZWR1Y2UoZnVuY3Rpb24gKHJlc3VsdHMsIGZpZWxkKSB7XG4gICAgICAgICAgICByZXN1bHRzW2ZpZWxkXSA9IGZpbHRlcmVkRG9jcy5yZWR1Y2UoZnVuY3Rpb24gKHJlc3VsdCwgZG9jKSB7XG4gICAgICAgICAgICAgIHJldHVybiBfdGhpcy5yZWR1Y2VGbihyZXN1bHQsIGRvYywgZmllbGQpIHx8IHJlc3VsdDtcbiAgICAgICAgICAgIH0sIE9iamVjdC5hc3NpZ24oe30sIF90aGlzLmluaXRpYWwpKTtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHRzO1xuICAgICAgICAgIH0sIHt9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmaWx0ZXJlZERvY3MucmVkdWNlKGZ1bmN0aW9uIChyZXN1bHQsIGRvYykge1xuICAgICAgICAgIHJldHVybiBfdGhpcy5yZWR1Y2VGbihkb2MsIHJlc3VsdCkgfHwgcmVzdWx0O1xuICAgICAgICB9LCBPYmplY3QuYXNzaWduKHt9LCB0aGlzLmluaXRpYWwpKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIHRoaXMuaW5pdGlhbCk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInRvUGxhaW5PYmplY3RcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gdG9QbGFpbk9iamVjdCgpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGtleTogdGhpcy5rZXksXG4gICAgICAgIGluaXRpYWw6IHRoaXMuaW5pdGlhbCxcbiAgICAgICAgcmVkdWNlOiB0aGlzLnJlZHVjZUZuLFxuICAgICAgICByZWR1Y2VGbjogdGhpcy5yZWR1Y2VGbixcbiAgICAgICAgY29uZGl0aW9uOiB0aGlzLnF1ZXJ5ID8gdGhpcy5xdWVyeS50b1BsYWluT2JqZWN0KCkuZmlsdGVyIDoge30sXG4gICAgICAgIHF1ZXJ5OiB0aGlzLnF1ZXJ5ID8gdGhpcy5xdWVyeS50b1BsYWluT2JqZWN0KCkgOiBudWxsXG4gICAgICB9O1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJxdWVyeVwiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3F1ZXJ5O1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiBzZXQocXVlcnkpIHtcbiAgICAgIGlmIChxdWVyeSAmJiAhKHF1ZXJ5IGluc3RhbmNlb2YgX3F1ZXJ5LmRlZmF1bHQpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignUXVlcnkgbXVzdCBiZSBhbiBpbnN0YW5jZSBvZiBRdWVyeSBjbGFzcy4nKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5fcXVlcnkgPSBxdWVyeTtcbiAgICB9XG4gIH1dKTtcbiAgcmV0dXJuIEFnZ3JlZ2F0aW9uO1xufSgpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBBZ2dyZWdhdGlvbjsiLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSBhdmVyYWdlO1xuXG52YXIgX2FnZ3JlZ2F0aW9uID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9hZ2dyZWdhdGlvblwiKSk7XG5cbi8qKlxuICogQ3JlYXRlcyBhbiBhZ2dyZWdhdGlvbiB0aGF0IHdpbGwgcmV0dXJuIHRoZSBhdmVyYWdlIHZhbHVlIGZvciBhIGZpZWxkIG9uIGFuIGFycmF5IG9mIGRhdGEuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGZpZWxkIEZpZWxkXG4gKiBAcmV0dXJucyB7QWdncmVnYXRpb259IEFnZ3JlZ2F0aW9uXG4gKi9cbmZ1bmN0aW9uIGF2ZXJhZ2UoKSB7XG4gIHZhciBmaWVsZCA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogJyc7XG4gIHZhciBhZ2dyZWdhdGlvbiA9IG5ldyBfYWdncmVnYXRpb24uZGVmYXVsdCh7XG4gICAgaW5pdGlhbDoge1xuICAgICAgY291bnQ6IDAsXG4gICAgICBhdmVyYWdlOiAwXG4gICAgfSxcbiAgICByZWR1Y2VGbjogZnVuY3Rpb24gcmVkdWNlRm4ocmVzdWx0LCBkb2MsIGtleSkge1xuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXBhcmFtLXJlYXNzaWduXG4gICAgICByZXN1bHQuYXZlcmFnZSA9IChyZXN1bHQuYXZlcmFnZSAqIHJlc3VsdC5jb3VudCArIGRvY1trZXldKSAvIChyZXN1bHQuY291bnQgKyAxKTsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXBhcmFtLXJlYXNzaWduXG5cbiAgICAgIHJlc3VsdC5jb3VudCArPSAxO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gIH0pO1xuICBhZ2dyZWdhdGlvbi5ieShmaWVsZCk7XG4gIHJldHVybiBhZ2dyZWdhdGlvbjtcbn0iLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSBjb3VudDtcblxudmFyIF9hZ2dyZWdhdGlvbiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vYWdncmVnYXRpb25cIikpO1xuXG4vKipcbiAqIENyZWF0ZXMgYW4gYWdncmVnYXRpb24gdGhhdCB3aWxsIHJldHVybiB0aGUgY291bnQgZm9yIGEgZmllbGQgb24gYW4gYXJyYXkgb2YgZGF0YS5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gZmllbGQgRmllbGRcbiAqIEByZXR1cm5zIHtBZ2dyZWdhdGlvbn0gQWdncmVnYXRpb25cbiAqL1xuZnVuY3Rpb24gY291bnQoKSB7XG4gIHZhciBmaWVsZCA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogJyc7XG4gIHZhciBhZ2dyZWdhdGlvbiA9IG5ldyBfYWdncmVnYXRpb24uZGVmYXVsdCh7XG4gICAgcmVkdWNlRm46IGZ1bmN0aW9uIHJlZHVjZUZuKHJlc3VsdCwgZG9jLCBrZXkpIHtcbiAgICAgIHZhciB2YWwgPSBkb2Nba2V5XTtcblxuICAgICAgaWYgKHZhbCkge1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcGFyYW0tcmVhc3NpZ25cbiAgICAgICAgcmVzdWx0W3ZhbF0gPSB0eXBlb2YgcmVzdWx0W3ZhbF0gPT09ICd1bmRlZmluZWQnID8gMSA6IHJlc3VsdFt2YWxdICsgMTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gIH0pO1xuICBhZ2dyZWdhdGlvbi5ieShmaWVsZCk7XG4gIHJldHVybiBhZ2dyZWdhdGlvbjtcbn0iLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG5cbnZhciBfYWdncmVnYXRpb24gPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL2FnZ3JlZ2F0aW9uXCIpKTtcblxudmFyIF9hdmVyYWdlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9hdmVyYWdlXCIpKTtcblxudmFyIF9jb3VudCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vY291bnRcIikpO1xuXG52YXIgX21heCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vbWF4XCIpKTtcblxudmFyIF9taW4gPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL21pblwiKSk7XG5cbnZhciBfc3VtID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9zdW1cIikpO1xuXG5fYWdncmVnYXRpb24uZGVmYXVsdC5hdmVyYWdlID0gX2F2ZXJhZ2UuZGVmYXVsdDtcbl9hZ2dyZWdhdGlvbi5kZWZhdWx0LmNvdW50ID0gX2NvdW50LmRlZmF1bHQ7XG5fYWdncmVnYXRpb24uZGVmYXVsdC5tYXggPSBfbWF4LmRlZmF1bHQ7XG5fYWdncmVnYXRpb24uZGVmYXVsdC5taW4gPSBfbWluLmRlZmF1bHQ7XG5fYWdncmVnYXRpb24uZGVmYXVsdC5zdW0gPSBfc3VtLmRlZmF1bHQ7XG52YXIgX2RlZmF1bHQgPSBfYWdncmVnYXRpb24uZGVmYXVsdDtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0OyIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IG1heDtcblxudmFyIF9hZ2dyZWdhdGlvbiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vYWdncmVnYXRpb25cIikpO1xuXG4vKipcbiAqIENyZWF0ZXMgYW4gYWdncmVnYXRpb24gdGhhdCB3aWxsIHJldHVybiB0aGUgbWF4IHZhbHVlIGZvciBhIGZpZWxkIG9uIGFuIGFycmF5IG9mIGRhdGEuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGZpZWxkIEZpZWxkXG4gKiBAcmV0dXJucyB7QWdncmVnYXRpb259IEFnZ3JlZ2F0aW9uXG4gKi9cbmZ1bmN0aW9uIG1heCgpIHtcbiAgdmFyIGZpZWxkID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiAnJztcbiAgdmFyIGFnZ3JlZ2F0aW9uID0gbmV3IF9hZ2dyZWdhdGlvbi5kZWZhdWx0KHtcbiAgICBpbml0aWFsOiB7XG4gICAgICBtYXg6IC1JbmZpbml0eVxuICAgIH0sXG4gICAgcmVkdWNlRm46IGZ1bmN0aW9uIHJlZHVjZUZuKHJlc3VsdCwgZG9jLCBrZXkpIHtcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wYXJhbS1yZWFzc2lnblxuICAgICAgcmVzdWx0Lm1heCA9IE1hdGgubWF4KHJlc3VsdC5tYXgsIGRvY1trZXldKTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICB9KTtcbiAgYWdncmVnYXRpb24uYnkoZmllbGQpO1xuICByZXR1cm4gYWdncmVnYXRpb247XG59IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gcmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW50ZXJvcFJlcXVpcmVEZWZhdWx0XCIpO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gbWluO1xuXG52YXIgX2FnZ3JlZ2F0aW9uID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9hZ2dyZWdhdGlvblwiKSk7XG5cbi8qKlxuICogQ3JlYXRlcyBhbiBhZ2dyZWdhdGlvbiB0aGF0IHdpbGwgcmV0dXJuIHRoZSBtaW4gdmFsdWUgZm9yIGEgZmllbGQgb24gYW4gYXJyYXkgb2YgZGF0YS5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gZmllbGQgRmllbGRcbiAqIEByZXR1cm5zIHtBZ2dyZWdhdGlvbn0gQWdncmVnYXRpb25cbiAqL1xuZnVuY3Rpb24gbWluKCkge1xuICB2YXIgZmllbGQgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6ICcnO1xuICB2YXIgYWdncmVnYXRpb24gPSBuZXcgX2FnZ3JlZ2F0aW9uLmRlZmF1bHQoe1xuICAgIGluaXRpYWw6IHtcbiAgICAgIG1pbjogSW5maW5pdHlcbiAgICB9LFxuICAgIHJlZHVjZUZuOiBmdW5jdGlvbiByZWR1Y2VGbihyZXN1bHQsIGRvYywga2V5KSB7XG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcGFyYW0tcmVhc3NpZ25cbiAgICAgIHJlc3VsdC5taW4gPSBNYXRoLm1pbihyZXN1bHQubWluLCBkb2Nba2V5XSk7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgfSk7XG4gIGFnZ3JlZ2F0aW9uLmJ5KGZpZWxkKTtcbiAgcmV0dXJuIGFnZ3JlZ2F0aW9uO1xufSIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHN1bTtcblxudmFyIF9hZ2dyZWdhdGlvbiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vYWdncmVnYXRpb25cIikpO1xuXG4vKipcbiAqIENyZWF0ZXMgYW4gYWdncmVnYXRpb24gdGhhdCB3aWxsIHJldHVybiB0aGUgc3VtIGZvciBhIGZpZWxkIG9uIGFuIGFycmF5IG9mIGRhdGEuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGZpZWxkIEZpZWxkXG4gKiBAcmV0dXJucyB7QWdncmVnYXRpb259IEFnZ3JlZ2F0aW9uXG4gKi9cbmZ1bmN0aW9uIHN1bSgpIHtcbiAgdmFyIGZpZWxkID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiAnJztcbiAgdmFyIGFnZ3JlZ2F0aW9uID0gbmV3IF9hZ2dyZWdhdGlvbi5kZWZhdWx0KHtcbiAgICBpbml0aWFsOiB7XG4gICAgICBzdW06IDBcbiAgICB9LFxuICAgIHJlZHVjZUZuOiBmdW5jdGlvbiByZWR1Y2VGbihyZXN1bHQsIGRvYywga2V5KSB7XG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcGFyYW0tcmVhc3NpZ25cbiAgICAgIHJlc3VsdC5zdW0gKz0gZG9jW2tleV07XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgfSk7XG4gIGFnZ3JlZ2F0aW9uLmJ5KGZpZWxkKTtcbiAgcmV0dXJuIGFnZ3JlZ2F0aW9uO1xufSIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuY2xlYXIgPSBjbGVhcjtcbmV4cG9ydHMuQ2FjaGUgPSB2b2lkIDA7XG5cbnZhciBfcmVnZW5lcmF0b3IgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9yZWdlbmVyYXRvclwiKSk7XG5cbnZhciBfYXN5bmNUb0dlbmVyYXRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2FzeW5jVG9HZW5lcmF0b3JcIikpO1xuXG52YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2tcIikpO1xuXG52YXIgX2NyZWF0ZUNsYXNzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3NcIikpO1xuXG52YXIgX3BRdWV1ZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcInAtcXVldWVcIikpO1xuXG52YXIgX3F1ZXJ5ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vcXVlcnlcIikpO1xuXG52YXIgX2FnZ3JlZ2F0aW9uID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vYWdncmVnYXRpb25cIikpO1xuXG52YXIgX2tpbnZleSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uL2Vycm9ycy9raW52ZXlcIikpO1xuXG52YXIgX3V0aWxzID0gcmVxdWlyZShcIi4vdXRpbHNcIik7XG5cbnZhciBfc3RvcmUgPSByZXF1aXJlKFwiLi9zdG9yZVwiKTtcblxudmFyIHF1ZXVlID0gbmV3IF9wUXVldWUuZGVmYXVsdCh7XG4gIGNvbmN1cnJlbmN5OiAxXG59KTtcblxudmFyIENhY2hlID1cbi8qI19fUFVSRV9fKi9cbmZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gQ2FjaGUoc3RvcmVOYW1lLCBjb2xsZWN0aW9uTmFtZSkge1xuICAgICgwLCBfY2xhc3NDYWxsQ2hlY2syLmRlZmF1bHQpKHRoaXMsIENhY2hlKTtcbiAgICB0aGlzLnN0b3JlTmFtZSA9IHN0b3JlTmFtZTtcbiAgICB0aGlzLmNvbGxlY3Rpb25OYW1lID0gY29sbGVjdGlvbk5hbWU7XG4gICAgdGhpcy5zdG9yZSA9ICgwLCBfc3RvcmUuZ2V0KSgpO1xuICB9XG5cbiAgKDAsIF9jcmVhdGVDbGFzczIuZGVmYXVsdCkoQ2FjaGUsIFt7XG4gICAga2V5OiBcImZpbmRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gZmluZChxdWVyeSkge1xuICAgICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgICAgcmV0dXJuIHF1ZXVlLmFkZChcbiAgICAgIC8qI19fUFVSRV9fKi9cbiAgICAgICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gICAgICAvKiNfX1BVUkVfXyovXG4gICAgICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7XG4gICAgICAgIHZhciBkb2NzO1xuICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yLmRlZmF1bHQud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkge1xuICAgICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7XG4gICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjtcbiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuc3RvcmUuZmluZChfdGhpcy5zdG9yZU5hbWUsIF90aGlzLmNvbGxlY3Rpb25OYW1lKTtcblxuICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgZG9jcyA9IF9jb250ZXh0LnNlbnQ7XG5cbiAgICAgICAgICAgICAgICBpZiAoIShxdWVyeSAmJiAhKHF1ZXJ5IGluc3RhbmNlb2YgX3F1ZXJ5LmRlZmF1bHQpKSkge1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDU7XG4gICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX2tpbnZleS5kZWZhdWx0KCdJbnZhbGlkIHF1ZXJ5LiBJdCBtdXN0IGJlIGFuIGluc3RhbmNlIG9mIHRoZSBRdWVyeSBjbGFzcy4nKTtcblxuICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgaWYgKCEoZG9jcy5sZW5ndGggPiAwICYmIHF1ZXJ5KSkge1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDc7XG4gICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KFwicmV0dXJuXCIsIHF1ZXJ5LnByb2Nlc3MoZG9jcykpO1xuXG4gICAgICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KFwicmV0dXJuXCIsIGRvY3MpO1xuXG4gICAgICAgICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LCBfY2FsbGVlLCB0aGlzKTtcbiAgICAgIH0pKSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImdyb3VwXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBfZ3JvdXAgPSAoMCwgX2FzeW5jVG9HZW5lcmF0b3IyLmRlZmF1bHQpKFxuICAgICAgLyojX19QVVJFX18qL1xuICAgICAgX3JlZ2VuZXJhdG9yLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlMihhZ2dyZWdhdGlvbikge1xuICAgICAgICB2YXIgZG9jcztcbiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvci5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0Mikge1xuICAgICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHtcbiAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgIGlmIChhZ2dyZWdhdGlvbiBpbnN0YW5jZW9mIF9hZ2dyZWdhdGlvbi5kZWZhdWx0KSB7XG4gICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDI7XG4gICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX2tpbnZleS5kZWZhdWx0KCdJbnZhbGlkIGFnZ3JlZ2F0aW9uLiBJdCBtdXN0IGJlIGFuIGluc3RhbmNlIG9mIHRoZSBBZ2dyZWdhdGlvbiBjbGFzcy4nKTtcblxuICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA0O1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmZpbmQoKTtcblxuICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgZG9jcyA9IF9jb250ZXh0Mi5zZW50O1xuICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KFwicmV0dXJuXCIsIGFnZ3JlZ2F0aW9uLnByb2Nlc3MoZG9jcykpO1xuXG4gICAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSwgX2NhbGxlZTIsIHRoaXMpO1xuICAgICAgfSkpO1xuXG4gICAgICBmdW5jdGlvbiBncm91cChfeCkge1xuICAgICAgICByZXR1cm4gX2dyb3VwLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBncm91cDtcbiAgICB9KClcbiAgfSwge1xuICAgIGtleTogXCJyZWR1Y2VcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gcmVkdWNlKGFnZ3JlZ2F0aW9uKSB7XG4gICAgICByZXR1cm4gdGhpcy5ncm91cChhZ2dyZWdhdGlvbik7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImNvdW50XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBfY291bnQgPSAoMCwgX2FzeW5jVG9HZW5lcmF0b3IyLmRlZmF1bHQpKFxuICAgICAgLyojX19QVVJFX18qL1xuICAgICAgX3JlZ2VuZXJhdG9yLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlMyhxdWVyeSkge1xuICAgICAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgICAgICB2YXIgZG9jcztcbiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvci5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0Mykge1xuICAgICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHtcbiAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgIGlmICghcXVlcnkpIHtcbiAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gNTtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMztcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5maW5kKHF1ZXJ5KTtcblxuICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgZG9jcyA9IF9jb250ZXh0My5zZW50O1xuICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuYWJydXB0KFwicmV0dXJuXCIsIGRvY3MubGVuZ3RoKTtcblxuICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoXCJyZXR1cm5cIiwgcXVldWUuYWRkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczIuc3RvcmUuY291bnQoX3RoaXMyLnN0b3JlTmFtZSwgX3RoaXMyLmNvbGxlY3Rpb25OYW1lKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LCBfY2FsbGVlMywgdGhpcyk7XG4gICAgICB9KSk7XG5cbiAgICAgIGZ1bmN0aW9uIGNvdW50KF94Mikge1xuICAgICAgICByZXR1cm4gX2NvdW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBjb3VudDtcbiAgICB9KClcbiAgfSwge1xuICAgIGtleTogXCJmaW5kQnlJZFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBmaW5kQnlJZChpZCkge1xuICAgICAgdmFyIF90aGlzMyA9IHRoaXM7XG5cbiAgICAgIHJldHVybiBxdWV1ZS5hZGQoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gX3RoaXMzLnN0b3JlLmZpbmRCeUlkKF90aGlzMy5zdG9yZU5hbWUsIF90aGlzMy5jb2xsZWN0aW9uTmFtZSwgaWQpO1xuICAgICAgfSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInNhdmVcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gc2F2ZShkb2NzKSB7XG4gICAgICB2YXIgX3RoaXM0ID0gdGhpcztcblxuICAgICAgcmV0dXJuIHF1ZXVlLmFkZChcbiAgICAgIC8qI19fUFVSRV9fKi9cbiAgICAgICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gICAgICAvKiNfX1BVUkVfXyovXG4gICAgICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0KCkge1xuICAgICAgICB2YXIgZG9jc1RvU2F2ZSwgc2luZ3VsYXI7XG4gICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3IuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWU0JChfY29udGV4dDQpIHtcbiAgICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDQucHJldiA9IF9jb250ZXh0NC5uZXh0KSB7XG4gICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICBkb2NzVG9TYXZlID0gZG9jcztcbiAgICAgICAgICAgICAgICBzaW5ndWxhciA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgaWYgKGRvY3MpIHtcbiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gNDtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KFwicmV0dXJuXCIsIG51bGwpO1xuXG4gICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoZG9jcykpIHtcbiAgICAgICAgICAgICAgICAgIHNpbmd1bGFyID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgIGRvY3NUb1NhdmUgPSBbZG9jc107XG4gICAgICAgICAgICAgICAgfSAvLyBDbG9uZSB0aGUgZG9jc1xuXG5cbiAgICAgICAgICAgICAgICBkb2NzVG9TYXZlID0gZG9jc1RvU2F2ZS5zbGljZSgwLCBkb2NzVG9TYXZlLmxlbmd0aCk7IC8vIFNhdmUgdGhlIGRvY3NcblxuICAgICAgICAgICAgICAgIGlmICghKGRvY3NUb1NhdmUubGVuZ3RoID4gMCkpIHtcbiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMTE7XG4gICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBkb2NzVG9TYXZlID0gZG9jc1RvU2F2ZS5tYXAoZnVuY3Rpb24gKGRvYykge1xuICAgICAgICAgICAgICAgICAgaWYgKCFkb2MuX2lkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCB7XG4gICAgICAgICAgICAgICAgICAgICAgX2lkOiAoMCwgX3V0aWxzLmdlbmVyYXRlSWQpKCksXG4gICAgICAgICAgICAgICAgICAgICAgX2ttZDogT2JqZWN0LmFzc2lnbih7fSwgZG9jLl9rbWQsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgfSwgZG9jKTtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgcmV0dXJuIGRvYztcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDEwO1xuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczQuc3RvcmUuc2F2ZShfdGhpczQuc3RvcmVOYW1lLCBfdGhpczQuY29sbGVjdGlvbk5hbWUsIGRvY3NUb1NhdmUpO1xuXG4gICAgICAgICAgICAgIGNhc2UgMTA6XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5hYnJ1cHQoXCJyZXR1cm5cIiwgc2luZ3VsYXIgPyBkb2NzVG9TYXZlLnNoaWZ0KCkgOiBkb2NzVG9TYXZlKTtcblxuICAgICAgICAgICAgICBjYXNlIDExOlxuICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KFwicmV0dXJuXCIsIGRvY3MpO1xuXG4gICAgICAgICAgICAgIGNhc2UgMTI6XG4gICAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sIF9jYWxsZWU0LCB0aGlzKTtcbiAgICAgIH0pKSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInJlbW92ZVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgX3JlbW92ZSA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gICAgICAvKiNfX1BVUkVfXyovXG4gICAgICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU1KHF1ZXJ5KSB7XG4gICAgICAgIHZhciBfdGhpczUgPSB0aGlzO1xuXG4gICAgICAgIHZhciBkb2NzLCByZXN1bHRzO1xuICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yLmRlZmF1bHQud3JhcChmdW5jdGlvbiBfY2FsbGVlNSQoX2NvbnRleHQ1KSB7XG4gICAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ1LnByZXYgPSBfY29udGV4dDUubmV4dCkge1xuICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSAyO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmZpbmQocXVlcnkpO1xuXG4gICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICBkb2NzID0gX2NvbnRleHQ1LnNlbnQ7XG5cbiAgICAgICAgICAgICAgICBpZiAoIXF1ZXJ5KSB7XG4gICAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDg7XG4gICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDY7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKGRvY3MubWFwKGZ1bmN0aW9uIChkb2MpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczUucmVtb3ZlQnlJZChkb2MuX2lkKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgICAgIHJlc3VsdHMgPSBfY29udGV4dDUuc2VudDtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LmFicnVwdChcInJldHVyblwiLCByZXN1bHRzLnJlZHVjZShmdW5jdGlvbiAodG90YWxDb3VudCwgY291bnQpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiB0b3RhbENvdW50ICsgY291bnQ7XG4gICAgICAgICAgICAgICAgfSwgMCkpO1xuXG4gICAgICAgICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDEwO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNsZWFyKCk7XG5cbiAgICAgICAgICAgICAgY2FzZSAxMDpcbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LmFicnVwdChcInJldHVyblwiLCBkb2NzLmxlbmd0aCk7XG5cbiAgICAgICAgICAgICAgY2FzZSAxMTpcbiAgICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuc3RvcCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSwgX2NhbGxlZTUsIHRoaXMpO1xuICAgICAgfSkpO1xuXG4gICAgICBmdW5jdGlvbiByZW1vdmUoX3gzKSB7XG4gICAgICAgIHJldHVybiBfcmVtb3ZlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiByZW1vdmU7XG4gICAgfSgpXG4gIH0sIHtcbiAgICBrZXk6IFwicmVtb3ZlQnlJZFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVCeUlkKGlkKSB7XG4gICAgICB2YXIgX3RoaXM2ID0gdGhpcztcblxuICAgICAgcmV0dXJuIHF1ZXVlLmFkZChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBfdGhpczYuc3RvcmUucmVtb3ZlQnlJZChfdGhpczYuc3RvcmVOYW1lLCBfdGhpczYuY29sbGVjdGlvbk5hbWUsIGlkKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJjbGVhclwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBjbGVhcigpIHtcbiAgICAgIHZhciBfdGhpczcgPSB0aGlzO1xuXG4gICAgICByZXR1cm4gcXVldWUuYWRkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIF90aGlzNy5zdG9yZS5jbGVhcihfdGhpczcuc3RvcmVOYW1lLCBfdGhpczcuY29sbGVjdGlvbk5hbWUpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XSk7XG4gIHJldHVybiBDYWNoZTtcbn0oKTtcblxuZXhwb3J0cy5DYWNoZSA9IENhY2hlO1xuXG5mdW5jdGlvbiBjbGVhcihzdG9yZU5hbWUpIHtcbiAgdmFyIHN0b3JlID0gKDAsIF9zdG9yZS5nZXQpKCk7XG4gIHJldHVybiBxdWV1ZS5hZGQoZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBzdG9yZS5jbGVhckFsbChzdG9yZU5hbWUpO1xuICB9KTtcbn0iLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmZpbmQgPSBmaW5kO1xuZXhwb3J0cy5jb3VudCA9IGNvdW50O1xuZXhwb3J0cy5maW5kQnlJZCA9IGZpbmRCeUlkO1xuZXhwb3J0cy5zYXZlID0gc2F2ZTtcbmV4cG9ydHMucmVtb3ZlQnlJZCA9IHJlbW92ZUJ5SWQ7XG5leHBvcnRzLmNsZWFyID0gY2xlYXI7XG5leHBvcnRzLmNsZWFyQWxsID0gY2xlYXJBbGw7XG5cbnZhciBfcmVnZW5lcmF0b3IgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9yZWdlbmVyYXRvclwiKSk7XG5cbnZhciBfYXN5bmNUb0dlbmVyYXRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2FzeW5jVG9HZW5lcmF0b3JcIikpO1xuXG52YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2tcIikpO1xuXG52YXIgX2NyZWF0ZUNsYXNzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3NcIikpO1xuXG52YXIgREJfQ0FDSEUgPSB7fTtcbnZhciBJbmRleGVkREJUcmFuc2FjdGlvbk1vZGUgPSB7XG4gIHJlYWRXcml0ZTogJ3JlYWR3cml0ZScsXG4gIHJlYWRPbmx5OiAncmVhZG9ubHknXG59O1xuXG52YXIgSW5kZXhlZERCID1cbi8qI19fUFVSRV9fKi9cbmZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gSW5kZXhlZERCKGRiTmFtZSkge1xuICAgICgwLCBfY2xhc3NDYWxsQ2hlY2syLmRlZmF1bHQpKHRoaXMsIEluZGV4ZWREQik7XG4gICAgdGhpcy5kYk5hbWUgPSBkYk5hbWU7XG4gICAgdGhpcy5kYiA9IERCX0NBQ0hFW3RoaXMuZGJOYW1lXTtcbiAgICB0aGlzLmluVHJhbnNhY3Rpb24gPSBmYWxzZTtcbiAgICB0aGlzLnF1ZXVlID0gW107XG4gIH1cblxuICAoMCwgX2NyZWF0ZUNsYXNzMi5kZWZhdWx0KShJbmRleGVkREIsIFt7XG4gICAga2V5OiBcImhhc09iamVjdFN0b3JlXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGhhc09iamVjdFN0b3JlKG9iamVjdFN0b3JlTmFtZSkge1xuICAgICAgaWYgKHRoaXMuZGIgJiYgdGhpcy5kYi5vYmplY3RTdG9yZU5hbWUpIHtcbiAgICAgICAgcmV0dXJuIHR5cGVvZiB0aGlzLmRiLm9iamVjdFN0b3JlTmFtZXMuY29udGFpbnMgPT09ICdmdW5jdGlvbicgPyB0aGlzLmRiLm9iamVjdFN0b3JlTmFtZXMuY29udGFpbnMob2JqZWN0U3RvcmVOYW1lKSA6IHRoaXMuZGIub2JqZWN0U3RvcmVOYW1lcy5pbmRleE9mKG9iamVjdFN0b3JlTmFtZSkgIT09IC0xO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIm9wZW5UcmFuc2FjdGlvblwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBvcGVuVHJhbnNhY3Rpb24ob2JqZWN0U3RvcmVOYW1lKSB7XG4gICAgICB2YXIgbW9kZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogSW5kZXhlZERCVHJhbnNhY3Rpb25Nb2RlLnJlYWRPbmx5O1xuICAgICAgdmFyIHR4biA9IHRoaXMuZGIudHJhbnNhY3Rpb24ob2JqZWN0U3RvcmVOYW1lLCBtb2RlKTtcblxuICAgICAgaWYgKCF0eG4pIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVW5hYmxlIHRvIG9wZW4gYSB0cmFuc2FjdGlvbiBmb3IgXCIuY29uY2F0KG9iamVjdFN0b3JlTmFtZSwgXCIgY29sbGVjdGlvbiBvbiB0aGUgXCIpLmNvbmNhdCh0aGlzLmRiTmFtZSwgXCIgSW5kZXhlZERCIGRhdGFiYXNlLlwiKSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0eG47XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIm9wZW5EQlwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBvcGVuREIoKSB7XG4gICAgICB2YXIgaW5kZXhlZERCID0gd2luZG93LmluZGV4ZWREQiB8fCB3aW5kb3cud2Via2l0SW5kZXhlZERCIHx8IHdpbmRvdy5tb3pJbmRleGVkREIgfHwgd2luZG93Lm1zSW5kZXhlZERCO1xuXG4gICAgICBpZiAodGhpcy5kYikge1xuICAgICAgICB2YXIgdmVyc2lvbiA9IHRoaXMuZGIudmVyc2lvbiArIDE7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgcmV0dXJuIGluZGV4ZWREQi5vcGVuKHRoaXMuZGJOYW1lLCB2ZXJzaW9uKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGluZGV4ZWREQi5vcGVuKHRoaXMuZGJOYW1lKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwib3BlblwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBvcGVuKG9iamVjdFN0b3JlTmFtZSkge1xuICAgICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgICAgdmFyIHdyaXRlID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBmYWxzZTtcbiAgICAgIHZhciBzdWNjZXNzID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgPyBhcmd1bWVudHNbMl0gOiB1bmRlZmluZWQ7XG4gICAgICB2YXIgZXJyb3IgPSBhcmd1bWVudHMubGVuZ3RoID4gMyA/IGFyZ3VtZW50c1szXSA6IHVuZGVmaW5lZDtcbiAgICAgIHZhciBmb3JjZSA9IGFyZ3VtZW50cy5sZW5ndGggPiA0ICYmIGFyZ3VtZW50c1s0XSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzRdIDogZmFsc2U7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGlmICh0aGlzLmRiKSB7XG4gICAgICAgICAgaWYgKHRoaXMuZGIub2JqZWN0U3RvcmVOYW1lcy5jb250YWlucyhvYmplY3RTdG9yZU5hbWUpKSB7XG4gICAgICAgICAgICB2YXIgbW9kZSA9IHdyaXRlID8gSW5kZXhlZERCVHJhbnNhY3Rpb25Nb2RlLnJlYWRXcml0ZSA6IEluZGV4ZWREQlRyYW5zYWN0aW9uTW9kZS5yZWFkT25seTtcbiAgICAgICAgICAgIHJldHVybiBzdWNjZXNzKHRoaXMub3BlblRyYW5zYWN0aW9uKG9iamVjdFN0b3JlTmFtZSwgbW9kZSkpO1xuICAgICAgICAgIH0gZWxzZSBpZiAoIXdyaXRlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUaGUgXCIuY29uY2F0KG9iamVjdFN0b3JlTmFtZSwgXCIgY29sbGVjdGlvbiB3YXMgbm90IGZvdW5kIG9uIHRoZSBcIikuY29uY2F0KHRoaXMuZGJOYW1lLCBcIiBJbmRleGVkREIgZGF0YWJhc2UuXCIpKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWZvcmNlICYmIHRoaXMuaW5UcmFuc2FjdGlvbikge1xuICAgICAgICAgIHJldHVybiB0aGlzLnF1ZXVlLnB1c2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzLm9wZW4ob2JqZWN0U3RvcmVOYW1lLCB3cml0ZSwgc3VjY2VzcywgZXJyb3IpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5pblRyYW5zYWN0aW9uID0gdHJ1ZTtcbiAgICAgICAgdmFyIHJlcXVlc3QgPSB0aGlzLm9wZW5EQihvYmplY3RTdG9yZU5hbWUpOyAvLyBJZiB0aGUgZGF0YWJhc2UgaXMgb3BlbmVkIHdpdGggYW4gaGlnaGVyIHZlcnNpb24gdGhhbiBpdHMgY3VycmVudCwgdGhlXG4gICAgICAgIC8vIGB1cGdyYWRlbmVlZGVkYCBldmVudCBpcyBmaXJlZC4gU2F2ZSB0aGUgaGFuZGxlIHRvIHRoZSBkYXRhYmFzZSwgYW5kXG4gICAgICAgIC8vIGNyZWF0ZSB0aGUgY29sbGVjdGlvbi5cblxuICAgICAgICByZXF1ZXN0Lm9udXBncmFkZW5lZWRlZCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgX3RoaXMuZGIgPSBlLnRhcmdldC5yZXN1bHQ7XG5cbiAgICAgICAgICBpZiAod3JpdGUgJiYgIV90aGlzLmRiLm9iamVjdFN0b3JlTmFtZXMuY29udGFpbnMob2JqZWN0U3RvcmVOYW1lKSkge1xuICAgICAgICAgICAgX3RoaXMuZGIuY3JlYXRlT2JqZWN0U3RvcmUob2JqZWN0U3RvcmVOYW1lLCB7XG4gICAgICAgICAgICAgIGtleVBhdGg6ICdfaWQnXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH07IC8vIFRoZSBgc3VjY2Vzc2AgZXZlbnQgaXMgZmlyZWQgYWZ0ZXIgYHVwZ3JhZGVuZWVkZWRgIHRlcm1pbmF0ZXMuXG4gICAgICAgIC8vIFNhdmUgdGhlIGhhbmRsZSB0byB0aGUgZGF0YWJhc2UuXG5cblxuICAgICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgX3RoaXMuZGIgPSBlLnRhcmdldC5yZXN1bHQ7IC8vIElmIGEgc2Vjb25kIGluc3RhbmNlIG9mIHRoZSBzYW1lIEluZGV4ZWREQiBkYXRhYmFzZSBwZXJmb3JtcyBhblxuICAgICAgICAgIC8vIHVwZ3JhZGUgb3BlcmF0aW9uLCB0aGUgYHZlcnNpb25jaGFuZ2VgIGV2ZW50IGlzIGZpcmVkLiBUaGVuLCBjbG9zZSB0aGVcbiAgICAgICAgICAvLyBkYXRhYmFzZSB0byBhbGxvdyB0aGUgZXh0ZXJuYWwgdXBncmFkZSB0byBwcm9jZWVkLlxuXG4gICAgICAgICAgX3RoaXMuZGIub252ZXJzaW9uY2hhbmdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzLmNsb3NlKCk7XG4gICAgICAgICAgfTsgLy8gVHJ5IHRvIG9idGFpbiB0aGUgY29sbGVjdGlvbiBoYW5kbGUgYnkgcmVjdXJzaW5nLiBBcHBlbmQgdGhlIGhhbmRsZXJzXG4gICAgICAgICAgLy8gdG8gZW1wdHkgdGhlIHF1ZXVlIHVwb24gc3VjY2VzcyBhbmQgZmFpbHVyZS4gU2V0IHRoZSBgZm9yY2VgIGZsYWcgc29cbiAgICAgICAgICAvLyBhbGwgYnV0IHRoZSBjdXJyZW50IHRyYW5zYWN0aW9uIHJlbWFpbiBxdWV1ZWQuXG5cblxuICAgICAgICAgIHZhciB3cmFwID0gZnVuY3Rpb24gd3JhcChkb25lKSB7XG4gICAgICAgICAgICB2YXIgY2FsbGJhY2tGbiA9IGZ1bmN0aW9uIGNhbGxiYWNrRm4oYXJnKSB7XG4gICAgICAgICAgICAgIGRvbmUoYXJnKTsgLy8gU3dpdGNoIGZsYWdcblxuICAgICAgICAgICAgICBfdGhpcy5pblRyYW5zYWN0aW9uID0gZmFsc2U7IC8vIFRoZSBkYXRhYmFzZSBoYW5kbGUgaGFzIGJlZW4gZXN0YWJsaXNoZWQsIHdlIGNhbiBub3cgc2FmZWx5IGVtcHR5XG4gICAgICAgICAgICAgIC8vIHRoZSBxdWV1ZS4gVGhlIHF1ZXVlIG11c3QgYmUgZW1wdGllZCBiZWZvcmUgaW52b2tpbmcgdGhlIGNvbmN1cnJlbnRcbiAgICAgICAgICAgICAgLy8gb3BlcmF0aW9ucyB0byBhdm9pZCBpbmZpbml0ZSByZWN1cnNpb24uXG5cbiAgICAgICAgICAgICAgaWYgKF90aGlzLnF1ZXVlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICB2YXIgcGVuZGluZyA9IF90aGlzLnF1ZXVlO1xuICAgICAgICAgICAgICAgIF90aGlzLnF1ZXVlID0gW107XG4gICAgICAgICAgICAgICAgcGVuZGluZy5mb3JFYWNoKGZ1bmN0aW9uIChmbikge1xuICAgICAgICAgICAgICAgICAgZm4uY2FsbChfdGhpcyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHJldHVybiBjYWxsYmFja0ZuO1xuICAgICAgICAgIH07XG5cbiAgICAgICAgICByZXR1cm4gX3RoaXMub3BlbihvYmplY3RTdG9yZU5hbWUsIHdyaXRlLCB3cmFwKHN1Y2Nlc3MpLCB3cmFwKGVycm9yKSwgdHJ1ZSk7XG4gICAgICAgIH07IC8vIFRoZSBgYmxvY2tlZGAgZXZlbnQgaXMgbm90IGhhbmRsZWQuIEluIGNhc2Ugc3VjaCBhbiBldmVudCBvY2N1cnMsIGl0XG4gICAgICAgIC8vIHdpbGwgcmVzb2x2ZSBpdHNlbGYgc2luY2UgdGhlIGB2ZXJzaW9uY2hhbmdlYCBldmVudCBoYW5kbGVyIHdpbGwgY2xvc2VcbiAgICAgICAgLy8gdGhlIGNvbmZsaWN0aW5nIGRhdGFiYXNlIGFuZCBlbmFibGUgdGhlIGBibG9ja2VkYCBldmVudCB0byBjb250aW51ZS5cblxuXG4gICAgICAgIHJlcXVlc3Qub25ibG9ja2VkID0gZnVuY3Rpb24gKCkge307IC8vIEhhbmRsZSBlcnJvcnNcblxuXG4gICAgICAgIHJlcXVlc3Qub25lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgZXJyb3IobmV3IEVycm9yKFwiVW5hYmxlIHRvIG9wZW4gdGhlIFwiLmNvbmNhdChfdGhpcy5kYk5hbWUsIFwiIEluZGV4ZWREQiBkYXRhYmFzZS4gXCIpLmNvbmNhdChlLnRhcmdldC5lcnJvci5tZXNzYWdlLCBcIi5cIikpKTtcbiAgICAgICAgfTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgZXJyb3IoZSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJjbG9zZVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBjbG9zZSgpIHtcbiAgICAgIGlmICh0aGlzLmRiKSB7XG4gICAgICAgIHRoaXMuZGIuY2xvc2UoKTtcbiAgICAgICAgdGhpcy5kYiA9IG51bGw7XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImRiXCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fZGI7XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uIHNldChkYikge1xuICAgICAgaWYgKGRiKSB7XG4gICAgICAgIHRoaXMuX2RiID0gZGI7XG4gICAgICAgIERCX0NBQ0hFW3RoaXMuZGJOYW1lXSA9IGRiO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fZGIgPSBudWxsO1xuICAgICAgICBkZWxldGUgREJfQ0FDSEVbdGhpcy5kYk5hbWVdO1xuICAgICAgfVxuICAgIH1cbiAgfV0pO1xuICByZXR1cm4gSW5kZXhlZERCO1xufSgpO1xuXG5mdW5jdGlvbiBmaW5kKGRiTmFtZSwgb2JqZWN0U3RvcmVOYW1lKSB7XG4gIHZhciBkYiA9IG5ldyBJbmRleGVkREIoZGJOYW1lKTtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICBkYi5vcGVuKG9iamVjdFN0b3JlTmFtZSwgZmFsc2UsIGZ1bmN0aW9uICh0eG4pIHtcbiAgICAgIHZhciBzdG9yZSA9IHR4bi5vYmplY3RTdG9yZShvYmplY3RTdG9yZU5hbWUpO1xuICAgICAgdmFyIHJlcXVlc3QgPSBzdG9yZS5vcGVuQ3Vyc29yKCk7XG4gICAgICB2YXIgZG9jcyA9IFtdO1xuXG4gICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHZhciBjdXJzb3IgPSBlLnRhcmdldC5yZXN1bHQ7XG5cbiAgICAgICAgaWYgKGN1cnNvcikge1xuICAgICAgICAgIGRvY3MucHVzaChjdXJzb3IudmFsdWUpO1xuICAgICAgICAgIHJldHVybiBjdXJzb3IuY29udGludWUoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiByZXNvbHZlKGRvY3MpO1xuICAgICAgfTtcblxuICAgICAgcmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgcmVqZWN0KGUudGFyZ2V0LmVycm9yKTtcbiAgICAgIH07XG4gICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICBpZiAoZXJyb3IubWVzc2FnZS5pbmRleE9mKCdub3QgZm91bmQnKSAhPT0gLTEpIHtcbiAgICAgICAgcmVzb2x2ZShbXSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gY291bnQoX3gsIF94Mikge1xuICByZXR1cm4gX2NvdW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5cbmZ1bmN0aW9uIF9jb3VudCgpIHtcbiAgX2NvdW50ID0gKDAsIF9hc3luY1RvR2VuZXJhdG9yMi5kZWZhdWx0KShcbiAgLyojX19QVVJFX18qL1xuICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoZGJOYW1lLCBvYmplY3RTdG9yZU5hbWUpIHtcbiAgICB2YXIgZGI7XG4gICAgcmV0dXJuIF9yZWdlbmVyYXRvci5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHtcbiAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHtcbiAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICBkYiA9IG5ldyBJbmRleGVkREIoZGJOYW1lKTtcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoXCJyZXR1cm5cIiwgbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICBkYi5vcGVuKG9iamVjdFN0b3JlTmFtZSwgZmFsc2UsIGZ1bmN0aW9uICh0eG4pIHtcbiAgICAgICAgICAgICAgICB2YXIgc3RvcmUgPSB0eG4ub2JqZWN0U3RvcmUob2JqZWN0U3RvcmVOYW1lKTtcbiAgICAgICAgICAgICAgICB2YXIgcmVxdWVzdCA9IHN0b3JlLmNvdW50KCk7XG5cbiAgICAgICAgICAgICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiByZXNvbHZlKHJlcXVlc3QucmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgcmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiByZWplY3QoZS50YXJnZXQuZXJyb3IpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGlmIChlcnJvci5tZXNzYWdlLmluZGV4T2YoJ25vdCBmb3VuZCcpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgwKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LCBfY2FsbGVlLCB0aGlzKTtcbiAgfSkpO1xuICByZXR1cm4gX2NvdW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5cbmZ1bmN0aW9uIGZpbmRCeUlkKGRiTmFtZSwgb2JqZWN0U3RvcmVOYW1lLCBpZCkge1xuICB2YXIgZGIgPSBuZXcgSW5kZXhlZERCKGRiTmFtZSk7XG4gIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgZGIub3BlbihvYmplY3RTdG9yZU5hbWUsIGZhbHNlLCBmdW5jdGlvbiAodHhuKSB7XG4gICAgICB2YXIgc3RvcmUgPSB0eG4ub2JqZWN0U3RvcmUob2JqZWN0U3RvcmVOYW1lKTtcbiAgICAgIHZhciByZXF1ZXN0ID0gc3RvcmUuZ2V0KGlkKTtcblxuICAgICAgcmVxdWVzdC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICByZXNvbHZlKGUudGFyZ2V0LnJlc3VsdCk7XG4gICAgICB9O1xuXG4gICAgICByZXF1ZXN0Lm9uZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICByZWplY3QoZS50YXJnZXQuZXJyb3IpO1xuICAgICAgfTtcbiAgICB9LCByZWplY3QpO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gc2F2ZShfeDMsIF94NCkge1xuICByZXR1cm4gX3NhdmUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cblxuZnVuY3Rpb24gX3NhdmUoKSB7XG4gIF9zYXZlID0gKDAsIF9hc3luY1RvR2VuZXJhdG9yMi5kZWZhdWx0KShcbiAgLyojX19QVVJFX18qL1xuICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKGRiTmFtZSwgb2JqZWN0U3RvcmVOYW1lKSB7XG4gICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICB2YXIgZG9jcyxcbiAgICAgICAgZGIsXG4gICAgICAgIF9hcmdzMiA9IGFyZ3VtZW50cztcbiAgICByZXR1cm4gX3JlZ2VuZXJhdG9yLmRlZmF1bHQud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7XG4gICAgICB3aGlsZSAoMSkge1xuICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHtcbiAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICBkb2NzID0gX2FyZ3MyLmxlbmd0aCA+IDIgJiYgX2FyZ3MyWzJdICE9PSB1bmRlZmluZWQgPyBfYXJnczJbMl0gOiBbXTtcbiAgICAgICAgICAgIGRiID0gbmV3IEluZGV4ZWREQihkYk5hbWUpO1xuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoXCJyZXR1cm5cIiwgbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICBkYi5vcGVuKG9iamVjdFN0b3JlTmFtZSwgdHJ1ZSwgZnVuY3Rpb24gKHR4bikge1xuICAgICAgICAgICAgICAgIHZhciBzdG9yZSA9IHR4bi5vYmplY3RTdG9yZShvYmplY3RTdG9yZU5hbWUpO1xuICAgICAgICAgICAgICAgIHZhciBkb2NzVG9TYXZlID0gZG9jcztcblxuICAgICAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheShkb2NzKSkge1xuICAgICAgICAgICAgICAgICAgZG9jc1RvU2F2ZSA9IFtkb2NzXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBkb2NzVG9TYXZlLmZvckVhY2goZnVuY3Rpb24gKGRvYykge1xuICAgICAgICAgICAgICAgICAgc3RvcmUucHV0KGRvYyk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0eG4ub25jb21wbGV0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgIHJlc29sdmUoZG9jcyk7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHR4bi5vbmVycm9yID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoXCJBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSBzYXZpbmcgdGhlIGVudGl0aWVzIHRvIHRoZSBcIi5jb25jYXQob2JqZWN0U3RvcmVOYW1lLCBcIiBjb2xsZWN0aW9uIG9uIHRoZSBcIikuY29uY2F0KF90aGlzMi5kYk5hbWUsIFwiIEluZGV4ZWREQiBkYXRhYmFzZS4gXCIpLmNvbmNhdChlLnRhcmdldC5lcnJvci5tZXNzYWdlLCBcIi5cIikpKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICB9LCByZWplY3QpO1xuICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwgX2NhbGxlZTIsIHRoaXMpO1xuICB9KSk7XG4gIHJldHVybiBfc2F2ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuXG5mdW5jdGlvbiByZW1vdmVCeUlkKF94NSwgX3g2LCBfeDcpIHtcbiAgcmV0dXJuIF9yZW1vdmVCeUlkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5cbmZ1bmN0aW9uIF9yZW1vdmVCeUlkKCkge1xuICBfcmVtb3ZlQnlJZCA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gIC8qI19fUFVSRV9fKi9cbiAgX3JlZ2VuZXJhdG9yLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlMyhkYk5hbWUsIG9iamVjdFN0b3JlTmFtZSwgaWQpIHtcbiAgICB2YXIgX3RoaXMzID0gdGhpcztcblxuICAgIHZhciBkYjtcbiAgICByZXR1cm4gX3JlZ2VuZXJhdG9yLmRlZmF1bHQud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7XG4gICAgICB3aGlsZSAoMSkge1xuICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHtcbiAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICBkYiA9IG5ldyBJbmRleGVkREIoZGJOYW1lKTtcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuYWJydXB0KFwicmV0dXJuXCIsIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgZGIub3BlbihvYmplY3RTdG9yZU5hbWUsIHRydWUsIGZ1bmN0aW9uICh0eG4pIHtcbiAgICAgICAgICAgICAgICB2YXIgc3RvcmUgPSB0eG4ub2JqZWN0U3RvcmUob2JqZWN0U3RvcmVOYW1lKTtcbiAgICAgICAgICAgICAgICB2YXIgcmVxdWVzdCA9IHN0b3JlLmdldChpZCk7XG4gICAgICAgICAgICAgICAgc3RvcmUuZGVsZXRlKGlkKTtcblxuICAgICAgICAgICAgICAgIHR4bi5vbmNvbXBsZXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgdmFyIGRvYyA9IHJlcXVlc3QucmVzdWx0O1xuXG4gICAgICAgICAgICAgICAgICBpZiAoZG9jKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoMSk7XG4gICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QobmV3IEVycm9yKFwiQW4gZW50aXR5IHdpdGggX2lkID0gXCIuY29uY2F0KGlkLCBcIiB3YXMgbm90IGZvdW5kIGluIHRoZSBcIikuY29uY2F0KG9iamVjdFN0b3JlTmFtZSwgXCIgY29sbGVjdGlvbiBvbiB0aGUgXCIpLmNvbmNhdChfdGhpczMuZGJOYW1lLCBcIiBkYXRhYmFzZS5cIikpKTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgdHhuLm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICByZWplY3QobmV3IEVycm9yKFwiQW4gZW50aXR5IHdpdGggX2lkID0gXCIuY29uY2F0KGlkLCBcIiB3YXMgbm90IGZvdW5kIGluIHRoZSBcIikuY29uY2F0KG9iamVjdFN0b3JlTmFtZSwgXCIgY29sbGVjdGlvbiBvbiB0aGUgXCIpLmNvbmNhdChfdGhpczMuZGJOYW1lLCBcIiBkYXRhYmFzZS5cIikpKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICB9LCByZWplY3QpO1xuICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwgX2NhbGxlZTMsIHRoaXMpO1xuICB9KSk7XG4gIHJldHVybiBfcmVtb3ZlQnlJZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuXG5mdW5jdGlvbiBjbGVhcihfeDgsIF94OSkge1xuICByZXR1cm4gX2NsZWFyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5cbmZ1bmN0aW9uIF9jbGVhcigpIHtcbiAgX2NsZWFyID0gKDAsIF9hc3luY1RvR2VuZXJhdG9yMi5kZWZhdWx0KShcbiAgLyojX19QVVJFX18qL1xuICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0KGRiTmFtZSwgb2JqZWN0U3RvcmVOYW1lKSB7XG4gICAgdmFyIGRiO1xuICAgIHJldHVybiBfcmVnZW5lcmF0b3IuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWU0JChfY29udGV4dDQpIHtcbiAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgIHN3aXRjaCAoX2NvbnRleHQ0LnByZXYgPSBfY29udGV4dDQubmV4dCkge1xuICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIGRiID0gbmV3IEluZGV4ZWREQihkYk5hbWUpO1xuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5hYnJ1cHQoXCJyZXR1cm5cIiwgbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICBkYi5vcGVuKG9iamVjdFN0b3JlTmFtZSwgdHJ1ZSwgZnVuY3Rpb24gKHR4bikge1xuICAgICAgICAgICAgICAgIHZhciBvYmplY3RTdG9yZSA9IHR4bi5vYmplY3RTdG9yZShvYmplY3RTdG9yZU5hbWUpO1xuICAgICAgICAgICAgICAgIG9iamVjdFN0b3JlLmNsZWFyKCk7XG5cbiAgICAgICAgICAgICAgICB0eG4ub25jb21wbGV0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiByZXNvbHZlKHRydWUpO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB0eG4ub25lcnJvciA9IGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICB9LCByZWplY3QpO1xuICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuc3RvcCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwgX2NhbGxlZTQsIHRoaXMpO1xuICB9KSk7XG4gIHJldHVybiBfY2xlYXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cblxuZnVuY3Rpb24gY2xlYXJBbGwoZGJOYW1lKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgdmFyIGluZGV4ZWREQiA9IHdpbmRvdy5pbmRleGVkREIgfHwgd2luZG93LndlYmtpdEluZGV4ZWREQiB8fCB3aW5kb3cubW96SW5kZXhlZERCIHx8IHdpbmRvdy5tc0luZGV4ZWREQjtcbiAgICB2YXIgcmVxdWVzdCA9IGluZGV4ZWREQi5kZWxldGVEYXRhYmFzZShkYk5hbWUpO1xuXG4gICAgcmVxdWVzdC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBkZWxldGUgREJfQ0FDSEVbZGJOYW1lXTtcbiAgICAgIHJlc29sdmUodHJ1ZSk7XG4gICAgfTtcblxuICAgIHJlcXVlc3Qub25lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICByZWplY3QobmV3IEVycm9yKFwiQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgY2xlYXJpbmcgdGhlIFwiLmNvbmNhdChkYk5hbWUsIFwiIEluZGV4ZWREQiBkYXRhYmFzZS4gXCIpLmNvbmNhdChlLnRhcmdldC5lcnJvci5tZXNzYWdlLCBcIi5cIikpKTtcbiAgICB9O1xuXG4gICAgcmVxdWVzdC5vbmJsb2NrZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZWplY3QobmV3IEVycm9yKFwiVGhlIFwiLmNvbmNhdChkYk5hbWUsIFwiIEluZGV4ZWREQiBkYXRhYmFzZSBjb3VsZCBub3QgYmUgY2xlYXJlZCBkdWUgdG8gdGhlIG9wZXJhdGlvbiBiZWluZyBibG9ja2VkLlwiKSkpO1xuICAgIH07XG4gIH0pO1xufSIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZmluZCA9IGZpbmQ7XG5leHBvcnRzLmNvdW50ID0gY291bnQ7XG5leHBvcnRzLmZpbmRCeUlkID0gZmluZEJ5SWQ7XG5leHBvcnRzLnNhdmUgPSBzYXZlO1xuZXhwb3J0cy5yZW1vdmVCeUlkID0gcmVtb3ZlQnlJZDtcbmV4cG9ydHMuY2xlYXIgPSBjbGVhcjtcbmV4cG9ydHMuY2xlYXJBbGwgPSBjbGVhckFsbDtcblxudmFyIF9yZWdlbmVyYXRvciA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL3JlZ2VuZXJhdG9yXCIpKTtcblxudmFyIF9hc3luY1RvR2VuZXJhdG9yMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXN5bmNUb0dlbmVyYXRvclwiKSk7XG5cbnZhciBfbG9raWpzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwibG9raWpzXCIpKTtcblxudmFyIG1lbUFkYXB0ZXIgPSBuZXcgX2xva2lqcy5kZWZhdWx0Lkxva2lNZW1vcnlBZGFwdGVyKCk7XG5cbmZ1bmN0aW9uIG9wZW4oZGJOYW1lLCBjb2xsZWN0aW9uTmFtZSkge1xuICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgIHZhciBkYiA9IG5ldyBfbG9raWpzLmRlZmF1bHQoZGJOYW1lLCB7XG4gICAgICBhZGFwdGVyOiBtZW1BZGFwdGVyLFxuICAgICAgYXV0b3NhdmU6IGZhbHNlLFxuICAgICAgYXV0b2xvYWQ6IHRydWUsXG4gICAgICBhdXRvbG9hZENhbGxiYWNrOiBmdW5jdGlvbiBhdXRvbG9hZENhbGxiYWNrKGVycm9yKSB7XG4gICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKGNvbGxlY3Rpb25OYW1lKSB7XG4gICAgICAgICAgICB2YXIgY29sbGVjdGlvbiA9IGRiLmdldENvbGxlY3Rpb24oY29sbGVjdGlvbk5hbWUpO1xuXG4gICAgICAgICAgICBpZiAoIWNvbGxlY3Rpb24pIHtcbiAgICAgICAgICAgICAgY29sbGVjdGlvbiA9IGRiLmFkZENvbGxlY3Rpb24oY29sbGVjdGlvbk5hbWUsIHtcbiAgICAgICAgICAgICAgICBjbG9uZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICB1bmlxdWU6IFsnX2lkJ10sXG4gICAgICAgICAgICAgICAgZGlzYWJsZU1ldGE6IHRydWVcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmVzb2x2ZShkYik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGZpbmQoX3gsIF94Mikge1xuICByZXR1cm4gX2ZpbmQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cblxuZnVuY3Rpb24gX2ZpbmQoKSB7XG4gIF9maW5kID0gKDAsIF9hc3luY1RvR2VuZXJhdG9yMi5kZWZhdWx0KShcbiAgLyojX19QVVJFX18qL1xuICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoZGJOYW1lLCBjb2xsZWN0aW9uTmFtZSkge1xuICAgIHZhciBkYiwgY29sbGVjdGlvbjtcbiAgICByZXR1cm4gX3JlZ2VuZXJhdG9yLmRlZmF1bHQud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkge1xuICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkge1xuICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyO1xuICAgICAgICAgICAgcmV0dXJuIG9wZW4oZGJOYW1lLCBjb2xsZWN0aW9uTmFtZSk7XG5cbiAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICBkYiA9IF9jb250ZXh0LnNlbnQ7XG4gICAgICAgICAgICBjb2xsZWN0aW9uID0gZGIuZ2V0Q29sbGVjdGlvbihjb2xsZWN0aW9uTmFtZSk7XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KFwicmV0dXJuXCIsIGNvbGxlY3Rpb24uY2hhaW4oKS5kYXRhKHtcbiAgICAgICAgICAgICAgcmVtb3ZlTWV0YTogdHJ1ZVxuICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LCBfY2FsbGVlLCB0aGlzKTtcbiAgfSkpO1xuICByZXR1cm4gX2ZpbmQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cblxuZnVuY3Rpb24gY291bnQoX3gzLCBfeDQpIHtcbiAgcmV0dXJuIF9jb3VudC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuXG5mdW5jdGlvbiBfY291bnQoKSB7XG4gIF9jb3VudCA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gIC8qI19fUFVSRV9fKi9cbiAgX3JlZ2VuZXJhdG9yLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlMihkYk5hbWUsIGNvbGxlY3Rpb25OYW1lKSB7XG4gICAgdmFyIGRvY3M7XG4gICAgcmV0dXJuIF9yZWdlbmVyYXRvci5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0Mikge1xuICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7XG4gICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAyO1xuICAgICAgICAgICAgcmV0dXJuIGZpbmQoZGJOYW1lLCBjb2xsZWN0aW9uTmFtZSk7XG5cbiAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICBkb2NzID0gX2NvbnRleHQyLnNlbnQ7XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdChcInJldHVyblwiLCBkb2NzLmxlbmd0aCk7XG5cbiAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LCBfY2FsbGVlMiwgdGhpcyk7XG4gIH0pKTtcbiAgcmV0dXJuIF9jb3VudC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuXG5mdW5jdGlvbiBmaW5kQnlJZChfeDUsIF94NiwgX3g3KSB7XG4gIHJldHVybiBfZmluZEJ5SWQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cblxuZnVuY3Rpb24gX2ZpbmRCeUlkKCkge1xuICBfZmluZEJ5SWQgPSAoMCwgX2FzeW5jVG9HZW5lcmF0b3IyLmRlZmF1bHQpKFxuICAvKiNfX1BVUkVfXyovXG4gIF9yZWdlbmVyYXRvci5kZWZhdWx0Lm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoZGJOYW1lLCBjb2xsZWN0aW9uTmFtZSwgaWQpIHtcbiAgICB2YXIgZGIsIGNvbGxlY3Rpb24sIGRvYztcbiAgICByZXR1cm4gX3JlZ2VuZXJhdG9yLmRlZmF1bHQud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7XG4gICAgICB3aGlsZSAoMSkge1xuICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHtcbiAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDI7XG4gICAgICAgICAgICByZXR1cm4gb3BlbihkYk5hbWUsIGNvbGxlY3Rpb25OYW1lKTtcblxuICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgIGRiID0gX2NvbnRleHQzLnNlbnQ7XG4gICAgICAgICAgICBjb2xsZWN0aW9uID0gZGIuZ2V0Q29sbGVjdGlvbihjb2xsZWN0aW9uTmFtZSk7XG4gICAgICAgICAgICBkb2MgPSBjb2xsZWN0aW9uLmJ5KCdfaWQnLCBpZCk7XG5cbiAgICAgICAgICAgIGlmIChkb2MpIHtcbiAgICAgICAgICAgICAgZGVsZXRlIGRvYy4kbG9raTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoXCJyZXR1cm5cIiwgZG9jKTtcblxuICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIF9jYWxsZWUzLCB0aGlzKTtcbiAgfSkpO1xuICByZXR1cm4gX2ZpbmRCeUlkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5cbmZ1bmN0aW9uIHNhdmUoX3g4LCBfeDksIF94MTApIHtcbiAgcmV0dXJuIF9zYXZlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5cbmZ1bmN0aW9uIF9zYXZlKCkge1xuICBfc2F2ZSA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gIC8qI19fUFVSRV9fKi9cbiAgX3JlZ2VuZXJhdG9yLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlNChkYk5hbWUsIGNvbGxlY3Rpb25OYW1lLCBkb2NzVG9TYXZlT3JVcGRhdGUpIHtcbiAgICB2YXIgZGIsIGNvbGxlY3Rpb24sIGRvY3M7XG4gICAgcmV0dXJuIF9yZWdlbmVyYXRvci5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZTQkKF9jb250ZXh0NCkge1xuICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgc3dpdGNoIChfY29udGV4dDQucHJldiA9IF9jb250ZXh0NC5uZXh0KSB7XG4gICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAyO1xuICAgICAgICAgICAgcmV0dXJuIG9wZW4oZGJOYW1lLCBjb2xsZWN0aW9uTmFtZSk7XG5cbiAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICBkYiA9IF9jb250ZXh0NC5zZW50O1xuICAgICAgICAgICAgY29sbGVjdGlvbiA9IGRiLmdldENvbGxlY3Rpb24oY29sbGVjdGlvbk5hbWUpO1xuICAgICAgICAgICAgZG9jcyA9IGRvY3NUb1NhdmVPclVwZGF0ZTtcblxuICAgICAgICAgICAgaWYgKGRvY3MpIHtcbiAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSA3O1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5hYnJ1cHQoXCJyZXR1cm5cIiwgbnVsbCk7XG5cbiAgICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICBkb2NzID0gZG9jcy5tYXAoZnVuY3Rpb24gKGRvYykge1xuICAgICAgICAgICAgICB2YXIgc2F2ZWREb2MgPSBjb2xsZWN0aW9uLmJ5KCdfaWQnLCBkb2MuX2lkKTtcblxuICAgICAgICAgICAgICBpZiAoc2F2ZWREb2MpIHtcbiAgICAgICAgICAgICAgICBzYXZlZERvYyA9IE9iamVjdC5hc3NpZ24oe1xuICAgICAgICAgICAgICAgICAgJGxva2k6IHNhdmVkRG9jLiRsb2tpXG4gICAgICAgICAgICAgICAgfSwgZG9jKTtcbiAgICAgICAgICAgICAgICBjb2xsZWN0aW9uLnVwZGF0ZShzYXZlZERvYyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNhdmVkRG9jO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgY29sbGVjdGlvbi5pbnNlcnQoZG9jKTtcbiAgICAgICAgICAgICAgcmV0dXJuIGRvYztcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5hYnJ1cHQoXCJyZXR1cm5cIiwgbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICBkYi5zYXZlKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUoZG9jcyk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgICAgY2FzZSA5OlxuICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuc3RvcCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwgX2NhbGxlZTQsIHRoaXMpO1xuICB9KSk7XG4gIHJldHVybiBfc2F2ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuXG5mdW5jdGlvbiByZW1vdmVCeUlkKF94MTEsIF94MTIsIF94MTMpIHtcbiAgcmV0dXJuIF9yZW1vdmVCeUlkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5cbmZ1bmN0aW9uIF9yZW1vdmVCeUlkKCkge1xuICBfcmVtb3ZlQnlJZCA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gIC8qI19fUFVSRV9fKi9cbiAgX3JlZ2VuZXJhdG9yLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlNShkYk5hbWUsIGNvbGxlY3Rpb25OYW1lLCBpZCkge1xuICAgIHZhciBkYiwgY29sbGVjdGlvbiwgZG9jLCByZW1vdmVkRG9jO1xuICAgIHJldHVybiBfcmVnZW5lcmF0b3IuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWU1JChfY29udGV4dDUpIHtcbiAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgIHN3aXRjaCAoX2NvbnRleHQ1LnByZXYgPSBfY29udGV4dDUubmV4dCkge1xuICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gMjtcbiAgICAgICAgICAgIHJldHVybiBvcGVuKGRiTmFtZSwgY29sbGVjdGlvbk5hbWUpO1xuXG4gICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgZGIgPSBfY29udGV4dDUuc2VudDtcbiAgICAgICAgICAgIGNvbGxlY3Rpb24gPSBkYi5nZXRDb2xsZWN0aW9uKGNvbGxlY3Rpb25OYW1lKTtcbiAgICAgICAgICAgIGRvYyA9IGNvbGxlY3Rpb24uYnkoJ19pZCcsIGlkKTtcblxuICAgICAgICAgICAgaWYgKCFkb2MpIHtcbiAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSA5O1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmVtb3ZlZERvYyA9IGNvbGxlY3Rpb24ucmVtb3ZlKGRvYyk7XG5cbiAgICAgICAgICAgIGlmICghcmVtb3ZlZERvYykge1xuICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDk7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LmFicnVwdChcInJldHVyblwiLCBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgIGRiLnNhdmUoZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZSgxKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgICBjYXNlIDk6XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LmFicnVwdChcInJldHVyblwiLCAwKTtcblxuICAgICAgICAgIGNhc2UgMTA6XG4gICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5zdG9wKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LCBfY2FsbGVlNSwgdGhpcyk7XG4gIH0pKTtcbiAgcmV0dXJuIF9yZW1vdmVCeUlkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5cbmZ1bmN0aW9uIGNsZWFyKF94MTQsIF94MTUpIHtcbiAgcmV0dXJuIF9jbGVhci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuXG5mdW5jdGlvbiBfY2xlYXIoKSB7XG4gIF9jbGVhciA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gIC8qI19fUFVSRV9fKi9cbiAgX3JlZ2VuZXJhdG9yLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlNihkYk5hbWUsIGNvbGxlY3Rpb25OYW1lKSB7XG4gICAgdmFyIGRiLCBjb2xsZWN0aW9uO1xuICAgIHJldHVybiBfcmVnZW5lcmF0b3IuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWU2JChfY29udGV4dDYpIHtcbiAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgIHN3aXRjaCAoX2NvbnRleHQ2LnByZXYgPSBfY29udGV4dDYubmV4dCkge1xuICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMjtcbiAgICAgICAgICAgIHJldHVybiBvcGVuKGRiTmFtZSwgY29sbGVjdGlvbk5hbWUpO1xuXG4gICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgZGIgPSBfY29udGV4dDYuc2VudDtcbiAgICAgICAgICAgIGNvbGxlY3Rpb24gPSBkYi5nZXRDb2xsZWN0aW9uKGNvbGxlY3Rpb25OYW1lKTtcbiAgICAgICAgICAgIGNvbGxlY3Rpb24uY2xlYXIoKTtcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuYWJydXB0KFwicmV0dXJuXCIsIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgZGIuc2F2ZShmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiByZXNvbHZlKHRydWUpO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pKTtcblxuICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LnN0b3AoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIF9jYWxsZWU2LCB0aGlzKTtcbiAgfSkpO1xuICByZXR1cm4gX2NsZWFyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5cbmZ1bmN0aW9uIGNsZWFyQWxsKF94MTYpIHtcbiAgcmV0dXJuIF9jbGVhckFsbC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuXG5mdW5jdGlvbiBfY2xlYXJBbGwoKSB7XG4gIF9jbGVhckFsbCA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gIC8qI19fUFVSRV9fKi9cbiAgX3JlZ2VuZXJhdG9yLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlNyhkYk5hbWUpIHtcbiAgICB2YXIgZGI7XG4gICAgcmV0dXJuIF9yZWdlbmVyYXRvci5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZTckKF9jb250ZXh0Nykge1xuICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgc3dpdGNoIChfY29udGV4dDcucHJldiA9IF9jb250ZXh0Ny5uZXh0KSB7XG4gICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSAyO1xuICAgICAgICAgICAgcmV0dXJuIG9wZW4oZGJOYW1lKTtcblxuICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgIGRiID0gX2NvbnRleHQ3LnNlbnQ7XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LmFicnVwdChcInJldHVyblwiLCBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgIGRiLmRlbGV0ZURhdGFiYXNlKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUodHJ1ZSk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuc3RvcCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwgX2NhbGxlZTcsIHRoaXMpO1xuICB9KSk7XG4gIHJldHVybiBfY2xlYXJBbGwuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn0iLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkID0gcmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW50ZXJvcFJlcXVpcmVXaWxkY2FyZFwiKTtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmdldCA9IGdldDtcbmV4cG9ydHMuU3RvcmFnZVByb3ZpZGVyID0gdm9pZCAwO1xuXG52YXIgX2NvbmZpZyA9IHJlcXVpcmUoXCIuLi9raW52ZXkvY29uZmlnXCIpO1xuXG52YXIgX2tpbnZleSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uL2Vycm9ycy9raW52ZXlcIikpO1xuXG52YXIgaW5kZXhlZERCID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQocmVxdWlyZShcIi4vaW5kZXhlZGRiXCIpKTtcblxudmFyIG1lbW9yeSA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoXCIuL21lbW9yeVwiKSk7XG5cbnZhciB3ZWJTUUwgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKFwiLi93ZWJzcWxcIikpO1xuXG52YXIgU3RvcmFnZVByb3ZpZGVyID0ge1xuICBJbmRleGVkREI6ICdJbmRleGVkREInLFxuICBNZW1vcnk6ICdNZW1vcnknLFxuICBXZWJTUUw6ICdXZWJTUUwnXG59OyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L3ByZWZlci1kZWZhdWx0LWV4cG9ydFxuXG5leHBvcnRzLlN0b3JhZ2VQcm92aWRlciA9IFN0b3JhZ2VQcm92aWRlcjtcblxuZnVuY3Rpb24gZ2V0KCkge1xuICB2YXIgX2dldENvbmZpZyA9ICgwLCBfY29uZmlnLmdldCkoKSxcbiAgICAgIF9nZXRDb25maWckc3RvcmFnZSA9IF9nZXRDb25maWcuc3RvcmFnZSxcbiAgICAgIHN0b3JhZ2UgPSBfZ2V0Q29uZmlnJHN0b3JhZ2UgPT09IHZvaWQgMCA/IFN0b3JhZ2VQcm92aWRlci5XZWJTUUwgOiBfZ2V0Q29uZmlnJHN0b3JhZ2U7XG5cbiAgaWYgKHN0b3JhZ2UgPT09IFN0b3JhZ2VQcm92aWRlci5JbmRleGVkREIpIHtcbiAgICByZXR1cm4gaW5kZXhlZERCO1xuICB9IGVsc2UgaWYgKHN0b3JhZ2UgPT09IFN0b3JhZ2VQcm92aWRlci5NZW1vcnkpIHtcbiAgICByZXR1cm4gbWVtb3J5O1xuICB9IGVsc2UgaWYgKHN0b3JhZ2UgPT09IFN0b3JhZ2VQcm92aWRlci5XZWJTUUwpIHtcbiAgICByZXR1cm4gd2ViU1FMO1xuICB9XG5cbiAgdGhyb3cgbmV3IF9raW52ZXkuZGVmYXVsdCgnWW91IG11c3Qgb3ZlcnJpZGUgdGhlIGRlZmF1bHQgY2FjaGUgc3RvcmUuJyk7XG59IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmdlbmVyYXRlSWQgPSBnZW5lcmF0ZUlkO1xuXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L3ByZWZlci1kZWZhdWx0LWV4cG9ydFxuZnVuY3Rpb24gZ2VuZXJhdGVJZCgpIHtcbiAgdmFyIGxlbmd0aCA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogMjQ7XG4gIHZhciBjaGFycyA9ICdhYmNkZWYwMTIzNDU2Nzg5JztcbiAgdmFyIGlkID0gJyc7XG5cbiAgZm9yICh2YXIgaSA9IDAsIGogPSBjaGFycy5sZW5ndGg7IGkgPCBsZW5ndGg7IGkgKz0gMSkge1xuICAgIHZhciBwb3MgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBqKTtcbiAgICBpZCArPSBjaGFycy5zdWJzdHJpbmcocG9zLCBwb3MgKyAxKTtcbiAgfVxuXG4gIHJldHVybiBpZDtcbn0iLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmZpbmQgPSBmaW5kO1xuZXhwb3J0cy5jb3VudCA9IGNvdW50O1xuZXhwb3J0cy5maW5kQnlJZCA9IGZpbmRCeUlkO1xuZXhwb3J0cy5zYXZlID0gc2F2ZTtcbmV4cG9ydHMucmVtb3ZlQnlJZCA9IHJlbW92ZUJ5SWQ7XG5leHBvcnRzLmNsZWFyID0gY2xlYXI7XG5leHBvcnRzLmNsZWFyQWxsID0gY2xlYXJBbGw7XG5cbnZhciBfcmVnZW5lcmF0b3IgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9yZWdlbmVyYXRvclwiKSk7XG5cbnZhciBfYXN5bmNUb0dlbmVyYXRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2FzeW5jVG9HZW5lcmF0b3JcIikpO1xuXG52YXIgX3NsaWNlZFRvQXJyYXkyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9zbGljZWRUb0FycmF5XCIpKTtcblxudmFyIF9pc1N0cmluZyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcImxvZGFzaC9pc1N0cmluZ1wiKSk7XG5cbnZhciBfa2ludmV5ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vZXJyb3JzL2tpbnZleVwiKSk7XG5cbnZhciBNQVNURVJfVEFCTEVfTkFNRSA9ICdzcWxpdGVfbWFzdGVyJztcbnZhciBTSVpFID0gMiAqIDEwMjQgKiAxMDI0OyAvLyBEYXRhYmFzZSBzaXplIGluIGJ5dGVzXG5cbmZ1bmN0aW9uIGV4ZWN1dGUoZGJOYW1lLCB0YWJsZU5hbWUsIHNxbFF1ZXJpZXMpIHtcbiAgdmFyIHdyaXRlID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgYXJndW1lbnRzWzNdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbM10gOiBmYWxzZTtcbiAgdmFyIGVzY2FwZWRUYWJsZU5hbWUgPSBcIlxcXCJcIi5jb25jYXQodGFibGVOYW1lLCBcIlxcXCJcIik7XG4gIHZhciBpc01hc3RlciA9IHRhYmxlTmFtZSA9PT0gTUFTVEVSX1RBQkxFX05BTUU7XG4gIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgdHJ5IHtcbiAgICAgIHZhciBkYiA9IHdpbmRvdy5vcGVuRGF0YWJhc2UoZGJOYW1lLCAxLCAnS2ludmV5IFdlYlNRTCcsIFNJWkUpO1xuICAgICAgdmFyIHdyaXRlVHhuID0gd3JpdGUgfHwgdHlwZW9mIGRiLnJlYWRUcmFuc2FjdGlvbiAhPT0gJ2Z1bmN0aW9uJztcbiAgICAgIGRiW3dyaXRlVHhuID8gJ3RyYW5zYWN0aW9uJyA6ICdyZWFkVHJhbnNhY3Rpb24nXShmdW5jdGlvbiAodHgpIHtcbiAgICAgICAgbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcbiAgICAgICAgICBpZiAod3JpdGUgJiYgIWlzTWFzdGVyKSB7XG4gICAgICAgICAgICB0eC5leGVjdXRlU3FsKFwiQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgXCIuY29uY2F0KGVzY2FwZWRUYWJsZU5hbWUsIFwiIChrZXkgQkxPQiBQUklNQVJZIEtFWSBOT1QgTlVMTCwgdmFsdWUgQkxPQiBOT1QgTlVMTClcIiksIFtdLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5hbGwoc3FsUXVlcmllcy5tYXAoZnVuY3Rpb24gKF9yZWYpIHtcbiAgICAgICAgICAgIHZhciBfcmVmMiA9ICgwLCBfc2xpY2VkVG9BcnJheTIuZGVmYXVsdCkoX3JlZiwgMiksXG4gICAgICAgICAgICAgICAgc3FsUXVlcnkgPSBfcmVmMlswXSxcbiAgICAgICAgICAgICAgICBfcmVmMiQgPSBfcmVmMlsxXSxcbiAgICAgICAgICAgICAgICBwYXJhbWV0ZXJzID0gX3JlZjIkID09PSB2b2lkIDAgPyBbXSA6IF9yZWYyJDtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XG4gICAgICAgICAgICAgIHR4LmV4ZWN1dGVTcWwoc3FsUXVlcnkucmVwbGFjZSgnI3t0YWJsZX0nLCBlc2NhcGVkVGFibGVOYW1lKSwgcGFyYW1ldGVycywgZnVuY3Rpb24gKF8sIHJlc3VsdFNldCkge1xuICAgICAgICAgICAgICAgIHZhciByZXNwb25zZSA9IHtcbiAgICAgICAgICAgICAgICAgIHJvd0NvdW50OiByZXN1bHRTZXQucm93cy5sZW5ndGggfHwgcmVzdWx0U2V0LnJvd3NBZmZlY3RlZCxcbiAgICAgICAgICAgICAgICAgIHJlc3VsdDogW11cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdFNldC5yb3dzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSByZXN1bHRTZXQucm93cy5sZW5ndGg7IGkgPCBsZW47IGkgKz0gMSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgX3Jlc3VsdFNldCRyb3dzJGl0ZW0gPSByZXN1bHRTZXQucm93cy5pdGVtKGkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBfcmVzdWx0U2V0JHJvd3MkaXRlbS52YWx1ZTtcblxuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgIHZhciBkb2MgPSBpc01hc3RlciA/IHZhbHVlIDogSlNPTi5wYXJzZSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2UucmVzdWx0LnB1c2goZG9jKTtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICByZXNwb25zZS5yZXN1bHQucHVzaCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KSk7XG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHZhciByZXNwb25zZXMgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IFtdO1xuICAgICAgICAgIHJldHVybiByZXNwb25zZXMucmVkdWNlKGZ1bmN0aW9uIChfcmVmMywgcmVzcG9uc2UpIHtcbiAgICAgICAgICAgIHZhciBfcmVmMyRyb3dDb3VudCA9IF9yZWYzLnJvd0NvdW50LFxuICAgICAgICAgICAgICAgIHJvd0NvdW50ID0gX3JlZjMkcm93Q291bnQgPT09IHZvaWQgMCA/IDAgOiBfcmVmMyRyb3dDb3VudCxcbiAgICAgICAgICAgICAgICBfcmVmMyRyZXN1bHQgPSBfcmVmMy5yZXN1bHQsXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gX3JlZjMkcmVzdWx0ID09PSB2b2lkIDAgPyBbXSA6IF9yZWYzJHJlc3VsdDtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIHJvd0NvdW50OiByb3dDb3VudCArIHJlc3BvbnNlLnJvd0NvdW50LFxuICAgICAgICAgICAgICByZXN1bHQ6IHJlc3VsdC5jb25jYXQocmVzcG9uc2UucmVzdWx0KVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9LCB7XG4gICAgICAgICAgICByb3dDb3VudDogMCxcbiAgICAgICAgICAgIHJlc3VsdDogW11cbiAgICAgICAgICB9KTtcbiAgICAgICAgfSkudGhlbihyZXNvbHZlKS5jYXRjaChyZWplY3QpO1xuICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgIHZhciBlcnJvck1lc3NhZ2UgPSAoMCwgX2lzU3RyaW5nLmRlZmF1bHQpKGVycm9yKSA/IGVycm9yIDogZXJyb3IubWVzc2FnZTtcblxuICAgICAgICBpZiAoZXJyb3JNZXNzYWdlICYmIGVycm9yTWVzc2FnZS5pbmRleE9mKCdubyBzdWNoIHRhYmxlJykgPT09IC0xKSB7XG4gICAgICAgICAgcmVzb2x2ZSh7XG4gICAgICAgICAgICByb3dDb3VudDogMCxcbiAgICAgICAgICAgIHJlc3VsdDogW11cbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgc3FsID0gJ1NFTEVDVCBuYW1lIEFTIHZhbHVlIGZyb20gI3t0YWJsZX0gV0hFUkUgdHlwZSA9ID8gQU5EIG5hbWUgPSA/JztcbiAgICAgICAgICB2YXIgcGFyYW1ldGVycyA9IFsndGFibGUnLCB0YWJsZU5hbWVdO1xuICAgICAgICAgIGV4ZWN1dGUoZGJOYW1lLCBNQVNURVJfVEFCTEVfTkFNRSwgW1tzcWwsIHBhcmFtZXRlcnNdXSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5yZXN1bHQubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgIHJldHVybiByZXNvbHZlKHtcbiAgICAgICAgICAgICAgICByb3dDb3VudDogMCxcbiAgICAgICAgICAgICAgICByZXN1bHQ6IFtdXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gcmVqZWN0KG5ldyBfa2ludmV5LmRlZmF1bHQoXCJVbmFibGUgdG8gb3BlbiBhIHRyYW5zYWN0aW9uIGZvciB0aGUgXCIuY29uY2F0KHRhYmxlTmFtZSwgXCIgY29sbGVjdGlvbiBvbiB0aGUgXCIpLmNvbmNhdChkYk5hbWUsIFwiIFdlYlNRTCBkYXRhYmFzZS5cIikpKTtcbiAgICAgICAgICB9KS5jYXRjaChyZWplY3QpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICB9XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBmaW5kKF94LCBfeDIpIHtcbiAgcmV0dXJuIF9maW5kLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5cbmZ1bmN0aW9uIF9maW5kKCkge1xuICBfZmluZCA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gIC8qI19fUFVSRV9fKi9cbiAgX3JlZ2VuZXJhdG9yLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlKGRiTmFtZSwgdGFibGVOYW1lKSB7XG4gICAgdmFyIHJlc3BvbnNlO1xuICAgIHJldHVybiBfcmVnZW5lcmF0b3IuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7XG4gICAgICB3aGlsZSAoMSkge1xuICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7XG4gICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI7XG4gICAgICAgICAgICByZXR1cm4gZXhlY3V0ZShkYk5hbWUsIHRhYmxlTmFtZSwgW1snU0VMRUNUIHZhbHVlIEZST00gI3t0YWJsZX0nXV0pO1xuXG4gICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgcmVzcG9uc2UgPSBfY29udGV4dC5zZW50O1xuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdChcInJldHVyblwiLCByZXNwb25zZS5yZXN1bHQpO1xuXG4gICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LCBfY2FsbGVlLCB0aGlzKTtcbiAgfSkpO1xuICByZXR1cm4gX2ZpbmQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cblxuZnVuY3Rpb24gY291bnQoX3gzLCBfeDQpIHtcbiAgcmV0dXJuIF9jb3VudC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuXG5mdW5jdGlvbiBfY291bnQoKSB7XG4gIF9jb3VudCA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gIC8qI19fUFVSRV9fKi9cbiAgX3JlZ2VuZXJhdG9yLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlMihkYk5hbWUsIHRhYmxlTmFtZSkge1xuICAgIHZhciByZXNwb25zZTtcbiAgICByZXR1cm4gX3JlZ2VuZXJhdG9yLmRlZmF1bHQud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7XG4gICAgICB3aGlsZSAoMSkge1xuICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHtcbiAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDI7XG4gICAgICAgICAgICByZXR1cm4gZXhlY3V0ZShkYk5hbWUsIHRhYmxlTmFtZSwgW1snU0VMRUNUIENPVU5UKCopIEFTIHZhbHVlIEZST00gI3t0YWJsZX0nXV0pO1xuXG4gICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgcmVzcG9uc2UgPSBfY29udGV4dDIuc2VudDtcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KFwicmV0dXJuXCIsIHJlc3BvbnNlLnJlc3VsdC5zaGlmdCgpIHx8IDApO1xuXG4gICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwgX2NhbGxlZTIsIHRoaXMpO1xuICB9KSk7XG4gIHJldHVybiBfY291bnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cblxuZnVuY3Rpb24gZmluZEJ5SWQoX3g1LCBfeDYsIF94Nykge1xuICByZXR1cm4gX2ZpbmRCeUlkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5cbmZ1bmN0aW9uIF9maW5kQnlJZCgpIHtcbiAgX2ZpbmRCeUlkID0gKDAsIF9hc3luY1RvR2VuZXJhdG9yMi5kZWZhdWx0KShcbiAgLyojX19QVVJFX18qL1xuICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKGRiTmFtZSwgdGFibGVOYW1lLCBpZCkge1xuICAgIHZhciByZXNwb25zZTtcbiAgICByZXR1cm4gX3JlZ2VuZXJhdG9yLmRlZmF1bHQud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7XG4gICAgICB3aGlsZSAoMSkge1xuICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHtcbiAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDI7XG4gICAgICAgICAgICByZXR1cm4gZXhlY3V0ZShkYk5hbWUsIHRhYmxlTmFtZSwgW1snU0VMRUNUIHZhbHVlIEZST00gI3t0YWJsZX0gV0hFUkUga2V5ID0gPycsIFtpZF1dXSk7XG5cbiAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICByZXNwb25zZSA9IF9jb250ZXh0My5zZW50O1xuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoXCJyZXR1cm5cIiwgcmVzcG9uc2UucmVzdWx0LnNoaWZ0KCkpO1xuXG4gICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwgX2NhbGxlZTMsIHRoaXMpO1xuICB9KSk7XG4gIHJldHVybiBfZmluZEJ5SWQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cblxuZnVuY3Rpb24gc2F2ZShfeDgsIF94OSkge1xuICByZXR1cm4gX3NhdmUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cblxuZnVuY3Rpb24gX3NhdmUoKSB7XG4gIF9zYXZlID0gKDAsIF9hc3luY1RvR2VuZXJhdG9yMi5kZWZhdWx0KShcbiAgLyojX19QVVJFX18qL1xuICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0KGRiTmFtZSwgdGFibGVOYW1lKSB7XG4gICAgdmFyIGRvY3MsXG4gICAgICAgIHNxbFF1ZXJpZXMsXG4gICAgICAgIF9hcmdzNCA9IGFyZ3VtZW50cztcbiAgICByZXR1cm4gX3JlZ2VuZXJhdG9yLmRlZmF1bHQud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7XG4gICAgICB3aGlsZSAoMSkge1xuICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHtcbiAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICBkb2NzID0gX2FyZ3M0Lmxlbmd0aCA+IDIgJiYgX2FyZ3M0WzJdICE9PSB1bmRlZmluZWQgPyBfYXJnczRbMl0gOiBbXTtcbiAgICAgICAgICAgIHNxbFF1ZXJpZXMgPSBkb2NzLm1hcChmdW5jdGlvbiAoZG9jKSB7XG4gICAgICAgICAgICAgIHJldHVybiBbJ1JFUExBQ0UgSU5UTyAje3RhYmxlfSAoa2V5LCB2YWx1ZSkgVkFMVUVTICg/LCA/KScsIFtkb2MuX2lkLCBKU09OLnN0cmluZ2lmeShkb2MpXV07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gNDtcbiAgICAgICAgICAgIHJldHVybiBleGVjdXRlKGRiTmFtZSwgdGFibGVOYW1lLCBzcWxRdWVyaWVzLCB0cnVlKTtcblxuICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KFwicmV0dXJuXCIsIGRvY3MpO1xuXG4gICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuc3RvcCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwgX2NhbGxlZTQsIHRoaXMpO1xuICB9KSk7XG4gIHJldHVybiBfc2F2ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuXG5mdW5jdGlvbiByZW1vdmVCeUlkKF94MTAsIF94MTEsIF94MTIpIHtcbiAgcmV0dXJuIF9yZW1vdmVCeUlkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5cbmZ1bmN0aW9uIF9yZW1vdmVCeUlkKCkge1xuICBfcmVtb3ZlQnlJZCA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gIC8qI19fUFVSRV9fKi9cbiAgX3JlZ2VuZXJhdG9yLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlNShkYk5hbWUsIHRhYmxlTmFtZSwgaWQpIHtcbiAgICB2YXIgcmVzcG9uc2U7XG4gICAgcmV0dXJuIF9yZWdlbmVyYXRvci5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZTUkKF9jb250ZXh0NSkge1xuICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgc3dpdGNoIChfY29udGV4dDUucHJldiA9IF9jb250ZXh0NS5uZXh0KSB7XG4gICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSAyO1xuICAgICAgICAgICAgcmV0dXJuIGV4ZWN1dGUoZGJOYW1lLCB0YWJsZU5hbWUsIFtbJ0RFTEVURSBGUk9NICN7dGFibGV9IFdIRVJFIGtleSA9ID8nLCBbaWRdXV0sIHRydWUpO1xuXG4gICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgcmVzcG9uc2UgPSBfY29udGV4dDUuc2VudDtcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuYWJydXB0KFwicmV0dXJuXCIsIHJlc3BvbnNlLnJvd0NvdW50KTtcblxuICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LnN0b3AoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIF9jYWxsZWU1LCB0aGlzKTtcbiAgfSkpO1xuICByZXR1cm4gX3JlbW92ZUJ5SWQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cblxuZnVuY3Rpb24gY2xlYXIoX3gxMywgX3gxNCkge1xuICByZXR1cm4gX2NsZWFyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5cbmZ1bmN0aW9uIF9jbGVhcigpIHtcbiAgX2NsZWFyID0gKDAsIF9hc3luY1RvR2VuZXJhdG9yMi5kZWZhdWx0KShcbiAgLyojX19QVVJFX18qL1xuICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU2KGRiTmFtZSwgdGFibGVOYW1lKSB7XG4gICAgcmV0dXJuIF9yZWdlbmVyYXRvci5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZTYkKF9jb250ZXh0Nikge1xuICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgc3dpdGNoIChfY29udGV4dDYucHJldiA9IF9jb250ZXh0Ni5uZXh0KSB7XG4gICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSAyO1xuICAgICAgICAgICAgcmV0dXJuIGV4ZWN1dGUoZGJOYW1lLCB0YWJsZU5hbWUsIFtbJ0RST1AgVEFCTEUgSUYgRVhJU1RTICN7dGFibGV9J11dLCB0cnVlKTtcblxuICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuYWJydXB0KFwicmV0dXJuXCIsIHRydWUpO1xuXG4gICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuc3RvcCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwgX2NhbGxlZTYsIHRoaXMpO1xuICB9KSk7XG4gIHJldHVybiBfY2xlYXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cblxuZnVuY3Rpb24gY2xlYXJBbGwoX3gxNSkge1xuICByZXR1cm4gX2NsZWFyQWxsLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5cbmZ1bmN0aW9uIF9jbGVhckFsbCgpIHtcbiAgX2NsZWFyQWxsID0gKDAsIF9hc3luY1RvR2VuZXJhdG9yMi5kZWZhdWx0KShcbiAgLyojX19QVVJFX18qL1xuICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU3KGRiTmFtZSkge1xuICAgIHZhciByZXNwb25zZSwgdGFibGVzO1xuICAgIHJldHVybiBfcmVnZW5lcmF0b3IuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWU3JChfY29udGV4dDcpIHtcbiAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgIHN3aXRjaCAoX2NvbnRleHQ3LnByZXYgPSBfY29udGV4dDcubmV4dCkge1xuICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMjtcbiAgICAgICAgICAgIHJldHVybiBleGVjdXRlKGRiTmFtZSwgTUFTVEVSX1RBQkxFX05BTUUsIFtbJ1NFTEVDVCBuYW1lIEFTIHZhbHVlIEZST00gI3t0YWJsZX0gV0hFUkUgdHlwZSA9ID8gQU5EIHZhbHVlIE5PVCBMSUtFID8nLCBbJ3RhYmxlJywgJ19fV2Via2l0JSddXV0pO1xuXG4gICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgcmVzcG9uc2UgPSBfY29udGV4dDcuc2VudDtcbiAgICAgICAgICAgIHRhYmxlcyA9IHJlc3BvbnNlLnJlc3VsdDtcblxuICAgICAgICAgICAgaWYgKCEodGFibGVzLmxlbmd0aCA+IDApKSB7XG4gICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gNztcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gNztcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLmFsbCh0YWJsZXMubWFwKGZ1bmN0aW9uICh0YWJsZU5hbWUpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGV4ZWN1dGUoZGJOYW1lLCB0YWJsZU5hbWUsIFtbJ0RST1AgVEFCTEUgSUYgRVhJU1RTICN7dGFibGV9J11dLCB0cnVlKTtcbiAgICAgICAgICAgIH0pKTtcblxuICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuYWJydXB0KFwicmV0dXJuXCIsIHRydWUpO1xuXG4gICAgICAgICAgY2FzZSA4OlxuICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuc3RvcCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwgX2NhbGxlZTcsIHRoaXMpO1xuICB9KSk7XG4gIHJldHVybiBfY2xlYXJBbGwuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn0iLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmlzVmFsaWRUYWcgPSBpc1ZhbGlkVGFnO1xuZXhwb3J0cy5jbGVhciA9IGNsZWFyO1xuZXhwb3J0cy5RdWVyeUNhY2hlID0gZXhwb3J0cy5EYXRhU3RvcmVDYWNoZSA9IHZvaWQgMDtcblxudmFyIF9yZWdlbmVyYXRvciA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL3JlZ2VuZXJhdG9yXCIpKTtcblxudmFyIF9hc3luY1RvR2VuZXJhdG9yMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXN5bmNUb0dlbmVyYXRvclwiKSk7XG5cbnZhciBfY3JlYXRlQ2xhc3MyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jcmVhdGVDbGFzc1wiKSk7XG5cbnZhciBfZ2V0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZ2V0XCIpKTtcblxudmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrXCIpKTtcblxudmFyIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvcG9zc2libGVDb25zdHJ1Y3RvclJldHVyblwiKSk7XG5cbnZhciBfZ2V0UHJvdG90eXBlT2YyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9nZXRQcm90b3R5cGVPZlwiKSk7XG5cbnZhciBfaW5oZXJpdHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbmhlcml0c1wiKSk7XG5cbnZhciBfaXNTdHJpbmcgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJsb2Rhc2gvaXNTdHJpbmdcIikpO1xuXG52YXIgX2lzRW1wdHkgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJsb2Rhc2gvaXNFbXB0eVwiKSk7XG5cbnZhciBfY2FjaGUgPSByZXF1aXJlKFwiLi4vY2FjaGVcIik7XG5cbnZhciBfY29uZmlnID0gcmVxdWlyZShcIi4uL2tpbnZleS9jb25maWdcIik7XG5cbnZhciBfaGVhZGVycyA9IHJlcXVpcmUoXCIuLi9odHRwL2hlYWRlcnNcIik7XG5cbnZhciBfcXVlcnkgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi9xdWVyeVwiKSk7XG5cbnZhciBRVUVSWV9DQUNIRV9UQUcgPSAnX1F1ZXJ5Q2FjaGUnO1xuXG5mdW5jdGlvbiBpc1ZhbGlkVGFnKHRhZykge1xuICB2YXIgcmVnZXhwID0gL15bYS16MC05LV0rJC9pO1xuICByZXR1cm4gKDAsIF9pc1N0cmluZy5kZWZhdWx0KSh0YWcpICYmIHJlZ2V4cC50ZXN0KHRhZyk7XG59XG5cbnZhciBEYXRhU3RvcmVDYWNoZSA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoX0NhY2hlKSB7XG4gICgwLCBfaW5oZXJpdHMyLmRlZmF1bHQpKERhdGFTdG9yZUNhY2hlLCBfQ2FjaGUpO1xuXG4gIGZ1bmN0aW9uIERhdGFTdG9yZUNhY2hlKGNvbGxlY3Rpb25OYW1lLCB0YWcpIHtcbiAgICB2YXIgX3RoaXM7XG5cbiAgICAoMCwgX2NsYXNzQ2FsbENoZWNrMi5kZWZhdWx0KSh0aGlzLCBEYXRhU3RvcmVDYWNoZSk7XG5cbiAgICB2YXIgX2dldENvbmZpZyA9ICgwLCBfY29uZmlnLmdldCkoKSxcbiAgICAgICAgYXBwS2V5ID0gX2dldENvbmZpZy5hcHBLZXk7XG5cbiAgICBpZiAodGFnICYmICFpc1ZhbGlkVGFnKHRhZykpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQSB0YWcgY2FuIG9ubHkgY29udGFpbiBsZXR0ZXJzLCBudW1iZXJzLCBhbmQgXCItXCIuJyk7XG4gICAgfVxuXG4gICAgaWYgKHRhZykge1xuICAgICAgX3RoaXMgPSAoMCwgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yLmRlZmF1bHQpKHRoaXMsICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKERhdGFTdG9yZUNhY2hlKS5jYWxsKHRoaXMsIGFwcEtleSwgXCJcIi5jb25jYXQoY29sbGVjdGlvbk5hbWUsIFwiLlwiKS5jb25jYXQodGFnKSkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBfdGhpcyA9ICgwLCBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIuZGVmYXVsdCkodGhpcywgKDAsIF9nZXRQcm90b3R5cGVPZjIuZGVmYXVsdCkoRGF0YVN0b3JlQ2FjaGUpLmNhbGwodGhpcywgYXBwS2V5LCBjb2xsZWN0aW9uTmFtZSkpO1xuICAgIH1cblxuICAgIHJldHVybiAoMCwgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yLmRlZmF1bHQpKF90aGlzKTtcbiAgfVxuXG4gIHJldHVybiBEYXRhU3RvcmVDYWNoZTtcbn0oX2NhY2hlLkNhY2hlKTtcblxuZXhwb3J0cy5EYXRhU3RvcmVDYWNoZSA9IERhdGFTdG9yZUNhY2hlO1xuXG52YXIgUXVlcnlDYWNoZSA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoX0RhdGFTdG9yZUNhY2hlKSB7XG4gICgwLCBfaW5oZXJpdHMyLmRlZmF1bHQpKFF1ZXJ5Q2FjaGUsIF9EYXRhU3RvcmVDYWNoZSk7XG5cbiAgZnVuY3Rpb24gUXVlcnlDYWNoZSh0YWcpIHtcbiAgICAoMCwgX2NsYXNzQ2FsbENoZWNrMi5kZWZhdWx0KSh0aGlzLCBRdWVyeUNhY2hlKTtcbiAgICByZXR1cm4gKDAsIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMi5kZWZhdWx0KSh0aGlzLCAoMCwgX2dldFByb3RvdHlwZU9mMi5kZWZhdWx0KShRdWVyeUNhY2hlKS5jYWxsKHRoaXMsIFFVRVJZX0NBQ0hFX1RBRywgdGFnKSk7XG4gIH0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGNsYXNzLW1ldGhvZHMtdXNlLXRoaXNcblxuXG4gICgwLCBfY3JlYXRlQ2xhc3MyLmRlZmF1bHQpKFF1ZXJ5Q2FjaGUsIFt7XG4gICAga2V5OiBcInNlcmlhbGl6ZVF1ZXJ5XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHNlcmlhbGl6ZVF1ZXJ5KHF1ZXJ5KSB7XG4gICAgICBpZiAoIXF1ZXJ5KSB7XG4gICAgICAgIHJldHVybiAnJztcbiAgICAgIH1cblxuICAgICAgaWYgKHF1ZXJ5LnNraXAgPiAwIHx8IHF1ZXJ5LmxpbWl0IDwgSW5maW5pdHkpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG5cbiAgICAgIHZhciBxdWVyeU9iamVjdCA9IHF1ZXJ5LnRvUXVlcnlPYmplY3QoKTtcbiAgICAgIHJldHVybiBxdWVyeU9iamVjdCAmJiAhKDAsIF9pc0VtcHR5LmRlZmF1bHQpKHF1ZXJ5T2JqZWN0KSA/IEpTT04uc3RyaW5naWZ5KHF1ZXJ5T2JqZWN0KSA6ICcnO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJmaW5kQnlLZXlcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIF9maW5kQnlLZXkgPSAoMCwgX2FzeW5jVG9HZW5lcmF0b3IyLmRlZmF1bHQpKFxuICAgICAgLyojX19QVVJFX18qL1xuICAgICAgX3JlZ2VuZXJhdG9yLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlKGtleSkge1xuICAgICAgICB2YXIgcXVlcnksIGRvY3M7XG4gICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3IuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7XG4gICAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHtcbiAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgIHF1ZXJ5ID0gbmV3IF9xdWVyeS5kZWZhdWx0KCkuZXF1YWxUbygncXVlcnknLCBrZXkpO1xuICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmZpbmQocXVlcnkpO1xuXG4gICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICBkb2NzID0gX2NvbnRleHQuc2VudDtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KFwicmV0dXJuXCIsIGRvY3Muc2hpZnQoKSk7XG5cbiAgICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sIF9jYWxsZWUsIHRoaXMpO1xuICAgICAgfSkpO1xuXG4gICAgICBmdW5jdGlvbiBmaW5kQnlLZXkoX3gpIHtcbiAgICAgICAgcmV0dXJuIF9maW5kQnlLZXkuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGZpbmRCeUtleTtcbiAgICB9KClcbiAgfSwge1xuICAgIGtleTogXCJzYXZlXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBfc2F2ZSA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gICAgICAvKiNfX1BVUkVfXyovXG4gICAgICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKHF1ZXJ5LCByZXNwb25zZSkge1xuICAgICAgICB2YXIga2V5LCBoZWFkZXJzLCBkb2M7XG4gICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3IuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHtcbiAgICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7XG4gICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICBrZXkgPSB0aGlzLnNlcmlhbGl6ZVF1ZXJ5KHF1ZXJ5KTtcblxuICAgICAgICAgICAgICAgIGlmICghKGtleSAhPT0gbnVsbCkpIHtcbiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gOTtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGhlYWRlcnMgPSBuZXcgX2hlYWRlcnMuS2ludmV5SGVhZGVycyhyZXNwb25zZS5oZWFkZXJzKTtcbiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDU7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmluZEJ5S2V5KGtleSk7XG5cbiAgICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgIGRvYyA9IF9jb250ZXh0Mi5zZW50O1xuXG4gICAgICAgICAgICAgICAgaWYgKCFkb2MpIHtcbiAgICAgICAgICAgICAgICAgIGRvYyA9IHtcbiAgICAgICAgICAgICAgICAgICAgY29sbGVjdGlvbk5hbWU6IHRoaXMuY29sbGVjdGlvbk5hbWUsXG4gICAgICAgICAgICAgICAgICAgIHF1ZXJ5OiBrZXlcbiAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZG9jLmxhc3RSZXF1ZXN0ID0gaGVhZGVycy5yZXF1ZXN0U3RhcnQ7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoXCJyZXR1cm5cIiwgKDAsIF9nZXQyLmRlZmF1bHQpKCgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKFF1ZXJ5Q2FjaGUucHJvdG90eXBlKSwgXCJzYXZlXCIsIHRoaXMpLmNhbGwodGhpcywgZG9jKSk7XG5cbiAgICAgICAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KFwicmV0dXJuXCIsIG51bGwpO1xuXG4gICAgICAgICAgICAgIGNhc2UgMTA6XG4gICAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sIF9jYWxsZWUyLCB0aGlzKTtcbiAgICAgIH0pKTtcblxuICAgICAgZnVuY3Rpb24gc2F2ZShfeDIsIF94Mykge1xuICAgICAgICByZXR1cm4gX3NhdmUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHNhdmU7XG4gICAgfSgpXG4gIH1dKTtcbiAgcmV0dXJuIFF1ZXJ5Q2FjaGU7XG59KERhdGFTdG9yZUNhY2hlKTtcblxuZXhwb3J0cy5RdWVyeUNhY2hlID0gUXVlcnlDYWNoZTtcblxuZnVuY3Rpb24gY2xlYXIoKSB7XG4gIHJldHVybiBfY2xlYXIyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5cbmZ1bmN0aW9uIF9jbGVhcjIoKSB7XG4gIF9jbGVhcjIgPSAoMCwgX2FzeW5jVG9HZW5lcmF0b3IyLmRlZmF1bHQpKFxuICAvKiNfX1BVUkVfXyovXG4gIF9yZWdlbmVyYXRvci5kZWZhdWx0Lm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoKSB7XG4gICAgdmFyIF9nZXRDb25maWcyLCBhcHBLZXk7XG5cbiAgICByZXR1cm4gX3JlZ2VuZXJhdG9yLmRlZmF1bHQud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7XG4gICAgICB3aGlsZSAoMSkge1xuICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHtcbiAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICBfZ2V0Q29uZmlnMiA9ICgwLCBfY29uZmlnLmdldCkoKSwgYXBwS2V5ID0gX2dldENvbmZpZzIuYXBwS2V5O1xuICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAzO1xuICAgICAgICAgICAgcmV0dXJuICgwLCBfY2FjaGUuY2xlYXIpKGFwcEtleSk7XG5cbiAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdChcInJldHVyblwiLCBudWxsKTtcblxuICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIF9jYWxsZWUzLCB0aGlzKTtcbiAgfSkpO1xuICByZXR1cm4gX2NsZWFyMi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufSIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuQ2FjaGVTdG9yZSA9IGV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcblxudmFyIF9yZWdlbmVyYXRvciA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL3JlZ2VuZXJhdG9yXCIpKTtcblxudmFyIF9hc3luY1RvR2VuZXJhdG9yMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXN5bmNUb0dlbmVyYXRvclwiKSk7XG5cbnZhciBfY3JlYXRlQ2xhc3MyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jcmVhdGVDbGFzc1wiKSk7XG5cbnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVja1wiKSk7XG5cbnZhciBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm5cIikpO1xuXG52YXIgX2dldFByb3RvdHlwZU9mMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZ2V0UHJvdG90eXBlT2ZcIikpO1xuXG52YXIgX2luaGVyaXRzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW5oZXJpdHNcIikpO1xuXG52YXIgX2Fzc2VydFRoaXNJbml0aWFsaXplZDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2Fzc2VydFRoaXNJbml0aWFsaXplZFwiKSk7XG5cbnZhciBfaXNBcnJheSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcImxvZGFzaC9pc0FycmF5XCIpKTtcblxudmFyIF90aW1lcyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcImxvZGFzaC90aW1lc1wiKSk7XG5cbnZhciBfb2JzZXJ2YWJsZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uL29ic2VydmFibGVcIikpO1xuXG52YXIgX3F1ZXJ5ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vcXVlcnlcIikpO1xuXG52YXIgX2NvbmZpZyA9IHJlcXVpcmUoXCIuLi9raW52ZXkvY29uZmlnXCIpO1xuXG52YXIgX3V0aWxzID0gcmVxdWlyZShcIi4uL2h0dHAvdXRpbHNcIik7XG5cbnZhciBfcmVxdWVzdCA9IHJlcXVpcmUoXCIuLi9odHRwL3JlcXVlc3RcIik7XG5cbnZhciBfYXV0aCA9IHJlcXVpcmUoXCIuLi9odHRwL2F1dGhcIik7XG5cbnZhciBfa2ludmV5ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vZXJyb3JzL2tpbnZleVwiKSk7XG5cbnZhciBfbWlzc2luZ0NvbmZpZ3VyYXRpb24gPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi9lcnJvcnMvbWlzc2luZ0NvbmZpZ3VyYXRpb25cIikpO1xuXG52YXIgX3BhcmFtZXRlclZhbHVlT3V0T2ZSYW5nZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uL2Vycm9ycy9wYXJhbWV0ZXJWYWx1ZU91dE9mUmFuZ2VcIikpO1xuXG52YXIgX25vdEZvdW5kID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vZXJyb3JzL25vdEZvdW5kXCIpKTtcblxudmFyIF9iYXNlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vZXJyb3JzL2Jhc2VcIikpO1xuXG52YXIgX2NhY2hlID0gcmVxdWlyZShcIi4vY2FjaGVcIik7XG5cbnZhciBfc3luYzIgPSByZXF1aXJlKFwiLi9zeW5jXCIpO1xuXG52YXIgX25ldHdvcmtzdG9yZSA9IHJlcXVpcmUoXCIuL25ldHdvcmtzdG9yZVwiKTtcblxudmFyIE5BTUVTUEFDRSA9ICdhcHBkYXRhJztcbnZhciBQQUdFX0xJTUlUID0gMTAwMDA7XG5cbnZhciBJbnZhbGlkRGVsdGFTZXRRdWVyeUVycm9yID1cbi8qI19fUFVSRV9fKi9cbmZ1bmN0aW9uIChfQmFzZUVycm9yKSB7XG4gICgwLCBfaW5oZXJpdHMyLmRlZmF1bHQpKEludmFsaWREZWx0YVNldFF1ZXJ5RXJyb3IsIF9CYXNlRXJyb3IpO1xuXG4gIGZ1bmN0aW9uIEludmFsaWREZWx0YVNldFF1ZXJ5RXJyb3IoKSB7XG4gICAgdmFyIF9nZXRQcm90b3R5cGVPZjI7XG5cbiAgICB2YXIgX3RoaXM7XG5cbiAgICB2YXIgbWVzc2FnZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogJ0ludmFsaWQgZGVsdGEgc2V0IHF1ZXJ5Lic7XG4gICAgKDAsIF9jbGFzc0NhbGxDaGVjazIuZGVmYXVsdCkodGhpcywgSW52YWxpZERlbHRhU2V0UXVlcnlFcnJvcik7XG5cbiAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuID4gMSA/IF9sZW4gLSAxIDogMCksIF9rZXkgPSAxOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7XG4gICAgICBhcmdzW19rZXkgLSAxXSA9IGFyZ3VtZW50c1tfa2V5XTtcbiAgICB9XG5cbiAgICAvLyBQYXNzIHJlbWFpbmluZyBhcmd1bWVudHMgKGluY2x1ZGluZyB2ZW5kb3Igc3BlY2lmaWMgb25lcykgdG8gcGFyZW50IGNvbnN0cnVjdG9yXG4gICAgX3RoaXMgPSAoMCwgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yLmRlZmF1bHQpKHRoaXMsIChfZ2V0UHJvdG90eXBlT2YyID0gKDAsIF9nZXRQcm90b3R5cGVPZjMuZGVmYXVsdCkoSW52YWxpZERlbHRhU2V0UXVlcnlFcnJvcikpLmNhbGwuYXBwbHkoX2dldFByb3RvdHlwZU9mMiwgW3RoaXMsIG1lc3NhZ2VdLmNvbmNhdChhcmdzKSkpOyAvLyBNYWludGFpbnMgcHJvcGVyIHN0YWNrIHRyYWNlIGZvciB3aGVyZSBvdXIgZXJyb3Igd2FzIHRocm93biAob25seSBhdmFpbGFibGUgb24gVjgpXG5cbiAgICBpZiAoRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UpIHtcbiAgICAgIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKCgwLCBfYXNzZXJ0VGhpc0luaXRpYWxpemVkMi5kZWZhdWx0KSgoMCwgX2Fzc2VydFRoaXNJbml0aWFsaXplZDIuZGVmYXVsdCkoX3RoaXMpKSwgSW52YWxpZERlbHRhU2V0UXVlcnlFcnJvcik7XG4gICAgfSAvLyBDdXN0b20gZGVidWdnaW5nIGluZm9ybWF0aW9uXG5cblxuICAgIF90aGlzLm5hbWUgPSAnSW52YWxpZERlbHRhU2V0UXVlcnlFcnJvcic7XG4gICAgcmV0dXJuIF90aGlzO1xuICB9XG5cbiAgcmV0dXJuIEludmFsaWREZWx0YVNldFF1ZXJ5RXJyb3I7XG59KF9iYXNlLmRlZmF1bHQpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBJbnZhbGlkRGVsdGFTZXRRdWVyeUVycm9yO1xuXG52YXIgQ2FjaGVTdG9yZSA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIENhY2hlU3RvcmUoY29sbGVjdGlvbk5hbWUpIHtcbiAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge1xuICAgICAgdGFnOiB1bmRlZmluZWQsXG4gICAgICB1c2VEZWx0YVNldDogZmFsc2UsXG4gICAgICB1c2VBdXRvUGFnaW5hdGlvbjogZmFsc2UsXG4gICAgICBhdXRvU3luYzogdHJ1ZVxuICAgIH07XG4gICAgKDAsIF9jbGFzc0NhbGxDaGVjazIuZGVmYXVsdCkodGhpcywgQ2FjaGVTdG9yZSk7XG4gICAgdGhpcy5jb2xsZWN0aW9uTmFtZSA9IGNvbGxlY3Rpb25OYW1lO1xuICAgIHRoaXMudGFnID0gb3B0aW9ucy50YWc7XG4gICAgdGhpcy51c2VEZWx0YVNldCA9IG9wdGlvbnMudXNlRGVsdGFTZXQgPT09IHRydWU7XG4gICAgdGhpcy51c2VBdXRvUGFnaW5hdGlvbiA9IG9wdGlvbnMudXNlQXV0b1BhZ2luYXRpb24gPT09IHRydWUgfHwgb3B0aW9ucy5hdXRvUGFnaW5hdGlvbjtcbiAgICB0aGlzLmF1dG9TeW5jID0gb3B0aW9ucy5hdXRvU3luYyA9PT0gdHJ1ZTtcbiAgfVxuXG4gICgwLCBfY3JlYXRlQ2xhc3MyLmRlZmF1bHQpKENhY2hlU3RvcmUsIFt7XG4gICAga2V5OiBcImZpbmRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gZmluZChxdWVyeSkge1xuICAgICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7fTtcbiAgICAgIHZhciBhdXRvU3luYyA9IG9wdGlvbnMuYXV0b1N5bmMgPT09IHRydWUgfHwgdGhpcy5hdXRvU3luYztcbiAgICAgIHZhciBjYWNoZSA9IG5ldyBfY2FjaGUuRGF0YVN0b3JlQ2FjaGUodGhpcy5jb2xsZWN0aW9uTmFtZSwgdGhpcy50YWcpO1xuXG4gICAgICB2YXIgc3RyZWFtID0gX29ic2VydmFibGUuZGVmYXVsdC5jcmVhdGUoXG4gICAgICAvKiNfX1BVUkVfXyovXG4gICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfcmVmID0gKDAsIF9hc3luY1RvR2VuZXJhdG9yMi5kZWZhdWx0KShcbiAgICAgICAgLyojX19QVVJFX18qL1xuICAgICAgICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUob2JzZXJ2ZXIpIHtcbiAgICAgICAgICB2YXIgY2FjaGVkRG9jcywgZG9jcztcbiAgICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yLmRlZmF1bHQud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkge1xuICAgICAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkge1xuICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAwO1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDM7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gY2FjaGUuZmluZChxdWVyeSk7XG5cbiAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICBjYWNoZWREb2NzID0gX2NvbnRleHQuc2VudDtcbiAgICAgICAgICAgICAgICAgIG9ic2VydmVyLm5leHQoY2FjaGVkRG9jcyk7XG5cbiAgICAgICAgICAgICAgICAgIGlmICghYXV0b1N5bmMpIHtcbiAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDEyO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDg7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMyLnB1bGwocXVlcnksIG9wdGlvbnMpO1xuXG4gICAgICAgICAgICAgICAgY2FzZSA4OlxuICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDEwO1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhY2hlLmZpbmQocXVlcnkpO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAxMDpcbiAgICAgICAgICAgICAgICAgIGRvY3MgPSBfY29udGV4dC5zZW50O1xuICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIubmV4dChkb2NzKTtcblxuICAgICAgICAgICAgICAgIGNhc2UgMTI6XG4gICAgICAgICAgICAgICAgICBvYnNlcnZlci5jb21wbGV0ZSgpO1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE4O1xuICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlIDE1OlxuICAgICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDE1O1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQudDAgPSBfY29udGV4dFtcImNhdGNoXCJdKDApO1xuICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIuZXJyb3IoX2NvbnRleHQudDApO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAxODpcbiAgICAgICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSwgX2NhbGxlZSwgdGhpcywgW1swLCAxNV1dKTtcbiAgICAgICAgfSkpO1xuXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoX3gpIHtcbiAgICAgICAgICByZXR1cm4gX3JlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICB9O1xuICAgICAgfSgpKTtcblxuICAgICAgcmV0dXJuIHN0cmVhbTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiY291bnRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gY291bnQocXVlcnkpIHtcbiAgICAgIHZhciBfdGhpczMgPSB0aGlzO1xuXG4gICAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307XG4gICAgICB2YXIgYXV0b1N5bmMgPSBvcHRpb25zLmF1dG9TeW5jID09PSB0cnVlIHx8IHRoaXMuYXV0b1N5bmM7XG4gICAgICB2YXIgY2FjaGUgPSBuZXcgX2NhY2hlLkRhdGFTdG9yZUNhY2hlKHRoaXMuY29sbGVjdGlvbk5hbWUsIHRoaXMudGFnKTtcblxuICAgICAgdmFyIHN0cmVhbSA9IF9vYnNlcnZhYmxlLmRlZmF1bHQuY3JlYXRlKFxuICAgICAgLyojX19QVVJFX18qL1xuICAgICAgZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3JlZjIgPSAoMCwgX2FzeW5jVG9HZW5lcmF0b3IyLmRlZmF1bHQpKFxuICAgICAgICAvKiNfX1BVUkVfXyovXG4gICAgICAgIF9yZWdlbmVyYXRvci5kZWZhdWx0Lm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIob2JzZXJ2ZXIpIHtcbiAgICAgICAgICB2YXIgY2FjaGVDb3VudCwgbmV0d29yaywgY291bnQ7XG4gICAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvci5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0Mikge1xuICAgICAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLnByZXYgPSAwO1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzO1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhY2hlLmNvdW50KHF1ZXJ5KTtcblxuICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgIGNhY2hlQ291bnQgPSBfY29udGV4dDIuc2VudDtcbiAgICAgICAgICAgICAgICAgIG9ic2VydmVyLm5leHQoY2FjaGVDb3VudCk7XG5cbiAgICAgICAgICAgICAgICAgIGlmICghYXV0b1N5bmMpIHtcbiAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxMTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIG5ldHdvcmsgPSBuZXcgX25ldHdvcmtzdG9yZS5OZXR3b3JrU3RvcmUoX3RoaXMzLmNvbGxlY3Rpb25OYW1lKTtcbiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gOTtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBuZXR3b3JrLmNvdW50KHF1ZXJ5LCBvcHRpb25zKS50b1Byb21pc2UoKTtcblxuICAgICAgICAgICAgICAgIGNhc2UgOTpcbiAgICAgICAgICAgICAgICAgIGNvdW50ID0gX2NvbnRleHQyLnNlbnQ7XG4gICAgICAgICAgICAgICAgICBvYnNlcnZlci5uZXh0KGNvdW50KTtcblxuICAgICAgICAgICAgICAgIGNhc2UgMTE6XG4gICAgICAgICAgICAgICAgICBvYnNlcnZlci5jb21wbGV0ZSgpO1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxNztcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAxNDpcbiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5wcmV2ID0gMTQ7XG4gICAgICAgICAgICAgICAgICBfY29udGV4dDIudDAgPSBfY29udGV4dDJbXCJjYXRjaFwiXSgwKTtcbiAgICAgICAgICAgICAgICAgIG9ic2VydmVyLmVycm9yKF9jb250ZXh0Mi50MCk7XG5cbiAgICAgICAgICAgICAgICBjYXNlIDE3OlxuICAgICAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSwgX2NhbGxlZTIsIHRoaXMsIFtbMCwgMTRdXSk7XG4gICAgICAgIH0pKTtcblxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKF94Mikge1xuICAgICAgICAgIHJldHVybiBfcmVmMi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICB9O1xuICAgICAgfSgpKTtcblxuICAgICAgcmV0dXJuIHN0cmVhbTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiZ3JvdXBcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gZ3JvdXAoYWdncmVnYXRpb24pIHtcbiAgICAgIHZhciBfdGhpczQgPSB0aGlzO1xuXG4gICAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307XG4gICAgICB2YXIgYXV0b1N5bmMgPSBvcHRpb25zLmF1dG9TeW5jID09PSB0cnVlIHx8IHRoaXMuYXV0b1N5bmM7XG4gICAgICB2YXIgY2FjaGUgPSBuZXcgX2NhY2hlLkRhdGFTdG9yZUNhY2hlKHRoaXMuY29sbGVjdGlvbk5hbWUsIHRoaXMudGFnKTtcblxuICAgICAgdmFyIHN0cmVhbSA9IF9vYnNlcnZhYmxlLmRlZmF1bHQuY3JlYXRlKFxuICAgICAgLyojX19QVVJFX18qL1xuICAgICAgZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3JlZjMgPSAoMCwgX2FzeW5jVG9HZW5lcmF0b3IyLmRlZmF1bHQpKFxuICAgICAgICAvKiNfX1BVUkVfXyovXG4gICAgICAgIF9yZWdlbmVyYXRvci5kZWZhdWx0Lm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMob2JzZXJ2ZXIpIHtcbiAgICAgICAgICB2YXIgY2FjaGVSZXN1bHQsIG5ldHdvcmssIG5ldHdvcmtSZXN1bHQ7XG4gICAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvci5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0Mykge1xuICAgICAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLnByZXYgPSAwO1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAzO1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhY2hlLmdyb3VwKGFnZ3JlZ2F0aW9uKTtcblxuICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgIGNhY2hlUmVzdWx0ID0gX2NvbnRleHQzLnNlbnQ7XG4gICAgICAgICAgICAgICAgICBvYnNlcnZlci5uZXh0KGNhY2hlUmVzdWx0KTtcblxuICAgICAgICAgICAgICAgICAgaWYgKCFhdXRvU3luYykge1xuICAgICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDExO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgbmV0d29yayA9IG5ldyBfbmV0d29ya3N0b3JlLk5ldHdvcmtTdG9yZShfdGhpczQuY29sbGVjdGlvbk5hbWUpO1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA5O1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldHdvcmsuZ3JvdXAoYWdncmVnYXRpb24sIG9wdGlvbnMpLnRvUHJvbWlzZSgpO1xuXG4gICAgICAgICAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgICAgICAgbmV0d29ya1Jlc3VsdCA9IF9jb250ZXh0My5zZW50O1xuICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIubmV4dChuZXR3b3JrUmVzdWx0KTtcblxuICAgICAgICAgICAgICAgIGNhc2UgMTE6XG4gICAgICAgICAgICAgICAgICBvYnNlcnZlci5jb21wbGV0ZSgpO1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAxNztcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAxNDpcbiAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5wcmV2ID0gMTQ7XG4gICAgICAgICAgICAgICAgICBfY29udGV4dDMudDAgPSBfY29udGV4dDNbXCJjYXRjaFwiXSgwKTtcbiAgICAgICAgICAgICAgICAgIG9ic2VydmVyLmVycm9yKF9jb250ZXh0My50MCk7XG5cbiAgICAgICAgICAgICAgICBjYXNlIDE3OlxuICAgICAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSwgX2NhbGxlZTMsIHRoaXMsIFtbMCwgMTRdXSk7XG4gICAgICAgIH0pKTtcblxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKF94Mykge1xuICAgICAgICAgIHJldHVybiBfcmVmMy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICB9O1xuICAgICAgfSgpKTtcblxuICAgICAgcmV0dXJuIHN0cmVhbTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiZmluZEJ5SWRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gZmluZEJ5SWQoaWQpIHtcbiAgICAgIHZhciBfdGhpczUgPSB0aGlzO1xuXG4gICAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307XG5cbiAgICAgIHZhciBzdHJlYW0gPSBfb2JzZXJ2YWJsZS5kZWZhdWx0LmNyZWF0ZShcbiAgICAgIC8qI19fUFVSRV9fKi9cbiAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF9yZWY0ID0gKDAsIF9hc3luY1RvR2VuZXJhdG9yMi5kZWZhdWx0KShcbiAgICAgICAgLyojX19QVVJFX18qL1xuICAgICAgICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0KG9ic2VydmVyKSB7XG4gICAgICAgICAgdmFyIGF1dG9TeW5jLCBjYWNoZSwgY2FjaGVkRG9jLCBkb2M7XG4gICAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvci5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZTQkKF9jb250ZXh0NCkge1xuICAgICAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDQucHJldiA9IF9jb250ZXh0NC5uZXh0KSB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0LnByZXYgPSAwO1xuXG4gICAgICAgICAgICAgICAgICBpZiAoaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSA1O1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIubmV4dCh1bmRlZmluZWQpO1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAyMjtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgICAgYXV0b1N5bmMgPSBvcHRpb25zLmF1dG9TeW5jID09PSB0cnVlIHx8IF90aGlzNS5hdXRvU3luYztcbiAgICAgICAgICAgICAgICAgIGNhY2hlID0gbmV3IF9jYWNoZS5EYXRhU3RvcmVDYWNoZShfdGhpczUuY29sbGVjdGlvbk5hbWUsIF90aGlzNS50YWcpO1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSA5O1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhY2hlLmZpbmRCeUlkKGlkKTtcblxuICAgICAgICAgICAgICAgIGNhc2UgOTpcbiAgICAgICAgICAgICAgICAgIGNhY2hlZERvYyA9IF9jb250ZXh0NC5zZW50O1xuXG4gICAgICAgICAgICAgICAgICBpZiAoY2FjaGVkRG9jKSB7XG4gICAgICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMTY7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICBpZiAoYXV0b1N5bmMpIHtcbiAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAxMztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBfbm90Rm91bmQuZGVmYXVsdCgpO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAxMzpcbiAgICAgICAgICAgICAgICAgIG9ic2VydmVyLm5leHQodW5kZWZpbmVkKTtcbiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMTc7XG4gICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgMTY6XG4gICAgICAgICAgICAgICAgICBvYnNlcnZlci5uZXh0KGNhY2hlZERvYyk7XG5cbiAgICAgICAgICAgICAgICBjYXNlIDE3OlxuICAgICAgICAgICAgICAgICAgaWYgKCFhdXRvU3luYykge1xuICAgICAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDIyO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAyMDtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczUucHVsbEJ5SWQoaWQsIG9wdGlvbnMpO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAyMDpcbiAgICAgICAgICAgICAgICAgIGRvYyA9IF9jb250ZXh0NC5zZW50O1xuICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIubmV4dChkb2MpO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAyMjpcbiAgICAgICAgICAgICAgICAgIG9ic2VydmVyLmNvbXBsZXRlKCk7XG4gICAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDI4O1xuICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlIDI1OlxuICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0LnByZXYgPSAyNTtcbiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NC50MCA9IF9jb250ZXh0NFtcImNhdGNoXCJdKDApO1xuICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIuZXJyb3IoX2NvbnRleHQ0LnQwKTtcblxuICAgICAgICAgICAgICAgIGNhc2UgMjg6XG4gICAgICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5zdG9wKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LCBfY2FsbGVlNCwgdGhpcywgW1swLCAyNV1dKTtcbiAgICAgICAgfSkpO1xuXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoX3g0KSB7XG4gICAgICAgICAgcmV0dXJuIF9yZWY0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgIH07XG4gICAgICB9KCkpO1xuXG4gICAgICByZXR1cm4gc3RyZWFtO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJjcmVhdGVcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIF9jcmVhdGUgPSAoMCwgX2FzeW5jVG9HZW5lcmF0b3IyLmRlZmF1bHQpKFxuICAgICAgLyojX19QVVJFX18qL1xuICAgICAgX3JlZ2VuZXJhdG9yLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlNShkb2MpIHtcbiAgICAgICAgdmFyIG9wdGlvbnMsXG4gICAgICAgICAgICBhdXRvU3luYyxcbiAgICAgICAgICAgIGNhY2hlLFxuICAgICAgICAgICAgc3luYyxcbiAgICAgICAgICAgIGNhY2hlZERvYyxcbiAgICAgICAgICAgIHN5bmNEb2MsXG4gICAgICAgICAgICBxdWVyeSxcbiAgICAgICAgICAgIHB1c2hSZXN1bHRzLFxuICAgICAgICAgICAgcHVzaFJlc3VsdCxcbiAgICAgICAgICAgIF9hcmdzNSA9IGFyZ3VtZW50cztcbiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvci5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZTUkKF9jb250ZXh0NSkge1xuICAgICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NS5wcmV2ID0gX2NvbnRleHQ1Lm5leHQpIHtcbiAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgIG9wdGlvbnMgPSBfYXJnczUubGVuZ3RoID4gMSAmJiBfYXJnczVbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmdzNVsxXSA6IHt9O1xuXG4gICAgICAgICAgICAgICAgaWYgKCEoMCwgX2lzQXJyYXkuZGVmYXVsdCkoZG9jKSkge1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSAzO1xuICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IF9raW52ZXkuZGVmYXVsdCgnVW5hYmxlIHRvIGNyZWF0ZSBhbiBhcnJheSBvZiBlbnRpdGllcy4nLCAnUGxlYXNlIGNyZWF0ZSBlbnRpdGllcyBvbmUgYnkgb25lLicpO1xuXG4gICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICBhdXRvU3luYyA9IG9wdGlvbnMuYXV0b1N5bmMgPT09IHRydWUgfHwgdGhpcy5hdXRvU3luYztcbiAgICAgICAgICAgICAgICBjYWNoZSA9IG5ldyBfY2FjaGUuRGF0YVN0b3JlQ2FjaGUodGhpcy5jb2xsZWN0aW9uTmFtZSwgdGhpcy50YWcpO1xuICAgICAgICAgICAgICAgIHN5bmMgPSBuZXcgX3N5bmMyLlN5bmModGhpcy5jb2xsZWN0aW9uTmFtZSwgdGhpcy50YWcpO1xuICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gODtcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FjaGUuc2F2ZShkb2MpO1xuXG4gICAgICAgICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgICAgICBjYWNoZWREb2MgPSBfY29udGV4dDUuc2VudDtcbiAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDExO1xuICAgICAgICAgICAgICAgIHJldHVybiBzeW5jLmFkZENyZWF0ZVN5bmNFdmVudChjYWNoZWREb2MpO1xuXG4gICAgICAgICAgICAgIGNhc2UgMTE6XG4gICAgICAgICAgICAgICAgc3luY0RvYyA9IF9jb250ZXh0NS5zZW50O1xuXG4gICAgICAgICAgICAgICAgaWYgKCFhdXRvU3luYykge1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSAyMTtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHF1ZXJ5ID0gbmV3IF9xdWVyeS5kZWZhdWx0KCkuZXF1YWxUbygnX2lkJywgc3luY0RvYy5faWQpO1xuICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gMTY7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN5bmMucHVzaChxdWVyeSwgb3B0aW9ucyk7XG5cbiAgICAgICAgICAgICAgY2FzZSAxNjpcbiAgICAgICAgICAgICAgICBwdXNoUmVzdWx0cyA9IF9jb250ZXh0NS5zZW50O1xuICAgICAgICAgICAgICAgIHB1c2hSZXN1bHQgPSBwdXNoUmVzdWx0cy5zaGlmdCgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFwdXNoUmVzdWx0LmVycm9yKSB7XG4gICAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDIwO1xuICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhyb3cgcHVzaFJlc3VsdC5lcnJvcjtcblxuICAgICAgICAgICAgICBjYXNlIDIwOlxuICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuYWJydXB0KFwicmV0dXJuXCIsIHB1c2hSZXN1bHQuZW50aXR5KTtcblxuICAgICAgICAgICAgICBjYXNlIDIxOlxuICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuYWJydXB0KFwicmV0dXJuXCIsIGNhY2hlZERvYyk7XG5cbiAgICAgICAgICAgICAgY2FzZSAyMjpcbiAgICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuc3RvcCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSwgX2NhbGxlZTUsIHRoaXMpO1xuICAgICAgfSkpO1xuXG4gICAgICBmdW5jdGlvbiBjcmVhdGUoX3g1KSB7XG4gICAgICAgIHJldHVybiBfY3JlYXRlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBjcmVhdGU7XG4gICAgfSgpXG4gIH0sIHtcbiAgICBrZXk6IFwidXBkYXRlXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBfdXBkYXRlID0gKDAsIF9hc3luY1RvR2VuZXJhdG9yMi5kZWZhdWx0KShcbiAgICAgIC8qI19fUFVSRV9fKi9cbiAgICAgIF9yZWdlbmVyYXRvci5kZWZhdWx0Lm1hcmsoZnVuY3Rpb24gX2NhbGxlZTYoZG9jKSB7XG4gICAgICAgIHZhciBvcHRpb25zLFxuICAgICAgICAgICAgYXV0b1N5bmMsXG4gICAgICAgICAgICBjYWNoZSxcbiAgICAgICAgICAgIHN5bmMsXG4gICAgICAgICAgICBjYWNoZWREb2MsXG4gICAgICAgICAgICBzeW5jRG9jLFxuICAgICAgICAgICAgcXVlcnksXG4gICAgICAgICAgICBwdXNoUmVzdWx0cyxcbiAgICAgICAgICAgIHB1c2hSZXN1bHQsXG4gICAgICAgICAgICBfYXJnczYgPSBhcmd1bWVudHM7XG4gICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3IuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWU2JChfY29udGV4dDYpIHtcbiAgICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDYucHJldiA9IF9jb250ZXh0Ni5uZXh0KSB7XG4gICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICBvcHRpb25zID0gX2FyZ3M2Lmxlbmd0aCA+IDEgJiYgX2FyZ3M2WzFdICE9PSB1bmRlZmluZWQgPyBfYXJnczZbMV0gOiB7fTtcblxuICAgICAgICAgICAgICAgIGlmICghKDAsIF9pc0FycmF5LmRlZmF1bHQpKGRvYykpIHtcbiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMztcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBfa2ludmV5LmRlZmF1bHQoJ1VuYWJsZSB0byB1cGRhdGUgYW4gYXJyYXkgb2YgZW50aXRpZXMuJywgJ1BsZWFzZSB1cGRhdGUgZW50aXRpZXMgb25lIGJ5IG9uZS4nKTtcblxuICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgaWYgKGRvYy5faWQpIHtcbiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gNTtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBfa2ludmV5LmRlZmF1bHQoJ1RoZSBlbnRpdHkgcHJvdmlkZWQgZG9lcyBub3QgY29udGFpbiBhbiBfaWQuIEFuIF9pZCBpcyByZXF1aXJlZCB0byB1cGRhdGUgdGhlIGVudGl0eS4nLCBkb2MpO1xuXG4gICAgICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgICAgICBhdXRvU3luYyA9IG9wdGlvbnMuYXV0b1N5bmMgPT09IHRydWUgfHwgdGhpcy5hdXRvU3luYztcbiAgICAgICAgICAgICAgICBjYWNoZSA9IG5ldyBfY2FjaGUuRGF0YVN0b3JlQ2FjaGUodGhpcy5jb2xsZWN0aW9uTmFtZSwgdGhpcy50YWcpO1xuICAgICAgICAgICAgICAgIHN5bmMgPSBuZXcgX3N5bmMyLlN5bmModGhpcy5jb2xsZWN0aW9uTmFtZSwgdGhpcy50YWcpO1xuICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMTA7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhY2hlLnNhdmUoZG9jKTtcblxuICAgICAgICAgICAgICBjYXNlIDEwOlxuICAgICAgICAgICAgICAgIGNhY2hlZERvYyA9IF9jb250ZXh0Ni5zZW50O1xuICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMTM7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN5bmMuYWRkVXBkYXRlU3luY0V2ZW50KGNhY2hlZERvYyk7XG5cbiAgICAgICAgICAgICAgY2FzZSAxMzpcbiAgICAgICAgICAgICAgICBzeW5jRG9jID0gX2NvbnRleHQ2LnNlbnQ7XG5cbiAgICAgICAgICAgICAgICBpZiAoIWF1dG9TeW5jKSB7XG4gICAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDIzO1xuICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcXVlcnkgPSBuZXcgX3F1ZXJ5LmRlZmF1bHQoKS5lcXVhbFRvKCdfaWQnLCBzeW5jRG9jLl9pZCk7XG4gICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSAxODtcbiAgICAgICAgICAgICAgICByZXR1cm4gc3luYy5wdXNoKHF1ZXJ5LCBvcHRpb25zKTtcblxuICAgICAgICAgICAgICBjYXNlIDE4OlxuICAgICAgICAgICAgICAgIHB1c2hSZXN1bHRzID0gX2NvbnRleHQ2LnNlbnQ7XG4gICAgICAgICAgICAgICAgcHVzaFJlc3VsdCA9IHB1c2hSZXN1bHRzLnNoaWZ0KCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIXB1c2hSZXN1bHQuZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMjI7XG4gICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aHJvdyBwdXNoUmVzdWx0LmVycm9yO1xuXG4gICAgICAgICAgICAgIGNhc2UgMjI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5hYnJ1cHQoXCJyZXR1cm5cIiwgcHVzaFJlc3VsdC5lbnRpdHkpO1xuXG4gICAgICAgICAgICAgIGNhc2UgMjM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5hYnJ1cHQoXCJyZXR1cm5cIiwgY2FjaGVkRG9jKTtcblxuICAgICAgICAgICAgICBjYXNlIDI0OlxuICAgICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5zdG9wKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LCBfY2FsbGVlNiwgdGhpcyk7XG4gICAgICB9KSk7XG5cbiAgICAgIGZ1bmN0aW9uIHVwZGF0ZShfeDYpIHtcbiAgICAgICAgcmV0dXJuIF91cGRhdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHVwZGF0ZTtcbiAgICB9KClcbiAgfSwge1xuICAgIGtleTogXCJzYXZlXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHNhdmUoZG9jLCBvcHRpb25zKSB7XG4gICAgICBpZiAoZG9jLl9pZCkge1xuICAgICAgICByZXR1cm4gdGhpcy51cGRhdGUoZG9jLCBvcHRpb25zKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlKGRvYywgb3B0aW9ucyk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInJlbW92ZVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgX3JlbW92ZSA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gICAgICAvKiNfX1BVUkVfXyovXG4gICAgICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU3KHF1ZXJ5KSB7XG4gICAgICAgIHZhciBvcHRpb25zLFxuICAgICAgICAgICAgYXV0b1N5bmMsXG4gICAgICAgICAgICBjYWNoZSxcbiAgICAgICAgICAgIHN5bmMsXG4gICAgICAgICAgICBjb3VudCxcbiAgICAgICAgICAgIGRvY3MsXG4gICAgICAgICAgICBmaW5kUXVlcnksXG4gICAgICAgICAgICBzeW5jRG9jcyxcbiAgICAgICAgICAgIHB1c2hRdWVyeSxcbiAgICAgICAgICAgIHB1c2hSZXN1bHRzLFxuICAgICAgICAgICAgX2FyZ3M3ID0gYXJndW1lbnRzO1xuICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yLmRlZmF1bHQud3JhcChmdW5jdGlvbiBfY2FsbGVlNyQoX2NvbnRleHQ3KSB7XG4gICAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ3LnByZXYgPSBfY29udGV4dDcubmV4dCkge1xuICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgb3B0aW9ucyA9IF9hcmdzNy5sZW5ndGggPiAxICYmIF9hcmdzN1sxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3M3WzFdIDoge307XG4gICAgICAgICAgICAgICAgYXV0b1N5bmMgPSBvcHRpb25zLmF1dG9TeW5jID09PSB0cnVlIHx8IHRoaXMuYXV0b1N5bmM7XG4gICAgICAgICAgICAgICAgY2FjaGUgPSBuZXcgX2NhY2hlLkRhdGFTdG9yZUNhY2hlKHRoaXMuY29sbGVjdGlvbk5hbWUsIHRoaXMudGFnKTtcbiAgICAgICAgICAgICAgICBzeW5jID0gbmV3IF9zeW5jMi5TeW5jKHRoaXMuY29sbGVjdGlvbk5hbWUsIHRoaXMudGFnKTtcbiAgICAgICAgICAgICAgICBjb3VudCA9IDA7IC8vIEZpbmQgdGhlIGRvY3MgdGhhdCB3aWxsIGJlIHJlbW92ZWQgZnJvbSB0aGUgY2FjaGUgdGhhdCBtYXRjaCB0aGUgcXVlcnlcblxuICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gNztcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FjaGUuZmluZChxdWVyeSk7XG5cbiAgICAgICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgICAgIGRvY3MgPSBfY29udGV4dDcuc2VudDtcblxuICAgICAgICAgICAgICAgIGlmICghKGRvY3MubGVuZ3RoID4gMCkpIHtcbiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMTQ7XG4gICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBfY29udGV4dDcubmV4dCA9IDExO1xuICAgICAgICAgICAgICAgIHJldHVybiBjYWNoZS5yZW1vdmUocXVlcnkpO1xuXG4gICAgICAgICAgICAgIGNhc2UgMTE6XG4gICAgICAgICAgICAgICAgY291bnQgPSBfY29udGV4dDcuc2VudDtcbiAgICAgICAgICAgICAgICBfY29udGV4dDcubmV4dCA9IDE0O1xuICAgICAgICAgICAgICAgIHJldHVybiBzeW5jLmFkZERlbGV0ZVN5bmNFdmVudChkb2NzKTtcblxuICAgICAgICAgICAgICBjYXNlIDE0OlxuICAgICAgICAgICAgICAgIGlmICghYXV0b1N5bmMpIHtcbiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMjU7XG4gICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmaW5kUXVlcnkgPSAoMCwgX3N5bmMyLnF1ZXJ5VG9TeW5jUXVlcnkpKHF1ZXJ5LCB0aGlzLmNvbGxlY3Rpb25OYW1lKTtcbiAgICAgICAgICAgICAgICBfY29udGV4dDcubmV4dCA9IDE4O1xuICAgICAgICAgICAgICAgIHJldHVybiBzeW5jLmZpbmQoZmluZFF1ZXJ5KTtcblxuICAgICAgICAgICAgICBjYXNlIDE4OlxuICAgICAgICAgICAgICAgIHN5bmNEb2NzID0gX2NvbnRleHQ3LnNlbnQ7XG5cbiAgICAgICAgICAgICAgICBpZiAoIShzeW5jRG9jcy5sZW5ndGggPiAwKSkge1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSAyNTtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHB1c2hRdWVyeSA9IG5ldyBfcXVlcnkuZGVmYXVsdCgpLmNvbnRhaW5zKCdfaWQnLCBzeW5jRG9jcy5tYXAoZnVuY3Rpb24gKGRvYykge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGRvYy5faWQ7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMjM7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN5bmMucHVzaChwdXNoUXVlcnkpO1xuXG4gICAgICAgICAgICAgIGNhc2UgMjM6XG4gICAgICAgICAgICAgICAgcHVzaFJlc3VsdHMgPSBfY29udGV4dDcuc2VudDtcbiAgICAgICAgICAgICAgICBjb3VudCA9IHB1c2hSZXN1bHRzLnJlZHVjZShmdW5jdGlvbiAoY291bnQsIHB1c2hSZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgIGlmIChwdXNoUmVzdWx0LmVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjb3VudCAtIDE7XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIHJldHVybiBjb3VudDtcbiAgICAgICAgICAgICAgICB9LCBjb3VudCB8fCBzeW5jRG9jcy5sZW5ndGgpO1xuXG4gICAgICAgICAgICAgIGNhc2UgMjU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5hYnJ1cHQoXCJyZXR1cm5cIiwge1xuICAgICAgICAgICAgICAgICAgY291bnQ6IGNvdW50XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgY2FzZSAyNjpcbiAgICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuc3RvcCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSwgX2NhbGxlZTcsIHRoaXMpO1xuICAgICAgfSkpO1xuXG4gICAgICBmdW5jdGlvbiByZW1vdmUoX3g3KSB7XG4gICAgICAgIHJldHVybiBfcmVtb3ZlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiByZW1vdmU7XG4gICAgfSgpXG4gIH0sIHtcbiAgICBrZXk6IFwicmVtb3ZlQnlJZFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgX3JlbW92ZUJ5SWQgPSAoMCwgX2FzeW5jVG9HZW5lcmF0b3IyLmRlZmF1bHQpKFxuICAgICAgLyojX19QVVJFX18qL1xuICAgICAgX3JlZ2VuZXJhdG9yLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlOChpZCkge1xuICAgICAgICB2YXIgb3B0aW9ucyxcbiAgICAgICAgICAgIGF1dG9TeW5jLFxuICAgICAgICAgICAgY2FjaGUsXG4gICAgICAgICAgICBzeW5jLFxuICAgICAgICAgICAgY291bnQsXG4gICAgICAgICAgICBkb2MsXG4gICAgICAgICAgICBzeW5jRG9jLFxuICAgICAgICAgICAgcXVlcnksXG4gICAgICAgICAgICBwdXNoUmVzdWx0cyxcbiAgICAgICAgICAgIHB1c2hSZXN1bHQsXG4gICAgICAgICAgICBfYXJnczggPSBhcmd1bWVudHM7XG4gICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3IuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWU4JChfY29udGV4dDgpIHtcbiAgICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDgucHJldiA9IF9jb250ZXh0OC5uZXh0KSB7XG4gICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICBvcHRpb25zID0gX2FyZ3M4Lmxlbmd0aCA+IDEgJiYgX2FyZ3M4WzFdICE9PSB1bmRlZmluZWQgPyBfYXJnczhbMV0gOiB7fTtcbiAgICAgICAgICAgICAgICBhdXRvU3luYyA9IG9wdGlvbnMuYXV0b1N5bmMgPT09IHRydWUgfHwgdGhpcy5hdXRvU3luYztcbiAgICAgICAgICAgICAgICBjYWNoZSA9IG5ldyBfY2FjaGUuRGF0YVN0b3JlQ2FjaGUodGhpcy5jb2xsZWN0aW9uTmFtZSwgdGhpcy50YWcpO1xuICAgICAgICAgICAgICAgIHN5bmMgPSBuZXcgX3N5bmMyLlN5bmModGhpcy5jb2xsZWN0aW9uTmFtZSwgdGhpcy50YWcpO1xuICAgICAgICAgICAgICAgIGNvdW50ID0gMDtcblxuICAgICAgICAgICAgICAgIGlmICghaWQpIHtcbiAgICAgICAgICAgICAgICAgIF9jb250ZXh0OC5uZXh0ID0gMjg7XG4gICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBfY29udGV4dDgubmV4dCA9IDg7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhY2hlLmZpbmRCeUlkKGlkKTtcblxuICAgICAgICAgICAgICBjYXNlIDg6XG4gICAgICAgICAgICAgICAgZG9jID0gX2NvbnRleHQ4LnNlbnQ7XG5cbiAgICAgICAgICAgICAgICBpZiAoIWRvYykge1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQ4Lm5leHQgPSAyNztcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIF9jb250ZXh0OC5uZXh0ID0gMTI7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhY2hlLnJlbW92ZUJ5SWQoaWQpO1xuXG4gICAgICAgICAgICAgIGNhc2UgMTI6XG4gICAgICAgICAgICAgICAgY291bnQgPSBfY29udGV4dDguc2VudDtcbiAgICAgICAgICAgICAgICBfY29udGV4dDgubmV4dCA9IDE1O1xuICAgICAgICAgICAgICAgIHJldHVybiBzeW5jLmFkZERlbGV0ZVN5bmNFdmVudChkb2MpO1xuXG4gICAgICAgICAgICAgIGNhc2UgMTU6XG4gICAgICAgICAgICAgICAgc3luY0RvYyA9IF9jb250ZXh0OC5zZW50O1xuXG4gICAgICAgICAgICAgICAgaWYgKCEoYXV0b1N5bmMgJiYgc3luY0RvYykpIHtcbiAgICAgICAgICAgICAgICAgIF9jb250ZXh0OC5uZXh0ID0gMjQ7XG4gICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBxdWVyeSA9IG5ldyBfcXVlcnkuZGVmYXVsdCgpLmVxdWFsVG8oJ19pZCcsIHN5bmNEb2MuX2lkKTtcbiAgICAgICAgICAgICAgICBfY29udGV4dDgubmV4dCA9IDIwO1xuICAgICAgICAgICAgICAgIHJldHVybiBzeW5jLnB1c2gocXVlcnkpO1xuXG4gICAgICAgICAgICAgIGNhc2UgMjA6XG4gICAgICAgICAgICAgICAgcHVzaFJlc3VsdHMgPSBfY29udGV4dDguc2VudDtcblxuICAgICAgICAgICAgICAgIGlmIChwdXNoUmVzdWx0cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICBwdXNoUmVzdWx0ID0gcHVzaFJlc3VsdHMuc2hpZnQoKTtcblxuICAgICAgICAgICAgICAgICAgaWYgKHB1c2hSZXN1bHQuZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgY291bnQgLT0gMTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBfY29udGV4dDgubmV4dCA9IDI1O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgIGNhc2UgMjQ6XG4gICAgICAgICAgICAgICAgY291bnQgPSAxO1xuXG4gICAgICAgICAgICAgIGNhc2UgMjU6XG4gICAgICAgICAgICAgICAgX2NvbnRleHQ4Lm5leHQgPSAyODtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICBjYXNlIDI3OlxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBfbm90Rm91bmQuZGVmYXVsdCgpO1xuXG4gICAgICAgICAgICAgIGNhc2UgMjg6XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OC5hYnJ1cHQoXCJyZXR1cm5cIiwge1xuICAgICAgICAgICAgICAgICAgY291bnQ6IGNvdW50XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgY2FzZSAyOTpcbiAgICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDguc3RvcCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSwgX2NhbGxlZTgsIHRoaXMpO1xuICAgICAgfSkpO1xuXG4gICAgICBmdW5jdGlvbiByZW1vdmVCeUlkKF94OCkge1xuICAgICAgICByZXR1cm4gX3JlbW92ZUJ5SWQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHJlbW92ZUJ5SWQ7XG4gICAgfSgpXG4gIH0sIHtcbiAgICBrZXk6IFwiY2xlYXJcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIF9jbGVhciA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gICAgICAvKiNfX1BVUkVfXyovXG4gICAgICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU5KHF1ZXJ5KSB7XG4gICAgICAgIHZhciBjYWNoZSwgY291bnQsIHF1ZXJ5Q2FjaGU7XG4gICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3IuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWU5JChfY29udGV4dDkpIHtcbiAgICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDkucHJldiA9IF9jb250ZXh0OS5uZXh0KSB7XG4gICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAvLyBSZW1vdmUgdGhlIGRvY3MgZnJvbSB0aGUgY2FjaGVcbiAgICAgICAgICAgICAgICBjYWNoZSA9IG5ldyBfY2FjaGUuRGF0YVN0b3JlQ2FjaGUodGhpcy5jb2xsZWN0aW9uTmFtZSwgdGhpcy50YWcpO1xuICAgICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gMztcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FjaGUucmVtb3ZlKHF1ZXJ5KTtcblxuICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgY291bnQgPSBfY29udGV4dDkuc2VudDtcbiAgICAgICAgICAgICAgICBfY29udGV4dDkubmV4dCA9IDY7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2xlYXJTeW5jKHF1ZXJ5KTtcblxuICAgICAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICAgICAgLy8gQ2xlYXIgdGhlIHF1ZXJ5IGNhY2hlXG4gICAgICAgICAgICAgICAgaWYgKCFxdWVyeSkge1xuICAgICAgICAgICAgICAgICAgcXVlcnlDYWNoZSA9IG5ldyBfY2FjaGUuUXVlcnlDYWNoZSh0aGlzLnRhZyk7XG4gICAgICAgICAgICAgICAgICBxdWVyeUNhY2hlLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIH0gLy8gUmV0dXJuIHRoZSBjb3VuZFxuXG5cbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ5LmFicnVwdChcInJldHVyblwiLCB7XG4gICAgICAgICAgICAgICAgICBjb3VudDogY291bnRcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICBjYXNlIDg6XG4gICAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ5LnN0b3AoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sIF9jYWxsZWU5LCB0aGlzKTtcbiAgICAgIH0pKTtcblxuICAgICAgZnVuY3Rpb24gY2xlYXIoX3g5KSB7XG4gICAgICAgIHJldHVybiBfY2xlYXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGNsZWFyO1xuICAgIH0oKVxuICB9LCB7XG4gICAga2V5OiBcInB1c2hcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gcHVzaChxdWVyeSwgb3B0aW9ucykge1xuICAgICAgdmFyIHN5bmMgPSBuZXcgX3N5bmMyLlN5bmModGhpcy5jb2xsZWN0aW9uTmFtZSwgdGhpcy50YWcpO1xuICAgICAgcmV0dXJuIHN5bmMucHVzaChudWxsLCBvcHRpb25zKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwicHVsbFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgX3B1bGwgPSAoMCwgX2FzeW5jVG9HZW5lcmF0b3IyLmRlZmF1bHQpKFxuICAgICAgLyojX19QVVJFX18qL1xuICAgICAgX3JlZ2VuZXJhdG9yLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlMTAocXVlcnkpIHtcbiAgICAgICAgdmFyIG9wdGlvbnMsXG4gICAgICAgICAgICBuZXR3b3JrLFxuICAgICAgICAgICAgY2FjaGUsXG4gICAgICAgICAgICBxdWVyeUNhY2hlLFxuICAgICAgICAgICAgdXNlRGVsdGFTZXQsXG4gICAgICAgICAgICB1c2VBdXRvUGFnaW5hdGlvbixcbiAgICAgICAgICAgIGNvdW50LFxuICAgICAgICAgICAga2V5LFxuICAgICAgICAgICAgcXVlcnlDYWNoZURvYyxcbiAgICAgICAgICAgIHF1ZXJ5T2JqZWN0LFxuICAgICAgICAgICAgX2dldENvbmZpZyxcbiAgICAgICAgICAgIGFwaVByb3RvY29sLFxuICAgICAgICAgICAgYXBpSG9zdCxcbiAgICAgICAgICAgIGFwcEtleSxcbiAgICAgICAgICAgIHVybCxcbiAgICAgICAgICAgIHJlcXVlc3QsXG4gICAgICAgICAgICBfcmVzcG9uc2UsXG4gICAgICAgICAgICBfcmVzcG9uc2UkZGF0YSxcbiAgICAgICAgICAgIGNoYW5nZWQsXG4gICAgICAgICAgICBkZWxldGVkLFxuICAgICAgICAgICAgcmVtb3ZlUXVlcnksXG4gICAgICAgICAgICBfcmVzcG9uc2UyLFxuICAgICAgICAgICAgX2NvdW50LFxuICAgICAgICAgICAgcGFnZVNpemUsXG4gICAgICAgICAgICBwYWdlQ291bnQsXG4gICAgICAgICAgICBwYWdlUXVlcmllcyxcbiAgICAgICAgICAgIHBhZ2VQcm9taXNlcyxcbiAgICAgICAgICAgIHBhZ2VDb3VudHMsXG4gICAgICAgICAgICB0b3RhbFBhZ2VDb3VudCxcbiAgICAgICAgICAgIHJlc3BvbnNlLFxuICAgICAgICAgICAgZG9jcyxcbiAgICAgICAgICAgIF9hcmdzMTAgPSBhcmd1bWVudHM7XG5cbiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvci5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZTEwJChfY29udGV4dDEwKSB7XG4gICAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMC5wcmV2ID0gX2NvbnRleHQxMC5uZXh0KSB7XG4gICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICBvcHRpb25zID0gX2FyZ3MxMC5sZW5ndGggPiAxICYmIF9hcmdzMTBbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmdzMTBbMV0gOiB7fTtcbiAgICAgICAgICAgICAgICBuZXR3b3JrID0gbmV3IF9uZXR3b3Jrc3RvcmUuTmV0d29ya1N0b3JlKHRoaXMuY29sbGVjdGlvbk5hbWUpO1xuICAgICAgICAgICAgICAgIGNhY2hlID0gbmV3IF9jYWNoZS5EYXRhU3RvcmVDYWNoZSh0aGlzLmNvbGxlY3Rpb25OYW1lLCB0aGlzLnRhZyk7XG4gICAgICAgICAgICAgICAgcXVlcnlDYWNoZSA9IG5ldyBfY2FjaGUuUXVlcnlDYWNoZSh0aGlzLnRhZyk7XG4gICAgICAgICAgICAgICAgdXNlRGVsdGFTZXQgPSBvcHRpb25zLnVzZURlbHRhU2V0ID09PSB0cnVlIHx8IHRoaXMudXNlRGVsdGFTZXQ7XG4gICAgICAgICAgICAgICAgdXNlQXV0b1BhZ2luYXRpb24gPSBvcHRpb25zLnVzZUF1dG9QYWdpbmF0aW9uID09PSB0cnVlIHx8IG9wdGlvbnMuYXV0b1BhZ2luYXRpb24gfHwgdGhpcy51c2VBdXRvUGFnaW5hdGlvbjsgLy8gUHVzaCBzeW5jIHF1ZXVlXG5cbiAgICAgICAgICAgICAgICBfY29udGV4dDEwLm5leHQgPSA4O1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnBlbmRpbmdTeW5jQ291bnQoKTtcblxuICAgICAgICAgICAgICBjYXNlIDg6XG4gICAgICAgICAgICAgICAgY291bnQgPSBfY29udGV4dDEwLnNlbnQ7XG5cbiAgICAgICAgICAgICAgICBpZiAoIShjb3VudCA+IDApKSB7XG4gICAgICAgICAgICAgICAgICBfY29udGV4dDEwLm5leHQgPSAxMztcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICghKGNvdW50ID09PSAxKSkge1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQxMC5uZXh0ID0gMTI7XG4gICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX2tpbnZleS5kZWZhdWx0KFwiVW5hYmxlIHRvIHB1bGwgZW50aXRpZXMgZnJvbSB0aGUgYmFja2VuZC4gVGhlcmUgaXMgXCIuY29uY2F0KGNvdW50LCBcIiBlbnRpdHlcIikgKyAnIHRoYXQgbmVlZHMgdG8gYmUgcHVzaGVkIHRvIHRoZSBiYWNrZW5kLicpO1xuXG4gICAgICAgICAgICAgIGNhc2UgMTI6XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IF9raW52ZXkuZGVmYXVsdChcIlVuYWJsZSB0byBwdWxsIGVudGl0aWVzIGZyb20gdGhlIGJhY2tlbmQuIFRoZXJlIGFyZSBcIi5jb25jYXQoY291bnQsIFwiIGVudGl0aWVzXCIpICsgJyB0aGF0IG5lZWQgdG8gYmUgcHVzaGVkIHRvIHRoZSBiYWNrZW5kLicpO1xuXG4gICAgICAgICAgICAgIGNhc2UgMTM6XG4gICAgICAgICAgICAgICAgaWYgKCEodXNlRGVsdGFTZXQgJiYgKCFxdWVyeSB8fCBxdWVyeS5za2lwID09PSAwICYmIHF1ZXJ5LmxpbWl0ID09PSBJbmZpbml0eSkpKSB7XG4gICAgICAgICAgICAgICAgICBfY29udGV4dDEwLm5leHQgPSA0NTtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIF9jb250ZXh0MTAucHJldiA9IDE0O1xuICAgICAgICAgICAgICAgIGtleSA9IHF1ZXJ5Q2FjaGUuc2VyaWFsaXplUXVlcnkocXVlcnkpO1xuICAgICAgICAgICAgICAgIF9jb250ZXh0MTAubmV4dCA9IDE4O1xuICAgICAgICAgICAgICAgIHJldHVybiBxdWVyeUNhY2hlLmZpbmRCeUtleShrZXkpO1xuXG4gICAgICAgICAgICAgIGNhc2UgMTg6XG4gICAgICAgICAgICAgICAgcXVlcnlDYWNoZURvYyA9IF9jb250ZXh0MTAuc2VudDtcblxuICAgICAgICAgICAgICAgIGlmICghKHF1ZXJ5Q2FjaGVEb2MgJiYgcXVlcnlDYWNoZURvYy5sYXN0UmVxdWVzdCkpIHtcbiAgICAgICAgICAgICAgICAgIF9jb250ZXh0MTAubmV4dCA9IDM5O1xuICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcXVlcnlPYmplY3QgPSB7XG4gICAgICAgICAgICAgICAgICBzaW5jZTogcXVlcnlDYWNoZURvYy5sYXN0UmVxdWVzdFxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBpZiAocXVlcnkpIHtcbiAgICAgICAgICAgICAgICAgIHF1ZXJ5T2JqZWN0ID0gT2JqZWN0LmFzc2lnbih7fSwgcXVlcnkudG9RdWVyeU9iamVjdCgpLCBxdWVyeU9iamVjdCk7XG4gICAgICAgICAgICAgICAgfSAvLyBEZWx0YSBTZXQgcmVxdWVzdFxuXG5cbiAgICAgICAgICAgICAgICBfZ2V0Q29uZmlnID0gKDAsIF9jb25maWcuZ2V0KSgpLCBhcGlQcm90b2NvbCA9IF9nZXRDb25maWcuYXBpUHJvdG9jb2wsIGFwaUhvc3QgPSBfZ2V0Q29uZmlnLmFwaUhvc3QsIGFwcEtleSA9IF9nZXRDb25maWcuYXBwS2V5O1xuICAgICAgICAgICAgICAgIHVybCA9ICgwLCBfdXRpbHMuZm9ybWF0S2ludmV5VXJsKShhcGlQcm90b2NvbCwgYXBpSG9zdCwgXCIvYXBwZGF0YS9cIi5jb25jYXQoYXBwS2V5LCBcIi9cIikuY29uY2F0KHRoaXMuY29sbGVjdGlvbk5hbWUsIFwiL19kZWx0YXNldFwiKSwgcXVlcnlPYmplY3QpO1xuICAgICAgICAgICAgICAgIHJlcXVlc3QgPSBuZXcgX3JlcXVlc3QuS2ludmV5UmVxdWVzdCh7XG4gICAgICAgICAgICAgICAgICBtZXRob2Q6IF9yZXF1ZXN0LlJlcXVlc3RNZXRob2QuR0VULFxuICAgICAgICAgICAgICAgICAgYXV0aDogX2F1dGguQXV0aC5TZXNzaW9uLFxuICAgICAgICAgICAgICAgICAgdXJsOiB1cmxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBfY29udGV4dDEwLm5leHQgPSAyNztcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVxdWVzdC5leGVjdXRlKCk7XG5cbiAgICAgICAgICAgICAgY2FzZSAyNzpcbiAgICAgICAgICAgICAgICBfcmVzcG9uc2UgPSBfY29udGV4dDEwLnNlbnQ7XG4gICAgICAgICAgICAgICAgX3Jlc3BvbnNlJGRhdGEgPSBfcmVzcG9uc2UuZGF0YSwgY2hhbmdlZCA9IF9yZXNwb25zZSRkYXRhLmNoYW5nZWQsIGRlbGV0ZWQgPSBfcmVzcG9uc2UkZGF0YS5kZWxldGVkOyAvLyBEZWxldGUgdGhlIGRvY3MgdGhhdCBoYXZlIGJlZW4gZGVsZXRlZFxuXG4gICAgICAgICAgICAgICAgaWYgKCEoQXJyYXkuaXNBcnJheShkZWxldGVkKSAmJiBkZWxldGVkLmxlbmd0aCA+IDApKSB7XG4gICAgICAgICAgICAgICAgICBfY29udGV4dDEwLm5leHQgPSAzMztcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJlbW92ZVF1ZXJ5ID0gbmV3IF9xdWVyeS5kZWZhdWx0KCkuY29udGFpbnMoJ19pZCcsIGRlbGV0ZWQubWFwKGZ1bmN0aW9uIChkb2MpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBkb2MuX2lkO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICBfY29udGV4dDEwLm5leHQgPSAzMztcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FjaGUucmVtb3ZlKHJlbW92ZVF1ZXJ5KTtcblxuICAgICAgICAgICAgICBjYXNlIDMzOlxuICAgICAgICAgICAgICAgIGlmICghKEFycmF5LmlzQXJyYXkoY2hhbmdlZCkgJiYgY2hhbmdlZC5sZW5ndGggPiAwKSkge1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQxMC5uZXh0ID0gMzY7XG4gICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBfY29udGV4dDEwLm5leHQgPSAzNjtcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FjaGUuc2F2ZShjaGFuZ2VkKTtcblxuICAgICAgICAgICAgICBjYXNlIDM2OlxuICAgICAgICAgICAgICAgIF9jb250ZXh0MTAubmV4dCA9IDM4O1xuICAgICAgICAgICAgICAgIHJldHVybiBxdWVyeUNhY2hlLnNhdmUocXVlcnksIF9yZXNwb25zZSk7XG5cbiAgICAgICAgICAgICAgY2FzZSAzODpcbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMC5hYnJ1cHQoXCJyZXR1cm5cIiwgY2hhbmdlZC5sZW5ndGgpO1xuXG4gICAgICAgICAgICAgIGNhc2UgMzk6XG4gICAgICAgICAgICAgICAgX2NvbnRleHQxMC5uZXh0ID0gNDU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgY2FzZSA0MTpcbiAgICAgICAgICAgICAgICBfY29udGV4dDEwLnByZXYgPSA0MTtcbiAgICAgICAgICAgICAgICBfY29udGV4dDEwLnQwID0gX2NvbnRleHQxMFtcImNhdGNoXCJdKDE0KTtcblxuICAgICAgICAgICAgICAgIGlmICghKCEoX2NvbnRleHQxMC50MCBpbnN0YW5jZW9mIF9taXNzaW5nQ29uZmlndXJhdGlvbi5kZWZhdWx0KSAmJiAhKF9jb250ZXh0MTAudDAgaW5zdGFuY2VvZiBfcGFyYW1ldGVyVmFsdWVPdXRPZlJhbmdlLmRlZmF1bHQpKSkge1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQxMC5uZXh0ID0gNDU7XG4gICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aHJvdyBfY29udGV4dDEwLnQwO1xuXG4gICAgICAgICAgICAgIGNhc2UgNDU6XG4gICAgICAgICAgICAgICAgaWYgKCF1c2VBdXRvUGFnaW5hdGlvbikge1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQxMC5uZXh0ID0gNjI7XG4gICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBfY29udGV4dDEwLm5leHQgPSA0ODtcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FjaGUuY2xlYXIoKTtcblxuICAgICAgICAgICAgICBjYXNlIDQ4OlxuICAgICAgICAgICAgICAgIF9jb250ZXh0MTAubmV4dCA9IDUwO1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXR3b3JrLmNvdW50KHF1ZXJ5LCBPYmplY3QuYXNzaWduKHt9LCBvcHRpb25zLCB7XG4gICAgICAgICAgICAgICAgICByYXdSZXNwb25zZTogdHJ1ZVxuICAgICAgICAgICAgICAgIH0pKS50b1Byb21pc2UoKTtcblxuICAgICAgICAgICAgICBjYXNlIDUwOlxuICAgICAgICAgICAgICAgIF9yZXNwb25zZTIgPSBfY29udGV4dDEwLnNlbnQ7XG4gICAgICAgICAgICAgICAgX2NvdW50ID0gJ2NvdW50JyBpbiBfcmVzcG9uc2UyLmRhdGEgPyBfcmVzcG9uc2UyLmRhdGEuY291bnQgOiBJbmZpbml0eTsgLy8gQ3JlYXRlIHRoZSBwYWdlc1xuXG4gICAgICAgICAgICAgICAgcGFnZVNpemUgPSBvcHRpb25zLmF1dG9QYWdpbmF0aW9uUGFnZVNpemUgfHwgb3B0aW9ucy5hdXRvUGFnaW5hdGlvbiAmJiBvcHRpb25zLmF1dG9QYWdpbmF0aW9uLnBhZ2VTaXplIHx8IFBBR0VfTElNSVQ7XG4gICAgICAgICAgICAgICAgcGFnZUNvdW50ID0gTWF0aC5jZWlsKF9jb3VudCAvIHBhZ2VTaXplKTtcbiAgICAgICAgICAgICAgICBwYWdlUXVlcmllcyA9ICgwLCBfdGltZXMuZGVmYXVsdCkocGFnZUNvdW50LCBmdW5jdGlvbiAoaSkge1xuICAgICAgICAgICAgICAgICAgdmFyIHBhZ2VRdWVyeSA9IG5ldyBfcXVlcnkuZGVmYXVsdChxdWVyeSk7XG4gICAgICAgICAgICAgICAgICBwYWdlUXVlcnkuc2tpcCA9IGkgKiBwYWdlU2l6ZTtcbiAgICAgICAgICAgICAgICAgIHBhZ2VRdWVyeS5saW1pdCA9IE1hdGgubWluKF9jb3VudCAtIGkgKiBwYWdlU2l6ZSwgcGFnZVNpemUpO1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhZ2VRdWVyeTtcbiAgICAgICAgICAgICAgICB9KTsgLy8gUHJvY2VzcyB0aGUgcGFnZXNcblxuICAgICAgICAgICAgICAgIHBhZ2VQcm9taXNlcyA9IHBhZ2VRdWVyaWVzLm1hcChmdW5jdGlvbiAocGFnZVF1ZXJ5KSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gbmV0d29yay5maW5kKHBhZ2VRdWVyeSwgb3B0aW9ucykudG9Qcm9taXNlKCkudGhlbihmdW5jdGlvbiAoZG9jcykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2FjaGUuc2F2ZShkb2NzKTtcbiAgICAgICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKGRvY3MpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRvY3MubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgX2NvbnRleHQxMC5uZXh0ID0gNTg7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKHBhZ2VQcm9taXNlcyk7XG5cbiAgICAgICAgICAgICAgY2FzZSA1ODpcbiAgICAgICAgICAgICAgICBwYWdlQ291bnRzID0gX2NvbnRleHQxMC5zZW50O1xuICAgICAgICAgICAgICAgIHRvdGFsUGFnZUNvdW50ID0gcGFnZUNvdW50cy5yZWR1Y2UoZnVuY3Rpb24gKHRvdGFsQ291bnQsIHBhZ2VDb3VudCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHRvdGFsQ291bnQgKyBwYWdlQ291bnQ7XG4gICAgICAgICAgICAgICAgfSwgMCk7IC8vIFVwZGF0ZSB0aGUgcXVlcnkgY2FjaGVcblxuICAgICAgICAgICAgICAgIHF1ZXJ5Q2FjaGUuc2F2ZShxdWVyeSwgX3Jlc3BvbnNlMik7IC8vIFJldHVybiB0aGUgdG90YWwgcGFnZSBjb3VudFxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTAuYWJydXB0KFwicmV0dXJuXCIsIHRvdGFsUGFnZUNvdW50KTtcblxuICAgICAgICAgICAgICBjYXNlIDYyOlxuICAgICAgICAgICAgICAgIF9jb250ZXh0MTAubmV4dCA9IDY0O1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXR3b3JrLmZpbmQocXVlcnksIE9iamVjdC5hc3NpZ24oe30sIG9wdGlvbnMsIHtcbiAgICAgICAgICAgICAgICAgIHJhd1Jlc3BvbnNlOiB0cnVlXG4gICAgICAgICAgICAgICAgfSkpLnRvUHJvbWlzZSgpO1xuXG4gICAgICAgICAgICAgIGNhc2UgNjQ6XG4gICAgICAgICAgICAgICAgcmVzcG9uc2UgPSBfY29udGV4dDEwLnNlbnQ7XG4gICAgICAgICAgICAgICAgZG9jcyA9IHJlc3BvbnNlLmRhdGE7IC8vIENsZWFyIHRoZSBjYWNoZSBpZiBhIHF1ZXJ5IHdhcyBub3QgcHJvdmlkZWRcblxuICAgICAgICAgICAgICAgIGlmIChxdWVyeSkge1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQxMC5uZXh0ID0gNjk7XG4gICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBfY29udGV4dDEwLm5leHQgPSA2OTtcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FjaGUuY2xlYXIoKTtcblxuICAgICAgICAgICAgICBjYXNlIDY5OlxuICAgICAgICAgICAgICAgIF9jb250ZXh0MTAubmV4dCA9IDcxO1xuICAgICAgICAgICAgICAgIHJldHVybiBjYWNoZS5zYXZlKGRvY3MpO1xuXG4gICAgICAgICAgICAgIGNhc2UgNzE6XG4gICAgICAgICAgICAgICAgX2NvbnRleHQxMC5uZXh0ID0gNzM7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHF1ZXJ5Q2FjaGUuc2F2ZShxdWVyeSwgcmVzcG9uc2UpO1xuXG4gICAgICAgICAgICAgIGNhc2UgNzM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTAuYWJydXB0KFwicmV0dXJuXCIsIGRvY3MubGVuZ3RoKTtcblxuICAgICAgICAgICAgICBjYXNlIDc0OlxuICAgICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTAuc3RvcCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSwgX2NhbGxlZTEwLCB0aGlzLCBbWzE0LCA0MV1dKTtcbiAgICAgIH0pKTtcblxuICAgICAgZnVuY3Rpb24gcHVsbChfeDEwKSB7XG4gICAgICAgIHJldHVybiBfcHVsbC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gcHVsbDtcbiAgICB9KClcbiAgfSwge1xuICAgIGtleTogXCJwdWxsQnlJZFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgX3B1bGxCeUlkID0gKDAsIF9hc3luY1RvR2VuZXJhdG9yMi5kZWZhdWx0KShcbiAgICAgIC8qI19fUFVSRV9fKi9cbiAgICAgIF9yZWdlbmVyYXRvci5kZWZhdWx0Lm1hcmsoZnVuY3Rpb24gX2NhbGxlZTExKGlkKSB7XG4gICAgICAgIHZhciBvcHRpb25zLFxuICAgICAgICAgICAgbmV0d29yayxcbiAgICAgICAgICAgIGNhY2hlLFxuICAgICAgICAgICAgY291bnQsXG4gICAgICAgICAgICBkb2MsXG4gICAgICAgICAgICBfYXJnczExID0gYXJndW1lbnRzO1xuICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yLmRlZmF1bHQud3JhcChmdW5jdGlvbiBfY2FsbGVlMTEkKF9jb250ZXh0MTEpIHtcbiAgICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDExLnByZXYgPSBfY29udGV4dDExLm5leHQpIHtcbiAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgIG9wdGlvbnMgPSBfYXJnczExLmxlbmd0aCA+IDEgJiYgX2FyZ3MxMVsxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3MxMVsxXSA6IHt9O1xuICAgICAgICAgICAgICAgIG5ldHdvcmsgPSBuZXcgX25ldHdvcmtzdG9yZS5OZXR3b3JrU3RvcmUodGhpcy5jb2xsZWN0aW9uTmFtZSk7XG4gICAgICAgICAgICAgICAgY2FjaGUgPSBuZXcgX2NhY2hlLkRhdGFTdG9yZUNhY2hlKHRoaXMuY29sbGVjdGlvbk5hbWUsIHRoaXMudGFnKTsgLy8gUHVzaCBzeW5jIHF1ZXVlXG5cbiAgICAgICAgICAgICAgICBfY29udGV4dDExLm5leHQgPSA1O1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnBlbmRpbmdTeW5jQ291bnQoKTtcblxuICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgY291bnQgPSBfY29udGV4dDExLnNlbnQ7XG5cbiAgICAgICAgICAgICAgICBpZiAoIShjb3VudCA+IDApKSB7XG4gICAgICAgICAgICAgICAgICBfY29udGV4dDExLm5leHQgPSAxMDtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICghKGNvdW50ID09PSAxKSkge1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQxMS5uZXh0ID0gOTtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBfa2ludmV5LmRlZmF1bHQoXCJVbmFibGUgdG8gcHVsbCBlbnRpdGllcyBmcm9tIHRoZSBiYWNrZW5kLiBUaGVyZSBpcyBcIi5jb25jYXQoY291bnQsIFwiIGVudGl0eVwiKSArICcgdGhhdCBuZWVkcyB0byBiZSBwdXNoZWQgdG8gdGhlIGJhY2tlbmQuJyk7XG5cbiAgICAgICAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBfa2ludmV5LmRlZmF1bHQoXCJVbmFibGUgdG8gcHVsbCBlbnRpdGllcyBmcm9tIHRoZSBiYWNrZW5kLiBUaGVyZSBhcmUgXCIuY29uY2F0KGNvdW50LCBcIiBlbnRpdGllc1wiKSArICcgdGhhdCBuZWVkIHRvIGJlIHB1c2hlZCB0byB0aGUgYmFja2VuZC4nKTtcblxuICAgICAgICAgICAgICBjYXNlIDEwOlxuICAgICAgICAgICAgICAgIF9jb250ZXh0MTEucHJldiA9IDEwO1xuICAgICAgICAgICAgICAgIF9jb250ZXh0MTEubmV4dCA9IDEzO1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXR3b3JrLmZpbmRCeUlkKGlkLCBvcHRpb25zKS50b1Byb21pc2UoKTtcblxuICAgICAgICAgICAgICBjYXNlIDEzOlxuICAgICAgICAgICAgICAgIGRvYyA9IF9jb250ZXh0MTEuc2VudDtcbiAgICAgICAgICAgICAgICBfY29udGV4dDExLm5leHQgPSAxNjtcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FjaGUuc2F2ZShkb2MpO1xuXG4gICAgICAgICAgICAgIGNhc2UgMTY6XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTEuYWJydXB0KFwicmV0dXJuXCIsIGRvYyk7XG5cbiAgICAgICAgICAgICAgY2FzZSAxOTpcbiAgICAgICAgICAgICAgICBfY29udGV4dDExLnByZXYgPSAxOTtcbiAgICAgICAgICAgICAgICBfY29udGV4dDExLnQwID0gX2NvbnRleHQxMVtcImNhdGNoXCJdKDEwKTtcblxuICAgICAgICAgICAgICAgIGlmICghKF9jb250ZXh0MTEudDAgaW5zdGFuY2VvZiBfbm90Rm91bmQuZGVmYXVsdCkpIHtcbiAgICAgICAgICAgICAgICAgIF9jb250ZXh0MTEubmV4dCA9IDI0O1xuICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgX2NvbnRleHQxMS5uZXh0ID0gMjQ7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhY2hlLnJlbW92ZUJ5SWQoaWQpO1xuXG4gICAgICAgICAgICAgIGNhc2UgMjQ6XG4gICAgICAgICAgICAgICAgdGhyb3cgX2NvbnRleHQxMS50MDtcblxuICAgICAgICAgICAgICBjYXNlIDI1OlxuICAgICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTEuc3RvcCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSwgX2NhbGxlZTExLCB0aGlzLCBbWzEwLCAxOV1dKTtcbiAgICAgIH0pKTtcblxuICAgICAgZnVuY3Rpb24gcHVsbEJ5SWQoX3gxMSkge1xuICAgICAgICByZXR1cm4gX3B1bGxCeUlkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBwdWxsQnlJZDtcbiAgICB9KClcbiAgfSwge1xuICAgIGtleTogXCJzeW5jXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBfc3luYyA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gICAgICAvKiNfX1BVUkVfXyovXG4gICAgICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMihxdWVyeSwgb3B0aW9ucykge1xuICAgICAgICB2YXIgcHVzaCwgcHVsbDtcbiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvci5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZTEyJChfY29udGV4dDEyKSB7XG4gICAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMi5wcmV2ID0gX2NvbnRleHQxMi5uZXh0KSB7XG4gICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICBfY29udGV4dDEyLm5leHQgPSAyO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnB1c2gobnVsbCwgb3B0aW9ucyk7XG5cbiAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgIHB1c2ggPSBfY29udGV4dDEyLnNlbnQ7XG4gICAgICAgICAgICAgICAgX2NvbnRleHQxMi5uZXh0ID0gNTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wdWxsKHF1ZXJ5LCBvcHRpb25zKTtcblxuICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgcHVsbCA9IF9jb250ZXh0MTIuc2VudDtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMi5hYnJ1cHQoXCJyZXR1cm5cIiwge1xuICAgICAgICAgICAgICAgICAgcHVzaDogcHVzaCxcbiAgICAgICAgICAgICAgICAgIHB1bGw6IHB1bGxcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMi5zdG9wKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LCBfY2FsbGVlMTIsIHRoaXMpO1xuICAgICAgfSkpO1xuXG4gICAgICBmdW5jdGlvbiBzeW5jKF94MTIsIF94MTMpIHtcbiAgICAgICAgcmV0dXJuIF9zeW5jLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBzeW5jO1xuICAgIH0oKVxuICB9LCB7XG4gICAga2V5OiBcInBlbmRpbmdTeW5jRG9jc1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBwZW5kaW5nU3luY0RvY3MocXVlcnkpIHtcbiAgICAgIHZhciBzeW5jID0gbmV3IF9zeW5jMi5TeW5jKHRoaXMuY29sbGVjdGlvbk5hbWUsIHRoaXMudGFnKTtcbiAgICAgIHZhciBmaW5kUXVlcnkgPSAoMCwgX3N5bmMyLnF1ZXJ5VG9TeW5jUXVlcnkpKHF1ZXJ5LCB0aGlzLmNvbGxlY3Rpb25OYW1lKTtcbiAgICAgIHJldHVybiBzeW5jLmZpbmQoZmluZFF1ZXJ5KTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwicGVuZGluZ1N5bmNFbnRpdGllc1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBwZW5kaW5nU3luY0VudGl0aWVzKHF1ZXJ5KSB7XG4gICAgICByZXR1cm4gdGhpcy5wZW5kaW5nU3luY0RvY3MocXVlcnkpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJwZW5kaW5nU3luY0NvdW50XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHBlbmRpbmdTeW5jQ291bnQocXVlcnkpIHtcbiAgICAgIHZhciBzeW5jID0gbmV3IF9zeW5jMi5TeW5jKHRoaXMuY29sbGVjdGlvbk5hbWUsIHRoaXMudGFnKTtcbiAgICAgIHZhciBmaW5kUXVlcnkgPSAoMCwgX3N5bmMyLnF1ZXJ5VG9TeW5jUXVlcnkpKHF1ZXJ5LCB0aGlzLmNvbGxlY3Rpb25OYW1lKTtcbiAgICAgIHJldHVybiBzeW5jLmNvdW50KGZpbmRRdWVyeSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImNsZWFyU3luY1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgX2NsZWFyU3luYyA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gICAgICAvKiNfX1BVUkVfXyovXG4gICAgICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMyhxdWVyeSkge1xuICAgICAgICB2YXIgc3luYywgY2xlYXJRdWVyeTtcbiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvci5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZTEzJChfY29udGV4dDEzKSB7XG4gICAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMy5wcmV2ID0gX2NvbnRleHQxMy5uZXh0KSB7XG4gICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICBzeW5jID0gbmV3IF9zeW5jMi5TeW5jKHRoaXMuY29sbGVjdGlvbk5hbWUsIHRoaXMudGFnKTtcbiAgICAgICAgICAgICAgICBjbGVhclF1ZXJ5ID0gKDAsIF9zeW5jMi5xdWVyeVRvU3luY1F1ZXJ5KShxdWVyeSwgdGhpcy5jb2xsZWN0aW9uTmFtZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTMuYWJydXB0KFwicmV0dXJuXCIsIHN5bmMucmVtb3ZlKGNsZWFyUXVlcnkpKTtcblxuICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMy5zdG9wKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LCBfY2FsbGVlMTMsIHRoaXMpO1xuICAgICAgfSkpO1xuXG4gICAgICBmdW5jdGlvbiBjbGVhclN5bmMoX3gxNCkge1xuICAgICAgICByZXR1cm4gX2NsZWFyU3luYy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gY2xlYXJTeW5jO1xuICAgIH0oKVxuICB9LCB7XG4gICAga2V5OiBcInN1YnNjcmliZVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgX3N1YnNjcmliZSA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gICAgICAvKiNfX1BVUkVfXyovXG4gICAgICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxNChyZWNlaXZlcikge1xuICAgICAgICB2YXIgbmV0d29yaztcbiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvci5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZTE0JChfY29udGV4dDE0KSB7XG4gICAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxNC5wcmV2ID0gX2NvbnRleHQxNC5uZXh0KSB7XG4gICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICBuZXR3b3JrID0gbmV3IF9uZXR3b3Jrc3RvcmUuTmV0d29ya1N0b3JlKHRoaXMuY29sbGVjdGlvbk5hbWUpO1xuICAgICAgICAgICAgICAgIF9jb250ZXh0MTQubmV4dCA9IDM7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldHdvcmsuc3Vic2NyaWJlKHJlY2VpdmVyKTtcblxuICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTQuYWJydXB0KFwicmV0dXJuXCIsIHRoaXMpO1xuXG4gICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDE0LnN0b3AoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sIF9jYWxsZWUxNCwgdGhpcyk7XG4gICAgICB9KSk7XG5cbiAgICAgIGZ1bmN0aW9uIHN1YnNjcmliZShfeDE1KSB7XG4gICAgICAgIHJldHVybiBfc3Vic2NyaWJlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBzdWJzY3JpYmU7XG4gICAgfSgpXG4gIH0sIHtcbiAgICBrZXk6IFwidW5zdWJzY3JpYmVcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIF91bnN1YnNjcmliZSA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gICAgICAvKiNfX1BVUkVfXyovXG4gICAgICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxNSgpIHtcbiAgICAgICAgdmFyIG5ldHdvcms7XG4gICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3IuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxNSQoX2NvbnRleHQxNSkge1xuICAgICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTUucHJldiA9IF9jb250ZXh0MTUubmV4dCkge1xuICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgbmV0d29yayA9IG5ldyBfbmV0d29ya3N0b3JlLk5ldHdvcmtTdG9yZSh0aGlzLmNvbGxlY3Rpb25OYW1lKTtcbiAgICAgICAgICAgICAgICBfY29udGV4dDE1Lm5leHQgPSAzO1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXR3b3JrLnVuc3Vic2NyaWJlKCk7XG5cbiAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDE1LmFicnVwdChcInJldHVyblwiLCB0aGlzKTtcblxuICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxNS5zdG9wKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LCBfY2FsbGVlMTUsIHRoaXMpO1xuICAgICAgfSkpO1xuXG4gICAgICBmdW5jdGlvbiB1bnN1YnNjcmliZSgpIHtcbiAgICAgICAgcmV0dXJuIF91bnN1YnNjcmliZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdW5zdWJzY3JpYmU7XG4gICAgfSgpXG4gIH0sIHtcbiAgICBrZXk6IFwicGF0aG5hbWVcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHZhciBfZ2V0Q29uZmlnMiA9ICgwLCBfY29uZmlnLmdldCkoKSxcbiAgICAgICAgICBhcHBLZXkgPSBfZ2V0Q29uZmlnMi5hcHBLZXk7XG5cbiAgICAgIHJldHVybiBcIi9cIi5jb25jYXQoTkFNRVNQQUNFLCBcIi9cIikuY29uY2F0KGFwcEtleSwgXCIvXCIpLmNvbmNhdCh0aGlzLmNvbGxlY3Rpb25OYW1lKTtcbiAgICB9XG4gIH1dKTtcbiAgcmV0dXJuIENhY2hlU3RvcmU7XG59KCk7XG5cbmV4cG9ydHMuQ2FjaGVTdG9yZSA9IENhY2hlU3RvcmU7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gcmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW50ZXJvcFJlcXVpcmVEZWZhdWx0XCIpO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5jb2xsZWN0aW9uID0gY29sbGVjdGlvbjtcbmV4cG9ydHMuZ2V0SW5zdGFuY2UgPSBnZXRJbnN0YW5jZTtcbmV4cG9ydHMuY2xlYXIgPSBjbGVhcjtcbmV4cG9ydHMuY2xlYXJDYWNoZSA9IGNsZWFyQ2FjaGU7XG5leHBvcnRzLkRhdGFTdG9yZVR5cGUgPSB2b2lkIDA7XG5cbnZhciBfcmVnZW5lcmF0b3IgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9yZWdlbmVyYXRvclwiKSk7XG5cbnZhciBfYXN5bmNUb0dlbmVyYXRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2FzeW5jVG9HZW5lcmF0b3JcIikpO1xuXG52YXIgX2lzU3RyaW5nID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwibG9kYXNoL2lzU3RyaW5nXCIpKTtcblxudmFyIF9raW52ZXkgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi9lcnJvcnMva2ludmV5XCIpKTtcblxudmFyIF9jYWNoZSA9IHJlcXVpcmUoXCIuL2NhY2hlXCIpO1xuXG52YXIgX25ldHdvcmtzdG9yZSA9IHJlcXVpcmUoXCIuL25ldHdvcmtzdG9yZVwiKTtcblxudmFyIF9jYWNoZXN0b3JlID0gcmVxdWlyZShcIi4vY2FjaGVzdG9yZVwiKTtcblxudmFyIERhdGFTdG9yZVR5cGUgPSB7XG4gIENhY2hlOiAnQ2FjaGUnLFxuICBOZXR3b3JrOiAnTmV0d29yaycsXG4gIFN5bmM6ICdTeW5jJ1xufTtcbmV4cG9ydHMuRGF0YVN0b3JlVHlwZSA9IERhdGFTdG9yZVR5cGU7XG5cbmZ1bmN0aW9uIGNvbGxlY3Rpb24oY29sbGVjdGlvbk5hbWUpIHtcbiAgdmFyIHR5cGUgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IERhdGFTdG9yZVR5cGUuQ2FjaGU7XG4gIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiB7fTtcbiAgdmFyIGRhdGFzdG9yZTtcbiAgdmFyIHRhZ1dhc1Bhc3NlZCA9IG9wdGlvbnMgJiYgJ3RhZycgaW4gb3B0aW9ucztcblxuICBpZiAoY29sbGVjdGlvbk5hbWUgPT0gbnVsbCB8fCAhKDAsIF9pc1N0cmluZy5kZWZhdWx0KShjb2xsZWN0aW9uTmFtZSkpIHtcbiAgICB0aHJvdyBuZXcgX2tpbnZleS5kZWZhdWx0KCdBIGNvbGxlY3Rpb24gaXMgcmVxdWlyZWQgYW5kIG11c3QgYmUgYSBzdHJpbmcuJyk7XG4gIH1cblxuICBpZiAodGFnV2FzUGFzc2VkICYmICEoMCwgX2NhY2hlLmlzVmFsaWRUYWcpKG9wdGlvbnMudGFnKSkge1xuICAgIHRocm93IG5ldyBfa2ludmV5LmRlZmF1bHQoJ1BsZWFzZSBwcm92aWRlIGEgdmFsaWQgZGF0YSBzdG9yZSB0YWcuJyk7XG4gIH1cblxuICBpZiAodHlwZSA9PT0gRGF0YVN0b3JlVHlwZS5OZXR3b3JrKSB7XG4gICAgaWYgKHRhZ1dhc1Bhc3NlZCkge1xuICAgICAgdGhyb3cgbmV3IF9raW52ZXkuZGVmYXVsdCgnVGhlIHRhZ2dlZCBvcHRpb24gaXMgbm90IHZhbGlkIGZvciBkYXRhIHN0b3JlcyBvZiB0eXBlIFwiTmV0d29ya1wiJyk7XG4gICAgfVxuXG4gICAgZGF0YXN0b3JlID0gbmV3IF9uZXR3b3Jrc3RvcmUuTmV0d29ya1N0b3JlKGNvbGxlY3Rpb25OYW1lKTtcbiAgfSBlbHNlIGlmICh0eXBlID09PSBEYXRhU3RvcmVUeXBlLkNhY2hlKSB7XG4gICAgZGF0YXN0b3JlID0gbmV3IF9jYWNoZXN0b3JlLkNhY2hlU3RvcmUoY29sbGVjdGlvbk5hbWUsIE9iamVjdC5hc3NpZ24oe30sIG9wdGlvbnMsIHtcbiAgICAgIGF1dG9TeW5jOiB0cnVlXG4gICAgfSkpO1xuICB9IGVsc2UgaWYgKHR5cGUgPT09IERhdGFTdG9yZVR5cGUuU3luYykge1xuICAgIGRhdGFzdG9yZSA9IG5ldyBfY2FjaGVzdG9yZS5DYWNoZVN0b3JlKGNvbGxlY3Rpb25OYW1lLCBPYmplY3QuYXNzaWduKHt9LCBvcHRpb25zLCB7XG4gICAgICBhdXRvU3luYzogZmFsc2VcbiAgICB9KSk7XG4gIH0gZWxzZSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdVbmtub3duIGRhdGEgc3RvcmUgdHlwZS4nKTtcbiAgfVxuXG4gIHJldHVybiBkYXRhc3RvcmU7XG59XG5cbmZ1bmN0aW9uIGdldEluc3RhbmNlKGNvbGxlY3Rpb24sIHR5cGUsIG9wdGlvbnMpIHtcbiAgcmV0dXJuIGNvbGxlY3Rpb24oY29sbGVjdGlvbiwgdHlwZSwgb3B0aW9ucyk7XG59XG5cbmZ1bmN0aW9uIGNsZWFyKCkge1xuICByZXR1cm4gX2NsZWFyMi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuXG5mdW5jdGlvbiBfY2xlYXIyKCkge1xuICBfY2xlYXIyID0gKDAsIF9hc3luY1RvR2VuZXJhdG9yMi5kZWZhdWx0KShcbiAgLyojX19QVVJFX18qL1xuICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7XG4gICAgcmV0dXJuIF9yZWdlbmVyYXRvci5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHtcbiAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHtcbiAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KFwicmV0dXJuXCIsICgwLCBfY2FjaGUuY2xlYXIpKCkpO1xuXG4gICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LCBfY2FsbGVlLCB0aGlzKTtcbiAgfSkpO1xuICByZXR1cm4gX2NsZWFyMi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuXG5mdW5jdGlvbiBjbGVhckNhY2hlKCkge1xuICByZXR1cm4gX2NsZWFyQ2FjaGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cblxuZnVuY3Rpb24gX2NsZWFyQ2FjaGUoKSB7XG4gIF9jbGVhckNhY2hlID0gKDAsIF9hc3luY1RvR2VuZXJhdG9yMi5kZWZhdWx0KShcbiAgLyojX19QVVJFX18qL1xuICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkge1xuICAgIHJldHVybiBfcmVnZW5lcmF0b3IuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHtcbiAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkge1xuICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KFwicmV0dXJuXCIsIGNsZWFyKCkpO1xuXG4gICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwgX2NhbGxlZTIsIHRoaXMpO1xuICB9KSk7XG4gIHJldHVybiBfY2xlYXJDYWNoZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufSIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkXCIpO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuY3JlYXRlUmVxdWVzdCA9IGNyZWF0ZVJlcXVlc3Q7XG5leHBvcnRzLk5ldHdvcmtTdG9yZSA9IHZvaWQgMDtcblxudmFyIF9yZWdlbmVyYXRvciA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL3JlZ2VuZXJhdG9yXCIpKTtcblxudmFyIF9hc3luY1RvR2VuZXJhdG9yMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXN5bmNUb0dlbmVyYXRvclwiKSk7XG5cbnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVja1wiKSk7XG5cbnZhciBfY3JlYXRlQ2xhc3MyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jcmVhdGVDbGFzc1wiKSk7XG5cbnZhciBfaXNBcnJheSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcImxvZGFzaC9pc0FycmF5XCIpKTtcblxudmFyIF9jb25maWcgPSByZXF1aXJlKFwiLi4va2ludmV5L2NvbmZpZ1wiKTtcblxudmFyIF9kZXZpY2UgPSByZXF1aXJlKFwiLi4va2ludmV5L2RldmljZVwiKTtcblxudmFyIF9vYnNlcnZhYmxlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vb2JzZXJ2YWJsZVwiKSk7XG5cbnZhciBfc2Vzc2lvbiA9IHJlcXVpcmUoXCIuLi9zZXNzaW9uXCIpO1xuXG52YXIgX2FnZ3JlZ2F0aW9uID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vYWdncmVnYXRpb25cIikpO1xuXG52YXIgTGl2ZSA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoXCIuLi9saXZlXCIpKTtcblxudmFyIF9xdWVyeSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uL3F1ZXJ5XCIpKTtcblxudmFyIF91dGlscyA9IHJlcXVpcmUoXCIuLi9odHRwL3V0aWxzXCIpO1xuXG52YXIgX3JlcXVlc3QgPSByZXF1aXJlKFwiLi4vaHR0cC9yZXF1ZXN0XCIpO1xuXG52YXIgX2F1dGggPSByZXF1aXJlKFwiLi4vaHR0cC9hdXRoXCIpO1xuXG52YXIgX2tpbnZleSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uL2Vycm9ycy9raW52ZXlcIikpO1xuXG52YXIgTkFNRVNQQUNFID0gJ2FwcGRhdGEnO1xuXG5mdW5jdGlvbiBjcmVhdGVSZXF1ZXN0KG1ldGhvZCwgdXJsLCBib2R5KSB7XG4gIHJldHVybiBuZXcgX3JlcXVlc3QuS2ludmV5UmVxdWVzdCh7XG4gICAgbWV0aG9kOiBtZXRob2QsXG4gICAgYXV0aDogX2F1dGguQXV0aC5TZXNzaW9uLFxuICAgIHVybDogdXJsLFxuICAgIGJvZHk6IGJvZHlcbiAgfSk7XG59XG5cbnZhciBOZXR3b3JrU3RvcmUgPVxuLyojX19QVVJFX18qL1xuZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBOZXR3b3JrU3RvcmUoY29sbGVjdGlvbk5hbWUpIHtcbiAgICAoMCwgX2NsYXNzQ2FsbENoZWNrMi5kZWZhdWx0KSh0aGlzLCBOZXR3b3JrU3RvcmUpO1xuICAgIHRoaXMuY29sbGVjdGlvbk5hbWUgPSBjb2xsZWN0aW9uTmFtZTtcbiAgfVxuICAvKipcbiAgICogQGRlcHJlY2F0ZWQgNC4wLjAgLSBVc2UgY29sbGVjdGlvbk5hbWUgaW5zdGVhZC5cbiAgICovXG5cblxuICAoMCwgX2NyZWF0ZUNsYXNzMi5kZWZhdWx0KShOZXR3b3JrU3RvcmUsIFt7XG4gICAga2V5OiBcImZpbmRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gZmluZChxdWVyeSkge1xuICAgICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHt9O1xuXG4gICAgICB2YXIgc3RyZWFtID0gX29ic2VydmFibGUuZGVmYXVsdC5jcmVhdGUoXG4gICAgICAvKiNfX1BVUkVfXyovXG4gICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfcmVmID0gKDAsIF9hc3luY1RvR2VuZXJhdG9yMi5kZWZhdWx0KShcbiAgICAgICAgLyojX19QVVJFX18qL1xuICAgICAgICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUob2JzZXJ2ZXIpIHtcbiAgICAgICAgICB2YXIgX2dldENvbmZpZywgYXBpUHJvdG9jb2wsIGFwaUhvc3QsIF9vcHRpb25zJHJhd1Jlc3BvbnNlLCByYXdSZXNwb25zZSwgdGltZW91dCwgcHJvcGVydGllcywgdHJhY2UsIHNraXBCTCwga2ludmV5RmlsZVRUTCwga2ludmV5RmlsZVRMUywgcXVlcnlPYmplY3QsIHVybCwgcmVxdWVzdCwgcmVzcG9uc2U7XG5cbiAgICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yLmRlZmF1bHQud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkge1xuICAgICAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkge1xuICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAwO1xuXG4gICAgICAgICAgICAgICAgICBpZiAoIShxdWVyeSAmJiAhKHF1ZXJ5IGluc3RhbmNlb2YgX3F1ZXJ5LmRlZmF1bHQpKSkge1xuICAgICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBfa2ludmV5LmRlZmF1bHQoJ0ludmFsaWQgcXVlcnkuIEl0IG11c3QgYmUgYW4gaW5zdGFuY2Ugb2YgdGhlIFF1ZXJ5IGNsYXNzLicpO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgX2dldENvbmZpZyA9ICgwLCBfY29uZmlnLmdldCkoKSwgYXBpUHJvdG9jb2wgPSBfZ2V0Q29uZmlnLmFwaVByb3RvY29sLCBhcGlIb3N0ID0gX2dldENvbmZpZy5hcGlIb3N0O1xuICAgICAgICAgICAgICAgICAgX29wdGlvbnMkcmF3UmVzcG9uc2UgPSBvcHRpb25zLnJhd1Jlc3BvbnNlLCByYXdSZXNwb25zZSA9IF9vcHRpb25zJHJhd1Jlc3BvbnNlID09PSB2b2lkIDAgPyBmYWxzZSA6IF9vcHRpb25zJHJhd1Jlc3BvbnNlLCB0aW1lb3V0ID0gb3B0aW9ucy50aW1lb3V0LCBwcm9wZXJ0aWVzID0gb3B0aW9ucy5wcm9wZXJ0aWVzLCB0cmFjZSA9IG9wdGlvbnMudHJhY2UsIHNraXBCTCA9IG9wdGlvbnMuc2tpcEJMLCBraW52ZXlGaWxlVFRMID0gb3B0aW9ucy5raW52ZXlGaWxlVFRMLCBraW52ZXlGaWxlVExTID0gb3B0aW9ucy5raW52ZXlGaWxlVExTO1xuICAgICAgICAgICAgICAgICAgcXVlcnlPYmplY3QgPSBPYmplY3QuYXNzaWduKHt9LCBxdWVyeSA/IHF1ZXJ5LnRvUXVlcnlPYmplY3QoKSA6IHt9LCB7XG4gICAgICAgICAgICAgICAgICAgIGtpbnZleWZpbGVfdHRsOiBraW52ZXlGaWxlVFRMLFxuICAgICAgICAgICAgICAgICAgICBraW52ZXlmaWxlX3Rsczoga2ludmV5RmlsZVRMU1xuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICB1cmwgPSAoMCwgX3V0aWxzLmZvcm1hdEtpbnZleVVybCkoYXBpUHJvdG9jb2wsIGFwaUhvc3QsIF90aGlzLnBhdGhuYW1lLCBxdWVyeU9iamVjdCk7XG4gICAgICAgICAgICAgICAgICByZXF1ZXN0ID0gY3JlYXRlUmVxdWVzdChfcmVxdWVzdC5SZXF1ZXN0TWV0aG9kLkdFVCwgdXJsKTtcbiAgICAgICAgICAgICAgICAgIHJlcXVlc3QuaGVhZGVycy5jdXN0b21SZXF1ZXN0UHJvcGVydGllcyA9IHByb3BlcnRpZXM7XG4gICAgICAgICAgICAgICAgICByZXF1ZXN0LnRpbWVvdXQgPSB0aW1lb3V0O1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDEyO1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcXVlc3QuZXhlY3V0ZSgpO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAxMjpcbiAgICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gX2NvbnRleHQuc2VudDtcblxuICAgICAgICAgICAgICAgICAgaWYgKHJhd1Jlc3BvbnNlID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLm5leHQocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIubmV4dChyZXNwb25zZS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIuY29tcGxldGUoKTtcbiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyMDtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAxNzpcbiAgICAgICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAxNztcbiAgICAgICAgICAgICAgICAgIF9jb250ZXh0LnQwID0gX2NvbnRleHRbXCJjYXRjaFwiXSgwKTtcbiAgICAgICAgICAgICAgICAgIG9ic2VydmVyLmVycm9yKF9jb250ZXh0LnQwKTtcblxuICAgICAgICAgICAgICAgIGNhc2UgMjA6XG4gICAgICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sIF9jYWxsZWUsIHRoaXMsIFtbMCwgMTddXSk7XG4gICAgICAgIH0pKTtcblxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKF94KSB7XG4gICAgICAgICAgcmV0dXJuIF9yZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgfTtcbiAgICAgIH0oKSk7XG5cbiAgICAgIHJldHVybiBzdHJlYW07XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImNvdW50XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGNvdW50KHF1ZXJ5KSB7XG4gICAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHt9O1xuXG4gICAgICB2YXIgc3RyZWFtID0gX29ic2VydmFibGUuZGVmYXVsdC5jcmVhdGUoXG4gICAgICAvKiNfX1BVUkVfXyovXG4gICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfcmVmMiA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gICAgICAgIC8qI19fUFVSRV9fKi9cbiAgICAgICAgX3JlZ2VuZXJhdG9yLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlMihvYnNlcnZlcikge1xuICAgICAgICAgIHZhciBfZ2V0Q29uZmlnMiwgYXBpUHJvdG9jb2wsIGFwaUhvc3QsIF9vcHRpb25zJHJhd1Jlc3BvbnNlMiwgcmF3UmVzcG9uc2UsIHRpbWVvdXQsIHByb3BlcnRpZXMsIHRyYWNlLCBza2lwQkwsIHF1ZXJ5T2JqZWN0LCB1cmwsIHJlcXVlc3QsIHJlc3BvbnNlO1xuXG4gICAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvci5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0Mikge1xuICAgICAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLnByZXYgPSAwO1xuXG4gICAgICAgICAgICAgICAgICBpZiAoIShxdWVyeSAmJiAhKHF1ZXJ5IGluc3RhbmNlb2YgX3F1ZXJ5LmRlZmF1bHQpKSkge1xuICAgICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDM7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX2tpbnZleS5kZWZhdWx0KCdJbnZhbGlkIHF1ZXJ5LiBJdCBtdXN0IGJlIGFuIGluc3RhbmNlIG9mIHRoZSBRdWVyeSBjbGFzcy4nKTtcblxuICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgIF9nZXRDb25maWcyID0gKDAsIF9jb25maWcuZ2V0KSgpLCBhcGlQcm90b2NvbCA9IF9nZXRDb25maWcyLmFwaVByb3RvY29sLCBhcGlIb3N0ID0gX2dldENvbmZpZzIuYXBpSG9zdDtcbiAgICAgICAgICAgICAgICAgIF9vcHRpb25zJHJhd1Jlc3BvbnNlMiA9IG9wdGlvbnMucmF3UmVzcG9uc2UsIHJhd1Jlc3BvbnNlID0gX29wdGlvbnMkcmF3UmVzcG9uc2UyID09PSB2b2lkIDAgPyBmYWxzZSA6IF9vcHRpb25zJHJhd1Jlc3BvbnNlMiwgdGltZW91dCA9IG9wdGlvbnMudGltZW91dCwgcHJvcGVydGllcyA9IG9wdGlvbnMucHJvcGVydGllcywgdHJhY2UgPSBvcHRpb25zLnRyYWNlLCBza2lwQkwgPSBvcHRpb25zLnNraXBCTDtcbiAgICAgICAgICAgICAgICAgIHF1ZXJ5T2JqZWN0ID0gT2JqZWN0LmFzc2lnbih7fSwgcXVlcnkgPyBxdWVyeS50b1F1ZXJ5T2JqZWN0KCkgOiB7fSwge30pO1xuICAgICAgICAgICAgICAgICAgdXJsID0gKDAsIF91dGlscy5mb3JtYXRLaW52ZXlVcmwpKGFwaVByb3RvY29sLCBhcGlIb3N0LCBcIlwiLmNvbmNhdChfdGhpczIucGF0aG5hbWUsIFwiL19jb3VudFwiKSwgcXVlcnlPYmplY3QpO1xuICAgICAgICAgICAgICAgICAgcmVxdWVzdCA9IGNyZWF0ZVJlcXVlc3QoX3JlcXVlc3QuUmVxdWVzdE1ldGhvZC5HRVQsIHVybCk7XG4gICAgICAgICAgICAgICAgICByZXF1ZXN0LmhlYWRlcnMuY3VzdG9tUmVxdWVzdFByb3BlcnRpZXMgPSBwcm9wZXJ0aWVzO1xuICAgICAgICAgICAgICAgICAgcmVxdWVzdC50aW1lb3V0ID0gdGltZW91dDtcbiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTI7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gcmVxdWVzdC5leGVjdXRlKCk7XG5cbiAgICAgICAgICAgICAgICBjYXNlIDEyOlxuICAgICAgICAgICAgICAgICAgcmVzcG9uc2UgPSBfY29udGV4dDIuc2VudDtcblxuICAgICAgICAgICAgICAgICAgaWYgKHJhd1Jlc3BvbnNlID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLm5leHQocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIubmV4dChyZXNwb25zZS5kYXRhLmNvdW50KTtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIuY29tcGxldGUoKTtcbiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMjA7XG4gICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgMTc6XG4gICAgICAgICAgICAgICAgICBfY29udGV4dDIucHJldiA9IDE3O1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLnQwID0gX2NvbnRleHQyW1wiY2F0Y2hcIl0oMCk7XG4gICAgICAgICAgICAgICAgICBvYnNlcnZlci5lcnJvcihfY29udGV4dDIudDApO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAyMDpcbiAgICAgICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sIF9jYWxsZWUyLCB0aGlzLCBbWzAsIDE3XV0pO1xuICAgICAgICB9KSk7XG5cbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChfeDIpIHtcbiAgICAgICAgICByZXR1cm4gX3JlZjIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgfTtcbiAgICAgIH0oKSk7XG5cbiAgICAgIHJldHVybiBzdHJlYW07XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImdyb3VwXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGdyb3VwKGFnZ3JlZ2F0aW9uKSB7XG4gICAgICB2YXIgX3RoaXMzID0gdGhpcztcblxuICAgICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHt9O1xuXG4gICAgICB2YXIgc3RyZWFtID0gX29ic2VydmFibGUuZGVmYXVsdC5jcmVhdGUoXG4gICAgICAvKiNfX1BVUkVfXyovXG4gICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfcmVmMyA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gICAgICAgIC8qI19fUFVSRV9fKi9cbiAgICAgICAgX3JlZ2VuZXJhdG9yLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlMyhvYnNlcnZlcikge1xuICAgICAgICAgIHZhciBfZ2V0Q29uZmlnMywgYXBpUHJvdG9jb2wsIGFwaUhvc3QsIF9vcHRpb25zJHJhd1Jlc3BvbnNlMywgcmF3UmVzcG9uc2UsIHRpbWVvdXQsIHByb3BlcnRpZXMsIHRyYWNlLCBza2lwQkwsIHF1ZXJ5T2JqZWN0LCB1cmwsIHJlcXVlc3QsIHJlc3BvbnNlO1xuXG4gICAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvci5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0Mykge1xuICAgICAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLnByZXYgPSAwO1xuXG4gICAgICAgICAgICAgICAgICBpZiAoYWdncmVnYXRpb24gaW5zdGFuY2VvZiBfYWdncmVnYXRpb24uZGVmYXVsdCkge1xuICAgICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDM7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX2tpbnZleS5kZWZhdWx0KCdJbnZhbGlkIGFnZ3JlZ2F0aW9uLiBJdCBtdXN0IGJlIGFuIGluc3RhbmNlIG9mIHRoZSBBZ2dyZWdhdGlvbiBjbGFzcy4nKTtcblxuICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgIF9nZXRDb25maWczID0gKDAsIF9jb25maWcuZ2V0KSgpLCBhcGlQcm90b2NvbCA9IF9nZXRDb25maWczLmFwaVByb3RvY29sLCBhcGlIb3N0ID0gX2dldENvbmZpZzMuYXBpSG9zdDtcbiAgICAgICAgICAgICAgICAgIF9vcHRpb25zJHJhd1Jlc3BvbnNlMyA9IG9wdGlvbnMucmF3UmVzcG9uc2UsIHJhd1Jlc3BvbnNlID0gX29wdGlvbnMkcmF3UmVzcG9uc2UzID09PSB2b2lkIDAgPyBmYWxzZSA6IF9vcHRpb25zJHJhd1Jlc3BvbnNlMywgdGltZW91dCA9IG9wdGlvbnMudGltZW91dCwgcHJvcGVydGllcyA9IG9wdGlvbnMucHJvcGVydGllcywgdHJhY2UgPSBvcHRpb25zLnRyYWNlLCBza2lwQkwgPSBvcHRpb25zLnNraXBCTDtcbiAgICAgICAgICAgICAgICAgIHF1ZXJ5T2JqZWN0ID0ge307XG4gICAgICAgICAgICAgICAgICB1cmwgPSAoMCwgX3V0aWxzLmZvcm1hdEtpbnZleVVybCkoYXBpUHJvdG9jb2wsIGFwaUhvc3QsIFwiXCIuY29uY2F0KF90aGlzMy5wYXRobmFtZSwgXCIvX2dyb3VwXCIpLCBxdWVyeU9iamVjdCk7XG4gICAgICAgICAgICAgICAgICByZXF1ZXN0ID0gY3JlYXRlUmVxdWVzdChfcmVxdWVzdC5SZXF1ZXN0TWV0aG9kLlBPU1QsIHVybCwgYWdncmVnYXRpb24udG9QbGFpbk9iamVjdCgpKTtcbiAgICAgICAgICAgICAgICAgIHJlcXVlc3QuaGVhZGVycy5jdXN0b21SZXF1ZXN0UHJvcGVydGllcyA9IHByb3BlcnRpZXM7XG4gICAgICAgICAgICAgICAgICByZXF1ZXN0LnRpbWVvdXQgPSB0aW1lb3V0O1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAxMjtcbiAgICAgICAgICAgICAgICAgIHJldHVybiByZXF1ZXN0LmV4ZWN1dGUoKTtcblxuICAgICAgICAgICAgICAgIGNhc2UgMTI6XG4gICAgICAgICAgICAgICAgICByZXNwb25zZSA9IF9jb250ZXh0My5zZW50O1xuXG4gICAgICAgICAgICAgICAgICBpZiAocmF3UmVzcG9uc2UgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIubmV4dChyZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBvYnNlcnZlci5uZXh0KHJlc3BvbnNlLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICBvYnNlcnZlci5jb21wbGV0ZSgpO1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAyMDtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAxNzpcbiAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5wcmV2ID0gMTc7XG4gICAgICAgICAgICAgICAgICBfY29udGV4dDMudDAgPSBfY29udGV4dDNbXCJjYXRjaFwiXSgwKTtcbiAgICAgICAgICAgICAgICAgIG9ic2VydmVyLmVycm9yKF9jb250ZXh0My50MCk7XG5cbiAgICAgICAgICAgICAgICBjYXNlIDIwOlxuICAgICAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSwgX2NhbGxlZTMsIHRoaXMsIFtbMCwgMTddXSk7XG4gICAgICAgIH0pKTtcblxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKF94Mykge1xuICAgICAgICAgIHJldHVybiBfcmVmMy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICB9O1xuICAgICAgfSgpKTtcblxuICAgICAgcmV0dXJuIHN0cmVhbTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiZmluZEJ5SWRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gZmluZEJ5SWQoaWQpIHtcbiAgICAgIHZhciBfdGhpczQgPSB0aGlzO1xuXG4gICAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307XG5cbiAgICAgIHZhciBzdHJlYW0gPSBfb2JzZXJ2YWJsZS5kZWZhdWx0LmNyZWF0ZShcbiAgICAgIC8qI19fUFVSRV9fKi9cbiAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF9yZWY0ID0gKDAsIF9hc3luY1RvR2VuZXJhdG9yMi5kZWZhdWx0KShcbiAgICAgICAgLyojX19QVVJFX18qL1xuICAgICAgICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0KG9ic2VydmVyKSB7XG4gICAgICAgICAgdmFyIF9nZXRDb25maWc0LCBhcGlQcm90b2NvbCwgYXBpSG9zdCwgX29wdGlvbnMkcmF3UmVzcG9uc2U0LCByYXdSZXNwb25zZSwgdGltZW91dCwgcHJvcGVydGllcywgdHJhY2UsIHNraXBCTCwga2ludmV5RmlsZVRUTCwga2ludmV5RmlsZVRMUywgcXVlcnlPYmplY3QsIHVybCwgcmVxdWVzdCwgcmVzcG9uc2U7XG5cbiAgICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yLmRlZmF1bHQud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7XG4gICAgICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHtcbiAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICBfY29udGV4dDQucHJldiA9IDA7XG5cbiAgICAgICAgICAgICAgICAgIGlmICghaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAxNTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIF9nZXRDb25maWc0ID0gKDAsIF9jb25maWcuZ2V0KSgpLCBhcGlQcm90b2NvbCA9IF9nZXRDb25maWc0LmFwaVByb3RvY29sLCBhcGlIb3N0ID0gX2dldENvbmZpZzQuYXBpSG9zdDtcbiAgICAgICAgICAgICAgICAgIF9vcHRpb25zJHJhd1Jlc3BvbnNlNCA9IG9wdGlvbnMucmF3UmVzcG9uc2UsIHJhd1Jlc3BvbnNlID0gX29wdGlvbnMkcmF3UmVzcG9uc2U0ID09PSB2b2lkIDAgPyBmYWxzZSA6IF9vcHRpb25zJHJhd1Jlc3BvbnNlNCwgdGltZW91dCA9IG9wdGlvbnMudGltZW91dCwgcHJvcGVydGllcyA9IG9wdGlvbnMucHJvcGVydGllcywgdHJhY2UgPSBvcHRpb25zLnRyYWNlLCBza2lwQkwgPSBvcHRpb25zLnNraXBCTCwga2ludmV5RmlsZVRUTCA9IG9wdGlvbnMua2ludmV5RmlsZVRUTCwga2ludmV5RmlsZVRMUyA9IG9wdGlvbnMua2ludmV5RmlsZVRMUztcbiAgICAgICAgICAgICAgICAgIHF1ZXJ5T2JqZWN0ID0ge1xuICAgICAgICAgICAgICAgICAgICBraW52ZXlmaWxlX3R0bDoga2ludmV5RmlsZVRUTCxcbiAgICAgICAgICAgICAgICAgICAga2ludmV5ZmlsZV90bHM6IGtpbnZleUZpbGVUTFNcbiAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICB1cmwgPSAoMCwgX3V0aWxzLmZvcm1hdEtpbnZleVVybCkoYXBpUHJvdG9jb2wsIGFwaUhvc3QsIFwiXCIuY29uY2F0KF90aGlzNC5wYXRobmFtZSwgXCIvXCIpLmNvbmNhdChpZCksIHF1ZXJ5T2JqZWN0KTtcbiAgICAgICAgICAgICAgICAgIHJlcXVlc3QgPSBjcmVhdGVSZXF1ZXN0KF9yZXF1ZXN0LlJlcXVlc3RNZXRob2QuR0VULCB1cmwpO1xuICAgICAgICAgICAgICAgICAgcmVxdWVzdC5oZWFkZXJzLmN1c3RvbVJlcXVlc3RQcm9wZXJ0aWVzID0gcHJvcGVydGllcztcbiAgICAgICAgICAgICAgICAgIHJlcXVlc3QudGltZW91dCA9IHRpbWVvdXQ7XG4gICAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDExO1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcXVlc3QuZXhlY3V0ZSgpO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAxMTpcbiAgICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gX2NvbnRleHQ0LnNlbnQ7XG5cbiAgICAgICAgICAgICAgICAgIGlmIChyYXdSZXNwb25zZSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICBvYnNlcnZlci5uZXh0KHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLm5leHQocmVzcG9uc2UuZGF0YSk7XG4gICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMTY7XG4gICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgMTU6XG4gICAgICAgICAgICAgICAgICBvYnNlcnZlci5uZXh0KHVuZGVmaW5lZCk7XG5cbiAgICAgICAgICAgICAgICBjYXNlIDE2OlxuICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIuY29tcGxldGUoKTtcbiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMjI7XG4gICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgMTk6XG4gICAgICAgICAgICAgICAgICBfY29udGV4dDQucHJldiA9IDE5O1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0LnQwID0gX2NvbnRleHQ0W1wiY2F0Y2hcIl0oMCk7XG4gICAgICAgICAgICAgICAgICBvYnNlcnZlci5lcnJvcihfY29udGV4dDQudDApO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAyMjpcbiAgICAgICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sIF9jYWxsZWU0LCB0aGlzLCBbWzAsIDE5XV0pO1xuICAgICAgICB9KSk7XG5cbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChfeDQpIHtcbiAgICAgICAgICByZXR1cm4gX3JlZjQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgfTtcbiAgICAgIH0oKSk7XG5cbiAgICAgIHJldHVybiBzdHJlYW07XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImNyZWF0ZVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgX2NyZWF0ZSA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gICAgICAvKiNfX1BVUkVfXyovXG4gICAgICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU1KGRvYykge1xuICAgICAgICB2YXIgb3B0aW9ucyxcbiAgICAgICAgICAgIF9nZXRDb25maWc1LFxuICAgICAgICAgICAgYXBpUHJvdG9jb2wsXG4gICAgICAgICAgICBhcGlIb3N0LFxuICAgICAgICAgICAgX29wdGlvbnMkcmF3UmVzcG9uc2U1LFxuICAgICAgICAgICAgcmF3UmVzcG9uc2UsXG4gICAgICAgICAgICB0aW1lb3V0LFxuICAgICAgICAgICAgcHJvcGVydGllcyxcbiAgICAgICAgICAgIHRyYWNlLFxuICAgICAgICAgICAgc2tpcEJMLFxuICAgICAgICAgICAgcXVlcnlPYmplY3QsXG4gICAgICAgICAgICB1cmwsXG4gICAgICAgICAgICByZXF1ZXN0LFxuICAgICAgICAgICAgcmVzcG9uc2UsXG4gICAgICAgICAgICBfYXJnczUgPSBhcmd1bWVudHM7XG5cbiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvci5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZTUkKF9jb250ZXh0NSkge1xuICAgICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NS5wcmV2ID0gX2NvbnRleHQ1Lm5leHQpIHtcbiAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgIG9wdGlvbnMgPSBfYXJnczUubGVuZ3RoID4gMSAmJiBfYXJnczVbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmdzNVsxXSA6IHt9O1xuXG4gICAgICAgICAgICAgICAgaWYgKCEoMCwgX2lzQXJyYXkuZGVmYXVsdCkoZG9jKSkge1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSAzO1xuICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IF9raW52ZXkuZGVmYXVsdCgnVW5hYmxlIHRvIGNyZWF0ZSBhbiBhcnJheSBvZiBlbnRpdGllcy4nLCAnUGxlYXNlIGNyZWF0ZSBlbnRpdGllcyBvbmUgYnkgb25lLicpO1xuXG4gICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICBfZ2V0Q29uZmlnNSA9ICgwLCBfY29uZmlnLmdldCkoKSwgYXBpUHJvdG9jb2wgPSBfZ2V0Q29uZmlnNS5hcGlQcm90b2NvbCwgYXBpSG9zdCA9IF9nZXRDb25maWc1LmFwaUhvc3Q7XG4gICAgICAgICAgICAgICAgX29wdGlvbnMkcmF3UmVzcG9uc2U1ID0gb3B0aW9ucy5yYXdSZXNwb25zZSwgcmF3UmVzcG9uc2UgPSBfb3B0aW9ucyRyYXdSZXNwb25zZTUgPT09IHZvaWQgMCA/IGZhbHNlIDogX29wdGlvbnMkcmF3UmVzcG9uc2U1LCB0aW1lb3V0ID0gb3B0aW9ucy50aW1lb3V0LCBwcm9wZXJ0aWVzID0gb3B0aW9ucy5wcm9wZXJ0aWVzLCB0cmFjZSA9IG9wdGlvbnMudHJhY2UsIHNraXBCTCA9IG9wdGlvbnMuc2tpcEJMO1xuICAgICAgICAgICAgICAgIHF1ZXJ5T2JqZWN0ID0ge307XG4gICAgICAgICAgICAgICAgdXJsID0gKDAsIF91dGlscy5mb3JtYXRLaW52ZXlVcmwpKGFwaVByb3RvY29sLCBhcGlIb3N0LCB0aGlzLnBhdGhuYW1lLCBxdWVyeU9iamVjdCk7XG4gICAgICAgICAgICAgICAgcmVxdWVzdCA9IGNyZWF0ZVJlcXVlc3QoX3JlcXVlc3QuUmVxdWVzdE1ldGhvZC5QT1NULCB1cmwsIGRvYyk7XG4gICAgICAgICAgICAgICAgcmVxdWVzdC5oZWFkZXJzLmN1c3RvbVJlcXVlc3RQcm9wZXJ0aWVzID0gcHJvcGVydGllcztcbiAgICAgICAgICAgICAgICByZXF1ZXN0LnRpbWVvdXQgPSB0aW1lb3V0O1xuICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gMTI7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcXVlc3QuZXhlY3V0ZSgpO1xuXG4gICAgICAgICAgICAgIGNhc2UgMTI6XG4gICAgICAgICAgICAgICAgcmVzcG9uc2UgPSBfY29udGV4dDUuc2VudDtcblxuICAgICAgICAgICAgICAgIGlmICghKHJhd1Jlc3BvbnNlID09PSB0cnVlKSkge1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSAxNTtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuYWJydXB0KFwicmV0dXJuXCIsIHJlc3BvbnNlKTtcblxuICAgICAgICAgICAgICBjYXNlIDE1OlxuICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuYWJydXB0KFwicmV0dXJuXCIsIHJlc3BvbnNlLmRhdGEpO1xuXG4gICAgICAgICAgICAgIGNhc2UgMTY6XG4gICAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LnN0b3AoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sIF9jYWxsZWU1LCB0aGlzKTtcbiAgICAgIH0pKTtcblxuICAgICAgZnVuY3Rpb24gY3JlYXRlKF94NSkge1xuICAgICAgICByZXR1cm4gX2NyZWF0ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gY3JlYXRlO1xuICAgIH0oKVxuICB9LCB7XG4gICAga2V5OiBcInVwZGF0ZVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgX3VwZGF0ZSA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gICAgICAvKiNfX1BVUkVfXyovXG4gICAgICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU2KGRvYykge1xuICAgICAgICB2YXIgb3B0aW9ucyxcbiAgICAgICAgICAgIF9nZXRDb25maWc2LFxuICAgICAgICAgICAgYXBpUHJvdG9jb2wsXG4gICAgICAgICAgICBhcGlIb3N0LFxuICAgICAgICAgICAgX29wdGlvbnMkcmF3UmVzcG9uc2U2LFxuICAgICAgICAgICAgcmF3UmVzcG9uc2UsXG4gICAgICAgICAgICB0aW1lb3V0LFxuICAgICAgICAgICAgcHJvcGVydGllcyxcbiAgICAgICAgICAgIHRyYWNlLFxuICAgICAgICAgICAgc2tpcEJMLFxuICAgICAgICAgICAgcXVlcnlPYmplY3QsXG4gICAgICAgICAgICB1cmwsXG4gICAgICAgICAgICByZXF1ZXN0LFxuICAgICAgICAgICAgcmVzcG9uc2UsXG4gICAgICAgICAgICBfYXJnczYgPSBhcmd1bWVudHM7XG5cbiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvci5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZTYkKF9jb250ZXh0Nikge1xuICAgICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Ni5wcmV2ID0gX2NvbnRleHQ2Lm5leHQpIHtcbiAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgIG9wdGlvbnMgPSBfYXJnczYubGVuZ3RoID4gMSAmJiBfYXJnczZbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmdzNlsxXSA6IHt9O1xuXG4gICAgICAgICAgICAgICAgaWYgKCEoMCwgX2lzQXJyYXkuZGVmYXVsdCkoZG9jKSkge1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSAzO1xuICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IF9raW52ZXkuZGVmYXVsdCgnVW5hYmxlIHRvIHVwZGF0ZSBhbiBhcnJheSBvZiBlbnRpdGllcy4nLCAnUGxlYXNlIHVwZGF0ZSBlbnRpdGllcyBvbmUgYnkgb25lLicpO1xuXG4gICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICBpZiAoZG9jLl9pZCkge1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSA1O1xuICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IF9raW52ZXkuZGVmYXVsdCgnVGhlIGVudGl0eSBwcm92aWRlZCBkb2VzIG5vdCBjb250YWluIGFuIF9pZC4gQW4gX2lkIGlzIHJlcXVpcmVkIHRvIHVwZGF0ZSB0aGUgZW50aXR5LicsIGRvYyk7XG5cbiAgICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgIF9nZXRDb25maWc2ID0gKDAsIF9jb25maWcuZ2V0KSgpLCBhcGlQcm90b2NvbCA9IF9nZXRDb25maWc2LmFwaVByb3RvY29sLCBhcGlIb3N0ID0gX2dldENvbmZpZzYuYXBpSG9zdDtcbiAgICAgICAgICAgICAgICBfb3B0aW9ucyRyYXdSZXNwb25zZTYgPSBvcHRpb25zLnJhd1Jlc3BvbnNlLCByYXdSZXNwb25zZSA9IF9vcHRpb25zJHJhd1Jlc3BvbnNlNiA9PT0gdm9pZCAwID8gZmFsc2UgOiBfb3B0aW9ucyRyYXdSZXNwb25zZTYsIHRpbWVvdXQgPSBvcHRpb25zLnRpbWVvdXQsIHByb3BlcnRpZXMgPSBvcHRpb25zLnByb3BlcnRpZXMsIHRyYWNlID0gb3B0aW9ucy50cmFjZSwgc2tpcEJMID0gb3B0aW9ucy5za2lwQkw7XG4gICAgICAgICAgICAgICAgcXVlcnlPYmplY3QgPSB7fTtcbiAgICAgICAgICAgICAgICB1cmwgPSAoMCwgX3V0aWxzLmZvcm1hdEtpbnZleVVybCkoYXBpUHJvdG9jb2wsIGFwaUhvc3QsIFwiXCIuY29uY2F0KHRoaXMucGF0aG5hbWUsIFwiL1wiKS5jb25jYXQoZG9jLl9pZCksIHF1ZXJ5T2JqZWN0KTtcbiAgICAgICAgICAgICAgICByZXF1ZXN0ID0gY3JlYXRlUmVxdWVzdChfcmVxdWVzdC5SZXF1ZXN0TWV0aG9kLlBVVCwgdXJsLCBkb2MpO1xuICAgICAgICAgICAgICAgIHJlcXVlc3QuaGVhZGVycy5jdXN0b21SZXF1ZXN0UHJvcGVydGllcyA9IHByb3BlcnRpZXM7XG4gICAgICAgICAgICAgICAgcmVxdWVzdC50aW1lb3V0ID0gdGltZW91dDtcbiAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDE0O1xuICAgICAgICAgICAgICAgIHJldHVybiByZXF1ZXN0LmV4ZWN1dGUoKTtcblxuICAgICAgICAgICAgICBjYXNlIDE0OlxuICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gX2NvbnRleHQ2LnNlbnQ7XG5cbiAgICAgICAgICAgICAgICBpZiAoIShyYXdSZXNwb25zZSA9PT0gdHJ1ZSkpIHtcbiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMTc7XG4gICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LmFicnVwdChcInJldHVyblwiLCByZXNwb25zZSk7XG5cbiAgICAgICAgICAgICAgY2FzZSAxNzpcbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LmFicnVwdChcInJldHVyblwiLCByZXNwb25zZS5kYXRhKTtcblxuICAgICAgICAgICAgICBjYXNlIDE4OlxuICAgICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5zdG9wKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LCBfY2FsbGVlNiwgdGhpcyk7XG4gICAgICB9KSk7XG5cbiAgICAgIGZ1bmN0aW9uIHVwZGF0ZShfeDYpIHtcbiAgICAgICAgcmV0dXJuIF91cGRhdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHVwZGF0ZTtcbiAgICB9KClcbiAgfSwge1xuICAgIGtleTogXCJzYXZlXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHNhdmUoZG9jLCBvcHRpb25zKSB7XG4gICAgICBpZiAoZG9jLl9pZCkge1xuICAgICAgICByZXR1cm4gdGhpcy51cGRhdGUoZG9jLCBvcHRpb25zKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlKGRvYywgb3B0aW9ucyk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInJlbW92ZVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgX3JlbW92ZSA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gICAgICAvKiNfX1BVUkVfXyovXG4gICAgICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU3KHF1ZXJ5KSB7XG4gICAgICAgIHZhciBvcHRpb25zLFxuICAgICAgICAgICAgX2dldENvbmZpZzcsXG4gICAgICAgICAgICBhcGlQcm90b2NvbCxcbiAgICAgICAgICAgIGFwaUhvc3QsXG4gICAgICAgICAgICBfb3B0aW9ucyRyYXdSZXNwb25zZTcsXG4gICAgICAgICAgICByYXdSZXNwb25zZSxcbiAgICAgICAgICAgIHRpbWVvdXQsXG4gICAgICAgICAgICBwcm9wZXJ0aWVzLFxuICAgICAgICAgICAgdHJhY2UsXG4gICAgICAgICAgICBza2lwQkwsXG4gICAgICAgICAgICBxdWVyeU9iamVjdCxcbiAgICAgICAgICAgIHVybCxcbiAgICAgICAgICAgIHJlcXVlc3QsXG4gICAgICAgICAgICByZXNwb25zZSxcbiAgICAgICAgICAgIF9hcmdzNyA9IGFyZ3VtZW50cztcblxuICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yLmRlZmF1bHQud3JhcChmdW5jdGlvbiBfY2FsbGVlNyQoX2NvbnRleHQ3KSB7XG4gICAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ3LnByZXYgPSBfY29udGV4dDcubmV4dCkge1xuICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgb3B0aW9ucyA9IF9hcmdzNy5sZW5ndGggPiAxICYmIF9hcmdzN1sxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3M3WzFdIDoge307XG5cbiAgICAgICAgICAgICAgICBpZiAoIShxdWVyeSAmJiAhKHF1ZXJ5IGluc3RhbmNlb2YgX3F1ZXJ5LmRlZmF1bHQpKSkge1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSAzO1xuICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IF9raW52ZXkuZGVmYXVsdCgnSW52YWxpZCBxdWVyeS4gSXQgbXVzdCBiZSBhbiBpbnN0YW5jZSBvZiB0aGUgUXVlcnkgY2xhc3MuJyk7XG5cbiAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgIF9nZXRDb25maWc3ID0gKDAsIF9jb25maWcuZ2V0KSgpLCBhcGlQcm90b2NvbCA9IF9nZXRDb25maWc3LmFwaVByb3RvY29sLCBhcGlIb3N0ID0gX2dldENvbmZpZzcuYXBpSG9zdDtcbiAgICAgICAgICAgICAgICBfb3B0aW9ucyRyYXdSZXNwb25zZTcgPSBvcHRpb25zLnJhd1Jlc3BvbnNlLCByYXdSZXNwb25zZSA9IF9vcHRpb25zJHJhd1Jlc3BvbnNlNyA9PT0gdm9pZCAwID8gZmFsc2UgOiBfb3B0aW9ucyRyYXdSZXNwb25zZTcsIHRpbWVvdXQgPSBvcHRpb25zLnRpbWVvdXQsIHByb3BlcnRpZXMgPSBvcHRpb25zLnByb3BlcnRpZXMsIHRyYWNlID0gb3B0aW9ucy50cmFjZSwgc2tpcEJMID0gb3B0aW9ucy5za2lwQkw7XG4gICAgICAgICAgICAgICAgcXVlcnlPYmplY3QgPSBPYmplY3QuYXNzaWduKHt9LCBxdWVyeSA/IHF1ZXJ5LnRvUXVlcnlPYmplY3QoKSA6IHt9LCB7fSk7XG4gICAgICAgICAgICAgICAgdXJsID0gKDAsIF91dGlscy5mb3JtYXRLaW52ZXlVcmwpKGFwaVByb3RvY29sLCBhcGlIb3N0LCB0aGlzLnBhdGhuYW1lLCBxdWVyeU9iamVjdCk7XG4gICAgICAgICAgICAgICAgcmVxdWVzdCA9IGNyZWF0ZVJlcXVlc3QoX3JlcXVlc3QuUmVxdWVzdE1ldGhvZC5ERUxFVEUsIHVybCk7XG4gICAgICAgICAgICAgICAgcmVxdWVzdC5oZWFkZXJzLmN1c3RvbVJlcXVlc3RQcm9wZXJ0aWVzID0gcHJvcGVydGllcztcbiAgICAgICAgICAgICAgICByZXF1ZXN0LnRpbWVvdXQgPSB0aW1lb3V0O1xuICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMTI7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcXVlc3QuZXhlY3V0ZSgpO1xuXG4gICAgICAgICAgICAgIGNhc2UgMTI6XG4gICAgICAgICAgICAgICAgcmVzcG9uc2UgPSBfY29udGV4dDcuc2VudDtcblxuICAgICAgICAgICAgICAgIGlmICghKHJhd1Jlc3BvbnNlID09PSB0cnVlKSkge1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSAxNTtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuYWJydXB0KFwicmV0dXJuXCIsIHJlc3BvbnNlKTtcblxuICAgICAgICAgICAgICBjYXNlIDE1OlxuICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuYWJydXB0KFwicmV0dXJuXCIsIHJlc3BvbnNlLmRhdGEpO1xuXG4gICAgICAgICAgICAgIGNhc2UgMTY6XG4gICAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LnN0b3AoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sIF9jYWxsZWU3LCB0aGlzKTtcbiAgICAgIH0pKTtcblxuICAgICAgZnVuY3Rpb24gcmVtb3ZlKF94Nykge1xuICAgICAgICByZXR1cm4gX3JlbW92ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gcmVtb3ZlO1xuICAgIH0oKVxuICB9LCB7XG4gICAga2V5OiBcInJlbW92ZUJ5SWRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIF9yZW1vdmVCeUlkID0gKDAsIF9hc3luY1RvR2VuZXJhdG9yMi5kZWZhdWx0KShcbiAgICAgIC8qI19fUFVSRV9fKi9cbiAgICAgIF9yZWdlbmVyYXRvci5kZWZhdWx0Lm1hcmsoZnVuY3Rpb24gX2NhbGxlZTgoaWQpIHtcbiAgICAgICAgdmFyIG9wdGlvbnMsXG4gICAgICAgICAgICBfZ2V0Q29uZmlnOCxcbiAgICAgICAgICAgIGFwaVByb3RvY29sLFxuICAgICAgICAgICAgYXBpSG9zdCxcbiAgICAgICAgICAgIF9vcHRpb25zJHJhd1Jlc3BvbnNlOCxcbiAgICAgICAgICAgIHJhd1Jlc3BvbnNlLFxuICAgICAgICAgICAgdGltZW91dCxcbiAgICAgICAgICAgIHByb3BlcnRpZXMsXG4gICAgICAgICAgICB0cmFjZSxcbiAgICAgICAgICAgIHNraXBCTCxcbiAgICAgICAgICAgIHF1ZXJ5T2JqZWN0LFxuICAgICAgICAgICAgdXJsLFxuICAgICAgICAgICAgcmVxdWVzdCxcbiAgICAgICAgICAgIHJlc3BvbnNlLFxuICAgICAgICAgICAgX2FyZ3M4ID0gYXJndW1lbnRzO1xuXG4gICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3IuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWU4JChfY29udGV4dDgpIHtcbiAgICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDgucHJldiA9IF9jb250ZXh0OC5uZXh0KSB7XG4gICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICBvcHRpb25zID0gX2FyZ3M4Lmxlbmd0aCA+IDEgJiYgX2FyZ3M4WzFdICE9PSB1bmRlZmluZWQgPyBfYXJnczhbMV0gOiB7fTtcbiAgICAgICAgICAgICAgICBfZ2V0Q29uZmlnOCA9ICgwLCBfY29uZmlnLmdldCkoKSwgYXBpUHJvdG9jb2wgPSBfZ2V0Q29uZmlnOC5hcGlQcm90b2NvbCwgYXBpSG9zdCA9IF9nZXRDb25maWc4LmFwaUhvc3Q7XG4gICAgICAgICAgICAgICAgX29wdGlvbnMkcmF3UmVzcG9uc2U4ID0gb3B0aW9ucy5yYXdSZXNwb25zZSwgcmF3UmVzcG9uc2UgPSBfb3B0aW9ucyRyYXdSZXNwb25zZTggPT09IHZvaWQgMCA/IGZhbHNlIDogX29wdGlvbnMkcmF3UmVzcG9uc2U4LCB0aW1lb3V0ID0gb3B0aW9ucy50aW1lb3V0LCBwcm9wZXJ0aWVzID0gb3B0aW9ucy5wcm9wZXJ0aWVzLCB0cmFjZSA9IG9wdGlvbnMudHJhY2UsIHNraXBCTCA9IG9wdGlvbnMuc2tpcEJMO1xuICAgICAgICAgICAgICAgIHF1ZXJ5T2JqZWN0ID0ge307XG4gICAgICAgICAgICAgICAgdXJsID0gKDAsIF91dGlscy5mb3JtYXRLaW52ZXlVcmwpKGFwaVByb3RvY29sLCBhcGlIb3N0LCBcIlwiLmNvbmNhdCh0aGlzLnBhdGhuYW1lLCBcIi9cIikuY29uY2F0KGlkKSwgcXVlcnlPYmplY3QpO1xuICAgICAgICAgICAgICAgIHJlcXVlc3QgPSBjcmVhdGVSZXF1ZXN0KF9yZXF1ZXN0LlJlcXVlc3RNZXRob2QuREVMRVRFLCB1cmwpO1xuICAgICAgICAgICAgICAgIHJlcXVlc3QuaGVhZGVycy5jdXN0b21SZXF1ZXN0UHJvcGVydGllcyA9IHByb3BlcnRpZXM7XG4gICAgICAgICAgICAgICAgcmVxdWVzdC50aW1lb3V0ID0gdGltZW91dDtcbiAgICAgICAgICAgICAgICBfY29udGV4dDgubmV4dCA9IDEwO1xuICAgICAgICAgICAgICAgIHJldHVybiByZXF1ZXN0LmV4ZWN1dGUoKTtcblxuICAgICAgICAgICAgICBjYXNlIDEwOlxuICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gX2NvbnRleHQ4LnNlbnQ7XG5cbiAgICAgICAgICAgICAgICBpZiAoIShyYXdSZXNwb25zZSA9PT0gdHJ1ZSkpIHtcbiAgICAgICAgICAgICAgICAgIF9jb250ZXh0OC5uZXh0ID0gMTM7XG4gICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LmFicnVwdChcInJldHVyblwiLCByZXNwb25zZSk7XG5cbiAgICAgICAgICAgICAgY2FzZSAxMzpcbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LmFicnVwdChcInJldHVyblwiLCByZXNwb25zZS5kYXRhKTtcblxuICAgICAgICAgICAgICBjYXNlIDE0OlxuICAgICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OC5zdG9wKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LCBfY2FsbGVlOCwgdGhpcyk7XG4gICAgICB9KSk7XG5cbiAgICAgIGZ1bmN0aW9uIHJlbW92ZUJ5SWQoX3g4KSB7XG4gICAgICAgIHJldHVybiBfcmVtb3ZlQnlJZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gcmVtb3ZlQnlJZDtcbiAgICB9KClcbiAgfSwge1xuICAgIGtleTogXCJzdWJzY3JpYmVcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIF9zdWJzY3JpYmUgPSAoMCwgX2FzeW5jVG9HZW5lcmF0b3IyLmRlZmF1bHQpKFxuICAgICAgLyojX19QVVJFX18qL1xuICAgICAgX3JlZ2VuZXJhdG9yLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlOShyZWNlaXZlcikge1xuICAgICAgICB2YXIgX2dldENvbmZpZzksIGFwaVByb3RvY29sLCBhcGlIb3N0LCBkZXZpY2VJZCwgcmVxdWVzdDtcblxuICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yLmRlZmF1bHQud3JhcChmdW5jdGlvbiBfY2FsbGVlOSQoX2NvbnRleHQ5KSB7XG4gICAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ5LnByZXYgPSBfY29udGV4dDkubmV4dCkge1xuICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgaWYgKExpdmUuaXNSZWdpc3RlcmVkKCkpIHtcbiAgICAgICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gMjtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBfa2ludmV5LmRlZmF1bHQoJ1BsZWFzZSBjYWxsIEtpbnZleS5Vc2VyLnJlZ2lzdGVyRm9yTGl2ZVNlcnZpY2UoKSBiZWZvcmUgeW91IHN1YnNjcmliZSBmb3IgdG8gdGhlIGNvbGxlY3Rpb24uJyk7XG5cbiAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgIF9nZXRDb25maWc5ID0gKDAsIF9jb25maWcuZ2V0KSgpLCBhcGlQcm90b2NvbCA9IF9nZXRDb25maWc5LmFwaVByb3RvY29sLCBhcGlIb3N0ID0gX2dldENvbmZpZzkuYXBpSG9zdDtcbiAgICAgICAgICAgICAgICBkZXZpY2VJZCA9ICgwLCBfZGV2aWNlLmdldElkKSgpO1xuICAgICAgICAgICAgICAgIHJlcXVlc3QgPSBuZXcgX3JlcXVlc3QuS2ludmV5UmVxdWVzdCh7XG4gICAgICAgICAgICAgICAgICBtZXRob2Q6IF9yZXF1ZXN0LlJlcXVlc3RNZXRob2QuUE9TVCxcbiAgICAgICAgICAgICAgICAgIGF1dGg6IF9hdXRoLkF1dGguU2Vzc2lvbixcbiAgICAgICAgICAgICAgICAgIHVybDogKDAsIF91dGlscy5mb3JtYXRLaW52ZXlVcmwpKGFwaVByb3RvY29sLCBhcGlIb3N0LCBcIlwiLmNvbmNhdCh0aGlzLnBhdGhuYW1lLCBcIi9fc3Vic2NyaWJlXCIpKSxcbiAgICAgICAgICAgICAgICAgIGJvZHk6IHtcbiAgICAgICAgICAgICAgICAgICAgZGV2aWNlSWQ6IGRldmljZUlkXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgX2NvbnRleHQ5Lm5leHQgPSA3O1xuICAgICAgICAgICAgICAgIHJldHVybiByZXF1ZXN0LmV4ZWN1dGUoKTtcblxuICAgICAgICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICAgICAgTGl2ZS5zdWJzY3JpYmVUb0NoYW5uZWwodGhpcy5jaGFubmVsTmFtZSwgcmVjZWl2ZXIpO1xuICAgICAgICAgICAgICAgIExpdmUuc3Vic2NyaWJlVG9DaGFubmVsKHRoaXMucGVyc29uYWxDaGFubmVsTmFtZSwgcmVjZWl2ZXIpO1xuICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDkuYWJydXB0KFwicmV0dXJuXCIsIHRoaXMpO1xuXG4gICAgICAgICAgICAgIGNhc2UgMTA6XG4gICAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ5LnN0b3AoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sIF9jYWxsZWU5LCB0aGlzKTtcbiAgICAgIH0pKTtcblxuICAgICAgZnVuY3Rpb24gc3Vic2NyaWJlKF94OSkge1xuICAgICAgICByZXR1cm4gX3N1YnNjcmliZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gc3Vic2NyaWJlO1xuICAgIH0oKVxuICB9LCB7XG4gICAga2V5OiBcInVuc3Vic2NyaWJlXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBfdW5zdWJzY3JpYmUgPSAoMCwgX2FzeW5jVG9HZW5lcmF0b3IyLmRlZmF1bHQpKFxuICAgICAgLyojX19QVVJFX18qL1xuICAgICAgX3JlZ2VuZXJhdG9yLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlMTAoKSB7XG4gICAgICAgIHZhciBfZ2V0Q29uZmlnMTAsIGFwaVByb3RvY29sLCBhcGlIb3N0LCBkZXZpY2VJZCwgcmVxdWVzdDtcblxuICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yLmRlZmF1bHQud3JhcChmdW5jdGlvbiBfY2FsbGVlMTAkKF9jb250ZXh0MTApIHtcbiAgICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDEwLnByZXYgPSBfY29udGV4dDEwLm5leHQpIHtcbiAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgIF9nZXRDb25maWcxMCA9ICgwLCBfY29uZmlnLmdldCkoKSwgYXBpUHJvdG9jb2wgPSBfZ2V0Q29uZmlnMTAuYXBpUHJvdG9jb2wsIGFwaUhvc3QgPSBfZ2V0Q29uZmlnMTAuYXBpSG9zdDtcbiAgICAgICAgICAgICAgICBkZXZpY2VJZCA9ICgwLCBfZGV2aWNlLmdldElkKSgpO1xuICAgICAgICAgICAgICAgIHJlcXVlc3QgPSBuZXcgX3JlcXVlc3QuS2ludmV5UmVxdWVzdCh7XG4gICAgICAgICAgICAgICAgICBtZXRob2Q6IF9yZXF1ZXN0LlJlcXVlc3RNZXRob2QuUE9TVCxcbiAgICAgICAgICAgICAgICAgIGF1dGg6IF9hdXRoLkF1dGguU2Vzc2lvbixcbiAgICAgICAgICAgICAgICAgIHVybDogKDAsIF91dGlscy5mb3JtYXRLaW52ZXlVcmwpKGFwaVByb3RvY29sLCBhcGlIb3N0LCBcIlwiLmNvbmNhdCh0aGlzLnBhdGhuYW1lLCBcIi9fdW5zdWJzY3JpYmVcIikpLFxuICAgICAgICAgICAgICAgICAgYm9keToge1xuICAgICAgICAgICAgICAgICAgICBkZXZpY2VJZDogZGV2aWNlSWRcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBfY29udGV4dDEwLm5leHQgPSA1O1xuICAgICAgICAgICAgICAgIHJldHVybiByZXF1ZXN0LmV4ZWN1dGUoKTtcblxuICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgTGl2ZS51bnN1YnNjcmliZUZyb21DaGFubmVsKHRoaXMuY2hhbm5lbE5hbWUpO1xuICAgICAgICAgICAgICAgIExpdmUudW5zdWJzY3JpYmVGcm9tQ2hhbm5lbCh0aGlzLnBlcnNvbmFsQ2hhbm5lbE5hbWUpO1xuICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEwLmFicnVwdChcInJldHVyblwiLCB0aGlzKTtcblxuICAgICAgICAgICAgICBjYXNlIDg6XG4gICAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMC5zdG9wKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LCBfY2FsbGVlMTAsIHRoaXMpO1xuICAgICAgfSkpO1xuXG4gICAgICBmdW5jdGlvbiB1bnN1YnNjcmliZSgpIHtcbiAgICAgICAgcmV0dXJuIF91bnN1YnNjcmliZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdW5zdWJzY3JpYmU7XG4gICAgfSgpXG4gIH0sIHtcbiAgICBrZXk6IFwiY29sbGVjdGlvblwiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMuY29sbGVjdGlvbk5hbWU7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInBhdGhuYW1lXCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICB2YXIgX2dldENvbmZpZzExID0gKDAsIF9jb25maWcuZ2V0KSgpLFxuICAgICAgICAgIGFwcEtleSA9IF9nZXRDb25maWcxMS5hcHBLZXk7XG5cbiAgICAgIHJldHVybiBcIi9cIi5jb25jYXQoTkFNRVNQQUNFLCBcIi9cIikuY29uY2F0KGFwcEtleSwgXCIvXCIpLmNvbmNhdCh0aGlzLmNvbGxlY3Rpb25OYW1lKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiY2hhbm5lbE5hbWVcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHZhciBfZ2V0Q29uZmlnMTIgPSAoMCwgX2NvbmZpZy5nZXQpKCksXG4gICAgICAgICAgYXBwS2V5ID0gX2dldENvbmZpZzEyLmFwcEtleTtcblxuICAgICAgcmV0dXJuIFwiXCIuY29uY2F0KGFwcEtleSwgXCIuYy1cIikuY29uY2F0KHRoaXMuY29sbGVjdGlvbk5hbWUpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJwZXJzb25hbENoYW5uZWxOYW1lXCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICB2YXIgc2Vzc2lvbiA9ICgwLCBfc2Vzc2lvbi5nZXQpKCk7XG4gICAgICByZXR1cm4gXCJcIi5jb25jYXQodGhpcy5jaGFubmVsTmFtZSwgXCIudS1cIikuY29uY2F0KHNlc3Npb24uX2lkKTtcbiAgICB9XG4gIH1dKTtcbiAgcmV0dXJuIE5ldHdvcmtTdG9yZTtcbn0oKTtcblxuZXhwb3J0cy5OZXR3b3JrU3RvcmUgPSBOZXR3b3JrU3RvcmU7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gcmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW50ZXJvcFJlcXVpcmVEZWZhdWx0XCIpO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5xdWVyeVRvU3luY1F1ZXJ5ID0gcXVlcnlUb1N5bmNRdWVyeTtcbmV4cG9ydHMuU3luYyA9IGV4cG9ydHMuU3luY0V2ZW50ID0gdm9pZCAwO1xuXG52YXIgX3JlZ2VuZXJhdG9yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvcmVnZW5lcmF0b3JcIikpO1xuXG52YXIgX2FzeW5jVG9HZW5lcmF0b3IyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9hc3luY1RvR2VuZXJhdG9yXCIpKTtcblxudmFyIF9jcmVhdGVDbGFzczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2NyZWF0ZUNsYXNzXCIpKTtcblxudmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrXCIpKTtcblxudmFyIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvcG9zc2libGVDb25zdHJ1Y3RvclJldHVyblwiKSk7XG5cbnZhciBfZ2V0UHJvdG90eXBlT2YyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9nZXRQcm90b3R5cGVPZlwiKSk7XG5cbnZhciBfaW5oZXJpdHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbmhlcml0c1wiKSk7XG5cbnZhciBfZGVmaW5lUHJvcGVydHkyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9kZWZpbmVQcm9wZXJ0eVwiKSk7XG5cbnZhciBfcXVlcnkgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi9xdWVyeVwiKSk7XG5cbnZhciBfc3luYyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uL2Vycm9ycy9zeW5jXCIpKTtcblxudmFyIF9ub3RGb3VuZCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uL2Vycm9ycy9ub3RGb3VuZFwiKSk7XG5cbnZhciBfbmV0d29ya3N0b3JlID0gcmVxdWlyZShcIi4vbmV0d29ya3N0b3JlXCIpO1xuXG52YXIgX2NhY2hlID0gcmVxdWlyZShcIi4vY2FjaGVcIik7XG5cbnZhciBTWU5DX0NBQ0hFX1RBRyA9ICdraW52ZXlfc3luYyc7XG52YXIgUFVTSF9JTl9QUk9HUkVTUyA9IHt9O1xuXG5mdW5jdGlvbiBtYXJrUHVzaFN0YXJ0KGNvbGxlY3Rpb25OYW1lKSB7XG4gIFBVU0hfSU5fUFJPR1JFU1NbY29sbGVjdGlvbk5hbWVdID0gdHJ1ZTtcbn1cblxuZnVuY3Rpb24gbWFya1B1c2hFbmQoY29sbGVjdGlvbk5hbWUpIHtcbiAgUFVTSF9JTl9QUk9HUkVTU1tjb2xsZWN0aW9uTmFtZV0gPSBmYWxzZTtcbn1cblxuZnVuY3Rpb24gcXVlcnlUb1N5bmNRdWVyeShxdWVyeSwgY29sbGVjdGlvbk5hbWUpIHtcbiAgaWYgKHF1ZXJ5ICYmIHF1ZXJ5IGluc3RhbmNlb2YgX3F1ZXJ5LmRlZmF1bHQpIHtcbiAgICB2YXIgbmV3RmlsdGVyID0gT2JqZWN0LmtleXMocXVlcnkuZmlsdGVyKS5yZWR1Y2UoZnVuY3Rpb24gKGZpbHRlciwgZmllbGQpIHtcbiAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCBmaWx0ZXIsICgwLCBfZGVmaW5lUHJvcGVydHkyLmRlZmF1bHQpKHt9LCBcImVudGl0eS5cIi5jb25jYXQoZmllbGQpLCBxdWVyeS5maWx0ZXJbZmllbGRdKSk7XG4gICAgfSwge30pO1xuICAgIHZhciBuZXdTb3J0ID0gT2JqZWN0LmtleXMocXVlcnkuc29ydCkucmVkdWNlKGZ1bmN0aW9uIChzb3J0LCBmaWVsZCkge1xuICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIHNvcnQsICgwLCBfZGVmaW5lUHJvcGVydHkyLmRlZmF1bHQpKHt9LCBcImVudGl0eS5cIi5jb25jYXQoZmllbGQpLCBxdWVyeS5zb3J0W2ZpZWxkXSkpO1xuICAgIH0sIHt9KTtcbiAgICB2YXIgc3luY1F1ZXJ5ID0gbmV3IF9xdWVyeS5kZWZhdWx0KHtcbiAgICAgIGZpbHRlcjogbmV3RmlsdGVyLFxuICAgICAgc29ydDogbmV3U29ydCxcbiAgICAgIHNraXA6IHF1ZXJ5LnNraXAsXG4gICAgICBsaW1pdDogcXVlcnkubGltaXRcbiAgICB9KTtcblxuICAgIGlmIChjb2xsZWN0aW9uTmFtZSkge1xuICAgICAgc3luY1F1ZXJ5LmVxdWFsVG8oJ2NvbGxlY3Rpb24nLCBjb2xsZWN0aW9uTmFtZSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHN5bmNRdWVyeTtcbiAgfVxuXG4gIHJldHVybiBudWxsO1xufVxuXG52YXIgU3luY0V2ZW50ID0ge1xuICBDcmVhdGU6ICdQT1NUJyxcbiAgVXBkYXRlOiAnUFVUJyxcbiAgRGVsZXRlOiAnREVMRVRFJ1xufTtcbmV4cG9ydHMuU3luY0V2ZW50ID0gU3luY0V2ZW50O1xuXG52YXIgU3luY0NhY2hlID1cbi8qI19fUFVSRV9fKi9cbmZ1bmN0aW9uIChfRGF0YVN0b3JlQ2FjaGUpIHtcbiAgKDAsIF9pbmhlcml0czIuZGVmYXVsdCkoU3luY0NhY2hlLCBfRGF0YVN0b3JlQ2FjaGUpO1xuXG4gIGZ1bmN0aW9uIFN5bmNDYWNoZSh0YWcpIHtcbiAgICAoMCwgX2NsYXNzQ2FsbENoZWNrMi5kZWZhdWx0KSh0aGlzLCBTeW5jQ2FjaGUpO1xuICAgIHJldHVybiAoMCwgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yLmRlZmF1bHQpKHRoaXMsICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKFN5bmNDYWNoZSkuY2FsbCh0aGlzLCBTWU5DX0NBQ0hFX1RBRywgdGFnKSk7XG4gIH1cblxuICByZXR1cm4gU3luY0NhY2hlO1xufShfY2FjaGUuRGF0YVN0b3JlQ2FjaGUpO1xuXG52YXIgU3luYyA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIFN5bmMoY29sbGVjdGlvbk5hbWUsIHRhZykge1xuICAgICgwLCBfY2xhc3NDYWxsQ2hlY2syLmRlZmF1bHQpKHRoaXMsIFN5bmMpO1xuICAgIHRoaXMuY29sbGVjdGlvbk5hbWUgPSBjb2xsZWN0aW9uTmFtZTtcbiAgICB0aGlzLnRhZyA9IHRhZztcbiAgfVxuXG4gICgwLCBfY3JlYXRlQ2xhc3MyLmRlZmF1bHQpKFN5bmMsIFt7XG4gICAga2V5OiBcImlzUHVzaEluUHJvZ3Jlc3NcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gaXNQdXNoSW5Qcm9ncmVzcygpIHtcbiAgICAgIHJldHVybiBQVVNIX0lOX1BST0dSRVNTW3RoaXMuY29sbGVjdGlvbk5hbWVdID09PSB0cnVlO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJmaW5kXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGZpbmQocXVlcnkpIHtcbiAgICAgIHZhciBzeW5jQ2FjaGUgPSBuZXcgU3luY0NhY2hlKHRoaXMudGFnKTtcbiAgICAgIHJldHVybiBzeW5jQ2FjaGUuZmluZChxdWVyeSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImZpbmRCeUlkXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGZpbmRCeUlkKGlkKSB7XG4gICAgICB2YXIgc3luY0NhY2hlID0gbmV3IFN5bmNDYWNoZSh0aGlzLnRhZyk7XG4gICAgICByZXR1cm4gc3luY0NhY2hlLmZpbmRCeUlkKGlkKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiY291bnRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gY291bnQocXVlcnkpIHtcbiAgICAgIHZhciBzeW5jQ2FjaGUgPSBuZXcgU3luY0NhY2hlKHRoaXMudGFnKTtcbiAgICAgIHJldHVybiBzeW5jQ2FjaGUuY291bnQocXVlcnkpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJhZGRDcmVhdGVTeW5jRXZlbnRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gYWRkQ3JlYXRlU3luY0V2ZW50KGRvY3MpIHtcbiAgICAgIHJldHVybiB0aGlzLmFkZFN5bmNFdmVudChTeW5jRXZlbnQuQ3JlYXRlLCBkb2NzKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiYWRkVXBkYXRlU3luY0V2ZW50XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGFkZFVwZGF0ZVN5bmNFdmVudChkb2NzKSB7XG4gICAgICByZXR1cm4gdGhpcy5hZGRTeW5jRXZlbnQoU3luY0V2ZW50LlVwZGF0ZSwgZG9jcyk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImFkZERlbGV0ZVN5bmNFdmVudFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBhZGREZWxldGVTeW5jRXZlbnQoZG9jcykge1xuICAgICAgcmV0dXJuIHRoaXMuYWRkU3luY0V2ZW50KFN5bmNFdmVudC5EZWxldGUsIGRvY3MpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJhZGRTeW5jRXZlbnRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIF9hZGRTeW5jRXZlbnQgPSAoMCwgX2FzeW5jVG9HZW5lcmF0b3IyLmRlZmF1bHQpKFxuICAgICAgLyojX19QVVJFX18qL1xuICAgICAgX3JlZ2VuZXJhdG9yLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlKGV2ZW50LCBkb2NzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICAgICAgdmFyIHN5bmNDYWNoZSwgc2luZ3VsYXIsIHN5bmNEb2NzLCBkb2NzVG9TeW5jLCBkb2NXaXRoTm9JZCwgcXVlcnk7XG4gICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3IuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7XG4gICAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHtcbiAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgIHN5bmNDYWNoZSA9IG5ldyBTeW5jQ2FjaGUodGhpcy50YWcpO1xuICAgICAgICAgICAgICAgIHNpbmd1bGFyID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgc3luY0RvY3MgPSBbXTtcbiAgICAgICAgICAgICAgICBkb2NzVG9TeW5jID0gZG9jcztcblxuICAgICAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheShkb2NzKSkge1xuICAgICAgICAgICAgICAgICAgc2luZ3VsYXIgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgZG9jc1RvU3luYyA9IFtkb2NzXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoIShkb2NzVG9TeW5jLmxlbmd0aCA+IDApKSB7XG4gICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTY7XG4gICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBkb2NXaXRoTm9JZCA9IGRvY3NUb1N5bmMuZmluZChmdW5jdGlvbiAoZG9jKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gIWRvYy5faWQ7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIWRvY1dpdGhOb0lkKSB7XG4gICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gOTtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBfc3luYy5kZWZhdWx0KCdBIGRvYyBpcyBtaXNzaW5nIGFuIF9pZC4gQWxsIGRvY3MgbXVzdCBoYXZlIGFuIF9pZCBpbiBvcmRlciB0byBiZSBhZGRlZCB0byB0aGUgc3luYyBjb2xsZWN0aW9uLicpO1xuXG4gICAgICAgICAgICAgIGNhc2UgOTpcbiAgICAgICAgICAgICAgICAvLyBSZW1vdmUgZXhpc3Rpbmcgc3luYyBldmVudHMgdGhhdCBtYXRjaCB0aGUgZG9jc1xuICAgICAgICAgICAgICAgIHF1ZXJ5ID0gbmV3IF9xdWVyeS5kZWZhdWx0KCkuY29udGFpbnMoJ2VudGl0eUlkJywgZG9jc1RvU3luYy5tYXAoZnVuY3Rpb24gKGRvYykge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIGRvYy5faWQ7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMjtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZW1vdmUocXVlcnkpO1xuXG4gICAgICAgICAgICAgIGNhc2UgMTI6XG4gICAgICAgICAgICAgICAgLy8gRG9uJ3QgYWRkIGRlbGV0ZSBldmVudHMgZm9yIGRvY3MgdGhhdCB3ZXJlIGNyZWF0ZWQgb2ZmbGluZVxuICAgICAgICAgICAgICAgIGlmIChldmVudCA9PT0gU3luY0V2ZW50LkRlbGV0ZSkge1xuICAgICAgICAgICAgICAgICAgZG9jc1RvU3luYyA9IGRvY3NUb1N5bmMuZmlsdGVyKGZ1bmN0aW9uIChkb2MpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRvYy5fa21kICYmIGRvYy5fa21kLmxvY2FsID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IC8vIEFkZCBzeW5jIGV2ZW50cyBmb3IgdGhlIGRvY3NcblxuXG4gICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE1O1xuICAgICAgICAgICAgICAgIHJldHVybiBzeW5jQ2FjaGUuc2F2ZShkb2NzVG9TeW5jLm1hcChmdW5jdGlvbiAoZG9jKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBlbnRpdHlJZDogZG9jLl9pZCxcbiAgICAgICAgICAgICAgICAgICAgZW50aXR5OiBkb2MsXG4gICAgICAgICAgICAgICAgICAgIGNvbGxlY3Rpb246IF90aGlzLmNvbGxlY3Rpb25OYW1lLFxuICAgICAgICAgICAgICAgICAgICBzdGF0ZToge1xuICAgICAgICAgICAgICAgICAgICAgIG9wZXJhdGlvbjogZXZlbnRcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgICAgICAgY2FzZSAxNTpcbiAgICAgICAgICAgICAgICBzeW5jRG9jcyA9IF9jb250ZXh0LnNlbnQ7XG5cbiAgICAgICAgICAgICAgY2FzZSAxNjpcbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KFwicmV0dXJuXCIsIHNpbmd1bGFyID8gc3luY0RvY3Muc2hpZnQoKSA6IHN5bmNEb2NzKTtcblxuICAgICAgICAgICAgICBjYXNlIDE3OlxuICAgICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sIF9jYWxsZWUsIHRoaXMpO1xuICAgICAgfSkpO1xuXG4gICAgICBmdW5jdGlvbiBhZGRTeW5jRXZlbnQoX3gsIF94Mikge1xuICAgICAgICByZXR1cm4gX2FkZFN5bmNFdmVudC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gYWRkU3luY0V2ZW50O1xuICAgIH0oKVxuICB9LCB7XG4gICAga2V5OiBcInB1c2hcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIF9wdXNoID0gKDAsIF9hc3luY1RvR2VuZXJhdG9yMi5kZWZhdWx0KShcbiAgICAgIC8qI19fUFVSRV9fKi9cbiAgICAgIF9yZWdlbmVyYXRvci5kZWZhdWx0Lm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQocXVlcnksIG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICAgICAgdmFyIG5ldHdvcmssIGNhY2hlLCBzeW5jQ2FjaGUsIGJhdGNoU2l6ZSwgc3luY0RvY3MsIGksIGJhdGNoUHVzaDtcbiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvci5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZTQkKF9jb250ZXh0NCkge1xuICAgICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHtcbiAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgIG5ldHdvcmsgPSBuZXcgX25ldHdvcmtzdG9yZS5OZXR3b3JrU3RvcmUodGhpcy5jb2xsZWN0aW9uTmFtZSk7XG4gICAgICAgICAgICAgICAgY2FjaGUgPSBuZXcgX2NhY2hlLkRhdGFTdG9yZUNhY2hlKHRoaXMuY29sbGVjdGlvbk5hbWUsIHRoaXMudGFnKTtcbiAgICAgICAgICAgICAgICBzeW5jQ2FjaGUgPSBuZXcgU3luY0NhY2hlKHRoaXMudGFnKTtcblxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5pc1B1c2hJblByb2dyZXNzKCkpIHtcbiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gNTtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBfc3luYy5kZWZhdWx0KCdEYXRhIGlzIGFscmVhZHkgYmVpbmcgcHVzaGVkIHRvIHRoZSBiYWNrZW5kLiBQbGVhc2Ugd2FpdCBmb3IgaXQgdG8gY29tcGxldGUgYmVmb3JlIHB1c2hpbmcgbmV3IGRhdGEgdG8gdGhlIGJhY2tlbmQuJyk7XG5cbiAgICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgIGJhdGNoU2l6ZSA9IDEwMDtcbiAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDg7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN5bmNDYWNoZS5maW5kKHF1ZXJ5KTtcblxuICAgICAgICAgICAgICBjYXNlIDg6XG4gICAgICAgICAgICAgICAgc3luY0RvY3MgPSBfY29udGV4dDQuc2VudDtcblxuICAgICAgICAgICAgICAgIGlmICghKHN5bmNEb2NzLmxlbmd0aCA+IDApKSB7XG4gICAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDEzO1xuICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaSA9IDA7XG5cbiAgICAgICAgICAgICAgICBiYXRjaFB1c2ggPVxuICAgICAgICAgICAgICAgIC8qI19fUFVSRV9fKi9cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgX3JlZiA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gICAgICAgICAgICAgICAgICAvKiNfX1BVUkVfXyovXG4gICAgICAgICAgICAgICAgICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcHVzaFJlc3VsdHMsXG4gICAgICAgICAgICAgICAgICAgICAgICBiYXRjaCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdHMsXG4gICAgICAgICAgICAgICAgICAgICAgICBfYXJnczMgPSBhcmd1bWVudHM7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3IuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzJChfY29udGV4dDMpIHtcbiAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdXNoUmVzdWx0cyA9IF9hcmdzMy5sZW5ndGggPiAwICYmIF9hcmdzM1swXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3MzWzBdIDogW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya1B1c2hTdGFydChfdGhpczIuY29sbGVjdGlvbk5hbWUpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoaSA+PSBzeW5jRG9jcy5sZW5ndGgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJrUHVzaEVuZChfdGhpczIuY29sbGVjdGlvbk5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuYWJydXB0KFwicmV0dXJuXCIsIHB1c2hSZXN1bHRzKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmF0Y2ggPSBzeW5jRG9jcy5zbGljZShpLCBpICsgYmF0Y2hTaXplKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpICs9IGJhdGNoU2l6ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKGJhdGNoLm1hcChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiNfX1BVUkVfXyovXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYyID0gKDAsIF9hc3luY1RvR2VuZXJhdG9yMi5kZWZhdWx0KShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qI19fUFVSRV9fKi9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9yZWdlbmVyYXRvci5kZWZhdWx0Lm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoc3luY0RvYykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2lkLCBlbnRpdHlJZCwgX3N5bmNEb2Mkc3RhdGUsIHN0YXRlLCBldmVudCwgZG9jLCBsb2NhbDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yLmRlZmF1bHQud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2lkID0gc3luY0RvYy5faWQsIGVudGl0eUlkID0gc3luY0RvYy5lbnRpdHlJZCwgX3N5bmNEb2Mkc3RhdGUgPSBzeW5jRG9jLnN0YXRlLCBzdGF0ZSA9IF9zeW5jRG9jJHN0YXRlID09PSB2b2lkIDAgPyB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcGVyYXRpb246IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gOiBfc3luY0RvYyRzdGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudCA9IHN0YXRlLm9wZXJhdGlvbjtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKGV2ZW50ID09PSBTeW5jRXZlbnQuRGVsZXRlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAyMztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5wcmV2ID0gMztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDIucHJldiA9IDQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA3O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXR3b3JrLnJlbW92ZUJ5SWQoZW50aXR5SWQsIG9wdGlvbnMpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDEzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgOTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDIucHJldiA9IDk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLnQwID0gX2NvbnRleHQyW1wiY2F0Y2hcIl0oNCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoX2NvbnRleHQyLnQwIGluc3RhbmNlb2YgX25vdEZvdW5kLmRlZmF1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBfY29udGV4dDIudDA7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDE1O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzeW5jQ2FjaGUucmVtb3ZlQnlJZChfaWQpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTU6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoXCJyZXR1cm5cIiwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2lkOiBlbnRpdHlJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wZXJhdGlvbjogZXZlbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE4OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5wcmV2ID0gMTg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLnQxID0gX2NvbnRleHQyW1wiY2F0Y2hcIl0oMyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoXCJyZXR1cm5cIiwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2lkOiBlbnRpdHlJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wZXJhdGlvbjogZXZlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogX2NvbnRleHQyLnQxXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyMTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDUyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjM6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoZXZlbnQgPT09IFN5bmNFdmVudC5DcmVhdGUgfHwgZXZlbnQgPT09IFN5bmNFdmVudC5VcGRhdGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDUyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAyNjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2FjaGUuZmluZEJ5SWQoZW50aXR5SWQpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjY6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jID0gX2NvbnRleHQyLnNlbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWwgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDIucHJldiA9IDI4O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoZXZlbnQgPT09IFN5bmNFdmVudC5DcmVhdGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDM2O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRvYy5fa21kICYmIGRvYy5fa21kLmxvY2FsID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbCA9IHRydWU7IC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1kZWxldGVcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGRvYy5faWQ7IC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1kZWxldGVcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGRvYy5fa21kLmxvY2FsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMzM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldHdvcmsuY3JlYXRlKGRvYywgb3B0aW9ucyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzMzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2MgPSBfY29udGV4dDIuc2VudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDM5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzY6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzODtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV0d29yay51cGRhdGUoZG9jLCBvcHRpb25zKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM4OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvYyA9IF9jb250ZXh0Mi5zZW50O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzk6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA0MTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3luY0NhY2hlLnJlbW92ZUJ5SWQoX2lkKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQxOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNDM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhY2hlLnNhdmUoZG9jKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQzOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbG9jYWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNDY7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDQ2O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjYWNoZS5yZW1vdmVCeUlkKGVudGl0eUlkKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQ2OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KFwicmV0dXJuXCIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogZW50aXR5SWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcGVyYXRpb246IGV2ZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW50aXR5OiBkb2NcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQ5OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5wcmV2ID0gNDk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLnQyID0gX2NvbnRleHQyW1wiY2F0Y2hcIl0oMjgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KFwicmV0dXJuXCIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pZDogZW50aXR5SWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcGVyYXRpb246IGV2ZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW50aXR5OiBkb2MsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogX2NvbnRleHQyLnQyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA1MjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdChcInJldHVyblwiLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaWQ6IF9pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wZXJhdGlvbjogZXZlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogbmV3IEVycm9yKCdVbmFibGUgdG8gcHVzaCBpdGVtIGluIHN5bmMgdGFibGUgYmVjYXVzZSB0aGUgZXZlbnQgd2FzIG5vdCByZWNvZ25pemVkLicpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA1MzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgX2NhbGxlZTIsIHRoaXMsIFtbMywgMThdLCBbNCwgOV0sIFsyOCwgNDldXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoX3g1KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfcmVmMi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KCkpKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDk6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0cyA9IF9jb250ZXh0My5zZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtQdXNoRW5kKF90aGlzMi5jb2xsZWN0aW9uTmFtZSk7IC8vIFB1c2ggcmVtYWluaW5nIGRvY3NcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuYWJydXB0KFwicmV0dXJuXCIsIGJhdGNoUHVzaChwdXNoUmVzdWx0cy5jb25jYXQocmVzdWx0cykpKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEyOlxuICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlMywgdGhpcyk7XG4gICAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiBiYXRjaFB1c2goKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBfcmVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0oKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KFwicmV0dXJuXCIsIGJhdGNoUHVzaCgpKTtcblxuICAgICAgICAgICAgICBjYXNlIDEzOlxuICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KFwicmV0dXJuXCIsIFtdKTtcblxuICAgICAgICAgICAgICBjYXNlIDE0OlxuICAgICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5zdG9wKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LCBfY2FsbGVlNCwgdGhpcyk7XG4gICAgICB9KSk7XG5cbiAgICAgIGZ1bmN0aW9uIHB1c2goX3gzLCBfeDQpIHtcbiAgICAgICAgcmV0dXJuIF9wdXNoLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBwdXNoO1xuICAgIH0oKVxuICB9LCB7XG4gICAga2V5OiBcInJlbW92ZVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgX3JlbW92ZSA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gICAgICAvKiNfX1BVUkVfXyovXG4gICAgICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU1KHF1ZXJ5KSB7XG4gICAgICAgIHZhciBzeW5jQ2FjaGU7XG4gICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3IuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWU1JChfY29udGV4dDUpIHtcbiAgICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDUucHJldiA9IF9jb250ZXh0NS5uZXh0KSB7XG4gICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICBzeW5jQ2FjaGUgPSBuZXcgU3luY0NhY2hlKHRoaXMudGFnKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LmFicnVwdChcInJldHVyblwiLCBzeW5jQ2FjaGUucmVtb3ZlKHF1ZXJ5KSk7XG5cbiAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5zdG9wKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LCBfY2FsbGVlNSwgdGhpcyk7XG4gICAgICB9KSk7XG5cbiAgICAgIGZ1bmN0aW9uIHJlbW92ZShfeDYpIHtcbiAgICAgICAgcmV0dXJuIF9yZW1vdmUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHJlbW92ZTtcbiAgICB9KClcbiAgfSwge1xuICAgIGtleTogXCJyZW1vdmVCeUlkXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBfcmVtb3ZlQnlJZCA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gICAgICAvKiNfX1BVUkVfXyovXG4gICAgICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU2KGlkKSB7XG4gICAgICAgIHZhciBzeW5jQ2FjaGU7XG4gICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3IuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWU2JChfY29udGV4dDYpIHtcbiAgICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDYucHJldiA9IF9jb250ZXh0Ni5uZXh0KSB7XG4gICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICBzeW5jQ2FjaGUgPSBuZXcgU3luY0NhY2hlKHRoaXMudGFnKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LmFicnVwdChcInJldHVyblwiLCBzeW5jQ2FjaGUucmVtb3ZlQnlJZChpZCkpO1xuXG4gICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuc3RvcCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSwgX2NhbGxlZTYsIHRoaXMpO1xuICAgICAgfSkpO1xuXG4gICAgICBmdW5jdGlvbiByZW1vdmVCeUlkKF94Nykge1xuICAgICAgICByZXR1cm4gX3JlbW92ZUJ5SWQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHJlbW92ZUJ5SWQ7XG4gICAgfSgpXG4gIH0sIHtcbiAgICBrZXk6IFwiY2xlYXJcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIF9jbGVhciA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gICAgICAvKiNfX1BVUkVfXyovXG4gICAgICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU3KCkge1xuICAgICAgICB2YXIgc3luY0NhY2hlO1xuICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yLmRlZmF1bHQud3JhcChmdW5jdGlvbiBfY2FsbGVlNyQoX2NvbnRleHQ3KSB7XG4gICAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ3LnByZXYgPSBfY29udGV4dDcubmV4dCkge1xuICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgc3luY0NhY2hlID0gbmV3IFN5bmNDYWNoZSh0aGlzLnRhZyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5hYnJ1cHQoXCJyZXR1cm5cIiwgc3luY0NhY2hlLnJlbW92ZSgpKTtcblxuICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LnN0b3AoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sIF9jYWxsZWU3LCB0aGlzKTtcbiAgICAgIH0pKTtcblxuICAgICAgZnVuY3Rpb24gY2xlYXIoKSB7XG4gICAgICAgIHJldHVybiBfY2xlYXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGNsZWFyO1xuICAgIH0oKVxuICB9XSk7XG4gIHJldHVybiBTeW5jO1xufSgpO1xuXG5leHBvcnRzLlN5bmMgPSBTeW5jOyIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IGVuZHBvaW50O1xuXG52YXIgX3JlZ2VuZXJhdG9yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvcmVnZW5lcmF0b3JcIikpO1xuXG52YXIgX2FzeW5jVG9HZW5lcmF0b3IyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9hc3luY1RvR2VuZXJhdG9yXCIpKTtcblxudmFyIF9pc1N0cmluZyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcImxvZGFzaC9pc1N0cmluZ1wiKSk7XG5cbnZhciBfdXRpbHMgPSByZXF1aXJlKFwiLi9odHRwL3V0aWxzXCIpO1xuXG52YXIgX3JlcXVlc3QgPSByZXF1aXJlKFwiLi9odHRwL3JlcXVlc3RcIik7XG5cbnZhciBfYXV0aCA9IHJlcXVpcmUoXCIuL2h0dHAvYXV0aFwiKTtcblxudmFyIF9jb25maWcgPSByZXF1aXJlKFwiLi9raW52ZXkvY29uZmlnXCIpO1xuXG52YXIgX2tpbnZleSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vZXJyb3JzL2tpbnZleVwiKSk7XG5cbnZhciBSUENfTkFNRVNQQUNFID0gJ3JwYyc7XG5cbmZ1bmN0aW9uIGVuZHBvaW50KF94LCBfeDIpIHtcbiAgcmV0dXJuIF9lbmRwb2ludC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuXG5mdW5jdGlvbiBfZW5kcG9pbnQoKSB7XG4gIF9lbmRwb2ludCA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gIC8qI19fUFVSRV9fKi9cbiAgX3JlZ2VuZXJhdG9yLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlKGVuZHBvaW50LCBhcmdzKSB7XG4gICAgdmFyIG9wdGlvbnMsXG4gICAgICAgIF9nZXRDb25maWcsXG4gICAgICAgIGFwaVByb3RvY29sLFxuICAgICAgICBhcGlIb3N0LFxuICAgICAgICBhcHBLZXksXG4gICAgICAgIHJlcXVlc3QsXG4gICAgICAgIHJlc3BvbnNlLFxuICAgICAgICBfYXJncyA9IGFyZ3VtZW50cztcblxuICAgIHJldHVybiBfcmVnZW5lcmF0b3IuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7XG4gICAgICB3aGlsZSAoMSkge1xuICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7XG4gICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgb3B0aW9ucyA9IF9hcmdzLmxlbmd0aCA+IDIgJiYgX2FyZ3NbMl0gIT09IHVuZGVmaW5lZCA/IF9hcmdzWzJdIDoge307XG5cbiAgICAgICAgICAgIGlmICgoMCwgX2lzU3RyaW5nLmRlZmF1bHQpKGVuZHBvaW50KSkge1xuICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMztcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRocm93IG5ldyBfa2ludmV5LmRlZmF1bHQoJ0FuIGVuZHBvaW50IGlzIHJlcXVpcmVkIGFuZCBtdXN0IGJlIGEgc3RyaW5nLicpO1xuXG4gICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgX2dldENvbmZpZyA9ICgwLCBfY29uZmlnLmdldCkoKSwgYXBpUHJvdG9jb2wgPSBfZ2V0Q29uZmlnLmFwaVByb3RvY29sLCBhcGlIb3N0ID0gX2dldENvbmZpZy5hcGlIb3N0LCBhcHBLZXkgPSBfZ2V0Q29uZmlnLmFwcEtleTtcbiAgICAgICAgICAgIHJlcXVlc3QgPSBuZXcgX3JlcXVlc3QuS2ludmV5UmVxdWVzdCh7XG4gICAgICAgICAgICAgIG1ldGhvZDogX3JlcXVlc3QuUmVxdWVzdE1ldGhvZC5QT1NULFxuICAgICAgICAgICAgICBhdXRoOiBfYXV0aC5BdXRoLlNlc3Npb24sXG4gICAgICAgICAgICAgIHVybDogKDAsIF91dGlscy5mb3JtYXRLaW52ZXlVcmwpKGFwaVByb3RvY29sLCBhcGlIb3N0LCBcIi9cIi5jb25jYXQoUlBDX05BTUVTUEFDRSwgXCIvXCIpLmNvbmNhdChhcHBLZXksIFwiL2N1c3RvbS9cIikuY29uY2F0KGVuZHBvaW50KSksXG4gICAgICAgICAgICAgIGJvZHk6IGFyZ3MsXG4gICAgICAgICAgICAgIHRpbWVvdXQ6IG9wdGlvbnMudGltZW91dFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNztcbiAgICAgICAgICAgIHJldHVybiByZXF1ZXN0LmV4ZWN1dGUoKTtcblxuICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgIHJlc3BvbnNlID0gX2NvbnRleHQuc2VudDtcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoXCJyZXR1cm5cIiwgcmVzcG9uc2UuZGF0YSk7XG5cbiAgICAgICAgICBjYXNlIDk6XG4gICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIF9jYWxsZWUsIHRoaXMpO1xuICB9KSk7XG4gIHJldHVybiBfZW5kcG9pbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn0iLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG5cbnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVja1wiKSk7XG5cbnZhciBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm5cIikpO1xuXG52YXIgX2dldFByb3RvdHlwZU9mMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZ2V0UHJvdG90eXBlT2ZcIikpO1xuXG52YXIgX2luaGVyaXRzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW5oZXJpdHNcIikpO1xuXG52YXIgX2Fzc2VydFRoaXNJbml0aWFsaXplZDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2Fzc2VydFRoaXNJbml0aWFsaXplZFwiKSk7XG5cbnZhciBfYmFzZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vYmFzZVwiKSk7XG5cbnZhciBBY3RpdmVVc2VyRXJyb3IgPVxuLyojX19QVVJFX18qL1xuZnVuY3Rpb24gKF9CYXNlRXJyb3IpIHtcbiAgKDAsIF9pbmhlcml0czIuZGVmYXVsdCkoQWN0aXZlVXNlckVycm9yLCBfQmFzZUVycm9yKTtcblxuICBmdW5jdGlvbiBBY3RpdmVVc2VyRXJyb3IoKSB7XG4gICAgdmFyIF9nZXRQcm90b3R5cGVPZjI7XG5cbiAgICB2YXIgX3RoaXM7XG5cbiAgICB2YXIgbWVzc2FnZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogJ0FuIGFjdGl2ZSB1c2VyIGFscmVhZHkgZXhpc3RzLic7XG4gICAgKDAsIF9jbGFzc0NhbGxDaGVjazIuZGVmYXVsdCkodGhpcywgQWN0aXZlVXNlckVycm9yKTtcblxuICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4gPiAxID8gX2xlbiAtIDEgOiAwKSwgX2tleSA9IDE7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgIGFyZ3NbX2tleSAtIDFdID0gYXJndW1lbnRzW19rZXldO1xuICAgIH1cblxuICAgIC8vIFBhc3MgcmVtYWluaW5nIGFyZ3VtZW50cyAoaW5jbHVkaW5nIHZlbmRvciBzcGVjaWZpYyBvbmVzKSB0byBwYXJlbnQgY29uc3RydWN0b3JcbiAgICBfdGhpcyA9ICgwLCBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIuZGVmYXVsdCkodGhpcywgKF9nZXRQcm90b3R5cGVPZjIgPSAoMCwgX2dldFByb3RvdHlwZU9mMy5kZWZhdWx0KShBY3RpdmVVc2VyRXJyb3IpKS5jYWxsLmFwcGx5KF9nZXRQcm90b3R5cGVPZjIsIFt0aGlzLCBtZXNzYWdlXS5jb25jYXQoYXJncykpKTsgLy8gTWFpbnRhaW5zIHByb3BlciBzdGFjayB0cmFjZSBmb3Igd2hlcmUgb3VyIGVycm9yIHdhcyB0aHJvd24gKG9ubHkgYXZhaWxhYmxlIG9uIFY4KVxuXG4gICAgaWYgKEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKSB7XG4gICAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSgoMCwgX2Fzc2VydFRoaXNJbml0aWFsaXplZDIuZGVmYXVsdCkoKDAsIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQyLmRlZmF1bHQpKF90aGlzKSksIEFjdGl2ZVVzZXJFcnJvcik7XG4gICAgfSAvLyBDdXN0b20gZGVidWdnaW5nIGluZm9ybWF0aW9uXG5cblxuICAgIF90aGlzLm5hbWUgPSAnQWN0aXZlVXNlckVycm9yJztcbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICByZXR1cm4gQWN0aXZlVXNlckVycm9yO1xufShfYmFzZS5kZWZhdWx0KTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gQWN0aXZlVXNlckVycm9yOyIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcblxudmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrXCIpKTtcblxudmFyIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvcG9zc2libGVDb25zdHJ1Y3RvclJldHVyblwiKSk7XG5cbnZhciBfZ2V0UHJvdG90eXBlT2YzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9nZXRQcm90b3R5cGVPZlwiKSk7XG5cbnZhciBfaW5oZXJpdHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbmhlcml0c1wiKSk7XG5cbnZhciBfYXNzZXJ0VGhpc0luaXRpYWxpemVkMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXNzZXJ0VGhpc0luaXRpYWxpemVkXCIpKTtcblxudmFyIF9iYXNlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9iYXNlXCIpKTtcblxudmFyIEFQSVZlcnNpb25Ob3RBdmFpbGFibGVFcnJvciA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoX0Jhc2VFcnJvcikge1xuICAoMCwgX2luaGVyaXRzMi5kZWZhdWx0KShBUElWZXJzaW9uTm90QXZhaWxhYmxlRXJyb3IsIF9CYXNlRXJyb3IpO1xuXG4gIGZ1bmN0aW9uIEFQSVZlcnNpb25Ob3RBdmFpbGFibGVFcnJvcigpIHtcbiAgICB2YXIgX2dldFByb3RvdHlwZU9mMjtcblxuICAgIHZhciBfdGhpcztcblxuICAgIHZhciBtZXNzYWdlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiAnVGhpcyBBUEkgdmVyc2lvbiBpcyBub3QgYXZhaWxhYmxlIGZvciB5b3VyIGFwcC4nO1xuICAgICgwLCBfY2xhc3NDYWxsQ2hlY2syLmRlZmF1bHQpKHRoaXMsIEFQSVZlcnNpb25Ob3RBdmFpbGFibGVFcnJvcik7XG5cbiAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuID4gMSA/IF9sZW4gLSAxIDogMCksIF9rZXkgPSAxOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7XG4gICAgICBhcmdzW19rZXkgLSAxXSA9IGFyZ3VtZW50c1tfa2V5XTtcbiAgICB9XG5cbiAgICAvLyBQYXNzIHJlbWFpbmluZyBhcmd1bWVudHMgKGluY2x1ZGluZyB2ZW5kb3Igc3BlY2lmaWMgb25lcykgdG8gcGFyZW50IGNvbnN0cnVjdG9yXG4gICAgX3RoaXMgPSAoMCwgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yLmRlZmF1bHQpKHRoaXMsIChfZ2V0UHJvdG90eXBlT2YyID0gKDAsIF9nZXRQcm90b3R5cGVPZjMuZGVmYXVsdCkoQVBJVmVyc2lvbk5vdEF2YWlsYWJsZUVycm9yKSkuY2FsbC5hcHBseShfZ2V0UHJvdG90eXBlT2YyLCBbdGhpcywgbWVzc2FnZV0uY29uY2F0KGFyZ3MpKSk7IC8vIE1haW50YWlucyBwcm9wZXIgc3RhY2sgdHJhY2UgZm9yIHdoZXJlIG91ciBlcnJvciB3YXMgdGhyb3duIChvbmx5IGF2YWlsYWJsZSBvbiBWOClcblxuICAgIGlmIChFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSkge1xuICAgICAgRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UoKDAsIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQyLmRlZmF1bHQpKCgwLCBfYXNzZXJ0VGhpc0luaXRpYWxpemVkMi5kZWZhdWx0KShfdGhpcykpLCBBUElWZXJzaW9uTm90QXZhaWxhYmxlRXJyb3IpO1xuICAgIH0gLy8gQ3VzdG9tIGRlYnVnZ2luZyBpbmZvcm1hdGlvblxuXG5cbiAgICBfdGhpcy5uYW1lID0gJ0FQSVZlcnNpb25Ob3RBdmFpbGFibGVFcnJvcic7XG4gICAgcmV0dXJuIF90aGlzO1xuICB9XG5cbiAgcmV0dXJuIEFQSVZlcnNpb25Ob3RBdmFpbGFibGVFcnJvcjtcbn0oX2Jhc2UuZGVmYXVsdCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IEFQSVZlcnNpb25Ob3RBdmFpbGFibGVFcnJvcjsiLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG5cbnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVja1wiKSk7XG5cbnZhciBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm5cIikpO1xuXG52YXIgX2dldFByb3RvdHlwZU9mMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZ2V0UHJvdG90eXBlT2ZcIikpO1xuXG52YXIgX2luaGVyaXRzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW5oZXJpdHNcIikpO1xuXG52YXIgX2Fzc2VydFRoaXNJbml0aWFsaXplZDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2Fzc2VydFRoaXNJbml0aWFsaXplZFwiKSk7XG5cbnZhciBfYmFzZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vYmFzZVwiKSk7XG5cbnZhciBBUElWZXJzaW9uTm90SW1wbGVtZW50ZWRFcnJvciA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoX0Jhc2VFcnJvcikge1xuICAoMCwgX2luaGVyaXRzMi5kZWZhdWx0KShBUElWZXJzaW9uTm90SW1wbGVtZW50ZWRFcnJvciwgX0Jhc2VFcnJvcik7XG5cbiAgZnVuY3Rpb24gQVBJVmVyc2lvbk5vdEltcGxlbWVudGVkRXJyb3IoKSB7XG4gICAgdmFyIF9nZXRQcm90b3R5cGVPZjI7XG5cbiAgICB2YXIgX3RoaXM7XG5cbiAgICB2YXIgbWVzc2FnZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogJ1RoaXMgQVBJIHZlcnNpb24gaXMgbm90IGltcGxlbWVudGVkLic7XG4gICAgKDAsIF9jbGFzc0NhbGxDaGVjazIuZGVmYXVsdCkodGhpcywgQVBJVmVyc2lvbk5vdEltcGxlbWVudGVkRXJyb3IpO1xuXG4gICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbiA+IDEgPyBfbGVuIC0gMSA6IDApLCBfa2V5ID0gMTsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgICAgYXJnc1tfa2V5IC0gMV0gPSBhcmd1bWVudHNbX2tleV07XG4gICAgfVxuXG4gICAgLy8gUGFzcyByZW1haW5pbmcgYXJndW1lbnRzIChpbmNsdWRpbmcgdmVuZG9yIHNwZWNpZmljIG9uZXMpIHRvIHBhcmVudCBjb25zdHJ1Y3RvclxuICAgIF90aGlzID0gKDAsIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMi5kZWZhdWx0KSh0aGlzLCAoX2dldFByb3RvdHlwZU9mMiA9ICgwLCBfZ2V0UHJvdG90eXBlT2YzLmRlZmF1bHQpKEFQSVZlcnNpb25Ob3RJbXBsZW1lbnRlZEVycm9yKSkuY2FsbC5hcHBseShfZ2V0UHJvdG90eXBlT2YyLCBbdGhpcywgbWVzc2FnZV0uY29uY2F0KGFyZ3MpKSk7IC8vIE1haW50YWlucyBwcm9wZXIgc3RhY2sgdHJhY2UgZm9yIHdoZXJlIG91ciBlcnJvciB3YXMgdGhyb3duIChvbmx5IGF2YWlsYWJsZSBvbiBWOClcblxuICAgIGlmIChFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSkge1xuICAgICAgRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UoKDAsIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQyLmRlZmF1bHQpKCgwLCBfYXNzZXJ0VGhpc0luaXRpYWxpemVkMi5kZWZhdWx0KShfdGhpcykpLCBBUElWZXJzaW9uTm90SW1wbGVtZW50ZWRFcnJvcik7XG4gICAgfSAvLyBDdXN0b20gZGVidWdnaW5nIGluZm9ybWF0aW9uXG5cblxuICAgIF90aGlzLm5hbWUgPSAnQVBJVmVyc2lvbk5vdEltcGxlbWVudGVkRXJyb3InO1xuICAgIHJldHVybiBfdGhpcztcbiAgfVxuXG4gIHJldHVybiBBUElWZXJzaW9uTm90SW1wbGVtZW50ZWRFcnJvcjtcbn0oX2Jhc2UuZGVmYXVsdCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IEFQSVZlcnNpb25Ob3RJbXBsZW1lbnRlZEVycm9yOyIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcblxudmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrXCIpKTtcblxudmFyIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvcG9zc2libGVDb25zdHJ1Y3RvclJldHVyblwiKSk7XG5cbnZhciBfZ2V0UHJvdG90eXBlT2YzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9nZXRQcm90b3R5cGVPZlwiKSk7XG5cbnZhciBfaW5oZXJpdHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbmhlcml0c1wiKSk7XG5cbnZhciBfYXNzZXJ0VGhpc0luaXRpYWxpemVkMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXNzZXJ0VGhpc0luaXRpYWxpemVkXCIpKTtcblxudmFyIF9iYXNlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9iYXNlXCIpKTtcblxudmFyIEFwcFByb2JsZW1FcnJvciA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoX0Jhc2VFcnJvcikge1xuICAoMCwgX2luaGVyaXRzMi5kZWZhdWx0KShBcHBQcm9ibGVtRXJyb3IsIF9CYXNlRXJyb3IpO1xuXG4gIGZ1bmN0aW9uIEFwcFByb2JsZW1FcnJvcigpIHtcbiAgICB2YXIgX2dldFByb3RvdHlwZU9mMjtcblxuICAgIHZhciBfdGhpcztcblxuICAgIHZhciBtZXNzYWdlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiAnVGhlcmUgaXMgYSBwcm9ibGVtIHdpdGggdGhpcyBhcHAgYmFja2VuZCB0aGF0IHByZXZlbnRzIGV4ZWN1dGlvbiBvZiB0aGlzIG9wZXJhdGlvbi4gUGxlYXNlIGNvbnRhY3Qgc3VwcG9ydEBraW52ZXkuY29tIGZvciBhc3Npc3RhbmNlLic7XG4gICAgKDAsIF9jbGFzc0NhbGxDaGVjazIuZGVmYXVsdCkodGhpcywgQXBwUHJvYmxlbUVycm9yKTtcblxuICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4gPiAxID8gX2xlbiAtIDEgOiAwKSwgX2tleSA9IDE7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgIGFyZ3NbX2tleSAtIDFdID0gYXJndW1lbnRzW19rZXldO1xuICAgIH1cblxuICAgIC8vIFBhc3MgcmVtYWluaW5nIGFyZ3VtZW50cyAoaW5jbHVkaW5nIHZlbmRvciBzcGVjaWZpYyBvbmVzKSB0byBwYXJlbnQgY29uc3RydWN0b3JcbiAgICBfdGhpcyA9ICgwLCBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIuZGVmYXVsdCkodGhpcywgKF9nZXRQcm90b3R5cGVPZjIgPSAoMCwgX2dldFByb3RvdHlwZU9mMy5kZWZhdWx0KShBcHBQcm9ibGVtRXJyb3IpKS5jYWxsLmFwcGx5KF9nZXRQcm90b3R5cGVPZjIsIFt0aGlzLCBtZXNzYWdlXS5jb25jYXQoYXJncykpKTsgLy8gTWFpbnRhaW5zIHByb3BlciBzdGFjayB0cmFjZSBmb3Igd2hlcmUgb3VyIGVycm9yIHdhcyB0aHJvd24gKG9ubHkgYXZhaWxhYmxlIG9uIFY4KVxuXG4gICAgaWYgKEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKSB7XG4gICAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSgoMCwgX2Fzc2VydFRoaXNJbml0aWFsaXplZDIuZGVmYXVsdCkoKDAsIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQyLmRlZmF1bHQpKF90aGlzKSksIEFwcFByb2JsZW1FcnJvcik7XG4gICAgfSAvLyBDdXN0b20gZGVidWdnaW5nIGluZm9ybWF0aW9uXG5cblxuICAgIF90aGlzLm5hbWUgPSAnQXBwUHJvYmxlbUVycm9yJztcbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICByZXR1cm4gQXBwUHJvYmxlbUVycm9yO1xufShfYmFzZS5kZWZhdWx0KTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gQXBwUHJvYmxlbUVycm9yOyIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcblxudmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrXCIpKTtcblxudmFyIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvcG9zc2libGVDb25zdHJ1Y3RvclJldHVyblwiKSk7XG5cbnZhciBfZ2V0UHJvdG90eXBlT2YzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9nZXRQcm90b3R5cGVPZlwiKSk7XG5cbnZhciBfaW5oZXJpdHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbmhlcml0c1wiKSk7XG5cbnZhciBfYXNzZXJ0VGhpc0luaXRpYWxpemVkMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXNzZXJ0VGhpc0luaXRpYWxpemVkXCIpKTtcblxudmFyIF9iYXNlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9iYXNlXCIpKTtcblxudmFyIEJhZFJlcXVlc3RFcnJvciA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoX0Jhc2VFcnJvcikge1xuICAoMCwgX2luaGVyaXRzMi5kZWZhdWx0KShCYWRSZXF1ZXN0RXJyb3IsIF9CYXNlRXJyb3IpO1xuXG4gIGZ1bmN0aW9uIEJhZFJlcXVlc3RFcnJvcigpIHtcbiAgICB2YXIgX2dldFByb3RvdHlwZU9mMjtcblxuICAgIHZhciBfdGhpcztcblxuICAgIHZhciBtZXNzYWdlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiAnVW5hYmxlIHRvIHVuZGVyc3RhbmQgcmVxdWVzdC4nO1xuICAgICgwLCBfY2xhc3NDYWxsQ2hlY2syLmRlZmF1bHQpKHRoaXMsIEJhZFJlcXVlc3RFcnJvcik7XG5cbiAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuID4gMSA/IF9sZW4gLSAxIDogMCksIF9rZXkgPSAxOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7XG4gICAgICBhcmdzW19rZXkgLSAxXSA9IGFyZ3VtZW50c1tfa2V5XTtcbiAgICB9XG5cbiAgICAvLyBQYXNzIHJlbWFpbmluZyBhcmd1bWVudHMgKGluY2x1ZGluZyB2ZW5kb3Igc3BlY2lmaWMgb25lcykgdG8gcGFyZW50IGNvbnN0cnVjdG9yXG4gICAgX3RoaXMgPSAoMCwgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yLmRlZmF1bHQpKHRoaXMsIChfZ2V0UHJvdG90eXBlT2YyID0gKDAsIF9nZXRQcm90b3R5cGVPZjMuZGVmYXVsdCkoQmFkUmVxdWVzdEVycm9yKSkuY2FsbC5hcHBseShfZ2V0UHJvdG90eXBlT2YyLCBbdGhpcywgbWVzc2FnZV0uY29uY2F0KGFyZ3MpKSk7IC8vIE1haW50YWlucyBwcm9wZXIgc3RhY2sgdHJhY2UgZm9yIHdoZXJlIG91ciBlcnJvciB3YXMgdGhyb3duIChvbmx5IGF2YWlsYWJsZSBvbiBWOClcblxuICAgIGlmIChFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSkge1xuICAgICAgRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UoKDAsIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQyLmRlZmF1bHQpKCgwLCBfYXNzZXJ0VGhpc0luaXRpYWxpemVkMi5kZWZhdWx0KShfdGhpcykpLCBCYWRSZXF1ZXN0RXJyb3IpO1xuICAgIH0gLy8gQ3VzdG9tIGRlYnVnZ2luZyBpbmZvcm1hdGlvblxuXG5cbiAgICBfdGhpcy5uYW1lID0gJ0JhZFJlcXVlc3RFcnJvcic7XG4gICAgcmV0dXJuIF90aGlzO1xuICB9XG5cbiAgcmV0dXJuIEJhZFJlcXVlc3RFcnJvcjtcbn0oX2Jhc2UuZGVmYXVsdCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IEJhZFJlcXVlc3RFcnJvcjsiLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG5cbnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVja1wiKSk7XG5cbnZhciBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm5cIikpO1xuXG52YXIgX2dldFByb3RvdHlwZU9mMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZ2V0UHJvdG90eXBlT2ZcIikpO1xuXG52YXIgX2luaGVyaXRzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW5oZXJpdHNcIikpO1xuXG52YXIgX2Fzc2VydFRoaXNJbml0aWFsaXplZDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2Fzc2VydFRoaXNJbml0aWFsaXplZFwiKSk7XG5cbnZhciBfd3JhcE5hdGl2ZVN1cGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvd3JhcE5hdGl2ZVN1cGVyXCIpKTtcblxudmFyIEJhc2VFcnJvciA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoX0Vycm9yKSB7XG4gICgwLCBfaW5oZXJpdHMyLmRlZmF1bHQpKEJhc2VFcnJvciwgX0Vycm9yKTtcblxuICBmdW5jdGlvbiBCYXNlRXJyb3IoKSB7XG4gICAgdmFyIF9nZXRQcm90b3R5cGVPZjI7XG5cbiAgICB2YXIgX3RoaXM7XG5cbiAgICB2YXIgbWVzc2FnZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogJ0FuIGVycm9yIG9jY3VycmVkLic7XG4gICAgdmFyIGRlYnVnID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB1bmRlZmluZWQ7XG4gICAgdmFyIGNvZGUgPSBhcmd1bWVudHMubGVuZ3RoID4gMiA/IGFyZ3VtZW50c1syXSA6IHVuZGVmaW5lZDtcbiAgICB2YXIga2ludmV5UmVxdWVzdElkID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgPyBhcmd1bWVudHNbM10gOiB1bmRlZmluZWQ7XG4gICAgKDAsIF9jbGFzc0NhbGxDaGVjazIuZGVmYXVsdCkodGhpcywgQmFzZUVycm9yKTtcblxuICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4gPiA0ID8gX2xlbiAtIDQgOiAwKSwgX2tleSA9IDQ7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgIGFyZ3NbX2tleSAtIDRdID0gYXJndW1lbnRzW19rZXldO1xuICAgIH1cblxuICAgIC8vIFBhc3MgcmVtYWluaW5nIGFyZ3VtZW50cyAoaW5jbHVkaW5nIHZlbmRvciBzcGVjaWZpYyBvbmVzKSB0byBwYXJlbnQgY29uc3RydWN0b3JcbiAgICBfdGhpcyA9ICgwLCBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIuZGVmYXVsdCkodGhpcywgKF9nZXRQcm90b3R5cGVPZjIgPSAoMCwgX2dldFByb3RvdHlwZU9mMy5kZWZhdWx0KShCYXNlRXJyb3IpKS5jYWxsLmFwcGx5KF9nZXRQcm90b3R5cGVPZjIsIFt0aGlzXS5jb25jYXQoYXJncykpKTsgLy8gTWFpbnRhaW5zIHByb3BlciBzdGFjayB0cmFjZSBmb3Igd2hlcmUgb3VyIGVycm9yIHdhcyB0aHJvd24gKG9ubHkgYXZhaWxhYmxlIG9uIFY4KVxuXG4gICAgaWYgKEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKSB7XG4gICAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSgoMCwgX2Fzc2VydFRoaXNJbml0aWFsaXplZDIuZGVmYXVsdCkoKDAsIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQyLmRlZmF1bHQpKF90aGlzKSksIEJhc2VFcnJvcik7XG4gICAgfSAvLyBDdXN0b20gZGVidWdnaW5nIGluZm9ybWF0aW9uXG5cblxuICAgIF90aGlzLm5hbWUgPSAnQmFzZUVycm9yJztcbiAgICBfdGhpcy5tZXNzYWdlID0gbWVzc2FnZTtcbiAgICBfdGhpcy5kZWJ1ZyA9IGRlYnVnO1xuICAgIF90aGlzLmNvZGUgPSBjb2RlO1xuICAgIF90aGlzLmtpbnZleVJlcXVlc3RJZCA9IGtpbnZleVJlcXVlc3RJZDtcbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICByZXR1cm4gQmFzZUVycm9yO1xufSgoMCwgX3dyYXBOYXRpdmVTdXBlcjIuZGVmYXVsdCkoRXJyb3IpKTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gQmFzZUVycm9yOyIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcblxudmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrXCIpKTtcblxudmFyIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvcG9zc2libGVDb25zdHJ1Y3RvclJldHVyblwiKSk7XG5cbnZhciBfZ2V0UHJvdG90eXBlT2YzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9nZXRQcm90b3R5cGVPZlwiKSk7XG5cbnZhciBfaW5oZXJpdHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbmhlcml0c1wiKSk7XG5cbnZhciBfYXNzZXJ0VGhpc0luaXRpYWxpemVkMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXNzZXJ0VGhpc0luaXRpYWxpemVkXCIpKTtcblxudmFyIF9iYXNlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9iYXNlXCIpKTtcblxudmFyIEJMRXJyb3IgPVxuLyojX19QVVJFX18qL1xuZnVuY3Rpb24gKF9CYXNlRXJyb3IpIHtcbiAgKDAsIF9pbmhlcml0czIuZGVmYXVsdCkoQkxFcnJvciwgX0Jhc2VFcnJvcik7XG5cbiAgZnVuY3Rpb24gQkxFcnJvcigpIHtcbiAgICB2YXIgX2dldFByb3RvdHlwZU9mMjtcblxuICAgIHZhciBfdGhpcztcblxuICAgIHZhciBtZXNzYWdlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiAnVGhlIEJ1c2luZXNzIExvZ2ljIHNjcmlwdCBkaWQgbm90IGNvbXBsZXRlLic7XG4gICAgKDAsIF9jbGFzc0NhbGxDaGVjazIuZGVmYXVsdCkodGhpcywgQkxFcnJvcik7XG5cbiAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuID4gMSA/IF9sZW4gLSAxIDogMCksIF9rZXkgPSAxOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7XG4gICAgICBhcmdzW19rZXkgLSAxXSA9IGFyZ3VtZW50c1tfa2V5XTtcbiAgICB9XG5cbiAgICAvLyBQYXNzIHJlbWFpbmluZyBhcmd1bWVudHMgKGluY2x1ZGluZyB2ZW5kb3Igc3BlY2lmaWMgb25lcykgdG8gcGFyZW50IGNvbnN0cnVjdG9yXG4gICAgX3RoaXMgPSAoMCwgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yLmRlZmF1bHQpKHRoaXMsIChfZ2V0UHJvdG90eXBlT2YyID0gKDAsIF9nZXRQcm90b3R5cGVPZjMuZGVmYXVsdCkoQkxFcnJvcikpLmNhbGwuYXBwbHkoX2dldFByb3RvdHlwZU9mMiwgW3RoaXMsIG1lc3NhZ2VdLmNvbmNhdChhcmdzKSkpOyAvLyBNYWludGFpbnMgcHJvcGVyIHN0YWNrIHRyYWNlIGZvciB3aGVyZSBvdXIgZXJyb3Igd2FzIHRocm93biAob25seSBhdmFpbGFibGUgb24gVjgpXG5cbiAgICBpZiAoRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UpIHtcbiAgICAgIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKCgwLCBfYXNzZXJ0VGhpc0luaXRpYWxpemVkMi5kZWZhdWx0KSgoMCwgX2Fzc2VydFRoaXNJbml0aWFsaXplZDIuZGVmYXVsdCkoX3RoaXMpKSwgQkxFcnJvcik7XG4gICAgfSAvLyBDdXN0b20gZGVidWdnaW5nIGluZm9ybWF0aW9uXG5cblxuICAgIF90aGlzLm5hbWUgPSAnQkxFcnJvcic7XG4gICAgcmV0dXJuIF90aGlzO1xuICB9XG5cbiAgcmV0dXJuIEJMRXJyb3I7XG59KF9iYXNlLmRlZmF1bHQpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBCTEVycm9yOyIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcblxudmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrXCIpKTtcblxudmFyIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvcG9zc2libGVDb25zdHJ1Y3RvclJldHVyblwiKSk7XG5cbnZhciBfZ2V0UHJvdG90eXBlT2YzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9nZXRQcm90b3R5cGVPZlwiKSk7XG5cbnZhciBfaW5oZXJpdHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbmhlcml0c1wiKSk7XG5cbnZhciBfYXNzZXJ0VGhpc0luaXRpYWxpemVkMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXNzZXJ0VGhpc0luaXRpYWxpemVkXCIpKTtcblxudmFyIF9iYXNlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9iYXNlXCIpKTtcblxudmFyIENPUlNEaXNhYmxlZEVycm9yID1cbi8qI19fUFVSRV9fKi9cbmZ1bmN0aW9uIChfQmFzZUVycm9yKSB7XG4gICgwLCBfaW5oZXJpdHMyLmRlZmF1bHQpKENPUlNEaXNhYmxlZEVycm9yLCBfQmFzZUVycm9yKTtcblxuICBmdW5jdGlvbiBDT1JTRGlzYWJsZWRFcnJvcigpIHtcbiAgICB2YXIgX2dldFByb3RvdHlwZU9mMjtcblxuICAgIHZhciBfdGhpcztcblxuICAgIHZhciBtZXNzYWdlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiAnQ3Jvc3MgT3JpZ2luIFN1cHBvcnQgaXMgZGlzYWJsZWQgZm9yIHRoaXMgYXBwbGljYXRpb24uJztcbiAgICAoMCwgX2NsYXNzQ2FsbENoZWNrMi5kZWZhdWx0KSh0aGlzLCBDT1JTRGlzYWJsZWRFcnJvcik7XG5cbiAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuID4gMSA/IF9sZW4gLSAxIDogMCksIF9rZXkgPSAxOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7XG4gICAgICBhcmdzW19rZXkgLSAxXSA9IGFyZ3VtZW50c1tfa2V5XTtcbiAgICB9XG5cbiAgICAvLyBQYXNzIHJlbWFpbmluZyBhcmd1bWVudHMgKGluY2x1ZGluZyB2ZW5kb3Igc3BlY2lmaWMgb25lcykgdG8gcGFyZW50IGNvbnN0cnVjdG9yXG4gICAgX3RoaXMgPSAoMCwgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yLmRlZmF1bHQpKHRoaXMsIChfZ2V0UHJvdG90eXBlT2YyID0gKDAsIF9nZXRQcm90b3R5cGVPZjMuZGVmYXVsdCkoQ09SU0Rpc2FibGVkRXJyb3IpKS5jYWxsLmFwcGx5KF9nZXRQcm90b3R5cGVPZjIsIFt0aGlzLCBtZXNzYWdlXS5jb25jYXQoYXJncykpKTsgLy8gTWFpbnRhaW5zIHByb3BlciBzdGFjayB0cmFjZSBmb3Igd2hlcmUgb3VyIGVycm9yIHdhcyB0aHJvd24gKG9ubHkgYXZhaWxhYmxlIG9uIFY4KVxuXG4gICAgaWYgKEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKSB7XG4gICAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSgoMCwgX2Fzc2VydFRoaXNJbml0aWFsaXplZDIuZGVmYXVsdCkoKDAsIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQyLmRlZmF1bHQpKF90aGlzKSksIENPUlNEaXNhYmxlZEVycm9yKTtcbiAgICB9IC8vIEN1c3RvbSBkZWJ1Z2dpbmcgaW5mb3JtYXRpb25cblxuXG4gICAgX3RoaXMubmFtZSA9ICdDT1JTRGlzYWJsZWRFcnJvcic7XG4gICAgcmV0dXJuIF90aGlzO1xuICB9XG5cbiAgcmV0dXJuIENPUlNEaXNhYmxlZEVycm9yO1xufShfYmFzZS5kZWZhdWx0KTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gQ09SU0Rpc2FibGVkRXJyb3I7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gcmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW50ZXJvcFJlcXVpcmVEZWZhdWx0XCIpO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xuXG52YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2tcIikpO1xuXG52YXIgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuXCIpKTtcblxudmFyIF9nZXRQcm90b3R5cGVPZjMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2dldFByb3RvdHlwZU9mXCIpKTtcblxudmFyIF9pbmhlcml0czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2luaGVyaXRzXCIpKTtcblxudmFyIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9hc3NlcnRUaGlzSW5pdGlhbGl6ZWRcIikpO1xuXG52YXIgX2Jhc2UgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL2Jhc2VcIikpO1xuXG52YXIgRHVwbGljYXRlRW5kVXNlcnNFcnJvciA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoX0Jhc2VFcnJvcikge1xuICAoMCwgX2luaGVyaXRzMi5kZWZhdWx0KShEdXBsaWNhdGVFbmRVc2Vyc0Vycm9yLCBfQmFzZUVycm9yKTtcblxuICBmdW5jdGlvbiBEdXBsaWNhdGVFbmRVc2Vyc0Vycm9yKCkge1xuICAgIHZhciBfZ2V0UHJvdG90eXBlT2YyO1xuXG4gICAgdmFyIF90aGlzO1xuXG4gICAgdmFyIG1lc3NhZ2UgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6ICdNb3JlIHRoYW4gb25lIHVzZXIgcmVnaXN0ZXJlZCB3aXRoIHRoaXMgdXNlcm5hbWUgZm9yIHRoaXMgYXBwbGljYXRpb24uJztcbiAgICAoMCwgX2NsYXNzQ2FsbENoZWNrMi5kZWZhdWx0KSh0aGlzLCBEdXBsaWNhdGVFbmRVc2Vyc0Vycm9yKTtcblxuICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4gPiAxID8gX2xlbiAtIDEgOiAwKSwgX2tleSA9IDE7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgIGFyZ3NbX2tleSAtIDFdID0gYXJndW1lbnRzW19rZXldO1xuICAgIH1cblxuICAgIC8vIFBhc3MgcmVtYWluaW5nIGFyZ3VtZW50cyAoaW5jbHVkaW5nIHZlbmRvciBzcGVjaWZpYyBvbmVzKSB0byBwYXJlbnQgY29uc3RydWN0b3JcbiAgICBfdGhpcyA9ICgwLCBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIuZGVmYXVsdCkodGhpcywgKF9nZXRQcm90b3R5cGVPZjIgPSAoMCwgX2dldFByb3RvdHlwZU9mMy5kZWZhdWx0KShEdXBsaWNhdGVFbmRVc2Vyc0Vycm9yKSkuY2FsbC5hcHBseShfZ2V0UHJvdG90eXBlT2YyLCBbdGhpcywgbWVzc2FnZV0uY29uY2F0KGFyZ3MpKSk7IC8vIE1haW50YWlucyBwcm9wZXIgc3RhY2sgdHJhY2UgZm9yIHdoZXJlIG91ciBlcnJvciB3YXMgdGhyb3duIChvbmx5IGF2YWlsYWJsZSBvbiBWOClcblxuICAgIGlmIChFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSkge1xuICAgICAgRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UoKDAsIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQyLmRlZmF1bHQpKCgwLCBfYXNzZXJ0VGhpc0luaXRpYWxpemVkMi5kZWZhdWx0KShfdGhpcykpLCBEdXBsaWNhdGVFbmRVc2Vyc0Vycm9yKTtcbiAgICB9IC8vIEN1c3RvbSBkZWJ1Z2dpbmcgaW5mb3JtYXRpb25cblxuXG4gICAgX3RoaXMubmFtZSA9ICdEdXBsaWNhdGVFbmRVc2Vyc0Vycm9yJztcbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICByZXR1cm4gRHVwbGljYXRlRW5kVXNlcnNFcnJvcjtcbn0oX2Jhc2UuZGVmYXVsdCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IER1cGxpY2F0ZUVuZFVzZXJzRXJyb3I7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gcmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW50ZXJvcFJlcXVpcmVEZWZhdWx0XCIpO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xuXG52YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2tcIikpO1xuXG52YXIgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuXCIpKTtcblxudmFyIF9nZXRQcm90b3R5cGVPZjMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2dldFByb3RvdHlwZU9mXCIpKTtcblxudmFyIF9pbmhlcml0czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2luaGVyaXRzXCIpKTtcblxudmFyIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9hc3NlcnRUaGlzSW5pdGlhbGl6ZWRcIikpO1xuXG52YXIgX2Jhc2UgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL2Jhc2VcIikpO1xuXG52YXIgRmVhdHVyZVVuYXZhaWxhYmxlRXJyb3IgPVxuLyojX19QVVJFX18qL1xuZnVuY3Rpb24gKF9CYXNlRXJyb3IpIHtcbiAgKDAsIF9pbmhlcml0czIuZGVmYXVsdCkoRmVhdHVyZVVuYXZhaWxhYmxlRXJyb3IsIF9CYXNlRXJyb3IpO1xuXG4gIGZ1bmN0aW9uIEZlYXR1cmVVbmF2YWlsYWJsZUVycm9yKCkge1xuICAgIHZhciBfZ2V0UHJvdG90eXBlT2YyO1xuXG4gICAgdmFyIF90aGlzO1xuXG4gICAgdmFyIG1lc3NhZ2UgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6ICdSZXF1ZXN0ZWQgZnVuY3Rpb25hbGl0eSBpcyB1bmF2YWlsYWJsZSBpbiB0aGlzIEFQSSB2ZXJzaW9uLic7XG4gICAgKDAsIF9jbGFzc0NhbGxDaGVjazIuZGVmYXVsdCkodGhpcywgRmVhdHVyZVVuYXZhaWxhYmxlRXJyb3IpO1xuXG4gICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbiA+IDEgPyBfbGVuIC0gMSA6IDApLCBfa2V5ID0gMTsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgICAgYXJnc1tfa2V5IC0gMV0gPSBhcmd1bWVudHNbX2tleV07XG4gICAgfVxuXG4gICAgLy8gUGFzcyByZW1haW5pbmcgYXJndW1lbnRzIChpbmNsdWRpbmcgdmVuZG9yIHNwZWNpZmljIG9uZXMpIHRvIHBhcmVudCBjb25zdHJ1Y3RvclxuICAgIF90aGlzID0gKDAsIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMi5kZWZhdWx0KSh0aGlzLCAoX2dldFByb3RvdHlwZU9mMiA9ICgwLCBfZ2V0UHJvdG90eXBlT2YzLmRlZmF1bHQpKEZlYXR1cmVVbmF2YWlsYWJsZUVycm9yKSkuY2FsbC5hcHBseShfZ2V0UHJvdG90eXBlT2YyLCBbdGhpcywgbWVzc2FnZV0uY29uY2F0KGFyZ3MpKSk7IC8vIE1haW50YWlucyBwcm9wZXIgc3RhY2sgdHJhY2UgZm9yIHdoZXJlIG91ciBlcnJvciB3YXMgdGhyb3duIChvbmx5IGF2YWlsYWJsZSBvbiBWOClcblxuICAgIGlmIChFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSkge1xuICAgICAgRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UoKDAsIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQyLmRlZmF1bHQpKCgwLCBfYXNzZXJ0VGhpc0luaXRpYWxpemVkMi5kZWZhdWx0KShfdGhpcykpLCBGZWF0dXJlVW5hdmFpbGFibGVFcnJvcik7XG4gICAgfSAvLyBDdXN0b20gZGVidWdnaW5nIGluZm9ybWF0aW9uXG5cblxuICAgIF90aGlzLm5hbWUgPSAnRmVhdHVyZVVuYXZhaWxhYmxlRXJyb3InO1xuICAgIHJldHVybiBfdGhpcztcbiAgfVxuXG4gIHJldHVybiBGZWF0dXJlVW5hdmFpbGFibGVFcnJvcjtcbn0oX2Jhc2UuZGVmYXVsdCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IEZlYXR1cmVVbmF2YWlsYWJsZUVycm9yOyIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcblxudmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrXCIpKTtcblxudmFyIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvcG9zc2libGVDb25zdHJ1Y3RvclJldHVyblwiKSk7XG5cbnZhciBfZ2V0UHJvdG90eXBlT2YzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9nZXRQcm90b3R5cGVPZlwiKSk7XG5cbnZhciBfaW5oZXJpdHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbmhlcml0c1wiKSk7XG5cbnZhciBfYXNzZXJ0VGhpc0luaXRpYWxpemVkMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXNzZXJ0VGhpc0luaXRpYWxpemVkXCIpKTtcblxudmFyIF9iYXNlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9iYXNlXCIpKTtcblxudmFyIEluY29tcGxldGVSZXF1ZXN0Qm9keUVycm9yID1cbi8qI19fUFVSRV9fKi9cbmZ1bmN0aW9uIChfQmFzZUVycm9yKSB7XG4gICgwLCBfaW5oZXJpdHMyLmRlZmF1bHQpKEluY29tcGxldGVSZXF1ZXN0Qm9keUVycm9yLCBfQmFzZUVycm9yKTtcblxuICBmdW5jdGlvbiBJbmNvbXBsZXRlUmVxdWVzdEJvZHlFcnJvcigpIHtcbiAgICB2YXIgX2dldFByb3RvdHlwZU9mMjtcblxuICAgIHZhciBfdGhpcztcblxuICAgIHZhciBtZXNzYWdlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiAnVGhlIHJlcXVlc3QgYm9keSBpcyBlaXRoZXIgbWlzc2luZyBvciBpbmNvbXBsZXRlLic7XG4gICAgKDAsIF9jbGFzc0NhbGxDaGVjazIuZGVmYXVsdCkodGhpcywgSW5jb21wbGV0ZVJlcXVlc3RCb2R5RXJyb3IpO1xuXG4gICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbiA+IDEgPyBfbGVuIC0gMSA6IDApLCBfa2V5ID0gMTsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgICAgYXJnc1tfa2V5IC0gMV0gPSBhcmd1bWVudHNbX2tleV07XG4gICAgfVxuXG4gICAgLy8gUGFzcyByZW1haW5pbmcgYXJndW1lbnRzIChpbmNsdWRpbmcgdmVuZG9yIHNwZWNpZmljIG9uZXMpIHRvIHBhcmVudCBjb25zdHJ1Y3RvclxuICAgIF90aGlzID0gKDAsIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMi5kZWZhdWx0KSh0aGlzLCAoX2dldFByb3RvdHlwZU9mMiA9ICgwLCBfZ2V0UHJvdG90eXBlT2YzLmRlZmF1bHQpKEluY29tcGxldGVSZXF1ZXN0Qm9keUVycm9yKSkuY2FsbC5hcHBseShfZ2V0UHJvdG90eXBlT2YyLCBbdGhpcywgbWVzc2FnZV0uY29uY2F0KGFyZ3MpKSk7IC8vIE1haW50YWlucyBwcm9wZXIgc3RhY2sgdHJhY2UgZm9yIHdoZXJlIG91ciBlcnJvciB3YXMgdGhyb3duIChvbmx5IGF2YWlsYWJsZSBvbiBWOClcblxuICAgIGlmIChFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSkge1xuICAgICAgRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UoKDAsIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQyLmRlZmF1bHQpKCgwLCBfYXNzZXJ0VGhpc0luaXRpYWxpemVkMi5kZWZhdWx0KShfdGhpcykpLCBJbmNvbXBsZXRlUmVxdWVzdEJvZHlFcnJvcik7XG4gICAgfSAvLyBDdXN0b20gZGVidWdnaW5nIGluZm9ybWF0aW9uXG5cblxuICAgIF90aGlzLm5hbWUgPSAnSW5jb21wbGV0ZVJlcXVlc3RCb2R5RXJyb3InO1xuICAgIHJldHVybiBfdGhpcztcbiAgfVxuXG4gIHJldHVybiBJbmNvbXBsZXRlUmVxdWVzdEJvZHlFcnJvcjtcbn0oX2Jhc2UuZGVmYXVsdCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IEluY29tcGxldGVSZXF1ZXN0Qm9keUVycm9yOyIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcblxudmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrXCIpKTtcblxudmFyIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvcG9zc2libGVDb25zdHJ1Y3RvclJldHVyblwiKSk7XG5cbnZhciBfZ2V0UHJvdG90eXBlT2YzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9nZXRQcm90b3R5cGVPZlwiKSk7XG5cbnZhciBfaW5oZXJpdHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbmhlcml0c1wiKSk7XG5cbnZhciBfYXNzZXJ0VGhpc0luaXRpYWxpemVkMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXNzZXJ0VGhpc0luaXRpYWxpemVkXCIpKTtcblxudmFyIF9iYXNlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9iYXNlXCIpKTtcblxudmFyIEluZGlyZWN0Q29sbGVjdGlvbkFjY2Vzc0Rpc2FsbG93ZWRFcnJvciA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoX0Jhc2VFcnJvcikge1xuICAoMCwgX2luaGVyaXRzMi5kZWZhdWx0KShJbmRpcmVjdENvbGxlY3Rpb25BY2Nlc3NEaXNhbGxvd2VkRXJyb3IsIF9CYXNlRXJyb3IpO1xuXG4gIGZ1bmN0aW9uIEluZGlyZWN0Q29sbGVjdGlvbkFjY2Vzc0Rpc2FsbG93ZWRFcnJvcigpIHtcbiAgICB2YXIgX2dldFByb3RvdHlwZU9mMjtcblxuICAgIHZhciBfdGhpcztcblxuICAgIHZhciBtZXNzYWdlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiAnUGxlYXNlIHVzZSB0aGUgYXBwcm9wcmlhdGUgQVBJIHRvIGFjY2VzcyB0aGlzIGNvbGxlY3Rpb24gZm9yIHRoaXMgYXBwIGJhY2tlbmQuJztcbiAgICAoMCwgX2NsYXNzQ2FsbENoZWNrMi5kZWZhdWx0KSh0aGlzLCBJbmRpcmVjdENvbGxlY3Rpb25BY2Nlc3NEaXNhbGxvd2VkRXJyb3IpO1xuXG4gICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbiA+IDEgPyBfbGVuIC0gMSA6IDApLCBfa2V5ID0gMTsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgICAgYXJnc1tfa2V5IC0gMV0gPSBhcmd1bWVudHNbX2tleV07XG4gICAgfVxuXG4gICAgLy8gUGFzcyByZW1haW5pbmcgYXJndW1lbnRzIChpbmNsdWRpbmcgdmVuZG9yIHNwZWNpZmljIG9uZXMpIHRvIHBhcmVudCBjb25zdHJ1Y3RvclxuICAgIF90aGlzID0gKDAsIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMi5kZWZhdWx0KSh0aGlzLCAoX2dldFByb3RvdHlwZU9mMiA9ICgwLCBfZ2V0UHJvdG90eXBlT2YzLmRlZmF1bHQpKEluZGlyZWN0Q29sbGVjdGlvbkFjY2Vzc0Rpc2FsbG93ZWRFcnJvcikpLmNhbGwuYXBwbHkoX2dldFByb3RvdHlwZU9mMiwgW3RoaXMsIG1lc3NhZ2VdLmNvbmNhdChhcmdzKSkpOyAvLyBNYWludGFpbnMgcHJvcGVyIHN0YWNrIHRyYWNlIGZvciB3aGVyZSBvdXIgZXJyb3Igd2FzIHRocm93biAob25seSBhdmFpbGFibGUgb24gVjgpXG5cbiAgICBpZiAoRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UpIHtcbiAgICAgIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKCgwLCBfYXNzZXJ0VGhpc0luaXRpYWxpemVkMi5kZWZhdWx0KSgoMCwgX2Fzc2VydFRoaXNJbml0aWFsaXplZDIuZGVmYXVsdCkoX3RoaXMpKSwgSW5kaXJlY3RDb2xsZWN0aW9uQWNjZXNzRGlzYWxsb3dlZEVycm9yKTtcbiAgICB9IC8vIEN1c3RvbSBkZWJ1Z2dpbmcgaW5mb3JtYXRpb25cblxuXG4gICAgX3RoaXMubmFtZSA9ICdJbmRpcmVjdENvbGxlY3Rpb25BY2Nlc3NEaXNhbGxvd2VkRXJyb3InO1xuICAgIHJldHVybiBfdGhpcztcbiAgfVxuXG4gIHJldHVybiBJbmRpcmVjdENvbGxlY3Rpb25BY2Nlc3NEaXNhbGxvd2VkRXJyb3I7XG59KF9iYXNlLmRlZmF1bHQpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBJbmRpcmVjdENvbGxlY3Rpb25BY2Nlc3NEaXNhbGxvd2VkRXJyb3I7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gcmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW50ZXJvcFJlcXVpcmVEZWZhdWx0XCIpO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xuXG52YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2tcIikpO1xuXG52YXIgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuXCIpKTtcblxudmFyIF9nZXRQcm90b3R5cGVPZjMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2dldFByb3RvdHlwZU9mXCIpKTtcblxudmFyIF9pbmhlcml0czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2luaGVyaXRzXCIpKTtcblxudmFyIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9hc3NlcnRUaGlzSW5pdGlhbGl6ZWRcIikpO1xuXG52YXIgX2Jhc2UgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL2Jhc2VcIikpO1xuXG52YXIgSW5zdWZmaWNpZW50Q3JlZGVudGlhbHNFcnJvciA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoX0Jhc2VFcnJvcikge1xuICAoMCwgX2luaGVyaXRzMi5kZWZhdWx0KShJbnN1ZmZpY2llbnRDcmVkZW50aWFsc0Vycm9yLCBfQmFzZUVycm9yKTtcblxuICBmdW5jdGlvbiBJbnN1ZmZpY2llbnRDcmVkZW50aWFsc0Vycm9yKCkge1xuICAgIHZhciBfZ2V0UHJvdG90eXBlT2YyO1xuXG4gICAgdmFyIF90aGlzO1xuXG4gICAgdmFyIG1lc3NhZ2UgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6ICdUaGUgY3JlZGVudGlhbHMgdXNlZCB0byBhdXRoZW50aWNhdGUgdGhpcyByZXF1ZXN0IGFyZSBub3QgYXV0aG9yaXplZCB0byBydW4gdGhpcyBvcGVyYXRpb24uIFBsZWFzZSByZXRyeSB5b3VyIHJlcXVlc3Qgd2l0aCBhcHByb3ByaWF0ZSBjcmVkZW50aWFscy4nO1xuICAgICgwLCBfY2xhc3NDYWxsQ2hlY2syLmRlZmF1bHQpKHRoaXMsIEluc3VmZmljaWVudENyZWRlbnRpYWxzRXJyb3IpO1xuXG4gICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbiA+IDEgPyBfbGVuIC0gMSA6IDApLCBfa2V5ID0gMTsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgICAgYXJnc1tfa2V5IC0gMV0gPSBhcmd1bWVudHNbX2tleV07XG4gICAgfVxuXG4gICAgLy8gUGFzcyByZW1haW5pbmcgYXJndW1lbnRzIChpbmNsdWRpbmcgdmVuZG9yIHNwZWNpZmljIG9uZXMpIHRvIHBhcmVudCBjb25zdHJ1Y3RvclxuICAgIF90aGlzID0gKDAsIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMi5kZWZhdWx0KSh0aGlzLCAoX2dldFByb3RvdHlwZU9mMiA9ICgwLCBfZ2V0UHJvdG90eXBlT2YzLmRlZmF1bHQpKEluc3VmZmljaWVudENyZWRlbnRpYWxzRXJyb3IpKS5jYWxsLmFwcGx5KF9nZXRQcm90b3R5cGVPZjIsIFt0aGlzLCBtZXNzYWdlXS5jb25jYXQoYXJncykpKTsgLy8gTWFpbnRhaW5zIHByb3BlciBzdGFjayB0cmFjZSBmb3Igd2hlcmUgb3VyIGVycm9yIHdhcyB0aHJvd24gKG9ubHkgYXZhaWxhYmxlIG9uIFY4KVxuXG4gICAgaWYgKEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKSB7XG4gICAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSgoMCwgX2Fzc2VydFRoaXNJbml0aWFsaXplZDIuZGVmYXVsdCkoKDAsIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQyLmRlZmF1bHQpKF90aGlzKSksIEluc3VmZmljaWVudENyZWRlbnRpYWxzRXJyb3IpO1xuICAgIH0gLy8gQ3VzdG9tIGRlYnVnZ2luZyBpbmZvcm1hdGlvblxuXG5cbiAgICBfdGhpcy5uYW1lID0gJ0luc3VmZmljaWVudENyZWRlbnRpYWxzRXJyb3InO1xuICAgIHJldHVybiBfdGhpcztcbiAgfVxuXG4gIHJldHVybiBJbnN1ZmZpY2llbnRDcmVkZW50aWFsc0Vycm9yO1xufShfYmFzZS5kZWZhdWx0KTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gSW5zdWZmaWNpZW50Q3JlZGVudGlhbHNFcnJvcjsiLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG5cbnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVja1wiKSk7XG5cbnZhciBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm5cIikpO1xuXG52YXIgX2dldFByb3RvdHlwZU9mMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZ2V0UHJvdG90eXBlT2ZcIikpO1xuXG52YXIgX2luaGVyaXRzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW5oZXJpdHNcIikpO1xuXG52YXIgX2Fzc2VydFRoaXNJbml0aWFsaXplZDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2Fzc2VydFRoaXNJbml0aWFsaXplZFwiKSk7XG5cbnZhciBfYmFzZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vYmFzZVwiKSk7XG5cbnZhciBJbnZhbGlkQ3JlZGVudGlhbHNFcnJvciA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoX0Jhc2VFcnJvcikge1xuICAoMCwgX2luaGVyaXRzMi5kZWZhdWx0KShJbnZhbGlkQ3JlZGVudGlhbHNFcnJvciwgX0Jhc2VFcnJvcik7XG5cbiAgZnVuY3Rpb24gSW52YWxpZENyZWRlbnRpYWxzRXJyb3IoKSB7XG4gICAgdmFyIF9nZXRQcm90b3R5cGVPZjI7XG5cbiAgICB2YXIgX3RoaXM7XG5cbiAgICB2YXIgbWVzc2FnZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogJ0ludmFsaWQgY3JlZGVudGlhbHMuIFBsZWFzZSByZXRyeSB5b3VyIHJlcXVlc3Qgd2l0aCBjb3JyZWN0IGNyZWRlbnRpYWxzLic7XG4gICAgKDAsIF9jbGFzc0NhbGxDaGVjazIuZGVmYXVsdCkodGhpcywgSW52YWxpZENyZWRlbnRpYWxzRXJyb3IpO1xuXG4gICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbiA+IDEgPyBfbGVuIC0gMSA6IDApLCBfa2V5ID0gMTsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgICAgYXJnc1tfa2V5IC0gMV0gPSBhcmd1bWVudHNbX2tleV07XG4gICAgfVxuXG4gICAgLy8gUGFzcyByZW1haW5pbmcgYXJndW1lbnRzIChpbmNsdWRpbmcgdmVuZG9yIHNwZWNpZmljIG9uZXMpIHRvIHBhcmVudCBjb25zdHJ1Y3RvclxuICAgIF90aGlzID0gKDAsIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMi5kZWZhdWx0KSh0aGlzLCAoX2dldFByb3RvdHlwZU9mMiA9ICgwLCBfZ2V0UHJvdG90eXBlT2YzLmRlZmF1bHQpKEludmFsaWRDcmVkZW50aWFsc0Vycm9yKSkuY2FsbC5hcHBseShfZ2V0UHJvdG90eXBlT2YyLCBbdGhpcywgbWVzc2FnZV0uY29uY2F0KGFyZ3MpKSk7IC8vIE1haW50YWlucyBwcm9wZXIgc3RhY2sgdHJhY2UgZm9yIHdoZXJlIG91ciBlcnJvciB3YXMgdGhyb3duIChvbmx5IGF2YWlsYWJsZSBvbiBWOClcblxuICAgIGlmIChFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSkge1xuICAgICAgRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UoKDAsIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQyLmRlZmF1bHQpKCgwLCBfYXNzZXJ0VGhpc0luaXRpYWxpemVkMi5kZWZhdWx0KShfdGhpcykpLCBJbnZhbGlkQ3JlZGVudGlhbHNFcnJvcik7XG4gICAgfSAvLyBDdXN0b20gZGVidWdnaW5nIGluZm9ybWF0aW9uXG5cblxuICAgIF90aGlzLm5hbWUgPSAnSW52YWxpZENyZWRlbnRpYWxzRXJyb3InO1xuICAgIHJldHVybiBfdGhpcztcbiAgfVxuXG4gIHJldHVybiBJbnZhbGlkQ3JlZGVudGlhbHNFcnJvcjtcbn0oX2Jhc2UuZGVmYXVsdCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IEludmFsaWRDcmVkZW50aWFsc0Vycm9yOyIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcblxudmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrXCIpKTtcblxudmFyIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvcG9zc2libGVDb25zdHJ1Y3RvclJldHVyblwiKSk7XG5cbnZhciBfZ2V0UHJvdG90eXBlT2YzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9nZXRQcm90b3R5cGVPZlwiKSk7XG5cbnZhciBfaW5oZXJpdHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbmhlcml0c1wiKSk7XG5cbnZhciBfYXNzZXJ0VGhpc0luaXRpYWxpemVkMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXNzZXJ0VGhpc0luaXRpYWxpemVkXCIpKTtcblxudmFyIF9iYXNlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9iYXNlXCIpKTtcblxudmFyIEludmFsaWRJZGVudGlmaWVyRXJyb3IgPVxuLyojX19QVVJFX18qL1xuZnVuY3Rpb24gKF9CYXNlRXJyb3IpIHtcbiAgKDAsIF9pbmhlcml0czIuZGVmYXVsdCkoSW52YWxpZElkZW50aWZpZXJFcnJvciwgX0Jhc2VFcnJvcik7XG5cbiAgZnVuY3Rpb24gSW52YWxpZElkZW50aWZpZXJFcnJvcigpIHtcbiAgICB2YXIgX2dldFByb3RvdHlwZU9mMjtcblxuICAgIHZhciBfdGhpcztcblxuICAgIHZhciBtZXNzYWdlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiAnT25lIG9mIG1vcmUgaWRlbnRpZmllciBuYW1lcyBpbiB0aGUgcmVxdWVzdCBoYXMgYW4gaW52YWxpZCBmb3JtYXQuJztcbiAgICAoMCwgX2NsYXNzQ2FsbENoZWNrMi5kZWZhdWx0KSh0aGlzLCBJbnZhbGlkSWRlbnRpZmllckVycm9yKTtcblxuICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4gPiAxID8gX2xlbiAtIDEgOiAwKSwgX2tleSA9IDE7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgIGFyZ3NbX2tleSAtIDFdID0gYXJndW1lbnRzW19rZXldO1xuICAgIH1cblxuICAgIC8vIFBhc3MgcmVtYWluaW5nIGFyZ3VtZW50cyAoaW5jbHVkaW5nIHZlbmRvciBzcGVjaWZpYyBvbmVzKSB0byBwYXJlbnQgY29uc3RydWN0b3JcbiAgICBfdGhpcyA9ICgwLCBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIuZGVmYXVsdCkodGhpcywgKF9nZXRQcm90b3R5cGVPZjIgPSAoMCwgX2dldFByb3RvdHlwZU9mMy5kZWZhdWx0KShJbnZhbGlkSWRlbnRpZmllckVycm9yKSkuY2FsbC5hcHBseShfZ2V0UHJvdG90eXBlT2YyLCBbdGhpcywgbWVzc2FnZV0uY29uY2F0KGFyZ3MpKSk7IC8vIE1haW50YWlucyBwcm9wZXIgc3RhY2sgdHJhY2UgZm9yIHdoZXJlIG91ciBlcnJvciB3YXMgdGhyb3duIChvbmx5IGF2YWlsYWJsZSBvbiBWOClcblxuICAgIGlmIChFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSkge1xuICAgICAgRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UoKDAsIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQyLmRlZmF1bHQpKCgwLCBfYXNzZXJ0VGhpc0luaXRpYWxpemVkMi5kZWZhdWx0KShfdGhpcykpLCBJbnZhbGlkSWRlbnRpZmllckVycm9yKTtcbiAgICB9IC8vIEN1c3RvbSBkZWJ1Z2dpbmcgaW5mb3JtYXRpb25cblxuXG4gICAgX3RoaXMubmFtZSA9ICdJbnZhbGlkSWRlbnRpZmllckVycm9yJztcbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICByZXR1cm4gSW52YWxpZElkZW50aWZpZXJFcnJvcjtcbn0oX2Jhc2UuZGVmYXVsdCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IEludmFsaWRJZGVudGlmaWVyRXJyb3I7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gcmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW50ZXJvcFJlcXVpcmVEZWZhdWx0XCIpO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xuXG52YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2tcIikpO1xuXG52YXIgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuXCIpKTtcblxudmFyIF9nZXRQcm90b3R5cGVPZjMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2dldFByb3RvdHlwZU9mXCIpKTtcblxudmFyIF9pbmhlcml0czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2luaGVyaXRzXCIpKTtcblxudmFyIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9hc3NlcnRUaGlzSW5pdGlhbGl6ZWRcIikpO1xuXG52YXIgX2Jhc2UgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL2Jhc2VcIikpO1xuXG52YXIgSW52YWxpZFF1ZXJ5U3ludGF4RXJyb3IgPVxuLyojX19QVVJFX18qL1xuZnVuY3Rpb24gKF9CYXNlRXJyb3IpIHtcbiAgKDAsIF9pbmhlcml0czIuZGVmYXVsdCkoSW52YWxpZFF1ZXJ5U3ludGF4RXJyb3IsIF9CYXNlRXJyb3IpO1xuXG4gIGZ1bmN0aW9uIEludmFsaWRRdWVyeVN5bnRheEVycm9yKCkge1xuICAgIHZhciBfZ2V0UHJvdG90eXBlT2YyO1xuXG4gICAgdmFyIF90aGlzO1xuXG4gICAgdmFyIG1lc3NhZ2UgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6ICdUaGUgcXVlcnkgc3RyaW5nIGluIHRoZSByZXF1ZXN0IGhhcyBhbiBpbnZhbGlkIHN5bnRheC4nO1xuICAgICgwLCBfY2xhc3NDYWxsQ2hlY2syLmRlZmF1bHQpKHRoaXMsIEludmFsaWRRdWVyeVN5bnRheEVycm9yKTtcblxuICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4gPiAxID8gX2xlbiAtIDEgOiAwKSwgX2tleSA9IDE7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgIGFyZ3NbX2tleSAtIDFdID0gYXJndW1lbnRzW19rZXldO1xuICAgIH1cblxuICAgIC8vIFBhc3MgcmVtYWluaW5nIGFyZ3VtZW50cyAoaW5jbHVkaW5nIHZlbmRvciBzcGVjaWZpYyBvbmVzKSB0byBwYXJlbnQgY29uc3RydWN0b3JcbiAgICBfdGhpcyA9ICgwLCBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIuZGVmYXVsdCkodGhpcywgKF9nZXRQcm90b3R5cGVPZjIgPSAoMCwgX2dldFByb3RvdHlwZU9mMy5kZWZhdWx0KShJbnZhbGlkUXVlcnlTeW50YXhFcnJvcikpLmNhbGwuYXBwbHkoX2dldFByb3RvdHlwZU9mMiwgW3RoaXMsIG1lc3NhZ2VdLmNvbmNhdChhcmdzKSkpOyAvLyBNYWludGFpbnMgcHJvcGVyIHN0YWNrIHRyYWNlIGZvciB3aGVyZSBvdXIgZXJyb3Igd2FzIHRocm93biAob25seSBhdmFpbGFibGUgb24gVjgpXG5cbiAgICBpZiAoRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UpIHtcbiAgICAgIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKCgwLCBfYXNzZXJ0VGhpc0luaXRpYWxpemVkMi5kZWZhdWx0KSgoMCwgX2Fzc2VydFRoaXNJbml0aWFsaXplZDIuZGVmYXVsdCkoX3RoaXMpKSwgSW52YWxpZFF1ZXJ5U3ludGF4RXJyb3IpO1xuICAgIH0gLy8gQ3VzdG9tIGRlYnVnZ2luZyBpbmZvcm1hdGlvblxuXG5cbiAgICBfdGhpcy5uYW1lID0gJ0ludmFsaWRRdWVyeVN5bnRheEVycm9yJztcbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICByZXR1cm4gSW52YWxpZFF1ZXJ5U3ludGF4RXJyb3I7XG59KF9iYXNlLmRlZmF1bHQpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBJbnZhbGlkUXVlcnlTeW50YXhFcnJvcjsiLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG5cbnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVja1wiKSk7XG5cbnZhciBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm5cIikpO1xuXG52YXIgX2dldFByb3RvdHlwZU9mMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZ2V0UHJvdG90eXBlT2ZcIikpO1xuXG52YXIgX2luaGVyaXRzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW5oZXJpdHNcIikpO1xuXG52YXIgX2Fzc2VydFRoaXNJbml0aWFsaXplZDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2Fzc2VydFRoaXNJbml0aWFsaXplZFwiKSk7XG5cbnZhciBfYmFzZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vYmFzZVwiKSk7XG5cbnZhciBKU09OUGFyc2VFcnJvciA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoX0Jhc2VFcnJvcikge1xuICAoMCwgX2luaGVyaXRzMi5kZWZhdWx0KShKU09OUGFyc2VFcnJvciwgX0Jhc2VFcnJvcik7XG5cbiAgZnVuY3Rpb24gSlNPTlBhcnNlRXJyb3IoKSB7XG4gICAgdmFyIF9nZXRQcm90b3R5cGVPZjI7XG5cbiAgICB2YXIgX3RoaXM7XG5cbiAgICB2YXIgbWVzc2FnZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogJ1VuYWJsZSB0byBwYXJzZSB0aGUgSlNPTiBpbiB0aGUgcmVxdWVzdC4nO1xuICAgICgwLCBfY2xhc3NDYWxsQ2hlY2syLmRlZmF1bHQpKHRoaXMsIEpTT05QYXJzZUVycm9yKTtcblxuICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4gPiAxID8gX2xlbiAtIDEgOiAwKSwgX2tleSA9IDE7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgIGFyZ3NbX2tleSAtIDFdID0gYXJndW1lbnRzW19rZXldO1xuICAgIH1cblxuICAgIC8vIFBhc3MgcmVtYWluaW5nIGFyZ3VtZW50cyAoaW5jbHVkaW5nIHZlbmRvciBzcGVjaWZpYyBvbmVzKSB0byBwYXJlbnQgY29uc3RydWN0b3JcbiAgICBfdGhpcyA9ICgwLCBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIuZGVmYXVsdCkodGhpcywgKF9nZXRQcm90b3R5cGVPZjIgPSAoMCwgX2dldFByb3RvdHlwZU9mMy5kZWZhdWx0KShKU09OUGFyc2VFcnJvcikpLmNhbGwuYXBwbHkoX2dldFByb3RvdHlwZU9mMiwgW3RoaXMsIG1lc3NhZ2VdLmNvbmNhdChhcmdzKSkpOyAvLyBNYWludGFpbnMgcHJvcGVyIHN0YWNrIHRyYWNlIGZvciB3aGVyZSBvdXIgZXJyb3Igd2FzIHRocm93biAob25seSBhdmFpbGFibGUgb24gVjgpXG5cbiAgICBpZiAoRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UpIHtcbiAgICAgIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKCgwLCBfYXNzZXJ0VGhpc0luaXRpYWxpemVkMi5kZWZhdWx0KSgoMCwgX2Fzc2VydFRoaXNJbml0aWFsaXplZDIuZGVmYXVsdCkoX3RoaXMpKSwgSlNPTlBhcnNlRXJyb3IpO1xuICAgIH0gLy8gQ3VzdG9tIGRlYnVnZ2luZyBpbmZvcm1hdGlvblxuXG5cbiAgICBfdGhpcy5uYW1lID0gJ0pTT05QYXJzZUVycm9yJztcbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICByZXR1cm4gSlNPTlBhcnNlRXJyb3I7XG59KF9iYXNlLmRlZmF1bHQpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBKU09OUGFyc2VFcnJvcjsiLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG5cbnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVja1wiKSk7XG5cbnZhciBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm5cIikpO1xuXG52YXIgX2dldFByb3RvdHlwZU9mMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZ2V0UHJvdG90eXBlT2ZcIikpO1xuXG52YXIgX2luaGVyaXRzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW5oZXJpdHNcIikpO1xuXG52YXIgX2Fzc2VydFRoaXNJbml0aWFsaXplZDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2Fzc2VydFRoaXNJbml0aWFsaXplZFwiKSk7XG5cbnZhciBfYmFzZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vYmFzZVwiKSk7XG5cbnZhciBLaW52ZXlFcnJvciA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoX0Jhc2VFcnJvcikge1xuICAoMCwgX2luaGVyaXRzMi5kZWZhdWx0KShLaW52ZXlFcnJvciwgX0Jhc2VFcnJvcik7XG5cbiAgZnVuY3Rpb24gS2ludmV5RXJyb3IoKSB7XG4gICAgdmFyIF9nZXRQcm90b3R5cGVPZjI7XG5cbiAgICB2YXIgX3RoaXM7XG5cbiAgICB2YXIgbWVzc2FnZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogJ0FuIGVycm9yIG9jY3VycmVkLic7XG4gICAgKDAsIF9jbGFzc0NhbGxDaGVjazIuZGVmYXVsdCkodGhpcywgS2ludmV5RXJyb3IpO1xuXG4gICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbiA+IDEgPyBfbGVuIC0gMSA6IDApLCBfa2V5ID0gMTsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgICAgYXJnc1tfa2V5IC0gMV0gPSBhcmd1bWVudHNbX2tleV07XG4gICAgfVxuXG4gICAgLy8gUGFzcyByZW1haW5pbmcgYXJndW1lbnRzIChpbmNsdWRpbmcgdmVuZG9yIHNwZWNpZmljIG9uZXMpIHRvIHBhcmVudCBjb25zdHJ1Y3RvclxuICAgIF90aGlzID0gKDAsIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMi5kZWZhdWx0KSh0aGlzLCAoX2dldFByb3RvdHlwZU9mMiA9ICgwLCBfZ2V0UHJvdG90eXBlT2YzLmRlZmF1bHQpKEtpbnZleUVycm9yKSkuY2FsbC5hcHBseShfZ2V0UHJvdG90eXBlT2YyLCBbdGhpcywgbWVzc2FnZV0uY29uY2F0KGFyZ3MpKSk7IC8vIE1haW50YWlucyBwcm9wZXIgc3RhY2sgdHJhY2UgZm9yIHdoZXJlIG91ciBlcnJvciB3YXMgdGhyb3duIChvbmx5IGF2YWlsYWJsZSBvbiBWOClcblxuICAgIGlmIChFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSkge1xuICAgICAgRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UoKDAsIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQyLmRlZmF1bHQpKCgwLCBfYXNzZXJ0VGhpc0luaXRpYWxpemVkMi5kZWZhdWx0KShfdGhpcykpLCBLaW52ZXlFcnJvcik7XG4gICAgfSAvLyBDdXN0b20gZGVidWdnaW5nIGluZm9ybWF0aW9uXG5cblxuICAgIF90aGlzLm5hbWUgPSAnS2ludmV5RXJyb3InO1xuICAgIHJldHVybiBfdGhpcztcbiAgfVxuXG4gIHJldHVybiBLaW52ZXlFcnJvcjtcbn0oX2Jhc2UuZGVmYXVsdCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IEtpbnZleUVycm9yOyIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcblxudmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrXCIpKTtcblxudmFyIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvcG9zc2libGVDb25zdHJ1Y3RvclJldHVyblwiKSk7XG5cbnZhciBfZ2V0UHJvdG90eXBlT2YzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9nZXRQcm90b3R5cGVPZlwiKSk7XG5cbnZhciBfaW5oZXJpdHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbmhlcml0c1wiKSk7XG5cbnZhciBfYXNzZXJ0VGhpc0luaXRpYWxpemVkMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXNzZXJ0VGhpc0luaXRpYWxpemVkXCIpKTtcblxudmFyIF9iYXNlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9iYXNlXCIpKTtcblxudmFyIEtpbnZleUludGVybmFsRXJyb3JSZXRyeSA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoX0Jhc2VFcnJvcikge1xuICAoMCwgX2luaGVyaXRzMi5kZWZhdWx0KShLaW52ZXlJbnRlcm5hbEVycm9yUmV0cnksIF9CYXNlRXJyb3IpO1xuXG4gIGZ1bmN0aW9uIEtpbnZleUludGVybmFsRXJyb3JSZXRyeSgpIHtcbiAgICB2YXIgX2dldFByb3RvdHlwZU9mMjtcblxuICAgIHZhciBfdGhpcztcblxuICAgIHZhciBtZXNzYWdlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiAnVGhlIEtpbnZleSBzZXJ2ZXIgZW5jb3VudGVyZWQgYW4gdW5leHBlY3RlZCBlcnJvci4gUGxlYXNlIHJldHJ5IHlvdXIgcmVxdWVzdC4nO1xuICAgICgwLCBfY2xhc3NDYWxsQ2hlY2syLmRlZmF1bHQpKHRoaXMsIEtpbnZleUludGVybmFsRXJyb3JSZXRyeSk7XG5cbiAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuID4gMSA/IF9sZW4gLSAxIDogMCksIF9rZXkgPSAxOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7XG4gICAgICBhcmdzW19rZXkgLSAxXSA9IGFyZ3VtZW50c1tfa2V5XTtcbiAgICB9XG5cbiAgICAvLyBQYXNzIHJlbWFpbmluZyBhcmd1bWVudHMgKGluY2x1ZGluZyB2ZW5kb3Igc3BlY2lmaWMgb25lcykgdG8gcGFyZW50IGNvbnN0cnVjdG9yXG4gICAgX3RoaXMgPSAoMCwgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yLmRlZmF1bHQpKHRoaXMsIChfZ2V0UHJvdG90eXBlT2YyID0gKDAsIF9nZXRQcm90b3R5cGVPZjMuZGVmYXVsdCkoS2ludmV5SW50ZXJuYWxFcnJvclJldHJ5KSkuY2FsbC5hcHBseShfZ2V0UHJvdG90eXBlT2YyLCBbdGhpcywgbWVzc2FnZV0uY29uY2F0KGFyZ3MpKSk7IC8vIE1haW50YWlucyBwcm9wZXIgc3RhY2sgdHJhY2UgZm9yIHdoZXJlIG91ciBlcnJvciB3YXMgdGhyb3duIChvbmx5IGF2YWlsYWJsZSBvbiBWOClcblxuICAgIGlmIChFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSkge1xuICAgICAgRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UoKDAsIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQyLmRlZmF1bHQpKCgwLCBfYXNzZXJ0VGhpc0luaXRpYWxpemVkMi5kZWZhdWx0KShfdGhpcykpLCBLaW52ZXlJbnRlcm5hbEVycm9yUmV0cnkpO1xuICAgIH0gLy8gQ3VzdG9tIGRlYnVnZ2luZyBpbmZvcm1hdGlvblxuXG5cbiAgICBfdGhpcy5uYW1lID0gJ0tpbnZleUludGVybmFsRXJyb3JSZXRyeSc7XG4gICAgcmV0dXJuIF90aGlzO1xuICB9XG5cbiAgcmV0dXJuIEtpbnZleUludGVybmFsRXJyb3JSZXRyeTtcbn0oX2Jhc2UuZGVmYXVsdCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IEtpbnZleUludGVybmFsRXJyb3JSZXRyeTsiLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG5cbnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVja1wiKSk7XG5cbnZhciBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm5cIikpO1xuXG52YXIgX2dldFByb3RvdHlwZU9mMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZ2V0UHJvdG90eXBlT2ZcIikpO1xuXG52YXIgX2luaGVyaXRzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW5oZXJpdHNcIikpO1xuXG52YXIgX2Fzc2VydFRoaXNJbml0aWFsaXplZDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2Fzc2VydFRoaXNJbml0aWFsaXplZFwiKSk7XG5cbnZhciBfYmFzZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vYmFzZVwiKSk7XG5cbnZhciBLaW52ZXlJbnRlcm5hbEVycm9yU3RvcCA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoX0Jhc2VFcnJvcikge1xuICAoMCwgX2luaGVyaXRzMi5kZWZhdWx0KShLaW52ZXlJbnRlcm5hbEVycm9yU3RvcCwgX0Jhc2VFcnJvcik7XG5cbiAgZnVuY3Rpb24gS2ludmV5SW50ZXJuYWxFcnJvclN0b3AoKSB7XG4gICAgdmFyIF9nZXRQcm90b3R5cGVPZjI7XG5cbiAgICB2YXIgX3RoaXM7XG5cbiAgICB2YXIgbWVzc2FnZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogJ1RoZSBLaW52ZXkgc2VydmVyIGVuY291bnRlcmVkIGFuIHVuZXhwZWN0ZWQgZXJyb3IuIFBsZWFzZSBjb250YWN0IHN1cHBvcnRAa2ludmV5LmNvbSBmb3IgYXNzaXN0YW5jZS4nO1xuICAgICgwLCBfY2xhc3NDYWxsQ2hlY2syLmRlZmF1bHQpKHRoaXMsIEtpbnZleUludGVybmFsRXJyb3JTdG9wKTtcblxuICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4gPiAxID8gX2xlbiAtIDEgOiAwKSwgX2tleSA9IDE7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgIGFyZ3NbX2tleSAtIDFdID0gYXJndW1lbnRzW19rZXldO1xuICAgIH1cblxuICAgIC8vIFBhc3MgcmVtYWluaW5nIGFyZ3VtZW50cyAoaW5jbHVkaW5nIHZlbmRvciBzcGVjaWZpYyBvbmVzKSB0byBwYXJlbnQgY29uc3RydWN0b3JcbiAgICBfdGhpcyA9ICgwLCBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIuZGVmYXVsdCkodGhpcywgKF9nZXRQcm90b3R5cGVPZjIgPSAoMCwgX2dldFByb3RvdHlwZU9mMy5kZWZhdWx0KShLaW52ZXlJbnRlcm5hbEVycm9yU3RvcCkpLmNhbGwuYXBwbHkoX2dldFByb3RvdHlwZU9mMiwgW3RoaXMsIG1lc3NhZ2VdLmNvbmNhdChhcmdzKSkpOyAvLyBNYWludGFpbnMgcHJvcGVyIHN0YWNrIHRyYWNlIGZvciB3aGVyZSBvdXIgZXJyb3Igd2FzIHRocm93biAob25seSBhdmFpbGFibGUgb24gVjgpXG5cbiAgICBpZiAoRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UpIHtcbiAgICAgIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKCgwLCBfYXNzZXJ0VGhpc0luaXRpYWxpemVkMi5kZWZhdWx0KSgoMCwgX2Fzc2VydFRoaXNJbml0aWFsaXplZDIuZGVmYXVsdCkoX3RoaXMpKSwgS2ludmV5SW50ZXJuYWxFcnJvclN0b3ApO1xuICAgIH0gLy8gQ3VzdG9tIGRlYnVnZ2luZyBpbmZvcm1hdGlvblxuXG5cbiAgICBfdGhpcy5uYW1lID0gJ0tpbnZleUludGVybmFsRXJyb3JTdG9wJztcbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICByZXR1cm4gS2ludmV5SW50ZXJuYWxFcnJvclN0b3A7XG59KF9iYXNlLmRlZmF1bHQpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBLaW52ZXlJbnRlcm5hbEVycm9yU3RvcDsiLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG5cbnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVja1wiKSk7XG5cbnZhciBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm5cIikpO1xuXG52YXIgX2dldFByb3RvdHlwZU9mMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZ2V0UHJvdG90eXBlT2ZcIikpO1xuXG52YXIgX2luaGVyaXRzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW5oZXJpdHNcIikpO1xuXG52YXIgX2Fzc2VydFRoaXNJbml0aWFsaXplZDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2Fzc2VydFRoaXNJbml0aWFsaXplZFwiKSk7XG5cbnZhciBfYmFzZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vYmFzZVwiKSk7XG5cbnZhciBNaXNzaW5nQ29uZmlndXJhdGlvbkVycm9yID1cbi8qI19fUFVSRV9fKi9cbmZ1bmN0aW9uIChfQmFzZUVycm9yKSB7XG4gICgwLCBfaW5oZXJpdHMyLmRlZmF1bHQpKE1pc3NpbmdDb25maWd1cmF0aW9uRXJyb3IsIF9CYXNlRXJyb3IpO1xuXG4gIGZ1bmN0aW9uIE1pc3NpbmdDb25maWd1cmF0aW9uRXJyb3IoKSB7XG4gICAgdmFyIF9nZXRQcm90b3R5cGVPZjI7XG5cbiAgICB2YXIgX3RoaXM7XG5cbiAgICB2YXIgbWVzc2FnZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogJ01pc3NpbmcgY29uZmlndXJhdGlvbiBlcnJvci4nO1xuICAgICgwLCBfY2xhc3NDYWxsQ2hlY2syLmRlZmF1bHQpKHRoaXMsIE1pc3NpbmdDb25maWd1cmF0aW9uRXJyb3IpO1xuXG4gICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbiA+IDEgPyBfbGVuIC0gMSA6IDApLCBfa2V5ID0gMTsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgICAgYXJnc1tfa2V5IC0gMV0gPSBhcmd1bWVudHNbX2tleV07XG4gICAgfVxuXG4gICAgLy8gUGFzcyByZW1haW5pbmcgYXJndW1lbnRzIChpbmNsdWRpbmcgdmVuZG9yIHNwZWNpZmljIG9uZXMpIHRvIHBhcmVudCBjb25zdHJ1Y3RvclxuICAgIF90aGlzID0gKDAsIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMi5kZWZhdWx0KSh0aGlzLCAoX2dldFByb3RvdHlwZU9mMiA9ICgwLCBfZ2V0UHJvdG90eXBlT2YzLmRlZmF1bHQpKE1pc3NpbmdDb25maWd1cmF0aW9uRXJyb3IpKS5jYWxsLmFwcGx5KF9nZXRQcm90b3R5cGVPZjIsIFt0aGlzLCBtZXNzYWdlXS5jb25jYXQoYXJncykpKTsgLy8gTWFpbnRhaW5zIHByb3BlciBzdGFjayB0cmFjZSBmb3Igd2hlcmUgb3VyIGVycm9yIHdhcyB0aHJvd24gKG9ubHkgYXZhaWxhYmxlIG9uIFY4KVxuXG4gICAgaWYgKEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKSB7XG4gICAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSgoMCwgX2Fzc2VydFRoaXNJbml0aWFsaXplZDIuZGVmYXVsdCkoKDAsIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQyLmRlZmF1bHQpKF90aGlzKSksIE1pc3NpbmdDb25maWd1cmF0aW9uRXJyb3IpO1xuICAgIH0gLy8gQ3VzdG9tIGRlYnVnZ2luZyBpbmZvcm1hdGlvblxuXG5cbiAgICBfdGhpcy5uYW1lID0gJ01pc3NpbmdDb25maWd1cmF0aW9uRXJyb3InO1xuICAgIHJldHVybiBfdGhpcztcbiAgfVxuXG4gIHJldHVybiBNaXNzaW5nQ29uZmlndXJhdGlvbkVycm9yO1xufShfYmFzZS5kZWZhdWx0KTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gTWlzc2luZ0NvbmZpZ3VyYXRpb25FcnJvcjsiLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG5cbnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVja1wiKSk7XG5cbnZhciBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm5cIikpO1xuXG52YXIgX2dldFByb3RvdHlwZU9mMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZ2V0UHJvdG90eXBlT2ZcIikpO1xuXG52YXIgX2luaGVyaXRzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW5oZXJpdHNcIikpO1xuXG52YXIgX2Fzc2VydFRoaXNJbml0aWFsaXplZDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2Fzc2VydFRoaXNJbml0aWFsaXplZFwiKSk7XG5cbnZhciBfYmFzZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vYmFzZVwiKSk7XG5cbnZhciBNaXNzaW5nUXVlcnlFcnJvciA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoX0Jhc2VFcnJvcikge1xuICAoMCwgX2luaGVyaXRzMi5kZWZhdWx0KShNaXNzaW5nUXVlcnlFcnJvciwgX0Jhc2VFcnJvcik7XG5cbiAgZnVuY3Rpb24gTWlzc2luZ1F1ZXJ5RXJyb3IoKSB7XG4gICAgdmFyIF9nZXRQcm90b3R5cGVPZjI7XG5cbiAgICB2YXIgX3RoaXM7XG5cbiAgICB2YXIgbWVzc2FnZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogJ1RoZSByZXF1ZXN0IGlzIG1pc3NpbmcgYSBxdWVyeSBzdHJpbmcuJztcbiAgICAoMCwgX2NsYXNzQ2FsbENoZWNrMi5kZWZhdWx0KSh0aGlzLCBNaXNzaW5nUXVlcnlFcnJvcik7XG5cbiAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuID4gMSA/IF9sZW4gLSAxIDogMCksIF9rZXkgPSAxOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7XG4gICAgICBhcmdzW19rZXkgLSAxXSA9IGFyZ3VtZW50c1tfa2V5XTtcbiAgICB9XG5cbiAgICAvLyBQYXNzIHJlbWFpbmluZyBhcmd1bWVudHMgKGluY2x1ZGluZyB2ZW5kb3Igc3BlY2lmaWMgb25lcykgdG8gcGFyZW50IGNvbnN0cnVjdG9yXG4gICAgX3RoaXMgPSAoMCwgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yLmRlZmF1bHQpKHRoaXMsIChfZ2V0UHJvdG90eXBlT2YyID0gKDAsIF9nZXRQcm90b3R5cGVPZjMuZGVmYXVsdCkoTWlzc2luZ1F1ZXJ5RXJyb3IpKS5jYWxsLmFwcGx5KF9nZXRQcm90b3R5cGVPZjIsIFt0aGlzLCBtZXNzYWdlXS5jb25jYXQoYXJncykpKTsgLy8gTWFpbnRhaW5zIHByb3BlciBzdGFjayB0cmFjZSBmb3Igd2hlcmUgb3VyIGVycm9yIHdhcyB0aHJvd24gKG9ubHkgYXZhaWxhYmxlIG9uIFY4KVxuXG4gICAgaWYgKEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKSB7XG4gICAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSgoMCwgX2Fzc2VydFRoaXNJbml0aWFsaXplZDIuZGVmYXVsdCkoKDAsIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQyLmRlZmF1bHQpKF90aGlzKSksIE1pc3NpbmdRdWVyeUVycm9yKTtcbiAgICB9IC8vIEN1c3RvbSBkZWJ1Z2dpbmcgaW5mb3JtYXRpb25cblxuXG4gICAgX3RoaXMubmFtZSA9ICdNaXNzaW5nUXVlcnlFcnJvcic7XG4gICAgcmV0dXJuIF90aGlzO1xuICB9XG5cbiAgcmV0dXJuIE1pc3NpbmdRdWVyeUVycm9yO1xufShfYmFzZS5kZWZhdWx0KTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gTWlzc2luZ1F1ZXJ5RXJyb3I7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gcmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW50ZXJvcFJlcXVpcmVEZWZhdWx0XCIpO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xuXG52YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2tcIikpO1xuXG52YXIgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuXCIpKTtcblxudmFyIF9nZXRQcm90b3R5cGVPZjMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2dldFByb3RvdHlwZU9mXCIpKTtcblxudmFyIF9pbmhlcml0czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2luaGVyaXRzXCIpKTtcblxudmFyIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9hc3NlcnRUaGlzSW5pdGlhbGl6ZWRcIikpO1xuXG52YXIgX2Jhc2UgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL2Jhc2VcIikpO1xuXG52YXIgTWlzc2luZ1JlcXVlc3RIZWFkZXJFcnJvciA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoX0Jhc2VFcnJvcikge1xuICAoMCwgX2luaGVyaXRzMi5kZWZhdWx0KShNaXNzaW5nUmVxdWVzdEhlYWRlckVycm9yLCBfQmFzZUVycm9yKTtcblxuICBmdW5jdGlvbiBNaXNzaW5nUmVxdWVzdEhlYWRlckVycm9yKCkge1xuICAgIHZhciBfZ2V0UHJvdG90eXBlT2YyO1xuXG4gICAgdmFyIF90aGlzO1xuXG4gICAgdmFyIG1lc3NhZ2UgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6ICdUaGUgcmVxdWVzdCBpcyBtaXNzaW5nIGEgcmVxdWlyZWQgaGVhZGVyLic7XG4gICAgKDAsIF9jbGFzc0NhbGxDaGVjazIuZGVmYXVsdCkodGhpcywgTWlzc2luZ1JlcXVlc3RIZWFkZXJFcnJvcik7XG5cbiAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuID4gMSA/IF9sZW4gLSAxIDogMCksIF9rZXkgPSAxOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7XG4gICAgICBhcmdzW19rZXkgLSAxXSA9IGFyZ3VtZW50c1tfa2V5XTtcbiAgICB9XG5cbiAgICAvLyBQYXNzIHJlbWFpbmluZyBhcmd1bWVudHMgKGluY2x1ZGluZyB2ZW5kb3Igc3BlY2lmaWMgb25lcykgdG8gcGFyZW50IGNvbnN0cnVjdG9yXG4gICAgX3RoaXMgPSAoMCwgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yLmRlZmF1bHQpKHRoaXMsIChfZ2V0UHJvdG90eXBlT2YyID0gKDAsIF9nZXRQcm90b3R5cGVPZjMuZGVmYXVsdCkoTWlzc2luZ1JlcXVlc3RIZWFkZXJFcnJvcikpLmNhbGwuYXBwbHkoX2dldFByb3RvdHlwZU9mMiwgW3RoaXMsIG1lc3NhZ2VdLmNvbmNhdChhcmdzKSkpOyAvLyBNYWludGFpbnMgcHJvcGVyIHN0YWNrIHRyYWNlIGZvciB3aGVyZSBvdXIgZXJyb3Igd2FzIHRocm93biAob25seSBhdmFpbGFibGUgb24gVjgpXG5cbiAgICBpZiAoRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UpIHtcbiAgICAgIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKCgwLCBfYXNzZXJ0VGhpc0luaXRpYWxpemVkMi5kZWZhdWx0KSgoMCwgX2Fzc2VydFRoaXNJbml0aWFsaXplZDIuZGVmYXVsdCkoX3RoaXMpKSwgTWlzc2luZ1JlcXVlc3RIZWFkZXJFcnJvcik7XG4gICAgfSAvLyBDdXN0b20gZGVidWdnaW5nIGluZm9ybWF0aW9uXG5cblxuICAgIF90aGlzLm5hbWUgPSAnTWlzc2luZ1JlcXVlc3RIZWFkZXJFcnJvcic7XG4gICAgcmV0dXJuIF90aGlzO1xuICB9XG5cbiAgcmV0dXJuIE1pc3NpbmdSZXF1ZXN0SGVhZGVyRXJyb3I7XG59KF9iYXNlLmRlZmF1bHQpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBNaXNzaW5nUmVxdWVzdEhlYWRlckVycm9yOyIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcblxudmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrXCIpKTtcblxudmFyIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvcG9zc2libGVDb25zdHJ1Y3RvclJldHVyblwiKSk7XG5cbnZhciBfZ2V0UHJvdG90eXBlT2YzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9nZXRQcm90b3R5cGVPZlwiKSk7XG5cbnZhciBfaW5oZXJpdHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbmhlcml0c1wiKSk7XG5cbnZhciBfYXNzZXJ0VGhpc0luaXRpYWxpemVkMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXNzZXJ0VGhpc0luaXRpYWxpemVkXCIpKTtcblxudmFyIF9iYXNlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9iYXNlXCIpKTtcblxudmFyIE1pc3NpbmdSZXF1ZXN0UGFyYW1ldGVyRXJyb3IgPVxuLyojX19QVVJFX18qL1xuZnVuY3Rpb24gKF9CYXNlRXJyb3IpIHtcbiAgKDAsIF9pbmhlcml0czIuZGVmYXVsdCkoTWlzc2luZ1JlcXVlc3RQYXJhbWV0ZXJFcnJvciwgX0Jhc2VFcnJvcik7XG5cbiAgZnVuY3Rpb24gTWlzc2luZ1JlcXVlc3RQYXJhbWV0ZXJFcnJvcigpIHtcbiAgICB2YXIgX2dldFByb3RvdHlwZU9mMjtcblxuICAgIHZhciBfdGhpcztcblxuICAgIHZhciBtZXNzYWdlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiAnQSByZXF1aXJlZCBwYXJhbWV0ZXIgaXMgbWlzc2luZyBmcm9tIHRoZSByZXF1ZXN0Lic7XG4gICAgKDAsIF9jbGFzc0NhbGxDaGVjazIuZGVmYXVsdCkodGhpcywgTWlzc2luZ1JlcXVlc3RQYXJhbWV0ZXJFcnJvcik7XG5cbiAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuID4gMSA/IF9sZW4gLSAxIDogMCksIF9rZXkgPSAxOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7XG4gICAgICBhcmdzW19rZXkgLSAxXSA9IGFyZ3VtZW50c1tfa2V5XTtcbiAgICB9XG5cbiAgICAvLyBQYXNzIHJlbWFpbmluZyBhcmd1bWVudHMgKGluY2x1ZGluZyB2ZW5kb3Igc3BlY2lmaWMgb25lcykgdG8gcGFyZW50IGNvbnN0cnVjdG9yXG4gICAgX3RoaXMgPSAoMCwgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yLmRlZmF1bHQpKHRoaXMsIChfZ2V0UHJvdG90eXBlT2YyID0gKDAsIF9nZXRQcm90b3R5cGVPZjMuZGVmYXVsdCkoTWlzc2luZ1JlcXVlc3RQYXJhbWV0ZXJFcnJvcikpLmNhbGwuYXBwbHkoX2dldFByb3RvdHlwZU9mMiwgW3RoaXMsIG1lc3NhZ2VdLmNvbmNhdChhcmdzKSkpOyAvLyBNYWludGFpbnMgcHJvcGVyIHN0YWNrIHRyYWNlIGZvciB3aGVyZSBvdXIgZXJyb3Igd2FzIHRocm93biAob25seSBhdmFpbGFibGUgb24gVjgpXG5cbiAgICBpZiAoRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UpIHtcbiAgICAgIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKCgwLCBfYXNzZXJ0VGhpc0luaXRpYWxpemVkMi5kZWZhdWx0KSgoMCwgX2Fzc2VydFRoaXNJbml0aWFsaXplZDIuZGVmYXVsdCkoX3RoaXMpKSwgTWlzc2luZ1JlcXVlc3RQYXJhbWV0ZXJFcnJvcik7XG4gICAgfSAvLyBDdXN0b20gZGVidWdnaW5nIGluZm9ybWF0aW9uXG5cblxuICAgIF90aGlzLm5hbWUgPSAnTWlzc2luZ1JlcXVlc3RQYXJhbWV0ZXJFcnJvcic7XG4gICAgcmV0dXJuIF90aGlzO1xuICB9XG5cbiAgcmV0dXJuIE1pc3NpbmdSZXF1ZXN0UGFyYW1ldGVyRXJyb3I7XG59KF9iYXNlLmRlZmF1bHQpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBNaXNzaW5nUmVxdWVzdFBhcmFtZXRlckVycm9yOyIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcblxudmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrXCIpKTtcblxudmFyIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvcG9zc2libGVDb25zdHJ1Y3RvclJldHVyblwiKSk7XG5cbnZhciBfZ2V0UHJvdG90eXBlT2YzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9nZXRQcm90b3R5cGVPZlwiKSk7XG5cbnZhciBfaW5oZXJpdHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbmhlcml0c1wiKSk7XG5cbnZhciBfYXNzZXJ0VGhpc0luaXRpYWxpemVkMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXNzZXJ0VGhpc0luaXRpYWxpemVkXCIpKTtcblxudmFyIF9iYXNlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9iYXNlXCIpKTtcblxudmFyIE5ldHdvcmtDb25uZWN0aW9uRXJyb3IgPVxuLyojX19QVVJFX18qL1xuZnVuY3Rpb24gKF9CYXNlRXJyb3IpIHtcbiAgKDAsIF9pbmhlcml0czIuZGVmYXVsdCkoTmV0d29ya0Nvbm5lY3Rpb25FcnJvciwgX0Jhc2VFcnJvcik7XG5cbiAgZnVuY3Rpb24gTmV0d29ya0Nvbm5lY3Rpb25FcnJvcigpIHtcbiAgICB2YXIgX2dldFByb3RvdHlwZU9mMjtcblxuICAgIHZhciBfdGhpcztcblxuICAgIHZhciBtZXNzYWdlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiAnVGhlcmUgd2FzIGFuIGVycm9yIGNvbm5lY3RpbmcgdG8gdGhlIG5ldHdvcmsuJztcbiAgICAoMCwgX2NsYXNzQ2FsbENoZWNrMi5kZWZhdWx0KSh0aGlzLCBOZXR3b3JrQ29ubmVjdGlvbkVycm9yKTtcblxuICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4gPiAxID8gX2xlbiAtIDEgOiAwKSwgX2tleSA9IDE7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgIGFyZ3NbX2tleSAtIDFdID0gYXJndW1lbnRzW19rZXldO1xuICAgIH1cblxuICAgIC8vIFBhc3MgcmVtYWluaW5nIGFyZ3VtZW50cyAoaW5jbHVkaW5nIHZlbmRvciBzcGVjaWZpYyBvbmVzKSB0byBwYXJlbnQgY29uc3RydWN0b3JcbiAgICBfdGhpcyA9ICgwLCBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIuZGVmYXVsdCkodGhpcywgKF9nZXRQcm90b3R5cGVPZjIgPSAoMCwgX2dldFByb3RvdHlwZU9mMy5kZWZhdWx0KShOZXR3b3JrQ29ubmVjdGlvbkVycm9yKSkuY2FsbC5hcHBseShfZ2V0UHJvdG90eXBlT2YyLCBbdGhpcywgbWVzc2FnZV0uY29uY2F0KGFyZ3MpKSk7IC8vIE1haW50YWlucyBwcm9wZXIgc3RhY2sgdHJhY2UgZm9yIHdoZXJlIG91ciBlcnJvciB3YXMgdGhyb3duIChvbmx5IGF2YWlsYWJsZSBvbiBWOClcblxuICAgIGlmIChFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSkge1xuICAgICAgRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UoKDAsIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQyLmRlZmF1bHQpKCgwLCBfYXNzZXJ0VGhpc0luaXRpYWxpemVkMi5kZWZhdWx0KShfdGhpcykpLCBOZXR3b3JrQ29ubmVjdGlvbkVycm9yKTtcbiAgICB9IC8vIEN1c3RvbSBkZWJ1Z2dpbmcgaW5mb3JtYXRpb25cblxuXG4gICAgX3RoaXMubmFtZSA9ICdOZXR3b3JrQ29ubmVjdGlvbkVycm9yJztcbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICByZXR1cm4gTmV0d29ya0Nvbm5lY3Rpb25FcnJvcjtcbn0oX2Jhc2UuZGVmYXVsdCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IE5ldHdvcmtDb25uZWN0aW9uRXJyb3I7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gcmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW50ZXJvcFJlcXVpcmVEZWZhdWx0XCIpO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xuXG52YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2tcIikpO1xuXG52YXIgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuXCIpKTtcblxudmFyIF9nZXRQcm90b3R5cGVPZjMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2dldFByb3RvdHlwZU9mXCIpKTtcblxudmFyIF9pbmhlcml0czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2luaGVyaXRzXCIpKTtcblxudmFyIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9hc3NlcnRUaGlzSW5pdGlhbGl6ZWRcIikpO1xuXG52YXIgX2Jhc2UgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL2Jhc2VcIikpO1xuXG52YXIgTm90Rm91bmRFcnJvciA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoX0Jhc2VFcnJvcikge1xuICAoMCwgX2luaGVyaXRzMi5kZWZhdWx0KShOb3RGb3VuZEVycm9yLCBfQmFzZUVycm9yKTtcblxuICBmdW5jdGlvbiBOb3RGb3VuZEVycm9yKCkge1xuICAgIHZhciBfZ2V0UHJvdG90eXBlT2YyO1xuXG4gICAgdmFyIF90aGlzO1xuXG4gICAgdmFyIG1lc3NhZ2UgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6ICdUaGUgZW50aXR5IHdhcyBub3QgZm91bmQuJztcbiAgICB2YXIgZGVidWcgPSBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZDtcbiAgICB2YXIgY29kZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogNDA0O1xuICAgICgwLCBfY2xhc3NDYWxsQ2hlY2syLmRlZmF1bHQpKHRoaXMsIE5vdEZvdW5kRXJyb3IpO1xuXG4gICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbiA+IDMgPyBfbGVuIC0gMyA6IDApLCBfa2V5ID0gMzsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgICAgYXJnc1tfa2V5IC0gM10gPSBhcmd1bWVudHNbX2tleV07XG4gICAgfVxuXG4gICAgLy8gUGFzcyByZW1haW5pbmcgYXJndW1lbnRzIChpbmNsdWRpbmcgdmVuZG9yIHNwZWNpZmljIG9uZXMpIHRvIHBhcmVudCBjb25zdHJ1Y3RvclxuICAgIF90aGlzID0gKDAsIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMi5kZWZhdWx0KSh0aGlzLCAoX2dldFByb3RvdHlwZU9mMiA9ICgwLCBfZ2V0UHJvdG90eXBlT2YzLmRlZmF1bHQpKE5vdEZvdW5kRXJyb3IpKS5jYWxsLmFwcGx5KF9nZXRQcm90b3R5cGVPZjIsIFt0aGlzLCBtZXNzYWdlLCBkZWJ1ZywgY29kZV0uY29uY2F0KGFyZ3MpKSk7IC8vIE1haW50YWlucyBwcm9wZXIgc3RhY2sgdHJhY2UgZm9yIHdoZXJlIG91ciBlcnJvciB3YXMgdGhyb3duIChvbmx5IGF2YWlsYWJsZSBvbiBWOClcblxuICAgIGlmIChFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSkge1xuICAgICAgRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UoKDAsIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQyLmRlZmF1bHQpKCgwLCBfYXNzZXJ0VGhpc0luaXRpYWxpemVkMi5kZWZhdWx0KShfdGhpcykpLCBOb3RGb3VuZEVycm9yKTtcbiAgICB9IC8vIEN1c3RvbSBkZWJ1Z2dpbmcgaW5mb3JtYXRpb25cblxuXG4gICAgX3RoaXMubmFtZSA9ICdOb3RGb3VuZEVycm9yJztcbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICByZXR1cm4gTm90Rm91bmRFcnJvcjtcbn0oX2Jhc2UuZGVmYXVsdCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IE5vdEZvdW5kRXJyb3I7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gcmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW50ZXJvcFJlcXVpcmVEZWZhdWx0XCIpO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xuXG52YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2tcIikpO1xuXG52YXIgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuXCIpKTtcblxudmFyIF9nZXRQcm90b3R5cGVPZjMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2dldFByb3RvdHlwZU9mXCIpKTtcblxudmFyIF9pbmhlcml0czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2luaGVyaXRzXCIpKTtcblxudmFyIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9hc3NlcnRUaGlzSW5pdGlhbGl6ZWRcIikpO1xuXG52YXIgX2Jhc2UgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL2Jhc2VcIikpO1xuXG52YXIgUGFyYW1ldGVyVmFsdWVPdXRPZlJhbmdlRXJyb3IgPVxuLyojX19QVVJFX18qL1xuZnVuY3Rpb24gKF9CYXNlRXJyb3IpIHtcbiAgKDAsIF9pbmhlcml0czIuZGVmYXVsdCkoUGFyYW1ldGVyVmFsdWVPdXRPZlJhbmdlRXJyb3IsIF9CYXNlRXJyb3IpO1xuXG4gIGZ1bmN0aW9uIFBhcmFtZXRlclZhbHVlT3V0T2ZSYW5nZUVycm9yKCkge1xuICAgIHZhciBfZ2V0UHJvdG90eXBlT2YyO1xuXG4gICAgdmFyIF90aGlzO1xuXG4gICAgdmFyIG1lc3NhZ2UgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6ICdUaGUgdmFsdWUgc3BlY2lmaWVkIGZvciBvbmUgb2YgdGhlIHJlcXVlc3QgcGFyYW1ldGVycyBpcyBvdXQgb2YgcmFuZ2UuJztcbiAgICAoMCwgX2NsYXNzQ2FsbENoZWNrMi5kZWZhdWx0KSh0aGlzLCBQYXJhbWV0ZXJWYWx1ZU91dE9mUmFuZ2VFcnJvcik7XG5cbiAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuID4gMSA/IF9sZW4gLSAxIDogMCksIF9rZXkgPSAxOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7XG4gICAgICBhcmdzW19rZXkgLSAxXSA9IGFyZ3VtZW50c1tfa2V5XTtcbiAgICB9XG5cbiAgICAvLyBQYXNzIHJlbWFpbmluZyBhcmd1bWVudHMgKGluY2x1ZGluZyB2ZW5kb3Igc3BlY2lmaWMgb25lcykgdG8gcGFyZW50IGNvbnN0cnVjdG9yXG4gICAgX3RoaXMgPSAoMCwgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yLmRlZmF1bHQpKHRoaXMsIChfZ2V0UHJvdG90eXBlT2YyID0gKDAsIF9nZXRQcm90b3R5cGVPZjMuZGVmYXVsdCkoUGFyYW1ldGVyVmFsdWVPdXRPZlJhbmdlRXJyb3IpKS5jYWxsLmFwcGx5KF9nZXRQcm90b3R5cGVPZjIsIFt0aGlzLCBtZXNzYWdlXS5jb25jYXQoYXJncykpKTsgLy8gTWFpbnRhaW5zIHByb3BlciBzdGFjayB0cmFjZSBmb3Igd2hlcmUgb3VyIGVycm9yIHdhcyB0aHJvd24gKG9ubHkgYXZhaWxhYmxlIG9uIFY4KVxuXG4gICAgaWYgKEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKSB7XG4gICAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSgoMCwgX2Fzc2VydFRoaXNJbml0aWFsaXplZDIuZGVmYXVsdCkoKDAsIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQyLmRlZmF1bHQpKF90aGlzKSksIFBhcmFtZXRlclZhbHVlT3V0T2ZSYW5nZUVycm9yKTtcbiAgICB9IC8vIEN1c3RvbSBkZWJ1Z2dpbmcgaW5mb3JtYXRpb25cblxuXG4gICAgX3RoaXMubmFtZSA9ICdQYXJhbWV0ZXJWYWx1ZU91dE9mUmFuZ2VFcnJvcic7XG4gICAgcmV0dXJuIF90aGlzO1xuICB9XG5cbiAgcmV0dXJuIFBhcmFtZXRlclZhbHVlT3V0T2ZSYW5nZUVycm9yO1xufShfYmFzZS5kZWZhdWx0KTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gUGFyYW1ldGVyVmFsdWVPdXRPZlJhbmdlRXJyb3I7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gcmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW50ZXJvcFJlcXVpcmVEZWZhdWx0XCIpO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xuXG52YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2tcIikpO1xuXG52YXIgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuXCIpKTtcblxudmFyIF9nZXRQcm90b3R5cGVPZjMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2dldFByb3RvdHlwZU9mXCIpKTtcblxudmFyIF9pbmhlcml0czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2luaGVyaXRzXCIpKTtcblxudmFyIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9hc3NlcnRUaGlzSW5pdGlhbGl6ZWRcIikpO1xuXG52YXIgX2Jhc2UgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL2Jhc2VcIikpO1xuXG52YXIgUXVlcnlFcnJvciA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoX0Jhc2VFcnJvcikge1xuICAoMCwgX2luaGVyaXRzMi5kZWZhdWx0KShRdWVyeUVycm9yLCBfQmFzZUVycm9yKTtcblxuICBmdW5jdGlvbiBRdWVyeUVycm9yKCkge1xuICAgIHZhciBfZ2V0UHJvdG90eXBlT2YyO1xuXG4gICAgdmFyIF90aGlzO1xuXG4gICAgdmFyIG1lc3NhZ2UgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6ICdBbiBlcnJvciBvY2N1cnJlZCB3aXRoIHRoZSBxdWVyeS4nO1xuICAgICgwLCBfY2xhc3NDYWxsQ2hlY2syLmRlZmF1bHQpKHRoaXMsIFF1ZXJ5RXJyb3IpO1xuXG4gICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbiA+IDEgPyBfbGVuIC0gMSA6IDApLCBfa2V5ID0gMTsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgICAgYXJnc1tfa2V5IC0gMV0gPSBhcmd1bWVudHNbX2tleV07XG4gICAgfVxuXG4gICAgLy8gUGFzcyByZW1haW5pbmcgYXJndW1lbnRzIChpbmNsdWRpbmcgdmVuZG9yIHNwZWNpZmljIG9uZXMpIHRvIHBhcmVudCBjb25zdHJ1Y3RvclxuICAgIF90aGlzID0gKDAsIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMi5kZWZhdWx0KSh0aGlzLCAoX2dldFByb3RvdHlwZU9mMiA9ICgwLCBfZ2V0UHJvdG90eXBlT2YzLmRlZmF1bHQpKFF1ZXJ5RXJyb3IpKS5jYWxsLmFwcGx5KF9nZXRQcm90b3R5cGVPZjIsIFt0aGlzLCBtZXNzYWdlXS5jb25jYXQoYXJncykpKTsgLy8gTWFpbnRhaW5zIHByb3BlciBzdGFjayB0cmFjZSBmb3Igd2hlcmUgb3VyIGVycm9yIHdhcyB0aHJvd24gKG9ubHkgYXZhaWxhYmxlIG9uIFY4KVxuXG4gICAgaWYgKEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKSB7XG4gICAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSgoMCwgX2Fzc2VydFRoaXNJbml0aWFsaXplZDIuZGVmYXVsdCkoKDAsIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQyLmRlZmF1bHQpKF90aGlzKSksIFF1ZXJ5RXJyb3IpO1xuICAgIH0gLy8gQ3VzdG9tIGRlYnVnZ2luZyBpbmZvcm1hdGlvblxuXG5cbiAgICBfdGhpcy5uYW1lID0gJ1F1ZXJ5RXJyb3InO1xuICAgIHJldHVybiBfdGhpcztcbiAgfVxuXG4gIHJldHVybiBRdWVyeUVycm9yO1xufShfYmFzZS5kZWZhdWx0KTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gUXVlcnlFcnJvcjsiLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG5cbnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVja1wiKSk7XG5cbnZhciBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm5cIikpO1xuXG52YXIgX2dldFByb3RvdHlwZU9mMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZ2V0UHJvdG90eXBlT2ZcIikpO1xuXG52YXIgX2luaGVyaXRzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW5oZXJpdHNcIikpO1xuXG52YXIgX2Fzc2VydFRoaXNJbml0aWFsaXplZDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2Fzc2VydFRoaXNJbml0aWFsaXplZFwiKSk7XG5cbnZhciBfYmFzZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vYmFzZVwiKSk7XG5cbnZhciBSZXN1bHRTZXRTaXplRXhjZWVkZWRFcnJvciA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoX0Jhc2VFcnJvcikge1xuICAoMCwgX2luaGVyaXRzMi5kZWZhdWx0KShSZXN1bHRTZXRTaXplRXhjZWVkZWRFcnJvciwgX0Jhc2VFcnJvcik7XG5cbiAgZnVuY3Rpb24gUmVzdWx0U2V0U2l6ZUV4Y2VlZGVkRXJyb3IoKSB7XG4gICAgdmFyIF9nZXRQcm90b3R5cGVPZjI7XG5cbiAgICB2YXIgX3RoaXM7XG5cbiAgICB2YXIgbWVzc2FnZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogJ1Jlc3VsdCBzZXQgc2l6ZSBleGNlZWRlZC4nO1xuICAgICgwLCBfY2xhc3NDYWxsQ2hlY2syLmRlZmF1bHQpKHRoaXMsIFJlc3VsdFNldFNpemVFeGNlZWRlZEVycm9yKTtcblxuICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4gPiAxID8gX2xlbiAtIDEgOiAwKSwgX2tleSA9IDE7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgIGFyZ3NbX2tleSAtIDFdID0gYXJndW1lbnRzW19rZXldO1xuICAgIH1cblxuICAgIC8vIFBhc3MgcmVtYWluaW5nIGFyZ3VtZW50cyAoaW5jbHVkaW5nIHZlbmRvciBzcGVjaWZpYyBvbmVzKSB0byBwYXJlbnQgY29uc3RydWN0b3JcbiAgICBfdGhpcyA9ICgwLCBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIuZGVmYXVsdCkodGhpcywgKF9nZXRQcm90b3R5cGVPZjIgPSAoMCwgX2dldFByb3RvdHlwZU9mMy5kZWZhdWx0KShSZXN1bHRTZXRTaXplRXhjZWVkZWRFcnJvcikpLmNhbGwuYXBwbHkoX2dldFByb3RvdHlwZU9mMiwgW3RoaXMsIG1lc3NhZ2VdLmNvbmNhdChhcmdzKSkpOyAvLyBNYWludGFpbnMgcHJvcGVyIHN0YWNrIHRyYWNlIGZvciB3aGVyZSBvdXIgZXJyb3Igd2FzIHRocm93biAob25seSBhdmFpbGFibGUgb24gVjgpXG5cbiAgICBpZiAoRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UpIHtcbiAgICAgIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKCgwLCBfYXNzZXJ0VGhpc0luaXRpYWxpemVkMi5kZWZhdWx0KSgoMCwgX2Fzc2VydFRoaXNJbml0aWFsaXplZDIuZGVmYXVsdCkoX3RoaXMpKSwgUmVzdWx0U2V0U2l6ZUV4Y2VlZGVkRXJyb3IpO1xuICAgIH0gLy8gQ3VzdG9tIGRlYnVnZ2luZyBpbmZvcm1hdGlvblxuXG5cbiAgICBfdGhpcy5uYW1lID0gJ1Jlc3VsdFNldFNpemVFeGNlZWRlZEVycm9yJztcbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICByZXR1cm4gUmVzdWx0U2V0U2l6ZUV4Y2VlZGVkRXJyb3I7XG59KF9iYXNlLmRlZmF1bHQpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBSZXN1bHRTZXRTaXplRXhjZWVkZWRFcnJvcjsiLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG5cbnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVja1wiKSk7XG5cbnZhciBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm5cIikpO1xuXG52YXIgX2dldFByb3RvdHlwZU9mMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZ2V0UHJvdG90eXBlT2ZcIikpO1xuXG52YXIgX2luaGVyaXRzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW5oZXJpdHNcIikpO1xuXG52YXIgX2Fzc2VydFRoaXNJbml0aWFsaXplZDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2Fzc2VydFRoaXNJbml0aWFsaXplZFwiKSk7XG5cbnZhciBfYmFzZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vYmFzZVwiKSk7XG5cbnZhciBTZXJ2ZXJFcnJvciA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoX0Jhc2VFcnJvcikge1xuICAoMCwgX2luaGVyaXRzMi5kZWZhdWx0KShTZXJ2ZXJFcnJvciwgX0Jhc2VFcnJvcik7XG5cbiAgZnVuY3Rpb24gU2VydmVyRXJyb3IoKSB7XG4gICAgdmFyIF9nZXRQcm90b3R5cGVPZjI7XG5cbiAgICB2YXIgX3RoaXM7XG5cbiAgICB2YXIgbWVzc2FnZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogJ0FuIGVycm9yIG9jY3VycmVkIG9uIHRoZSBzZXJ2ZXIuJztcbiAgICB2YXIgZGVidWcgPSBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZDtcbiAgICB2YXIgY29kZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogNTAwO1xuICAgICgwLCBfY2xhc3NDYWxsQ2hlY2syLmRlZmF1bHQpKHRoaXMsIFNlcnZlckVycm9yKTtcblxuICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4gPiAzID8gX2xlbiAtIDMgOiAwKSwgX2tleSA9IDM7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgIGFyZ3NbX2tleSAtIDNdID0gYXJndW1lbnRzW19rZXldO1xuICAgIH1cblxuICAgIC8vIFBhc3MgcmVtYWluaW5nIGFyZ3VtZW50cyAoaW5jbHVkaW5nIHZlbmRvciBzcGVjaWZpYyBvbmVzKSB0byBwYXJlbnQgY29uc3RydWN0b3JcbiAgICBfdGhpcyA9ICgwLCBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIuZGVmYXVsdCkodGhpcywgKF9nZXRQcm90b3R5cGVPZjIgPSAoMCwgX2dldFByb3RvdHlwZU9mMy5kZWZhdWx0KShTZXJ2ZXJFcnJvcikpLmNhbGwuYXBwbHkoX2dldFByb3RvdHlwZU9mMiwgW3RoaXMsIG1lc3NhZ2UsIGRlYnVnLCBjb2RlXS5jb25jYXQoYXJncykpKTsgLy8gTWFpbnRhaW5zIHByb3BlciBzdGFjayB0cmFjZSBmb3Igd2hlcmUgb3VyIGVycm9yIHdhcyB0aHJvd24gKG9ubHkgYXZhaWxhYmxlIG9uIFY4KVxuXG4gICAgaWYgKEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKSB7XG4gICAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSgoMCwgX2Fzc2VydFRoaXNJbml0aWFsaXplZDIuZGVmYXVsdCkoKDAsIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQyLmRlZmF1bHQpKF90aGlzKSksIFNlcnZlckVycm9yKTtcbiAgICB9IC8vIEN1c3RvbSBkZWJ1Z2dpbmcgaW5mb3JtYXRpb25cblxuXG4gICAgX3RoaXMubmFtZSA9ICdTZXJ2ZXJFcnJvcic7XG4gICAgcmV0dXJuIF90aGlzO1xuICB9XG5cbiAgcmV0dXJuIFNlcnZlckVycm9yO1xufShfYmFzZS5kZWZhdWx0KTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gU2VydmVyRXJyb3I7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gcmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW50ZXJvcFJlcXVpcmVEZWZhdWx0XCIpO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xuXG52YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2tcIikpO1xuXG52YXIgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuXCIpKTtcblxudmFyIF9nZXRQcm90b3R5cGVPZjMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2dldFByb3RvdHlwZU9mXCIpKTtcblxudmFyIF9pbmhlcml0czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2luaGVyaXRzXCIpKTtcblxudmFyIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9hc3NlcnRUaGlzSW5pdGlhbGl6ZWRcIikpO1xuXG52YXIgX2Jhc2UgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL2Jhc2VcIikpO1xuXG52YXIgU3RhbGVSZXF1ZXN0RXJyb3IgPVxuLyojX19QVVJFX18qL1xuZnVuY3Rpb24gKF9CYXNlRXJyb3IpIHtcbiAgKDAsIF9pbmhlcml0czIuZGVmYXVsdCkoU3RhbGVSZXF1ZXN0RXJyb3IsIF9CYXNlRXJyb3IpO1xuXG4gIGZ1bmN0aW9uIFN0YWxlUmVxdWVzdEVycm9yKCkge1xuICAgIHZhciBfZ2V0UHJvdG90eXBlT2YyO1xuXG4gICAgdmFyIF90aGlzO1xuXG4gICAgdmFyIG1lc3NhZ2UgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6ICdUaGUgdGltZSB3aW5kb3cgZm9yIHRoaXMgcmVxdWVzdCBoYXMgZXhwaXJlZC4nO1xuICAgICgwLCBfY2xhc3NDYWxsQ2hlY2syLmRlZmF1bHQpKHRoaXMsIFN0YWxlUmVxdWVzdEVycm9yKTtcblxuICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4gPiAxID8gX2xlbiAtIDEgOiAwKSwgX2tleSA9IDE7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgIGFyZ3NbX2tleSAtIDFdID0gYXJndW1lbnRzW19rZXldO1xuICAgIH1cblxuICAgIC8vIFBhc3MgcmVtYWluaW5nIGFyZ3VtZW50cyAoaW5jbHVkaW5nIHZlbmRvciBzcGVjaWZpYyBvbmVzKSB0byBwYXJlbnQgY29uc3RydWN0b3JcbiAgICBfdGhpcyA9ICgwLCBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIuZGVmYXVsdCkodGhpcywgKF9nZXRQcm90b3R5cGVPZjIgPSAoMCwgX2dldFByb3RvdHlwZU9mMy5kZWZhdWx0KShTdGFsZVJlcXVlc3RFcnJvcikpLmNhbGwuYXBwbHkoX2dldFByb3RvdHlwZU9mMiwgW3RoaXMsIG1lc3NhZ2VdLmNvbmNhdChhcmdzKSkpOyAvLyBNYWludGFpbnMgcHJvcGVyIHN0YWNrIHRyYWNlIGZvciB3aGVyZSBvdXIgZXJyb3Igd2FzIHRocm93biAob25seSBhdmFpbGFibGUgb24gVjgpXG5cbiAgICBpZiAoRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UpIHtcbiAgICAgIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKCgwLCBfYXNzZXJ0VGhpc0luaXRpYWxpemVkMi5kZWZhdWx0KSgoMCwgX2Fzc2VydFRoaXNJbml0aWFsaXplZDIuZGVmYXVsdCkoX3RoaXMpKSwgU3RhbGVSZXF1ZXN0RXJyb3IpO1xuICAgIH0gLy8gQ3VzdG9tIGRlYnVnZ2luZyBpbmZvcm1hdGlvblxuXG5cbiAgICBfdGhpcy5uYW1lID0gJ1N0YWxlUmVxdWVzdEVycm9yJztcbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICByZXR1cm4gU3RhbGVSZXF1ZXN0RXJyb3I7XG59KF9iYXNlLmRlZmF1bHQpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBTdGFsZVJlcXVlc3RFcnJvcjsiLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG5cbnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVja1wiKSk7XG5cbnZhciBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm5cIikpO1xuXG52YXIgX2dldFByb3RvdHlwZU9mMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZ2V0UHJvdG90eXBlT2ZcIikpO1xuXG52YXIgX2luaGVyaXRzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW5oZXJpdHNcIikpO1xuXG52YXIgX2Fzc2VydFRoaXNJbml0aWFsaXplZDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2Fzc2VydFRoaXNJbml0aWFsaXplZFwiKSk7XG5cbnZhciBfYmFzZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vYmFzZVwiKSk7XG5cbnZhciBTeW5jRXJyb3IgPVxuLyojX19QVVJFX18qL1xuZnVuY3Rpb24gKF9CYXNlRXJyb3IpIHtcbiAgKDAsIF9pbmhlcml0czIuZGVmYXVsdCkoU3luY0Vycm9yLCBfQmFzZUVycm9yKTtcblxuICBmdW5jdGlvbiBTeW5jRXJyb3IoKSB7XG4gICAgdmFyIF9nZXRQcm90b3R5cGVPZjI7XG5cbiAgICB2YXIgX3RoaXM7XG5cbiAgICB2YXIgbWVzc2FnZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogJ0FuIGVycm9yIG9jY3VycmVkIGR1cmluZyBzeW5jLic7XG4gICAgKDAsIF9jbGFzc0NhbGxDaGVjazIuZGVmYXVsdCkodGhpcywgU3luY0Vycm9yKTtcblxuICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4gPiAxID8gX2xlbiAtIDEgOiAwKSwgX2tleSA9IDE7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgIGFyZ3NbX2tleSAtIDFdID0gYXJndW1lbnRzW19rZXldO1xuICAgIH1cblxuICAgIC8vIFBhc3MgcmVtYWluaW5nIGFyZ3VtZW50cyAoaW5jbHVkaW5nIHZlbmRvciBzcGVjaWZpYyBvbmVzKSB0byBwYXJlbnQgY29uc3RydWN0b3JcbiAgICBfdGhpcyA9ICgwLCBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIuZGVmYXVsdCkodGhpcywgKF9nZXRQcm90b3R5cGVPZjIgPSAoMCwgX2dldFByb3RvdHlwZU9mMy5kZWZhdWx0KShTeW5jRXJyb3IpKS5jYWxsLmFwcGx5KF9nZXRQcm90b3R5cGVPZjIsIFt0aGlzLCBtZXNzYWdlXS5jb25jYXQoYXJncykpKTsgLy8gTWFpbnRhaW5zIHByb3BlciBzdGFjayB0cmFjZSBmb3Igd2hlcmUgb3VyIGVycm9yIHdhcyB0aHJvd24gKG9ubHkgYXZhaWxhYmxlIG9uIFY4KVxuXG4gICAgaWYgKEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKSB7XG4gICAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSgoMCwgX2Fzc2VydFRoaXNJbml0aWFsaXplZDIuZGVmYXVsdCkoKDAsIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQyLmRlZmF1bHQpKF90aGlzKSksIFN5bmNFcnJvcik7XG4gICAgfSAvLyBDdXN0b20gZGVidWdnaW5nIGluZm9ybWF0aW9uXG5cblxuICAgIF90aGlzLm5hbWUgPSAnU3luY0Vycm9yJztcbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICByZXR1cm4gU3luY0Vycm9yO1xufShfYmFzZS5kZWZhdWx0KTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gU3luY0Vycm9yOyIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcblxudmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrXCIpKTtcblxudmFyIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvcG9zc2libGVDb25zdHJ1Y3RvclJldHVyblwiKSk7XG5cbnZhciBfZ2V0UHJvdG90eXBlT2YzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9nZXRQcm90b3R5cGVPZlwiKSk7XG5cbnZhciBfaW5oZXJpdHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbmhlcml0c1wiKSk7XG5cbnZhciBfYXNzZXJ0VGhpc0luaXRpYWxpemVkMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXNzZXJ0VGhpc0luaXRpYWxpemVkXCIpKTtcblxudmFyIF9iYXNlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9iYXNlXCIpKTtcblxudmFyIFRpbWVvdXRFcnJvciA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoX0Jhc2VFcnJvcikge1xuICAoMCwgX2luaGVyaXRzMi5kZWZhdWx0KShUaW1lb3V0RXJyb3IsIF9CYXNlRXJyb3IpO1xuXG4gIGZ1bmN0aW9uIFRpbWVvdXRFcnJvcigpIHtcbiAgICB2YXIgX2dldFByb3RvdHlwZU9mMjtcblxuICAgIHZhciBfdGhpcztcblxuICAgIHZhciBtZXNzYWdlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiAnVGhlIHJlcXVlc3QgdGltZWQgb3V0Lic7XG4gICAgKDAsIF9jbGFzc0NhbGxDaGVjazIuZGVmYXVsdCkodGhpcywgVGltZW91dEVycm9yKTtcblxuICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4gPiAxID8gX2xlbiAtIDEgOiAwKSwgX2tleSA9IDE7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgIGFyZ3NbX2tleSAtIDFdID0gYXJndW1lbnRzW19rZXldO1xuICAgIH1cblxuICAgIC8vIFBhc3MgcmVtYWluaW5nIGFyZ3VtZW50cyAoaW5jbHVkaW5nIHZlbmRvciBzcGVjaWZpYyBvbmVzKSB0byBwYXJlbnQgY29uc3RydWN0b3JcbiAgICBfdGhpcyA9ICgwLCBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIuZGVmYXVsdCkodGhpcywgKF9nZXRQcm90b3R5cGVPZjIgPSAoMCwgX2dldFByb3RvdHlwZU9mMy5kZWZhdWx0KShUaW1lb3V0RXJyb3IpKS5jYWxsLmFwcGx5KF9nZXRQcm90b3R5cGVPZjIsIFt0aGlzLCBtZXNzYWdlXS5jb25jYXQoYXJncykpKTsgLy8gTWFpbnRhaW5zIHByb3BlciBzdGFjayB0cmFjZSBmb3Igd2hlcmUgb3VyIGVycm9yIHdhcyB0aHJvd24gKG9ubHkgYXZhaWxhYmxlIG9uIFY4KVxuXG4gICAgaWYgKEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKSB7XG4gICAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSgoMCwgX2Fzc2VydFRoaXNJbml0aWFsaXplZDIuZGVmYXVsdCkoKDAsIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQyLmRlZmF1bHQpKF90aGlzKSksIFRpbWVvdXRFcnJvcik7XG4gICAgfSAvLyBDdXN0b20gZGVidWdnaW5nIGluZm9ybWF0aW9uXG5cblxuICAgIF90aGlzLm5hbWUgPSAnVGltZW91dEVycm9yJztcbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICByZXR1cm4gVGltZW91dEVycm9yO1xufShfYmFzZS5kZWZhdWx0KTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gVGltZW91dEVycm9yOyIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcblxudmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrXCIpKTtcblxudmFyIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvcG9zc2libGVDb25zdHJ1Y3RvclJldHVyblwiKSk7XG5cbnZhciBfZ2V0UHJvdG90eXBlT2YzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9nZXRQcm90b3R5cGVPZlwiKSk7XG5cbnZhciBfaW5oZXJpdHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbmhlcml0c1wiKSk7XG5cbnZhciBfYXNzZXJ0VGhpc0luaXRpYWxpemVkMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXNzZXJ0VGhpc0luaXRpYWxpemVkXCIpKTtcblxudmFyIF9iYXNlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9iYXNlXCIpKTtcblxudmFyIFVzZXJBbHJlYWR5RXhpc3RzRXJyb3IgPVxuLyojX19QVVJFX18qL1xuZnVuY3Rpb24gKF9CYXNlRXJyb3IpIHtcbiAgKDAsIF9pbmhlcml0czIuZGVmYXVsdCkoVXNlckFscmVhZHlFeGlzdHNFcnJvciwgX0Jhc2VFcnJvcik7XG5cbiAgZnVuY3Rpb24gVXNlckFscmVhZHlFeGlzdHNFcnJvcigpIHtcbiAgICB2YXIgX2dldFByb3RvdHlwZU9mMjtcblxuICAgIHZhciBfdGhpcztcblxuICAgIHZhciBtZXNzYWdlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiAnVGhpcyB1c2VybmFtZSBpcyBhbHJlYWR5IHRha2VuLiBQbGVhc2UgcmV0cnkgeW91ciByZXF1ZXN0IHdpdGggYSBkaWZmZXJlbnQgdXNlcm5hbWUuJztcbiAgICAoMCwgX2NsYXNzQ2FsbENoZWNrMi5kZWZhdWx0KSh0aGlzLCBVc2VyQWxyZWFkeUV4aXN0c0Vycm9yKTtcblxuICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4gPiAxID8gX2xlbiAtIDEgOiAwKSwgX2tleSA9IDE7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgIGFyZ3NbX2tleSAtIDFdID0gYXJndW1lbnRzW19rZXldO1xuICAgIH1cblxuICAgIC8vIFBhc3MgcmVtYWluaW5nIGFyZ3VtZW50cyAoaW5jbHVkaW5nIHZlbmRvciBzcGVjaWZpYyBvbmVzKSB0byBwYXJlbnQgY29uc3RydWN0b3JcbiAgICBfdGhpcyA9ICgwLCBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIuZGVmYXVsdCkodGhpcywgKF9nZXRQcm90b3R5cGVPZjIgPSAoMCwgX2dldFByb3RvdHlwZU9mMy5kZWZhdWx0KShVc2VyQWxyZWFkeUV4aXN0c0Vycm9yKSkuY2FsbC5hcHBseShfZ2V0UHJvdG90eXBlT2YyLCBbdGhpcywgbWVzc2FnZV0uY29uY2F0KGFyZ3MpKSk7IC8vIE1haW50YWlucyBwcm9wZXIgc3RhY2sgdHJhY2UgZm9yIHdoZXJlIG91ciBlcnJvciB3YXMgdGhyb3duIChvbmx5IGF2YWlsYWJsZSBvbiBWOClcblxuICAgIGlmIChFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSkge1xuICAgICAgRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UoKDAsIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQyLmRlZmF1bHQpKCgwLCBfYXNzZXJ0VGhpc0luaXRpYWxpemVkMi5kZWZhdWx0KShfdGhpcykpLCBVc2VyQWxyZWFkeUV4aXN0c0Vycm9yKTtcbiAgICB9IC8vIEN1c3RvbSBkZWJ1Z2dpbmcgaW5mb3JtYXRpb25cblxuXG4gICAgX3RoaXMubmFtZSA9ICdVc2VyQWxyZWFkeUV4aXN0c0Vycm9yJztcbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICByZXR1cm4gVXNlckFscmVhZHlFeGlzdHNFcnJvcjtcbn0oX2Jhc2UuZGVmYXVsdCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IFVzZXJBbHJlYWR5RXhpc3RzRXJyb3I7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gcmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW50ZXJvcFJlcXVpcmVEZWZhdWx0XCIpO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xuXG52YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2tcIikpO1xuXG52YXIgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuXCIpKTtcblxudmFyIF9nZXRQcm90b3R5cGVPZjMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2dldFByb3RvdHlwZU9mXCIpKTtcblxudmFyIF9pbmhlcml0czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2luaGVyaXRzXCIpKTtcblxudmFyIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9hc3NlcnRUaGlzSW5pdGlhbGl6ZWRcIikpO1xuXG52YXIgX2Jhc2UgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL2Jhc2VcIikpO1xuXG52YXIgV3JpdGVzVG9Db2xsZWN0aW9uRGlzYWxsb3dlZEVycm9yID1cbi8qI19fUFVSRV9fKi9cbmZ1bmN0aW9uIChfQmFzZUVycm9yKSB7XG4gICgwLCBfaW5oZXJpdHMyLmRlZmF1bHQpKFdyaXRlc1RvQ29sbGVjdGlvbkRpc2FsbG93ZWRFcnJvciwgX0Jhc2VFcnJvcik7XG5cbiAgZnVuY3Rpb24gV3JpdGVzVG9Db2xsZWN0aW9uRGlzYWxsb3dlZEVycm9yKCkge1xuICAgIHZhciBfZ2V0UHJvdG90eXBlT2YyO1xuXG4gICAgdmFyIF90aGlzO1xuXG4gICAgdmFyIG1lc3NhZ2UgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6ICdUaGlzIGNvbGxlY3Rpb24gaXMgY29uZmlndXJlZCB0byBkaXNhbGxvdyBhbnkgbW9kaWZpY2F0aW9ucyB0byBhbiBleGlzdGluZyBlbnRpdHkgb3IgY3JlYXRpb24gb2YgbmV3IGVudGl0aWVzLic7XG4gICAgKDAsIF9jbGFzc0NhbGxDaGVjazIuZGVmYXVsdCkodGhpcywgV3JpdGVzVG9Db2xsZWN0aW9uRGlzYWxsb3dlZEVycm9yKTtcblxuICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4gPiAxID8gX2xlbiAtIDEgOiAwKSwgX2tleSA9IDE7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgIGFyZ3NbX2tleSAtIDFdID0gYXJndW1lbnRzW19rZXldO1xuICAgIH1cblxuICAgIC8vIFBhc3MgcmVtYWluaW5nIGFyZ3VtZW50cyAoaW5jbHVkaW5nIHZlbmRvciBzcGVjaWZpYyBvbmVzKSB0byBwYXJlbnQgY29uc3RydWN0b3JcbiAgICBfdGhpcyA9ICgwLCBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIuZGVmYXVsdCkodGhpcywgKF9nZXRQcm90b3R5cGVPZjIgPSAoMCwgX2dldFByb3RvdHlwZU9mMy5kZWZhdWx0KShXcml0ZXNUb0NvbGxlY3Rpb25EaXNhbGxvd2VkRXJyb3IpKS5jYWxsLmFwcGx5KF9nZXRQcm90b3R5cGVPZjIsIFt0aGlzLCBtZXNzYWdlXS5jb25jYXQoYXJncykpKTsgLy8gTWFpbnRhaW5zIHByb3BlciBzdGFjayB0cmFjZSBmb3Igd2hlcmUgb3VyIGVycm9yIHdhcyB0aHJvd24gKG9ubHkgYXZhaWxhYmxlIG9uIFY4KVxuXG4gICAgaWYgKEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKSB7XG4gICAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSgoMCwgX2Fzc2VydFRoaXNJbml0aWFsaXplZDIuZGVmYXVsdCkoKDAsIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQyLmRlZmF1bHQpKF90aGlzKSksIFdyaXRlc1RvQ29sbGVjdGlvbkRpc2FsbG93ZWRFcnJvcik7XG4gICAgfSAvLyBDdXN0b20gZGVidWdnaW5nIGluZm9ybWF0aW9uXG5cblxuICAgIF90aGlzLm5hbWUgPSAnV3JpdGVzVG9Db2xsZWN0aW9uRGlzYWxsb3dlZEVycm9yJztcbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICByZXR1cm4gV3JpdGVzVG9Db2xsZWN0aW9uRGlzYWxsb3dlZEVycm9yO1xufShfYmFzZS5kZWZhdWx0KTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gV3JpdGVzVG9Db2xsZWN0aW9uRGlzYWxsb3dlZEVycm9yOyIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IGNyZWF0ZTtcblxudmFyIF9yZWdlbmVyYXRvciA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL3JlZ2VuZXJhdG9yXCIpKTtcblxudmFyIF9hc3luY1RvR2VuZXJhdG9yMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXN5bmNUb0dlbmVyYXRvclwiKSk7XG5cbnZhciBfdXBsb2FkID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi91cGxvYWRcIikpO1xuXG5mdW5jdGlvbiBjcmVhdGUoX3gsIF94MiwgX3gzKSB7XG4gIHJldHVybiBfY3JlYXRlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5cbmZ1bmN0aW9uIF9jcmVhdGUoKSB7XG4gIF9jcmVhdGUgPSAoMCwgX2FzeW5jVG9HZW5lcmF0b3IyLmRlZmF1bHQpKFxuICAvKiNfX1BVUkVfXyovXG4gIF9yZWdlbmVyYXRvci5kZWZhdWx0Lm1hcmsoZnVuY3Rpb24gX2NhbGxlZShmaWxlLCBtZXRhZGF0YSwgb3B0aW9ucykge1xuICAgIHJldHVybiBfcmVnZW5lcmF0b3IuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7XG4gICAgICB3aGlsZSAoMSkge1xuICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7XG4gICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdChcInJldHVyblwiLCAoMCwgX3VwbG9hZC5kZWZhdWx0KShmaWxlLCBtZXRhZGF0YSwgb3B0aW9ucykpO1xuXG4gICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LCBfY2FsbGVlLCB0aGlzKTtcbiAgfSkpO1xuICByZXR1cm4gX2NyZWF0ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufSIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IGRvd25sb2FkO1xuXG52YXIgX3JlZ2VuZXJhdG9yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvcmVnZW5lcmF0b3JcIikpO1xuXG52YXIgX2FzeW5jVG9HZW5lcmF0b3IyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9hc3luY1RvR2VuZXJhdG9yXCIpKTtcblxudmFyIF9pc051bWJlciA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcImxvZGFzaC9pc051bWJlclwiKSk7XG5cbnZhciBfY29uZmlnID0gcmVxdWlyZShcIi4uL2tpbnZleS9jb25maWdcIik7XG5cbnZhciBfdXRpbHMgPSByZXF1aXJlKFwiLi4vaHR0cC91dGlsc1wiKTtcblxudmFyIF9yZXF1ZXN0ID0gcmVxdWlyZShcIi4uL2h0dHAvcmVxdWVzdFwiKTtcblxudmFyIF9hdXRoID0gcmVxdWlyZShcIi4uL2h0dHAvYXV0aFwiKTtcblxudmFyIF9kb3dubG9hZEJ5VXJsID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9kb3dubG9hZEJ5VXJsXCIpKTtcblxudmFyIE5BTUVTUEFDRSA9ICdibG9iJztcblxuZnVuY3Rpb24gZG93bmxvYWQoX3gpIHtcbiAgcmV0dXJuIF9kb3dubG9hZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuXG5mdW5jdGlvbiBfZG93bmxvYWQoKSB7XG4gIF9kb3dubG9hZCA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gIC8qI19fUFVSRV9fKi9cbiAgX3JlZ2VuZXJhdG9yLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlKGlkKSB7XG4gICAgdmFyIG9wdGlvbnMsXG4gICAgICAgIF9nZXRDb25maWcsXG4gICAgICAgIGFwaVByb3RvY29sLFxuICAgICAgICBhcGlIb3N0LFxuICAgICAgICBhcHBLZXksXG4gICAgICAgIF9vcHRpb25zJHN0cmVhbSxcbiAgICAgICAgc3RyZWFtLFxuICAgICAgICBfb3B0aW9ucyR0bHMsXG4gICAgICAgIHRscyxcbiAgICAgICAgdHRsLFxuICAgICAgICBxdWVyeVN0cmluZ09iamVjdCxcbiAgICAgICAgcmVxdWVzdCxcbiAgICAgICAgcmVzcG9uc2UsXG4gICAgICAgIGZpbGUsXG4gICAgICAgIF9hcmdzID0gYXJndW1lbnRzO1xuXG4gICAgcmV0dXJuIF9yZWdlbmVyYXRvci5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHtcbiAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHtcbiAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICBvcHRpb25zID0gX2FyZ3MubGVuZ3RoID4gMSAmJiBfYXJnc1sxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3NbMV0gOiB7fTtcbiAgICAgICAgICAgIF9nZXRDb25maWcgPSAoMCwgX2NvbmZpZy5nZXQpKCksIGFwaVByb3RvY29sID0gX2dldENvbmZpZy5hcGlQcm90b2NvbCwgYXBpSG9zdCA9IF9nZXRDb25maWcuYXBpSG9zdCwgYXBwS2V5ID0gX2dldENvbmZpZy5hcHBLZXk7XG4gICAgICAgICAgICBfb3B0aW9ucyRzdHJlYW0gPSBvcHRpb25zLnN0cmVhbSwgc3RyZWFtID0gX29wdGlvbnMkc3RyZWFtID09PSB2b2lkIDAgPyBmYWxzZSA6IF9vcHRpb25zJHN0cmVhbSwgX29wdGlvbnMkdGxzID0gb3B0aW9ucy50bHMsIHRscyA9IF9vcHRpb25zJHRscyA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9vcHRpb25zJHRscywgdHRsID0gb3B0aW9ucy50dGw7XG4gICAgICAgICAgICBxdWVyeVN0cmluZ09iamVjdCA9IE9iamVjdC5hc3NpZ24oe30sIHtcbiAgICAgICAgICAgICAgdGxzOiB0bHMgPT09IHRydWVcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAoKDAsIF9pc051bWJlci5kZWZhdWx0KSh0dGwpKSB7XG4gICAgICAgICAgICAgIHF1ZXJ5U3RyaW5nT2JqZWN0LnR0bF9pbl9zZWNvbmRzID0gcGFyc2VJbnQodHRsLCAxMCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJlcXVlc3QgPSBuZXcgX3JlcXVlc3QuS2ludmV5UmVxdWVzdCh7XG4gICAgICAgICAgICAgIG1ldGhvZDogX3JlcXVlc3QuUmVxdWVzdE1ldGhvZC5HRVQsXG4gICAgICAgICAgICAgIGF1dGg6IF9hdXRoLkF1dGguRGVmYXVsdCxcbiAgICAgICAgICAgICAgdXJsOiAoMCwgX3V0aWxzLmZvcm1hdEtpbnZleVVybCkoYXBpUHJvdG9jb2wsIGFwaUhvc3QsIFwiL1wiLmNvbmNhdChOQU1FU1BBQ0UsIFwiL1wiKS5jb25jYXQoYXBwS2V5LCBcIi9cIikuY29uY2F0KGlkKSwgcXVlcnlTdHJpbmdPYmplY3QpLFxuICAgICAgICAgICAgICB0aW1lb3V0OiBvcHRpb25zLnRpbWVvdXRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDg7XG4gICAgICAgICAgICByZXR1cm4gcmVxdWVzdC5leGVjdXRlKCk7XG5cbiAgICAgICAgICBjYXNlIDg6XG4gICAgICAgICAgICByZXNwb25zZSA9IF9jb250ZXh0LnNlbnQ7XG4gICAgICAgICAgICBmaWxlID0gcmVzcG9uc2UuZGF0YTtcblxuICAgICAgICAgICAgaWYgKCFzdHJlYW0pIHtcbiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDEyO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdChcInJldHVyblwiLCBmaWxlKTtcblxuICAgICAgICAgIGNhc2UgMTI6XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KFwicmV0dXJuXCIsICgwLCBfZG93bmxvYWRCeVVybC5kZWZhdWx0KShmaWxlLl9kb3dubG9hZFVSTCwgb3B0aW9ucykpO1xuXG4gICAgICAgICAgY2FzZSAxMzpcbiAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwgX2NhbGxlZSwgdGhpcyk7XG4gIH0pKTtcbiAgcmV0dXJuIF9kb3dubG9hZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufSIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IGRvd25sb2FkQnlVcmw7XG5cbnZhciBfcmVnZW5lcmF0b3IgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9yZWdlbmVyYXRvclwiKSk7XG5cbnZhciBfYXN5bmNUb0dlbmVyYXRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2FzeW5jVG9HZW5lcmF0b3JcIikpO1xuXG52YXIgX3JlcXVlc3QgPSByZXF1aXJlKFwiLi4vaHR0cC9yZXF1ZXN0XCIpO1xuXG5mdW5jdGlvbiBkb3dubG9hZEJ5VXJsKF94KSB7XG4gIHJldHVybiBfZG93bmxvYWRCeVVybC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuXG5mdW5jdGlvbiBfZG93bmxvYWRCeVVybCgpIHtcbiAgX2Rvd25sb2FkQnlVcmwgPSAoMCwgX2FzeW5jVG9HZW5lcmF0b3IyLmRlZmF1bHQpKFxuICAvKiNfX1BVUkVfXyovXG4gIF9yZWdlbmVyYXRvci5kZWZhdWx0Lm1hcmsoZnVuY3Rpb24gX2NhbGxlZSh1cmwpIHtcbiAgICB2YXIgb3B0aW9ucyxcbiAgICAgICAgcmVxdWVzdCxcbiAgICAgICAgcmVzcG9uc2UsXG4gICAgICAgIF9hcmdzID0gYXJndW1lbnRzO1xuICAgIHJldHVybiBfcmVnZW5lcmF0b3IuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7XG4gICAgICB3aGlsZSAoMSkge1xuICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7XG4gICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgb3B0aW9ucyA9IF9hcmdzLmxlbmd0aCA+IDEgJiYgX2FyZ3NbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmdzWzFdIDoge307XG4gICAgICAgICAgICByZXF1ZXN0ID0gbmV3IF9yZXF1ZXN0LlJlcXVlc3Qoe1xuICAgICAgICAgICAgICBtZXRob2Q6IF9yZXF1ZXN0LlJlcXVlc3RNZXRob2QuR0VULFxuICAgICAgICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICAgICAgdGltZW91dDogb3B0aW9ucy50aW1lb3V0XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA0O1xuICAgICAgICAgICAgcmV0dXJuIHJlcXVlc3QuZXhlY3V0ZSgpO1xuXG4gICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgcmVzcG9uc2UgPSBfY29udGV4dC5zZW50O1xuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdChcInJldHVyblwiLCByZXNwb25zZS5kYXRhKTtcblxuICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwgX2NhbGxlZSwgdGhpcyk7XG4gIH0pKTtcbiAgcmV0dXJuIF9kb3dubG9hZEJ5VXJsLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gcmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW50ZXJvcFJlcXVpcmVEZWZhdWx0XCIpO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gZmluZDtcblxudmFyIF9yZWdlbmVyYXRvciA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL3JlZ2VuZXJhdG9yXCIpKTtcblxudmFyIF9hc3luY1RvR2VuZXJhdG9yMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXN5bmNUb0dlbmVyYXRvclwiKSk7XG5cbnZhciBfaXNOdW1iZXIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJsb2Rhc2gvaXNOdW1iZXJcIikpO1xuXG52YXIgX2NvbmZpZyA9IHJlcXVpcmUoXCIuLi9raW52ZXkvY29uZmlnXCIpO1xuXG52YXIgX3F1ZXJ5ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vcXVlcnlcIikpO1xuXG52YXIgX2tpbnZleSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uL2Vycm9ycy9raW52ZXlcIikpO1xuXG52YXIgX3V0aWxzID0gcmVxdWlyZShcIi4uL2h0dHAvdXRpbHNcIik7XG5cbnZhciBfcmVxdWVzdCA9IHJlcXVpcmUoXCIuLi9odHRwL3JlcXVlc3RcIik7XG5cbnZhciBfYXV0aCA9IHJlcXVpcmUoXCIuLi9odHRwL2F1dGhcIik7XG5cbnZhciBfZG93bmxvYWRCeVVybCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vZG93bmxvYWRCeVVybFwiKSk7XG5cbnZhciBOQU1FU1BBQ0UgPSAnYmxvYic7XG5cbmZ1bmN0aW9uIGZpbmQoKSB7XG4gIHJldHVybiBfZmluZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuXG5mdW5jdGlvbiBfZmluZCgpIHtcbiAgX2ZpbmQgPSAoMCwgX2FzeW5jVG9HZW5lcmF0b3IyLmRlZmF1bHQpKFxuICAvKiNfX1BVUkVfXyovXG4gIF9yZWdlbmVyYXRvci5kZWZhdWx0Lm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHtcbiAgICB2YXIgcXVlcnksXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIF9nZXRDb25maWcsXG4gICAgICAgIGFwaVByb3RvY29sLFxuICAgICAgICBhcGlIb3N0LFxuICAgICAgICBhcHBLZXksXG4gICAgICAgIF9vcHRpb25zJGRvd25sb2FkLFxuICAgICAgICBkb3dubG9hZCxcbiAgICAgICAgX29wdGlvbnMkdGxzLFxuICAgICAgICB0bHMsXG4gICAgICAgIHR0bCxcbiAgICAgICAgcXVlcnlTdHJpbmdPYmplY3QsXG4gICAgICAgIHJlcXVlc3QsXG4gICAgICAgIHJlc3BvbnNlLFxuICAgICAgICBmaWxlcyxcbiAgICAgICAgX2FyZ3MgPSBhcmd1bWVudHM7XG5cbiAgICByZXR1cm4gX3JlZ2VuZXJhdG9yLmRlZmF1bHQud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkge1xuICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkge1xuICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIHF1ZXJ5ID0gX2FyZ3MubGVuZ3RoID4gMCAmJiBfYXJnc1swXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3NbMF0gOiBuZXcgX3F1ZXJ5LmRlZmF1bHQoKTtcbiAgICAgICAgICAgIG9wdGlvbnMgPSBfYXJncy5sZW5ndGggPiAxICYmIF9hcmdzWzFdICE9PSB1bmRlZmluZWQgPyBfYXJnc1sxXSA6IHt9O1xuICAgICAgICAgICAgX2dldENvbmZpZyA9ICgwLCBfY29uZmlnLmdldCkoKSwgYXBpUHJvdG9jb2wgPSBfZ2V0Q29uZmlnLmFwaVByb3RvY29sLCBhcGlIb3N0ID0gX2dldENvbmZpZy5hcGlIb3N0LCBhcHBLZXkgPSBfZ2V0Q29uZmlnLmFwcEtleTtcbiAgICAgICAgICAgIF9vcHRpb25zJGRvd25sb2FkID0gb3B0aW9ucy5kb3dubG9hZCwgZG93bmxvYWQgPSBfb3B0aW9ucyRkb3dubG9hZCA9PT0gdm9pZCAwID8gZmFsc2UgOiBfb3B0aW9ucyRkb3dubG9hZCwgX29wdGlvbnMkdGxzID0gb3B0aW9ucy50bHMsIHRscyA9IF9vcHRpb25zJHRscyA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9vcHRpb25zJHRscywgdHRsID0gb3B0aW9ucy50dGw7XG4gICAgICAgICAgICBxdWVyeVN0cmluZ09iamVjdCA9IE9iamVjdC5hc3NpZ24oe30sIHtcbiAgICAgICAgICAgICAgdGxzOiB0bHMgPT09IHRydWVcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAoIXF1ZXJ5KSB7XG4gICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA5O1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHF1ZXJ5IGluc3RhbmNlb2YgX3F1ZXJ5LmRlZmF1bHQpIHtcbiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDg7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aHJvdyBuZXcgX2tpbnZleS5kZWZhdWx0KCdJbnZhbGlkIHF1ZXJ5LiBJdCBtdXN0IGJlIGFuIGluc3RhbmNlIG9mIHRoZSBRdWVyeSBjbGFzcy4nKTtcblxuICAgICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgIHF1ZXJ5U3RyaW5nT2JqZWN0ID0gT2JqZWN0LmFzc2lnbih7fSwgcXVlcnlTdHJpbmdPYmplY3QsIHF1ZXJ5LnRvUXVlcnlPYmplY3QoKSk7XG5cbiAgICAgICAgICBjYXNlIDk6XG4gICAgICAgICAgICBpZiAoKDAsIF9pc051bWJlci5kZWZhdWx0KSh0dGwpKSB7XG4gICAgICAgICAgICAgIHF1ZXJ5U3RyaW5nT2JqZWN0LnR0bF9pbl9zZWNvbmRzID0gcGFyc2VJbnQodHRsLCAxMCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJlcXVlc3QgPSBuZXcgX3JlcXVlc3QuS2ludmV5UmVxdWVzdCh7XG4gICAgICAgICAgICAgIG1ldGhvZDogX3JlcXVlc3QuUmVxdWVzdE1ldGhvZC5HRVQsXG4gICAgICAgICAgICAgIGF1dGg6IF9hdXRoLkF1dGguRGVmYXVsdCxcbiAgICAgICAgICAgICAgdXJsOiAoMCwgX3V0aWxzLmZvcm1hdEtpbnZleVVybCkoYXBpUHJvdG9jb2wsIGFwaUhvc3QsIFwiL1wiLmNvbmNhdChOQU1FU1BBQ0UsIFwiL1wiKS5jb25jYXQoYXBwS2V5KSwgcXVlcnlTdHJpbmdPYmplY3QpLFxuICAgICAgICAgICAgICB0aW1lb3V0OiBvcHRpb25zLnRpbWVvdXRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDEzO1xuICAgICAgICAgICAgcmV0dXJuIHJlcXVlc3QuZXhlY3V0ZSgpO1xuXG4gICAgICAgICAgY2FzZSAxMzpcbiAgICAgICAgICAgIHJlc3BvbnNlID0gX2NvbnRleHQuc2VudDtcbiAgICAgICAgICAgIGZpbGVzID0gcmVzcG9uc2UuZGF0YTtcblxuICAgICAgICAgICAgaWYgKCEoZG93bmxvYWQgPT09IHRydWUpKSB7XG4gICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxNztcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoXCJyZXR1cm5cIiwgUHJvbWlzZS5hbGwoZmlsZXMubWFwKGZ1bmN0aW9uIChmaWxlKSB7XG4gICAgICAgICAgICAgIHJldHVybiAoMCwgX2Rvd25sb2FkQnlVcmwuZGVmYXVsdCkoZmlsZS5fZG93bmxvYWRVUkwsIG9wdGlvbnMpO1xuICAgICAgICAgICAgfSkpKTtcblxuICAgICAgICAgIGNhc2UgMTc6XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KFwicmV0dXJuXCIsIGZpbGVzKTtcblxuICAgICAgICAgIGNhc2UgMTg6XG4gICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIF9jYWxsZWUsIHRoaXMpO1xuICB9KSk7XG4gIHJldHVybiBfZmluZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufSIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IGZpbmRCeUlkO1xuXG52YXIgX2Rvd25sb2FkID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9kb3dubG9hZFwiKSk7XG5cbmZ1bmN0aW9uIGZpbmRCeUlkKGlkLCBvcHRpb25zKSB7XG4gIHJldHVybiAoMCwgX2Rvd25sb2FkLmRlZmF1bHQpKGlkLCBvcHRpb25zKTtcbn0iLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJjcmVhdGVcIiwge1xuICBlbnVtZXJhYmxlOiB0cnVlLFxuICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICByZXR1cm4gX2NyZWF0ZS5kZWZhdWx0O1xuICB9XG59KTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcImRvd25sb2FkXCIsIHtcbiAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgcmV0dXJuIF9kb3dubG9hZC5kZWZhdWx0O1xuICB9XG59KTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcImRvd25sb2FkQnlVcmxcIiwge1xuICBlbnVtZXJhYmxlOiB0cnVlLFxuICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICByZXR1cm4gX2Rvd25sb2FkQnlVcmwuZGVmYXVsdDtcbiAgfVxufSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJmaW5kXCIsIHtcbiAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgcmV0dXJuIF9maW5kLmRlZmF1bHQ7XG4gIH1cbn0pO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiZmluZEJ5SWRcIiwge1xuICBlbnVtZXJhYmxlOiB0cnVlLFxuICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICByZXR1cm4gX2ZpbmRCeUlkLmRlZmF1bHQ7XG4gIH1cbn0pO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwicmVtb3ZlXCIsIHtcbiAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgcmV0dXJuIF9yZW1vdmUuZGVmYXVsdDtcbiAgfVxufSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJyZW1vdmVCeUlkXCIsIHtcbiAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgcmV0dXJuIF9yZW1vdmVCeUlkLmRlZmF1bHQ7XG4gIH1cbn0pO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwic3RyZWFtXCIsIHtcbiAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgcmV0dXJuIF9zdHJlYW0uZGVmYXVsdDtcbiAgfVxufSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJ1cGRhdGVcIiwge1xuICBlbnVtZXJhYmxlOiB0cnVlLFxuICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICByZXR1cm4gX3VwZGF0ZS5kZWZhdWx0O1xuICB9XG59KTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcInVwbG9hZFwiLCB7XG4gIGVudW1lcmFibGU6IHRydWUsXG4gIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgIHJldHVybiBfdXBsb2FkLmRlZmF1bHQ7XG4gIH1cbn0pO1xuXG52YXIgX2NyZWF0ZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vY3JlYXRlXCIpKTtcblxudmFyIF9kb3dubG9hZCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vZG93bmxvYWRcIikpO1xuXG52YXIgX2Rvd25sb2FkQnlVcmwgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL2Rvd25sb2FkQnlVcmxcIikpO1xuXG52YXIgX2ZpbmQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL2ZpbmRcIikpO1xuXG52YXIgX2ZpbmRCeUlkID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9maW5kQnlJZFwiKSk7XG5cbnZhciBfcmVtb3ZlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9yZW1vdmVcIikpO1xuXG52YXIgX3JlbW92ZUJ5SWQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL3JlbW92ZUJ5SWRcIikpO1xuXG52YXIgX3N0cmVhbSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vc3RyZWFtXCIpKTtcblxudmFyIF91cGRhdGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL3VwZGF0ZVwiKSk7XG5cbnZhciBfdXBsb2FkID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi91cGxvYWRcIikpOyIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHJlbW92ZTtcblxudmFyIF9yZWdlbmVyYXRvciA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL3JlZ2VuZXJhdG9yXCIpKTtcblxudmFyIF9hc3luY1RvR2VuZXJhdG9yMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXN5bmNUb0dlbmVyYXRvclwiKSk7XG5cbnZhciBfa2ludmV5ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vZXJyb3JzL2tpbnZleVwiKSk7XG5cbmZ1bmN0aW9uIHJlbW92ZSgpIHtcbiAgcmV0dXJuIF9yZW1vdmUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cblxuZnVuY3Rpb24gX3JlbW92ZSgpIHtcbiAgX3JlbW92ZSA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gIC8qI19fUFVSRV9fKi9cbiAgX3JlZ2VuZXJhdG9yLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkge1xuICAgIHJldHVybiBfcmVnZW5lcmF0b3IuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7XG4gICAgICB3aGlsZSAoMSkge1xuICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7XG4gICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgdGhyb3cgbmV3IF9raW52ZXkuZGVmYXVsdCgnUGxlYXNlIHVzZSByZW1vdmVCeUlkKCkgdG8gcmVtb3ZlIGZpbGVzIG9uZSBieSBvbmUuJyk7XG5cbiAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIF9jYWxsZWUsIHRoaXMpO1xuICB9KSk7XG4gIHJldHVybiBfcmVtb3ZlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gcmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW50ZXJvcFJlcXVpcmVEZWZhdWx0XCIpO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gcmVtb3ZlQnlJZDtcblxudmFyIF9yZWdlbmVyYXRvciA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL3JlZ2VuZXJhdG9yXCIpKTtcblxudmFyIF9hc3luY1RvR2VuZXJhdG9yMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXN5bmNUb0dlbmVyYXRvclwiKSk7XG5cbnZhciBfdXRpbHMgPSByZXF1aXJlKFwiLi4vaHR0cC91dGlsc1wiKTtcblxudmFyIF9yZXF1ZXN0ID0gcmVxdWlyZShcIi4uL2h0dHAvcmVxdWVzdFwiKTtcblxudmFyIF9hdXRoID0gcmVxdWlyZShcIi4uL2h0dHAvYXV0aFwiKTtcblxudmFyIF9jb25maWcgPSByZXF1aXJlKFwiLi4va2ludmV5L2NvbmZpZ1wiKTtcblxudmFyIE5BTUVTUEFDRSA9ICdibG9iJztcblxuZnVuY3Rpb24gcmVtb3ZlQnlJZChfeCkge1xuICByZXR1cm4gX3JlbW92ZUJ5SWQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cblxuZnVuY3Rpb24gX3JlbW92ZUJ5SWQoKSB7XG4gIF9yZW1vdmVCeUlkID0gKDAsIF9hc3luY1RvR2VuZXJhdG9yMi5kZWZhdWx0KShcbiAgLyojX19QVVJFX18qL1xuICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoaWQpIHtcbiAgICB2YXIgb3B0aW9ucyxcbiAgICAgICAgX2dldENvbmZpZyxcbiAgICAgICAgYXBpUHJvdG9jb2wsXG4gICAgICAgIGFwaUhvc3QsXG4gICAgICAgIGFwcEtleSxcbiAgICAgICAgcmVxdWVzdCxcbiAgICAgICAgcmVzcG9uc2UsXG4gICAgICAgIF9hcmdzID0gYXJndW1lbnRzO1xuXG4gICAgcmV0dXJuIF9yZWdlbmVyYXRvci5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHtcbiAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHtcbiAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICBvcHRpb25zID0gX2FyZ3MubGVuZ3RoID4gMSAmJiBfYXJnc1sxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3NbMV0gOiB7fTtcbiAgICAgICAgICAgIF9nZXRDb25maWcgPSAoMCwgX2NvbmZpZy5nZXQpKCksIGFwaVByb3RvY29sID0gX2dldENvbmZpZy5hcGlQcm90b2NvbCwgYXBpSG9zdCA9IF9nZXRDb25maWcuYXBpSG9zdCwgYXBwS2V5ID0gX2dldENvbmZpZy5hcHBLZXk7XG4gICAgICAgICAgICByZXF1ZXN0ID0gbmV3IF9yZXF1ZXN0LktpbnZleVJlcXVlc3Qoe1xuICAgICAgICAgICAgICBtZXRob2Q6IF9yZXF1ZXN0LlJlcXVlc3RNZXRob2QuREVMRVRFLFxuICAgICAgICAgICAgICBhdXRoOiBfYXV0aC5BdXRoLkRlZmF1bHQsXG4gICAgICAgICAgICAgIHVybDogKDAsIF91dGlscy5mb3JtYXRLaW52ZXlVcmwpKGFwaVByb3RvY29sLCBhcGlIb3N0LCBcIi9cIi5jb25jYXQoTkFNRVNQQUNFLCBcIi9cIikuY29uY2F0KGFwcEtleSwgXCIvXCIpLmNvbmNhdChpZCkpLFxuICAgICAgICAgICAgICB0aW1lb3V0OiBvcHRpb25zLnRpbWVvdXRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDU7XG4gICAgICAgICAgICByZXR1cm4gcmVxdWVzdC5leGVjdXRlKCk7XG5cbiAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICByZXNwb25zZSA9IF9jb250ZXh0LnNlbnQ7XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KFwicmV0dXJuXCIsIHJlc3BvbnNlLmRhdGEpO1xuXG4gICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LCBfY2FsbGVlLCB0aGlzKTtcbiAgfSkpO1xuICByZXR1cm4gX3JlbW92ZUJ5SWQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn0iLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSBzdHJlYW07XG5cbnZhciBfcmVnZW5lcmF0b3IgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9yZWdlbmVyYXRvclwiKSk7XG5cbnZhciBfYXN5bmNUb0dlbmVyYXRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2FzeW5jVG9HZW5lcmF0b3JcIikpO1xuXG52YXIgX2ZpbmRCeUlkID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9maW5kQnlJZFwiKSk7XG5cbmZ1bmN0aW9uIHN0cmVhbShfeCwgX3gyKSB7XG4gIHJldHVybiBfc3RyZWFtLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5cbmZ1bmN0aW9uIF9zdHJlYW0oKSB7XG4gIF9zdHJlYW0gPSAoMCwgX2FzeW5jVG9HZW5lcmF0b3IyLmRlZmF1bHQpKFxuICAvKiNfX1BVUkVfXyovXG4gIF9yZWdlbmVyYXRvci5kZWZhdWx0Lm1hcmsoZnVuY3Rpb24gX2NhbGxlZShpZCwgb3B0aW9ucykge1xuICAgIHJldHVybiBfcmVnZW5lcmF0b3IuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7XG4gICAgICB3aGlsZSAoMSkge1xuICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7XG4gICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdChcInJldHVyblwiLCAoMCwgX2ZpbmRCeUlkLmRlZmF1bHQpKGlkLCBPYmplY3QuYXNzaWduKHt9LCBvcHRpb25zLCB7XG4gICAgICAgICAgICAgIHN0cmVhbTogdHJ1ZVxuICAgICAgICAgICAgfSkpKTtcblxuICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwgX2NhbGxlZSwgdGhpcyk7XG4gIH0pKTtcbiAgcmV0dXJuIF9zdHJlYW0uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn0iLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB1cGRhdGU7XG5cbnZhciBfcmVnZW5lcmF0b3IgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9yZWdlbmVyYXRvclwiKSk7XG5cbnZhciBfYXN5bmNUb0dlbmVyYXRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2FzeW5jVG9HZW5lcmF0b3JcIikpO1xuXG52YXIgX3VwbG9hZCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vdXBsb2FkXCIpKTtcblxuZnVuY3Rpb24gdXBkYXRlKF94LCBfeDIsIF94Mykge1xuICByZXR1cm4gX3VwZGF0ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuXG5mdW5jdGlvbiBfdXBkYXRlKCkge1xuICBfdXBkYXRlID0gKDAsIF9hc3luY1RvR2VuZXJhdG9yMi5kZWZhdWx0KShcbiAgLyojX19QVVJFX18qL1xuICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoZmlsZSwgbWV0YWRhdGEsIG9wdGlvbnMpIHtcbiAgICByZXR1cm4gX3JlZ2VuZXJhdG9yLmRlZmF1bHQud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkge1xuICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkge1xuICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoXCJyZXR1cm5cIiwgKDAsIF91cGxvYWQuZGVmYXVsdCkoZmlsZSwgbWV0YWRhdGEsIG9wdGlvbnMpKTtcblxuICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwgX2NhbGxlZSwgdGhpcyk7XG4gIH0pKTtcbiAgcmV0dXJuIF91cGRhdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn0iLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB1cGxvYWQ7XG5cbnZhciBfcmVnZW5lcmF0b3IgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9yZWdlbmVyYXRvclwiKSk7XG5cbnZhciBfYXN5bmNUb0dlbmVyYXRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2FzeW5jVG9HZW5lcmF0b3JcIikpO1xuXG52YXIgX3V0aWxzID0gcmVxdWlyZShcIi4uL2h0dHAvdXRpbHNcIik7XG5cbnZhciBfcmVxdWVzdCA9IHJlcXVpcmUoXCIuLi9odHRwL3JlcXVlc3RcIik7XG5cbnZhciBfYXV0aCA9IHJlcXVpcmUoXCIuLi9odHRwL2F1dGhcIik7XG5cbnZhciBfaGVhZGVycyA9IHJlcXVpcmUoXCIuLi9odHRwL2hlYWRlcnNcIik7XG5cbnZhciBfY29uZmlnID0gcmVxdWlyZShcIi4uL2tpbnZleS9jb25maWdcIik7XG5cbnZhciBfa2ludmV5ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vZXJyb3JzL2tpbnZleVwiKSk7XG5cbnZhciBOQU1FU1BBQ0UgPSAnYmxvYic7XG52YXIgTUFYX0JBQ0tPRkYgPSAzMiAqIDEwMDA7XG5cbmZ1bmN0aW9uIHRyYW5zZm9ybU1ldGFkYXRhKCkge1xuICB2YXIgZmlsZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307XG4gIHZhciBtZXRhZGF0YSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307XG4gIHZhciBmaWxlTWV0YWRhdGEgPSBPYmplY3QuYXNzaWduKHt9LCB7XG4gICAgZmlsZW5hbWU6IGZpbGUuX2ZpbGVuYW1lIHx8IGZpbGUubmFtZSxcbiAgICBwdWJsaWM6IGZhbHNlLFxuICAgIHNpemU6IGZpbGUuc2l6ZSB8fCBmaWxlLmxlbmd0aCxcbiAgICBtaW1lVHlwZTogZmlsZS5taW1lVHlwZSB8fCBmaWxlLnR5cGUgfHwgJ2FwcGxpY2F0aW9uL29jdGV0LXN0cmVhbSdcbiAgfSwgbWV0YWRhdGEpO1xuICBmaWxlTWV0YWRhdGEuX2ZpbGVuYW1lID0gbWV0YWRhdGEuZmlsZW5hbWU7XG4gIGRlbGV0ZSBmaWxlTWV0YWRhdGEuZmlsZW5hbWU7XG4gIGZpbGVNZXRhZGF0YS5fcHVibGljID0gbWV0YWRhdGEucHVibGljO1xuICBkZWxldGUgZmlsZU1ldGFkYXRhLnB1YmxpYztcbiAgcmV0dXJuIGZpbGVNZXRhZGF0YTtcbn1cblxuZnVuY3Rpb24gc2F2ZUZpbGVNZXRhZGF0YShfeCkge1xuICByZXR1cm4gX3NhdmVGaWxlTWV0YWRhdGEuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cblxuZnVuY3Rpb24gX3NhdmVGaWxlTWV0YWRhdGEoKSB7XG4gIF9zYXZlRmlsZU1ldGFkYXRhID0gKDAsIF9hc3luY1RvR2VuZXJhdG9yMi5kZWZhdWx0KShcbiAgLyojX19QVVJFX18qL1xuICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUobWV0YWRhdGEpIHtcbiAgICB2YXIgb3B0aW9ucyxcbiAgICAgICAgX2dldENvbmZpZyxcbiAgICAgICAgYXBpUHJvdG9jb2wsXG4gICAgICAgIGFwaUhvc3QsXG4gICAgICAgIGFwcEtleSxcbiAgICAgICAgcmVxdWVzdCxcbiAgICAgICAgcmVzcG9uc2UsXG4gICAgICAgIF9hcmdzID0gYXJndW1lbnRzO1xuXG4gICAgcmV0dXJuIF9yZWdlbmVyYXRvci5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHtcbiAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHtcbiAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICBvcHRpb25zID0gX2FyZ3MubGVuZ3RoID4gMSAmJiBfYXJnc1sxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3NbMV0gOiB7fTtcbiAgICAgICAgICAgIF9nZXRDb25maWcgPSAoMCwgX2NvbmZpZy5nZXQpKCksIGFwaVByb3RvY29sID0gX2dldENvbmZpZy5hcGlQcm90b2NvbCwgYXBpSG9zdCA9IF9nZXRDb25maWcuYXBpSG9zdCwgYXBwS2V5ID0gX2dldENvbmZpZy5hcHBLZXk7XG5cbiAgICAgICAgICAgIGlmICghKG1ldGFkYXRhLnNpemUgPD0gMCkpIHtcbiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDQ7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aHJvdyBuZXcgX2tpbnZleS5kZWZhdWx0KCdVbmFibGUgdG8gY3JlYXRlIGEgZmlsZSB3aXRoIGEgc2l6ZSBvZiAwLicpO1xuXG4gICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgcmVxdWVzdCA9IG5ldyBfcmVxdWVzdC5LaW52ZXlSZXF1ZXN0KHtcbiAgICAgICAgICAgICAgbWV0aG9kOiBtZXRhZGF0YS5faWQgPyBfcmVxdWVzdC5SZXF1ZXN0TWV0aG9kLlBVVCA6IF9yZXF1ZXN0LlJlcXVlc3RNZXRob2QuUE9TVCxcbiAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICdYLUtpbnZleS1Db250ZW50LVR5cGUnOiBtZXRhZGF0YS5taW1lVHlwZVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBhdXRoOiBfYXV0aC5BdXRoLkRlZmF1bHQsXG4gICAgICAgICAgICAgIHVybDogbWV0YWRhdGEuX2lkID8gKDAsIF91dGlscy5mb3JtYXRLaW52ZXlVcmwpKGFwaVByb3RvY29sLCBhcGlIb3N0LCBcIi9cIi5jb25jYXQoTkFNRVNQQUNFLCBcIi9cIikuY29uY2F0KGFwcEtleSwgXCIvXCIpLmNvbmNhdChtZXRhZGF0YS5faWQpKSA6ICgwLCBfdXRpbHMuZm9ybWF0S2ludmV5VXJsKShhcGlQcm90b2NvbCwgYXBpSG9zdCwgXCIvXCIuY29uY2F0KE5BTUVTUEFDRSwgXCIvXCIpLmNvbmNhdChhcHBLZXkpKSxcbiAgICAgICAgICAgICAgYm9keTogbWV0YWRhdGEsXG4gICAgICAgICAgICAgIHRpbWVvdXQ6IG9wdGlvbnMudGltZW91dFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNztcbiAgICAgICAgICAgIHJldHVybiByZXF1ZXN0LmV4ZWN1dGUoKTtcblxuICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgIHJlc3BvbnNlID0gX2NvbnRleHQuc2VudDtcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoXCJyZXR1cm5cIiwgcmVzcG9uc2UuZGF0YSk7XG5cbiAgICAgICAgICBjYXNlIDk6XG4gICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIF9jYWxsZWUsIHRoaXMpO1xuICB9KSk7XG4gIHJldHVybiBfc2F2ZUZpbGVNZXRhZGF0YS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuXG5mdW5jdGlvbiBjaGVja1VwbG9hZFN0YXR1cyh1cmwsIGhlYWRlcnMsIG1ldGFkYXRhLCB0aW1lb3V0KSB7XG4gIHZhciByZXF1ZXN0SGVhZGVycyA9IG5ldyBfaGVhZGVycy5IZWFkZXJzKGhlYWRlcnMpO1xuICByZXF1ZXN0SGVhZGVycy5zZXQoJ0NvbnRlbnQtVHlwZScsIG1ldGFkYXRhLm1pbWVUeXBlKTtcbiAgcmVxdWVzdEhlYWRlcnMuc2V0KCdDb250ZW50LVJhbmdlJywgXCJieXRlcyAqL1wiLmNvbmNhdChtZXRhZGF0YS5zaXplKSk7XG4gIHZhciByZXF1ZXN0ID0gbmV3IF9yZXF1ZXN0LlJlcXVlc3Qoe1xuICAgIG1ldGhvZDogX3JlcXVlc3QuUmVxdWVzdE1ldGhvZC5QVVQsXG4gICAgaGVhZGVyczogcmVxdWVzdEhlYWRlcnMsXG4gICAgdXJsOiB1cmwsXG4gICAgdGltZW91dDogdGltZW91dFxuICB9KTtcbiAgcmV0dXJuIHJlcXVlc3QuZXhlY3V0ZSgpO1xufVxuXG5mdW5jdGlvbiBnZXRTdGFydEluZGV4KHJhbmdlSGVhZGVyLCBtYXgpIHtcbiAgdmFyIHN0YXJ0ID0gcmFuZ2VIZWFkZXIgPyBwYXJzZUludChyYW5nZUhlYWRlci5zcGxpdCgnLScpWzFdLCAxMCkgKyAxIDogMDtcbiAgcmV0dXJuIHN0YXJ0ID49IG1heCA/IG1heCAtIDEgOiBzdGFydDtcbn1cblxuZnVuY3Rpb24gcmFuZG9tSW50KG1pbiwgbWF4KSB7XG4gIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAobWF4IC0gbWluKSkgKyBtaW47XG59XG5cbmZ1bmN0aW9uIHVwbG9hZEZpbGUoX3gyLCBfeDMsIF94NCkge1xuICByZXR1cm4gX3VwbG9hZEZpbGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cblxuZnVuY3Rpb24gX3VwbG9hZEZpbGUoKSB7XG4gIF91cGxvYWRGaWxlID0gKDAsIF9hc3luY1RvR2VuZXJhdG9yMi5kZWZhdWx0KShcbiAgLyojX19QVVJFX18qL1xuICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKHVybCwgZmlsZSwgbWV0YWRhdGEpIHtcbiAgICB2YXIgb3B0aW9ucyxcbiAgICAgICAgX29wdGlvbnMkY291bnQsXG4gICAgICAgIGNvdW50LFxuICAgICAgICBfb3B0aW9ucyRtYXhCYWNrb2ZmLFxuICAgICAgICBtYXhCYWNrb2ZmLFxuICAgICAgICBfb3B0aW9ucyRzdGFydCxcbiAgICAgICAgc3RhcnQsXG4gICAgICAgIHJlcXVlc3RIZWFkZXJzLFxuICAgICAgICByZXF1ZXN0LFxuICAgICAgICByZXNwb25zZSxcbiAgICAgICAgYmFja29mZixcbiAgICAgICAgX2FyZ3MyID0gYXJndW1lbnRzO1xuXG4gICAgcmV0dXJuIF9yZWdlbmVyYXRvci5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0Mikge1xuICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7XG4gICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgb3B0aW9ucyA9IF9hcmdzMi5sZW5ndGggPiAzICYmIF9hcmdzMlszXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3MyWzNdIDoge307XG4gICAgICAgICAgICBfb3B0aW9ucyRjb3VudCA9IG9wdGlvbnMuY291bnQsIGNvdW50ID0gX29wdGlvbnMkY291bnQgPT09IHZvaWQgMCA/IDAgOiBfb3B0aW9ucyRjb3VudCwgX29wdGlvbnMkbWF4QmFja29mZiA9IG9wdGlvbnMubWF4QmFja29mZiwgbWF4QmFja29mZiA9IF9vcHRpb25zJG1heEJhY2tvZmYgPT09IHZvaWQgMCA/IE1BWF9CQUNLT0ZGIDogX29wdGlvbnMkbWF4QmFja29mZjtcbiAgICAgICAgICAgIF9vcHRpb25zJHN0YXJ0ID0gb3B0aW9ucy5zdGFydCwgc3RhcnQgPSBfb3B0aW9ucyRzdGFydCA9PT0gdm9pZCAwID8gMCA6IF9vcHRpb25zJHN0YXJ0O1xuICAgICAgICAgICAgcmVxdWVzdEhlYWRlcnMgPSBuZXcgX2hlYWRlcnMuSGVhZGVycyhvcHRpb25zLmhlYWRlcnMpO1xuICAgICAgICAgICAgcmVxdWVzdEhlYWRlcnMuc2V0KCdDb250ZW50LVR5cGUnLCBtZXRhZGF0YS5taW1lVHlwZSk7XG4gICAgICAgICAgICByZXF1ZXN0SGVhZGVycy5zZXQoJ0NvbnRlbnQtUmFuZ2UnLCBcImJ5dGVzIFwiLmNvbmNhdChvcHRpb25zLnN0YXJ0LCBcIi1cIikuY29uY2F0KG1ldGFkYXRhLnNpemUgLSAxLCBcIi9cIikuY29uY2F0KG1ldGFkYXRhLnNpemUpKTtcbiAgICAgICAgICAgIHJlcXVlc3QgPSBuZXcgX3JlcXVlc3QuUmVxdWVzdCh7XG4gICAgICAgICAgICAgIG1ldGhvZDogX3JlcXVlc3QuUmVxdWVzdE1ldGhvZC5QVVQsXG4gICAgICAgICAgICAgIGhlYWRlcnM6IHJlcXVlc3RIZWFkZXJzLFxuICAgICAgICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICAgICAgYm9keTogZmlsZS5zbGljZShvcHRpb25zLnN0YXJ0LCBtZXRhZGF0YS5zaXplKSxcbiAgICAgICAgICAgICAgdGltZW91dDogb3B0aW9ucy50aW1lb3V0XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gOTtcbiAgICAgICAgICAgIHJldHVybiByZXF1ZXN0LmV4ZWN1dGUoKTtcblxuICAgICAgICAgIGNhc2UgOTpcbiAgICAgICAgICAgIHJlc3BvbnNlID0gX2NvbnRleHQyLnNlbnQ7XG5cbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5pc1N1Y2Nlc3MoKSkge1xuICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDE4O1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCEocmVzcG9uc2Uuc3RhdHVzQ29kZSA+PSA1MDAgJiYgcmVzcG9uc2Uuc3RhdHVzQ29kZSA8IDYwMCkpIHtcbiAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxNztcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGJhY2tvZmYgPSBNYXRoLnBvdygyLCBvcHRpb25zLmNvdW50KSArIHJhbmRvbUludCgxLCAxMDAxKTsgLy8gQ2FsY3VsYXRlIHRoZSBleHBvbmVudGlhbCBiYWNrb2ZmXG5cbiAgICAgICAgICAgIGlmICghKGJhY2tvZmYgPCBvcHRpb25zLm1heEJhY2tvZmYpKSB7XG4gICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTc7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDE2O1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XG4gICAgICAgICAgICAgIHNldFRpbWVvdXQocmVzb2x2ZSwgYmFja29mZik7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgIGNhc2UgMTY6XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdChcInJldHVyblwiLCB1cGxvYWRGaWxlKHVybCwgZmlsZSwgbWV0YWRhdGEsIHtcbiAgICAgICAgICAgICAgY291bnQ6IGNvdW50ICsgMSxcbiAgICAgICAgICAgICAgc3RhcnQ6IHN0YXJ0LFxuICAgICAgICAgICAgICBtYXhCYWNrb2ZmOiBtYXhCYWNrb2ZmXG4gICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgICBjYXNlIDE3OlxuICAgICAgICAgICAgdGhyb3cgcmVzcG9uc2UuZXJyb3I7XG5cbiAgICAgICAgICBjYXNlIDE4OlxuICAgICAgICAgICAgaWYgKCEocmVzcG9uc2Uuc3RhdHVzQ29kZSA9PT0gMzA4KSkge1xuICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDIxO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgc3RhcnQgPSBnZXRTdGFydEluZGV4KHJlc3BvbnNlLmhlYWRlcnMuZ2V0KCdSYW5nZScpLCBtZXRhZGF0YS5zaXplKTtcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KFwicmV0dXJuXCIsIHVwbG9hZEZpbGUodXJsLCBmaWxlLCBtZXRhZGF0YSwge1xuICAgICAgICAgICAgICBjb3VudDogMCxcbiAgICAgICAgICAgICAgc3RhcnQ6IHN0YXJ0LFxuICAgICAgICAgICAgICBtYXhCYWNrb2ZmOiBtYXhCYWNrb2ZmXG4gICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgICBjYXNlIDIxOlxuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoXCJyZXR1cm5cIiwgcmVzcG9uc2UuZGF0YSk7XG5cbiAgICAgICAgICBjYXNlIDIyOlxuICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwgX2NhbGxlZTIsIHRoaXMpO1xuICB9KSk7XG4gIHJldHVybiBfdXBsb2FkRmlsZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuXG5mdW5jdGlvbiB1cGxvYWQoKSB7XG4gIHJldHVybiBfdXBsb2FkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5cbmZ1bmN0aW9uIF91cGxvYWQoKSB7XG4gIF91cGxvYWQgPSAoMCwgX2FzeW5jVG9HZW5lcmF0b3IyLmRlZmF1bHQpKFxuICAvKiNfX1BVUkVfXyovXG4gIF9yZWdlbmVyYXRvci5kZWZhdWx0Lm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoKSB7XG4gICAgdmFyIGZpbGUsXG4gICAgICAgIG1ldGFkYXRhLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBmaWxlTWV0YWRhdGEsXG4gICAgICAgIGtpbnZleUZpbGUsXG4gICAgICAgIHVwbG9hZFN0YXR1c1Jlc3BvbnNlLFxuICAgICAgICB1cGxvYWRPcHRpb25zLFxuICAgICAgICBfYXJnczMgPSBhcmd1bWVudHM7XG4gICAgcmV0dXJuIF9yZWdlbmVyYXRvci5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0Mykge1xuICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7XG4gICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgZmlsZSA9IF9hcmdzMy5sZW5ndGggPiAwICYmIF9hcmdzM1swXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3MzWzBdIDoge307XG4gICAgICAgICAgICBtZXRhZGF0YSA9IF9hcmdzMy5sZW5ndGggPiAxICYmIF9hcmdzM1sxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3MzWzFdIDoge307XG4gICAgICAgICAgICBvcHRpb25zID0gX2FyZ3MzLmxlbmd0aCA+IDIgJiYgX2FyZ3MzWzJdICE9PSB1bmRlZmluZWQgPyBfYXJnczNbMl0gOiB7fTtcbiAgICAgICAgICAgIGZpbGVNZXRhZGF0YSA9IHRyYW5zZm9ybU1ldGFkYXRhKGZpbGUsIG1ldGFkYXRhKTtcbiAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gNjtcbiAgICAgICAgICAgIHJldHVybiBzYXZlRmlsZU1ldGFkYXRhKGZpbGVNZXRhZGF0YSwgb3B0aW9ucyk7XG5cbiAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICBraW52ZXlGaWxlID0gX2NvbnRleHQzLnNlbnQ7XG4gICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDk7XG4gICAgICAgICAgICByZXR1cm4gY2hlY2tVcGxvYWRTdGF0dXMoa2ludmV5RmlsZS5fdXBsb2FkVVJMLCBraW52ZXlGaWxlLl9yZXF1aXJlZEhlYWRlcnMsIGZpbGVNZXRhZGF0YSwgb3B0aW9ucy50aW1lb3V0KTtcblxuICAgICAgICAgIGNhc2UgOTpcbiAgICAgICAgICAgIHVwbG9hZFN0YXR1c1Jlc3BvbnNlID0gX2NvbnRleHQzLnNlbnQ7XG5cbiAgICAgICAgICAgIGlmICh1cGxvYWRTdGF0dXNSZXNwb25zZS5pc1N1Y2Nlc3MoKSkge1xuICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDEyO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhyb3cgdXBsb2FkU3RhdHVzUmVzcG9uc2UuZXJyb3I7XG5cbiAgICAgICAgICBjYXNlIDEyOlxuICAgICAgICAgICAgaWYgKCEodXBsb2FkU3RhdHVzUmVzcG9uc2Uuc3RhdHVzQ29kZSAhPT0gMjAwICYmIHVwbG9hZFN0YXR1c1Jlc3BvbnNlLnN0YXR1c0NvZGUgIT09IDIwMSkpIHtcbiAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAxODtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICghKHVwbG9hZFN0YXR1c1Jlc3BvbnNlLnN0YXR1c0NvZGUgIT09IDMwOCkpIHtcbiAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAxNTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRocm93IG5ldyBfa2ludmV5LmRlZmF1bHQoJ1VuZXhwZWN0ZWQgcmVzcG9uc2UgZm9yIHVwbG9hZCBmaWxlIHN0YXR1cyBjaGVjayByZXF1ZXN0LicpO1xuXG4gICAgICAgICAgY2FzZSAxNTpcbiAgICAgICAgICAgIHVwbG9hZE9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgIHN0YXJ0OiBnZXRTdGFydEluZGV4KHVwbG9hZFN0YXR1c1Jlc3BvbnNlLmhlYWRlcnMuZ2V0KCdSYW5nZScpLCBtZXRhZGF0YS5zaXplKSxcbiAgICAgICAgICAgICAgdGltZW91dDogb3B0aW9ucy50aW1lb3V0LFxuICAgICAgICAgICAgICBtYXhCYWNrb2ZmOiBvcHRpb25zLm1heEJhY2tvZmYsXG4gICAgICAgICAgICAgIGhlYWRlcnM6IGtpbnZleUZpbGUuX3JlcXVpcmVkSGVhZGVyc1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMTg7XG4gICAgICAgICAgICByZXR1cm4gdXBsb2FkRmlsZShraW52ZXlGaWxlLl91cGxvYWRVUkwsIGZpbGUsIGZpbGVNZXRhZGF0YSwgdXBsb2FkT3B0aW9ucyk7XG5cbiAgICAgICAgICBjYXNlIDE4OlxuICAgICAgICAgICAgZGVsZXRlIGtpbnZleUZpbGUuX2V4cGlyZXNBdDtcbiAgICAgICAgICAgIGRlbGV0ZSBraW52ZXlGaWxlLl9yZXF1aXJlZEhlYWRlcnM7XG4gICAgICAgICAgICBkZWxldGUga2ludmV5RmlsZS5fdXBsb2FkVVJMO1xuICAgICAgICAgICAga2ludmV5RmlsZS5fZGF0YSA9IGZpbGU7XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdChcInJldHVyblwiLCBraW52ZXlGaWxlKTtcblxuICAgICAgICAgIGNhc2UgMjM6XG4gICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LCBfY2FsbGVlMywgdGhpcyk7XG4gIH0pKTtcbiAgcmV0dXJuIF91cGxvYWQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn0iLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmFwcCA9IGFwcDtcbmV4cG9ydHMubWFzdGVyID0gbWFzdGVyO1xuZXhwb3J0cy5zZXNzaW9uID0gc2Vzc2lvbjtcbmV4cG9ydHMuYmFzaWMgPSBiYXNpYztcbmV4cG9ydHMuZGVmYXVsdEF1dGggPSBkZWZhdWx0QXV0aDtcbmV4cG9ydHMuYWxsID0gYWxsO1xuZXhwb3J0cy5BdXRoID0gdm9pZCAwO1xuXG52YXIgX2pzQmFzZSA9IHJlcXVpcmUoXCJqcy1iYXNlNjRcIik7XG5cbnZhciBfYWN0aXZlVXNlciA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uL2Vycm9ycy9hY3RpdmVVc2VyXCIpKTtcblxuZnVuY3Rpb24gYXBwKGFwcEtleSwgYXBwU2VjcmV0KSB7XG4gIHZhciBjcmVkZW50aWFscyA9IF9qc0Jhc2UuQmFzZTY0LmVuY29kZShcIlwiLmNvbmNhdChhcHBLZXksIFwiOlwiKS5jb25jYXQoYXBwU2VjcmV0KSk7XG5cbiAgcmV0dXJuIFwiQmFzaWMgXCIuY29uY2F0KGNyZWRlbnRpYWxzKTtcbn1cblxuZnVuY3Rpb24gbWFzdGVyKGFwcEtleSwgbWFzdGVyU2VjcmV0KSB7XG4gIHZhciBjcmVkZW50aWFscyA9IF9qc0Jhc2UuQmFzZTY0LmVuY29kZShcIlwiLmNvbmNhdChhcHBLZXksIFwiOlwiKS5jb25jYXQobWFzdGVyU2VjcmV0KSk7XG5cbiAgcmV0dXJuIFwiQmFzaWMgXCIuY29uY2F0KGNyZWRlbnRpYWxzKTtcbn1cblxuZnVuY3Rpb24gc2Vzc2lvbihzZXNzaW9uKSB7XG4gIGlmICghc2Vzc2lvbiB8fCAhc2Vzc2lvbi5fa21kIHx8ICFzZXNzaW9uLl9rbWQuYXV0aHRva2VuKSB7XG4gICAgdGhyb3cgbmV3IF9hY3RpdmVVc2VyLmRlZmF1bHQoJ1RoZXJlIGlzIG5vIGFjdGl2ZSB1c2VyIHRvIGF1dGhvcml6ZSB0aGUgcmVxdWVzdC4gUGxlYXNlIGxvZ2luIGFuZCByZXRyeSB0aGUgcmVxdWVzdC4nKTtcbiAgfVxuXG4gIHJldHVybiBcIktpbnZleSBcIi5jb25jYXQoc2Vzc2lvbi5fa21kLmF1dGh0b2tlbik7XG59XG5cbmZ1bmN0aW9uIGJhc2ljKGFwcEtleSwgYXBwU2VjcmV0LCBtYXN0ZXJTZWNyZXQpIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gYXBwKGFwcEtleSwgYXBwU2VjcmV0KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4gbWFzdGVyKGFwcEtleSwgbWFzdGVyU2VjcmV0KTtcbiAgfVxufVxuXG5mdW5jdGlvbiBkZWZhdWx0QXV0aChfc2Vzc2lvbiwgYXBwS2V5LCBtYXN0ZXJTZWNyZXQpIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gc2Vzc2lvbihfc2Vzc2lvbik7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIG1hc3RlcihhcHBLZXksIG1hc3RlclNlY3JldCk7XG4gIH1cbn1cblxuZnVuY3Rpb24gYWxsKF9zZXNzaW9uLCBhcHBLZXksIGFwcFNlY3JldCwgbWFzdGVyU2VjcmV0KSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIHNlc3Npb24oX3Nlc3Npb24pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiBiYXNpYyhhcHBLZXksIGFwcFNlY3JldCwgbWFzdGVyU2VjcmV0KTtcbiAgfVxufVxuXG52YXIgQXV0aCA9IHtcbiAgQWxsOiAnQWxsJyxcbiAgQXBwOiAnQXBwJyxcbiAgQmFzaWM6ICdCYXNpYycsXG4gIERlZmF1bHQ6ICdEZWZhdWx0JyxcbiAgTWFzdGVyOiAnTWFzdGVyJyxcbiAgU2Vzc2lvbjogJ1Nlc3Npb24nXG59O1xuZXhwb3J0cy5BdXRoID0gQXV0aDsiLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLktpbnZleUhlYWRlcnMgPSBleHBvcnRzLkhlYWRlcnMgPSB2b2lkIDA7XG5cbnZhciBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm5cIikpO1xuXG52YXIgX2dldFByb3RvdHlwZU9mMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZ2V0UHJvdG90eXBlT2ZcIikpO1xuXG52YXIgX2luaGVyaXRzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW5oZXJpdHNcIikpO1xuXG52YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2tcIikpO1xuXG52YXIgX2NyZWF0ZUNsYXNzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3NcIikpO1xuXG52YXIgX2lzQXJyYXkgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJsb2Rhc2gvaXNBcnJheVwiKSk7XG5cbnZhciBfaXNTdHJpbmcgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJsb2Rhc2gvaXNTdHJpbmdcIikpO1xuXG52YXIgX2lzRnVuY3Rpb24gPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJsb2Rhc2gvaXNGdW5jdGlvblwiKSk7XG5cbnZhciBfaXNFbXB0eSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcImxvZGFzaC9pc0VtcHR5XCIpKTtcblxudmFyIF9raW52ZXkgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi9lcnJvcnMva2ludmV5XCIpKTtcblxudmFyIFhfS0lOVkVZX1JFUVVFU1RfU1RBUlRfSEVBREVSID0gJ1gtS2ludmV5LVJlcXVlc3QtU3RhcnQnO1xudmFyIFhfS0lOVkVZX0NVU1RPTV9SRVFVRVNUX1BST1BFUlRJRVNfSEVBREVSID0gJ1gtS2ludmV5LUN1c3RvbS1SZXF1ZXN0LVByb3BlcnRpZXMnO1xuXG5mdW5jdGlvbiBpc05vdFN0cmluZyh2YWwpIHtcbiAgcmV0dXJuICEoMCwgX2lzU3RyaW5nLmRlZmF1bHQpKHZhbCk7XG59XG5cbnZhciBIZWFkZXJzID1cbi8qI19fUFVSRV9fKi9cbmZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gSGVhZGVycyhoZWFkZXJzKSB7XG4gICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgICgwLCBfY2xhc3NDYWxsQ2hlY2syLmRlZmF1bHQpKHRoaXMsIEhlYWRlcnMpO1xuICAgIHRoaXMuaGVhZGVycyA9IG5ldyBNYXAoKTtcbiAgICB0aGlzLm5vcm1hbGl6ZWROYW1lcyA9IG5ldyBNYXAoKTtcblxuICAgIGlmIChoZWFkZXJzKSB7XG4gICAgICBpZiAoaGVhZGVycyBpbnN0YW5jZW9mIEhlYWRlcnMpIHtcbiAgICAgICAgaGVhZGVycy5rZXlzKCkuZm9yRWFjaChmdW5jdGlvbiAoaGVhZGVyKSB7XG4gICAgICAgICAgdmFyIHZhbHVlID0gaGVhZGVycy5nZXQoaGVhZGVyKTtcblxuICAgICAgICAgIF90aGlzLnNldChoZWFkZXIsIHZhbHVlKTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBPYmplY3Qua2V5cyhoZWFkZXJzKS5mb3JFYWNoKGZ1bmN0aW9uIChoZWFkZXIpIHtcbiAgICAgICAgICB2YXIgdmFsdWUgPSBoZWFkZXJzW2hlYWRlcl07XG5cbiAgICAgICAgICBfdGhpcy5zZXQoaGVhZGVyLCB2YWx1ZSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gICgwLCBfY3JlYXRlQ2xhc3MyLmRlZmF1bHQpKEhlYWRlcnMsIFt7XG4gICAga2V5OiBcImhhc1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBoYXMobmFtZSkge1xuICAgICAgaWYgKCEoMCwgX2lzU3RyaW5nLmRlZmF1bHQpKG5hbWUpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignUGxlYXNlIHByb3ZpZGUgYSBuYW1lLiBOYW1lIG11c3QgYmUgYSBzdHJpbmcuJyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLmhlYWRlcnMuaGFzKG5hbWUudG9Mb3dlckNhc2UoKSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImdldFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBnZXQobmFtZSkge1xuICAgICAgaWYgKCEoMCwgX2lzU3RyaW5nLmRlZmF1bHQpKG5hbWUpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignUGxlYXNlIHByb3ZpZGUgYSBuYW1lLiBOYW1lIG11c3QgYmUgYSBzdHJpbmcuJyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLmhlYWRlcnMuZ2V0KG5hbWUudG9Mb3dlckNhc2UoKSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImtleXNcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24ga2V5cygpIHtcbiAgICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMubm9ybWFsaXplZE5hbWVzLnZhbHVlcygpKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwic2V0XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHNldChuYW1lLCB2YWx1ZSkge1xuICAgICAgaWYgKCEoMCwgX2lzU3RyaW5nLmRlZmF1bHQpKG5hbWUpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignUGxlYXNlIHByb3ZpZGUgYSBuYW1lLiBOYW1lIG11c3QgYmUgYSBzdHJpbmcuJyk7XG4gICAgICB9XG5cbiAgICAgIGlmICghKDAsIF9pc1N0cmluZy5kZWZhdWx0KSh2YWx1ZSkgJiYgISgwLCBfaXNBcnJheS5kZWZhdWx0KSh2YWx1ZSkgJiYgISgwLCBfaXNGdW5jdGlvbi5kZWZhdWx0KSh2YWx1ZSkgfHwgKDAsIF9pc0FycmF5LmRlZmF1bHQpKHZhbHVlKSAmJiB2YWx1ZS5zb21lKGlzTm90U3RyaW5nKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1BsZWFzZSBwcm92aWRlIGEgdmFsdWUuIFZhbHVlIG11c3QgYmUgYSBzdHJpbmcgb3IgYW4gYXJyYXkgdGhhdCBjb250YWlucyBvbmx5IHN0cmluZ3MuJyk7XG4gICAgICB9XG5cbiAgICAgIHZhciBrZXkgPSBuYW1lLnRvTG93ZXJDYXNlKCk7XG5cbiAgICAgIGlmICgoMCwgX2lzQXJyYXkuZGVmYXVsdCkodmFsdWUpKSB7XG4gICAgICAgIHRoaXMuaGVhZGVycy5zZXQoa2V5LCB2YWx1ZS5qb2luKCcsJykpO1xuICAgICAgfSBlbHNlIGlmICgoMCwgX2lzRnVuY3Rpb24uZGVmYXVsdCkodmFsdWUpKSB7XG4gICAgICAgIHZhciB2YWwgPSB2YWx1ZSgpO1xuICAgICAgICByZXR1cm4gdGhpcy5zZXQobmFtZSwgdmFsKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuaGVhZGVycy5zZXQoa2V5LCB2YWx1ZSk7XG4gICAgICB9XG5cbiAgICAgIGlmICghdGhpcy5ub3JtYWxpemVkTmFtZXMuaGFzKGtleSkpIHtcbiAgICAgICAgdGhpcy5ub3JtYWxpemVkTmFtZXMuc2V0KGtleSwgbmFtZSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJqb2luXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGpvaW4oaGVhZGVycykge1xuICAgICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICAgIGlmIChoZWFkZXJzIGluc3RhbmNlb2YgSGVhZGVycykge1xuICAgICAgICBoZWFkZXJzLmtleXMoKS5mb3JFYWNoKGZ1bmN0aW9uIChoZWFkZXIpIHtcbiAgICAgICAgICB2YXIgdmFsdWUgPSBoZWFkZXJzLmdldChoZWFkZXIpO1xuXG4gICAgICAgICAgX3RoaXMyLnNldChoZWFkZXIsIHZhbHVlKTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBPYmplY3Qua2V5cyhoZWFkZXJzKS5mb3JFYWNoKGZ1bmN0aW9uIChoZWFkZXIpIHtcbiAgICAgICAgICB2YXIgdmFsdWUgPSBoZWFkZXJzW2hlYWRlcl07XG5cbiAgICAgICAgICBfdGhpczIuc2V0KGhlYWRlciwgdmFsdWUpO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImRlbGV0ZVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBfZGVsZXRlKG5hbWUpIHtcbiAgICAgIGlmICghKDAsIF9pc1N0cmluZy5kZWZhdWx0KShuYW1lKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1BsZWFzZSBwcm92aWRlIGEgbmFtZS4gTmFtZSBtdXN0IGJlIGEgc3RyaW5nLicpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcy5oZWFkZXJzLmRlbGV0ZShuYW1lLnRvTG93ZXJDYXNlKCkpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJ0b09iamVjdFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiB0b09iamVjdCgpIHtcbiAgICAgIHZhciBfdGhpczMgPSB0aGlzO1xuXG4gICAgICByZXR1cm4gdGhpcy5rZXlzKCkucmVkdWNlKGZ1bmN0aW9uIChoZWFkZXJzLCBoZWFkZXIpIHtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXBhcmFtLXJlYXNzaWduXG4gICAgICAgIGhlYWRlcnNbaGVhZGVyXSA9IF90aGlzMy5nZXQoaGVhZGVyKTtcbiAgICAgICAgcmV0dXJuIGhlYWRlcnM7XG4gICAgICB9LCB7fSk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImNvbnRlbnRUeXBlXCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICByZXR1cm4gdGhpcy5nZXQoJ0NvbnRlbnQtVHlwZScpO1xuICAgIH1cbiAgfV0pO1xuICByZXR1cm4gSGVhZGVycztcbn0oKTtcblxuZXhwb3J0cy5IZWFkZXJzID0gSGVhZGVycztcblxuZnVuY3Rpb24gYnl0ZUNvdW50KHN0cikge1xuICBpZiAoc3RyKSB7XG4gICAgdmFyIGNvdW50ID0gMDtcbiAgICB2YXIgc3RyaW5nTGVuZ3RoID0gc3RyLmxlbmd0aDtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3RyaW5nTGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgIHZhciBwYXJ0Q291bnQgPSBlbmNvZGVVUkkoc3RyW2ldKS5zcGxpdCgnJScpLmxlbmd0aDtcbiAgICAgIGNvdW50ICs9IHBhcnRDb3VudCA9PT0gMSA/IDEgOiBwYXJ0Q291bnQgLSAxO1xuICAgIH1cblxuICAgIHJldHVybiBjb3VudDtcbiAgfVxuXG4gIHJldHVybiAwO1xufVxuXG52YXIgS2ludmV5SGVhZGVycyA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoX0hlYWRlcnMpIHtcbiAgKDAsIF9pbmhlcml0czIuZGVmYXVsdCkoS2ludmV5SGVhZGVycywgX0hlYWRlcnMpO1xuXG4gIGZ1bmN0aW9uIEtpbnZleUhlYWRlcnMoaGVhZGVycykge1xuICAgIHZhciBfdGhpczQ7XG5cbiAgICAoMCwgX2NsYXNzQ2FsbENoZWNrMi5kZWZhdWx0KSh0aGlzLCBLaW52ZXlIZWFkZXJzKTtcbiAgICBfdGhpczQgPSAoMCwgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yLmRlZmF1bHQpKHRoaXMsICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKEtpbnZleUhlYWRlcnMpLmNhbGwodGhpcywgaGVhZGVycykpOyAvLyBBZGQgdGhlIEFjY2VwdCBoZWFkZXJcblxuICAgIGlmICghX3RoaXM0LmhhcygnQWNjZXB0JykpIHtcbiAgICAgIF90aGlzNC5zZXQoJ0FjY2VwdCcsICdhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PXV0Zi04Jyk7XG4gICAgfSAvLyBBZGQgQ29udGVudC1UeXBlIGhlYWRlclxuXG5cbiAgICBpZiAoIV90aGlzNC5oYXMoJ0NvbnRlbnQtVHlwZScpKSB7XG4gICAgICBfdGhpczQuc2V0KCdDb250ZW50LVR5cGUnLCAnYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD11dGYtOCcpO1xuICAgIH0gLy8gQWRkIHRoZSBYLUtpbnZleS1BUEktVmVyc2lvbiBoZWFkZXJcblxuXG4gICAgaWYgKCFfdGhpczQuaGFzKCdYLUtpbnZleS1BcGktVmVyc2lvbicpKSB7XG4gICAgICBfdGhpczQuc2V0KCdYLUtpbnZleS1BcGktVmVyc2lvbicsICc0Jyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIF90aGlzNDtcbiAgfVxuXG4gICgwLCBfY3JlYXRlQ2xhc3MyLmRlZmF1bHQpKEtpbnZleUhlYWRlcnMsIFt7XG4gICAga2V5OiBcInJlcXVlc3RTdGFydFwiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0KFhfS0lOVkVZX1JFUVVFU1RfU1RBUlRfSEVBREVSKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiY3VzdG9tUmVxdWVzdFByb3BlcnRpZXNcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLmdldChYX0tJTlZFWV9DVVNUT01fUkVRVUVTVF9QUk9QRVJUSUVTX0hFQURFUik7XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uIHNldChwcm9wZXJ0aWVzKSB7XG4gICAgICB2YXIgY3VzdG9tUmVxdWVzdFByb3BlcnRpZXNWYWwgPSBKU09OLnN0cmluZ2lmeShwcm9wZXJ0aWVzKTtcblxuICAgICAgaWYgKCEoMCwgX2lzRW1wdHkuZGVmYXVsdCkoY3VzdG9tUmVxdWVzdFByb3BlcnRpZXNWYWwpKSB7XG4gICAgICAgIHZhciBjdXN0b21SZXF1ZXN0UHJvcGVydGllc0J5dGVDb3VudCA9IGJ5dGVDb3VudChjdXN0b21SZXF1ZXN0UHJvcGVydGllc1ZhbCk7XG5cbiAgICAgICAgaWYgKGN1c3RvbVJlcXVlc3RQcm9wZXJ0aWVzQnl0ZUNvdW50ID49IDIwMDApIHtcbiAgICAgICAgICB0aHJvdyBuZXcgX2tpbnZleS5kZWZhdWx0KFwiVGhlIGN1c3RvbSBwcm9wZXJ0aWVzIGFyZSBcIi5jb25jYXQoY3VzdG9tUmVxdWVzdFByb3BlcnRpZXNCeXRlQ291bnQsIFwiIGJ5dGVzLlwiKSArICdJdCBtdXN0IGJlIGxlc3MgdGhlbiAyMDAwIGJ5dGVzLicsICdQbGVhc2UgcmVtb3ZlIHNvbWUgY3VzdG9tIHByb3BlcnRpZXMuJyk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnNldChYX0tJTlZFWV9DVVNUT01fUkVRVUVTVF9QUk9QRVJUSUVTX0hFQURFUiwgY3VzdG9tUmVxdWVzdFByb3BlcnRpZXNWYWwpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5kZWxldGUoJ1gtS2ludmV5LUN1c3RvbS1SZXF1ZXN0LVByb3BlcnRpZXMnKTtcbiAgICAgIH1cbiAgICB9XG4gIH1dKTtcbiAgcmV0dXJuIEtpbnZleUhlYWRlcnM7XG59KEhlYWRlcnMpO1xuXG5leHBvcnRzLktpbnZleUhlYWRlcnMgPSBLaW52ZXlIZWFkZXJzOyIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IGh0dHA7XG5cbnZhciBfcmVnZW5lcmF0b3IgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9yZWdlbmVyYXRvclwiKSk7XG5cbnZhciBfYXN5bmNUb0dlbmVyYXRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2FzeW5jVG9HZW5lcmF0b3JcIikpO1xuXG52YXIgX2F4aW9zID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiYXhpb3NcIikpO1xuXG52YXIgX3RpbWVvdXQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi9lcnJvcnMvdGltZW91dFwiKSk7XG5cbnZhciBfbmV0d29ya0Nvbm5lY3Rpb24gPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi9lcnJvcnMvbmV0d29ya0Nvbm5lY3Rpb25cIikpO1xuXG5mdW5jdGlvbiBodHRwKF94KSB7XG4gIHJldHVybiBfaHR0cC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuXG5mdW5jdGlvbiBfaHR0cCgpIHtcbiAgX2h0dHAgPSAoMCwgX2FzeW5jVG9HZW5lcmF0b3IyLmRlZmF1bHQpKFxuICAvKiNfX1BVUkVfXyovXG4gIF9yZWdlbmVyYXRvci5kZWZhdWx0Lm1hcmsoZnVuY3Rpb24gX2NhbGxlZShyZXF1ZXN0KSB7XG4gICAgdmFyIHJlc3BvbnNlO1xuICAgIHJldHVybiBfcmVnZW5lcmF0b3IuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7XG4gICAgICB3aGlsZSAoMSkge1xuICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7XG4gICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDA7XG4gICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMztcbiAgICAgICAgICAgIHJldHVybiAoMCwgX2F4aW9zLmRlZmF1bHQpKHtcbiAgICAgICAgICAgICAgaGVhZGVyczogcmVxdWVzdC5oZWFkZXJzLFxuICAgICAgICAgICAgICBtZXRob2Q6IHJlcXVlc3QubWV0aG9kLFxuICAgICAgICAgICAgICB1cmw6IHJlcXVlc3QudXJsLFxuICAgICAgICAgICAgICBkYXRhOiByZXF1ZXN0LmJvZHksXG4gICAgICAgICAgICAgIHRpbWVvdXQ6IHJlcXVlc3QudGltZW91dFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICByZXNwb25zZSA9IF9jb250ZXh0LnNlbnQ7XG4gICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjM7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSA2O1xuICAgICAgICAgICAgX2NvbnRleHQudDAgPSBfY29udGV4dFtcImNhdGNoXCJdKDApO1xuXG4gICAgICAgICAgICBpZiAoIV9jb250ZXh0LnQwLnJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMjtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcmVmZXItZGVzdHJ1Y3R1cmluZ1xuICAgICAgICAgICAgcmVzcG9uc2UgPSBfY29udGV4dC50MC5yZXNwb25zZTtcbiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyMztcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSAxMjpcbiAgICAgICAgICAgIGlmICghX2NvbnRleHQudDAucmVxdWVzdCkge1xuICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjI7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIShfY29udGV4dC50MC5jb2RlID09PSAnRVNPQ0tFVFRJTUVET1VUJyB8fCBfY29udGV4dC50MC5jb2RlID09PSAnRVRJTUVET1VUJyB8fCBfY29udGV4dC50MC5jb2RlID09PSAnRUNPTk5BQk9SVEVEJykpIHtcbiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE3O1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhyb3cgbmV3IF90aW1lb3V0LmRlZmF1bHQoJ1RoZSBuZXR3b3JrIHJlcXVlc3QgdGltZWQgb3V0LicpO1xuXG4gICAgICAgICAgY2FzZSAxNzpcbiAgICAgICAgICAgIGlmICghKF9jb250ZXh0LnQwLmNvZGUgPT09ICdFTk9FTlQnKSkge1xuICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTk7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aHJvdyBuZXcgX25ldHdvcmtDb25uZWN0aW9uLmRlZmF1bHQoJ1lvdSBkbyBub3QgaGF2ZSBhIG5ldHdvcmsgY29ubmVjdGlvbi4nKTtcblxuICAgICAgICAgIGNhc2UgMTk6XG4gICAgICAgICAgICB0aHJvdyBfY29udGV4dC50MDtcblxuICAgICAgICAgIGNhc2UgMjI6XG4gICAgICAgICAgICB0aHJvdyBfY29udGV4dC50MDtcblxuICAgICAgICAgIGNhc2UgMjM6XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KFwicmV0dXJuXCIsIHtcbiAgICAgICAgICAgICAgc3RhdHVzQ29kZTogcmVzcG9uc2Uuc3RhdHVzLFxuICAgICAgICAgICAgICBoZWFkZXJzOiByZXNwb25zZS5oZWFkZXJzLFxuICAgICAgICAgICAgICBkYXRhOiByZXNwb25zZS5kYXRhXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgIGNhc2UgMjQ6XG4gICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIF9jYWxsZWUsIHRoaXMsIFtbMCwgNl1dKTtcbiAgfSkpO1xuICByZXR1cm4gX2h0dHAuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cblxuZnVuY3Rpb24gYnJvd3NlckRldGVjdCh1YSkge1xuICAvLyBDYXN0IGFyZ3VtZW50cy5cbiAgdmFyIHVzZXJBZ2VudCA9IHVhLnRvTG93ZXJDYXNlKCk7IC8vIFVzZXItQWdlbnQgcGF0dGVybnMuXG5cbiAgdmFyIHJDaHJvbWUgPSAvKGNocm9tZSlcXC8oW1xcd10rKS87XG4gIHZhciByRmlyZWZveCA9IC8oZmlyZWZveClcXC8oW1xcdy5dKykvO1xuICB2YXIgcklFID0gLyhtc2llKSAoW1xcdy5dKykvaTtcbiAgdmFyIHJPcGVyYSA9IC8ob3BlcmEpKD86Lip2ZXJzaW9uKT9bIC9dKFtcXHcuXSspLztcbiAgdmFyIHJTYWZhcmkgPSAvKHNhZmFyaSlcXC8oW1xcdy5dKykvO1xuICByZXR1cm4gckNocm9tZS5leGVjKHVzZXJBZ2VudCkgfHwgckZpcmVmb3guZXhlYyh1c2VyQWdlbnQpIHx8IHJJRS5leGVjKHVzZXJBZ2VudCkgfHwgck9wZXJhLmV4ZWModXNlckFnZW50KSB8fCByU2FmYXJpLmV4ZWModXNlckFnZW50KSB8fCBbXTtcbn1cblxuZnVuY3Rpb24gZGV2aWNlSW5mb3JtYXRpb24oKSB7XG4gIHZhciBzZGtJbmZvID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTtcbiAgdmFyIF9zZGtJbmZvJG5hbWUgPSBzZGtJbmZvLm5hbWUsXG4gICAgICBuYW1lID0gX3Nka0luZm8kbmFtZSA9PT0gdm9pZCAwID8gJ1NESyB1bmtub3duIChraW52ZXktaHR0cC13ZWIpJyA6IF9zZGtJbmZvJG5hbWUsXG4gICAgICBfc2RrSW5mbyR2ZXJzaW9uID0gc2RrSW5mby52ZXJzaW9uLFxuICAgICAgdmVyc2lvbiA9IF9zZGtJbmZvJHZlcnNpb24gPT09IHZvaWQgMCA/ICd1bmtub3duJyA6IF9zZGtJbmZvJHZlcnNpb247XG4gIHZhciBsaWJyYXJpZXMgPSBbXTtcbiAgdmFyIGJyb3dzZXI7XG4gIHZhciBwbGF0Zm9ybTtcbiAgdmFyIGJyb3dzZXJWZXJzaW9uO1xuICB2YXIgbWFudWZhY3R1cmVyOyAvLyBEZWZhdWx0IHBsYXRmb3JtLCBtb3N0IGxpa2VseSB0aGlzIGlzIGp1c3QgYSBwbGFpbiB3ZWIgYXBwLlxuXG4gIGlmICgocGxhdGZvcm0gPT09IG51bGwgfHwgcGxhdGZvcm0gPT09IHVuZGVmaW5lZCkgJiYgd2luZG93Lm5hdmlnYXRvcikge1xuICAgIGJyb3dzZXIgPSBicm93c2VyRGV0ZWN0KHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50KTtcbiAgICBwbGF0Zm9ybSA9IGJyb3dzZXJbMV07IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgcHJlZmVyLWRlc3RydWN0dXJpbmdcblxuICAgIGJyb3dzZXJWZXJzaW9uID0gYnJvd3NlclsyXTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBwcmVmZXItZGVzdHJ1Y3R1cmluZ1xuXG4gICAgbWFudWZhY3R1cmVyID0gd2luZG93Lm5hdmlnYXRvci5wbGF0Zm9ybTtcbiAgfSAvLyBMaWJyYXJpZXMuXG5cblxuICBpZiAod2luZG93LmFuZ3VsYXIgIT09IHVuZGVmaW5lZCkge1xuICAgIC8vIEFuZ3VsYXJKUy5cbiAgICBsaWJyYXJpZXMucHVzaChcImFuZ3VsYXJqcy9cIi5jb25jYXQod2luZG93LmFuZ3VsYXIudmVyc2lvbi5mdWxsKSk7XG4gIH1cblxuICBpZiAod2luZG93LkJhY2tib25lICE9PSB1bmRlZmluZWQpIHtcbiAgICAvLyBCYWNrYm9uZS5qcy5cbiAgICBsaWJyYXJpZXMucHVzaChcImJhY2tib25lanMvXCIuY29uY2F0KHdpbmRvdy5CYWNrYm9uZS5WRVJTSU9OKSk7XG4gIH1cblxuICBpZiAod2luZG93LkVtYmVyICE9PSB1bmRlZmluZWQpIHtcbiAgICAvLyBFbWJlci5qcy5cbiAgICBsaWJyYXJpZXMucHVzaChcImVtYmVyanMvXCIuY29uY2F0KHdpbmRvdy5FbWJlci5WRVJTSU9OKSk7XG4gIH1cblxuICBpZiAod2luZG93LmpRdWVyeSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgLy8galF1ZXJ5LlxuICAgIGxpYnJhcmllcy5wdXNoKFwianF1ZXJ5L1wiLmNvbmNhdCh3aW5kb3cualF1ZXJ5LmZuLmpxdWVyeSkpO1xuICB9XG5cbiAgaWYgKHdpbmRvdy5rbyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgLy8gS25vY2tvdXQuXG4gICAgbGlicmFyaWVzLnB1c2goXCJrbm9ja291dC9cIi5jb25jYXQod2luZG93LmtvLnZlcnNpb24pKTtcbiAgfVxuXG4gIGlmICh3aW5kb3cuWmVwdG8gIT09IHVuZGVmaW5lZCkge1xuICAgIC8vIFplcHRvLmpzLlxuICAgIGxpYnJhcmllcy5wdXNoKCd6ZXB0b2pzJyk7XG4gIH0gLy8gUmV0dXJuIHRoZSBkZXZpY2UgaW5mb3JtYXRpb24gc3RyaW5nLlxuXG5cbiAgdmFyIHBhcnRzID0gW1wianMtXCIuY29uY2F0KG5hbWUsIFwiL1wiKS5jb25jYXQodmVyc2lvbildO1xuXG4gIGlmIChsaWJyYXJpZXMubGVuZ3RoICE9PSAwKSB7XG4gICAgLy8gQWRkIGV4dGVybmFsIGxpYnJhcnkgaW5mb3JtYXRpb24uXG4gICAgcGFydHMucHVzaChcIihcIi5jb25jYXQobGlicmFyaWVzLnNvcnQoKS5qb2luKCcsICcpLCBcIilcIikpO1xuICB9XG5cbiAgcmV0dXJuIHBhcnRzLmNvbmNhdChbcGxhdGZvcm0sIGJyb3dzZXJWZXJzaW9uLCBtYW51ZmFjdHVyZXJdKS5tYXAoZnVuY3Rpb24gKHBhcnQpIHtcbiAgICBpZiAocGFydCkge1xuICAgICAgcmV0dXJuIHBhcnQudG9TdHJpbmcoKS5yZXBsYWNlKC9cXHMvZywgJ18nKS50b0xvd2VyQ2FzZSgpO1xuICAgIH1cblxuICAgIHJldHVybiAndW5rbm93bic7XG4gIH0pLmpvaW4oJyAnKTtcbn1cblxuZnVuY3Rpb24gZGV2aWNlSW5mbyhzZGtJbmZvKSB7XG4gIHJldHVybiB7XG4gICAgaHY6IDEsXG4gICAgb3M6IHdpbmRvdy5uYXZpZ2F0b3IuYXBwVmVyc2lvbixcbiAgICBvdjogd2luZG93Lm5hdmlnYXRvci5hcHBWZXJzaW9uLFxuICAgIHNkazogc2RrSW5mbyB8fCB7XG4gICAgICBuYW1lOiAnU0RLIHVua25vd24gKGtpbnZleS1odHRwLXdlYiknLFxuICAgICAgdmVyc2lvbjogJ3Vua25vd24nXG4gICAgfSxcbiAgICBwdjogd2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnRcbiAgfTtcbn0iLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLktpbnZleVJlcXVlc3QgPSBleHBvcnRzLlJlcXVlc3QgPSBleHBvcnRzLlJlcXVlc3RNZXRob2QgPSB2b2lkIDA7XG5cbnZhciBfZGVmaW5lUHJvcGVydHkyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9kZWZpbmVQcm9wZXJ0eVwiKSk7XG5cbnZhciBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm5cIikpO1xuXG52YXIgX2dldFByb3RvdHlwZU9mMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZ2V0UHJvdG90eXBlT2ZcIikpO1xuXG52YXIgX2dldDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2dldFwiKSk7XG5cbnZhciBfaW5oZXJpdHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbmhlcml0c1wiKSk7XG5cbnZhciBfcmVnZW5lcmF0b3IgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9yZWdlbmVyYXRvclwiKSk7XG5cbnZhciBfYXN5bmNUb0dlbmVyYXRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2FzeW5jVG9HZW5lcmF0b3JcIikpO1xuXG52YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2tcIikpO1xuXG52YXIgX2NyZWF0ZUNsYXNzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3NcIikpO1xuXG52YXIgX2lzTnVtYmVyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwibG9kYXNoL2lzTnVtYmVyXCIpKTtcblxudmFyIF9wUXVldWUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJwLXF1ZXVlXCIpKTtcblxudmFyIF9qc0Jhc2UgPSByZXF1aXJlKFwianMtYmFzZTY0XCIpO1xuXG52YXIgX2tpbnZleSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uL2Vycm9ycy9raW52ZXlcIikpO1xuXG52YXIgX2ludmFsaWRDcmVkZW50aWFscyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uL2Vycm9ycy9pbnZhbGlkQ3JlZGVudGlhbHNcIikpO1xuXG52YXIgX2NvbmZpZyA9IHJlcXVpcmUoXCIuLi9raW52ZXkvY29uZmlnXCIpO1xuXG52YXIgX3Nlc3Npb24gPSByZXF1aXJlKFwiLi4vc2Vzc2lvblwiKTtcblxudmFyIF9jYWNoZSA9IHJlcXVpcmUoXCIuLi9jYWNoZVwiKTtcblxudmFyIF9oZWFkZXJzID0gcmVxdWlyZShcIi4vaGVhZGVyc1wiKTtcblxudmFyIF91dGlscyA9IHJlcXVpcmUoXCIuL3V0aWxzXCIpO1xuXG52YXIgX3Jlc3BvbnNlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vcmVzcG9uc2VcIikpO1xuXG52YXIgX2F1dGggPSByZXF1aXJlKFwiLi9hdXRoXCIpO1xuXG52YXIgX2h0dHAgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL2h0dHBcIikpO1xuXG52YXIgUkVRVUVTVF9RVUVVRSA9IG5ldyBfcFF1ZXVlLmRlZmF1bHQoKTtcbnZhciByZWZyZXNoVG9rZW5SZXF1ZXN0SW5Qcm9ncmVzcyA9IGZhbHNlO1xudmFyIEFVVEhPUklaQVRJT05fSEVBREVSID0gJ0F1dGhvcml6YXRpb24nO1xudmFyIFJlcXVlc3RNZXRob2QgPSB7XG4gIEdFVDogJ0dFVCcsXG4gIFBPU1Q6ICdQT1NUJyxcbiAgUFVUOiAnUFVUJyxcbiAgREVMRVRFOiAnREVMRVRFJ1xufTtcbmV4cG9ydHMuUmVxdWVzdE1ldGhvZCA9IFJlcXVlc3RNZXRob2Q7XG52YXIgS0lOVkVZX0RFVklDRV9JTkZPUk1BVElPTl9IRUFERVIgPSAnWC1LaW52ZXktRGV2aWNlLUluZm9ybWF0aW9uJztcbnZhciBkZXZpY2VJbmZvcm1hdGlvbjtcbnZhciBLSU5WRVlfREVWSUNFX0lORk9fSEVBREVSID0gJ1gtS2ludmV5LURldmljZS1JbmZvJztcbnZhciBkZXZpY2VJbmZvO1xuXG52YXIgUmVxdWVzdCA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIFJlcXVlc3QoKSB7XG4gICAgdmFyIHJlcXVlc3QgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9O1xuICAgICgwLCBfY2xhc3NDYWxsQ2hlY2syLmRlZmF1bHQpKHRoaXMsIFJlcXVlc3QpO1xuICAgIHZhciBoZWFkZXJzID0gcmVxdWVzdC5oZWFkZXJzLFxuICAgICAgICBtZXRob2QgPSByZXF1ZXN0Lm1ldGhvZCxcbiAgICAgICAgdXJsID0gcmVxdWVzdC51cmwsXG4gICAgICAgIGJvZHkgPSByZXF1ZXN0LmJvZHksXG4gICAgICAgIHRpbWVvdXQgPSByZXF1ZXN0LnRpbWVvdXQ7XG4gICAgdGhpcy5oZWFkZXJzID0gaGVhZGVycztcbiAgICB0aGlzLm1ldGhvZCA9IG1ldGhvZDtcbiAgICB0aGlzLnVybCA9IHVybDtcbiAgICB0aGlzLmJvZHkgPSBib2R5O1xuICAgIHRoaXMudGltZW91dCA9IHRpbWVvdXQ7XG4gIH1cblxuICAoMCwgX2NyZWF0ZUNsYXNzMi5kZWZhdWx0KShSZXF1ZXN0LCBbe1xuICAgIGtleTogXCJleGVjdXRlXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBfZXhlY3V0ZSA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gICAgICAvKiNfX1BVUkVfXyovXG4gICAgICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7XG4gICAgICAgIHZhciByZXNwb25zZU9iamVjdCwgcmVzcG9uc2U7XG4gICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3IuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7XG4gICAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHtcbiAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyO1xuICAgICAgICAgICAgICAgIHJldHVybiAoMCwgX2h0dHAuZGVmYXVsdCkoe1xuICAgICAgICAgICAgICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLnRvT2JqZWN0KCksXG4gICAgICAgICAgICAgICAgICBtZXRob2Q6IHRoaXMubWV0aG9kLFxuICAgICAgICAgICAgICAgICAgdXJsOiB0aGlzLnVybCxcbiAgICAgICAgICAgICAgICAgIGJvZHk6ICgwLCBfdXRpbHMuc2VyaWFsaXplKSh0aGlzLmhlYWRlcnMuY29udGVudFR5cGUsIHRoaXMuYm9keSksXG4gICAgICAgICAgICAgICAgICB0aW1lb3V0OiB0aGlzLnRpbWVvdXRcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgcmVzcG9uc2VPYmplY3QgPSBfY29udGV4dC5zZW50O1xuICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBhIHJlc3BvbnNlXG4gICAgICAgICAgICAgICAgcmVzcG9uc2UgPSBuZXcgX3Jlc3BvbnNlMi5kZWZhdWx0KHtcbiAgICAgICAgICAgICAgICAgIHN0YXR1c0NvZGU6IHJlc3BvbnNlT2JqZWN0LnN0YXR1c0NvZGUsXG4gICAgICAgICAgICAgICAgICBoZWFkZXJzOiByZXNwb25zZU9iamVjdC5oZWFkZXJzLFxuICAgICAgICAgICAgICAgICAgZGF0YTogcmVzcG9uc2VPYmplY3QuZGF0YVxuICAgICAgICAgICAgICAgIH0pOyAvLyBSZXR1cm4gdGhlIHJlc3BvbnNlIGlmIGl0IHdhcyBzdWNjZXNzZnVsXG5cbiAgICAgICAgICAgICAgICBpZiAoIXJlc3BvbnNlLmlzU3VjY2VzcygpKSB7XG4gICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNjtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoXCJyZXR1cm5cIiwgcmVzcG9uc2UpO1xuXG4gICAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgICAgICB0aHJvdyByZXNwb25zZS5lcnJvcjtcblxuICAgICAgICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSwgX2NhbGxlZSwgdGhpcyk7XG4gICAgICB9KSk7XG5cbiAgICAgIGZ1bmN0aW9uIGV4ZWN1dGUoKSB7XG4gICAgICAgIHJldHVybiBfZXhlY3V0ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gZXhlY3V0ZTtcbiAgICB9KClcbiAgfSwge1xuICAgIGtleTogXCJoZWFkZXJzXCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICByZXR1cm4gdGhpcy5faGVhZGVycztcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24gc2V0KGhlYWRlcnMpIHtcbiAgICAgIHRoaXMuX2hlYWRlcnMgPSBuZXcgX2hlYWRlcnMuSGVhZGVycyhoZWFkZXJzKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwidGltZW91dFwiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3RpbWVvdXQ7XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uIHNldCh0aW1lb3V0KSB7XG4gICAgICB2YXIgX2dldENvbmZpZyA9ICgwLCBfY29uZmlnLmdldCkoKSxcbiAgICAgICAgICBkZWZhdWx0VGltZW91dCA9IF9nZXRDb25maWcuZGVmYXVsdFRpbWVvdXQ7XG5cbiAgICAgIHZhciByZXF1ZXN0VGltZW91dCA9IHR5cGVvZiB0aW1lb3V0ID09PSAndW5kZWZpbmVkJyB8fCB0aW1lb3V0ID09PSBudWxsID8gZGVmYXVsdFRpbWVvdXQgOiB0aW1lb3V0O1xuXG4gICAgICBpZiAoISgwLCBfaXNOdW1iZXIuZGVmYXVsdCkocmVxdWVzdFRpbWVvdXQpIHx8IGlzTmFOKHJlcXVlc3RUaW1lb3V0KSkge1xuICAgICAgICB0aHJvdyBuZXcgX2tpbnZleS5kZWZhdWx0KCdJbnZhbGlkIHRpbWVvdXQuIFRpbWVvdXQgbXVzdCBiZSBhIG51bWJlci4nKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5fdGltZW91dCA9IHJlcXVlc3RUaW1lb3V0O1xuICAgIH1cbiAgfV0pO1xuICByZXR1cm4gUmVxdWVzdDtcbn0oKTtcblxuZXhwb3J0cy5SZXF1ZXN0ID0gUmVxdWVzdDtcblxuZnVuY3Rpb24gaXNSZWZyZXNoVG9rZW5SZXF1ZXN0SW5Qcm9ncmVzcygpIHtcbiAgcmV0dXJuIHJlZnJlc2hUb2tlblJlcXVlc3RJblByb2dyZXNzID09PSB0cnVlO1xufVxuXG52YXIgS2ludmV5UmVxdWVzdCA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoX1JlcXVlc3QpIHtcbiAgKDAsIF9pbmhlcml0czIuZGVmYXVsdCkoS2ludmV5UmVxdWVzdCwgX1JlcXVlc3QpO1xuXG4gIGZ1bmN0aW9uIEtpbnZleVJlcXVlc3QocmVxdWVzdCkge1xuICAgIHZhciBfdGhpcztcblxuICAgICgwLCBfY2xhc3NDYWxsQ2hlY2syLmRlZmF1bHQpKHRoaXMsIEtpbnZleVJlcXVlc3QpO1xuICAgIF90aGlzID0gKDAsIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMi5kZWZhdWx0KSh0aGlzLCAoMCwgX2dldFByb3RvdHlwZU9mMi5kZWZhdWx0KShLaW52ZXlSZXF1ZXN0KS5jYWxsKHRoaXMsIHJlcXVlc3QpKTtcbiAgICBfdGhpcy5oZWFkZXJzID0gcmVxdWVzdC5oZWFkZXJzO1xuICAgIF90aGlzLmF1dGggPSByZXF1ZXN0LmF1dGg7XG4gICAgcmV0dXJuIF90aGlzO1xuICB9XG5cbiAgKDAsIF9jcmVhdGVDbGFzczIuZGVmYXVsdCkoS2ludmV5UmVxdWVzdCwgW3tcbiAgICBrZXk6IFwiZXhlY3V0ZVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgX2V4ZWN1dGUyID0gKDAsIF9hc3luY1RvR2VuZXJhdG9yMi5kZWZhdWx0KShcbiAgICAgIC8qI19fUFVSRV9fKi9cbiAgICAgIF9yZWdlbmVyYXRvci5kZWZhdWx0Lm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoKSB7XG4gICAgICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgICAgIHZhciByZXRyeSxcbiAgICAgICAgICAgIHJlc3BvbnNlLFxuICAgICAgICAgICAgX2dldENvbmZpZzIsXG4gICAgICAgICAgICBhcHBLZXksXG4gICAgICAgICAgICBhcHBTZWNyZXQsXG4gICAgICAgICAgICBhdXRoUHJvdG9jb2wsXG4gICAgICAgICAgICBhdXRoSG9zdCxcbiAgICAgICAgICAgIGFwaVByb3RvY29sLFxuICAgICAgICAgICAgYXBpSG9zdCxcbiAgICAgICAgICAgIGFjdGl2ZVNlc3Npb24sXG4gICAgICAgICAgICBzb2NpYWxJZGVudGl0eSxcbiAgICAgICAgICAgIG1pY0lkZW50aXR5S2V5LFxuICAgICAgICAgICAgbWljSWRlbnRpdHksXG4gICAgICAgICAgICByZWZyZXNoUmVxdWVzdCxcbiAgICAgICAgICAgIHJlZnJlc2hSZXNwb25zZSxcbiAgICAgICAgICAgIG5ld01pY0lkZW50aXR5LFxuICAgICAgICAgICAgbG9naW5SZXF1ZXN0LFxuICAgICAgICAgICAgbG9naW5SZXNwb25zZSxcbiAgICAgICAgICAgIG5ld1Nlc3Npb24sXG4gICAgICAgICAgICBfcmVzcG9uc2UsXG4gICAgICAgICAgICB1cmwsXG4gICAgICAgICAgICByZXF1ZXN0LFxuICAgICAgICAgICAgX2FyZ3MyID0gYXJndW1lbnRzO1xuXG4gICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3IuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHtcbiAgICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7XG4gICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICByZXRyeSA9IF9hcmdzMi5sZW5ndGggPiAwICYmIF9hcmdzMlswXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3MyWzBdIDogdHJ1ZTtcbiAgICAgICAgICAgICAgICBfY29udGV4dDIucHJldiA9IDE7XG5cbiAgICAgICAgICAgICAgICAvLyBBZGQgdGhlIFgtS2ludmV5LURldmljZS1JbmZvcm1hdGlvbiBoZWFkZXJcbiAgICAgICAgICAgICAgICBpZiAoZGV2aWNlSW5mb3JtYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgIHRoaXMuaGVhZGVycy5zZXQoS0lOVkVZX0RFVklDRV9JTkZPUk1BVElPTl9IRUFERVIsIGRldmljZUluZm9ybWF0aW9uKTtcbiAgICAgICAgICAgICAgICB9IC8vIEFkZCB0aGUgWC1LaW52ZXktRGV2aWNlLUluZm8gaGVhZGVyXG5cblxuICAgICAgICAgICAgICAgIGlmIChkZXZpY2VJbmZvKSB7XG4gICAgICAgICAgICAgICAgICB0aGlzLmhlYWRlcnMuc2V0KEtJTlZFWV9ERVZJQ0VfSU5GT19IRUFERVIsIEpTT04uc3RyaW5naWZ5KGRldmljZUluZm8pKTtcbiAgICAgICAgICAgICAgICB9IC8vIFNldCB0aGUgYXV0aG9yaXphdGlvbiBoZWFkZXJcblxuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYXV0aCkge1xuICAgICAgICAgICAgICAgICAgdGhpcy5oZWFkZXJzLnNldChBVVRIT1JJWkFUSU9OX0hFQURFUiwgdGhpcy5hdXRob3JpemF0aW9uSGVhZGVyKTtcbiAgICAgICAgICAgICAgICB9IC8vIEV4ZWN1dGUgdGhlIHJlcXVlc3RcblxuXG4gICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA3O1xuICAgICAgICAgICAgICAgIHJldHVybiAoMCwgX2dldDIuZGVmYXVsdCkoKDAsIF9nZXRQcm90b3R5cGVPZjIuZGVmYXVsdCkoS2ludmV5UmVxdWVzdC5wcm90b3R5cGUpLCBcImV4ZWN1dGVcIiwgdGhpcykuY2FsbCh0aGlzKTtcblxuICAgICAgICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICAgICAgcmVzcG9uc2UgPSBfY29udGV4dDIuc2VudDtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdChcInJldHVyblwiLCByZXNwb25zZSk7XG5cbiAgICAgICAgICAgICAgY2FzZSAxMTpcbiAgICAgICAgICAgICAgICBfY29udGV4dDIucHJldiA9IDExO1xuICAgICAgICAgICAgICAgIF9jb250ZXh0Mi50MCA9IF9jb250ZXh0MltcImNhdGNoXCJdKDEpO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFyZXRyeSkge1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA2MTtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICghKF9jb250ZXh0Mi50MCBpbnN0YW5jZW9mIF9pbnZhbGlkQ3JlZGVudGlhbHMuZGVmYXVsdCkpIHtcbiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNTk7XG4gICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoIWlzUmVmcmVzaFRva2VuUmVxdWVzdEluUHJvZ3Jlc3MoKSkge1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxNztcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KFwicmV0dXJuXCIsIFJFUVVFU1RfUVVFVUUuYWRkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczIuZXhlY3V0ZShmYWxzZSkuY2F0Y2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoX2NvbnRleHQyLnQwKTtcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICAgICAgICBjYXNlIDE3OlxuICAgICAgICAgICAgICAgIF9nZXRDb25maWcyID0gKDAsIF9jb25maWcuZ2V0KSgpLCBhcHBLZXkgPSBfZ2V0Q29uZmlnMi5hcHBLZXksIGFwcFNlY3JldCA9IF9nZXRDb25maWcyLmFwcFNlY3JldCwgYXV0aFByb3RvY29sID0gX2dldENvbmZpZzIuYXV0aFByb3RvY29sLCBhdXRoSG9zdCA9IF9nZXRDb25maWcyLmF1dGhIb3N0LCBhcGlQcm90b2NvbCA9IF9nZXRDb25maWcyLmFwaVByb3RvY29sLCBhcGlIb3N0ID0gX2dldENvbmZpZzIuYXBpSG9zdDtcbiAgICAgICAgICAgICAgICBhY3RpdmVTZXNzaW9uID0gKDAsIF9zZXNzaW9uLmdldCkoKTtcbiAgICAgICAgICAgICAgICBzb2NpYWxJZGVudGl0eSA9IGFjdGl2ZVNlc3Npb24gJiYgYWN0aXZlU2Vzc2lvbi5fc29jaWFsSWRlbnRpdHkgfHwge307XG4gICAgICAgICAgICAgICAgbWljSWRlbnRpdHlLZXkgPSBPYmplY3Qua2V5cyhzb2NpYWxJZGVudGl0eSkuZmluZChmdW5jdGlvbiAoc2Vzc2lvbktleSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHNvY2lhbElkZW50aXR5W3Nlc3Npb25LZXldLmlkZW50aXR5ID09PSAna2ludmV5QXV0aCc7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgbWljSWRlbnRpdHkgPSBzb2NpYWxJZGVudGl0eVttaWNJZGVudGl0eUtleV07XG5cbiAgICAgICAgICAgICAgICBpZiAoIShtaWNJZGVudGl0eSAmJiBtaWNJZGVudGl0eS5yZWZyZXNoX3Rva2VuICYmIG1pY0lkZW50aXR5LnJlZGlyZWN0X3VyaSkpIHtcbiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNDg7XG4gICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBfY29udGV4dDIucHJldiA9IDIzO1xuICAgICAgICAgICAgICAgIC8vIFBhdXNlIHRoZSByZXF1ZXN0IHF1ZXVlXG4gICAgICAgICAgICAgICAgUkVRVUVTVF9RVUVVRS5wYXVzZSgpO1xuICAgICAgICAgICAgICAgIHJlZnJlc2hUb2tlblJlcXVlc3RJblByb2dyZXNzID0gdHJ1ZTsgLy8gUmVmcmVzaCB0aGUgc2Vzc2lvblxuXG4gICAgICAgICAgICAgICAgcmVmcmVzaFJlcXVlc3QgPSBuZXcgS2ludmV5UmVxdWVzdCh7XG4gICAgICAgICAgICAgICAgICBtZXRob2Q6IFJlcXVlc3RNZXRob2QuUE9TVCxcbiAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnLFxuICAgICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBmdW5jdGlvbiBBdXRob3JpemF0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgIHZhciBjcmVkZW50aWFscyA9IF9qc0Jhc2UuQmFzZTY0LmVuY29kZShcIlwiLmNvbmNhdChtaWNJZGVudGl0eS5jbGllbnRfaWQsIFwiOlwiKS5jb25jYXQoYXBwU2VjcmV0KSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJCYXNpYyBcIi5jb25jYXQoY3JlZGVudGlhbHMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgdXJsOiAoMCwgX3V0aWxzLmZvcm1hdEtpbnZleVVybCkoYXV0aFByb3RvY29sLCBhdXRoSG9zdCwgJy9vYXV0aC90b2tlbicpLFxuICAgICAgICAgICAgICAgICAgYm9keToge1xuICAgICAgICAgICAgICAgICAgICBncmFudF90eXBlOiAncmVmcmVzaF90b2tlbicsXG4gICAgICAgICAgICAgICAgICAgIGNsaWVudF9pZDogbWljSWRlbnRpdHkuY2xpZW50X2lkLFxuICAgICAgICAgICAgICAgICAgICByZWRpcmVjdF91cmk6IG1pY0lkZW50aXR5LnJlZGlyZWN0X3VyaSxcbiAgICAgICAgICAgICAgICAgICAgcmVmcmVzaF90b2tlbjogbWljSWRlbnRpdHkucmVmcmVzaF90b2tlblxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMjk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlZnJlc2hSZXF1ZXN0LmV4ZWN1dGUoKTtcblxuICAgICAgICAgICAgICBjYXNlIDI5OlxuICAgICAgICAgICAgICAgIHJlZnJlc2hSZXNwb25zZSA9IF9jb250ZXh0Mi5zZW50O1xuICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBhIG5ldyBzZXNzaW9uXG4gICAgICAgICAgICAgICAgbmV3TWljSWRlbnRpdHkgPSBPYmplY3QuYXNzaWduKHt9LCByZWZyZXNoUmVzcG9uc2UuZGF0YSwge1xuICAgICAgICAgICAgICAgICAgY2xpZW50X2lkOiBtaWNJZGVudGl0eS5jbGllbnRfaWQsXG4gICAgICAgICAgICAgICAgICByZWRpcmVjdF91cmk6IG1pY0lkZW50aXR5LnJlZGlyZWN0X3VyaSxcbiAgICAgICAgICAgICAgICAgIHByb3RvY29sOiBhdXRoUHJvdG9jb2wsXG4gICAgICAgICAgICAgICAgICBob3N0OiBhdXRoSG9zdFxuICAgICAgICAgICAgICAgIH0pOyAvLyBMb2dpbiB0aGUgbmV3IE1JQyBpZGVudGl0eVxuXG4gICAgICAgICAgICAgICAgbG9naW5SZXF1ZXN0ID0gbmV3IEtpbnZleVJlcXVlc3Qoe1xuICAgICAgICAgICAgICAgICAgbWV0aG9kOiBSZXF1ZXN0TWV0aG9kLlBPU1QsXG4gICAgICAgICAgICAgICAgICBhdXRoOiBfYXV0aC5BdXRoLkFwcCxcbiAgICAgICAgICAgICAgICAgIHVybDogKDAsIF91dGlscy5mb3JtYXRLaW52ZXlVcmwpKGFwaVByb3RvY29sLCBhcGlIb3N0LCBcIi91c2VyL1wiLmNvbmNhdChhcHBLZXksIFwiL2xvZ2luXCIpKSxcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHRoaXMucHJvcGVydGllcyxcbiAgICAgICAgICAgICAgICAgIGJvZHk6IHtcbiAgICAgICAgICAgICAgICAgICAgX3NvY2lhbElkZW50aXR5OiAoMCwgX2RlZmluZVByb3BlcnR5Mi5kZWZhdWx0KSh7fSwgbWljSWRlbnRpdHlLZXksIG5ld01pY0lkZW50aXR5KVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMzQ7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGxvZ2luUmVxdWVzdC5leGVjdXRlKCk7XG5cbiAgICAgICAgICAgICAgY2FzZSAzNDpcbiAgICAgICAgICAgICAgICBsb2dpblJlc3BvbnNlID0gX2NvbnRleHQyLnNlbnQ7XG4gICAgICAgICAgICAgICAgbmV3U2Vzc2lvbiA9IGxvZ2luUmVzcG9uc2UuZGF0YTtcbiAgICAgICAgICAgICAgICBuZXdTZXNzaW9uLl9zb2NpYWxJZGVudGl0eVttaWNJZGVudGl0eUtleV0gPSBPYmplY3QuYXNzaWduKHt9LCBuZXdTZXNzaW9uLl9zb2NpYWxJZGVudGl0eVttaWNJZGVudGl0eUtleV0sIG5ld01pY0lkZW50aXR5KTsgLy8gU2V0IHRoZSBuZXcgc2Vzc2lvblxuXG4gICAgICAgICAgICAgICAgKDAsIF9zZXNzaW9uLnNldCkobmV3U2Vzc2lvbik7IC8vIFJlZG8gdGhlIG9yaWdpbmFsIHJlcXVlc3RcblxuICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNDA7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZXhlY3V0ZShmYWxzZSk7XG5cbiAgICAgICAgICAgICAgY2FzZSA0MDpcbiAgICAgICAgICAgICAgICBfcmVzcG9uc2UgPSBfY29udGV4dDIuc2VudDtcbiAgICAgICAgICAgICAgICAvLyBTdGFydCB0aGUgcmVxdWVzdCBxdWV1ZVxuICAgICAgICAgICAgICAgIHJlZnJlc2hUb2tlblJlcXVlc3RJblByb2dyZXNzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgUkVRVUVTVF9RVUVVRS5zdGFydCgpOyAvLyBSZXR1cm4gdGhlIHJlc3BvbnNlXG5cbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdChcInJldHVyblwiLCBfcmVzcG9uc2UpO1xuXG4gICAgICAgICAgICAgIGNhc2UgNDY6XG4gICAgICAgICAgICAgICAgX2NvbnRleHQyLnByZXYgPSA0NjtcbiAgICAgICAgICAgICAgICBfY29udGV4dDIudDEgPSBfY29udGV4dDJbXCJjYXRjaFwiXSgyMyk7XG5cbiAgICAgICAgICAgICAgY2FzZSA0ODpcbiAgICAgICAgICAgICAgICBfY29udGV4dDIucHJldiA9IDQ4O1xuICAgICAgICAgICAgICAgIC8vIFRPRE86IFVucmVnaXN0ZXIgZnJvbSBsaXZlIHNlcnZpY2VcbiAgICAgICAgICAgICAgICAvLyBMb2dvdXRcbiAgICAgICAgICAgICAgICB1cmwgPSAoMCwgX3V0aWxzLmZvcm1hdEtpbnZleVVybCkoYXBpUHJvdG9jb2wsIGFwaUhvc3QsIFwiL3VzZXIvXCIuY29uY2F0KGFwcEtleSwgXCIvX2xvZ291dFwiKSk7XG4gICAgICAgICAgICAgICAgcmVxdWVzdCA9IG5ldyBLaW52ZXlSZXF1ZXN0KHtcbiAgICAgICAgICAgICAgICAgIG1ldGhvZDogUmVxdWVzdE1ldGhvZC5QT1NULFxuICAgICAgICAgICAgICAgICAgYXV0aDogX2F1dGguQXV0aC5TZXNzaW9uLFxuICAgICAgICAgICAgICAgICAgdXJsOiB1cmxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDUzO1xuICAgICAgICAgICAgICAgIHJldHVybiByZXF1ZXN0LmV4ZWN1dGUoZmFsc2UpO1xuXG4gICAgICAgICAgICAgIGNhc2UgNTM6XG4gICAgICAgICAgICAgICAgLy8gUmVtb3ZlIHRoZSBzZXNzaW9uXG4gICAgICAgICAgICAgICAgKDAsIF9zZXNzaW9uLnJlbW92ZSkoKTsgLy8gQ2xlYXIgZGF0YVxuXG4gICAgICAgICAgICAgICAgKDAsIF9jYWNoZS5jbGVhcikoYXBwS2V5KTtcbiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDU5O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgIGNhc2UgNTc6XG4gICAgICAgICAgICAgICAgX2NvbnRleHQyLnByZXYgPSA1NztcbiAgICAgICAgICAgICAgICBfY29udGV4dDIudDIgPSBfY29udGV4dDJbXCJjYXRjaFwiXSg0OCk7XG5cbiAgICAgICAgICAgICAgY2FzZSA1OTpcbiAgICAgICAgICAgICAgICAvLyBTdGFydCB0aGUgcmVxdWVzdCBxdWV1ZVxuICAgICAgICAgICAgICAgIHJlZnJlc2hUb2tlblJlcXVlc3RJblByb2dyZXNzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgUkVRVUVTVF9RVUVVRS5zdGFydCgpO1xuXG4gICAgICAgICAgICAgIGNhc2UgNjE6XG4gICAgICAgICAgICAgICAgdGhyb3cgX2NvbnRleHQyLnQwO1xuXG4gICAgICAgICAgICAgIGNhc2UgNjI6XG4gICAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sIF9jYWxsZWUyLCB0aGlzLCBbWzEsIDExXSwgWzIzLCA0Nl0sIFs0OCwgNTddXSk7XG4gICAgICB9KSk7XG5cbiAgICAgIGZ1bmN0aW9uIGV4ZWN1dGUoKSB7XG4gICAgICAgIHJldHVybiBfZXhlY3V0ZTIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGV4ZWN1dGU7XG4gICAgfSgpXG4gIH0sIHtcbiAgICBrZXk6IFwiaGVhZGVyc1wiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2hlYWRlcnM7XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uIHNldChoZWFkZXJzKSB7XG4gICAgICB0aGlzLl9oZWFkZXJzID0gbmV3IF9oZWFkZXJzLktpbnZleUhlYWRlcnMoaGVhZGVycyk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImF1dGhvcml6YXRpb25IZWFkZXJcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHZhciBfZ2V0Q29uZmlnMyA9ICgwLCBfY29uZmlnLmdldCkoKSxcbiAgICAgICAgICBhcHBLZXkgPSBfZ2V0Q29uZmlnMy5hcHBLZXksXG4gICAgICAgICAgYXBwU2VjcmV0ID0gX2dldENvbmZpZzMuYXBwU2VjcmV0LFxuICAgICAgICAgIG1hc3RlclNlY3JldCA9IF9nZXRDb25maWczLm1hc3RlclNlY3JldDtcblxuICAgICAgdmFyIHNlc3Npb24gPSAoMCwgX3Nlc3Npb24uZ2V0KSgpO1xuXG4gICAgICBpZiAodGhpcy5hdXRoID09PSBfYXV0aC5BdXRoLkFwcCkge1xuICAgICAgICByZXR1cm4gKDAsIF9hdXRoLmFwcCkoYXBwS2V5LCBhcHBTZWNyZXQpO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLmF1dGggPT09IF9hdXRoLkF1dGguTWFzdGVyKSB7XG4gICAgICAgIHJldHVybiAoMCwgX2F1dGgubWFzdGVyKShhcHBLZXksIG1hc3RlclNlY3JldCk7XG4gICAgICB9IGVsc2UgaWYgKHRoaXMuYXV0aCA9PT0gX2F1dGguQXV0aC5TZXNzaW9uKSB7XG4gICAgICAgIHJldHVybiAoMCwgX2F1dGguc2Vzc2lvbikoc2Vzc2lvbik7XG4gICAgICB9IGVsc2UgaWYgKHRoaXMuYXV0aCA9PT0gX2F1dGguQXV0aC5CYXNpYykge1xuICAgICAgICByZXR1cm4gKDAsIF9hdXRoLmJhc2ljKShhcHBLZXksIGFwcFNlY3JldCwgbWFzdGVyU2VjcmV0KTtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5hdXRoID09PSBfYXV0aC5BdXRoLkRlZmF1bHQpIHtcbiAgICAgICAgcmV0dXJuICgwLCBfYXV0aC5kZWZhdWx0QXV0aCkoc2Vzc2lvbiwgYXBwS2V5LCBtYXN0ZXJTZWNyZXQpO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLmF1dGggPT09IF9hdXRoLkF1dGguQWxsKSB7XG4gICAgICAgIHJldHVybiAoMCwgX2F1dGguYWxsKShzZXNzaW9uLCBhcHBLZXksIGFwcFNlY3JldCwgbWFzdGVyU2VjcmV0KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9XSk7XG4gIHJldHVybiBLaW52ZXlSZXF1ZXN0O1xufShSZXF1ZXN0KTtcblxuZXhwb3J0cy5LaW52ZXlSZXF1ZXN0ID0gS2ludmV5UmVxdWVzdDsiLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG5cbnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVja1wiKSk7XG5cbnZhciBfY3JlYXRlQ2xhc3MyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jcmVhdGVDbGFzc1wiKSk7XG5cbnZhciBfYXBpVmVyc2lvbk5vdEF2YWlsYWJsZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uL2Vycm9ycy9hcGlWZXJzaW9uTm90QXZhaWxhYmxlXCIpKTtcblxudmFyIF9hcGlWZXJzaW9uTm90SW1wbGVtZW50ZWQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi9lcnJvcnMvYXBpVmVyc2lvbk5vdEltcGxlbWVudGVkXCIpKTtcblxudmFyIF9hcHBQcm9ibGVtID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vZXJyb3JzL2FwcFByb2JsZW1cIikpO1xuXG52YXIgX2JhZFJlcXVlc3QgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi9lcnJvcnMvYmFkUmVxdWVzdFwiKSk7XG5cbnZhciBfYmwgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi9lcnJvcnMvYmxcIikpO1xuXG52YXIgX2NvcnNEaXNhYmxlZCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uL2Vycm9ycy9jb3JzRGlzYWJsZWRcIikpO1xuXG52YXIgX2R1cGxpY2F0ZUVuZFVzZXJzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vZXJyb3JzL2R1cGxpY2F0ZUVuZFVzZXJzXCIpKTtcblxudmFyIF9mZWF0dXJlVW5hdmFpbGFibGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi9lcnJvcnMvZmVhdHVyZVVuYXZhaWxhYmxlXCIpKTtcblxudmFyIF9pbmNvbXBsZXRlUmVxdWVzdEJvZHkgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi9lcnJvcnMvaW5jb21wbGV0ZVJlcXVlc3RCb2R5XCIpKTtcblxudmFyIF9pbmRpcmVjdENvbGxlY3Rpb25BY2Nlc3NEaXNhbGxvd2VkID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vZXJyb3JzL2luZGlyZWN0Q29sbGVjdGlvbkFjY2Vzc0Rpc2FsbG93ZWRcIikpO1xuXG52YXIgX2luc3VmZmljaWVudENyZWRlbnRpYWxzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vZXJyb3JzL2luc3VmZmljaWVudENyZWRlbnRpYWxzXCIpKTtcblxudmFyIF9pbnZhbGlkQ3JlZGVudGlhbHMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi9lcnJvcnMvaW52YWxpZENyZWRlbnRpYWxzXCIpKTtcblxudmFyIF9pbnZhbGlkSWRlbnRpZmllciA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uL2Vycm9ycy9pbnZhbGlkSWRlbnRpZmllclwiKSk7XG5cbnZhciBfaW52YWxpZFF1ZXJ5U3ludGF4ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vZXJyb3JzL2ludmFsaWRRdWVyeVN5bnRheFwiKSk7XG5cbnZhciBfanNvblBhcnNlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vZXJyb3JzL2pzb25QYXJzZVwiKSk7XG5cbnZhciBfa2ludmV5ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vZXJyb3JzL2tpbnZleVwiKSk7XG5cbnZhciBfa2ludmV5SW50ZXJuYWxFcnJvclJldHJ5ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vZXJyb3JzL2tpbnZleUludGVybmFsRXJyb3JSZXRyeVwiKSk7XG5cbnZhciBfa2ludmV5SW50ZXJuYWxFcnJvclN0b3AgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi9lcnJvcnMva2ludmV5SW50ZXJuYWxFcnJvclN0b3BcIikpO1xuXG52YXIgX21pc3NpbmdRdWVyeSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uL2Vycm9ycy9taXNzaW5nUXVlcnlcIikpO1xuXG52YXIgX21pc3NpbmdSZXF1ZXN0SGVhZGVyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vZXJyb3JzL21pc3NpbmdSZXF1ZXN0SGVhZGVyXCIpKTtcblxudmFyIF9taXNzaW5nUmVxdWVzdFBhcmFtZXRlciA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uL2Vycm9ycy9taXNzaW5nUmVxdWVzdFBhcmFtZXRlclwiKSk7XG5cbnZhciBfbWlzc2luZ0NvbmZpZ3VyYXRpb24gPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi9lcnJvcnMvbWlzc2luZ0NvbmZpZ3VyYXRpb25cIikpO1xuXG52YXIgX25ldHdvcmtDb25uZWN0aW9uID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vZXJyb3JzL25ldHdvcmtDb25uZWN0aW9uXCIpKTtcblxudmFyIF9ub3RGb3VuZCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uL2Vycm9ycy9ub3RGb3VuZFwiKSk7XG5cbnZhciBfcGFyYW1ldGVyVmFsdWVPdXRPZlJhbmdlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vZXJyb3JzL3BhcmFtZXRlclZhbHVlT3V0T2ZSYW5nZVwiKSk7XG5cbnZhciBfcmVzdWx0U2V0U2l6ZUV4Y2VlZGVkID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vZXJyb3JzL3Jlc3VsdFNldFNpemVFeGNlZWRlZFwiKSk7XG5cbnZhciBfc2VydmVyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vZXJyb3JzL3NlcnZlclwiKSk7XG5cbnZhciBfc3RhbGVSZXF1ZXN0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vZXJyb3JzL3N0YWxlUmVxdWVzdFwiKSk7XG5cbnZhciBfdGltZW91dCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uL2Vycm9ycy90aW1lb3V0XCIpKTtcblxudmFyIF91c2VyQWxyZWFkeUV4aXN0cyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uL2Vycm9ycy91c2VyQWxyZWFkeUV4aXN0c1wiKSk7XG5cbnZhciBfd3JpdGVzVG9Db2xsZWN0aW9uRGlzYWxsb3dlZCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uL2Vycm9ycy93cml0ZXNUb0NvbGxlY3Rpb25EaXNhbGxvd2VkXCIpKTtcblxudmFyIF9oZWFkZXJzID0gcmVxdWlyZShcIi4vaGVhZGVyc1wiKTtcblxudmFyIF91dGlscyA9IHJlcXVpcmUoXCIuL3V0aWxzXCIpO1xuXG52YXIgU3RhdHVzQ29kZSA9IHtcbiAgT2s6IDIwMCxcbiAgQ3JlYXRlZDogMjAxLFxuICBFbXB0eTogMjA0LFxuICBNb3ZlZFBlcm1hbmVudGx5OiAzMDEsXG4gIEZvdW5kOiAzMDIsXG4gIE5vdE1vZGlmaWVkOiAzMDQsXG4gIFRlbXBvcmFyeVJlZGlyZWN0OiAzMDcsXG4gIFBlcm1hbmVudFJlZGlyZWN0OiAzMDgsXG4gIFVuYXV0aG9yaXplZDogNDAxLFxuICBGb3JiaWRkZW46IDQwMyxcbiAgTm90Rm91bmQ6IDQwNCxcbiAgU2VydmVyRXJyb3I6IDUwMFxufTtcblxudmFyIFJlc3BvbnNlID1cbi8qI19fUFVSRV9fKi9cbmZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gUmVzcG9uc2UocmVzcG9uc2UpIHtcbiAgICAoMCwgX2NsYXNzQ2FsbENoZWNrMi5kZWZhdWx0KSh0aGlzLCBSZXNwb25zZSk7XG4gICAgdGhpcy5zdGF0dXNDb2RlID0gcmVzcG9uc2Uuc3RhdHVzQ29kZTtcbiAgICB0aGlzLmhlYWRlcnMgPSByZXNwb25zZS5oZWFkZXJzO1xuICAgIHRoaXMuZGF0YSA9IHJlc3BvbnNlLmRhdGE7XG4gIH1cblxuICAoMCwgX2NyZWF0ZUNsYXNzMi5kZWZhdWx0KShSZXNwb25zZSwgW3tcbiAgICBrZXk6IFwiaXNTdWNjZXNzXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGlzU3VjY2VzcygpIHtcbiAgICAgIHJldHVybiB0aGlzLnN0YXR1c0NvZGUgPj0gMjAwICYmIHRoaXMuc3RhdHVzQ29kZSA8IDMwMCB8fCB0aGlzLnN0YXR1c0NvZGUgPT09IFN0YXR1c0NvZGUuTW92ZWRQZXJtYW5lbnRseSB8fCB0aGlzLnN0YXR1c0NvZGUgPT09IFN0YXR1c0NvZGUuRm91bmQgfHwgdGhpcy5zdGF0dXNDb2RlID09PSBTdGF0dXNDb2RlLk5vdE1vZGlmaWVkIHx8IHRoaXMuc3RhdHVzQ29kZSA9PT0gU3RhdHVzQ29kZS5UZW1wb3JhcnlSZWRpcmVjdCB8fCB0aGlzLnN0YXR1c0NvZGUgPT09IFN0YXR1c0NvZGUuUGVybWFuZW50UmVkaXJlY3Q7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImhlYWRlcnNcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9oZWFkZXJzO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiBzZXQoaGVhZGVycykge1xuICAgICAgdGhpcy5faGVhZGVycyA9IG5ldyBfaGVhZGVycy5IZWFkZXJzKGhlYWRlcnMpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJkYXRhXCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fZGF0YTtcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24gc2V0KGRhdGEpIHtcbiAgICAgIHRoaXMuX2RhdGEgPSAoMCwgX3V0aWxzLnBhcnNlKSh0aGlzLmhlYWRlcnMuY29udGVudFR5cGUsIGRhdGEpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJlcnJvclwiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgaWYgKCF0aGlzLmlzU3VjY2VzcygpKSB7XG4gICAgICAgIHZhciBkYXRhID0gdGhpcy5kYXRhIHx8IHt9O1xuICAgICAgICB2YXIgbmFtZSA9IGRhdGEubmFtZSB8fCBkYXRhLmVycm9yO1xuICAgICAgICB2YXIgbWVzc2FnZSA9IGRhdGEubWVzc2FnZSB8fCBkYXRhLmRlc2NyaXB0aW9uO1xuICAgICAgICB2YXIgZGVidWcgPSBkYXRhLmRlYnVnO1xuICAgICAgICB2YXIgY29kZSA9IHRoaXMuc3RhdHVzQ29kZTtcbiAgICAgICAgdmFyIGtpbnZleVJlcXVlc3RJZCA9IHRoaXMuaGVhZGVycy5nZXQoJ1gtS2ludmV5LVJlcXVlc3QtSUQnKTtcblxuICAgICAgICBpZiAoY29kZSA9PT0gJ0VTT0NLRVRUSU1FRE9VVCcgfHwgY29kZSA9PT0gJ0VUSU1FRE9VVCcpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IF90aW1lb3V0LmRlZmF1bHQoJ1RoZSBuZXR3b3JrIHJlcXVlc3QgdGltZWQgb3V0LicpO1xuICAgICAgICB9IGVsc2UgaWYgKGNvZGUgPT09ICdFTk9FTlQnKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBfbmV0d29ya0Nvbm5lY3Rpb24uZGVmYXVsdCgnWW91IGRvIG5vdCBoYXZlIGEgbmV0d29yayBjb25uZWN0aW9uLicpO1xuICAgICAgICB9IGVsc2UgaWYgKG5hbWUgPT09ICdBUElWZXJzaW9uTm90QXZhaWxhYmxlJykge1xuICAgICAgICAgIHJldHVybiBuZXcgX2FwaVZlcnNpb25Ob3RBdmFpbGFibGUuZGVmYXVsdChtZXNzYWdlLCBkZWJ1ZywgY29kZSwga2ludmV5UmVxdWVzdElkKTtcbiAgICAgICAgfSBlbHNlIGlmIChuYW1lID09PSAnQVBJVmVyc2lvbk5vdEltcGxlbWVudGVkJykge1xuICAgICAgICAgIHJldHVybiBuZXcgX2FwaVZlcnNpb25Ob3RJbXBsZW1lbnRlZC5kZWZhdWx0KG1lc3NhZ2UsIGRlYnVnLCBjb2RlLCBraW52ZXlSZXF1ZXN0SWQpO1xuICAgICAgICB9IGVsc2UgaWYgKG5hbWUgPT09ICdBcHBQcm9ibGVtJykge1xuICAgICAgICAgIHJldHVybiBuZXcgX2FwcFByb2JsZW0uZGVmYXVsdChtZXNzYWdlLCBkZWJ1ZywgY29kZSwga2ludmV5UmVxdWVzdElkKTtcbiAgICAgICAgfSBlbHNlIGlmIChuYW1lID09PSAnQXBwUHJvYmxlbScpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IF9hcHBQcm9ibGVtLmRlZmF1bHQobWVzc2FnZSwgZGVidWcsIGNvZGUsIGtpbnZleVJlcXVlc3RJZCk7XG4gICAgICAgIH0gZWxzZSBpZiAobmFtZSA9PT0gJ0JhZFJlcXVlc3QnKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBfYmFkUmVxdWVzdC5kZWZhdWx0KG1lc3NhZ2UsIGRlYnVnLCBjb2RlLCBraW52ZXlSZXF1ZXN0SWQpO1xuICAgICAgICB9IGVsc2UgaWYgKG5hbWUgPT09ICdCTEludGVybmFsRXJyb3InIHx8IG5hbWUgPT09ICdCTFJ1bnRpbWVFcnJvcicgfHwgbmFtZSA9PT0gJ0JMU3ludGF4RXJyb3InIHx8IG5hbWUgPT09ICdCTFRpbWVvdXRFcnJvcicgfHwgbmFtZSA9PT0gJ0JMVmlvbGF0aW9uRXJyb3InKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBfYmwuZGVmYXVsdChtZXNzYWdlLCBkZWJ1ZywgY29kZSwga2ludmV5UmVxdWVzdElkKTtcbiAgICAgICAgfSBlbHNlIGlmIChuYW1lID09PSAnQ09SU0Rpc2FibGVkJykge1xuICAgICAgICAgIHJldHVybiBuZXcgX2NvcnNEaXNhYmxlZC5kZWZhdWx0KG1lc3NhZ2UsIGRlYnVnLCBjb2RlLCBraW52ZXlSZXF1ZXN0SWQpO1xuICAgICAgICB9IGVsc2UgaWYgKG5hbWUgPT09ICdEdXBsaWNhdGVFbmRVc2VycycpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IF9kdXBsaWNhdGVFbmRVc2Vycy5kZWZhdWx0KG1lc3NhZ2UsIGRlYnVnLCBjb2RlLCBraW52ZXlSZXF1ZXN0SWQpO1xuICAgICAgICB9IGVsc2UgaWYgKG5hbWUgPT09ICdGZWF0dXJlVW5hdmFpbGFibGUnKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBfZmVhdHVyZVVuYXZhaWxhYmxlLmRlZmF1bHQobWVzc2FnZSwgZGVidWcsIGNvZGUsIGtpbnZleVJlcXVlc3RJZCk7XG4gICAgICAgIH0gZWxzZSBpZiAobmFtZSA9PT0gJ0luY29tcGxldGVSZXF1ZXN0Qm9keScpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IF9pbmNvbXBsZXRlUmVxdWVzdEJvZHkuZGVmYXVsdChtZXNzYWdlLCBkZWJ1ZywgY29kZSwga2ludmV5UmVxdWVzdElkKTtcbiAgICAgICAgfSBlbHNlIGlmIChuYW1lID09PSAnSW5kaXJlY3RDb2xsZWN0aW9uQWNjZXNzRGlzYWxsb3dlZCcpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IF9pbmRpcmVjdENvbGxlY3Rpb25BY2Nlc3NEaXNhbGxvd2VkLmRlZmF1bHQobWVzc2FnZSwgZGVidWcsIGNvZGUsIGtpbnZleVJlcXVlc3RJZCk7XG4gICAgICAgIH0gZWxzZSBpZiAobmFtZSA9PT0gJ0luc3VmZmljaWVudENyZWRlbnRpYWxzJykge1xuICAgICAgICAgIHJldHVybiBuZXcgX2luc3VmZmljaWVudENyZWRlbnRpYWxzLmRlZmF1bHQobWVzc2FnZSwgZGVidWcsIGNvZGUsIGtpbnZleVJlcXVlc3RJZCk7XG4gICAgICAgIH0gZWxzZSBpZiAobmFtZSA9PT0gJ0ludmFsaWRDcmVkZW50aWFscycpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IF9pbnZhbGlkQ3JlZGVudGlhbHMuZGVmYXVsdChtZXNzYWdlLCBkZWJ1ZywgY29kZSwga2ludmV5UmVxdWVzdElkKTtcbiAgICAgICAgfSBlbHNlIGlmIChuYW1lID09PSAnSW52YWxpZElkZW50aWZpZXInKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBfaW52YWxpZElkZW50aWZpZXIuZGVmYXVsdChtZXNzYWdlLCBkZWJ1ZywgY29kZSwga2ludmV5UmVxdWVzdElkKTtcbiAgICAgICAgfSBlbHNlIGlmIChuYW1lID09PSAnSW52YWxpZFF1ZXJ5U3ludGF4Jykge1xuICAgICAgICAgIHJldHVybiBuZXcgX2ludmFsaWRRdWVyeVN5bnRheC5kZWZhdWx0KG1lc3NhZ2UsIGRlYnVnLCBjb2RlLCBraW52ZXlSZXF1ZXN0SWQpO1xuICAgICAgICB9IGVsc2UgaWYgKG5hbWUgPT09ICdKU09OUGFyc2VFcnJvcicpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IF9qc29uUGFyc2UuZGVmYXVsdChtZXNzYWdlLCBkZWJ1ZywgY29kZSwga2ludmV5UmVxdWVzdElkKTtcbiAgICAgICAgfSBlbHNlIGlmIChuYW1lID09PSAnS2ludmV5SW50ZXJuYWxFcnJvclJldHJ5Jykge1xuICAgICAgICAgIHJldHVybiBuZXcgX2tpbnZleUludGVybmFsRXJyb3JSZXRyeS5kZWZhdWx0KG1lc3NhZ2UsIGRlYnVnLCBjb2RlLCBraW52ZXlSZXF1ZXN0SWQpO1xuICAgICAgICB9IGVsc2UgaWYgKG5hbWUgPT09ICdLaW52ZXlJbnRlcm5hbEVycm9yU3RvcCcpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IF9raW52ZXlJbnRlcm5hbEVycm9yU3RvcC5kZWZhdWx0KG1lc3NhZ2UsIGRlYnVnLCBjb2RlLCBraW52ZXlSZXF1ZXN0SWQpO1xuICAgICAgICB9IGVsc2UgaWYgKG5hbWUgPT09ICdNaXNzaW5nUXVlcnknKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBfbWlzc2luZ1F1ZXJ5LmRlZmF1bHQobWVzc2FnZSwgZGVidWcsIGNvZGUsIGtpbnZleVJlcXVlc3RJZCk7XG4gICAgICAgIH0gZWxzZSBpZiAobmFtZSA9PT0gJ01pc3NpbmdSZXF1ZXN0SGVhZGVyJykge1xuICAgICAgICAgIHJldHVybiBuZXcgX21pc3NpbmdSZXF1ZXN0SGVhZGVyLmRlZmF1bHQobWVzc2FnZSwgZGVidWcsIGNvZGUsIGtpbnZleVJlcXVlc3RJZCk7XG4gICAgICAgIH0gZWxzZSBpZiAobmFtZSA9PT0gJ01pc3NpbmdSZXF1ZXN0UGFyYW1ldGVyJykge1xuICAgICAgICAgIHJldHVybiBuZXcgX21pc3NpbmdSZXF1ZXN0UGFyYW1ldGVyLmRlZmF1bHQobWVzc2FnZSwgZGVidWcsIGNvZGUsIGtpbnZleVJlcXVlc3RJZCk7XG4gICAgICAgIH0gZWxzZSBpZiAobmFtZSA9PT0gJ01pc3NpbmdDb25maWd1cmF0aW9uJykge1xuICAgICAgICAgIHJldHVybiBuZXcgX21pc3NpbmdDb25maWd1cmF0aW9uLmRlZmF1bHQobWVzc2FnZSwgZGVidWcsIGNvZGUsIGtpbnZleVJlcXVlc3RJZCk7XG4gICAgICAgIH0gZWxzZSBpZiAobmFtZSA9PT0gJ0VudGl0eU5vdEZvdW5kJyB8fCBuYW1lID09PSAnQ29sbGVjdGlvbk5vdEZvdW5kJyB8fCBuYW1lID09PSAnQXBwTm90Rm91bmQnIHx8IG5hbWUgPT09ICdVc2VyTm90Rm91bmQnIHx8IG5hbWUgPT09ICdCbG9iTm90Rm91bmQnIHx8IG5hbWUgPT09ICdEb2N1bWVudE5vdEZvdW5kJykge1xuICAgICAgICAgIHJldHVybiBuZXcgX25vdEZvdW5kLmRlZmF1bHQobWVzc2FnZSwgZGVidWcsIGNvZGUsIGtpbnZleVJlcXVlc3RJZCk7XG4gICAgICAgIH0gZWxzZSBpZiAobmFtZSA9PT0gJ1BhcmFtZXRlclZhbHVlT3V0T2ZSYW5nZScpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IF9wYXJhbWV0ZXJWYWx1ZU91dE9mUmFuZ2UuZGVmYXVsdChtZXNzYWdlLCBkZWJ1ZywgY29kZSwga2ludmV5UmVxdWVzdElkKTtcbiAgICAgICAgfSBlbHNlIGlmIChuYW1lID09PSAnUmVzdWx0U2V0U2l6ZUV4Y2VlZGVkJykge1xuICAgICAgICAgIHJldHVybiBuZXcgX3Jlc3VsdFNldFNpemVFeGNlZWRlZC5kZWZhdWx0KG1lc3NhZ2UsIGRlYnVnLCBjb2RlLCBraW52ZXlSZXF1ZXN0SWQpO1xuICAgICAgICB9IGVsc2UgaWYgKG5hbWUgPT09ICdTZXJ2ZXJFcnJvcicpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IF9zZXJ2ZXIuZGVmYXVsdChtZXNzYWdlLCBkZWJ1ZywgY29kZSwga2ludmV5UmVxdWVzdElkKTtcbiAgICAgICAgfSBlbHNlIGlmIChuYW1lID09PSAnU3RhbGVSZXF1ZXN0Jykge1xuICAgICAgICAgIHJldHVybiBuZXcgX3N0YWxlUmVxdWVzdC5kZWZhdWx0KG1lc3NhZ2UsIGRlYnVnLCBjb2RlLCBraW52ZXlSZXF1ZXN0SWQpO1xuICAgICAgICB9IGVsc2UgaWYgKG5hbWUgPT09ICdVc2VyQWxyZWFkeUV4aXN0cycpIHtcbiAgICAgICAgICByZXR1cm4gbmV3IF91c2VyQWxyZWFkeUV4aXN0cy5kZWZhdWx0KG1lc3NhZ2UsIGRlYnVnLCBjb2RlLCBraW52ZXlSZXF1ZXN0SWQpO1xuICAgICAgICB9IGVsc2UgaWYgKG5hbWUgPT09ICdXcml0ZXNUb0NvbGxlY3Rpb25EaXNhbGxvd2VkJykge1xuICAgICAgICAgIHJldHVybiBuZXcgX3dyaXRlc1RvQ29sbGVjdGlvbkRpc2FsbG93ZWQuZGVmYXVsdChtZXNzYWdlLCBkZWJ1ZywgY29kZSwga2ludmV5UmVxdWVzdElkKTtcbiAgICAgICAgfSBlbHNlIGlmIChjb2RlID09PSBTdGF0dXNDb2RlLlVuYXV0aG9yaXplZCB8fCBjb2RlID09PSBTdGF0dXNDb2RlLkZvcmJpZGRlbikge1xuICAgICAgICAgIHJldHVybiBuZXcgX2luc3VmZmljaWVudENyZWRlbnRpYWxzLmRlZmF1bHQobWVzc2FnZSwgZGVidWcsIGNvZGUsIGtpbnZleVJlcXVlc3RJZCk7XG4gICAgICAgIH0gZWxzZSBpZiAoY29kZSA9PT0gU3RhdHVzQ29kZS5Ob3RGb3VuZCkge1xuICAgICAgICAgIHJldHVybiBuZXcgX25vdEZvdW5kLmRlZmF1bHQobWVzc2FnZSwgZGVidWcsIGNvZGUsIGtpbnZleVJlcXVlc3RJZCk7XG4gICAgICAgIH0gZWxzZSBpZiAoY29kZSA9PT0gU3RhdHVzQ29kZS5TZXJ2ZXJFcnJvcikge1xuICAgICAgICAgIHJldHVybiBuZXcgX3NlcnZlci5kZWZhdWx0KG1lc3NhZ2UsIGRlYnVnLCBjb2RlLCBraW52ZXlSZXF1ZXN0SWQpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG5ldyBfa2ludmV5LmRlZmF1bHQobWVzc2FnZSwgZGVidWcsIGNvZGUsIGtpbnZleVJlcXVlc3RJZCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfV0pO1xuICByZXR1cm4gUmVzcG9uc2U7XG59KCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IFJlc3BvbnNlOyIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZm9ybWF0S2ludmV5VXJsID0gZm9ybWF0S2ludmV5VXJsO1xuZXhwb3J0cy5zZXJpYWxpemUgPSBzZXJpYWxpemU7XG5leHBvcnRzLnBhcnNlID0gcGFyc2U7XG5cbnZhciBfdXJsID0gcmVxdWlyZShcInVybFwiKTtcblxudmFyIF9pc1N0cmluZyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcImxvZGFzaC9pc1N0cmluZ1wiKSk7XG5cbnZhciBfaXNQbGFpbk9iamVjdCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcImxvZGFzaC9pc1BsYWluT2JqZWN0XCIpKTtcblxuZnVuY3Rpb24gY2xlYW4odmFsdWUpIHtcbiAgaWYgKCgwLCBfaXNQbGFpbk9iamVjdC5kZWZhdWx0KSh2YWx1ZSkpIHtcbiAgICByZXR1cm4gT2JqZWN0LmtleXModmFsdWUpLnJlZHVjZShmdW5jdGlvbiAoY2xlYW5WYWwsIGtleSkge1xuICAgICAgdmFyIG9ialZhbCA9IHZhbHVlW2tleV07XG5cbiAgICAgIGlmICgoMCwgX2lzUGxhaW5PYmplY3QuZGVmYXVsdCkob2JqVmFsKSkge1xuICAgICAgICBvYmpWYWwgPSBjbGVhbihvYmpWYWwpO1xuICAgICAgfVxuXG4gICAgICBpZiAodHlwZW9mIG9ialZhbCAhPT0gJ3VuZGVmaW5lZCcgJiYgb2JqVmFsICE9PSBudWxsKSB7XG4gICAgICAgIGNsZWFuVmFsW2tleV0gPSBvYmpWYWw7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBjbGVhblZhbDtcbiAgICB9LCB7fSk7XG4gIH1cblxuICByZXR1cm4gdmFsdWU7XG59XG5cbmZ1bmN0aW9uIGZvcm1hdEtpbnZleVVybChwcm90b2NvbCwgaG9zdCwgcGF0aG5hbWUsIHF1ZXJ5KSB7XG4gIHZhciBjbGVhblF1ZXJ5ID0gY2xlYW4ocXVlcnkpO1xuICByZXR1cm4gKDAsIF91cmwuZm9ybWF0KSh7XG4gICAgcHJvdG9jb2w6IHByb3RvY29sLFxuICAgIGhvc3Q6IGhvc3QsXG4gICAgcGF0aG5hbWU6IHBhdGhuYW1lLFxuICAgIHF1ZXJ5OiBjbGVhblF1ZXJ5XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBzZXJpYWxpemUoY29udGVudFR5cGUsIGJvZHkpIHtcbiAgaWYgKGJvZHkgJiYgISgwLCBfaXNTdHJpbmcuZGVmYXVsdCkoYm9keSkpIHtcbiAgICBpZiAoY29udGVudFR5cGUuaW5kZXhPZignYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJykgPT09IDApIHtcbiAgICAgIHZhciBzdHIgPSBbXTtcbiAgICAgIE9iamVjdC5rZXlzKGJvZHkpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgICAgICBzdHIucHVzaChcIlwiLmNvbmNhdChnbG9iYWwuZW5jb2RlVVJJQ29tcG9uZW50KGtleSksIFwiPVwiKS5jb25jYXQoZ2xvYmFsLmVuY29kZVVSSUNvbXBvbmVudChib2R5W2tleV0pKSk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBzdHIuam9pbignJicpO1xuICAgIH0gZWxzZSBpZiAoY29udGVudFR5cGUuaW5kZXhPZignYXBwbGljYXRpb24vanNvbicpID09PSAwKSB7XG4gICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoYm9keSk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGJvZHk7XG59XG5cbmZ1bmN0aW9uIHBhcnNlKCkge1xuICB2YXIgY29udGVudFR5cGUgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6ICdhcHBsaWNhdGlvbi9qc29uJztcbiAgdmFyIGRhdGEgPSBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZDtcblxuICBpZiAoKDAsIF9pc1N0cmluZy5kZWZhdWx0KShkYXRhKSkge1xuICAgIGlmIChjb250ZW50VHlwZS5pbmRleE9mKCdhcHBsaWNhdGlvbi9qc29uJykgPT09IDApIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHJldHVybiBKU09OLnBhcnNlKGRhdGEpO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHsvLyBUT0RPOiBsb2cgZXJyb3JcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gZGF0YTtcbn0iLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkID0gcmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW50ZXJvcFJlcXVpcmVXaWxkY2FyZFwiKTtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5cbnZhciBfYWNsID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9hY2xcIikpO1xuXG52YXIgX3N0b3JlID0gcmVxdWlyZShcIi4vY2FjaGUvc3RvcmVcIik7XG5cbnZhciBEYXRhU3RvcmUgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKFwiLi9kYXRhc3RvcmVcIikpO1xuXG52YXIgX2ttZCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4va21kXCIpKTtcblxudmFyIF9xdWVyeSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vcXVlcnlcIikpO1xuXG52YXIgRmlsZXMgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKFwiLi9maWxlc1wiKSk7XG5cbnZhciBfZW5kcG9pbnQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL2VuZHBvaW50XCIpKTtcblxudmFyIF9hZ2dyZWdhdGlvbiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vYWdncmVnYXRpb25cIikpO1xuXG52YXIgX2luaXQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL2tpbnZleS9pbml0XCIpKTtcblxudmFyIF9pbml0aWFsaXplID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9raW52ZXkvaW5pdGlhbGl6ZVwiKSk7XG5cbnZhciBfYXBwVmVyc2lvbiA9IHJlcXVpcmUoXCIuL2tpbnZleS9hcHBWZXJzaW9uXCIpO1xuXG52YXIgX3VzZXIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL3VzZXJcIikpO1xuXG4vLyBTREtcbnZhciBTREsgPSB7XG4gIGluaXQ6IF9pbml0LmRlZmF1bHQsXG4gIGluaXRpYWxpemU6IF9pbml0aWFsaXplLmRlZmF1bHQsXG4gIGdldEFwcFZlcnNpb246IF9hcHBWZXJzaW9uLmdldCxcbiAgc2V0QXBwVmVyc2lvbjogX2FwcFZlcnNpb24uc2V0LFxuICAvLyBBY2xcbiAgQWNsOiBfYWNsLmRlZmF1bHQsXG4gIC8vIEFnZ3JlZ2F0aW9uXG4gIEFnZ3JlZ2F0aW9uOiBfYWdncmVnYXRpb24uZGVmYXVsdCxcbiAgLy8gRGF0YVN0b3JlXG4gIERhdGFTdG9yZTogRGF0YVN0b3JlLFxuICBEYXRhU3RvcmVUeXBlOiBEYXRhU3RvcmUuRGF0YVN0b3JlVHlwZSxcbiAgU3RvcmFnZVByb3ZpZGVyOiBfc3RvcmUuU3RvcmFnZVByb3ZpZGVyLFxuICAvLyBDdXN0b20gRW5kcG9pbnRcbiAgQ3VzdG9tRW5kcG9pbnQ6IHtcbiAgICBleGVjdXRlOiBfZW5kcG9pbnQuZGVmYXVsdFxuICB9LFxuICAvLyBGaWxlc1xuICBGaWxlczogRmlsZXMsXG4gIC8vIEttZFxuICBLbWQ6IF9rbWQuZGVmYXVsdCxcbiAgTWV0YWRhdGE6IF9rbWQuZGVmYXVsdCxcbiAgLy8gUXVlcnlcbiAgUXVlcnk6IF9xdWVyeS5kZWZhdWx0LFxuICAvLyBVc2VyXG4gIFVzZXI6IF91c2VyLmRlZmF1bHQsXG4gIEF1dGhvcml6YXRpb25HcmFudDogX3VzZXIuZGVmYXVsdC5BdXRob3JpemF0aW9uR3JhbnRcbn07IC8vIEV4cG9ydFxuXG5tb2R1bGUuZXhwb3J0cyA9IFNESzsiLCJcInVzZSBzdHJpY3RcIjtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZ2V0ID0gZ2V0O1xuZXhwb3J0cy5zZXQgPSBzZXQ7XG5cbnZhciBfY29uZmlnID0gcmVxdWlyZShcIi4vY29uZmlnXCIpO1xuXG4vKipcbiAqIFRoZSB2ZXJzaW9uIG9mIHlvdXIgYXBwLiBJdCB3aWxsIHNlbnQgd2l0aCBLaW52ZXkgQVBJIHJlcXVlc3RzXG4gKiB1c2luZyB0aGUgWC1LaW52ZXktQXBpLVZlcnNpb24gaGVhZGVyLlxuICpcbiAqIEByZXR1cm4ge3N0cmluZ30gVGhlIHZlcnNpb24gb2YgeW91ciBhcHAuXG4gKi9cbmZ1bmN0aW9uIGdldCgpIHtcbiAgdmFyIGNvbmZpZyA9ICgwLCBfY29uZmlnLmdldCkoKTtcbiAgcmV0dXJuIGNvbmZpZy5hcHBWZXJzaW9uO1xufVxuLyoqXG4gKiBTZXQgdGhlIHZlcnNpb24gb2YgeW91ciBhcHAuIEl0IHdpbGwgc2VudCB3aXRoIEtpbnZleSBBUEkgcmVxdWVzdHNcbiAqIHVzaW5nIHRoZSBYLUtpbnZleS1BcGktVmVyc2lvbiBoZWFkZXIuXG4gKlxuICogQHBhcmFtICB7c3RyaW5nfSBhcHBWZXJzaW9uICBBcHAgdmVyc2lvbi5cbiAqL1xuXG5cbmZ1bmN0aW9uIHNldChhcHBWZXJzaW9uKSB7XG4gIHZhciBjb25maWcgPSAoMCwgX2NvbmZpZy5nZXQpKCk7XG4gIGNvbmZpZy5hcHBWZXJzaW9uID0gYXBwVmVyc2lvbjtcbiAgKDAsIF9jb25maWcuc2V0KShjb25maWcpO1xuICByZXR1cm4gdHJ1ZTtcbn0iLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmdldCA9IGdldDtcbmV4cG9ydHMuc2V0ID0gc2V0O1xuZXhwb3J0cy5yZW1vdmUgPSByZW1vdmU7XG5cbnZhciBfa2ludmV5ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vZXJyb3JzL2tpbnZleVwiKSk7XG5cbnZhciBtYXAgPSBuZXcgTWFwKCk7XG52YXIgYXBwS2V5O1xuXG5mdW5jdGlvbiBnZXRLZXkoKSB7XG4gIGlmIChhcHBLZXkpIHtcbiAgICByZXR1cm4gXCJcIi5jb25jYXQoYXBwS2V5LCBcIi5jb25maWdcIik7XG4gIH1cblxuICByZXR1cm4gdW5kZWZpbmVkO1xufVxuXG5mdW5jdGlvbiBnZXQoKSB7XG4gIHZhciBrZXkgPSBnZXRLZXkoKTtcblxuICBpZiAoa2V5KSB7XG4gICAgdmFyIGNvbmZpZyA9IG1hcC5nZXQoa2V5KTtcblxuICAgIGlmIChjb25maWcpIHtcbiAgICAgIHJldHVybiBjb25maWc7XG4gICAgfVxuICB9XG5cbiAgdGhyb3cgbmV3IF9raW52ZXkuZGVmYXVsdCgnWW91IGhhdmUgbm90IGluaXRpYWxpemVkIHRoZSBLaW52ZXkgU0RLLicpO1xufVxuXG5mdW5jdGlvbiBzZXQoY29uZmlnKSB7XG4gIGlmIChjb25maWcgJiYgY29uZmlnLmFwcEtleSkge1xuICAgIGFwcEtleSA9IGNvbmZpZy5hcHBLZXk7XG4gICAgdmFyIGtleSA9IGdldEtleSgpO1xuICAgIG1hcC5zZXQoa2V5LCBjb25maWcpO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5mdW5jdGlvbiByZW1vdmUoKSB7XG4gIHZhciBrZXkgPSBnZXRLZXkoKTtcblxuICBpZiAoa2V5KSB7XG4gICAgbWFwLmRlbGV0ZShrZXkpO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgcmV0dXJuIGZhbHNlO1xufSIsIlwidXNlIHN0cmljdFwiO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5nZXRJZCA9IGdldElkO1xuXG52YXIgX3V0aWxzID0gcmVxdWlyZShcIi4vdXRpbHNcIik7XG5cbnZhciBfY29uZmlnID0gcmVxdWlyZShcIi4vY29uZmlnXCIpO1xuXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L3ByZWZlci1kZWZhdWx0LWV4cG9ydFxuZnVuY3Rpb24gZ2V0SWQoKSB7XG4gIHZhciBfZ2V0Q29uZmlnID0gKDAsIF9jb25maWcuZ2V0KSgpLFxuICAgICAgYXBwS2V5ID0gX2dldENvbmZpZy5hcHBLZXk7XG5cbiAgdmFyIGtleSA9IFwiXCIuY29uY2F0KGFwcEtleSwgXCIuZGV2aWNlSWRcIik7XG4gIHZhciBpZCA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpO1xuXG4gIGlmICghaWQpIHtcbiAgICBpZCA9ICgwLCBfdXRpbHMudXVpZHY0KSgpO1xuICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShrZXksIGlkKTtcbiAgfVxuXG4gIHJldHVybiBpZDtcbn0iLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSBpbml0O1xuXG52YXIgX2lzU3RyaW5nID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwibG9kYXNoL2lzU3RyaW5nXCIpKTtcblxudmFyIF9pc051bWJlciA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcImxvZGFzaC9pc051bWJlclwiKSk7XG5cbnZhciBfdXJsID0gcmVxdWlyZShcInVybFwiKTtcblxudmFyIF9raW52ZXkgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi9lcnJvcnMva2ludmV5XCIpKTtcblxudmFyIF9jb25maWcgPSByZXF1aXJlKFwiLi9jb25maWdcIik7XG5cbnZhciBERUZBVUxUX1RJTUVPVVQgPSA2MDAwMDtcblxuZnVuY3Rpb24gaW5pdCgpIHtcbiAgdmFyIGNvbmZpZyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307XG4gIHZhciBhcHBLZXkgPSBjb25maWcuYXBwS2V5LFxuICAgICAgYXBwU2VjcmV0ID0gY29uZmlnLmFwcFNlY3JldCxcbiAgICAgIG1hc3RlclNlY3JldCA9IGNvbmZpZy5tYXN0ZXJTZWNyZXQsXG4gICAgICBhcHBWZXJzaW9uID0gY29uZmlnLmFwcFZlcnNpb24sXG4gICAgICBpbnN0YW5jZUlkID0gY29uZmlnLmluc3RhbmNlSWQsXG4gICAgICBlbmNyeXB0aW9uS2V5ID0gY29uZmlnLmVuY3J5cHRpb25LZXksXG4gICAgICBzdG9yYWdlID0gY29uZmlnLnN0b3JhZ2U7XG4gIHZhciBkZWZhdWx0VGltZW91dCA9ICgwLCBfaXNOdW1iZXIuZGVmYXVsdCkoY29uZmlnLmRlZmF1bHRUaW1lb3V0KSAmJiBjb25maWcuZGVmYXVsdFRpbWVvdXQgPj0gMCA/IGNvbmZpZy5kZWZhdWx0VGltZW91dCA6IERFRkFVTFRfVElNRU9VVDtcbiAgdmFyIGFwaUhvc3RuYW1lID0gJ2h0dHBzOi8vYmFhcy5raW52ZXkuY29tJztcbiAgdmFyIGF1dGhIb3N0bmFtZSA9ICdodHRwczovL2F1dGgua2ludmV5LmNvbSc7XG5cbiAgaWYgKGluc3RhbmNlSWQpIHtcbiAgICBpZiAoISgwLCBfaXNTdHJpbmcuZGVmYXVsdCkoaW5zdGFuY2VJZCkpIHtcbiAgICAgIHRocm93IG5ldyBfa2ludmV5LmRlZmF1bHQoJ0luc3RhbmNlIElEIG11c3QgYmUgYSBzdHJpbmcuJyk7XG4gICAgfVxuXG4gICAgYXBpSG9zdG5hbWUgPSBcImh0dHBzOi8vXCIuY29uY2F0KGluc3RhbmNlSWQsIFwiLWJhYXMua2ludmV5LmNvbVwiKTtcbiAgICBhdXRoSG9zdG5hbWUgPSBcImh0dHBzOi8vXCIuY29uY2F0KGluc3RhbmNlSWQsIFwiLWF1dGgua2ludmV5LmNvbVwiKTtcbiAgfSBlbHNlIHtcbiAgICBpZiAoKDAsIF9pc1N0cmluZy5kZWZhdWx0KShjb25maWcuYXBpSG9zdG5hbWUpKSB7XG4gICAgICBhcGlIb3N0bmFtZSA9IC9eaHR0cHM/OlxcL1xcLy9pLnRlc3QoY29uZmlnLmFwaUhvc3RuYW1lKSA/IGNvbmZpZy5hcGlIb3N0bmFtZSA6IFwiaHR0cHM6Ly9cIi5jb25jYXQoY29uZmlnLmFwaUhvc3RuYW1lKTtcbiAgICB9XG5cbiAgICBpZiAoKDAsIF9pc1N0cmluZy5kZWZhdWx0KShjb25maWcubWljSG9zdG5hbWUpKSB7XG4gICAgICBhdXRoSG9zdG5hbWUgPSAvXmh0dHBzPzpcXC9cXC8vaS50ZXN0KGNvbmZpZy5taWNIb3N0bmFtZSkgPyBjb25maWcubWljSG9zdG5hbWUgOiBcImh0dHBzOi8vXCIuY29uY2F0KGNvbmZpZy5taWNIb3N0bmFtZSk7XG4gICAgfVxuICB9XG5cbiAgaWYgKCEoMCwgX2lzU3RyaW5nLmRlZmF1bHQpKGFwcEtleSkpIHtcbiAgICB0aHJvdyBuZXcgX2tpbnZleS5kZWZhdWx0KCdBbiBhcHBLZXkgaXMgcmVxdWlyZWQgYW5kIG11c3QgYmUgYSBzdHJpbmcuJyk7XG4gIH1cblxuICBpZiAoISgwLCBfaXNTdHJpbmcuZGVmYXVsdCkoYXBwU2VjcmV0KSAmJiAhKDAsIF9pc1N0cmluZy5kZWZhdWx0KShtYXN0ZXJTZWNyZXQpKSB7XG4gICAgdGhyb3cgbmV3IF9raW52ZXkuZGVmYXVsdCgnQW4gYXBwU2VjcmV0IGlzIHJlcXVpcmVkIGFuZCBtdXN0IGJlIGEgc3RyaW5nLicpO1xuICB9XG5cbiAgaWYgKGFwcFZlcnNpb24gJiYgISgwLCBfaXNTdHJpbmcuZGVmYXVsdCkoYXBwVmVyc2lvbikpIHtcbiAgICB0aHJvdyBuZXcgX2tpbnZleS5kZWZhdWx0KCdBbiBhcHBWZXJzaW9uIG11c3QgYmUgYSBzdHJpbmcuJyk7XG4gIH1cblxuICBpZiAoZW5jcnlwdGlvbktleSAmJiAhKDAsIF9pc1N0cmluZy5kZWZhdWx0KShlbmNyeXB0aW9uS2V5KSkge1xuICAgIHRocm93IG5ldyBfa2ludmV5LmRlZmF1bHQoJ0FuIGVuY3J5cHRpb25LZXkgbXVzdCBiZSBhIHN0cmluZy4nKTtcbiAgfSAvLyBUT0RPOiBBZGQgY2hlY2sgaW4gZnV0dXJlXG4gIC8vIGlmIChkZWZhdWx0VGltZW91dCAhPSBudWxsICYmICghaXNOdW1iZXIoZGVmYXVsdFRpbWVvdXQpIHx8IGRlZmF1bHRUaW1lb3V0IDwgMSkpIHtcbiAgLy8gICB0aHJvdyBuZXcgS2luZXlFcnJvcignQSBkZWZhdWx0VGltZW91dCBtdXN0IGJlIGEgbnVtYmVyIGdyZWF0ZXIgdGhlbiAwLicpO1xuICAvLyB9XG4gIC8vIENyZWF0ZSB0aGUgaW50ZXJuYWwgY29uZmlnXG5cblxuICB2YXIgaW50ZXJuYWxDb25maWcgPSB7XG4gICAgYXBwS2V5OiBhcHBLZXksXG4gICAgYXBwU2VjcmV0OiBhcHBTZWNyZXQsXG4gICAgbWFzdGVyU2VjcmV0OiBtYXN0ZXJTZWNyZXQsXG4gICAgZW5jcnlwdGlvbktleTogZW5jcnlwdGlvbktleSxcbiAgICBhcHBWZXJzaW9uOiBhcHBWZXJzaW9uLFxuICAgIF9hcHBWZXJzaW9uOiBhcHBWZXJzaW9uLFxuICAgIGRlZmF1bHRUaW1lb3V0OiBkZWZhdWx0VGltZW91dCxcbiAgICBfZGVmYXVsdFRpbWVvdXQ6IGRlZmF1bHRUaW1lb3V0LFxuICAgIHN0b3JhZ2U6IHN0b3JhZ2UsXG4gICAgYXBpUHJvdG9jb2w6ICgwLCBfdXJsLnBhcnNlKShhcGlIb3N0bmFtZSkucHJvdG9jb2wsXG4gICAgYXBpSG9zdDogKDAsIF91cmwucGFyc2UpKGFwaUhvc3RuYW1lKS5ob3N0LFxuICAgIGFwaUhvc3RuYW1lOiBhcGlIb3N0bmFtZSxcbiAgICBhdXRoUHJvdG9jb2w6ICgwLCBfdXJsLnBhcnNlKShhdXRoSG9zdG5hbWUpLnByb3RvY29sLFxuICAgIGF1dGhIb3N0OiAoMCwgX3VybC5wYXJzZSkoYXV0aEhvc3RuYW1lKS5ob3N0LFxuICAgIGF1dGhIb3N0bmFtZTogYXV0aEhvc3RuYW1lLFxuICAgIG1pY1Byb3RvY29sOiAoMCwgX3VybC5wYXJzZSkoYXV0aEhvc3RuYW1lKS5wcm90b2NvbCxcbiAgICBtaWNIb3N0OiAoMCwgX3VybC5wYXJzZSkoYXV0aEhvc3RuYW1lKS5ob3N0LFxuICAgIG1pY0hvc3RuYW1lOiBhdXRoSG9zdG5hbWVcbiAgfTsgLy8gU2V0IHRoZSBpbnRlcm5hbCBjb25maWdcblxuICAoMCwgX2NvbmZpZy5zZXQpKGludGVybmFsQ29uZmlnKTsgLy8gUmV0dXJuIHRoZSBpbnRlcm5hbCBjb25maWdcblxuICByZXR1cm4gaW50ZXJuYWxDb25maWc7XG59IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gcmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW50ZXJvcFJlcXVpcmVEZWZhdWx0XCIpO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gaW5pdGlhbGl6ZTtcblxudmFyIF9raW52ZXkgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi9lcnJvcnMva2ludmV5XCIpKTtcblxuLyoqXG4gKiBAZGVwcmVjYXRlZCBQbGVhc2UgdXNlIGluaXQoKS5cbiAqL1xuZnVuY3Rpb24gaW5pdGlhbGl6ZSgpIHtcbiAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBfa2ludmV5LmRlZmF1bHQoJ2luaXRpYWxpemUoKSBoYXMgYmVlbiBkZXByZWNhdGVkLiBQbGVhc2UgdXNlIGluaXQoKS4nKSk7XG59IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLnM0ID0gczQ7XG5leHBvcnRzLnV1aWR2NCA9IHV1aWR2NDtcblxuZnVuY3Rpb24gczQoKSB7XG4gIHJldHVybiBNYXRoLmZsb29yKCgxICsgTWF0aC5yYW5kb20oKSkgKiAweDEwMDAwKS50b1N0cmluZygxNikuc3Vic3RyaW5nKDEpO1xufVxuXG5mdW5jdGlvbiB1dWlkdjQoKSB7XG4gIHJldHVybiBcIlwiLmNvbmNhdChzNCgpKS5jb25jYXQoczQoKSwgXCItXCIpLmNvbmNhdChzNCgpLCBcIi1cIikuY29uY2F0KHM0KCksIFwiLVwiKS5jb25jYXQoczQoKSwgXCItXCIpLmNvbmNhdChzNCgpKS5jb25jYXQoczQoKSkuY29uY2F0KHM0KCkpO1xufSIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcblxudmFyIF9jbGFzc0NhbGxDaGVjazIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrXCIpKTtcblxudmFyIF9jcmVhdGVDbGFzczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2NyZWF0ZUNsYXNzXCIpKTtcblxudmFyIF9pc1BsYWluT2JqZWN0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwibG9kYXNoL2lzUGxhaW5PYmplY3RcIikpO1xuXG52YXIgX2tpbnZleSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vZXJyb3JzL2tpbnZleVwiKSk7XG5cbi8qKlxuICogVGhpcyBjbGFzcyBwcm92aWRlcyBhIHdheSB0byBhY2Nlc3MgdGhlIEtNRCAoS2ludmV5IE1ldGFkYXRhKVxuICogaW5mb3JtYXRpb24gZm9yIGFuIGVudGl0eS5cbiAqL1xudmFyIEttZCA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIEttZChlbnRpdHkpIHtcbiAgICAoMCwgX2NsYXNzQ2FsbENoZWNrMi5kZWZhdWx0KSh0aGlzLCBLbWQpO1xuXG4gICAgaWYgKCEoMCwgX2lzUGxhaW5PYmplY3QuZGVmYXVsdCkoZW50aXR5KSkge1xuICAgICAgdGhyb3cgbmV3IF9raW52ZXkuZGVmYXVsdCgnZW50aXR5IGFyZ3VtZW50IG11c3QgYmUgYW4gb2JqZWN0Jyk7XG4gICAgfVxuXG4gICAgZW50aXR5Ll9rbWQgPSBlbnRpdHkuX2ttZCB8fCB7fTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1wYXJhbS1yZWFzc2lnblxuXG4gICAgdGhpcy5lbnRpdHkgPSBlbnRpdHk7XG4gIH1cbiAgLyoqXG4gICAqIEdldCB0aGUgYXV0aCB0b2tlbi5cbiAgICpcbiAgICogQHJldHVybnMge3N0cmluZ30gX2ttZC5hdXRodG9rZW5cbiAgICovXG5cblxuICAoMCwgX2NyZWF0ZUNsYXNzMi5kZWZhdWx0KShLbWQsIFt7XG4gICAga2V5OiBcImlzRW1haWxDb25maXJtZWRcIixcblxuICAgIC8qKlxuICAgICAqIENoZWNrcyBpZiBhbiBlbWFpbCBmb3IgYSB1c2VyIGhhcyBiZWVuIGNvbmZpcm1lZC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHRoZSBlbWFpbCBoYXMgYmVlbiBjb25maXJtZWQgb3RoZXJ3aXNlIGZhbHNlXG4gICAgICovXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGlzRW1haWxDb25maXJtZWQoKSB7XG4gICAgICBpZiAodGhpcy5lbWFpbFZlcmlmaWNhdGlvbikge1xuICAgICAgICByZXR1cm4gdGhpcy5lbWFpbFZlcmlmaWNhdGlvbi5zdGF0dXMgPT09ICdjb25maXJtZWQnO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENoZWNrcyBpZiB0aGUgZW50aXR5IGhhcyBiZWVuIGNyZWF0ZWQgbG9jYWxseS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHRoZSBlbnRpdHkgaGFzIGJlZW4gY3JlYXRlZCBsb2NhbGx5IG90aGVyd2lzZSBmYWxzZVxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6IFwiaXNMb2NhbFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBpc0xvY2FsKCkge1xuICAgICAgcmV0dXJuIHRoaXMuZW50aXR5Ll9rbWQubG9jYWwgPT09IHRydWU7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInRvUGxhaW5PYmplY3RcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gdG9QbGFpbk9iamVjdCgpIHtcbiAgICAgIHJldHVybiB0aGlzLmVudGl0eS5fa21kO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJhdXRodG9rZW5cIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLmVudGl0eS5fa21kLmF1dGh0b2tlbjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0IGNyZWF0ZWQgYXQgdGltZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtEYXRlP30gX2ttZC5lY3RcbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiBcImVjdFwiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlZEF0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgY3JlYXRlZCBhdCB0aW1lLlxuICAgICAqXG4gICAgICogQHJldHVybnMge0RhdGU/fSBfa21kLmVjdFxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6IFwiY3JlYXRlZEF0XCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICBpZiAodGhpcy5lbnRpdHkuX2ttZC5lY3QpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBEYXRlKHRoaXMuZW50aXR5Ll9rbWQuZWN0KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0IGxhc3QgbW9kaWZpZWQgdGltZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtEYXRlP30gX2ttZC5sbXRcbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiBcImxtdFwiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMudXBkYXRlZEF0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgbGFzdCBtb2RpZmllZCB0aW1lLlxuICAgICAqXG4gICAgICogQHJldHVybnMge0RhdGU/fSBfa21kLmxtdFxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6IFwibGFzdE1vZGlmaWVkXCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICByZXR1cm4gdGhpcy51cGRhdGVkQXQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldCBsYXN0IG1vZGlmaWVkIHRpbWUuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7RGF0ZT99IF9rbWQubG10XG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJ1cGRhdGVkQXRcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIGlmICh0aGlzLmVudGl0eS5fa21kLmxtdCkge1xuICAgICAgICByZXR1cm4gbmV3IERhdGUodGhpcy5lbnRpdHkuX2ttZC5sbXQpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGVtYWlsIHZlcmlmaWNhdGlvbiBkZXRhaWxzLlxuICAgICAqXG4gICAgICogQHJldHVybnMge09iamVjdH0gX2ttZC5lbWFpbFZlcmlmaWNhdGlvblxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6IFwiZW1haWxWZXJpZmljYXRpb25cIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIGlmICh0aGlzLmVudGl0eS5fa21kLmVtYWlsVmVyaWZpY2F0aW9uKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVudGl0eS5fa21kLmVtYWlsVmVyaWZpY2F0aW9uLnN0YXR1cztcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gIH1dKTtcbiAgcmV0dXJuIEttZDtcbn0oKTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gS21kOyIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuaXNSZWdpc3RlcmVkID0gaXNSZWdpc3RlcmVkO1xuZXhwb3J0cy5yZWdpc3RlciA9IHJlZ2lzdGVyO1xuZXhwb3J0cy51bnJlZ2lzdGVyID0gdW5yZWdpc3RlcjtcbmV4cG9ydHMuc3Vic2NyaWJlVG9DaGFubmVsID0gc3Vic2NyaWJlVG9DaGFubmVsO1xuZXhwb3J0cy51bnN1YnNjcmliZUZyb21DaGFubmVsID0gdW5zdWJzY3JpYmVGcm9tQ2hhbm5lbDtcbmV4cG9ydHMuTGlzdGVuZXIgPSB2b2lkIDA7XG5cbnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVja1wiKSk7XG5cbnZhciBfY3JlYXRlQ2xhc3MyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jcmVhdGVDbGFzc1wiKSk7XG5cbnZhciBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm5cIikpO1xuXG52YXIgX2dldFByb3RvdHlwZU9mMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZ2V0UHJvdG90eXBlT2ZcIikpO1xuXG52YXIgX2luaGVyaXRzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW5oZXJpdHNcIikpO1xuXG52YXIgX2lzRnVuY3Rpb24gPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJsb2Rhc2gvaXNGdW5jdGlvblwiKSk7XG5cbnZhciBfcHVibnViID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwicHVibnViXCIpKTtcblxudmFyIF9ldmVudHMgPSByZXF1aXJlKFwiZXZlbnRzXCIpO1xuXG52YXIgX2tpbnZleSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vZXJyb3JzL2tpbnZleVwiKSk7XG5cbnZhciBTVEFUVVNfUFJFRklYID0gJ3N0YXR1czonO1xudmFyIFVOQ0xBU1NJRklFRF9FVkVOVFMgPSAncHViTnViRXZlbnRzTm90Um91dGVkJztcbnZhciBwdWJudWI7XG52YXIgbGlzdGVuZXI7XG5cbmZ1bmN0aW9uIGlzVmFsaWRDaGFubmVsTmFtZShjaGFubmVsTmFtZSkge1xuICByZXR1cm4gdHlwZW9mIGNoYW5uZWxOYW1lID09PSAnc3RyaW5nJyAmJiBjaGFubmVsTmFtZSAhPT0gJyc7XG59XG5cbmZ1bmN0aW9uIGlzVmFsaWRSZWNlaXZlcihyZWNlaXZlcikge1xuICBpZiAoIXJlY2VpdmVyKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgdmFyIG9uTWVzc2FnZSA9IHJlY2VpdmVyLm9uTWVzc2FnZSxcbiAgICAgIG9uRXJyb3IgPSByZWNlaXZlci5vbkVycm9yLFxuICAgICAgb25TdGF0dXMgPSByZWNlaXZlci5vblN0YXR1cztcbiAgcmV0dXJuICgwLCBfaXNGdW5jdGlvbi5kZWZhdWx0KShvbk1lc3NhZ2UpIHx8ICgwLCBfaXNGdW5jdGlvbi5kZWZhdWx0KShvbkVycm9yKSB8fCAoMCwgX2lzRnVuY3Rpb24uZGVmYXVsdCkob25TdGF0dXMpO1xufVxuXG52YXIgTGlzdGVuZXIgPVxuLyojX19QVVJFX18qL1xuZnVuY3Rpb24gKF9FdmVudEVtaXR0ZXIpIHtcbiAgKDAsIF9pbmhlcml0czIuZGVmYXVsdCkoTGlzdGVuZXIsIF9FdmVudEVtaXR0ZXIpO1xuXG4gIGZ1bmN0aW9uIExpc3RlbmVyKCkge1xuICAgICgwLCBfY2xhc3NDYWxsQ2hlY2syLmRlZmF1bHQpKHRoaXMsIExpc3RlbmVyKTtcbiAgICByZXR1cm4gKDAsIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMi5kZWZhdWx0KSh0aGlzLCAoMCwgX2dldFByb3RvdHlwZU9mMi5kZWZhdWx0KShMaXN0ZW5lcikuYXBwbHkodGhpcywgYXJndW1lbnRzKSk7XG4gIH1cblxuICAoMCwgX2NyZWF0ZUNsYXNzMi5kZWZhdWx0KShMaXN0ZW5lciwgW3tcbiAgICBrZXk6IFwibWVzc2FnZVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBtZXNzYWdlKG0pIHtcbiAgICAgIHRoaXMuZW1pdChtLmNoYW5uZWwsIG0pO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJzdGF0dXNcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gc3RhdHVzKHMpIHtcbiAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICAgIHZhciBfcyRhZmZlY3RlZENoYW5uZWxzID0gcy5hZmZlY3RlZENoYW5uZWxzLFxuICAgICAgICAgIGFmZmVjdGVkQ2hhbm5lbHMgPSBfcyRhZmZlY3RlZENoYW5uZWxzID09PSB2b2lkIDAgPyBbXSA6IF9zJGFmZmVjdGVkQ2hhbm5lbHMsXG4gICAgICAgICAgX3MkYWZmZWN0ZWRDaGFubmVsR3JvID0gcy5hZmZlY3RlZENoYW5uZWxHcm91cHMsXG4gICAgICAgICAgYWZmZWN0ZWRDaGFubmVsR3JvdXBzID0gX3MkYWZmZWN0ZWRDaGFubmVsR3JvID09PSB2b2lkIDAgPyBbXSA6IF9zJGFmZmVjdGVkQ2hhbm5lbEdybztcbiAgICAgIHZhciBhbGxDaGFubmVscyA9IGFmZmVjdGVkQ2hhbm5lbHMuY29uY2F0KGFmZmVjdGVkQ2hhbm5lbEdyb3Vwcyk7XG4gICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgZXJyb3I6IHMuZXJyb3IsXG4gICAgICAgIGNhdGVnb3J5OiBzLmNhdGVnb3J5LFxuICAgICAgICBvcGVyYXRpb246IHMub3BlcmF0aW9uXG4gICAgICB9O1xuXG4gICAgICBpZiAoYWxsQ2hhbm5lbHMubGVuZ3RoID4gMCkge1xuICAgICAgICBhbGxDaGFubmVscy5mb3JFYWNoKGZ1bmN0aW9uIChjaGFubmVsT3JHcm91cCkge1xuICAgICAgICAgIF90aGlzLmVtaXQoXCJcIi5jb25jYXQoU1RBVFVTX1BSRUZJWCkuY29uY2F0KGNoYW5uZWxPckdyb3VwKSwgZGF0YSk7XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5lbWl0KFVOQ0xBU1NJRklFRF9FVkVOVFMsIGRhdGEpO1xuICAgICAgfVxuICAgIH1cbiAgfV0pO1xuICByZXR1cm4gTGlzdGVuZXI7XG59KF9ldmVudHMuRXZlbnRFbWl0dGVyKTtcblxuZXhwb3J0cy5MaXN0ZW5lciA9IExpc3RlbmVyO1xuXG5mdW5jdGlvbiBpc1JlZ2lzdGVyZWQoKSB7XG4gIHJldHVybiAhIXB1Ym51YiAmJiAhIWxpc3RlbmVyO1xufVxuXG5mdW5jdGlvbiByZWdpc3Rlcihjb25maWcpIHtcbiAgaWYgKCFpc1JlZ2lzdGVyZWQoKSkge1xuICAgIHB1Ym51YiA9IG5ldyBfcHVibnViLmRlZmF1bHQoY29uZmlnKTtcbiAgICBsaXN0ZW5lciA9IG5ldyBMaXN0ZW5lcigpO1xuICAgIHB1Ym51Yi5hZGRMaXN0ZW5lcihsaXN0ZW5lcik7XG4gIH1cbn1cblxuZnVuY3Rpb24gdW5yZWdpc3RlcigpIHtcbiAgaWYgKGlzUmVnaXN0ZXJlZCgpKSB7XG4gICAgcHVibnViLnVuc3Vic2NyaWJlQWxsKCk7XG4gICAgcHVibnViID0gbnVsbDtcbiAgICBsaXN0ZW5lci5yZW1vdmVBbGxMaXN0ZW5lcnMoKTtcbiAgICBsaXN0ZW5lciA9IG51bGw7XG4gIH1cbn1cblxuZnVuY3Rpb24gc3Vic2NyaWJlVG9DaGFubmVsKGNoYW5uZWxOYW1lKSB7XG4gIHZhciByZWNlaXZlciA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307XG5cbiAgaWYgKCFpc1JlZ2lzdGVyZWQoKSkge1xuICAgIHRocm93IG5ldyBfa2ludmV5LmRlZmF1bHQoJ1BsZWFzZSByZWdpc3RlciBmb3IgdGhlIGxpdmUgc2VydmljZSBiZWZvcmUgeW91IHN1YnNjcmliZSB0byBhIGNoYW5uZWwuJyk7XG4gIH1cblxuICB2YXIgb25NZXNzYWdlID0gcmVjZWl2ZXIub25NZXNzYWdlLFxuICAgICAgb25FcnJvciA9IHJlY2VpdmVyLm9uRXJyb3IsXG4gICAgICBvblN0YXR1cyA9IHJlY2VpdmVyLm9uU3RhdHVzO1xuXG4gIGlmICghaXNWYWxpZENoYW5uZWxOYW1lKGNoYW5uZWxOYW1lKSkge1xuICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBjaGFubmVsIG5hbWUuJyk7XG4gIH1cblxuICBpZiAoIWlzVmFsaWRSZWNlaXZlcihyZWNlaXZlcikpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgcmVjZWl2ZXIuJyk7XG4gIH1cblxuICBpZiAoIWlzUmVnaXN0ZXJlZCgpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdQbGVhc2UgcmVnaXN0ZXIgdG8gdGhlIExpdmUgU2VydmljZSBiZWZvcmUgeW91IHN1YnNjcmliZSB0byB0aGUgY2hhbm5lbC4nKTtcbiAgfVxuXG4gIGlmIChsaXN0ZW5lciAmJiAoMCwgX2lzRnVuY3Rpb24uZGVmYXVsdCkob25NZXNzYWdlKSkge1xuICAgIGxpc3RlbmVyLm9uKGNoYW5uZWxOYW1lLCBvbk1lc3NhZ2UpO1xuICB9XG5cbiAgaWYgKGxpc3RlbmVyICYmICgwLCBfaXNGdW5jdGlvbi5kZWZhdWx0KShvbkVycm9yKSkge1xuICAgIGxpc3RlbmVyLm9uKFwiXCIuY29uY2F0KFNUQVRVU19QUkVGSVgpLmNvbmNhdChjaGFubmVsTmFtZSksIGZ1bmN0aW9uIChzdGF0dXMpIHtcbiAgICAgIGlmIChzdGF0dXMuZXJyb3IpIHtcbiAgICAgICAgb25FcnJvcihzdGF0dXMpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgaWYgKGxpc3RlbmVyICYmICgwLCBfaXNGdW5jdGlvbi5kZWZhdWx0KShvblN0YXR1cykpIHtcbiAgICBsaXN0ZW5lci5vbihcIlwiLmNvbmNhdChTVEFUVVNfUFJFRklYKS5jb25jYXQoY2hhbm5lbE5hbWUpLCBmdW5jdGlvbiAoc3RhdHVzKSB7XG4gICAgICBpZiAoIXN0YXR1cy5lcnJvcikge1xuICAgICAgICBvblN0YXR1cyhzdGF0dXMpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG5cbmZ1bmN0aW9uIHVuc3Vic2NyaWJlRnJvbUNoYW5uZWwoY2hhbm5lbE5hbWUpIHtcbiAgaWYgKGxpc3RlbmVyKSB7XG4gICAgbGlzdGVuZXIucmVtb3ZlQWxsTGlzdGVuZXJzKGNoYW5uZWxOYW1lKTtcbiAgICBsaXN0ZW5lci5yZW1vdmVBbGxMaXN0ZW5lcnMoXCJcIi5jb25jYXQoU1RBVFVTX1BSRUZJWCkuY29uY2F0KGNoYW5uZWxOYW1lKSk7XG4gIH1cbn0iLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG5cbnZhciBfY2xhc3NDYWxsQ2hlY2syID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVja1wiKSk7XG5cbnZhciBfY3JlYXRlQ2xhc3MyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jcmVhdGVDbGFzc1wiKSk7XG5cbnZhciBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm5cIikpO1xuXG52YXIgX2dldFByb3RvdHlwZU9mMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZ2V0UHJvdG90eXBlT2ZcIikpO1xuXG52YXIgX2luaGVyaXRzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW5oZXJpdHNcIikpO1xuXG52YXIgX3J4anMgPSByZXF1aXJlKFwicnhqc1wiKTtcblxudmFyIEtpbnZleU9ic2VydmFibGUgPVxuLyojX19QVVJFX18qL1xuZnVuY3Rpb24gKF9PYnNlcnZhYmxlKSB7XG4gICgwLCBfaW5oZXJpdHMyLmRlZmF1bHQpKEtpbnZleU9ic2VydmFibGUsIF9PYnNlcnZhYmxlKTtcblxuICBmdW5jdGlvbiBLaW52ZXlPYnNlcnZhYmxlKCkge1xuICAgICgwLCBfY2xhc3NDYWxsQ2hlY2syLmRlZmF1bHQpKHRoaXMsIEtpbnZleU9ic2VydmFibGUpO1xuICAgIHJldHVybiAoMCwgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yLmRlZmF1bHQpKHRoaXMsICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKEtpbnZleU9ic2VydmFibGUpLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpO1xuICB9XG5cbiAgKDAsIF9jcmVhdGVDbGFzczIuZGVmYXVsdCkoS2ludmV5T2JzZXJ2YWJsZSwgW3tcbiAgICBrZXk6IFwidG9Qcm9taXNlXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHRvUHJvbWlzZSgpIHtcbiAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHZhciB2YWx1ZTtcblxuICAgICAgICBfdGhpcy5zdWJzY3JpYmUoZnVuY3Rpb24gKHYpIHtcbiAgICAgICAgICB2YWx1ZSA9IHY7XG4gICAgICAgIH0sIHJlamVjdCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJlc29sdmUodmFsdWUpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfV0pO1xuICByZXR1cm4gS2ludmV5T2JzZXJ2YWJsZTtcbn0oX3J4anMuT2JzZXJ2YWJsZSk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IEtpbnZleU9ic2VydmFibGU7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gcmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW50ZXJvcFJlcXVpcmVEZWZhdWx0XCIpO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xuXG52YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2tcIikpO1xuXG52YXIgX2NyZWF0ZUNsYXNzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3NcIikpO1xuXG52YXIgX2lzTnVtYmVyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwibG9kYXNoL2lzTnVtYmVyXCIpKTtcblxudmFyIF9pc1N0cmluZyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcImxvZGFzaC9pc1N0cmluZ1wiKSk7XG5cbnZhciBfaXNQbGFpbk9iamVjdCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcImxvZGFzaC9pc1BsYWluT2JqZWN0XCIpKTtcblxudmFyIF9pc09iamVjdCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcImxvZGFzaC9pc09iamVjdFwiKSk7XG5cbnZhciBfaXNFbXB0eSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcImxvZGFzaC9pc0VtcHR5XCIpKTtcblxudmFyIF9pc0FycmF5ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwibG9kYXNoL2lzQXJyYXlcIikpO1xuXG52YXIgX3NpZnQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJzaWZ0XCIpKTtcblxudmFyIF9xdWVyeSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vZXJyb3JzL3F1ZXJ5XCIpKTtcblxudmFyIFVOU1VQUE9SVEVEX0NPTkRJVElPTlMgPSBbJyRuZWFyU3BoZXJlJ107XG52YXIgUFJPVEVDVEVEX0ZJRUxEUyA9IFsnX2lkJywgJ19hY2wnXTtcblxuZnVuY3Rpb24gbmVzdGVkKG9iaiwgZG90UHJvcGVydHksIHZhbHVlKSB7XG4gIGlmICghZG90UHJvcGVydHkpIHtcbiAgICByZXR1cm4gdmFsdWUgfHwgb2JqO1xuICB9XG5cbiAgdmFyIHBhcnRzID0gZG90UHJvcGVydHkuc3BsaXQoJy4nKTtcbiAgdmFyIGN1cnJlbnRQcm9wZXJ0eSA9IHBhcnRzLnNoaWZ0KCk7XG4gIHZhciBjdXJyZW50T2JqID0gb2JqO1xuXG4gIHdoaWxlIChjdXJyZW50UHJvcGVydHkgJiYgdHlwZW9mIGN1cnJlbnRPYmogIT09ICd1bmRlZmluZWQnKSB7XG4gICAgY3VycmVudE9iaiA9IGN1cnJlbnRPYmpbY3VycmVudFByb3BlcnR5XTtcbiAgICBjdXJyZW50UHJvcGVydHkgPSBwYXJ0cy5zaGlmdCgpO1xuICB9XG5cbiAgcmV0dXJuIHR5cGVvZiBjdXJyZW50T2JqID09PSAndW5kZWZpbmVkJyA/IHZhbHVlIDogY3VycmVudE9iajtcbn1cblxudmFyIFF1ZXJ5ID1cbi8qI19fUFVSRV9fKi9cbmZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gUXVlcnkocXVlcnkpIHtcbiAgICAoMCwgX2NsYXNzQ2FsbENoZWNrMi5kZWZhdWx0KSh0aGlzLCBRdWVyeSk7XG4gICAgdmFyIGNvbmZpZyA9IE9iamVjdC5hc3NpZ24oe30sIHtcbiAgICAgIGZpZWxkczogW10sXG4gICAgICBmaWx0ZXI6IHt9LFxuICAgICAgc29ydDoge30sXG4gICAgICBsaW1pdDogSW5maW5pdHksXG4gICAgICBza2lwOiAwXG4gICAgfSwgcXVlcnkpO1xuICAgIHRoaXMuZmllbGRzID0gY29uZmlnLmZpZWxkcztcbiAgICB0aGlzLmZpbHRlciA9IGNvbmZpZy5maWx0ZXI7XG4gICAgdGhpcy5zb3J0ID0gY29uZmlnLnNvcnQ7XG4gICAgdGhpcy5saW1pdCA9IGNvbmZpZy5saW1pdDtcbiAgICB0aGlzLnNraXAgPSBjb25maWcuc2tpcDtcbiAgfVxuXG4gICgwLCBfY3JlYXRlQ2xhc3MyLmRlZmF1bHQpKFF1ZXJ5LCBbe1xuICAgIGtleTogXCJpc1N1cHBvcnRlZE9mZmxpbmVcIixcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdHJ1ZSBvciBmYWxzZSBkZXBlbmRpbmcgb24gaWYgdGhlIHF1ZXJ5IGlzIGFibGUgdG8gYmUgcHJvY2Vzc2VkIG9mZmxpbmUuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB0aGUgcXVlcnkgaXMgc3VwcG9ydGVkIG9mZmxpbmUgb3RoZXJ3aXNlIGZhbHNlLlxuICAgICAqL1xuICAgIHZhbHVlOiBmdW5jdGlvbiBpc1N1cHBvcnRlZE9mZmxpbmUoKSB7XG4gICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy5maWx0ZXIpLnJlZHVjZShmdW5jdGlvbiAoc3VwcG9ydGVkLCBrZXkpIHtcbiAgICAgICAgaWYgKHN1cHBvcnRlZCkge1xuICAgICAgICAgIHZhciB2YWx1ZSA9IF90aGlzLmZpbHRlcltrZXldO1xuICAgICAgICAgIHJldHVybiBVTlNVUFBPUlRFRF9DT05ESVRJT05TLnNvbWUoZnVuY3Rpb24gKHVuc3VwcG9ydGVkQ29uZGl0aW9ucykge1xuICAgICAgICAgICAgaWYgKCF2YWx1ZSkge1xuICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCEoMCwgX2lzT2JqZWN0LmRlZmF1bHQpKHZhbHVlKSkge1xuICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuICFPYmplY3Qua2V5cyh2YWx1ZSkuc29tZShmdW5jdGlvbiAoY29uZGl0aW9uKSB7XG4gICAgICAgICAgICAgIHJldHVybiBjb25kaXRpb24gPT09IHVuc3VwcG9ydGVkQ29uZGl0aW9ucztcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHN1cHBvcnRlZDtcbiAgICAgIH0sIHRydWUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGRzIGFuIGVxdWFsIHRvIGZpbHRlciB0byB0aGUgcXVlcnkuIFJlcXVpcmVzIGZpZWxkIHRvIGVxdWFsIHZhbHVlLlxuICAgICAqIEFueSBleGlzdGluZyBmaWx0ZXJzIG9uIGZpZWxkIHdpbGwgYmUgZGlzY2FyZGVkLlxuICAgICAqIEBzZWUgaHR0cHM6Ly9kb2NzLm1vbmdvZGIuY29tL21hbnVhbC9yZWZlcmVuY2Uvb3BlcmF0b3IvcXVlcnkvI2NvbXBhcmlzb25cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBmaWVsZCBGaWVsZFxuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVmFsdWVcbiAgICAgKiBAcmV0dXJucyB7UXVlcnl9IFF1ZXJ5XG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJlcXVhbFRvXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGVxdWFsVG8oZmllbGQsIHZhbHVlKSB7XG4gICAgICByZXR1cm4gdGhpcy5hZGRGaWx0ZXIoZmllbGQsIHZhbHVlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkcyBhIG5vdCBlcXVhbCB0byBmaWx0ZXIgdG8gdGhlIHF1ZXJ5LiBSZXF1aXJlcyBmaWVsZCBub3QgdG8gZXF1YWxcbiAgICAgKiB2YWx1ZS5cbiAgICAgKiBAc2VlIGh0dHBzOi8vZG9jcy5tb25nb2RiLmNvbS9tYW51YWwvcmVmZXJlbmNlL29wZXJhdG9yL3F1ZXJ5L25lXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZmllbGQgRmllbGRcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFZhbHVlXG4gICAgICogQHJldHVybnMge1F1ZXJ5fSBRdWVyeVxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6IFwibm90RXF1YWxUb1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBub3RFcXVhbFRvKGZpZWxkLCB2YWx1ZSkge1xuICAgICAgcmV0dXJuIHRoaXMuYWRkRmlsdGVyKGZpZWxkLCAnJG5lJywgdmFsdWUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGRzIGEgY29udGFpbnMgZmlsdGVyIHRvIHRoZSBxdWVyeS4gUmVxdWlyZXMgZmllbGQgdG8gY29udGFpbiBhdCBsZWFzdFxuICAgICAqIG9uZSBvZiB0aGUgbWVtYmVycyBvZiBsaXN0LlxuICAgICAqIEBzZWUgaHR0cHM6Ly9kb2NzLm1vbmdvZGIuY29tL21hbnVhbC9yZWZlcmVuY2Uvb3BlcmF0b3IvcXVlcnkvaW5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBmaWVsZCBGaWVsZFxuICAgICAqIEBwYXJhbSB7QXJyYXl9IHZhbHVlcyBMaXN0IG9mIHZhbHVlcy5cbiAgICAgKiBAdGhyb3dzIHtFcnJvcn0gQSB2YWx1ZSBpcyByZXF1aXJlZC5cbiAgICAgKiBAcmV0dXJucyB7UXVlcnl9IFF1ZXJ5XG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJjb250YWluc1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBjb250YWlucyhmaWVsZCwgdmFsdWVzKSB7XG4gICAgICBpZiAoIXZhbHVlcykge1xuICAgICAgICB0aHJvdyBuZXcgX3F1ZXJ5LmRlZmF1bHQoJ1lvdSBtdXN0IHN1cHBseSBhIHZhbHVlLicpO1xuICAgICAgfVxuXG4gICAgICBpZiAoIUFycmF5LmlzQXJyYXkodmFsdWVzKSkge1xuICAgICAgICByZXR1cm4gdGhpcy5hZGRGaWx0ZXIoZmllbGQsICckaW4nLCBbdmFsdWVzXSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLmFkZEZpbHRlcihmaWVsZCwgJyRpbicsIHZhbHVlcyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZHMgYSBub3QgY29udGFpbmVkIGluIGZpbHRlciB0byB0aGUgcXVlcnkuIFJlcXVpcmVzIGBmaWVsZGAgbm90IHRvXG4gICAgICogY29udGFpbiBhbnkgb2YgdGhlIG1lbWJlcnMgb2YgYGxpc3RgLlxuICAgICAqIEBzZWUgaHR0cHM6Ly9kb2NzLm1vbmdvZGIuY29tL21hbnVhbC9yZWZlcmVuY2Uvb3BlcmF0b3IvcXVlcnkvbmluXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZmllbGQgRmllbGRcbiAgICAgKiBAcGFyYW0ge0FycmF5fSB2YWx1ZXMgTGlzdCBvZiB2YWx1ZXMuXG4gICAgICogQHRocm93cyB7RXJyb3J9IEEgdmFsdWUgaXMgcmVxdWlyZWQuXG4gICAgICogQHJldHVybnMge1F1ZXJ5fSBRdWVyeVxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6IFwibm90Q29udGFpbmVkSW5cIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gbm90Q29udGFpbmVkSW4oZmllbGQsIHZhbHVlcykge1xuICAgICAgaWYgKCF2YWx1ZXMpIHtcbiAgICAgICAgdGhyb3cgbmV3IF9xdWVyeS5kZWZhdWx0KCdZb3UgbXVzdCBzdXBwbHkgYSB2YWx1ZS4nKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHVlcykpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYWRkRmlsdGVyKGZpZWxkLCAnJG5pbicsIFt2YWx1ZXNdKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMuYWRkRmlsdGVyKGZpZWxkLCAnJG5pbicsIHZhbHVlcyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZHMgYSBjb250YWlucyBhbGwgZmlsdGVyIHRvIHRoZSBxdWVyeS4gUmVxdWlyZXMgYGZpZWxkYCB0byBjb250YWluIGFsbFxuICAgICAqIG1lbWJlcnMgb2YgYGxpc3RgLlxuICAgICAqIEBzZWUgaHR0cHM6Ly9kb2NzLm1vbmdvZGIuY29tL21hbnVhbC9yZWZlcmVuY2Uvb3BlcmF0b3IvcXVlcnkvYWxsXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZmllbGQgRmllbGRcbiAgICAgKiBAcGFyYW0ge29iamVjdHxBcnJheX0gdmFsdWVzIExpc3Qgb2YgdmFsdWVzLlxuICAgICAqIEB0aHJvd3Mge0Vycm9yfSBBIHZhbHVlIGlzIHJlcXVpcmVkLlxuICAgICAqIEByZXR1cm5zIHtRdWVyeX0gUXVlcnlcbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiBcImNvbnRhaW5zQWxsXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGNvbnRhaW5zQWxsKGZpZWxkLCB2YWx1ZXMpIHtcbiAgICAgIGlmICghdmFsdWVzKSB7XG4gICAgICAgIHRocm93IG5ldyBfcXVlcnkuZGVmYXVsdCgnWW91IG11c3Qgc3VwcGx5IGEgdmFsdWUuJyk7XG4gICAgICB9XG5cbiAgICAgIGlmICghQXJyYXkuaXNBcnJheSh2YWx1ZXMpKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFkZEZpbHRlcihmaWVsZCwgJyRhbGwnLCBbdmFsdWVzXSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLmFkZEZpbHRlcihmaWVsZCwgJyRhbGwnLCB2YWx1ZXMpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGRzIGEgZ3JlYXRlciB0aGFuIGZpbHRlciB0byB0aGUgcXVlcnkuIFJlcXVpcmVzIGBmaWVsZGAgdG8gYmUgZ3JlYXRlclxuICAgICAqIHRoYW4gYHZhbHVlYC5cbiAgICAgKiBAc2VlIGh0dHBzOi8vZG9jcy5tb25nb2RiLmNvbS9tYW51YWwvcmVmZXJlbmNlL29wZXJhdG9yL3F1ZXJ5L2d0XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZmllbGQgRmllbGRcbiAgICAgKiBAcGFyYW0ge251bWJlcnxzdHJpbmd9IHZhbHVlIFZhbHVlXG4gICAgICogQHRocm93cyB7RXJyb3J9IFRoZSB2YWx1ZSBtdXN0IGJlIGEgbnVtYmVyIG9yIHN0cmluZy5cbiAgICAgKiBAcmV0dXJucyB7UXVlcnl9IFF1ZXJ5XG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJncmVhdGVyVGhhblwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBncmVhdGVyVGhhbihmaWVsZCwgdmFsdWUpIHtcbiAgICAgIGlmICghKDAsIF9pc051bWJlci5kZWZhdWx0KSh2YWx1ZSkgJiYgISgwLCBfaXNTdHJpbmcuZGVmYXVsdCkodmFsdWUpKSB7XG4gICAgICAgIHRocm93IG5ldyBfcXVlcnkuZGVmYXVsdCgnWW91IG11c3Qgc3VwcGx5IGEgbnVtYmVyIG9yIHN0cmluZy4nKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMuYWRkRmlsdGVyKGZpZWxkLCAnJGd0JywgdmFsdWUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGRzIGEgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvIGZpbHRlciB0byB0aGUgcXVlcnkuIFJlcXVpcmVzIGBmaWVsZGAgdG9cbiAgICAgKiBiZSBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gYHZhbHVlYC5cbiAgICAgKiBAc2VlIGh0dHBzOi8vZG9jcy5tb25nb2RiLmNvbS9tYW51YWwvcmVmZXJlbmNlL29wZXJhdG9yL3F1ZXJ5L2d0ZVxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGZpZWxkIEZpZWxkLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfHN0cmluZ30gdmFsdWUgVmFsdWUuXG4gICAgICogQHRocm93cyB7RXJyb3J9IFRoZSB2YWx1ZSBtdXN0IGJlIGEgbnVtYmVyIG9yIHN0cmluZy5cbiAgICAgKiBAcmV0dXJucyB7UXVlcnl9IFF1ZXJ5XG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJncmVhdGVyVGhhbk9yRXF1YWxUb1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBncmVhdGVyVGhhbk9yRXF1YWxUbyhmaWVsZCwgdmFsdWUpIHtcbiAgICAgIGlmICghKDAsIF9pc051bWJlci5kZWZhdWx0KSh2YWx1ZSkgJiYgISgwLCBfaXNTdHJpbmcuZGVmYXVsdCkodmFsdWUpKSB7XG4gICAgICAgIHRocm93IG5ldyBfcXVlcnkuZGVmYXVsdCgnWW91IG11c3Qgc3VwcGx5IGEgbnVtYmVyIG9yIHN0cmluZy4nKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMuYWRkRmlsdGVyKGZpZWxkLCAnJGd0ZScsIHZhbHVlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkcyBhIGxlc3MgdGhhbiBmaWx0ZXIgdG8gdGhlIHF1ZXJ5LiBSZXF1aXJlcyBgZmllbGRgIHRvIGJlIGxlc3MgdGhhblxuICAgICAqIGB2YWx1ZWAuXG4gICAgICogQHNlZSBodHRwczovL2RvY3MubW9uZ29kYi5jb20vbWFudWFsL3JlZmVyZW5jZS9vcGVyYXRvci9xdWVyeS9sdFxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGZpZWxkIEZpZWxkXG4gICAgICogQHBhcmFtIHtudW1iZXJ8c3RyaW5nfSB2YWx1ZSBWYWx1ZVxuICAgICAqIEB0aHJvd3Mge0Vycm9yfSBUaGUgdmFsdWUgbXVzdCBiZSBhIG51bWJlciBvciBzdHJpbmcuXG4gICAgICogQHJldHVybnMge1F1ZXJ5fSBRdWVyeVxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6IFwibGVzc1RoYW5cIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gbGVzc1RoYW4oZmllbGQsIHZhbHVlKSB7XG4gICAgICBpZiAoISgwLCBfaXNOdW1iZXIuZGVmYXVsdCkodmFsdWUpICYmICEoMCwgX2lzU3RyaW5nLmRlZmF1bHQpKHZhbHVlKSkge1xuICAgICAgICB0aHJvdyBuZXcgX3F1ZXJ5LmRlZmF1bHQoJ1lvdSBtdXN0IHN1cHBseSBhIG51bWJlciBvciBzdHJpbmcuJyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLmFkZEZpbHRlcihmaWVsZCwgJyRsdCcsIHZhbHVlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkcyBhIGxlc3MgdGhhbiBvciBlcXVhbCB0byBmaWx0ZXIgdG8gdGhlIHF1ZXJ5LiBSZXF1aXJlcyBgZmllbGRgIHRvIGJlXG4gICAgICogbGVzcyB0aGFuIG9yIGVxdWFsIHRvIGB2YWx1ZWAuXG4gICAgICogQHNlZSBodHRwczovL2RvY3MubW9uZ29kYi5jb20vbWFudWFsL3JlZmVyZW5jZS9vcGVyYXRvci9xdWVyeS9sdGVcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBmaWVsZCBGaWVsZFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfHN0cmluZ30gdmFsdWUgVmFsdWVcbiAgICAgKiBAdGhyb3dzIHtFcnJvcn0gVGhlIHZhbHVlIG11c3QgYmUgYSBudW1iZXIgb3Igc3RyaW5nLlxuICAgICAqIEByZXR1cm5zIHtRdWVyeX0gUXVlcnlcbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiBcImxlc3NUaGFuT3JFcXVhbFRvXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGxlc3NUaGFuT3JFcXVhbFRvKGZpZWxkLCB2YWx1ZSkge1xuICAgICAgaWYgKCEoMCwgX2lzTnVtYmVyLmRlZmF1bHQpKHZhbHVlKSAmJiAhKDAsIF9pc1N0cmluZy5kZWZhdWx0KSh2YWx1ZSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IF9xdWVyeS5kZWZhdWx0KCdZb3UgbXVzdCBzdXBwbHkgYSBudW1iZXIgb3Igc3RyaW5nLicpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcy5hZGRGaWx0ZXIoZmllbGQsICckbHRlJywgdmFsdWUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGRzIGFuIGV4aXN0cyBmaWx0ZXIgdG8gdGhlIHF1ZXJ5LiBSZXF1aXJlcyBgZmllbGRgIHRvIGV4aXN0IGlmIGBmbGFnYCBpc1xuICAgICAqIGB0cnVlYCwgb3Igbm90IHRvIGV4aXN0IGlmIGBmbGFnYCBpcyBgZmFsc2VgLlxuICAgICAqIEBzZWUgaHR0cHM6Ly9kb2NzLm1vbmdvZGIuY29tL21hbnVhbC9yZWZlcmVuY2Uvb3BlcmF0b3IvcXVlcnkvZXhpc3RzXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZmllbGQgRmllbGRcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtmbGFnPXRydWVdIFRoZSBleGlzdHMgZmxhZy5cbiAgICAgKiBAcmV0dXJucyB7UXVlcnl9IFF1ZXJ5XG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJleGlzdHNcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gZXhpc3RzKGZpZWxkKSB7XG4gICAgICB2YXIgZmxhZyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogdHJ1ZTtcbiAgICAgIHJldHVybiB0aGlzLmFkZEZpbHRlcihmaWVsZCwgJyRleGlzdHMnLCBmbGFnID09PSB0cnVlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkcyBhIG1vZHVsdXMgZmlsdGVyIHRvIHRoZSBxdWVyeS4gUmVxdWlyZXMgYGZpZWxkYCBtb2R1bG8gYGRpdmlzb3JgIHRvXG4gICAgICogaGF2ZSByZW1haW5kZXIgYHJlbWFpbmRlcmAuXG4gICAgICogQHNlZSBodHRwczovL2RvY3MubW9uZ29kYi5jb20vbWFudWFsL3JlZmVyZW5jZS9vcGVyYXRvci9xdWVyeS9tb2RcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBmaWVsZCBGaWVsZFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBkaXZpc29yIERpdmlzb3JcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3JlbWFpbmRlcj0wXSBSZW1haW5kZXJcbiAgICAgKiBAdGhyb3dzIHtFcnJvcn0gVGhlIGRpdmlzb3IgbXVzdCBiZSBhIG51bWJlci5cbiAgICAgKiBAdGhyb3dzIHtFcnJvcn0gVGhlIHJlbWFpbmRlciBtdXN0IGJlIGEgbnVtYmVyLlxuICAgICAqIEByZXR1cm5zIHtRdWVyeX0gUXVlcnlcbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiBcIm1vZFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBtb2QoZmllbGQsIGRpdmlzb3IpIHtcbiAgICAgIHZhciByZW1haW5kZXIgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IDA7XG5cbiAgICAgIGlmICghKDAsIF9pc051bWJlci5kZWZhdWx0KShkaXZpc29yKSkge1xuICAgICAgICB0aHJvdyBuZXcgX3F1ZXJ5LmRlZmF1bHQoJ2Rpdmlzb3IgbXVzdCBiZSBhIG51bWJlcicpO1xuICAgICAgfVxuXG4gICAgICBpZiAoISgwLCBfaXNOdW1iZXIuZGVmYXVsdCkocmVtYWluZGVyKSkge1xuICAgICAgICB0aHJvdyBuZXcgX3F1ZXJ5LmRlZmF1bHQoJ3JlbWFpbmRlciBtdXN0IGJlIGEgbnVtYmVyJyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLmFkZEZpbHRlcihmaWVsZCwgJyRtb2QnLCBbZGl2aXNvciwgcmVtYWluZGVyXSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZHMgYSBtYXRjaCBmaWx0ZXIgdG8gdGhlIHF1ZXJ5LiBSZXF1aXJlcyBgZmllbGRgIHRvIG1hdGNoIGByZWdFeHBgLlxuICAgICAqIEBzZWUgaHR0cHM6Ly9kb2NzLm1vbmdvZGIuY29tL21hbnVhbC9yZWZlcmVuY2Uvb3BlcmF0b3IvcXVlcnkvcmVnZXhcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBmaWVsZCBGaWVsZFxuICAgICAqIEBwYXJhbSB7UmVnRXhwfHN0cmluZ30gcmVnRXhwIFJlZ3VsYXIgZXhwcmVzc2lvbi5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdIE9wdGlvbnNcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLmlnbm9yZUNhc2U9aW5oZXJpdF0gVG9nZ2xlcyBjYXNlLWluc2Vuc2l0aXZpdHkuXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5tdWx0aWxpbmU9aW5oZXJpdF0gVG9nZ2xlcyBtdWx0aWxpbmUgbWF0Y2hpbmcuXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5leHRlbmRlZD1mYWxzZV0gVG9nZ2xlcyBleHRlbmRlZCBjYXBhYmlsaXR5LlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMuZG90TWF0Y2hlc0FsbD1mYWxzZV0gVG9nZ2xlcyBkb3QgbWF0Y2hlcyBhbGwuXG4gICAgICogQHRocm93cyB7RXJyb3J9IFRoZSByZWdFeHAgbXVzdCBoYXZlICdeJyBhdCB0aGUgYmVnaW5uaW5nIG9mIHRoZSBleHByZXNzaW9uIHRvIG1ha2UgaXQgYW4gYW5jaG9yZWQgZXhwcmVzc2lvbi5cbiAgICAgKiBAdGhyb3dzIHtFcnJvcn0gVGhlIGlnbm9yZUNhc2UgZmxhZyBpcyBub3Qgc3VwcG9ydGVkLlxuICAgICAqIEByZXR1cm5zIHtRdWVyeX0gUXVlcnlcbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiBcIm1hdGNoZXNcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gbWF0Y2hlcyhmaWVsZCwgZXhwcmVzc2lvbikge1xuICAgICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IHt9O1xuICAgICAgdmFyIGZsYWdzID0gW107XG4gICAgICB2YXIgcmVnRXhwID0gZXhwcmVzc2lvbjtcblxuICAgICAgaWYgKCEocmVnRXhwIGluc3RhbmNlb2YgUmVnRXhwKSkge1xuICAgICAgICByZWdFeHAgPSBuZXcgUmVnRXhwKHJlZ0V4cCk7XG4gICAgICB9XG5cbiAgICAgIGlmIChyZWdFeHAuc291cmNlLmluZGV4T2YoJ14nKSAhPT0gMCkge1xuICAgICAgICB0aHJvdyBuZXcgX3F1ZXJ5LmRlZmF1bHQoJ3JlZ0V4cCBtdXN0IGhhdmUgXFwnXlxcJyBhdCB0aGUgYmVnaW5uaW5nIG9mIHRoZSBleHByZXNzaW9uIHRvIG1ha2UgaXQgYW4gYW5jaG9yZWQgZXhwcmVzc2lvbi4nKTtcbiAgICAgIH1cblxuICAgICAgaWYgKChyZWdFeHAuaWdub3JlQ2FzZSB8fCBvcHRpb25zLmlnbm9yZUNhc2UpICYmIG9wdGlvbnMuaWdub3JlQ2FzZSAhPT0gZmFsc2UpIHtcbiAgICAgICAgdGhyb3cgbmV3IF9xdWVyeS5kZWZhdWx0KCdpZ25vcmVDYXNlIGZsYWcgaXMgbm90IHN1cHBvcnRlZCcpO1xuICAgICAgfVxuXG4gICAgICBpZiAoKHJlZ0V4cC5tdWx0aWxpbmUgfHwgb3B0aW9ucy5tdWx0aWxpbmUpICYmIG9wdGlvbnMubXVsdGlsaW5lICE9PSBmYWxzZSkge1xuICAgICAgICBmbGFncy5wdXNoKCdtJyk7XG4gICAgICB9XG5cbiAgICAgIGlmIChvcHRpb25zLmV4dGVuZGVkID09PSB0cnVlKSB7XG4gICAgICAgIGZsYWdzLnB1c2goJ3gnKTtcbiAgICAgIH1cblxuICAgICAgaWYgKG9wdGlvbnMuZG90TWF0Y2hlc0FsbCA9PT0gdHJ1ZSkge1xuICAgICAgICBmbGFncy5wdXNoKCdzJyk7XG4gICAgICB9XG5cbiAgICAgIGlmIChmbGFncy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHRoaXMuYWRkRmlsdGVyKGZpZWxkLCAnJG9wdGlvbnMnLCBmbGFncy5qb2luKCcnKSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLmFkZEZpbHRlcihmaWVsZCwgJyRyZWdleCcsIHJlZ0V4cC5zb3VyY2UpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGRzIGEgbmVhciBmaWx0ZXIgdG8gdGhlIHF1ZXJ5LiBSZXF1aXJlcyBgZmllbGRgIHRvIGJlIGEgY29vcmRpbmF0ZVxuICAgICAqIHdpdGhpbiBgbWF4RGlzdGFuY2VgIG9mIGBjb29yZGAuIFNvcnRzIGRvY3VtZW50cyBmcm9tIG5lYXJlc3QgdG8gZmFydGhlc3QuXG4gICAgICogQHNlZSBodHRwczovL2RvY3MubW9uZ29kYi5jb20vbWFudWFsL3JlZmVyZW5jZS9vcGVyYXRvci9xdWVyeS9uZWFyXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZmllbGQgVGhlIGZpZWxkLlxuICAgICAqIEBwYXJhbSB7QXJyYXk8bnVtYmVyLCBudW1iZXI+fSBjb29yZCBUaGUgY29vcmRpbmF0ZSAobG9uZ2l0dWRlLCBsYXRpdHVkZSkuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFttYXhEaXN0YW5jZV0gVGhlIG1heGltdW0gZGlzdGFuY2UgKG1pbGVzKS5cbiAgICAgKiBAdGhyb3dzIHtFcnJvcn0gVGhlIGNvb3JkIG11c3QgYmUgYSBbbnVtYmVyLCBudW1iZXJdLlxuICAgICAqIEByZXR1cm5zIHtRdWVyeX0gUXVlcnlcbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiBcIm5lYXJcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gbmVhcihmaWVsZCwgY29vcmQsIG1heERpc3RhbmNlKSB7XG4gICAgICBpZiAoIUFycmF5LmlzQXJyYXkoY29vcmQpIHx8ICEoMCwgX2lzTnVtYmVyLmRlZmF1bHQpKGNvb3JkWzBdKSB8fCAhKDAsIF9pc051bWJlci5kZWZhdWx0KShjb29yZFsxXSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IF9xdWVyeS5kZWZhdWx0KCdjb29yZCBtdXN0IGJlIGEgW251bWJlciwgbnVtYmVyXScpO1xuICAgICAgfVxuXG4gICAgICB2YXIgcmVzdWx0ID0gdGhpcy5hZGRGaWx0ZXIoZmllbGQsICckbmVhclNwaGVyZScsIFtjb29yZFswXSwgY29vcmRbMV1dKTtcblxuICAgICAgaWYgKCgwLCBfaXNOdW1iZXIuZGVmYXVsdCkobWF4RGlzdGFuY2UpKSB7XG4gICAgICAgIHRoaXMuYWRkRmlsdGVyKGZpZWxkLCAnJG1heERpc3RhbmNlJywgbWF4RGlzdGFuY2UpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGRzIGEgd2l0aGluIGJveCBmaWx0ZXIgdG8gdGhlIHF1ZXJ5LiBSZXF1aXJlcyBgZmllbGRgIHRvIGJlIGEgY29vcmRpbmF0ZVxuICAgICAqIHdpdGhpbiB0aGUgYm91bmRzIG9mIHRoZSByZWN0YW5nbGUgZGVmaW5lZCBieSBgYm90dG9tTGVmdENvb3JkYCxcbiAgICAgKiBgYm90dG9tUmlnaHRDb29yZGAuXG4gICAgICogQHNlZSBodHRwczovL2RvY3MubW9uZ29kYi5jb20vbWFudWFsL3JlZmVyZW5jZS9vcGVyYXRvci9xdWVyeS9ib3hcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBmaWVsZCBUaGUgZmllbGQuXG4gICAgICogQHBhcmFtIHtBcnJheTxudW1iZXIsIG51bWJlcj59IGJvdHRvbUxlZnRDb29yZCBUaGUgYm90dG9tIGxlZnQgY29vcmRpbmF0ZSAobG9uZ2l0dWRlLCBsYXRpdHVkZSkuXG4gICAgICogQHBhcmFtIHtBcnJheTxudW1iZXIsIG51bWJlcj59IHVwcGVyUmlnaHRDb29yZCBUaGUgYm90dG9tIHJpZ2h0IGNvb3JkaW5hdGUgKGxvbmdpdHVkZSwgbGF0aXR1ZGUpLlxuICAgICAqIEB0aHJvd3Mge0Vycm9yfSBUaGUgYm90dG9tTGVmdENvb3JkIG11c3QgYmUgYSBbbnVtYmVyLCBudW1iZXJdLlxuICAgICAqIEB0aHJvd3Mge0Vycm9yfSBUaGUgdXBwZXJSaWdodENvb3JkIG11c3QgYmUgYSBbbnVtYmVyLCBudW1iZXJdLlxuICAgICAqIEByZXR1cm5zIHtRdWVyeX0gUXVlcnlcbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiBcIndpdGhpbkJveFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiB3aXRoaW5Cb3goZmllbGQsIGJvdHRvbUxlZnRDb29yZCwgdXBwZXJSaWdodENvb3JkKSB7XG4gICAgICBpZiAoIUFycmF5LmlzQXJyYXkoYm90dG9tTGVmdENvb3JkKSB8fCAhKDAsIF9pc051bWJlci5kZWZhdWx0KShib3R0b21MZWZ0Q29vcmRbMF0pIHx8ICEoMCwgX2lzTnVtYmVyLmRlZmF1bHQpKGJvdHRvbUxlZnRDb29yZFsxXSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IF9xdWVyeS5kZWZhdWx0KCdib3R0b21MZWZ0Q29vcmQgbXVzdCBiZSBhIFtudW1iZXIsIG51bWJlcl0nKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHVwcGVyUmlnaHRDb29yZCkgfHwgISgwLCBfaXNOdW1iZXIuZGVmYXVsdCkodXBwZXJSaWdodENvb3JkWzBdKSB8fCAhKDAsIF9pc051bWJlci5kZWZhdWx0KSh1cHBlclJpZ2h0Q29vcmRbMV0pKSB7XG4gICAgICAgIHRocm93IG5ldyBfcXVlcnkuZGVmYXVsdCgndXBwZXJSaWdodENvb3JkIG11c3QgYmUgYSBbbnVtYmVyLCBudW1iZXJdJyk7XG4gICAgICB9XG5cbiAgICAgIHZhciBjb29yZHMgPSBbW2JvdHRvbUxlZnRDb29yZFswXSwgYm90dG9tTGVmdENvb3JkWzFdXSwgW3VwcGVyUmlnaHRDb29yZFswXSwgdXBwZXJSaWdodENvb3JkWzFdXV07XG4gICAgICByZXR1cm4gdGhpcy5hZGRGaWx0ZXIoZmllbGQsICckd2l0aGluJywge1xuICAgICAgICAkYm94OiBjb29yZHNcbiAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGRzIGEgd2l0aGluIHBvbHlnb24gZmlsdGVyIHRvIHRoZSBxdWVyeS4gUmVxdWlyZXMgYGZpZWxkYCB0byBiZSBhXG4gICAgICogY29vcmRpbmF0ZSB3aXRoaW4gdGhlIGJvdW5kcyBvZiB0aGUgcG9seWdvbiBkZWZpbmVkIGJ5IGBjb29yZHNgLlxuICAgICAqIEBzZWUgaHR0cHM6Ly9kb2NzLm1vbmdvZGIuY29tL21hbnVhbC9yZWZlcmVuY2Uvb3BlcmF0b3IvcXVlcnkvcG9seWdvblxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGZpZWxkIFRoZSBmaWVsZC5cbiAgICAgKiBAcGFyYW0ge0FycmF5PEFycmF5PG51bWJlciwgbnVtYmVyPj59IGNvb3JkcyBMaXN0IG9mIGNvb3JkaW5hdGVzLlxuICAgICAqIEB0aHJvd3Mge0Vycm9yfSBUaGUgY29vcmRzIG11c3QgYmUgYSBbW251bWJlciwgbnVtYmVyXV0uXG4gICAgICogQHJldHVybnMge1F1ZXJ5fSBRdWVyeVxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6IFwid2l0aGluUG9seWdvblwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiB3aXRoaW5Qb2x5Z29uKGZpZWxkLCBjb29yZHMpIHtcbiAgICAgIGlmIChBcnJheS5pc0FycmF5KGNvb3JkcykgPT09IGZhbHNlIHx8IGNvb3Jkcy5sZW5ndGggPT09IDAgfHwgY29vcmRzWzBdLmxlbmd0aCA+IDMpIHtcbiAgICAgICAgdGhyb3cgbmV3IF9xdWVyeS5kZWZhdWx0KCdjb29yZHMgbXVzdCBiZSBhIFtbbnVtYmVyLCBudW1iZXJdXScpO1xuICAgICAgfVxuXG4gICAgICB2YXIgd2l0aGluQ29vcmRzID0gY29vcmRzLm1hcChmdW5jdGlvbiAoY29vcmQpIHtcbiAgICAgICAgaWYgKCEoMCwgX2lzTnVtYmVyLmRlZmF1bHQpKGNvb3JkWzBdKSB8fCAhKDAsIF9pc051bWJlci5kZWZhdWx0KShjb29yZFsxXSkpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgX3F1ZXJ5LmRlZmF1bHQoJ2Nvb3JkcyBhcmd1bWVudCBtdXN0IGJlIGEgW251bWJlciwgbnVtYmVyXScpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIFtjb29yZFswXSwgY29vcmRbMV1dO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gdGhpcy5hZGRGaWx0ZXIoZmllbGQsICckd2l0aGluJywge1xuICAgICAgICAkcG9seWdvbjogd2l0aGluQ29vcmRzXG4gICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkcyBhIHNpemUgZmlsdGVyIHRvIHRoZSBxdWVyeS4gUmVxdWlyZXMgYGZpZWxkYCB0byBiZSBhbiBgQXJyYXlgIHdpdGhcbiAgICAgKiBleGFjdGx5IGBzaXplYCBtZW1iZXJzLlxuICAgICAqIEBzZWUgaHR0cHM6Ly9kb2NzLm1vbmdvZGIuY29tL21hbnVhbC9yZWZlcmVuY2Uvb3BlcmF0b3IvcXVlcnkvc2l6ZVxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGZpZWxkIEZpZWxkXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHNpemUgU2l6ZVxuICAgICAqIEB0aHJvd3Mge0Vycm9yfSBUaGUgc2l6ZSBtdXN0IGJlIGEgbnVtYmVyLlxuICAgICAqIEByZXR1cm5zIHtRdWVyeX0gUXVlcnlcbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiBcInNpemVcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gc2l6ZShmaWVsZCwgX3NpemUpIHtcbiAgICAgIGlmICghKDAsIF9pc051bWJlci5kZWZhdWx0KShfc2l6ZSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IF9xdWVyeS5kZWZhdWx0KCdzaXplIG11c3QgYmUgYSBudW1iZXInKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMuYWRkRmlsdGVyKGZpZWxkLCAnJHNpemUnLCBfc2l6ZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZHMgYW4gYXNjZW5kaW5nIHNvcnQgbW9kaWZpZXIgdG8gdGhlIHF1ZXJ5LiBTb3J0cyBieSBgZmllbGRgLCBhc2NlbmRpbmcuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZmllbGQgRmllbGRcbiAgICAgKiBAcmV0dXJucyB7UXVlcnl9IFF1ZXJ5XG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJhc2NlbmRpbmdcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gYXNjZW5kaW5nKGZpZWxkKSB7XG4gICAgICBpZiAodGhpcy5fcGFyZW50KSB7XG4gICAgICAgIHRoaXMuX3BhcmVudC5hc2NlbmRpbmcoZmllbGQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKCF0aGlzLnNvcnQpIHtcbiAgICAgICAgICB0aGlzLnNvcnQgPSB7fTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuc29ydFtmaWVsZF0gPSAxO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkcyBhbiBkZXNjZW5kaW5nIHNvcnQgbW9kaWZpZXIgdG8gdGhlIHF1ZXJ5LiBTb3J0cyBieSBgZmllbGRgLFxuICAgICAqIGRlc2NlbmRpbmcuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZmllbGQgRmllbGRcbiAgICAgKiBAcmV0dXJucyB7UXVlcnl9IFF1ZXJ5XG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJkZXNjZW5kaW5nXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGRlc2NlbmRpbmcoZmllbGQpIHtcbiAgICAgIGlmICh0aGlzLl9wYXJlbnQpIHtcbiAgICAgICAgdGhpcy5fcGFyZW50LmRlc2NlbmRpbmcoZmllbGQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKCF0aGlzLnNvcnQpIHtcbiAgICAgICAgICB0aGlzLnNvcnQgPSB7fTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuc29ydFtmaWVsZF0gPSAtMTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFBlcmZvcm1zIGEgbG9naWNhbCBBTkQgb3BlcmF0aW9uIG9uIHRoZSBxdWVyeSBhbmQgdGhlIHByb3ZpZGVkIHF1ZXJpZXMuXG4gICAgICogQHNlZSBodHRwczovL2RvY3MubW9uZ29kYi5jb20vbWFudWFsL3JlZmVyZW5jZS9vcGVyYXRvci9xdWVyeS9hbmRcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Li4uUXVlcnl8Li4uT2JqZWN0fSBhcmdzIFF1ZXJpZXNcbiAgICAgKiBAdGhyb3dzIHtFcnJvcn0gUXVlcmllcyBtdXN0IGJlIGFuIGFycmF5IG9mIFF1ZXJ5IGluc3RhbmNlcyBvciBvYmplY3RzLlxuICAgICAqIEByZXR1cm5zIHtRdWVyeX0gUXVlcnlcbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiBcImFuZFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBhbmQoKSB7XG4gICAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuKSwgX2tleSA9IDA7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgICAgYXJnc1tfa2V5XSA9IGFyZ3VtZW50c1tfa2V5XTtcbiAgICAgIH1cblxuICAgICAgLy8gQU5EIGhhcyBoaWdoZXN0IHByZWNlZGVuY2UuIFRoZXJlZm9yZSwgZXZlbiBpZiB0aGlzIHF1ZXJ5IGlzIHBhcnQgb2YgYVxuICAgICAgLy8gSk9JTiBhbHJlYWR5LCBhcHBseSBpdCBvbiB0aGlzIHF1ZXJ5LlxuICAgICAgcmV0dXJuIHRoaXMuam9pbignJGFuZCcsIGFyZ3MpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQZXJmb3JtcyBhIGxvZ2ljYWwgTk9SIG9wZXJhdGlvbiBvbiB0aGUgcXVlcnkgYW5kIHRoZSBwcm92aWRlZCBxdWVyaWVzLlxuICAgICAqIEBzZWUgaHR0cHM6Ly9kb2NzLm1vbmdvZGIuY29tL21hbnVhbC9yZWZlcmVuY2Uvb3BlcmF0b3IvcXVlcnkvbm9yXG4gICAgICpcbiAgICAgKiBAcGFyYW0gey4uLlF1ZXJ5fC4uLk9iamVjdH0gYXJncyBRdWVyaWVzXG4gICAgICogQHRocm93cyB7RXJyb3J9IFF1ZXJpZXMgbXVzdCBiZSBhbiBhcnJheSBvZiBRdWVyeSBpbnN0YW5jZXMgb3Igb2JqZWN0cy5cbiAgICAgKiBAcmV0dXJucyB7UXVlcnl9IFF1ZXJ5XG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJub3JcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gbm9yKCkge1xuICAgICAgZm9yICh2YXIgX2xlbjIgPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4yKSwgX2tleTIgPSAwOyBfa2V5MiA8IF9sZW4yOyBfa2V5MisrKSB7XG4gICAgICAgIGFyZ3NbX2tleTJdID0gYXJndW1lbnRzW19rZXkyXTtcbiAgICAgIH1cblxuICAgICAgLy8gTk9SIGlzIHByZWNlZGVkIGJ5IEFORC4gVGhlcmVmb3JlLCBpZiB0aGlzIHF1ZXJ5IGlzIHBhcnQgb2YgYW4gQU5ELWpvaW4sXG4gICAgICAvLyBhcHBseSB0aGUgTk9SIG9udG8gdGhlIHBhcmVudCB0byBtYWtlIHN1cmUgQU5EIGluZGVlZCBwcmVjZWRlcyBOT1IuXG4gICAgICBpZiAodGhpcy5fcGFyZW50ICYmIE9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKHRoaXMuX3BhcmVudC5maWx0ZXIsICckYW5kJykpIHtcbiAgICAgICAgdmFyIF90aGlzJF9wYXJlbnQ7XG5cbiAgICAgICAgcmV0dXJuIChfdGhpcyRfcGFyZW50ID0gdGhpcy5fcGFyZW50KS5ub3IuYXBwbHkoX3RoaXMkX3BhcmVudCwgYXJncyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLmpvaW4oJyRub3InLCBhcmdzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUGVyZm9ybXMgYSBsb2dpY2FsIE9SIG9wZXJhdGlvbiBvbiB0aGUgcXVlcnkgYW5kIHRoZSBwcm92aWRlZCBxdWVyaWVzLlxuICAgICAqIEBzZWUgaHR0cHM6Ly9kb2NzLm1vbmdvZGIuY29tL21hbnVhbC9yZWZlcmVuY2Uvb3BlcmF0b3IvcXVlcnkvb3JcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Li4uUXVlcnl8Li4uT2JqZWN0fSBhcmdzIFF1ZXJpZXMuXG4gICAgICogQHRocm93cyB7RXJyb3J9IFF1ZXJpZXMgbXVzdCBiZSBhbiBhcnJheSBvZiBRdWVyeSBpbnN0YW5jZXMgb3Igb2JqZWN0cy5cbiAgICAgKiBAcmV0dXJucyB7UXVlcnl9IFF1ZXJ5XG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJvclwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBvcigpIHtcbiAgICAgIGZvciAodmFyIF9sZW4zID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuMyksIF9rZXkzID0gMDsgX2tleTMgPCBfbGVuMzsgX2tleTMrKykge1xuICAgICAgICBhcmdzW19rZXkzXSA9IGFyZ3VtZW50c1tfa2V5M107XG4gICAgICB9XG5cbiAgICAgIC8vIE9SIGhhcyBsb3dlc3QgcHJlY2VkZW5jZS4gVGhlcmVmb3JlLCBpZiB0aGlzIHF1ZXJ5IGlzIHBhcnQgb2YgYW55IGpvaW4sXG4gICAgICAvLyBhcHBseSB0aGUgT1Igb250byB0aGUgcGFyZW50IHRvIG1ha2Ugc3VyZSBPUiBoYXMgaW5kZWVkIHRoZSBsb3dlc3RcbiAgICAgIC8vIHByZWNlZGVuY2UuXG4gICAgICBpZiAodGhpcy5fcGFyZW50KSB7XG4gICAgICAgIHZhciBfdGhpcyRfcGFyZW50MjtcblxuICAgICAgICByZXR1cm4gKF90aGlzJF9wYXJlbnQyID0gdGhpcy5fcGFyZW50KS5vci5hcHBseShfdGhpcyRfcGFyZW50MiwgYXJncyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLmpvaW4oJyRvcicsIGFyZ3MpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHF1ZXJ5IHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgcXVlcnkgYXMgYSBKYXZhU2NyaXB0IG9iamVjdC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IFF1ZXJ5IHN0cmluZyBvYmplY3QuXG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJ0b1F1ZXJ5T2JqZWN0XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHRvUXVlcnlPYmplY3QoKSB7XG4gICAgICB2YXIgcXVlcnlPYmplY3QgPSB7fTtcblxuICAgICAgaWYgKE9iamVjdC5rZXlzKHRoaXMuZmlsdGVyKS5sZW5ndGggPiAwKSB7XG4gICAgICAgIHF1ZXJ5T2JqZWN0LnF1ZXJ5ID0gdGhpcy5maWx0ZXI7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLmZpZWxkcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHF1ZXJ5T2JqZWN0LmZpZWxkcyA9IHRoaXMuZmllbGRzLmpvaW4oJywnKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCgwLCBfaXNOdW1iZXIuZGVmYXVsdCkodGhpcy5saW1pdCkgJiYgdGhpcy5saW1pdCA8IEluZmluaXR5KSB7XG4gICAgICAgIHF1ZXJ5T2JqZWN0LmxpbWl0ID0gdGhpcy5saW1pdDtcbiAgICAgIH1cblxuICAgICAgaWYgKCgwLCBfaXNOdW1iZXIuZGVmYXVsdCkodGhpcy5za2lwKSAmJiB0aGlzLnNraXAgPiAwKSB7XG4gICAgICAgIHF1ZXJ5T2JqZWN0LnNraXAgPSB0aGlzLnNraXA7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLnNvcnQgJiYgT2JqZWN0LmtleXModGhpcy5zb3J0KS5sZW5ndGggPiAwKSB7XG4gICAgICAgIHF1ZXJ5T2JqZWN0LnNvcnQgPSB0aGlzLnNvcnQ7XG4gICAgICB9XG5cbiAgICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMocXVlcnlPYmplY3QpO1xuICAgICAga2V5cy5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgcXVlcnlPYmplY3Rba2V5XSA9ICgwLCBfaXNTdHJpbmcuZGVmYXVsdCkocXVlcnlPYmplY3Rba2V5XSkgPyBxdWVyeU9iamVjdFtrZXldIDogSlNPTi5zdHJpbmdpZnkocXVlcnlPYmplY3Rba2V5XSk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBxdWVyeU9iamVjdDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGRlcHJlY2F0ZWRcbiAgICAgKiBQbGVhc2UgdXNlIFF1ZXJ5LnByb3RvdHlwZS50b1F1ZXJ5T2JqZWN0KCkgaW5zdGVhZC5cbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiBcInRvUXVlcnlTdHJpbmdcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gdG9RdWVyeVN0cmluZygpIHtcbiAgICAgIHJldHVybiB0aGlzLnRvUXVlcnlPYmplY3QoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBPYmplY3QgcmVwcmVzZW50YXRpb24gb2YgdGhlIHF1ZXJ5LlxuICAgICAqXG4gICAgICogQHJldHVybnMge09iamVjdH0gT2JqZWN0XG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJ0b1BsYWluT2JqZWN0XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHRvUGxhaW5PYmplY3QoKSB7XG4gICAgICBpZiAodGhpcy5fcGFyZW50KSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9wYXJlbnQudG9QbGFpbk9iamVjdCgpO1xuICAgICAgfSAvLyBSZXR1cm4gc2V0IG9mIHBhcmFtZXRlcnMuXG5cblxuICAgICAgdmFyIGpzb24gPSB7XG4gICAgICAgIGZpZWxkczogdGhpcy5maWVsZHMsXG4gICAgICAgIGZpbHRlcjogdGhpcy5maWx0ZXIsXG4gICAgICAgIHNvcnQ6IHRoaXMuc29ydCxcbiAgICAgICAgc2tpcDogdGhpcy5za2lwLFxuICAgICAgICBsaW1pdDogdGhpcy5saW1pdFxuICAgICAgfTtcbiAgICAgIHJldHVybiBqc29uO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHF1ZXJ5IHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgcXVlcnkuXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHtzdHJpbmd9IFF1ZXJ5IHN0cmluZyBzdHJpbmcuXG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJ0b1N0cmluZ1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiB0b1N0cmluZygpIHtcbiAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh0aGlzLnRvUXVlcnlTdHJpbmcoKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQWRkcyBhIGZpbHRlciB0byB0aGUgcXVlcnkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZmllbGQgRmllbGRcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gY29uZGl0aW9uIENvbmRpdGlvblxuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWVzIFZhbHVlc1xuICAgICAqIEByZXR1cm5zIHtRdWVyeX0gUXVlcnlcbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiBcImFkZEZpbHRlclwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBhZGRGaWx0ZXIoZmllbGQpIHtcbiAgICAgIHZhciBfcmVmID0gKGFyZ3VtZW50cy5sZW5ndGggPD0gMSA/IDAgOiBhcmd1bWVudHMubGVuZ3RoIC0gMSkgPT09IDIgPyB7XG4gICAgICAgIGNvbmRpdGlvbjogYXJndW1lbnRzLmxlbmd0aCA8PSAxID8gdW5kZWZpbmVkIDogYXJndW1lbnRzWzFdLFxuICAgICAgICB2YWx1ZXM6IGFyZ3VtZW50cy5sZW5ndGggPD0gMiA/IHVuZGVmaW5lZCA6IGFyZ3VtZW50c1syXVxuICAgICAgfSA6IHtcbiAgICAgICAgY29uZGl0aW9uOiB1bmRlZmluZWQsXG4gICAgICAgIHZhbHVlczogYXJndW1lbnRzLmxlbmd0aCA8PSAxID8gdW5kZWZpbmVkIDogYXJndW1lbnRzWzFdXG4gICAgICB9LFxuICAgICAgICAgIGNvbmRpdGlvbiA9IF9yZWYuY29uZGl0aW9uLFxuICAgICAgICAgIHZhbHVlcyA9IF9yZWYudmFsdWVzO1xuXG4gICAgICBpZiAoIXRoaXMuZmlsdGVyKSB7XG4gICAgICAgIHRoaXMuZmlsdGVyID0ge307XG4gICAgICB9XG5cbiAgICAgIGlmIChjb25kaXRpb24pIHtcbiAgICAgICAgaWYgKCF0aGlzLmZpbHRlcltmaWVsZF0pIHtcbiAgICAgICAgICB0aGlzLmZpbHRlcltmaWVsZF0gPSB7fTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZmlsdGVyW2ZpZWxkXVtjb25kaXRpb25dID0gdmFsdWVzO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5maWx0ZXJbZmllbGRdID0gdmFsdWVzO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBKb2lucyB0aGUgY3VycmVudCBxdWVyeSB3aXRoIGFub3RoZXIgcXVlcnkgdXNpbmcgYW4gb3BlcmF0b3IuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gb3BlcmF0b3IgT3BlcmF0b3JcbiAgICAgKiBAcGFyYW0ge1F1ZXJ5W118b2JqZWN0W119IHF1ZXJpZXMgUXVlcmllc1xuICAgICAqIEB0aHJvd3Mge0Vycm9yfSBRdWVyaWVzIG11c3QgYmUgYW4gYXJyYXkgb2YgUXVlcnkgaW5zdGFuY2VzIG9yIG9iamVjdHMuXG4gICAgICogQHJldHVybnMge1F1ZXJ5fSBRdWVyeVxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6IFwiam9pblwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBqb2luKG9wZXJhdG9yLCBxdWVyaWVzKSB7XG4gICAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgICAgdmFyIGZpbHRlcnMgPSBxdWVyaWVzLm1hcChmdW5jdGlvbiAocXVlcnkpIHtcbiAgICAgICAgcmV0dXJuIHF1ZXJ5LmZpbHRlcjtcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoZmlsdGVycy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgdGhhdCA9IG5ldyBRdWVyeSgpO1xuICAgICAgICBmaWx0ZXJzID0gW3RoYXQuZmlsdGVyXTtcbiAgICAgICAgdGhhdC5fcGFyZW50ID0gdGhpczsgLy8gUmVxdWlyZWQgZm9yIG9wZXJhdG9yIHByZWNlZGVuY2VcbiAgICAgIH1cblxuICAgICAgdmFyIGN1cnJlbnRGaWx0ZXIgPSBPYmplY3Qua2V5cyh0aGlzLmZpbHRlcikucmVkdWNlKGZ1bmN0aW9uIChmaWx0ZXIsIGtleSkge1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcGFyYW0tcmVhc3NpZ25cbiAgICAgICAgZmlsdGVyW2tleV0gPSBfdGhpczIuZmlsdGVyW2tleV07XG4gICAgICAgIGRlbGV0ZSBfdGhpczIuZmlsdGVyW2tleV07XG4gICAgICAgIHJldHVybiBmaWx0ZXI7XG4gICAgICB9LCB7fSk7XG4gICAgICB0aGlzLmFkZEZpbHRlcihvcGVyYXRvciwgW2N1cnJlbnRGaWx0ZXJdLmNvbmNhdChmaWx0ZXJzKSk7XG4gICAgICByZXR1cm4gdGhhdDtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwicHJvY2Vzc1wiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBwcm9jZXNzKCkge1xuICAgICAgdmFyIF90aGlzMyA9IHRoaXM7XG5cbiAgICAgIHZhciBkb2NzID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBbXTtcblxuICAgICAgaWYgKCFBcnJheS5pc0FycmF5KGRvY3MpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignZGF0YSBhcmd1bWVudCBtdXN0IGJlIG9mIHR5cGU6IEFycmF5LicpO1xuICAgICAgfVxuXG4gICAgICBpZiAoIXRoaXMuaXNTdXBwb3J0ZWRPZmZsaW5lKCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGlzIHF1ZXJ5IGlzIG5vdCBhYmxlIHRvIHJ1biBsb2NhbGx5LicpO1xuICAgICAgfVxuXG4gICAgICBpZiAoZG9jcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHZhciBwcm9jZXNzZWREb2NzO1xuXG4gICAgICAgIGlmICh0aGlzLmZpbHRlciAmJiAhKDAsIF9pc0VtcHR5LmRlZmF1bHQpKHRoaXMuZmlsdGVyKSkge1xuICAgICAgICAgIHByb2Nlc3NlZERvY3MgPSAoMCwgX3NpZnQuZGVmYXVsdCkodGhpcy5maWx0ZXIsIGRvY3MpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHByb2Nlc3NlZERvY3MgPSBkb2NzO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCEoMCwgX2lzRW1wdHkuZGVmYXVsdCkodGhpcy5zb3J0KSkge1xuICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBhcnJvdy1ib2R5LXN0eWxlXG4gICAgICAgICAgcHJvY2Vzc2VkRG9jcy5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICByZXR1cm4gT2JqZWN0LmtleXMoX3RoaXMzLnNvcnQpLnJlZHVjZShmdW5jdGlvbiAocmVzdWx0LCBmaWVsZCkge1xuICAgICAgICAgICAgICBpZiAodHlwZW9mIHJlc3VsdCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChfdGhpczMuc29ydCwgZmllbGQpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGFGaWVsZCA9IG5lc3RlZChhLCBmaWVsZCk7XG4gICAgICAgICAgICAgICAgdmFyIGJGaWVsZCA9IG5lc3RlZChiLCBmaWVsZCk7XG4gICAgICAgICAgICAgICAgdmFyIG1vZGlmaWVyID0gX3RoaXMzLnNvcnRbZmllbGRdOyAvLyAtMSAoZGVzY2VuZGluZykgb3IgMSAoYXNjZW5kaW5nKVxuXG4gICAgICAgICAgICAgICAgaWYgKGFGaWVsZCAhPT0gbnVsbCAmJiB0eXBlb2YgYUZpZWxkICE9PSAndW5kZWZpbmVkJyAmJiAoYkZpZWxkID09PSBudWxsIHx8IHR5cGVvZiBiRmllbGQgPT09ICd1bmRlZmluZWQnKSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIDEgKiBtb2RpZmllcjtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGJGaWVsZCAhPT0gbnVsbCAmJiB0eXBlb2YgYkZpZWxkICE9PSAndW5kZWZpbmVkJyAmJiAoYUZpZWxkID09PSBudWxsIHx8IHR5cGVvZiBhRmllbGQgPT09ICd1bmRlZmluZWQnKSkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xICogbW9kaWZpZXI7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgYUZpZWxkID09PSAndW5kZWZpbmVkJyAmJiBiRmllbGQgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYUZpZWxkID09PSBudWxsICYmIHR5cGVvZiBiRmllbGQgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFGaWVsZCAhPT0gYkZpZWxkKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gKGFGaWVsZCA8IGJGaWVsZCA/IC0xIDogMSkgKiBtb2RpZmllcjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIH0sIHVuZGVmaW5lZCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5za2lwID4gMCkge1xuICAgICAgICAgIGlmICh0aGlzLmxpbWl0IDwgSW5maW5pdHkpIHtcbiAgICAgICAgICAgIHByb2Nlc3NlZERvY3MgPSBwcm9jZXNzZWREb2NzLnNsaWNlKHRoaXMuc2tpcCwgdGhpcy5za2lwICsgdGhpcy5saW1pdCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHByb2Nlc3NlZERvY3MgPSBwcm9jZXNzZWREb2NzLnNsaWNlKHRoaXMuc2tpcCk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMubGltaXQgPCBJbmZpbml0eSkge1xuICAgICAgICAgIHByb2Nlc3NlZERvY3MgPSBwcm9jZXNzZWREb2NzLnNsaWNlKDAsIHRoaXMubGltaXQpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCgwLCBfaXNBcnJheS5kZWZhdWx0KSh0aGlzLmZpZWxkcykgJiYgdGhpcy5maWVsZHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHByb2Nlc3NlZERvY3MgPSBwcm9jZXNzZWREb2NzLm1hcChmdW5jdGlvbiAoZG9jKSB7XG4gICAgICAgICAgICB2YXIgbW9kaWZpZWREb2MgPSBkb2M7XG4gICAgICAgICAgICBPYmplY3Qua2V5cyhtb2RpZmllZERvYykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgICAgIGlmIChfdGhpczMuZmllbGRzLmluZGV4T2Yoa2V5KSA9PT0gLTEgJiYgUFJPVEVDVEVEX0ZJRUxEUy5pbmRleE9mKGtleSkgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIG1vZGlmaWVkRG9jW2tleV07XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIG1vZGlmaWVkRG9jO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHByb2Nlc3NlZERvY3M7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBkb2NzO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJmaWVsZHNcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9maWVsZHM7XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uIHNldChmaWVsZHMpIHtcbiAgICAgIGlmICghQXJyYXkuaXNBcnJheShmaWVsZHMpKSB7XG4gICAgICAgIHRocm93IG5ldyBfcXVlcnkuZGVmYXVsdCgnZmllbGRzIG11c3QgYmUgYW4gQXJyYXknKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuX3BhcmVudCkge1xuICAgICAgICB0aGlzLl9wYXJlbnQuZmllbGRzID0gZmllbGRzO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fZmllbGRzID0gZmllbGRzO1xuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJzb3J0XCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc29ydDtcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24gc2V0KHNvcnQpIHtcbiAgICAgIGlmIChzb3J0ICYmICEoMCwgX2lzUGxhaW5PYmplY3QuZGVmYXVsdCkoc29ydCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IF9xdWVyeS5kZWZhdWx0KCdzb3J0IG11c3QgYW4gT2JqZWN0Jyk7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLl9wYXJlbnQpIHtcbiAgICAgICAgdGhpcy5fcGFyZW50LnNvcnQgPSBzb3J0O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fc29ydCA9IHNvcnQ7XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImxpbWl0XCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fbGltaXQ7XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uIHNldChsaW1pdCkge1xuICAgICAgdmFyIF9saW1pdCA9IGxpbWl0O1xuXG4gICAgICBpZiAoKDAsIF9pc1N0cmluZy5kZWZhdWx0KShfbGltaXQpKSB7XG4gICAgICAgIF9saW1pdCA9IHBhcnNlRmxvYXQoX2xpbWl0KTtcbiAgICAgIH1cblxuICAgICAgaWYgKGxpbWl0ICYmICEoMCwgX2lzTnVtYmVyLmRlZmF1bHQpKF9saW1pdCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IF9xdWVyeS5kZWZhdWx0KCdsaW1pdCBtdXN0IGJlIGEgbnVtYmVyJyk7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLl9wYXJlbnQpIHtcbiAgICAgICAgdGhpcy5fcGFyZW50LmxpbWl0ID0gX2xpbWl0O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fbGltaXQgPSBfbGltaXQ7XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInNraXBcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9za2lwO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiBzZXQoc2tpcCkge1xuICAgICAgdmFyIF9za2lwID0gc2tpcDtcblxuICAgICAgaWYgKCgwLCBfaXNTdHJpbmcuZGVmYXVsdCkoX3NraXApKSB7XG4gICAgICAgIF9za2lwID0gcGFyc2VGbG9hdChfc2tpcCk7XG4gICAgICB9XG5cbiAgICAgIGlmICghKDAsIF9pc051bWJlci5kZWZhdWx0KShfc2tpcCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IF9xdWVyeS5kZWZhdWx0KCdza2lwIG11c3QgYmUgYSBudW1iZXInKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuX3BhcmVudCkge1xuICAgICAgICB0aGlzLl9wYXJlbnQuc2tpcCA9IF9za2lwO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fc2tpcCA9IF9za2lwO1xuICAgICAgfVxuICAgIH1cbiAgfV0pO1xuICByZXR1cm4gUXVlcnk7XG59KCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IFF1ZXJ5OyIsIlwidXNlIHN0cmljdFwiO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX3Nlc3Npb24gPSByZXF1aXJlKFwiLi9zZXNzaW9uXCIpO1xuXG5PYmplY3Qua2V5cyhfc2Vzc2lvbikuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gIGlmIChrZXkgPT09IFwiZGVmYXVsdFwiIHx8IGtleSA9PT0gXCJfX2VzTW9kdWxlXCIpIHJldHVybjtcbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwge1xuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICByZXR1cm4gX3Nlc3Npb25ba2V5XTtcbiAgICB9XG4gIH0pO1xufSk7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmdldCA9IGdldDtcbmV4cG9ydHMuc2V0ID0gc2V0O1xuZXhwb3J0cy5yZW1vdmUgPSByZW1vdmU7XG5cbnZhciBfdXRpbHMgPSByZXF1aXJlKFwiLi91dGlsc1wiKTtcblxuZnVuY3Rpb24gZ2V0KCkge1xuICB2YXIga2V5ID0gKDAsIF91dGlscy5nZXRLZXkpKCk7XG4gIHZhciBzZXNzaW9uID0gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKGtleSk7XG5cbiAgaWYgKHNlc3Npb24pIHtcbiAgICByZXR1cm4gSlNPTi5wYXJzZShzZXNzaW9uKTtcbiAgfVxuXG4gIHJldHVybiBudWxsO1xufVxuXG5mdW5jdGlvbiBzZXQoc2Vzc2lvbikge1xuICB2YXIga2V5ID0gKDAsIF91dGlscy5nZXRLZXkpKCk7XG4gIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShrZXksIEpTT04uc3RyaW5naWZ5KHNlc3Npb24pKTtcbiAgcmV0dXJuIHRydWU7XG59XG5cbmZ1bmN0aW9uIHJlbW92ZSgpIHtcbiAgdmFyIGtleSA9ICgwLCBfdXRpbHMuZ2V0S2V5KSgpO1xuICB3aW5kb3cubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oa2V5KTtcbiAgcmV0dXJuIHRydWU7XG59IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmdldEtleSA9IGdldEtleTtcblxudmFyIF9jb25maWcgPSByZXF1aXJlKFwiLi4va2ludmV5L2NvbmZpZ1wiKTtcblxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9wcmVmZXItZGVmYXVsdC1leHBvcnRcbmZ1bmN0aW9uIGdldEtleSgpIHtcbiAgdmFyIF9nZXRDb25maWcgPSAoMCwgX2NvbmZpZy5nZXQpKCksXG4gICAgICBhcHBLZXkgPSBfZ2V0Q29uZmlnLmFwcEtleTtcblxuICByZXR1cm4gXCJcIi5jb25jYXQoYXBwS2V5LCBcIi5hY3RpdmVfdXNlclwiKTtcbn0iLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSBleGlzdHM7XG5cbnZhciBfcmVnZW5lcmF0b3IgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9yZWdlbmVyYXRvclwiKSk7XG5cbnZhciBfYXN5bmNUb0dlbmVyYXRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2FzeW5jVG9HZW5lcmF0b3JcIikpO1xuXG52YXIgX2lzU3RyaW5nID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwibG9kYXNoL2lzU3RyaW5nXCIpKTtcblxudmFyIF9jb25maWcgPSByZXF1aXJlKFwiLi4va2ludmV5L2NvbmZpZ1wiKTtcblxudmFyIF9raW52ZXkgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi9lcnJvcnMva2ludmV5XCIpKTtcblxudmFyIF91dGlscyA9IHJlcXVpcmUoXCIuLi9odHRwL3V0aWxzXCIpO1xuXG52YXIgX3JlcXVlc3QgPSByZXF1aXJlKFwiLi4vaHR0cC9yZXF1ZXN0XCIpO1xuXG52YXIgX2F1dGggPSByZXF1aXJlKFwiLi4vaHR0cC9hdXRoXCIpO1xuXG52YXIgUlBDX05BTUVTUEFDRSA9ICdycGMnO1xuXG5mdW5jdGlvbiBleGlzdHMoX3gpIHtcbiAgcmV0dXJuIF9leGlzdHMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cblxuZnVuY3Rpb24gX2V4aXN0cygpIHtcbiAgX2V4aXN0cyA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gIC8qI19fUFVSRV9fKi9cbiAgX3JlZ2VuZXJhdG9yLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlKHVzZXJuYW1lKSB7XG4gICAgdmFyIG9wdGlvbnMsXG4gICAgICAgIF9nZXRDb25maWcsXG4gICAgICAgIGFwaVByb3RvY29sLFxuICAgICAgICBhcGlIb3N0LFxuICAgICAgICBhcHBLZXksXG4gICAgICAgIHJlcXVlc3QsXG4gICAgICAgIHJlc3BvbnNlLFxuICAgICAgICBfYXJncyA9IGFyZ3VtZW50cztcblxuICAgIHJldHVybiBfcmVnZW5lcmF0b3IuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7XG4gICAgICB3aGlsZSAoMSkge1xuICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7XG4gICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgb3B0aW9ucyA9IF9hcmdzLmxlbmd0aCA+IDEgJiYgX2FyZ3NbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmdzWzFdIDoge307XG4gICAgICAgICAgICBfZ2V0Q29uZmlnID0gKDAsIF9jb25maWcuZ2V0KSgpLCBhcGlQcm90b2NvbCA9IF9nZXRDb25maWcuYXBpUHJvdG9jb2wsIGFwaUhvc3QgPSBfZ2V0Q29uZmlnLmFwaUhvc3QsIGFwcEtleSA9IF9nZXRDb25maWcuYXBwS2V5O1xuXG4gICAgICAgICAgICBpZiAodXNlcm5hbWUpIHtcbiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDQ7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aHJvdyBuZXcgX2tpbnZleS5kZWZhdWx0KCdBIHVzZXJuYW1lIHdhcyBub3QgcHJvdmlkZWQuJyk7XG5cbiAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICBpZiAoKDAsIF9pc1N0cmluZy5kZWZhdWx0KSh1c2VybmFtZSkpIHtcbiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDY7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aHJvdyBuZXcgX2tpbnZleS5kZWZhdWx0KCdUaGUgcHJvdmlkZWQgdXNlcm5hbWUgaXMgbm90IGEgc3RyaW5nLicpO1xuXG4gICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgcmVxdWVzdCA9IG5ldyBfcmVxdWVzdC5LaW52ZXlSZXF1ZXN0KHtcbiAgICAgICAgICAgICAgbWV0aG9kOiBfcmVxdWVzdC5SZXF1ZXN0TWV0aG9kLlBPU1QsXG4gICAgICAgICAgICAgIGF1dGg6IF9hdXRoLkF1dGguQXBwLFxuICAgICAgICAgICAgICB1cmw6ICgwLCBfdXRpbHMuZm9ybWF0S2ludmV5VXJsKShhcGlQcm90b2NvbCwgYXBpSG9zdCwgXCIvXCIuY29uY2F0KFJQQ19OQU1FU1BBQ0UsIFwiL1wiKS5jb25jYXQoYXBwS2V5LCBcIi9jaGVjay11c2VybmFtZS1leGlzdHNcIikpLFxuICAgICAgICAgICAgICBib2R5OiB7XG4gICAgICAgICAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHRpbWVvdXQ6IG9wdGlvbnMudGltZW91dFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gOTtcbiAgICAgICAgICAgIHJldHVybiByZXF1ZXN0LmV4ZWN1dGUoKTtcblxuICAgICAgICAgIGNhc2UgOTpcbiAgICAgICAgICAgIHJlc3BvbnNlID0gX2NvbnRleHQuc2VudDtcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoXCJyZXR1cm5cIiwgcmVzcG9uc2UuZGF0YS51c2VybmFtZUV4aXN0cyA9PT0gdHJ1ZSk7XG5cbiAgICAgICAgICBjYXNlIDExOlxuICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LCBfY2FsbGVlLCB0aGlzKTtcbiAgfSkpO1xuICByZXR1cm4gX2V4aXN0cy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufSIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IGZvcmdvdFVzZXJuYW1lO1xuXG52YXIgX3JlZ2VuZXJhdG9yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvcmVnZW5lcmF0b3JcIikpO1xuXG52YXIgX2FzeW5jVG9HZW5lcmF0b3IyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9hc3luY1RvR2VuZXJhdG9yXCIpKTtcblxudmFyIF9pc1N0cmluZyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcImxvZGFzaC9pc1N0cmluZ1wiKSk7XG5cbnZhciBfY29uZmlnID0gcmVxdWlyZShcIi4uL2tpbnZleS9jb25maWdcIik7XG5cbnZhciBfa2ludmV5ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vZXJyb3JzL2tpbnZleVwiKSk7XG5cbnZhciBfdXRpbHMgPSByZXF1aXJlKFwiLi4vaHR0cC91dGlsc1wiKTtcblxudmFyIF9yZXF1ZXN0ID0gcmVxdWlyZShcIi4uL2h0dHAvcmVxdWVzdFwiKTtcblxudmFyIF9hdXRoID0gcmVxdWlyZShcIi4uL2h0dHAvYXV0aFwiKTtcblxudmFyIFJQQ19OQU1FU1BBQ0UgPSAncnBjJztcblxuZnVuY3Rpb24gZm9yZ290VXNlcm5hbWUoX3gpIHtcbiAgcmV0dXJuIF9mb3Jnb3RVc2VybmFtZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuXG5mdW5jdGlvbiBfZm9yZ290VXNlcm5hbWUoKSB7XG4gIF9mb3Jnb3RVc2VybmFtZSA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gIC8qI19fUFVSRV9fKi9cbiAgX3JlZ2VuZXJhdG9yLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlKGVtYWlsKSB7XG4gICAgdmFyIG9wdGlvbnMsXG4gICAgICAgIF9nZXRDb25maWcsXG4gICAgICAgIGFwaVByb3RvY29sLFxuICAgICAgICBhcGlIb3N0LFxuICAgICAgICBhcHBLZXksXG4gICAgICAgIHJlcXVlc3QsXG4gICAgICAgIHJlc3BvbnNlLFxuICAgICAgICBfYXJncyA9IGFyZ3VtZW50cztcblxuICAgIHJldHVybiBfcmVnZW5lcmF0b3IuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7XG4gICAgICB3aGlsZSAoMSkge1xuICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7XG4gICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgb3B0aW9ucyA9IF9hcmdzLmxlbmd0aCA+IDEgJiYgX2FyZ3NbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmdzWzFdIDoge307XG4gICAgICAgICAgICBfZ2V0Q29uZmlnID0gKDAsIF9jb25maWcuZ2V0KSgpLCBhcGlQcm90b2NvbCA9IF9nZXRDb25maWcuYXBpUHJvdG9jb2wsIGFwaUhvc3QgPSBfZ2V0Q29uZmlnLmFwaUhvc3QsIGFwcEtleSA9IF9nZXRDb25maWcuYXBwS2V5O1xuXG4gICAgICAgICAgICBpZiAoZW1haWwpIHtcbiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDQ7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aHJvdyBuZXcgX2tpbnZleS5kZWZhdWx0KCdBbiBlbWFpbCB3YXMgbm90IHByb3ZpZGVkLicpO1xuXG4gICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgaWYgKCgwLCBfaXNTdHJpbmcuZGVmYXVsdCkoZW1haWwpKSB7XG4gICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA2O1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhyb3cgbmV3IF9raW52ZXkuZGVmYXVsdCgnVGhlIHByb3ZpZGVkIGVtYWlsIGlzIG5vdCBhIHN0cmluZy4nKTtcblxuICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgIHJlcXVlc3QgPSBuZXcgX3JlcXVlc3QuS2ludmV5UmVxdWVzdCh7XG4gICAgICAgICAgICAgIG1ldGhvZDogX3JlcXVlc3QuUmVxdWVzdE1ldGhvZC5QT1NULFxuICAgICAgICAgICAgICBhdXRoOiBfYXV0aC5BdXRoLkFwcCxcbiAgICAgICAgICAgICAgdXJsOiAoMCwgX3V0aWxzLmZvcm1hdEtpbnZleVVybCkoYXBpUHJvdG9jb2wsIGFwaUhvc3QsIFwiL1wiLmNvbmNhdChSUENfTkFNRVNQQUNFLCBcIi9cIikuY29uY2F0KGFwcEtleSwgXCIvdXNlci1mb3Jnb3QtdXNlcm5hbWVcIikpLFxuICAgICAgICAgICAgICBib2R5OiB7XG4gICAgICAgICAgICAgICAgZW1haWw6IGVtYWlsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHRpbWVvdXQ6IG9wdGlvbnMudGltZW91dFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gOTtcbiAgICAgICAgICAgIHJldHVybiByZXF1ZXN0LmV4ZWN1dGUoKTtcblxuICAgICAgICAgIGNhc2UgOTpcbiAgICAgICAgICAgIHJlc3BvbnNlID0gX2NvbnRleHQuc2VudDtcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoXCJyZXR1cm5cIiwgcmVzcG9uc2UuZGF0YSk7XG5cbiAgICAgICAgICBjYXNlIDExOlxuICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LCBfY2FsbGVlLCB0aGlzKTtcbiAgfSkpO1xuICByZXR1cm4gX2ZvcmdvdFVzZXJuYW1lLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gcmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW50ZXJvcFJlcXVpcmVEZWZhdWx0XCIpO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwO1xuXG52YXIgX2V4aXN0cyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vZXhpc3RzXCIpKTtcblxudmFyIF9mb3Jnb3RVc2VybmFtZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vZm9yZ290VXNlcm5hbWVcIikpO1xuXG52YXIgX2xvZ2luID0gcmVxdWlyZShcIi4vbG9naW5cIik7XG5cbnZhciBfbG9nb3V0ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9sb2dvdXRcIikpO1xuXG52YXIgX2xvb2t1cCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vbG9va3VwXCIpKTtcblxudmFyIF9tZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vbWVcIikpO1xuXG52YXIgX3JlbW92ZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vcmVtb3ZlXCIpKTtcblxudmFyIF9yZXNldFBhc3N3b3JkID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9yZXNldFBhc3N3b3JkXCIpKTtcblxudmFyIF9yZXN0b3JlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9yZXN0b3JlXCIpKTtcblxudmFyIF9zaWdudXAgPSByZXF1aXJlKFwiLi9zaWdudXBcIik7XG5cbnZhciBfdXBkYXRlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi91cGRhdGVcIikpO1xuXG52YXIgX3VzZXIgPSByZXF1aXJlKFwiLi91c2VyXCIpO1xuXG52YXIgX3ZlcmlmeUVtYWlsID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi92ZXJpZnlFbWFpbFwiKSk7XG5cbl91c2VyLlVzZXIuZXhpc3RzID0gX2V4aXN0cy5kZWZhdWx0O1xuX3VzZXIuVXNlci5mb3Jnb3RVc2VybmFtZSA9IF9mb3Jnb3RVc2VybmFtZS5kZWZhdWx0O1xuX3VzZXIuVXNlci5sb2dpbiA9IF9sb2dpbi5sb2dpbjtcbl91c2VyLlVzZXIubG9naW5XaXRoUmVkaXJlY3RVcmkgPSBfbG9naW4ubG9naW5XaXRoUmVkaXJlY3RVcmk7XG5fdXNlci5Vc2VyLmxvZ2luV2l0aFVzZXJuYW1lUGFzc3dvcmQgPSBfbG9naW4ubG9naW5XaXRoVXNlcm5hbWVQYXNzd29yZDtcbl91c2VyLlVzZXIubG9naW5XaXRoTUlDID0gX2xvZ2luLmxvZ2luV2l0aE1JQztcbl91c2VyLlVzZXIubG9nb3V0ID0gX2xvZ291dC5kZWZhdWx0O1xuX3VzZXIuVXNlci5sb29rdXAgPSBfbG9va3VwLmRlZmF1bHQ7XG5fdXNlci5Vc2VyLm1lID0gX21lLmRlZmF1bHQ7XG5fdXNlci5Vc2VyLnJlbW92ZSA9IF9yZW1vdmUuZGVmYXVsdDtcbl91c2VyLlVzZXIucmVzZXRQYXNzd29yZCA9IF9yZXNldFBhc3N3b3JkLmRlZmF1bHQ7XG5fdXNlci5Vc2VyLnJlc3RvcmUgPSBfcmVzdG9yZS5kZWZhdWx0O1xuX3VzZXIuVXNlci5zaWdudXAgPSBfc2lnbnVwLnNpZ251cDtcbl91c2VyLlVzZXIudXBkYXRlID0gX3VwZGF0ZS5kZWZhdWx0O1xuX3VzZXIuVXNlci52ZXJpZnlFbWFpbCA9IF92ZXJpZnlFbWFpbC5kZWZhdWx0O1xuX3VzZXIuVXNlci5nZXRBY3RpdmVVc2VyID0gX3VzZXIuZ2V0QWN0aXZlVXNlcjtcbnZhciBfZGVmYXVsdCA9IF91c2VyLlVzZXI7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDsiLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkID0gcmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW50ZXJvcFJlcXVpcmVXaWxkY2FyZFwiKTtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmxvZ2luID0gbG9naW47XG5leHBvcnRzLmxvZ2luV2l0aFJlZGlyZWN0VXJpID0gbG9naW5XaXRoUmVkaXJlY3RVcmk7XG5leHBvcnRzLmxvZ2luV2l0aE1JQyA9IGxvZ2luV2l0aE1JQztcbmV4cG9ydHMubG9naW5XaXRoVXNlcm5hbWVQYXNzd29yZCA9IGxvZ2luV2l0aFVzZXJuYW1lUGFzc3dvcmQ7XG5cbnZhciBfcmVnZW5lcmF0b3IgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9yZWdlbmVyYXRvclwiKSk7XG5cbnZhciBfYXN5bmNUb0dlbmVyYXRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2FzeW5jVG9HZW5lcmF0b3JcIikpO1xuXG52YXIgX2lzUGxhaW5PYmplY3QgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJsb2Rhc2gvaXNQbGFpbk9iamVjdFwiKSk7XG5cbnZhciBfY29uZmlnID0gcmVxdWlyZShcIi4uL2tpbnZleS9jb25maWdcIik7XG5cbnZhciBfYWN0aXZlVXNlciA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uL2Vycm9ycy9hY3RpdmVVc2VyXCIpKTtcblxudmFyIF9raW52ZXkgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi9lcnJvcnMva2ludmV5XCIpKTtcblxudmFyIF9ub3RGb3VuZCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uL2Vycm9ycy9ub3RGb3VuZFwiKSk7XG5cbnZhciBfdXRpbHMgPSByZXF1aXJlKFwiLi4vaHR0cC91dGlsc1wiKTtcblxudmFyIF9yZXF1ZXN0ID0gcmVxdWlyZShcIi4uL2h0dHAvcmVxdWVzdFwiKTtcblxudmFyIF9hdXRoID0gcmVxdWlyZShcIi4uL2h0dHAvYXV0aFwiKTtcblxudmFyIF9zZXNzaW9uID0gcmVxdWlyZShcIi4uL3Nlc3Npb25cIik7XG5cbnZhciBfdXNlciA9IHJlcXVpcmUoXCIuL3VzZXJcIik7XG5cbnZhciBfdXRpbHMyID0gcmVxdWlyZShcIi4vdXRpbHNcIik7XG5cbnZhciBNSUMgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKFwiLi9taWNcIikpO1xuXG52YXIgX3NpZ251cCA9IHJlcXVpcmUoXCIuL3NpZ251cFwiKTtcblxudmFyIFVTRVJfTkFNRVNQQUNFID0gJ3VzZXInO1xuXG5mdW5jdGlvbiBsb2dpbihfeCwgX3gyKSB7XG4gIHJldHVybiBfbG9naW4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cblxuZnVuY3Rpb24gX2xvZ2luKCkge1xuICBfbG9naW4gPSAoMCwgX2FzeW5jVG9HZW5lcmF0b3IyLmRlZmF1bHQpKFxuICAvKiNfX1BVUkVfXyovXG4gIF9yZWdlbmVyYXRvci5kZWZhdWx0Lm1hcmsoZnVuY3Rpb24gX2NhbGxlZSh1c2VybmFtZSwgcGFzc3dvcmQpIHtcbiAgICB2YXIgb3B0aW9ucyxcbiAgICAgICAgX2dldENvbmZpZyxcbiAgICAgICAgYXBpUHJvdG9jb2wsXG4gICAgICAgIGFwaUhvc3QsXG4gICAgICAgIGFwcEtleSxcbiAgICAgICAgYWN0aXZlVXNlcixcbiAgICAgICAgY3JlZGVudGlhbHMsXG4gICAgICAgIHJlcXVlc3QsXG4gICAgICAgIHJlc3BvbnNlLFxuICAgICAgICBzZXNzaW9uLFxuICAgICAgICBfYXJncyA9IGFyZ3VtZW50cztcblxuICAgIHJldHVybiBfcmVnZW5lcmF0b3IuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7XG4gICAgICB3aGlsZSAoMSkge1xuICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7XG4gICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgb3B0aW9ucyA9IF9hcmdzLmxlbmd0aCA+IDIgJiYgX2FyZ3NbMl0gIT09IHVuZGVmaW5lZCA/IF9hcmdzWzJdIDoge307XG4gICAgICAgICAgICBfZ2V0Q29uZmlnID0gKDAsIF9jb25maWcuZ2V0KSgpLCBhcGlQcm90b2NvbCA9IF9nZXRDb25maWcuYXBpUHJvdG9jb2wsIGFwaUhvc3QgPSBfZ2V0Q29uZmlnLmFwaUhvc3QsIGFwcEtleSA9IF9nZXRDb25maWcuYXBwS2V5O1xuICAgICAgICAgICAgYWN0aXZlVXNlciA9ICgwLCBfdXNlci5nZXRBY3RpdmVVc2VyKSgpO1xuICAgICAgICAgICAgY3JlZGVudGlhbHMgPSB1c2VybmFtZTtcblxuICAgICAgICAgICAgaWYgKCFhY3RpdmVVc2VyKSB7XG4gICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA2O1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhyb3cgbmV3IF9hY3RpdmVVc2VyLmRlZmF1bHQoJ0FuIGFjdGl2ZSB1c2VyIGFscmVhZHkgZXhpc3RzLiBQbGVhc2UgbG9nb3V0IHRoZSBhY3RpdmUgdXNlciBiZWZvcmUgeW91IGxvZ2luLicpO1xuXG4gICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgaWYgKCEoMCwgX2lzUGxhaW5PYmplY3QuZGVmYXVsdCkoY3JlZGVudGlhbHMpKSB7XG4gICAgICAgICAgICAgIGNyZWRlbnRpYWxzID0ge1xuICAgICAgICAgICAgICAgIHVzZXJuYW1lOiB1c2VybmFtZSxcbiAgICAgICAgICAgICAgICBwYXNzd29yZDogcGFzc3dvcmRcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGNyZWRlbnRpYWxzLnVzZXJuYW1lKSB7XG4gICAgICAgICAgICAgIGNyZWRlbnRpYWxzLnVzZXJuYW1lID0gU3RyaW5nKGNyZWRlbnRpYWxzLnVzZXJuYW1lKS50cmltKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChjcmVkZW50aWFscy5wYXNzd29yZCkge1xuICAgICAgICAgICAgICBjcmVkZW50aWFscy5wYXNzd29yZCA9IFN0cmluZyhjcmVkZW50aWFscy5wYXNzd29yZCkudHJpbSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoISgoIWNyZWRlbnRpYWxzLnVzZXJuYW1lIHx8IGNyZWRlbnRpYWxzLnVzZXJuYW1lID09PSAnJyB8fCAhY3JlZGVudGlhbHMucGFzc3dvcmQgfHwgY3JlZGVudGlhbHMucGFzc3dvcmQgPT09ICcnKSAmJiAhY3JlZGVudGlhbHMuX3NvY2lhbElkZW50aXR5KSkge1xuICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTE7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aHJvdyBuZXcgX2tpbnZleS5kZWZhdWx0KCdVc2VybmFtZSBhbmQvb3IgcGFzc3dvcmQgbWlzc2luZy4gUGxlYXNlIHByb3ZpZGUgYm90aCBhIHVzZXJuYW1lIGFuZCBwYXNzd29yZCB0byBsb2dpbi4nKTtcblxuICAgICAgICAgIGNhc2UgMTE6XG4gICAgICAgICAgICByZXF1ZXN0ID0gbmV3IF9yZXF1ZXN0LktpbnZleVJlcXVlc3Qoe1xuICAgICAgICAgICAgICBtZXRob2Q6IF9yZXF1ZXN0LlJlcXVlc3RNZXRob2QuUE9TVCxcbiAgICAgICAgICAgICAgYXV0aDogX2F1dGguQXV0aC5BcHAsXG4gICAgICAgICAgICAgIHVybDogKDAsIF91dGlscy5mb3JtYXRLaW52ZXlVcmwpKGFwaVByb3RvY29sLCBhcGlIb3N0LCBcIi9cIi5jb25jYXQoVVNFUl9OQU1FU1BBQ0UsIFwiL1wiKS5jb25jYXQoYXBwS2V5LCBcIi9sb2dpblwiKSksXG4gICAgICAgICAgICAgIGJvZHk6IGNyZWRlbnRpYWxzLFxuICAgICAgICAgICAgICB0aW1lb3V0OiBvcHRpb25zLnRpbWVvdXRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE0O1xuICAgICAgICAgICAgcmV0dXJuIHJlcXVlc3QuZXhlY3V0ZSgpO1xuXG4gICAgICAgICAgY2FzZSAxNDpcbiAgICAgICAgICAgIHJlc3BvbnNlID0gX2NvbnRleHQuc2VudDtcbiAgICAgICAgICAgIHNlc3Npb24gPSByZXNwb25zZS5kYXRhOyAvLyBSZW1vdmUgc2Vuc2l0aXZlIGRhdGFcblxuICAgICAgICAgICAgZGVsZXRlIHNlc3Npb24ucGFzc3dvcmQ7IC8vIE1lcmdlIF9zb2NpYWxJZGVudGl0eVxuXG4gICAgICAgICAgICBpZiAoY3JlZGVudGlhbHMuX3NvY2lhbElkZW50aXR5KSB7XG4gICAgICAgICAgICAgIHNlc3Npb24uX3NvY2lhbElkZW50aXR5ID0gKDAsIF91dGlsczIubWVyZ2VTb2NpYWxJZGVudGl0eSkoY3JlZGVudGlhbHMuX3NvY2lhbElkZW50aXR5LCBzZXNzaW9uLl9zb2NpYWxJZGVudGl0eSk7XG4gICAgICAgICAgICB9IC8vIFN0b3JlIHRoZSBhY3RpdmUgc2Vzc2lvblxuXG5cbiAgICAgICAgICAgICgwLCBfc2Vzc2lvbi5zZXQpKHNlc3Npb24pOyAvLyBSZXR1cm4gdGhlIHVzZXJcblxuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdChcInJldHVyblwiLCBuZXcgX3VzZXIuVXNlcihzZXNzaW9uKSk7XG5cbiAgICAgICAgICBjYXNlIDIwOlxuICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LCBfY2FsbGVlLCB0aGlzKTtcbiAgfSkpO1xuICByZXR1cm4gX2xvZ2luLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5cbmZ1bmN0aW9uIGxvZ2luV2l0aFJlZGlyZWN0VXJpKF94MywgX3g0KSB7XG4gIHJldHVybiBfbG9naW5XaXRoUmVkaXJlY3RVcmkuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cblxuZnVuY3Rpb24gX2xvZ2luV2l0aFJlZGlyZWN0VXJpKCkge1xuICBfbG9naW5XaXRoUmVkaXJlY3RVcmkgPSAoMCwgX2FzeW5jVG9HZW5lcmF0b3IyLmRlZmF1bHQpKFxuICAvKiNfX1BVUkVfXyovXG4gIF9yZWdlbmVyYXRvci5kZWZhdWx0Lm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIocmVkaXJlY3RVcmksIG9wdGlvbnMpIHtcbiAgICB2YXIgYWN0aXZlVXNlciwgc2Vzc2lvbiwgc29jaWFsSWRlbnRpdHksIGNyZWRlbnRpYWxzO1xuICAgIHJldHVybiBfcmVnZW5lcmF0b3IuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHtcbiAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkge1xuICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIGFjdGl2ZVVzZXIgPSAoMCwgX3VzZXIuZ2V0QWN0aXZlVXNlcikoKTtcblxuICAgICAgICAgICAgaWYgKCFhY3RpdmVVc2VyKSB7XG4gICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMztcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRocm93IG5ldyBfYWN0aXZlVXNlci5kZWZhdWx0KCdBbiBhY3RpdmUgdXNlciBhbHJlYWR5IGV4aXN0cy4gUGxlYXNlIGxvZ291dCB0aGUgYWN0aXZlIHVzZXIgYmVmb3JlIHlvdSBsb2dpbiB3aXRoIE1vYmlsZSBJZGVudGl0eSBDb25uZWN0LicpO1xuXG4gICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA1O1xuICAgICAgICAgICAgcmV0dXJuIE1JQy5sb2dpbldpdGhSZWRpcmVjdFVyaShyZWRpcmVjdFVyaSwgb3B0aW9ucyk7XG5cbiAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICBzZXNzaW9uID0gX2NvbnRleHQyLnNlbnQ7XG4gICAgICAgICAgICBzb2NpYWxJZGVudGl0eSA9IHt9O1xuICAgICAgICAgICAgc29jaWFsSWRlbnRpdHlbTUlDLklERU5USVRZXSA9IHNlc3Npb247XG4gICAgICAgICAgICBjcmVkZW50aWFscyA9IHtcbiAgICAgICAgICAgICAgX3NvY2lhbElkZW50aXR5OiBzb2NpYWxJZGVudGl0eVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIF9jb250ZXh0Mi5wcmV2ID0gOTtcbiAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTI7XG4gICAgICAgICAgICByZXR1cm4gbG9naW4oY3JlZGVudGlhbHMpO1xuXG4gICAgICAgICAgY2FzZSAxMjpcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KFwicmV0dXJuXCIsIF9jb250ZXh0Mi5zZW50KTtcblxuICAgICAgICAgIGNhc2UgMTU6XG4gICAgICAgICAgICBfY29udGV4dDIucHJldiA9IDE1O1xuICAgICAgICAgICAgX2NvbnRleHQyLnQwID0gX2NvbnRleHQyW1wiY2F0Y2hcIl0oOSk7XG5cbiAgICAgICAgICAgIGlmICghKF9jb250ZXh0Mi50MCBpbnN0YW5jZW9mIF9ub3RGb3VuZC5kZWZhdWx0KSkge1xuICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDIxO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAyMDtcbiAgICAgICAgICAgIHJldHVybiAoMCwgX3NpZ251cC5zaWdudXApKGNyZWRlbnRpYWxzKTtcblxuICAgICAgICAgIGNhc2UgMjA6XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdChcInJldHVyblwiLCBfY29udGV4dDIuc2VudCk7XG5cbiAgICAgICAgICBjYXNlIDIxOlxuICAgICAgICAgICAgdGhyb3cgX2NvbnRleHQyLnQwO1xuXG4gICAgICAgICAgY2FzZSAyMjpcbiAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIF9jYWxsZWUyLCB0aGlzLCBbWzksIDE1XV0pO1xuICB9KSk7XG4gIHJldHVybiBfbG9naW5XaXRoUmVkaXJlY3RVcmkuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cblxuZnVuY3Rpb24gbG9naW5XaXRoTUlDKF94NSwgX3g2LCBfeDcpIHtcbiAgcmV0dXJuIF9sb2dpbldpdGhNSUMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cblxuZnVuY3Rpb24gX2xvZ2luV2l0aE1JQygpIHtcbiAgX2xvZ2luV2l0aE1JQyA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gIC8qI19fUFVSRV9fKi9cbiAgX3JlZ2VuZXJhdG9yLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlMyhyZWRpcmVjdFVyaSwgYXV0aG9yaXphdGlvbkdyYW50LCBvcHRpb25zKSB7XG4gICAgcmV0dXJuIF9yZWdlbmVyYXRvci5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0Mykge1xuICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7XG4gICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoXCJyZXR1cm5cIiwgbG9naW5XaXRoUmVkaXJlY3RVcmkocmVkaXJlY3RVcmksIG9wdGlvbnMpKTtcblxuICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIF9jYWxsZWUzLCB0aGlzKTtcbiAgfSkpO1xuICByZXR1cm4gX2xvZ2luV2l0aE1JQy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuXG5mdW5jdGlvbiBsb2dpbldpdGhVc2VybmFtZVBhc3N3b3JkKF94OCwgX3g5LCBfeDEwKSB7XG4gIHJldHVybiBfbG9naW5XaXRoVXNlcm5hbWVQYXNzd29yZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuXG5mdW5jdGlvbiBfbG9naW5XaXRoVXNlcm5hbWVQYXNzd29yZCgpIHtcbiAgX2xvZ2luV2l0aFVzZXJuYW1lUGFzc3dvcmQgPSAoMCwgX2FzeW5jVG9HZW5lcmF0b3IyLmRlZmF1bHQpKFxuICAvKiNfX1BVUkVfXyovXG4gIF9yZWdlbmVyYXRvci5kZWZhdWx0Lm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQodXNlcm5hbWUsIHBhc3N3b3JkLCBvcHRpb25zKSB7XG4gICAgdmFyIGFjdGl2ZVVzZXIsIHNlc3Npb24sIHNvY2lhbElkZW50aXR5LCBjcmVkZW50aWFscztcbiAgICByZXR1cm4gX3JlZ2VuZXJhdG9yLmRlZmF1bHQud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7XG4gICAgICB3aGlsZSAoMSkge1xuICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHtcbiAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICBhY3RpdmVVc2VyID0gKDAsIF91c2VyLmdldEFjdGl2ZVVzZXIpKCk7XG5cbiAgICAgICAgICAgIGlmICghYWN0aXZlVXNlcikge1xuICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDM7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aHJvdyBuZXcgX2FjdGl2ZVVzZXIuZGVmYXVsdCgnQW4gYWN0aXZlIHVzZXIgYWxyZWFkeSBleGlzdHMuIFBsZWFzZSBsb2dvdXQgdGhlIGFjdGl2ZSB1c2VyIGJlZm9yZSB5b3UgbG9naW4gd2l0aCBNb2JpbGUgSWRlbnRpdHkgQ29ubmVjdC4nKTtcblxuICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gNTtcbiAgICAgICAgICAgIHJldHVybiBNSUMubG9naW5XaXRoVXNlcm5hbWVQYXNzd29yZCh1c2VybmFtZSwgcGFzc3dvcmQsIG9wdGlvbnMpO1xuXG4gICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgc2Vzc2lvbiA9IF9jb250ZXh0NC5zZW50O1xuICAgICAgICAgICAgc29jaWFsSWRlbnRpdHkgPSB7fTtcbiAgICAgICAgICAgIHNvY2lhbElkZW50aXR5W01JQy5JREVOVElUWV0gPSBzZXNzaW9uO1xuICAgICAgICAgICAgY3JlZGVudGlhbHMgPSB7XG4gICAgICAgICAgICAgIF9zb2NpYWxJZGVudGl0eTogc29jaWFsSWRlbnRpdHlcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBfY29udGV4dDQucHJldiA9IDk7XG4gICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDEyO1xuICAgICAgICAgICAgcmV0dXJuIGxvZ2luKGNyZWRlbnRpYWxzKTtcblxuICAgICAgICAgIGNhc2UgMTI6XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LmFicnVwdChcInJldHVyblwiLCBfY29udGV4dDQuc2VudCk7XG5cbiAgICAgICAgICBjYXNlIDE1OlxuICAgICAgICAgICAgX2NvbnRleHQ0LnByZXYgPSAxNTtcbiAgICAgICAgICAgIF9jb250ZXh0NC50MCA9IF9jb250ZXh0NFtcImNhdGNoXCJdKDkpO1xuXG4gICAgICAgICAgICBpZiAoIShfY29udGV4dDQudDAgaW5zdGFuY2VvZiBfbm90Rm91bmQuZGVmYXVsdCkpIHtcbiAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAyMTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMjA7XG4gICAgICAgICAgICByZXR1cm4gKDAsIF9zaWdudXAuc2lnbnVwKShjcmVkZW50aWFscyk7XG5cbiAgICAgICAgICBjYXNlIDIwOlxuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5hYnJ1cHQoXCJyZXR1cm5cIiwgX2NvbnRleHQ0LnNlbnQpO1xuXG4gICAgICAgICAgY2FzZSAyMTpcbiAgICAgICAgICAgIHRocm93IF9jb250ZXh0NC50MDtcblxuICAgICAgICAgIGNhc2UgMjI6XG4gICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5zdG9wKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LCBfY2FsbGVlNCwgdGhpcywgW1s5LCAxNV1dKTtcbiAgfSkpO1xuICByZXR1cm4gX2xvZ2luV2l0aFVzZXJuYW1lUGFzc3dvcmQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn0iLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSBsb2dvdXQ7XG5cbnZhciBfcmVnZW5lcmF0b3IgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9yZWdlbmVyYXRvclwiKSk7XG5cbnZhciBfYXN5bmNUb0dlbmVyYXRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2FzeW5jVG9HZW5lcmF0b3JcIikpO1xuXG52YXIgX3VzZXIgPSByZXF1aXJlKFwiLi91c2VyXCIpO1xuXG5mdW5jdGlvbiBsb2dvdXQoX3gpIHtcbiAgcmV0dXJuIF9sb2dvdXQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cblxuZnVuY3Rpb24gX2xvZ291dCgpIHtcbiAgX2xvZ291dCA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gIC8qI19fUFVSRV9fKi9cbiAgX3JlZ2VuZXJhdG9yLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlKG9wdGlvbnMpIHtcbiAgICB2YXIgYWN0aXZlVXNlcjtcbiAgICByZXR1cm4gX3JlZ2VuZXJhdG9yLmRlZmF1bHQud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkge1xuICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkge1xuICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIGFjdGl2ZVVzZXIgPSAoMCwgX3VzZXIuZ2V0QWN0aXZlVXNlcikoKTtcblxuICAgICAgICAgICAgaWYgKCFhY3RpdmVVc2VyKSB7XG4gICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdChcInJldHVyblwiLCBhY3RpdmVVc2VyLmxvZ291dChvcHRpb25zKSk7XG5cbiAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KFwicmV0dXJuXCIsIG51bGwpO1xuXG4gICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LCBfY2FsbGVlLCB0aGlzKTtcbiAgfSkpO1xuICByZXR1cm4gX2xvZ291dC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufSIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IGxvb2t1cDtcblxudmFyIF9yZWdlbmVyYXRvciA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL3JlZ2VuZXJhdG9yXCIpKTtcblxudmFyIF9hc3luY1RvR2VuZXJhdG9yMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXN5bmNUb0dlbmVyYXRvclwiKSk7XG5cbnZhciBfb2JzZXJ2YWJsZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uL29ic2VydmFibGVcIikpO1xuXG52YXIgX3F1ZXJ5ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vcXVlcnlcIikpO1xuXG52YXIgX2tpbnZleSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uL2Vycm9ycy9raW52ZXlcIikpO1xuXG52YXIgX2NvbmZpZyA9IHJlcXVpcmUoXCIuLi9raW52ZXkvY29uZmlnXCIpO1xuXG52YXIgX3V0aWxzID0gcmVxdWlyZShcIi4uL2h0dHAvdXRpbHNcIik7XG5cbnZhciBfcmVxdWVzdCA9IHJlcXVpcmUoXCIuLi9odHRwL3JlcXVlc3RcIik7XG5cbnZhciBfYXV0aCA9IHJlcXVpcmUoXCIuLi9odHRwL2F1dGhcIik7XG5cbnZhciBVU0VSX05BTUVTUEFDRSA9ICd1c2VyJztcblxuZnVuY3Rpb24gbG9va3VwKHF1ZXJ5KSB7XG4gIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7fTtcblxuICB2YXIgc3RyZWFtID0gX29ic2VydmFibGUuZGVmYXVsdC5jcmVhdGUoXG4gIC8qI19fUFVSRV9fKi9cbiAgZnVuY3Rpb24gKCkge1xuICAgIHZhciBfcmVmID0gKDAsIF9hc3luY1RvR2VuZXJhdG9yMi5kZWZhdWx0KShcbiAgICAvKiNfX1BVUkVfXyovXG4gICAgX3JlZ2VuZXJhdG9yLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlKG9ic2VydmVyKSB7XG4gICAgICB2YXIgX2dldENvbmZpZywgYXBpUHJvdG9jb2wsIGFwaUhvc3QsIGFwcEtleSwgcmVxdWVzdCwgcmVzcG9uc2U7XG5cbiAgICAgIHJldHVybiBfcmVnZW5lcmF0b3IuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7XG4gICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkge1xuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMDtcblxuICAgICAgICAgICAgICBpZiAoIShxdWVyeSAmJiAhKHF1ZXJ5IGluc3RhbmNlb2YgX3F1ZXJ5LmRlZmF1bHQpKSkge1xuICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgdGhyb3cgbmV3IF9raW52ZXkuZGVmYXVsdCgnSW52YWxpZCBxdWVyeS4gSXQgbXVzdCBiZSBhbiBpbnN0YW5jZSBvZiB0aGUgUXVlcnkgY2xhc3MuJyk7XG5cbiAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgX2dldENvbmZpZyA9ICgwLCBfY29uZmlnLmdldCkoKSwgYXBpUHJvdG9jb2wgPSBfZ2V0Q29uZmlnLmFwaVByb3RvY29sLCBhcGlIb3N0ID0gX2dldENvbmZpZy5hcGlIb3N0LCBhcHBLZXkgPSBfZ2V0Q29uZmlnLmFwcEtleTtcbiAgICAgICAgICAgICAgcmVxdWVzdCA9IG5ldyBfcmVxdWVzdC5LaW52ZXlSZXF1ZXN0KHtcbiAgICAgICAgICAgICAgICBtZXRob2Q6IF9yZXF1ZXN0LlJlcXVlc3RNZXRob2QuUE9TVCxcbiAgICAgICAgICAgICAgICBhdXRoOiBfYXV0aC5BdXRoLkRlZmF1bHQsXG4gICAgICAgICAgICAgICAgdXJsOiAoMCwgX3V0aWxzLmZvcm1hdEtpbnZleVVybCkoYXBpUHJvdG9jb2wsIGFwaUhvc3QsIFwiL1wiLmNvbmNhdChVU0VSX05BTUVTUEFDRSwgXCIvXCIpLmNvbmNhdChhcHBLZXksIFwiL19sb29rdXBcIikpLFxuICAgICAgICAgICAgICAgIGJvZHk6IHF1ZXJ5ID8gcXVlcnkuZmlsdGVyIDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIHRpbWVvdXQ6IG9wdGlvbnMudGltZW91dFxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDc7XG4gICAgICAgICAgICAgIHJldHVybiByZXF1ZXN0LmV4ZWN1dGUoKTtcblxuICAgICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgICByZXNwb25zZSA9IF9jb250ZXh0LnNlbnQ7XG4gICAgICAgICAgICAgIG9ic2VydmVyLm5leHQocmVzcG9uc2UuZGF0YSk7XG4gICAgICAgICAgICAgIG9ic2VydmVyLmNvbXBsZXRlKCk7XG4gICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxNTtcbiAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgMTI6XG4gICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAxMjtcbiAgICAgICAgICAgICAgX2NvbnRleHQudDAgPSBfY29udGV4dFtcImNhdGNoXCJdKDApO1xuICAgICAgICAgICAgICBvYnNlcnZlci5lcnJvcihfY29udGV4dC50MCk7XG5cbiAgICAgICAgICAgIGNhc2UgMTU6XG4gICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LCBfY2FsbGVlLCB0aGlzLCBbWzAsIDEyXV0pO1xuICAgIH0pKTtcblxuICAgIHJldHVybiBmdW5jdGlvbiAoX3gpIHtcbiAgICAgIHJldHVybiBfcmVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfTtcbiAgfSgpKTtcblxuICByZXR1cm4gc3RyZWFtO1xufSIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IG1lO1xuXG52YXIgX3JlZ2VuZXJhdG9yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvcmVnZW5lcmF0b3JcIikpO1xuXG52YXIgX2FzeW5jVG9HZW5lcmF0b3IyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9hc3luY1RvR2VuZXJhdG9yXCIpKTtcblxudmFyIF91c2VyID0gcmVxdWlyZShcIi4vdXNlclwiKTtcblxuZnVuY3Rpb24gbWUoKSB7XG4gIHJldHVybiBfbWUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cblxuZnVuY3Rpb24gX21lKCkge1xuICBfbWUgPSAoMCwgX2FzeW5jVG9HZW5lcmF0b3IyLmRlZmF1bHQpKFxuICAvKiNfX1BVUkVfXyovXG4gIF9yZWdlbmVyYXRvci5kZWZhdWx0Lm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHtcbiAgICB2YXIgYWN0aXZlVXNlcjtcbiAgICByZXR1cm4gX3JlZ2VuZXJhdG9yLmRlZmF1bHQud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkge1xuICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkge1xuICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIGFjdGl2ZVVzZXIgPSAoMCwgX3VzZXIuZ2V0QWN0aXZlVXNlcikoKTtcblxuICAgICAgICAgICAgaWYgKCFhY3RpdmVVc2VyKSB7XG4gICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdChcInJldHVyblwiLCBhY3RpdmVVc2VyLm1lKCkpO1xuXG4gICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdChcInJldHVyblwiLCBudWxsKTtcblxuICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwgX2NhbGxlZSwgdGhpcyk7XG4gIH0pKTtcbiAgcmV0dXJuIF9tZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufSIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMubG9naW5XaXRoUmVkaXJlY3RVcmkgPSBsb2dpbldpdGhSZWRpcmVjdFVyaTtcbmV4cG9ydHMubG9naW5XaXRoVXNlcm5hbWVQYXNzd29yZCA9IGxvZ2luV2l0aFVzZXJuYW1lUGFzc3dvcmQ7XG5leHBvcnRzLklERU5USVRZID0gdm9pZCAwO1xuXG52YXIgX3JlZ2VuZXJhdG9yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvcmVnZW5lcmF0b3JcIikpO1xuXG52YXIgX2FzeW5jVG9HZW5lcmF0b3IyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9hc3luY1RvR2VuZXJhdG9yXCIpKTtcblxudmFyIF9pc1N0cmluZyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcImxvZGFzaC9pc1N0cmluZ1wiKSk7XG5cbnZhciBfdXJsSm9pbiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcInVybC1qb2luXCIpKTtcblxudmFyIF91cmwgPSByZXF1aXJlKFwidXJsXCIpO1xuXG52YXIgX2pzQmFzZSA9IHJlcXVpcmUoXCJqcy1iYXNlNjRcIik7XG5cbnZhciBfY29uZmlnID0gcmVxdWlyZShcIi4uL2tpbnZleS9jb25maWdcIik7XG5cbnZhciBfdXRpbHMgPSByZXF1aXJlKFwiLi4vaHR0cC91dGlsc1wiKTtcblxudmFyIF9yZXF1ZXN0ID0gcmVxdWlyZShcIi4uL2h0dHAvcmVxdWVzdFwiKTtcblxudmFyIF9wb3B1cCA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vcG9wdXBcIikpO1xuXG52YXIgX2tpbnZleSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uL2Vycm9ycy9raW52ZXlcIikpO1xuXG52YXIgSURFTlRJVFkgPSAna2ludmV5QXV0aCc7XG5leHBvcnRzLklERU5USVRZID0gSURFTlRJVFk7XG5cbmZ1bmN0aW9uIGdldFZlcnNpb24oKSB7XG4gIHZhciB2ZXJzaW9uID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiAzO1xuICByZXR1cm4gU3RyaW5nKHZlcnNpb24pLmluZGV4T2YoJ3YnKSA9PT0gMCA/IHZlcnNpb24gOiBcInZcIi5jb25jYXQodmVyc2lvbik7XG59XG5cbmZ1bmN0aW9uIGxvZ2luV2l0aFBvcHVwKGNsaWVudElkLCByZWRpcmVjdFVyaSwgdmVyc2lvbikge1xuICByZXR1cm4gbmV3IFByb21pc2UoXG4gIC8qI19fUFVSRV9fKi9cbiAgZnVuY3Rpb24gKCkge1xuICAgIHZhciBfcmVmID0gKDAsIF9hc3luY1RvR2VuZXJhdG9yMi5kZWZhdWx0KShcbiAgICAvKiNfX1BVUkVfXyovXG4gICAgX3JlZ2VuZXJhdG9yLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgdmFyIF9nZXRDb25maWcsIGF1dGhQcm90b2NvbCwgYXV0aEhvc3QsIHF1ZXJ5LCB1cmwsIHBvcHVwLCByZWRpcmVjdGVkO1xuXG4gICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yLmRlZmF1bHQud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkge1xuICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHtcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgX2dldENvbmZpZyA9ICgwLCBfY29uZmlnLmdldCkoKSwgYXV0aFByb3RvY29sID0gX2dldENvbmZpZy5hdXRoUHJvdG9jb2wsIGF1dGhIb3N0ID0gX2dldENvbmZpZy5hdXRoSG9zdDtcbiAgICAgICAgICAgICAgcXVlcnkgPSB7XG4gICAgICAgICAgICAgICAgY2xpZW50X2lkOiBjbGllbnRJZCxcbiAgICAgICAgICAgICAgICByZWRpcmVjdF91cmk6IHJlZGlyZWN0VXJpLFxuICAgICAgICAgICAgICAgIHJlc3BvbnNlX3R5cGU6ICdjb2RlJyxcbiAgICAgICAgICAgICAgICBzY29wZTogJ29wZW5pZCdcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgdXJsID0gKDAsIF91dGlscy5mb3JtYXRLaW52ZXlVcmwpKGF1dGhQcm90b2NvbCwgYXV0aEhvc3QsICgwLCBfdXJsSm9pbi5kZWZhdWx0KShnZXRWZXJzaW9uKHZlcnNpb24pLCAnL29hdXRoL2F1dGgnKSwgcXVlcnkpO1xuICAgICAgICAgICAgICBwb3B1cCA9ICgwLCBfcG9wdXAuZGVmYXVsdCkodXJsKTtcbiAgICAgICAgICAgICAgcmVkaXJlY3RlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICBwb3B1cC5vbkxvYWRlZChmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LnVybCAmJiBldmVudC51cmwuaW5kZXhPZihyZWRpcmVjdFVyaSkgPT09IDAgJiYgcmVkaXJlY3RlZCA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhcnNlZFVybCA9ICgwLCBfdXJsLnBhcnNlKShldmVudC51cmwsIHRydWUpOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgY2FtZWxjYXNlXG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIF9yZWYyID0gcGFyc2VkVXJsLnF1ZXJ5IHx8IHt9LFxuICAgICAgICAgICAgICAgICAgICAgICAgY29kZSA9IF9yZWYyLmNvZGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvciA9IF9yZWYyLmVycm9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JfZGVzY3JpcHRpb24gPSBfcmVmMi5lcnJvcl9kZXNjcmlwdGlvbjtcblxuICAgICAgICAgICAgICAgICAgICByZWRpcmVjdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgcG9wdXAucmVtb3ZlQWxsTGlzdGVuZXJzKCk7XG4gICAgICAgICAgICAgICAgICAgIHBvcHVwLmNsb3NlKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGNvZGUpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KG5ldyBfa2ludmV5LmRlZmF1bHQoZXJyb3IsIGVycm9yX2Rlc2NyaXB0aW9uKSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KG5ldyBfa2ludmV5LmRlZmF1bHQoJ05vIGNvZGUgb3IgZXJyb3Igd2FzIHByb3ZpZGVkLicpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7Ly8gSnVzdCBjYXRjaCB0aGUgZXJyb3JcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICBwb3B1cC5vbkNsb3NlZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFyZWRpcmVjdGVkKSB7XG4gICAgICAgICAgICAgICAgICBwb3B1cC5yZW1vdmVBbGxMaXN0ZW5lcnMoKTtcbiAgICAgICAgICAgICAgICAgIHJlamVjdChuZXcgX2tpbnZleS5kZWZhdWx0KCdMb2dpbiBoYXMgYmVlbiBjYW5jZWxsZWQuJykpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sIF9jYWxsZWUsIHRoaXMpO1xuICAgIH0pKTtcblxuICAgIHJldHVybiBmdW5jdGlvbiAoX3gsIF94Mikge1xuICAgICAgcmV0dXJuIF9yZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9O1xuICB9KCkpO1xufVxuXG5mdW5jdGlvbiBnZXRUb2tlbldpdGhDb2RlKF94MywgX3g0LCBfeDUpIHtcbiAgcmV0dXJuIF9nZXRUb2tlbldpdGhDb2RlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5cbmZ1bmN0aW9uIF9nZXRUb2tlbldpdGhDb2RlKCkge1xuICBfZ2V0VG9rZW5XaXRoQ29kZSA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gIC8qI19fUFVSRV9fKi9cbiAgX3JlZ2VuZXJhdG9yLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlMihjb2RlLCBjbGllbnRJZCwgcmVkaXJlY3RVcmkpIHtcbiAgICB2YXIgb3B0aW9ucyxcbiAgICAgICAgX2dldENvbmZpZzIsXG4gICAgICAgIGF1dGhQcm90b2NvbCxcbiAgICAgICAgYXV0aEhvc3QsXG4gICAgICAgIHJlcXVlc3QsXG4gICAgICAgIHJlc3BvbnNlLFxuICAgICAgICB0b2tlbixcbiAgICAgICAgX2FyZ3MyID0gYXJndW1lbnRzO1xuXG4gICAgcmV0dXJuIF9yZWdlbmVyYXRvci5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0Mikge1xuICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7XG4gICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgb3B0aW9ucyA9IF9hcmdzMi5sZW5ndGggPiAzICYmIF9hcmdzMlszXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3MyWzNdIDoge307XG4gICAgICAgICAgICBfZ2V0Q29uZmlnMiA9ICgwLCBfY29uZmlnLmdldCkoKSwgYXV0aFByb3RvY29sID0gX2dldENvbmZpZzIuYXV0aFByb3RvY29sLCBhdXRoSG9zdCA9IF9nZXRDb25maWcyLmF1dGhIb3N0O1xuICAgICAgICAgICAgcmVxdWVzdCA9IG5ldyBfcmVxdWVzdC5LaW52ZXlSZXF1ZXN0KHtcbiAgICAgICAgICAgICAgbWV0aG9kOiBfcmVxdWVzdC5SZXF1ZXN0TWV0aG9kLlBPU1QsXG4gICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcsXG4gICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogZnVuY3Rpb24gQXV0aG9yaXphdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgIHZhciBfZ2V0Q29uZmlnMyA9ICgwLCBfY29uZmlnLmdldCkoKSxcbiAgICAgICAgICAgICAgICAgICAgICBhcHBTZWNyZXQgPSBfZ2V0Q29uZmlnMy5hcHBTZWNyZXQ7XG5cbiAgICAgICAgICAgICAgICAgIHZhciBjcmVkZW50aWFscyA9IF9qc0Jhc2UuQmFzZTY0LmVuY29kZShcIlwiLmNvbmNhdChjbGllbnRJZCwgXCI6XCIpLmNvbmNhdChhcHBTZWNyZXQpKTtcblxuICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiQmFzaWMgXCIuY29uY2F0KGNyZWRlbnRpYWxzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHVybDogKDAsIF91dGlscy5mb3JtYXRLaW52ZXlVcmwpKGF1dGhQcm90b2NvbCwgYXV0aEhvc3QsICcvb2F1dGgvdG9rZW4nKSxcbiAgICAgICAgICAgICAgYm9keToge1xuICAgICAgICAgICAgICAgIGdyYW50X3R5cGU6ICdhdXRob3JpemF0aW9uX2NvZGUnLFxuICAgICAgICAgICAgICAgIGNsaWVudF9pZDogY2xpZW50SWQsXG4gICAgICAgICAgICAgICAgcmVkaXJlY3RfdXJpOiByZWRpcmVjdFVyaSxcbiAgICAgICAgICAgICAgICBjb2RlOiBjb2RlXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHRpbWVvdXQ6IG9wdGlvbnMudGltZW91dFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDU7XG4gICAgICAgICAgICByZXR1cm4gcmVxdWVzdC5leGVjdXRlKCk7XG5cbiAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICByZXNwb25zZSA9IF9jb250ZXh0Mi5zZW50O1xuICAgICAgICAgICAgdG9rZW4gPSByZXNwb25zZS5kYXRhO1xuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoXCJyZXR1cm5cIiwgT2JqZWN0LmFzc2lnbih7fSwge1xuICAgICAgICAgICAgICBpZGVudGl0eTogSURFTlRJVFksXG4gICAgICAgICAgICAgIGNsaWVudF9pZDogY2xpZW50SWQsXG4gICAgICAgICAgICAgIHJlZGlyZWN0X3VyaTogcmVkaXJlY3RVcmksXG4gICAgICAgICAgICAgIHByb3RvY29sOiBhdXRoUHJvdG9jb2wsXG4gICAgICAgICAgICAgIGhvc3Q6IGF1dGhIb3N0XG4gICAgICAgICAgICB9LCB0b2tlbikpO1xuXG4gICAgICAgICAgY2FzZSA4OlxuICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwgX2NhbGxlZTIsIHRoaXMpO1xuICB9KSk7XG4gIHJldHVybiBfZ2V0VG9rZW5XaXRoQ29kZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuXG5mdW5jdGlvbiBnZXRUb2tlbldpdGhVc2VybmFtZVBhc3N3b3JkKF94NiwgX3g3LCBfeDgpIHtcbiAgcmV0dXJuIF9nZXRUb2tlbldpdGhVc2VybmFtZVBhc3N3b3JkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5cbmZ1bmN0aW9uIF9nZXRUb2tlbldpdGhVc2VybmFtZVBhc3N3b3JkKCkge1xuICBfZ2V0VG9rZW5XaXRoVXNlcm5hbWVQYXNzd29yZCA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gIC8qI19fUFVSRV9fKi9cbiAgX3JlZ2VuZXJhdG9yLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlMyh1c2VybmFtZSwgcGFzc3dvcmQsIGNsaWVudElkKSB7XG4gICAgdmFyIG9wdGlvbnMsXG4gICAgICAgIF9nZXRDb25maWc0LFxuICAgICAgICBhdXRoUHJvdG9jb2wsXG4gICAgICAgIGF1dGhIb3N0LFxuICAgICAgICByZXF1ZXN0LFxuICAgICAgICByZXNwb25zZSxcbiAgICAgICAgdG9rZW4sXG4gICAgICAgIF9hcmdzMyA9IGFyZ3VtZW50cztcblxuICAgIHJldHVybiBfcmVnZW5lcmF0b3IuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzJChfY29udGV4dDMpIHtcbiAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkge1xuICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIG9wdGlvbnMgPSBfYXJnczMubGVuZ3RoID4gMyAmJiBfYXJnczNbM10gIT09IHVuZGVmaW5lZCA/IF9hcmdzM1szXSA6IHt9O1xuICAgICAgICAgICAgX2dldENvbmZpZzQgPSAoMCwgX2NvbmZpZy5nZXQpKCksIGF1dGhQcm90b2NvbCA9IF9nZXRDb25maWc0LmF1dGhQcm90b2NvbCwgYXV0aEhvc3QgPSBfZ2V0Q29uZmlnNC5hdXRoSG9zdDtcbiAgICAgICAgICAgIHJlcXVlc3QgPSBuZXcgX3JlcXVlc3QuS2ludmV5UmVxdWVzdCh7XG4gICAgICAgICAgICAgIG1ldGhvZDogX3JlcXVlc3QuUmVxdWVzdE1ldGhvZC5QT1NULFxuICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnLFxuICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGZ1bmN0aW9uIEF1dGhvcml6YXRpb24oKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgX2dldENvbmZpZzUgPSAoMCwgX2NvbmZpZy5nZXQpKCksXG4gICAgICAgICAgICAgICAgICAgICAgYXBwU2VjcmV0ID0gX2dldENvbmZpZzUuYXBwU2VjcmV0O1xuXG4gICAgICAgICAgICAgICAgICB2YXIgY3JlZGVudGlhbHMgPSBfanNCYXNlLkJhc2U2NC5lbmNvZGUoXCJcIi5jb25jYXQoY2xpZW50SWQsIFwiOlwiKS5jb25jYXQoYXBwU2VjcmV0KSk7XG5cbiAgICAgICAgICAgICAgICAgIHJldHVybiBcIkJhc2ljIFwiLmNvbmNhdChjcmVkZW50aWFscyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB1cmw6ICgwLCBfdXRpbHMuZm9ybWF0S2ludmV5VXJsKShhdXRoUHJvdG9jb2wsIGF1dGhIb3N0LCAnL29hdXRoL3Rva2VuJyksXG4gICAgICAgICAgICAgIGJvZHk6IHtcbiAgICAgICAgICAgICAgICBncmFudF90eXBlOiAncGFzc3dvcmQnLFxuICAgICAgICAgICAgICAgIHVzZXJuYW1lOiB1c2VybmFtZSxcbiAgICAgICAgICAgICAgICBwYXNzd29yZDogcGFzc3dvcmRcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgdGltZW91dDogb3B0aW9ucy50aW1lb3V0XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gNTtcbiAgICAgICAgICAgIHJldHVybiByZXF1ZXN0LmV4ZWN1dGUoKTtcblxuICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgIHJlc3BvbnNlID0gX2NvbnRleHQzLnNlbnQ7XG4gICAgICAgICAgICB0b2tlbiA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdChcInJldHVyblwiLCBPYmplY3QuYXNzaWduKHt9LCB7XG4gICAgICAgICAgICAgIGlkZW50aXR5OiBJREVOVElUWSxcbiAgICAgICAgICAgICAgY2xpZW50X2lkOiBjbGllbnRJZCxcbiAgICAgICAgICAgICAgcHJvdG9jb2w6IGF1dGhQcm90b2NvbCxcbiAgICAgICAgICAgICAgaG9zdDogYXV0aEhvc3RcbiAgICAgICAgICAgIH0sIHRva2VuKSk7XG5cbiAgICAgICAgICBjYXNlIDg6XG4gICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LCBfY2FsbGVlMywgdGhpcyk7XG4gIH0pKTtcbiAgcmV0dXJuIF9nZXRUb2tlbldpdGhVc2VybmFtZVBhc3N3b3JkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5cbmZ1bmN0aW9uIGxvZ2luV2l0aFJlZGlyZWN0VXJpKF94OSkge1xuICByZXR1cm4gX2xvZ2luV2l0aFJlZGlyZWN0VXJpLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5cbmZ1bmN0aW9uIF9sb2dpbldpdGhSZWRpcmVjdFVyaSgpIHtcbiAgX2xvZ2luV2l0aFJlZGlyZWN0VXJpID0gKDAsIF9hc3luY1RvR2VuZXJhdG9yMi5kZWZhdWx0KShcbiAgLyojX19QVVJFX18qL1xuICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0KHJlZGlyZWN0VXJpKSB7XG4gICAgdmFyIG9wdGlvbnMsXG4gICAgICAgIF9nZXRDb25maWc2LFxuICAgICAgICBhcHBLZXksXG4gICAgICAgIG1pY0lkLFxuICAgICAgICB2ZXJzaW9uLFxuICAgICAgICBjbGllbnRJZCxcbiAgICAgICAgY29kZSxcbiAgICAgICAgdG9rZW4sXG4gICAgICAgIF9hcmdzNCA9IGFyZ3VtZW50cztcblxuICAgIHJldHVybiBfcmVnZW5lcmF0b3IuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWU0JChfY29udGV4dDQpIHtcbiAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgIHN3aXRjaCAoX2NvbnRleHQ0LnByZXYgPSBfY29udGV4dDQubmV4dCkge1xuICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIG9wdGlvbnMgPSBfYXJnczQubGVuZ3RoID4gMSAmJiBfYXJnczRbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmdzNFsxXSA6IHt9O1xuICAgICAgICAgICAgX2dldENvbmZpZzYgPSAoMCwgX2NvbmZpZy5nZXQpKCksIGFwcEtleSA9IF9nZXRDb25maWc2LmFwcEtleTtcbiAgICAgICAgICAgIG1pY0lkID0gb3B0aW9ucy5taWNJZCwgdmVyc2lvbiA9IG9wdGlvbnMudmVyc2lvbjtcbiAgICAgICAgICAgIGNsaWVudElkID0gYXBwS2V5O1xuXG4gICAgICAgICAgICBpZiAoKDAsIF9pc1N0cmluZy5kZWZhdWx0KShyZWRpcmVjdFVyaSkpIHtcbiAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSA2O1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhyb3cgbmV3IF9raW52ZXkuZGVmYXVsdCgnQSByZWRpcmVjdFVyaSBpcyByZXF1aXJlZCBhbmQgbXVzdCBiZSBhIHN0cmluZy4nKTtcblxuICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgIGlmICgoMCwgX2lzU3RyaW5nLmRlZmF1bHQpKG1pY0lkKSkge1xuICAgICAgICAgICAgICBjbGllbnRJZCA9IFwiXCIuY29uY2F0KGNsaWVudElkLCBcIi5cIikuY29uY2F0KG1pY0lkKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSA5O1xuICAgICAgICAgICAgcmV0dXJuIGxvZ2luV2l0aFBvcHVwKGNsaWVudElkLCByZWRpcmVjdFVyaSwgdmVyc2lvbik7XG5cbiAgICAgICAgICBjYXNlIDk6XG4gICAgICAgICAgICBjb2RlID0gX2NvbnRleHQ0LnNlbnQ7XG4gICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDEyO1xuICAgICAgICAgICAgcmV0dXJuIGdldFRva2VuV2l0aENvZGUoY29kZSwgY2xpZW50SWQsIHJlZGlyZWN0VXJpLCBvcHRpb25zKTtcblxuICAgICAgICAgIGNhc2UgMTI6XG4gICAgICAgICAgICB0b2tlbiA9IF9jb250ZXh0NC5zZW50O1xuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5hYnJ1cHQoXCJyZXR1cm5cIiwgdG9rZW4pO1xuXG4gICAgICAgICAgY2FzZSAxNDpcbiAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIF9jYWxsZWU0LCB0aGlzKTtcbiAgfSkpO1xuICByZXR1cm4gX2xvZ2luV2l0aFJlZGlyZWN0VXJpLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5cbmZ1bmN0aW9uIGxvZ2luV2l0aFVzZXJuYW1lUGFzc3dvcmQoX3gxMCwgX3gxMSkge1xuICByZXR1cm4gX2xvZ2luV2l0aFVzZXJuYW1lUGFzc3dvcmQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cblxuZnVuY3Rpb24gX2xvZ2luV2l0aFVzZXJuYW1lUGFzc3dvcmQoKSB7XG4gIF9sb2dpbldpdGhVc2VybmFtZVBhc3N3b3JkID0gKDAsIF9hc3luY1RvR2VuZXJhdG9yMi5kZWZhdWx0KShcbiAgLyojX19QVVJFX18qL1xuICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU1KHVzZXJuYW1lLCBwYXNzd29yZCkge1xuICAgIHZhciBvcHRpb25zLFxuICAgICAgICBfZ2V0Q29uZmlnNyxcbiAgICAgICAgYXBwS2V5LFxuICAgICAgICBtaWNJZCxcbiAgICAgICAgY2xpZW50SWQsXG4gICAgICAgIHRva2VuLFxuICAgICAgICBfYXJnczUgPSBhcmd1bWVudHM7XG5cbiAgICByZXR1cm4gX3JlZ2VuZXJhdG9yLmRlZmF1bHQud3JhcChmdW5jdGlvbiBfY2FsbGVlNSQoX2NvbnRleHQ1KSB7XG4gICAgICB3aGlsZSAoMSkge1xuICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NS5wcmV2ID0gX2NvbnRleHQ1Lm5leHQpIHtcbiAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICBvcHRpb25zID0gX2FyZ3M1Lmxlbmd0aCA+IDIgJiYgX2FyZ3M1WzJdICE9PSB1bmRlZmluZWQgPyBfYXJnczVbMl0gOiB7fTtcbiAgICAgICAgICAgIF9nZXRDb25maWc3ID0gKDAsIF9jb25maWcuZ2V0KSgpLCBhcHBLZXkgPSBfZ2V0Q29uZmlnNy5hcHBLZXk7XG4gICAgICAgICAgICBtaWNJZCA9IG9wdGlvbnMubWljSWQ7XG4gICAgICAgICAgICBjbGllbnRJZCA9IGFwcEtleTtcblxuICAgICAgICAgICAgaWYgKCEoISgwLCBfaXNTdHJpbmcuZGVmYXVsdCkodXNlcm5hbWUpIHx8ICEoMCwgX2lzU3RyaW5nLmRlZmF1bHQpKHBhc3N3b3JkKSkpIHtcbiAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSA2O1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhyb3cgbmV3IF9raW52ZXkuZGVmYXVsdCgnQSB1c2VybmFtZSBhbmQgcGFzc3dvcmQgYXJlIHJlcXVpcmVkIGFuZCBtdXN0IGJlIGEgc3RyaW5nLicpO1xuXG4gICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgaWYgKCgwLCBfaXNTdHJpbmcuZGVmYXVsdCkobWljSWQpKSB7XG4gICAgICAgICAgICAgIGNsaWVudElkID0gXCJcIi5jb25jYXQoY2xpZW50SWQsIFwiLlwiKS5jb25jYXQobWljSWQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDk7XG4gICAgICAgICAgICByZXR1cm4gZ2V0VG9rZW5XaXRoVXNlcm5hbWVQYXNzd29yZCh1c2VybmFtZSwgcGFzc3dvcmQsIGNsaWVudElkLCBvcHRpb25zKTtcblxuICAgICAgICAgIGNhc2UgOTpcbiAgICAgICAgICAgIHRva2VuID0gX2NvbnRleHQ1LnNlbnQ7XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LmFicnVwdChcInJldHVyblwiLCB0b2tlbik7XG5cbiAgICAgICAgICBjYXNlIDExOlxuICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuc3RvcCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwgX2NhbGxlZTUsIHRoaXMpO1xuICB9KSk7XG4gIHJldHVybiBfbG9naW5XaXRoVXNlcm5hbWVQYXNzd29yZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufSIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IG9wZW47XG5cbnZhciBfcmVnZW5lcmF0b3IgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9yZWdlbmVyYXRvclwiKSk7XG5cbnZhciBfYXN5bmNUb0dlbmVyYXRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2FzeW5jVG9HZW5lcmF0b3JcIikpO1xuXG52YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2tcIikpO1xuXG52YXIgX2NyZWF0ZUNsYXNzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3NcIikpO1xuXG52YXIgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuXCIpKTtcblxudmFyIF9nZXRQcm90b3R5cGVPZjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2dldFByb3RvdHlwZU9mXCIpKTtcblxudmFyIF9pbmhlcml0czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2luaGVyaXRzXCIpKTtcblxudmFyIEV2ZW50RW1pdHRlciA9IHJlcXVpcmUoJ2V2ZW50cycpO1xuXG52YXIgTE9BREVEX0VWRU5UID0gJ2xvYWRlZCc7XG52YXIgQ0xPU0VEX0VWRU5UID0gJ2Nsb3NlZCc7XG52YXIgRVJST1JfRVZFTlQgPSAnZXJyb3InO1xuXG52YXIgUG9wdXAgPVxuLyojX19QVVJFX18qL1xuZnVuY3Rpb24gKF9FdmVudEVtaXR0ZXIpIHtcbiAgKDAsIF9pbmhlcml0czIuZGVmYXVsdCkoUG9wdXAsIF9FdmVudEVtaXR0ZXIpO1xuXG4gIGZ1bmN0aW9uIFBvcHVwKHBvcHVwV2luZG93KSB7XG4gICAgdmFyIF90aGlzO1xuXG4gICAgKDAsIF9jbGFzc0NhbGxDaGVjazIuZGVmYXVsdCkodGhpcywgUG9wdXApO1xuICAgIF90aGlzID0gKDAsIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMi5kZWZhdWx0KSh0aGlzLCAoMCwgX2dldFByb3RvdHlwZU9mMi5kZWZhdWx0KShQb3B1cCkuY2FsbCh0aGlzKSk7XG4gICAgX3RoaXMucG9wdXBXaW5kb3cgPSBwb3B1cFdpbmRvdztcbiAgICBfdGhpcy5pbnRlcnZhbCA9IHdpbmRvdy5zZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAocG9wdXBXaW5kb3cuY2xvc2VkKSB7XG4gICAgICAgIF90aGlzLmNsb3NlKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIHZhciBldmVudCA9IHtcbiAgICAgICAgICAgIHVybDogcG9wdXBXaW5kb3cubG9jYXRpb24uaHJlZlxuICAgICAgICAgIH07XG5cbiAgICAgICAgICBfdGhpcy5lbWl0KExPQURFRF9FVkVOVCwgZXZlbnQpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGlmIChlcnJvci5jb2RlICE9PSB3aW5kb3cuRE9NRXhjZXB0aW9uLlNFQ1VSSVRZX0VSUikge1xuICAgICAgICAgICAgX3RoaXMuZW1pdChFUlJPUl9FVkVOVCwgZXJyb3IpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIDEwMCk7XG4gICAgcmV0dXJuIF90aGlzO1xuICB9XG5cbiAgKDAsIF9jcmVhdGVDbGFzczIuZGVmYXVsdCkoUG9wdXAsIFt7XG4gICAga2V5OiBcImlzQ2xvc2VkXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGlzQ2xvc2VkKCkge1xuICAgICAgcmV0dXJuIHRoaXMucG9wdXBXaW5kb3cuY2xvc2VkO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJvbkxvYWRlZFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBvbkxvYWRlZChsaXN0ZW5lcikge1xuICAgICAgcmV0dXJuIHRoaXMub24oTE9BREVEX0VWRU5ULCBsaXN0ZW5lcik7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIm9uQ2xvc2VkXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIG9uQ2xvc2VkKGxpc3RlbmVyKSB7XG4gICAgICByZXR1cm4gdGhpcy5vbihDTE9TRURfRVZFTlQsIGxpc3RlbmVyKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwib25FcnJvclwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBvbkVycm9yKGxpc3RlbmVyKSB7XG4gICAgICByZXR1cm4gdGhpcy5vbihFUlJPUl9FVkVOVCwgbGlzdGVuZXIpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJjbG9zZVwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgX2Nsb3NlID0gKDAsIF9hc3luY1RvR2VuZXJhdG9yMi5kZWZhdWx0KShcbiAgICAgIC8qI19fUFVSRV9fKi9cbiAgICAgIF9yZWdlbmVyYXRvci5kZWZhdWx0Lm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHtcbiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvci5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHtcbiAgICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkge1xuICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW50ZXJ2YWwpIHtcbiAgICAgICAgICAgICAgICAgIHdpbmRvdy5jbGVhckludGVydmFsKHRoaXMuaW50ZXJ2YWwpO1xuICAgICAgICAgICAgICAgICAgdGhpcy5pbnRlcnZhbCA9IG51bGw7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucG9wdXBXaW5kb3cgJiYgIXRoaXMucG9wdXBXaW5kb3cuY2xvc2VkKSB7XG4gICAgICAgICAgICAgICAgICB0aGlzLnBvcHVwV2luZG93LmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICB0aGlzLnBvcHVwV2luZG93ID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLmVtaXQoQ0xPU0VEX0VWRU5UKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KFwicmV0dXJuXCIsIHRoaXMpO1xuXG4gICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LCBfY2FsbGVlLCB0aGlzKTtcbiAgICAgIH0pKTtcblxuICAgICAgZnVuY3Rpb24gY2xvc2UoKSB7XG4gICAgICAgIHJldHVybiBfY2xvc2UuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGNsb3NlO1xuICAgIH0oKVxuICB9XSwgW3tcbiAgICBrZXk6IFwib3BlblwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBvcGVuKHVybCkge1xuICAgICAgdmFyIHBvcHVwV2luZG93ID0gd2luZG93Lm9wZW4odXJsLCAnX2JsYW5rJywgJ3Rvb2xiYXI9bm8sbG9jYXRpb249bm8nKTtcblxuICAgICAgaWYgKCFwb3B1cFdpbmRvdykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBwb3B1cCB3YXMgYmxvY2tlZC4nKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIG5ldyBQb3B1cChwb3B1cFdpbmRvdyk7XG4gICAgfVxuICB9XSk7XG4gIHJldHVybiBQb3B1cDtcbn0oRXZlbnRFbWl0dGVyKTtcblxuZnVuY3Rpb24gb3Blbih1cmwpIHtcbiAgcmV0dXJuIFBvcHVwLm9wZW4odXJsKTtcbn0iLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSByZW1vdmU7XG5cbnZhciBfcmVnZW5lcmF0b3IgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9yZWdlbmVyYXRvclwiKSk7XG5cbnZhciBfYXN5bmNUb0dlbmVyYXRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2FzeW5jVG9HZW5lcmF0b3JcIikpO1xuXG52YXIgX2lzU3RyaW5nID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwibG9kYXNoL2lzU3RyaW5nXCIpKTtcblxudmFyIF9jb25maWcgPSByZXF1aXJlKFwiLi4va2ludmV5L2NvbmZpZ1wiKTtcblxudmFyIF9raW52ZXkgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi9lcnJvcnMva2ludmV5XCIpKTtcblxudmFyIF91dGlscyA9IHJlcXVpcmUoXCIuLi9odHRwL3V0aWxzXCIpO1xuXG52YXIgX3JlcXVlc3QgPSByZXF1aXJlKFwiLi4vaHR0cC9yZXF1ZXN0XCIpO1xuXG52YXIgX2F1dGggPSByZXF1aXJlKFwiLi4vaHR0cC9hdXRoXCIpO1xuXG52YXIgX3VzZXIgPSByZXF1aXJlKFwiLi91c2VyXCIpO1xuXG5mdW5jdGlvbiByZW1vdmUoX3gpIHtcbiAgcmV0dXJuIF9yZW1vdmUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cblxuZnVuY3Rpb24gX3JlbW92ZSgpIHtcbiAgX3JlbW92ZSA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gIC8qI19fUFVSRV9fKi9cbiAgX3JlZ2VuZXJhdG9yLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlKGlkKSB7XG4gICAgdmFyIG9wdGlvbnMsXG4gICAgICAgIF9nZXRDb25maWcsXG4gICAgICAgIGFwaVByb3RvY29sLFxuICAgICAgICBhcGlIb3N0LFxuICAgICAgICBhcHBLZXksXG4gICAgICAgIGhhcmQsXG4gICAgICAgIGFjdGl2ZVVzZXIsXG4gICAgICAgIHVybCxcbiAgICAgICAgcmVxdWVzdCxcbiAgICAgICAgcmVzcG9uc2UsXG4gICAgICAgIF9hcmdzID0gYXJndW1lbnRzO1xuXG4gICAgcmV0dXJuIF9yZWdlbmVyYXRvci5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHtcbiAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHtcbiAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICBvcHRpb25zID0gX2FyZ3MubGVuZ3RoID4gMSAmJiBfYXJnc1sxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3NbMV0gOiB7fTtcbiAgICAgICAgICAgIF9nZXRDb25maWcgPSAoMCwgX2NvbmZpZy5nZXQpKCksIGFwaVByb3RvY29sID0gX2dldENvbmZpZy5hcGlQcm90b2NvbCwgYXBpSG9zdCA9IF9nZXRDb25maWcuYXBpSG9zdCwgYXBwS2V5ID0gX2dldENvbmZpZy5hcHBLZXk7XG4gICAgICAgICAgICBoYXJkID0gb3B0aW9ucy5oYXJkO1xuICAgICAgICAgICAgYWN0aXZlVXNlciA9ICgwLCBfdXNlci5nZXRBY3RpdmVVc2VyKSgpO1xuXG4gICAgICAgICAgICBpZiAoaWQpIHtcbiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDY7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aHJvdyBuZXcgX2tpbnZleS5kZWZhdWx0KCdBbiBpZCB3YXMgbm90IHByb3ZpZGVkLicpO1xuXG4gICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgaWYgKCgwLCBfaXNTdHJpbmcuZGVmYXVsdCkoaWQpKSB7XG4gICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA4O1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhyb3cgbmV3IF9raW52ZXkuZGVmYXVsdCgnVGhlIGlkIHByb3ZpZGVkIGlzIG5vdCBhIHN0cmluZy4nKTtcblxuICAgICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgIC8vIFJlbW92ZSB0aGUgdXNlciBmcm9tIHRoZSBiYWNrZW5kXG4gICAgICAgICAgICB1cmwgPSAoMCwgX3V0aWxzLmZvcm1hdEtpbnZleVVybCkoYXBpUHJvdG9jb2wsIGFwaUhvc3QsIFwiL3VzZXIvXCIuY29uY2F0KGFwcEtleSwgXCIvXCIpLmNvbmNhdChpZCksIHtcbiAgICAgICAgICAgICAgaGFyZDogaGFyZCA/IGhhcmQgPT09IHRydWUgOiB1bmRlZmluZWRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmVxdWVzdCA9IG5ldyBfcmVxdWVzdC5LaW52ZXlSZXF1ZXN0KHtcbiAgICAgICAgICAgICAgbWV0aG9kOiBfcmVxdWVzdC5SZXF1ZXN0TWV0aG9kLkRFTEVURSxcbiAgICAgICAgICAgICAgYXV0aDogX2F1dGguQXV0aC5EZWZhdWx0LFxuICAgICAgICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICAgICAgdGltZW91dDogb3B0aW9ucy50aW1lb3V0XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMjtcbiAgICAgICAgICAgIHJldHVybiByZXF1ZXN0LmV4ZWN1dGUoKTtcblxuICAgICAgICAgIGNhc2UgMTI6XG4gICAgICAgICAgICByZXNwb25zZSA9IF9jb250ZXh0LnNlbnQ7XG5cbiAgICAgICAgICAgIGlmICghKGFjdGl2ZVVzZXIuX2lkID09PSBpZCkpIHtcbiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE2O1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE2O1xuICAgICAgICAgICAgcmV0dXJuIGFjdGl2ZVVzZXIubG9nb3V0KCk7XG5cbiAgICAgICAgICBjYXNlIDE2OlxuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdChcInJldHVyblwiLCByZXNwb25zZS5kYXRhKTtcblxuICAgICAgICAgIGNhc2UgMTc6XG4gICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIF9jYWxsZWUsIHRoaXMpO1xuICB9KSk7XG4gIHJldHVybiBfcmVtb3ZlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gcmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW50ZXJvcFJlcXVpcmVEZWZhdWx0XCIpO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gcmVzZXRQYXNzd29yZDtcblxudmFyIF9yZWdlbmVyYXRvciA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL3JlZ2VuZXJhdG9yXCIpKTtcblxudmFyIF9hc3luY1RvR2VuZXJhdG9yMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvYXN5bmNUb0dlbmVyYXRvclwiKSk7XG5cbnZhciBfaXNTdHJpbmcgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJsb2Rhc2gvaXNTdHJpbmdcIikpO1xuXG52YXIgX2NvbmZpZyA9IHJlcXVpcmUoXCIuLi9raW52ZXkvY29uZmlnXCIpO1xuXG52YXIgX2tpbnZleSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uL2Vycm9ycy9raW52ZXlcIikpO1xuXG52YXIgX3V0aWxzID0gcmVxdWlyZShcIi4uL2h0dHAvdXRpbHNcIik7XG5cbnZhciBfcmVxdWVzdCA9IHJlcXVpcmUoXCIuLi9odHRwL3JlcXVlc3RcIik7XG5cbnZhciBfYXV0aCA9IHJlcXVpcmUoXCIuLi9odHRwL2F1dGhcIik7XG5cbnZhciBSUENfTkFNRVNQQUNFID0gJ3JwYyc7XG5cbmZ1bmN0aW9uIHJlc2V0UGFzc3dvcmQoX3gpIHtcbiAgcmV0dXJuIF9yZXNldFBhc3N3b3JkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5cbmZ1bmN0aW9uIF9yZXNldFBhc3N3b3JkKCkge1xuICBfcmVzZXRQYXNzd29yZCA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gIC8qI19fUFVSRV9fKi9cbiAgX3JlZ2VuZXJhdG9yLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlKHVzZXJuYW1lKSB7XG4gICAgdmFyIG9wdGlvbnMsXG4gICAgICAgIF9nZXRDb25maWcsXG4gICAgICAgIGFwaVByb3RvY29sLFxuICAgICAgICBhcGlIb3N0LFxuICAgICAgICBhcHBLZXksXG4gICAgICAgIHJlcXVlc3QsXG4gICAgICAgIHJlc3BvbnNlLFxuICAgICAgICBfYXJncyA9IGFyZ3VtZW50cztcblxuICAgIHJldHVybiBfcmVnZW5lcmF0b3IuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7XG4gICAgICB3aGlsZSAoMSkge1xuICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7XG4gICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgb3B0aW9ucyA9IF9hcmdzLmxlbmd0aCA+IDEgJiYgX2FyZ3NbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmdzWzFdIDoge307XG4gICAgICAgICAgICBfZ2V0Q29uZmlnID0gKDAsIF9jb25maWcuZ2V0KSgpLCBhcGlQcm90b2NvbCA9IF9nZXRDb25maWcuYXBpUHJvdG9jb2wsIGFwaUhvc3QgPSBfZ2V0Q29uZmlnLmFwaUhvc3QsIGFwcEtleSA9IF9nZXRDb25maWcuYXBwS2V5O1xuXG4gICAgICAgICAgICBpZiAodXNlcm5hbWUpIHtcbiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDQ7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aHJvdyBuZXcgX2tpbnZleS5kZWZhdWx0KCdBIHVzZXJuYW1lIHdhcyBub3QgcHJvdmlkZWQuJyk7XG5cbiAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICBpZiAoKDAsIF9pc1N0cmluZy5kZWZhdWx0KSh1c2VybmFtZSkpIHtcbiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDY7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aHJvdyBuZXcgX2tpbnZleS5kZWZhdWx0KCdUaGUgcHJvdmlkZWQgdXNlcm5hbWUgaXMgbm90IGEgc3RyaW5nLicpO1xuXG4gICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgcmVxdWVzdCA9IG5ldyBfcmVxdWVzdC5LaW52ZXlSZXF1ZXN0KHtcbiAgICAgICAgICAgICAgbWV0aG9kOiBfcmVxdWVzdC5SZXF1ZXN0TWV0aG9kLlBPU1QsXG4gICAgICAgICAgICAgIGF1dGg6IF9hdXRoLkF1dGguQXBwLFxuICAgICAgICAgICAgICB1cmw6ICgwLCBfdXRpbHMuZm9ybWF0S2ludmV5VXJsKShhcGlQcm90b2NvbCwgYXBpSG9zdCwgXCIvXCIuY29uY2F0KFJQQ19OQU1FU1BBQ0UsIFwiL1wiKS5jb25jYXQoYXBwS2V5LCBcIi9cIikuY29uY2F0KHVzZXJuYW1lLCBcIi91c2VyLXBhc3N3b3JkLXJlc2V0LWluaXRpYXRlXCIpKSxcbiAgICAgICAgICAgICAgdGltZW91dDogb3B0aW9ucy50aW1lb3V0XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA5O1xuICAgICAgICAgICAgcmV0dXJuIHJlcXVlc3QuZXhlY3V0ZSgpO1xuXG4gICAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgcmVzcG9uc2UgPSBfY29udGV4dC5zZW50O1xuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdChcInJldHVyblwiLCByZXNwb25zZS5kYXRhKTtcblxuICAgICAgICAgIGNhc2UgMTE6XG4gICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIF9jYWxsZWUsIHRoaXMpO1xuICB9KSk7XG4gIHJldHVybiBfcmVzZXRQYXNzd29yZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufSIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IHJlc3RvcmU7XG5cbnZhciBfcmVnZW5lcmF0b3IgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9yZWdlbmVyYXRvclwiKSk7XG5cbnZhciBfYXN5bmNUb0dlbmVyYXRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2FzeW5jVG9HZW5lcmF0b3JcIikpO1xuXG52YXIgX2tpbnZleSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uL2Vycm9ycy9raW52ZXlcIikpO1xuXG5mdW5jdGlvbiByZXN0b3JlKCkge1xuICByZXR1cm4gX3Jlc3RvcmUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cblxuZnVuY3Rpb24gX3Jlc3RvcmUoKSB7XG4gIF9yZXN0b3JlID0gKDAsIF9hc3luY1RvR2VuZXJhdG9yMi5kZWZhdWx0KShcbiAgLyojX19QVVJFX18qL1xuICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7XG4gICAgcmV0dXJuIF9yZWdlbmVyYXRvci5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHtcbiAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHtcbiAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICB0aHJvdyBuZXcgX2tpbnZleS5kZWZhdWx0KCdUaGlzIGZ1bmN0aW9uIHJlcXVpcmVzIGEgbWFzdGVyIHNlY3JldCB0byBiZSBwcm92aWRlZCBmb3IgeW91ciBhcHBsaWNhdGlvbi4gV2Ugc3Ryb25nbHkgYWR2aXNlIG5vdCB0byBkbyB0aGlzLicpO1xuXG4gICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LCBfY2FsbGVlLCB0aGlzKTtcbiAgfSkpO1xuICByZXR1cm4gX3Jlc3RvcmUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn0iLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLnNpZ251cCA9IHNpZ251cDtcbmV4cG9ydHMuc2lnbnVwV2l0aElkZW50aXR5ID0gc2lnbnVwV2l0aElkZW50aXR5O1xuXG52YXIgX3JlZ2VuZXJhdG9yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvcmVnZW5lcmF0b3JcIikpO1xuXG52YXIgX2FzeW5jVG9HZW5lcmF0b3IyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9hc3luY1RvR2VuZXJhdG9yXCIpKTtcblxudmFyIF9pc0VtcHR5ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwibG9kYXNoL2lzRW1wdHlcIikpO1xuXG52YXIgX2NvbmZpZyA9IHJlcXVpcmUoXCIuLi9raW52ZXkvY29uZmlnXCIpO1xuXG52YXIgX2FjdGl2ZVVzZXIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi9lcnJvcnMvYWN0aXZlVXNlclwiKSk7XG5cbnZhciBfa2ludmV5ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vZXJyb3JzL2tpbnZleVwiKSk7XG5cbnZhciBfdXRpbHMgPSByZXF1aXJlKFwiLi4vaHR0cC91dGlsc1wiKTtcblxudmFyIF9yZXF1ZXN0ID0gcmVxdWlyZShcIi4uL2h0dHAvcmVxdWVzdFwiKTtcblxudmFyIF9hdXRoID0gcmVxdWlyZShcIi4uL2h0dHAvYXV0aFwiKTtcblxudmFyIF9zZXNzaW9uID0gcmVxdWlyZShcIi4uL3Nlc3Npb25cIik7XG5cbnZhciBfdXNlciA9IHJlcXVpcmUoXCIuL3VzZXJcIik7XG5cbnZhciBVU0VSX05BTUVTUEFDRSA9ICd1c2VyJztcblxuZnVuY3Rpb24gc2lnbnVwKF94KSB7XG4gIHJldHVybiBfc2lnbnVwLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5cbmZ1bmN0aW9uIF9zaWdudXAoKSB7XG4gIF9zaWdudXAgPSAoMCwgX2FzeW5jVG9HZW5lcmF0b3IyLmRlZmF1bHQpKFxuICAvKiNfX1BVUkVfXyovXG4gIF9yZWdlbmVyYXRvci5kZWZhdWx0Lm1hcmsoZnVuY3Rpb24gX2NhbGxlZShkYXRhKSB7XG4gICAgdmFyIG9wdGlvbnMsXG4gICAgICAgIF9nZXRDb25maWcsXG4gICAgICAgIGFwaVByb3RvY29sLFxuICAgICAgICBhcGlIb3N0LFxuICAgICAgICBhcHBLZXksXG4gICAgICAgIGFjdGl2ZVVzZXIsXG4gICAgICAgIF9vcHRpb25zJHN0YXRlLFxuICAgICAgICBzdGF0ZSxcbiAgICAgICAgdXJsLFxuICAgICAgICByZXF1ZXN0LFxuICAgICAgICByZXNwb25zZSxcbiAgICAgICAgc2Vzc2lvbixcbiAgICAgICAgX2FyZ3MgPSBhcmd1bWVudHM7XG5cbiAgICByZXR1cm4gX3JlZ2VuZXJhdG9yLmRlZmF1bHQud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkge1xuICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkge1xuICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIG9wdGlvbnMgPSBfYXJncy5sZW5ndGggPiAxICYmIF9hcmdzWzFdICE9PSB1bmRlZmluZWQgPyBfYXJnc1sxXSA6IHt9O1xuICAgICAgICAgICAgX2dldENvbmZpZyA9ICgwLCBfY29uZmlnLmdldCkoKSwgYXBpUHJvdG9jb2wgPSBfZ2V0Q29uZmlnLmFwaVByb3RvY29sLCBhcGlIb3N0ID0gX2dldENvbmZpZy5hcGlIb3N0LCBhcHBLZXkgPSBfZ2V0Q29uZmlnLmFwcEtleTtcbiAgICAgICAgICAgIGFjdGl2ZVVzZXIgPSAoMCwgX3VzZXIuZ2V0QWN0aXZlVXNlcikoKTtcbiAgICAgICAgICAgIF9vcHRpb25zJHN0YXRlID0gb3B0aW9ucy5zdGF0ZSwgc3RhdGUgPSBfb3B0aW9ucyRzdGF0ZSA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9vcHRpb25zJHN0YXRlO1xuXG4gICAgICAgICAgICBpZiAoIShzdGF0ZSA9PT0gdHJ1ZSAmJiBhY3RpdmVVc2VyKSkge1xuICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNjtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRocm93IG5ldyBfYWN0aXZlVXNlci5kZWZhdWx0KCdBbiBhY3RpdmUgdXNlciBhbHJlYWR5IGV4aXN0cy4gUGxlYXNlIGxvZ291dCB0aGUgYWN0aXZlIHVzZXIgYmVmb3JlIHlvdSBzaWdudXAuJyk7XG5cbiAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICB1cmwgPSAoMCwgX3V0aWxzLmZvcm1hdEtpbnZleVVybCkoYXBpUHJvdG9jb2wsIGFwaUhvc3QsIFwiL1wiLmNvbmNhdChVU0VSX05BTUVTUEFDRSwgXCIvXCIpLmNvbmNhdChhcHBLZXkpKTtcbiAgICAgICAgICAgIHJlcXVlc3QgPSBuZXcgX3JlcXVlc3QuS2ludmV5UmVxdWVzdCh7XG4gICAgICAgICAgICAgIG1ldGhvZDogX3JlcXVlc3QuUmVxdWVzdE1ldGhvZC5QT1NULFxuICAgICAgICAgICAgICBhdXRoOiBfYXV0aC5BdXRoLkFwcCxcbiAgICAgICAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgICAgICAgIHRpbWVvdXQ6IG9wdGlvbnMudGltZW91dFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmIChkYXRhIGluc3RhbmNlb2YgX3VzZXIuVXNlcikge1xuICAgICAgICAgICAgICByZXF1ZXN0LmJvZHkgPSAoMCwgX2lzRW1wdHkuZGVmYXVsdCkoZGF0YS5kYXRhKSA/IG51bGwgOiBkYXRhLmRhdGE7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICByZXF1ZXN0LmJvZHkgPSAoMCwgX2lzRW1wdHkuZGVmYXVsdCkoZGF0YSkgPyBudWxsIDogZGF0YTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDExO1xuICAgICAgICAgICAgcmV0dXJuIHJlcXVlc3QuZXhlY3V0ZSgpO1xuXG4gICAgICAgICAgY2FzZSAxMTpcbiAgICAgICAgICAgIHJlc3BvbnNlID0gX2NvbnRleHQuc2VudDtcbiAgICAgICAgICAgIHNlc3Npb24gPSByZXNwb25zZS5kYXRhO1xuXG4gICAgICAgICAgICBpZiAoc3RhdGUgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgKDAsIF9zZXNzaW9uLnNldCkoc2Vzc2lvbik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoXCJyZXR1cm5cIiwgbmV3IF91c2VyLlVzZXIoc2Vzc2lvbikpO1xuXG4gICAgICAgICAgY2FzZSAxNTpcbiAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwgX2NhbGxlZSwgdGhpcyk7XG4gIH0pKTtcbiAgcmV0dXJuIF9zaWdudXAuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cblxuZnVuY3Rpb24gc2lnbnVwV2l0aElkZW50aXR5KCkge1xuICByZXR1cm4gX3NpZ251cFdpdGhJZGVudGl0eS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufVxuXG5mdW5jdGlvbiBfc2lnbnVwV2l0aElkZW50aXR5KCkge1xuICBfc2lnbnVwV2l0aElkZW50aXR5ID0gKDAsIF9hc3luY1RvR2VuZXJhdG9yMi5kZWZhdWx0KShcbiAgLyojX19QVVJFX18qL1xuICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkge1xuICAgIHJldHVybiBfcmVnZW5lcmF0b3IuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHtcbiAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkge1xuICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIHRocm93IG5ldyBfa2ludmV5LmRlZmF1bHQoJ1RoaXMgZnVuY3Rpb24gaGFzIGJlZW4gZGVwcmVjYXRlZC4gWW91IHNob3VsZCB1c2UgTUlDIHRvIGxvZ2luIGluc3RlYWQuJyk7XG5cbiAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LCBfY2FsbGVlMiwgdGhpcyk7XG4gIH0pKTtcbiAgcmV0dXJuIF9zaWdudXBXaXRoSWRlbnRpdHkuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn0iLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSB1cGRhdGU7XG5cbnZhciBfcmVnZW5lcmF0b3IgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9yZWdlbmVyYXRvclwiKSk7XG5cbnZhciBfYXN5bmNUb0dlbmVyYXRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2FzeW5jVG9HZW5lcmF0b3JcIikpO1xuXG52YXIgX3VzZXIgPSByZXF1aXJlKFwiLi91c2VyXCIpO1xuXG5mdW5jdGlvbiB1cGRhdGUoX3gpIHtcbiAgcmV0dXJuIF91cGRhdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cblxuZnVuY3Rpb24gX3VwZGF0ZSgpIHtcbiAgX3VwZGF0ZSA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gIC8qI19fUFVSRV9fKi9cbiAgX3JlZ2VuZXJhdG9yLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlKGRhdGEpIHtcbiAgICB2YXIgYWN0aXZlVXNlcjtcbiAgICByZXR1cm4gX3JlZ2VuZXJhdG9yLmRlZmF1bHQud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkge1xuICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkge1xuICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIGFjdGl2ZVVzZXIgPSAoMCwgX3VzZXIuZ2V0QWN0aXZlVXNlcikoKTtcblxuICAgICAgICAgICAgaWYgKCFhY3RpdmVVc2VyKSB7XG4gICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdChcInJldHVyblwiLCBhY3RpdmVVc2VyLnVwZGF0ZShkYXRhKSk7XG5cbiAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KFwicmV0dXJuXCIsIG51bGwpO1xuXG4gICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LCBfY2FsbGVlLCB0aGlzKTtcbiAgfSkpO1xuICByZXR1cm4gX3VwZGF0ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xufSIsIlwidXNlIHN0cmljdFwiO1xuXG52YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZ2V0QWN0aXZlVXNlciA9IGdldEFjdGl2ZVVzZXI7XG5leHBvcnRzLlVzZXIgPSB2b2lkIDA7XG5cbnZhciBfcmVnZW5lcmF0b3IgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9yZWdlbmVyYXRvclwiKSk7XG5cbnZhciBfYXN5bmNUb0dlbmVyYXRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2FzeW5jVG9HZW5lcmF0b3JcIikpO1xuXG52YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2tcIikpO1xuXG52YXIgX2NyZWF0ZUNsYXNzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3NcIikpO1xuXG52YXIgX2lzQXJyYXkgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJsb2Rhc2gvaXNBcnJheVwiKSk7XG5cbnZhciBfYWNsID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vYWNsXCIpKTtcblxudmFyIF9rbWQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi9rbWRcIikpO1xuXG52YXIgX3Nlc3Npb24gPSByZXF1aXJlKFwiLi4vc2Vzc2lvblwiKTtcblxudmFyIF91dGlscyA9IHJlcXVpcmUoXCIuLi9odHRwL3V0aWxzXCIpO1xuXG52YXIgX3JlcXVlc3QgPSByZXF1aXJlKFwiLi4vaHR0cC9yZXF1ZXN0XCIpO1xuXG52YXIgX2F1dGggPSByZXF1aXJlKFwiLi4vaHR0cC9hdXRoXCIpO1xuXG52YXIgX2NvbmZpZyA9IHJlcXVpcmUoXCIuLi9raW52ZXkvY29uZmlnXCIpO1xuXG52YXIgX2RldmljZSA9IHJlcXVpcmUoXCIuLi9raW52ZXkvZGV2aWNlXCIpO1xuXG52YXIgX2tpbnZleSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uL2Vycm9ycy9raW52ZXlcIikpO1xuXG52YXIgX2RhdGFzdG9yZSA9IHJlcXVpcmUoXCIuLi9kYXRhc3RvcmVcIik7XG5cbnZhciBfdXRpbHMyID0gcmVxdWlyZShcIi4vdXRpbHNcIik7XG5cbnZhciBVU0VSX05BTUVTUEFDRSA9ICd1c2VyJztcblxudmFyIFVzZXIgPVxuLyojX19QVVJFX18qL1xuZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBVc2VyKCkge1xuICAgIHZhciBkYXRhID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTtcbiAgICAoMCwgX2NsYXNzQ2FsbENoZWNrMi5kZWZhdWx0KSh0aGlzLCBVc2VyKTtcbiAgICB0aGlzLmRhdGEgPSBkYXRhO1xuICB9XG5cbiAgKDAsIF9jcmVhdGVDbGFzczIuZGVmYXVsdCkoVXNlciwgW3tcbiAgICBrZXk6IFwiaXNBY3RpdmVcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gaXNBY3RpdmUoKSB7XG4gICAgICB2YXIgYWN0aXZlVXNlciA9ICgwLCBfc2Vzc2lvbi5nZXQpKCk7XG5cbiAgICAgIGlmIChhY3RpdmVVc2VyICYmIGFjdGl2ZVVzZXIuX2lkID09PSB0aGlzLl9pZCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJpc0VtYWlsVmVyaWZpZWRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gaXNFbWFpbFZlcmlmaWVkKCkge1xuICAgICAgdmFyIG1ldGFkYXRhID0gdGhpcy5tZXRhZGF0YTtcblxuICAgICAgaWYgKG1ldGFkYXRhKSB7XG4gICAgICAgIHZhciBzdGF0dXMgPSBtZXRhZGF0YS5lbWFpbFZlcmlmaWNhdGlvbjtcbiAgICAgICAgcmV0dXJuIHN0YXR1cyA9PT0gJ2NvbmZpcm1lZCc7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwibWVcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIF9tZSA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gICAgICAvKiNfX1BVUkVfXyovXG4gICAgICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7XG4gICAgICAgIHZhciBvcHRpb25zLFxuICAgICAgICAgICAgX2dldENvbmZpZyxcbiAgICAgICAgICAgIGFwaVByb3RvY29sLFxuICAgICAgICAgICAgYXBpSG9zdCxcbiAgICAgICAgICAgIGFwcEtleSxcbiAgICAgICAgICAgIHJlcXVlc3QsXG4gICAgICAgICAgICByZXNwb25zZSxcbiAgICAgICAgICAgIGRhdGEsXG4gICAgICAgICAgICBfYXJncyA9IGFyZ3VtZW50cztcblxuICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yLmRlZmF1bHQud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkge1xuICAgICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7XG4gICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICBvcHRpb25zID0gX2FyZ3MubGVuZ3RoID4gMCAmJiBfYXJnc1swXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3NbMF0gOiB7fTtcbiAgICAgICAgICAgICAgICBfZ2V0Q29uZmlnID0gKDAsIF9jb25maWcuZ2V0KSgpLCBhcGlQcm90b2NvbCA9IF9nZXRDb25maWcuYXBpUHJvdG9jb2wsIGFwaUhvc3QgPSBfZ2V0Q29uZmlnLmFwaUhvc3QsIGFwcEtleSA9IF9nZXRDb25maWcuYXBwS2V5O1xuICAgICAgICAgICAgICAgIHJlcXVlc3QgPSBuZXcgX3JlcXVlc3QuS2ludmV5UmVxdWVzdCh7XG4gICAgICAgICAgICAgICAgICBtZXRob2Q6IF9yZXF1ZXN0LlJlcXVlc3RNZXRob2QuR0VULFxuICAgICAgICAgICAgICAgICAgYXV0aDogX2F1dGguQXV0aC5TZXNzaW9uLFxuICAgICAgICAgICAgICAgICAgdXJsOiAoMCwgX3V0aWxzLmZvcm1hdEtpbnZleVVybCkoYXBpUHJvdG9jb2wsIGFwaUhvc3QsIFwiL1wiLmNvbmNhdChVU0VSX05BTUVTUEFDRSwgXCIvXCIpLmNvbmNhdChhcHBLZXksIFwiL19tZVwiKSksXG4gICAgICAgICAgICAgICAgICB0aW1lb3V0OiBvcHRpb25zLnRpbWVvdXRcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNTtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVxdWVzdC5leGVjdXRlKCk7XG5cbiAgICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gX2NvbnRleHQuc2VudDtcbiAgICAgICAgICAgICAgICBkYXRhID0gcmVzcG9uc2UuZGF0YTsgLy8gUmVtb3ZlIHNlbnNpdGl2ZSBkYXRhXG5cbiAgICAgICAgICAgICAgICBkZWxldGUgZGF0YS5wYXNzd29yZDsgLy8gTWVyZ2UgX3NvY2lhbElkZW50aXR5XG5cbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5fc29jaWFsSWRlbnRpdHkpIHtcbiAgICAgICAgICAgICAgICAgIGRhdGEuX3NvY2lhbElkZW50aXR5ID0gKDAsIF91dGlsczIubWVyZ2VTb2NpYWxJZGVudGl0eSkodGhpcy5fc29jaWFsSWRlbnRpdHksIGRhdGEuX3NvY2lhbElkZW50aXR5KTtcbiAgICAgICAgICAgICAgICB9IC8vIFVwZGF0ZSB0aGUgYWN0aXZlIHNlc3Npb25cblxuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNBY3RpdmUoKSkge1xuICAgICAgICAgICAgICAgICAgKDAsIF9zZXNzaW9uLnNldCkoZGF0YSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhID0gZGF0YTtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KFwicmV0dXJuXCIsIHRoaXMpO1xuXG4gICAgICAgICAgICAgIGNhc2UgMTI6XG4gICAgICAgICAgICAgIGNhc2UgXCJlbmRcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSwgX2NhbGxlZSwgdGhpcyk7XG4gICAgICB9KSk7XG5cbiAgICAgIGZ1bmN0aW9uIG1lKCkge1xuICAgICAgICByZXR1cm4gX21lLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBtZTtcbiAgICB9KClcbiAgfSwge1xuICAgIGtleTogXCJ1cGRhdGVcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIF91cGRhdGUgPSAoMCwgX2FzeW5jVG9HZW5lcmF0b3IyLmRlZmF1bHQpKFxuICAgICAgLyojX19QVVJFX18qL1xuICAgICAgX3JlZ2VuZXJhdG9yLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlMihkYXRhKSB7XG4gICAgICAgIHZhciBvcHRpb25zLFxuICAgICAgICAgICAgX2dldENvbmZpZzIsXG4gICAgICAgICAgICBhcGlQcm90b2NvbCxcbiAgICAgICAgICAgIGFwaUhvc3QsXG4gICAgICAgICAgICBhcHBLZXksXG4gICAgICAgICAgICBib2R5LFxuICAgICAgICAgICAgcmVxdWVzdCxcbiAgICAgICAgICAgIHJlc3BvbnNlLFxuICAgICAgICAgICAgdXBkYXRlZERhdGEsXG4gICAgICAgICAgICBfYXJnczIgPSBhcmd1bWVudHM7XG5cbiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvci5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0Mikge1xuICAgICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHtcbiAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgIG9wdGlvbnMgPSBfYXJnczIubGVuZ3RoID4gMSAmJiBfYXJnczJbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmdzMlsxXSA6IHt9O1xuICAgICAgICAgICAgICAgIF9nZXRDb25maWcyID0gKDAsIF9jb25maWcuZ2V0KSgpLCBhcGlQcm90b2NvbCA9IF9nZXRDb25maWcyLmFwaVByb3RvY29sLCBhcGlIb3N0ID0gX2dldENvbmZpZzIuYXBpSG9zdCwgYXBwS2V5ID0gX2dldENvbmZpZzIuYXBwS2V5O1xuICAgICAgICAgICAgICAgIGJvZHkgPSBPYmplY3QuYXNzaWduKHt9LCB0aGlzLmRhdGEsIGRhdGEpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNTtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBfa2ludmV5LmRlZmF1bHQoJ05vIHVzZXIgd2FzIHByb3ZpZGVkIHRvIGJlIHVwZGF0ZWQuJyk7XG5cbiAgICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgIGlmICghKDAsIF9pc0FycmF5LmRlZmF1bHQpKGRhdGEpKSB7XG4gICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDc7XG4gICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX2tpbnZleS5kZWZhdWx0KCdPbmx5IG9uZSB1c2VyIGNhbiBiZSB1cGRhdGVkIGF0IG9uZSB0aW1lLicpO1xuXG4gICAgICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgICAgICBpZiAoYm9keS5faWQpIHtcbiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gOTtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBfa2ludmV5LmRlZmF1bHQoJ1VzZXIgbXVzdCBoYXZlIGFuIF9pZC4nKTtcblxuICAgICAgICAgICAgICBjYXNlIDk6XG4gICAgICAgICAgICAgICAgcmVxdWVzdCA9IG5ldyBfcmVxdWVzdC5LaW52ZXlSZXF1ZXN0KHtcbiAgICAgICAgICAgICAgICAgIG1ldGhvZDogX3JlcXVlc3QuUmVxdWVzdE1ldGhvZC5QVVQsXG4gICAgICAgICAgICAgICAgICBhdXRoOiBfYXV0aC5BdXRoLkRlZmF1bHQsXG4gICAgICAgICAgICAgICAgICB1cmw6ICgwLCBfdXRpbHMuZm9ybWF0S2ludmV5VXJsKShhcGlQcm90b2NvbCwgYXBpSG9zdCwgXCIvXCIuY29uY2F0KFVTRVJfTkFNRVNQQUNFLCBcIi9cIikuY29uY2F0KGFwcEtleSwgXCIvXCIpLmNvbmNhdCh0aGlzLl9pZCkpLFxuICAgICAgICAgICAgICAgICAgYm9keTogYm9keSxcbiAgICAgICAgICAgICAgICAgIHRpbWVvdXQ6IG9wdGlvbnMudGltZW91dFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTI7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcXVlc3QuZXhlY3V0ZSgpO1xuXG4gICAgICAgICAgICAgIGNhc2UgMTI6XG4gICAgICAgICAgICAgICAgcmVzcG9uc2UgPSBfY29udGV4dDIuc2VudDtcbiAgICAgICAgICAgICAgICB1cGRhdGVkRGF0YSA9IHJlc3BvbnNlLmRhdGE7IC8vIFJlbW92ZSBzZW5zaXRpdmUgZGF0YVxuXG4gICAgICAgICAgICAgICAgZGVsZXRlIHVwZGF0ZWREYXRhLnBhc3N3b3JkOyAvLyBNZXJnZSBfc29jaWFsSWRlbnRpdHlcblxuICAgICAgICAgICAgICAgIGlmICh1cGRhdGVkRGF0YS5fc29jaWFsSWRlbnRpdHkpIHtcbiAgICAgICAgICAgICAgICAgIHVwZGF0ZWREYXRhLl9zb2NpYWxJZGVudGl0eSA9ICgwLCBfdXRpbHMyLm1lcmdlU29jaWFsSWRlbnRpdHkpKHRoaXMuX3NvY2lhbElkZW50aXR5LCB1cGRhdGVkRGF0YS5fc29jaWFsSWRlbnRpdHkpO1xuICAgICAgICAgICAgICAgIH0gLy8gVXBkYXRlIHRoZSBhY3RpdmUgc2Vzc2lvblxuXG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc0FjdGl2ZSgpKSB7XG4gICAgICAgICAgICAgICAgICAoMCwgX3Nlc3Npb24uc2V0KSh1cGRhdGVkRGF0YSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhID0gdXBkYXRlZERhdGE7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoXCJyZXR1cm5cIiwgdGhpcyk7XG5cbiAgICAgICAgICAgICAgY2FzZSAxOTpcbiAgICAgICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSwgX2NhbGxlZTIsIHRoaXMpO1xuICAgICAgfSkpO1xuXG4gICAgICBmdW5jdGlvbiB1cGRhdGUoX3gpIHtcbiAgICAgICAgcmV0dXJuIF91cGRhdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHVwZGF0ZTtcbiAgICB9KClcbiAgfSwge1xuICAgIGtleTogXCJyZWdpc3RlckZvckxpdmVTZXJ2aWNlXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBfcmVnaXN0ZXJGb3JMaXZlU2VydmljZSA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gICAgICAvKiNfX1BVUkVfXyovXG4gICAgICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKCkge1xuICAgICAgICB2YXIgX2dldENvbmZpZzMsIGFwaVByb3RvY29sLCBhcGlIb3N0LCBhcHBLZXksIGRldmljZUlkLCByZXF1ZXN0LCByZXNwb25zZSwgY29uZmlnO1xuXG4gICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3IuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzJChfY29udGV4dDMpIHtcbiAgICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7XG4gICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICBpZiAoTGl2ZS5pc1JlZ2lzdGVyZWQoKSkge1xuICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA5O1xuICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgX2dldENvbmZpZzMgPSAoMCwgX2NvbmZpZy5nZXQpKCksIGFwaVByb3RvY29sID0gX2dldENvbmZpZzMuYXBpUHJvdG9jb2wsIGFwaUhvc3QgPSBfZ2V0Q29uZmlnMy5hcGlIb3N0LCBhcHBLZXkgPSBfZ2V0Q29uZmlnMy5hcHBLZXk7XG4gICAgICAgICAgICAgICAgZGV2aWNlSWQgPSAoMCwgX2RldmljZS5nZXRJZCkoKTtcbiAgICAgICAgICAgICAgICByZXF1ZXN0ID0gbmV3IF9yZXF1ZXN0LktpbnZleVJlcXVlc3Qoe1xuICAgICAgICAgICAgICAgICAgbWV0aG9kOiBfcmVxdWVzdC5SZXF1ZXN0TWV0aG9kLlBPU1QsXG4gICAgICAgICAgICAgICAgICBhdXRoOiBfYXV0aC5BdXRoLlNlc3Npb24sXG4gICAgICAgICAgICAgICAgICB1cmw6ICgwLCBfdXRpbHMuZm9ybWF0S2ludmV5VXJsKShhcGlQcm90b2NvbCwgYXBpSG9zdCwgXCIvXCIuY29uY2F0KFVTRVJfTkFNRVNQQUNFLCBcIi9cIikuY29uY2F0KGFwcEtleSwgXCIvXCIpLmNvbmNhdCh0aGlzLl9pZCwgXCIvcmVnaXN0ZXItcmVhbHRpbWVcIikpLFxuICAgICAgICAgICAgICAgICAgYm9keToge1xuICAgICAgICAgICAgICAgICAgICBkZXZpY2VJZDogZGV2aWNlSWRcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDY7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcXVlc3QuZXhlY3V0ZSgpO1xuXG4gICAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgICAgICByZXNwb25zZSA9IF9jb250ZXh0My5zZW50O1xuICAgICAgICAgICAgICAgIGNvbmZpZyA9IE9iamVjdC5hc3NpZ24oe30sIHtcbiAgICAgICAgICAgICAgICAgIHNzbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgIGF1dGhLZXk6IHRoaXMuYXV0aHRva2VuXG4gICAgICAgICAgICAgICAgfSwgcmVzcG9uc2UuZGF0YSk7XG4gICAgICAgICAgICAgICAgTGl2ZS5yZWdpc3Rlcihjb25maWcpO1xuXG4gICAgICAgICAgICAgIGNhc2UgOTpcbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdChcInJldHVyblwiLCB0cnVlKTtcblxuICAgICAgICAgICAgICBjYXNlIDEwOlxuICAgICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LCBfY2FsbGVlMywgdGhpcyk7XG4gICAgICB9KSk7XG5cbiAgICAgIGZ1bmN0aW9uIHJlZ2lzdGVyRm9yTGl2ZVNlcnZpY2UoKSB7XG4gICAgICAgIHJldHVybiBfcmVnaXN0ZXJGb3JMaXZlU2VydmljZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gcmVnaXN0ZXJGb3JMaXZlU2VydmljZTtcbiAgICB9KClcbiAgfSwge1xuICAgIGtleTogXCJ1bnJlZ2lzdGVyRnJvbUxpdmVTZXJ2aWNlXCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBfdW5yZWdpc3RlckZyb21MaXZlU2VydmljZSA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoXG4gICAgICAvKiNfX1BVUkVfXyovXG4gICAgICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0KCkge1xuICAgICAgICB2YXIgX2dldENvbmZpZzQsIGFwaVByb3RvY29sLCBhcGlIb3N0LCBhcHBLZXksIGRldmljZUlkLCByZXF1ZXN0O1xuXG4gICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3IuZGVmYXVsdC53cmFwKGZ1bmN0aW9uIF9jYWxsZWU0JChfY29udGV4dDQpIHtcbiAgICAgICAgICB3aGlsZSAoMSkge1xuICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDQucHJldiA9IF9jb250ZXh0NC5uZXh0KSB7XG4gICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICBpZiAoIUxpdmUuaXNSZWdpc3RlcmVkKCkpIHtcbiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gNztcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIF9nZXRDb25maWc0ID0gKDAsIF9jb25maWcuZ2V0KSgpLCBhcGlQcm90b2NvbCA9IF9nZXRDb25maWc0LmFwaVByb3RvY29sLCBhcGlIb3N0ID0gX2dldENvbmZpZzQuYXBpSG9zdCwgYXBwS2V5ID0gX2dldENvbmZpZzQuYXBwS2V5O1xuICAgICAgICAgICAgICAgIGRldmljZUlkID0gKDAsIF9kZXZpY2UuZ2V0SWQpKCk7XG4gICAgICAgICAgICAgICAgcmVxdWVzdCA9IG5ldyBfcmVxdWVzdC5LaW52ZXlSZXF1ZXN0KHtcbiAgICAgICAgICAgICAgICAgIG1ldGhvZDogX3JlcXVlc3QuUmVxdWVzdE1ldGhvZC5QT1NULFxuICAgICAgICAgICAgICAgICAgYXV0aDogX2F1dGguQXV0aC5TZXNzaW9uLFxuICAgICAgICAgICAgICAgICAgdXJsOiAoMCwgX3V0aWxzLmZvcm1hdEtpbnZleVVybCkoYXBpUHJvdG9jb2wsIGFwaUhvc3QsIFwiL1wiLmNvbmNhdChVU0VSX05BTUVTUEFDRSwgXCIvXCIpLmNvbmNhdChhcHBLZXksIFwiL1wiKS5jb25jYXQodGhpcy5faWQsIFwiL3VucmVnaXN0ZXItcmVhbHRpbWVcIikpLFxuICAgICAgICAgICAgICAgICAgYm9keToge1xuICAgICAgICAgICAgICAgICAgICBkZXZpY2VJZDogZGV2aWNlSWRcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDY7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcXVlc3QuZXhlY3V0ZSgpO1xuXG4gICAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgICAgICBMaXZlLnVucmVnaXN0ZXIoKTtcblxuICAgICAgICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5hYnJ1cHQoXCJyZXR1cm5cIiwgdHJ1ZSk7XG5cbiAgICAgICAgICAgICAgY2FzZSA4OlxuICAgICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5zdG9wKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LCBfY2FsbGVlNCwgdGhpcyk7XG4gICAgICB9KSk7XG5cbiAgICAgIGZ1bmN0aW9uIHVucmVnaXN0ZXJGcm9tTGl2ZVNlcnZpY2UoKSB7XG4gICAgICAgIHJldHVybiBfdW5yZWdpc3RlckZyb21MaXZlU2VydmljZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdW5yZWdpc3RlckZyb21MaXZlU2VydmljZTtcbiAgICB9KClcbiAgfSwge1xuICAgIGtleTogXCJsb2dvdXRcIixcbiAgICB2YWx1ZTogZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIF9sb2dvdXQgPSAoMCwgX2FzeW5jVG9HZW5lcmF0b3IyLmRlZmF1bHQpKFxuICAgICAgLyojX19QVVJFX18qL1xuICAgICAgX3JlZ2VuZXJhdG9yLmRlZmF1bHQubWFyayhmdW5jdGlvbiBfY2FsbGVlNSgpIHtcbiAgICAgICAgdmFyIG9wdGlvbnMsXG4gICAgICAgICAgICBfZ2V0Q29uZmlnNSxcbiAgICAgICAgICAgIGFwaVByb3RvY29sLFxuICAgICAgICAgICAgYXBpSG9zdCxcbiAgICAgICAgICAgIGFwcEtleSxcbiAgICAgICAgICAgIHVybCxcbiAgICAgICAgICAgIHJlcXVlc3QsXG4gICAgICAgICAgICBfYXJnczUgPSBhcmd1bWVudHM7XG5cbiAgICAgICAgcmV0dXJuIF9yZWdlbmVyYXRvci5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZTUkKF9jb250ZXh0NSkge1xuICAgICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NS5wcmV2ID0gX2NvbnRleHQ1Lm5leHQpIHtcbiAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgIG9wdGlvbnMgPSBfYXJnczUubGVuZ3RoID4gMCAmJiBfYXJnczVbMF0gIT09IHVuZGVmaW5lZCA/IF9hcmdzNVswXSA6IHt9O1xuICAgICAgICAgICAgICAgIF9nZXRDb25maWc1ID0gKDAsIF9jb25maWcuZ2V0KSgpLCBhcGlQcm90b2NvbCA9IF9nZXRDb25maWc1LmFwaVByb3RvY29sLCBhcGlIb3N0ID0gX2dldENvbmZpZzUuYXBpSG9zdCwgYXBwS2V5ID0gX2dldENvbmZpZzUuYXBwS2V5O1xuXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmlzQWN0aXZlKCkpIHtcbiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gMTU7XG4gICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBfY29udGV4dDUucHJldiA9IDM7XG4gICAgICAgICAgICAgICAgLy8gVE9ETzogdW5yZWdpc3RlciBmcm9tIGxpdmUgc2VydmljZSBhbmQgcHVzaFxuICAgICAgICAgICAgICAgIHVybCA9ICgwLCBfdXRpbHMuZm9ybWF0S2ludmV5VXJsKShhcGlQcm90b2NvbCwgYXBpSG9zdCwgXCIvXCIuY29uY2F0KFVTRVJfTkFNRVNQQUNFLCBcIi9cIikuY29uY2F0KGFwcEtleSwgXCIvX2xvZ291dFwiKSk7XG4gICAgICAgICAgICAgICAgcmVxdWVzdCA9IG5ldyBfcmVxdWVzdC5LaW52ZXlSZXF1ZXN0KHtcbiAgICAgICAgICAgICAgICAgIG1ldGhvZDogX3JlcXVlc3QuUmVxdWVzdE1ldGhvZC5QT1NULFxuICAgICAgICAgICAgICAgICAgYXV0aDogX2F1dGguQXV0aC5TZXNzaW9uLFxuICAgICAgICAgICAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgICAgICAgICAgICB0aW1lb3V0OiBvcHRpb25zLnRpbWVvdXRcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDg7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcXVlc3QuZXhlY3V0ZSgpO1xuXG4gICAgICAgICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDEyO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgIGNhc2UgMTA6XG4gICAgICAgICAgICAgICAgX2NvbnRleHQ1LnByZXYgPSAxMDtcbiAgICAgICAgICAgICAgICBfY29udGV4dDUudDAgPSBfY29udGV4dDVbXCJjYXRjaFwiXSgzKTtcblxuICAgICAgICAgICAgICBjYXNlIDEyOlxuICAgICAgICAgICAgICAgICgwLCBfc2Vzc2lvbi5yZW1vdmUpKCk7XG4gICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSAxNTtcbiAgICAgICAgICAgICAgICByZXR1cm4gKDAsIF9kYXRhc3RvcmUuY2xlYXIpKCk7XG5cbiAgICAgICAgICAgICAgY2FzZSAxNTpcbiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LmFicnVwdChcInJldHVyblwiLCB0aGlzKTtcblxuICAgICAgICAgICAgICBjYXNlIDE2OlxuICAgICAgICAgICAgICBjYXNlIFwiZW5kXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5zdG9wKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LCBfY2FsbGVlNSwgdGhpcywgW1szLCAxMF1dKTtcbiAgICAgIH0pKTtcblxuICAgICAgZnVuY3Rpb24gbG9nb3V0KCkge1xuICAgICAgICByZXR1cm4gX2xvZ291dC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gbG9nb3V0O1xuICAgIH0oKVxuICB9LCB7XG4gICAga2V5OiBcIl9pZFwiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgaWYgKHRoaXMuZGF0YSkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYXRhLl9pZDtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6IFwiX2FjbFwiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgaWYgKHRoaXMuZGF0YSkge1xuICAgICAgICByZXR1cm4gbmV3IF9hY2wuZGVmYXVsdCh0aGlzLmRhdGEpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJfa21kXCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICBpZiAodGhpcy5kYXRhKSB7XG4gICAgICAgIHJldHVybiBuZXcgX2ttZC5kZWZhdWx0KHRoaXMuZGF0YSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIm1ldGFkYXRhXCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fa21kO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJhdXRodG9rZW5cIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHZhciBrbWQgPSB0aGlzLl9rbWQ7XG5cbiAgICAgIGlmIChrbWQpIHtcbiAgICAgICAgcmV0dXJuIGttZC5hdXRodG9rZW47XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcIl9zb2NpYWxJZGVudGl0eVwiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMuZGF0YS5fc29jaWFsSWRlbnRpdHk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcInVzZXJuYW1lXCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICBpZiAodGhpcy5kYXRhKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRhdGEudXNlcm5hbWU7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImVtYWlsXCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICBpZiAodGhpcy5kYXRhKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRhdGEuZW1haWw7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICB9XSk7XG4gIHJldHVybiBVc2VyO1xufSgpO1xuXG5leHBvcnRzLlVzZXIgPSBVc2VyO1xuXG5mdW5jdGlvbiBnZXRBY3RpdmVVc2VyKCkge1xuICB2YXIgc2Vzc2lvbiA9ICgwLCBfc2Vzc2lvbi5nZXQpKCk7XG5cbiAgaWYgKHNlc3Npb24pIHtcbiAgICByZXR1cm4gbmV3IFVzZXIoc2Vzc2lvbik7XG4gIH1cblxuICByZXR1cm4gbnVsbDtcbn0iLCJcInVzZSBzdHJpY3RcIjtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMubWVyZ2VTb2NpYWxJZGVudGl0eSA9IG1lcmdlU29jaWFsSWRlbnRpdHk7XG5cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvcHJlZmVyLWRlZmF1bHQtZXhwb3J0XG5mdW5jdGlvbiBtZXJnZVNvY2lhbElkZW50aXR5KCkge1xuICB2YXIgb3JpZ1NvY2lhbElkZW50aXR5ID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTtcbiAgdmFyIG5ld1NvY2lhbElkZW50aXR5ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7fTtcbiAgdmFyIG1lcmdlZFNvY2lhbElkZW50aXR5ID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShvcmlnU29jaWFsSWRlbnRpdHkpKTtcbiAgcmV0dXJuIE9iamVjdC5rZXlzKG5ld1NvY2lhbElkZW50aXR5KS5yZWR1Y2UoZnVuY3Rpb24gKHNvY2lhbElkZW50aXR5LCBpZGVudGl0eSkge1xuICAgIHNvY2lhbElkZW50aXR5W2lkZW50aXR5XSA9IE9iamVjdC5hc3NpZ24oe30sIG9yaWdTb2NpYWxJZGVudGl0eVtpZGVudGl0eV0sIG5ld1NvY2lhbElkZW50aXR5W2lkZW50aXR5XSk7XG4gICAgcmV0dXJuIHNvY2lhbElkZW50aXR5O1xuICB9LCBtZXJnZWRTb2NpYWxJZGVudGl0eSk7XG59IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gcmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW50ZXJvcFJlcXVpcmVEZWZhdWx0XCIpO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5kZWZhdWx0ID0gdmVyaWZ5RW1haWw7XG5cbnZhciBfcmVnZW5lcmF0b3IgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9yZWdlbmVyYXRvclwiKSk7XG5cbnZhciBfYXN5bmNUb0dlbmVyYXRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2FzeW5jVG9HZW5lcmF0b3JcIikpO1xuXG52YXIgX2lzU3RyaW5nID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwibG9kYXNoL2lzU3RyaW5nXCIpKTtcblxudmFyIF9jb25maWcgPSByZXF1aXJlKFwiLi4va2ludmV5L2NvbmZpZ1wiKTtcblxudmFyIF9raW52ZXkgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi9lcnJvcnMva2ludmV5XCIpKTtcblxudmFyIF91dGlscyA9IHJlcXVpcmUoXCIuLi9odHRwL3V0aWxzXCIpO1xuXG52YXIgX3JlcXVlc3QgPSByZXF1aXJlKFwiLi4vaHR0cC9yZXF1ZXN0XCIpO1xuXG52YXIgX2F1dGggPSByZXF1aXJlKFwiLi4vaHR0cC9hdXRoXCIpO1xuXG52YXIgUlBDX05BTUVTUEFDRSA9ICdycGMnO1xuXG5mdW5jdGlvbiB2ZXJpZnlFbWFpbChfeCkge1xuICByZXR1cm4gX3ZlcmlmeUVtYWlsLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5cbmZ1bmN0aW9uIF92ZXJpZnlFbWFpbCgpIHtcbiAgX3ZlcmlmeUVtYWlsID0gKDAsIF9hc3luY1RvR2VuZXJhdG9yMi5kZWZhdWx0KShcbiAgLyojX19QVVJFX18qL1xuICBfcmVnZW5lcmF0b3IuZGVmYXVsdC5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUodXNlcm5hbWUpIHtcbiAgICB2YXIgb3B0aW9ucyxcbiAgICAgICAgX2dldENvbmZpZyxcbiAgICAgICAgYXBpUHJvdG9jb2wsXG4gICAgICAgIGFwaUhvc3QsXG4gICAgICAgIGFwcEtleSxcbiAgICAgICAgcmVxdWVzdCxcbiAgICAgICAgcmVzcG9uc2UsXG4gICAgICAgIF9hcmdzID0gYXJndW1lbnRzO1xuXG4gICAgcmV0dXJuIF9yZWdlbmVyYXRvci5kZWZhdWx0LndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHtcbiAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHtcbiAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICBvcHRpb25zID0gX2FyZ3MubGVuZ3RoID4gMSAmJiBfYXJnc1sxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3NbMV0gOiB7fTtcbiAgICAgICAgICAgIF9nZXRDb25maWcgPSAoMCwgX2NvbmZpZy5nZXQpKCksIGFwaVByb3RvY29sID0gX2dldENvbmZpZy5hcGlQcm90b2NvbCwgYXBpSG9zdCA9IF9nZXRDb25maWcuYXBpSG9zdCwgYXBwS2V5ID0gX2dldENvbmZpZy5hcHBLZXk7XG5cbiAgICAgICAgICAgIGlmICh1c2VybmFtZSkge1xuICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNDtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRocm93IG5ldyBfa2ludmV5LmRlZmF1bHQoJ0EgdXNlcm5hbWUgd2FzIG5vdCBwcm92aWRlZC4nKTtcblxuICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgIGlmICgoMCwgX2lzU3RyaW5nLmRlZmF1bHQpKHVzZXJuYW1lKSkge1xuICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNjtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRocm93IG5ldyBfa2ludmV5LmRlZmF1bHQoJ1RoZSBwcm92aWRlZCB1c2VybmFtZSBpcyBub3QgYSBzdHJpbmcuJyk7XG5cbiAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICByZXF1ZXN0ID0gbmV3IF9yZXF1ZXN0LktpbnZleVJlcXVlc3Qoe1xuICAgICAgICAgICAgICBtZXRob2Q6IF9yZXF1ZXN0LlJlcXVlc3RNZXRob2QuUE9TVCxcbiAgICAgICAgICAgICAgYXV0aDogX2F1dGguQXV0aC5BcHAsXG4gICAgICAgICAgICAgIHVybDogKDAsIF91dGlscy5mb3JtYXRLaW52ZXlVcmwpKGFwaVByb3RvY29sLCBhcGlIb3N0LCBcIi9cIi5jb25jYXQoUlBDX05BTUVTUEFDRSwgXCIvXCIpLmNvbmNhdChhcHBLZXksIFwiL1wiKS5jb25jYXQodXNlcm5hbWUsIFwiL3VzZXItZW1haWwtdmVyaWZpY2F0aW9uLWluaXRpYXRlXCIpKSxcbiAgICAgICAgICAgICAgdGltZW91dDogb3B0aW9ucy50aW1lb3V0XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA5O1xuICAgICAgICAgICAgcmV0dXJuIHJlcXVlc3QuZXhlY3V0ZSgpO1xuXG4gICAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgcmVzcG9uc2UgPSBfY29udGV4dC5zZW50O1xuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdChcInJldHVyblwiLCByZXNwb25zZS5kYXRhKTtcblxuICAgICAgICAgIGNhc2UgMTE6XG4gICAgICAgICAgY2FzZSBcImVuZFwiOlxuICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIF9jYWxsZWUsIHRoaXMpO1xuICB9KSk7XG4gIHJldHVybiBfdmVyaWZ5RW1haWwuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn0iXSwic291cmNlUm9vdCI6IiJ9